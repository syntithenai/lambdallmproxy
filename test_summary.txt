
      at Object.toHaveBeenCalledWith (tests/integration/endpoints.test.js:161:44)

  ● Main Router Integration Tests › Static File Routing › should route GET /css/styles.css to static endpoint

    expect(jest.fn()).toHaveBeenCalledWith(...expected)

    - Expected
    + Received

      {"httpMethod": "GET", "path": "/css/styles.css"},
    - {"chunks": [undefined], "ended": true, "metadata": null},

    Number of calls: 1

      173 |             await handler(event, mockStream);
      174 |             
    > 175 |             expect(staticEndpoint.handler).toHaveBeenCalledWith(event, mockStream);
          |                                            ^
      176 |         });
      177 |     });
      178 |     

      at Object.toHaveBeenCalledWith (tests/integration/endpoints.test.js:175:44)

  ● Main Router Integration Tests › Method Not Allowed › should return 405 for unsupported methods

    expect(received).toBe(expected) // Object.is equality

    Expected: 405
    Received: undefined

      187 |             await handler(event, mockStream);
      188 |             
    > 189 |             expect(mockStream.metadata?.statusCode).toBe(405);
          |                                                     ^
      190 |             expect(mockStream.ended).toBe(true);
      191 |         });
      192 |         

      at Object.toBe (tests/integration/endpoints.test.js:189:53)

  ● Main Router Integration Tests › Method Not Allowed › should return 405 for PUT requests

    expect(received).toBe(expected) // Object.is equality

    Expected: 405
    Received: undefined

      200 |             await handler(event, mockStream);
      201 |             
    > 202 |             expect(mockStream.metadata?.statusCode).toBe(405);
          |                                                     ^
      203 |             expect(mockStream.ended).toBe(true);
      204 |         });
      205 |     });

      at Object.toBe (tests/integration/endpoints.test.js:202:53)

  ● Main Router Integration Tests › Error Handling › should handle endpoint errors gracefully

    expect(received).toBe(expected) // Object.is equality

    Expected: 500
    Received: undefined

      218 |             await handler(event, mockStream);
      219 |             
    > 220 |             expect(mockStream.metadata?.statusCode).toBe(500);
          |                                                     ^
      221 |             expect(mockStream.ended).toBe(true);
      222 |         });
      223 |         

      at Object.toBe (tests/integration/endpoints.test.js:220:53)

  ● Main Router Integration Tests › Error Handling › should include CORS headers in error responses

    expect(received).toHaveProperty(path, value)

    Matcher error: received value must not be null nor undefined

    Received has value: undefined

      234 |             await handler(event, mockStream);
      235 |             
    > 236 |             expect(mockStream.metadata?.headers).toHaveProperty('Content-Type', 'application/json');
          |                                                  ^
      237 |         });
      238 |     });
      239 |     

      at Object.toHaveProperty (tests/integration/endpoints.test.js:236:50)


Test Suites: 5 failed, 30 passed, 35 total
Tests:       21 failed, 14 skipped, 650 passed, 685 total
Snapshots:   0 total
Time:        70.122 s
Ran all test suites.

import{c as E,r as n,aI as ae,u as ie,bo as re,b7 as oe,b5 as de,bp as he,j as e,bc as W,ba as J,bq as xe,bb as K,bh as Y,br as ue,l as me,a as ge,bs as P,bt as pe}from"./index-Bgcv6UVX.js";import{C as Z}from"./calendar-f68pZWov.js";import{Q as fe}from"./QuizCard-DU2YOgnE.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],we=E("arrow-up",be);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],ee=E("bookmark",ye);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ve=E("circle-alert",je);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],te=E("external-link",Ne);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],Ce=E("hand",ke);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],se=E("loader-circle",Se);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],$e=E("search",Ie);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],ne=E("tag",Me);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],ze=E("thumbs-down",Re);function Le(t={}){const{threshold:o=100,onSwipeStart:y,onSwipeEnd:u,onSwipeProgress:j}=t,[U,D]=n.useState({direction:null,progress:0,isSwiping:!1}),i=n.useRef(0),I=n.useRef(0),m=n.useRef(0),c=n.useRef(!1),w=n.useRef(null),v=n.useCallback((a,x)=>{i.current=a,m.current=x,I.current=a,c.current=!1,D({direction:null,progress:0,isSwiping:!1}),y&&y()},[y]),h=n.useCallback((a,x)=>{if(i.current===0)return;I.current=a;const f=a-i.current,_=x-m.current;if(!c.current&&Math.abs(f)>Math.abs(_)&&Math.abs(f)>10&&(c.current=!0),c.current){const F=f>0?"right":"left",q=Math.min(Math.abs(f)/o,1);D({direction:F,progress:q,isSwiping:!0}),j&&j(q,F)}},[o,j]),$=n.useCallback(()=>{if(!c.current){i.current=0,m.current=0;return}const a=I.current-i.current,x=a>0?"right":"left",f=Math.abs(a);c.current=!1,i.current=0,m.current=0,I.current=0,D({direction:null,progress:0,isSwiping:!1}),f>=o&&u?u(x):u&&u(null)},[o,u]),N=n.useCallback(a=>{const x=a.touches[0];v(x.clientX,x.clientY)},[v]),k=n.useCallback(a=>{const x=a.touches[0];h(x.clientX,x.clientY),c.current&&a.preventDefault()},[h]),M=n.useCallback(()=>{$()},[$]),C=n.useCallback(a=>{v(a.clientX,a.clientY)},[v]),R=n.useCallback(a=>{h(a.clientX,a.clientY)},[h]),d=n.useCallback(()=>{$()},[$]),A=n.useCallback(a=>{w.current=a,a.addEventListener("touchstart",N,{passive:!0}),a.addEventListener("touchmove",k,{passive:!1}),a.addEventListener("touchend",M,{passive:!0}),a.addEventListener("mousedown",C),document.addEventListener("mousemove",R),document.addEventListener("mouseup",d)},[N,k,M,C,R,d]),z=n.useCallback(()=>{const a=w.current;a&&(a.removeEventListener("touchstart",N),a.removeEventListener("touchmove",k),a.removeEventListener("touchend",M),a.removeEventListener("mousedown",C),document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",d))},[N,k,M,C,R,d]);return n.useEffect(()=>()=>{z()},[z]),{swipeState:U,attachListeners:A,detachListeners:z}}function Ee({item:t}){const{t:o}=ae(),y=ie(),{stashItem:u,trashItem:j,markViewed:U,startQuiz:D,generatingQuizForItem:i}=re(),{addSnippet:I}=oe(),{showSuccess:m}=de(),c=i===t.id,w=n.useRef(null),[v,h]=n.useState(!1),[$,N]=n.useState(!1),[k,M]=n.useState(!1),C=n.useRef(Date.now()),R=M,{swipeState:d,attachListeners:A,detachListeners:z}=Le({threshold:100,onSwipeEnd:s=>{s==="right"?x():s==="left"&&f()}});n.useEffect(()=>{const s="ontouchstart"in window&&window.innerWidth<768;return w.current&&s&&A(w.current),()=>{s&&z()}},[A,z]),n.useEffect(()=>{if(!t.viewed){const s=setTimeout(()=>{U(t.id),a("view")},1e3);return()=>clearTimeout(s)}},[t.id,t.viewed,U]);const a=async s=>{const l=Date.now()-C.current,p=t.type==="did-you-know"?"didYouKnow":"questionAnswer";await he.saveInteraction({feedItemId:t.id,action:s,timeSpent:l,itemType:p,topics:t.topics||[],source:t.sources?.[0]||"unknown",content:t.content||""})},x=async()=>{await a("stash");let s=`**${t.title}**

`;t.image&&(s+=`![${t.title}](${t.image})

`,t.imageAttribution&&(s+=`*Image: ${t.imageAttribution}*

`)),s+=`${t.content}

`,t.expandedContent&&t.expandedContent!==t.content&&(s+=`---

`,s+=`**Detailed Information:**

${t.expandedContent}

`),t.mnemonic&&(s+=`---

`,s+=`**Memory Aid:** ${t.mnemonic}

`),s+=`**Topics:** ${t.topics.join(", ")}`,t.sources&&t.sources.length>0&&(s+=`

**Sources:**
`,t.sources.forEach((p,X)=>{s+=`${X+1}. ${p}
`}));const l=[...t.topics||[],"admin:feed"];await I(s,"tool",t.title,l),await u(t.id)},f=async()=>{await a("trash"),await j(t.id)},_=async()=>{await a("quiz"),await D(t.id)},F=async()=>{await a("skip");const s=`Can you explain more about ${t.title}? ${t.topics.length>0?`I'm particularly interested in ${t.topics.slice(0,2).join(" and ")}.`:""} Please provide detailed information and examples.`;y("/chat",{state:{initialQuery:s,autoSubmit:!0,clearChat:!0}})},q=()=>{N(!0)},L=()=>{const s="https://ai.syntithenai.com",l=T=>{if(!T)return;const S=150;return T.length<=S?T:T.slice(0,S)+"..."},p=T=>!T||!Array.isArray(T)?[]:T.slice(0,3).map(S=>({url:typeof S=="string"?S:S.url,title:typeof S=="string"?S:S.title?.slice(0,60)||S.url})),X={type:"feed_item",title:t.title,content:t.content?.slice(0,200),topics:t.topics?.slice(0,5),image:t.image,sources:p(t.sources),expandedContent:l(t.expandedContent)},le=JSON.stringify(X),ce=me.compressToEncodedURIComponent(le);return`${s}/feed/share/${ce}`},O=()=>{const s=L(),l=encodeURIComponent(s);window.open(`https://www.facebook.com/sharer/sharer.php?u=${l}`,"_blank")},r=()=>{const s=L(),l=encodeURIComponent(`Check out this interesting article: ${t.title}

${s}`);window.open(`https://bsky.app/intent/compose?text=${l}`,"_blank")},g=()=>{const s=L(),l=encodeURIComponent(`Check out this interesting article: ${t.title}`),p=encodeURIComponent(s);window.open(`https://twitter.com/intent/tweet?text=${l}&url=${p}`,"_blank")},b=()=>{const s=L(),l=encodeURIComponent(s),p=encodeURIComponent(t.title);window.open(`https://reddit.com/submit?url=${l}&title=${p}`,"_blank")},H=()=>{const s=L(),l=encodeURIComponent(s);window.open(`https://www.quora.com/share?url=${l}`,"_blank")},B=()=>{const s=encodeURIComponent(`Check out: ${t.title}`),l=encodeURIComponent(`I thought you might find this interesting:

${t.title}

${L()}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${s}&body=${l}`,"_blank")},G=async()=>{try{await navigator.clipboard.writeText(L()),m("Link copied to clipboard!")}catch(s){console.error("Failed to copy link:",s)}},Q=()=>{if(!d.isSwiping)return"";const{progress:s,direction:l}=d,p=s*100;return`translateX(${l==="right"?p:-p}px)`},V=()=>{if(!d.isSwiping)return"transparent";const{progress:s,direction:l}=d,p=Math.min(s*.3,.3);return l==="right"?`rgba(34, 197, 94, ${p})`:`rgba(239, 68, 68, ${p})`};return e.jsxs("div",{ref:w,className:"bg-white sm:rounded-lg shadow-sm overflow-hidden transition-all hover:shadow-md cursor-pointer relative",style:{transform:Q(),backgroundColor:V(),transition:d.isSwiping?"none":"all 0.2s ease",display:"block",visibility:"visible",minHeight:"100px"},onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),children:[d.isSwiping&&e.jsxs(e.Fragment,{children:[d.direction==="right"&&e.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-green-600 flex items-center gap-2",children:[e.jsx(ee,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:o("feed.stash")})]}),d.direction==="left"&&e.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-red-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:o("feed.trash")}),e.jsx(W,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?o("feed.didYouKnow"):o("feed.questionAnswer")}),t.stashed&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-700",children:o("feed.stashed")})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:t.title}),t.image&&e.jsxs("div",{className:"mb-3 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-48 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{onClick:()=>h(!0),className:"cursor-pointer hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors",title:"Click to read full article",children:[e.jsx("p",{className:"text-gray-700 mb-3 line-clamp-3",children:typeof t.content=="string"?t.content:t.content?.summary||"No content available"}),t.mnemonic&&e.jsx("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 mb-3 rounded",children:e.jsxs("p",{className:"text-sm font-medium text-purple-900",children:["ðŸ’¡ ",typeof t.mnemonic=="string"?t.mnemonic:JSON.stringify(t.mnemonic)]})}),t.expandedContent&&e.jsx("p",{className:"text-xs text-blue-600 hover:text-blue-700 font-medium mb-3",children:"Click to read more..."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(ne,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,l)=>e.jsxs("span",{children:[e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(s)}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 hover:underline",title:`Search Google for "${s}"`,children:s}),l<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},l))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-3 mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 font-semibold",children:[o("feed.sources"),":"]}),e.jsx("div",{className:"space-y-1",children:t.sources.slice(0,2).map((s,l)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(te,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s})]},l))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 grid grid-cols-5 gap-2",children:[e.jsxs("button",{onClick:f,className:"flex flex-col items-center justify-center gap-2 p-4 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg transition-colors",title:"Downvote - Hide similar content",children:[e.jsx(ze,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Block"})]}),e.jsxs("button",{onClick:x,disabled:t.stashed,className:"flex flex-col items-center justify-center gap-2 p-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Save to Swag",children:[e.jsx(Ce,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:t.stashed?"Saved":"Save"})]}),e.jsxs("button",{onClick:_,disabled:c,className:"flex flex-col items-center justify-center gap-2 p-4 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate Quiz",children:[c?e.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(J,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Quiz"})]}),e.jsxs("button",{onClick:F,className:"flex flex-col items-center justify-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors",title:"Discuss in Chat",children:[e.jsx(xe,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Chat"})]}),e.jsxs("button",{onClick:q,className:"flex flex-col items-center justify-center gap-2 p-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors",title:"Share this article",children:[e.jsx(K,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Share"})]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>h(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?o("feed.didYouKnow"):o("feed.questionAnswer")}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.title})]}),e.jsx("button",{onClick:()=>h(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close",children:e.jsx(Y,{className:"h-6 w-6 text-gray-500"})})]}),e.jsxs("div",{className:"p-6",children:[t.image&&e.jsxs("div",{className:"mb-4 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-64 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.content})]}),t.mnemonic&&e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-4 mb-4 rounded",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-900 mb-2",children:["ðŸ’¡ ",t.mnemonic]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Topics:"}),e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(t.topics.join(" "))}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 hover:underline",title:`Search Google for "${t.topics.join(", ")}"`,children:t.topics.join(", ")})]})]}),t.expandedContent&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"ðŸ“– Deep Dive"}),e.jsx(ue,{text:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2),variant:"icon",shouldSummarize:!1})]}),e.jsx("div",{className:"text-gray-700 leading-relaxed space-y-3 whitespace-pre-line",children:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(ne,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,l)=>e.jsxs("span",{children:[e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(s)}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 hover:underline",title:`Search Google for "${s}"`,children:s}),l<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},l))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2 font-semibold",children:[o("feed.sources"),":"]}),e.jsx("div",{className:"space-y-2",children:t.sources.map((s,l)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:s})]},l))})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-4 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{await x(),h(!1)},className:`flex-1 px-4 py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors ${t.stashed?"bg-green-100 text-green-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[e.jsx(ee,{className:"h-5 w-5"}),t.stashed?o("feed.stashed"):o("feed.stash")]}),e.jsx("button",{onClick:async()=>{await _(),h(!1)},disabled:c,className:`flex-1 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-sm flex items-center justify-center gap-2 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o("quiz.generating")]}):e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-5 w-5"}),o("feed.quiz")]})}),e.jsx("button",{onClick:async()=>{await f(),h(!1)},className:"px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm flex items-center justify-center gap-2",children:e.jsx(W,{className:"h-5 w-5"})})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>N(!1),children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Share Article"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:t.title}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:G,className:"w-full px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"Copy Link"]}),e.jsxs("button",{onClick:g,className:"w-full px-4 py-3 bg-[#1DA1F2] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]}),e.jsxs("button",{onClick:b,className:"w-full px-4 py-3 bg-[#FF4500] hover:bg-[#e03d00] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:O,className:"w-full px-4 py-3 bg-[#1877F2] hover:bg-[#166fe5] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:r,className:"w-full px-4 py-3 bg-[#0085ff] hover:bg-[#0073e6] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:H,className:"w-full px-4 py-3 bg-[#B92B27] hover:bg-[#a02522] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),e.jsxs("button",{onClick:B,className:"w-full px-4 py-3 bg-[#EA4335] hover:bg-[#d33426] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]})})})]})}function Ae(t){return{title:t.title,questions:t.questions.map(o=>({id:o.id,prompt:o.prompt,choices:o.choices,answerId:o.correctChoiceId,explanation:o.explanation}))}}function _e({quiz:t,onClose:o}){const y=Ae(t);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsx(fe,{quiz:y,onClose:o,onComplete:(u,j)=>{console.log(`Feed quiz completed: ${u}/${j}`)}})})})}function Ue(){const{t}=ae(),{isAuthenticated:o}=ge(),{snippets:y}=oe(),[u,j]=n.useState(""),[U,D]=n.useState(!1),{items:i,currentQuiz:I,isLoading:m,isGenerating:c,generationStatus:w,error:v,generateMore:h,refresh:$,closeQuiz:N,clearAllItems:k,stopGeneration:M,lastSearchCriteria:C}=re(),R=n.useRef(null),d=n.useRef(null),A=n.useRef(null),z=n.useRef(c),a=n.useRef(m),x=n.useRef(h),f=n.useRef(C);n.useEffect(()=>{console.log("ðŸ”„ FeedPage: isGenerating changed:",c),console.log("ðŸ”„ FeedPage: generationStatus:",w),z.current=c,a.current=m,x.current=h,f.current=C},[c,m,h,w,C]);const _=n.useMemo(()=>{const r={};return y.forEach(g=>{g.tags?.forEach(b=>{b.startsWith("admin:")||(r[b]=(r[b]||0)+1)})}),Object.entries(r).sort((g,b)=>b[1]-g[1]).slice(0,10).map(([g])=>g)},[y]),F=n.useCallback(async()=>{const r=u.trim();r&&(console.log("ðŸ” Searching interests:",r),await k(),await h([r]),j(""))},[u,k,h]),q=n.useCallback(async r=>{console.log("ðŸ·ï¸ Searching tag:",r),await k(),await h([r])},[k,h]);n.useEffect(()=>{console.log("ðŸŽ¯ FeedPage: items changed:",i.length,"items"),console.log("ðŸŽ¯ Item titles:",i.map(r=>r.title)),console.log("ðŸŽ¯ Item IDs:",i.map(r=>r.id))},[i]),n.useEffect(()=>{if(!(!A.current||!o))return d.current&&d.current.disconnect(),d.current=new IntersectionObserver(r=>{const[g]=r,b=f.current;console.log("ðŸ‘ï¸ IntersectionObserver fired:",{isIntersecting:g.isIntersecting,itemsLength:i.length,lastSearchCriteria:b});const H=b&&b.length>0,B=i.length>0,G=B||H,Q=a.current,V=z.current,s=x.current;console.log("ðŸ” Infinite scroll check:",{isIntersecting:g.isIntersecting,currentIsLoading:Q,currentIsGenerating:V,shouldAllowInfiniteScroll:G,hasActiveSearchCriteria:H,hasExistingItems:B,itemsLength:i.length}),g.isIntersecting&&!Q&&!V&&G?(console.log("ðŸ“œ Infinite scroll triggered - generating more items..."),console.log("ðŸ“œ Reason: hasExistingItems="+B+", hasActiveSearchCriteria="+H),s()):g.isIntersecting&&!G?(console.log("ðŸ“œ Infinite scroll blocked: no items and no active search criteria (need user interests input or clicked tag)"),console.log("ðŸ“œ Debug: itemsLength="+i.length+", lastSearchCriteria="+(b?b.join(", "):"null"))):g.isIntersecting&&(Q||V)&&console.log("ðŸ“œ Infinite scroll blocked: already generating/loading")},{root:null,rootMargin:"200px",threshold:.1}),d.current.observe(A.current),()=>{d.current&&d.current.disconnect()}},[o]),n.useEffect(()=>{const r=()=>{D(window.scrollY>300)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const L=n.useCallback(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),O=n.useCallback(async()=>{await $()},[$]);return console.log("ðŸŽ¨ FeedPage render:",{isAuthenticated:o,isLoading:m,isGenerating:c,itemsCount:i.length,hasError:!!v}),o?e.jsxs("div",{ref:R,className:"bg-gray-50 pb-20",style:{minHeight:"100vh"},children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:[c&&e.jsx("div",{className:"bg-blue-50 border-b border-blue-200 px-2 sm:px-4 py-2",children:e.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800 font-medium",children:w||"Generating feed items..."})]}),e.jsxs("button",{onClick:r=>{console.log("ðŸ”´ Stop button clicked!",r),M()},className:"px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-1.5 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(Y,{className:"h-4 w-4"}),"Stop"]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-6 w-6 text-blue-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("feed.title")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:O,disabled:m||c,className:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:t("feed.refresh"),children:e.jsx(pe,{className:`h-5 w-5 text-gray-600 ${m||c?"animate-spin":""}`})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"What are your interests?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:u,onChange:r=>j(r.target.value),onKeyDown:r=>{r.key==="Enter"&&u.trim()&&!c&&F()},placeholder:"e.g., artificial intelligence, space exploration, history...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:c}),e.jsxs("button",{onClick:F,disabled:!u.trim()||c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Search"]})]})]}),_.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Or browse by your saved tags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(r=>e.jsx("button",{onClick:()=>q(r),disabled:c,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-blue-100 hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:r},r))})]}),_.length===0&&e.jsx("p",{className:"text-xs text-gray-500",children:"Add some interests above or save content with tags in Swag to see tag suggestions here."})]})]})]}),v&&e.jsx("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ve,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-900 mb-1",children:t("errors.error")}),e.jsx("p",{className:"text-sm text-red-700",children:v})]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4 space-y-4",children:[i.map((r,g)=>(console.log(`ðŸŽ´ Rendering FeedItemCard ${g+1}/${i.length}:`,r.id,r.title),e.jsx(Ee,{item:r},r.id))),i.length===0&&!m&&!c&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(P,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t("feed.noItems")}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Use the search or tag buttons above to generate your personalized feed"})]}),(m||c)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(se,{className:"h-8 w-8 text-blue-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:t(c?"feed.generating":"common.loading")}),w&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 animate-pulse",children:w})]}),c&&e.jsxs("button",{onClick:r=>{console.log("ðŸ”´ Bottom stop button clicked!",r),M()},className:"mt-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(Y,{className:"h-4 w-4"}),"Stop Generation"]})]})]}),i.length>2&&e.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:["â†“ Scroll down to see more items (",i.length," total) â†“"]}),e.jsx("div",{ref:A,className:"h-4"}),U&&e.jsx("button",{onClick:L,className:"fixed bottom-6 right-6 bg-blue-600 text-white rounded-full p-3 shadow-lg hover:bg-blue-700 transition-all duration-300 hover:scale-110 z-50",title:"Scroll to top","aria-label":"Scroll to top",children:e.jsx(we,{className:"h-6 w-6"})}),I&&e.jsx(_e,{quiz:I,onClose:N})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md text-center",children:[e.jsx(P,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t("feed.title")}),e.jsx("p",{className:"text-gray-600 mb-4",children:t("feed.emptyMessage")}),e.jsx("p",{className:"text-sm text-gray-500",children:t("common.pleaseSignIn")})]})})}export{Ue as default};

import{c as H,r as l,aH as te,u as ae,bl as se,aK as ne,aI as re,bm as le,j as e,aO as W,aN as Y,bn as oe,bo as O,be as V,bp as ce,a as ie,aJ as de,bq as P,br as he}from"./index-DdK1nKHz.js";import{C as J}from"./calendar-CMg5UCaA.js";import{Q as ue}from"./QuizCard-9G3rlv6q.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],K=H("bookmark",xe);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],me=H("circle-alert",ge);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],Z=H("external-link",pe);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],be=H("hand",fe);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],we=H("loader-circle",ye);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],ee=H("tag",je);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]],Ne=H("thumbs-down",ve);function ke(t={}){const{threshold:n=100,onSwipeStart:y,onSwipeEnd:x,onSwipeProgress:N}=t,[b,k]=l.useState({direction:null,progress:0,isSwiping:!1}),a=l.useRef(0),S=l.useRef(0),R=l.useRef(0),c=l.useRef(!1),i=l.useRef(null),z=l.useCallback((r,g)=>{a.current=r,R.current=g,S.current=r,c.current=!1,k({direction:null,progress:0,isSwiping:!1}),y&&y()},[y]),m=l.useCallback((r,g)=>{if(a.current===0)return;S.current=r;const w=r-a.current,L=g-R.current;if(!c.current&&Math.abs(w)>Math.abs(L)&&Math.abs(w)>10&&(c.current=!0),c.current){const q=w>0?"right":"left",U=Math.min(Math.abs(w)/n,1);k({direction:q,progress:U,isSwiping:!0}),N&&N(U,q)}},[n,N]),I=l.useCallback(()=>{if(!c.current){a.current=0,R.current=0;return}const r=S.current-a.current,g=r>0?"right":"left",w=Math.abs(r);c.current=!1,a.current=0,R.current=0,S.current=0,k({direction:null,progress:0,isSwiping:!1}),w>=n&&x?x(g):x&&x(null)},[n,x]),h=l.useCallback(r=>{const g=r.touches[0];z(g.clientX,g.clientY)},[z]),T=l.useCallback(r=>{const g=r.touches[0];m(g.clientX,g.clientY),c.current&&r.preventDefault()},[m]),E=l.useCallback(()=>{I()},[I]),_=l.useCallback(r=>{z(r.clientX,r.clientY)},[z]),$=l.useCallback(r=>{m(r.clientX,r.clientY)},[m]),p=l.useCallback(()=>{I()},[I]),C=l.useCallback(r=>{i.current=r,r.addEventListener("touchstart",h,{passive:!0}),r.addEventListener("touchmove",T,{passive:!1}),r.addEventListener("touchend",E,{passive:!0}),r.addEventListener("mousedown",_),document.addEventListener("mousemove",$),document.addEventListener("mouseup",p)},[h,T,E,_,$,p]),M=l.useCallback(()=>{const r=i.current;r&&(r.removeEventListener("touchstart",h),r.removeEventListener("touchmove",T),r.removeEventListener("touchend",E),r.removeEventListener("mousedown",_),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",p))},[h,T,E,_,$,p]);return l.useEffect(()=>()=>{M()},[M]),{swipeState:b,attachListeners:C,detachListeners:M}}function Ce({item:t}){const{t:n}=te(),y=ae(),{stashItem:x,trashItem:N,markViewed:b,startQuiz:k,generatingQuizForItem:a}=se(),{addSnippet:S}=ne(),{showSuccess:R}=re(),c=a===t.id,i=l.useRef(null),[z,m]=l.useState(!1),[I,h]=l.useState(!1),[T,E]=l.useState(!1),_=l.useRef(Date.now()),$=E,{swipeState:p,attachListeners:C,detachListeners:M}=ke({threshold:100,onSwipeEnd:s=>{s==="right"?g():s==="left"&&w()}});l.useEffect(()=>{const s="ontouchstart"in window&&window.innerWidth<768;return i.current&&s&&C(i.current),()=>{s&&M()}},[C,M]),l.useEffect(()=>{if(!t.viewed){const s=setTimeout(()=>{b(t.id),r("view")},1e3);return()=>clearTimeout(s)}},[t.id,t.viewed,b]);const r=async s=>{const o=Date.now()-_.current,f=t.type==="did-you-know"?"didYouKnow":"questionAnswer";await le.saveInteraction({feedItemId:t.id,action:s,timeSpent:o,itemType:f,topics:t.topics||[],source:t.sources?.[0]||"unknown",content:t.content||""})},g=async()=>{await r("stash");let s=`**${t.title}**

`;t.image&&(s+=`![${t.title}](${t.image})

`,t.imageAttribution&&(s+=`*Image: ${t.imageAttribution}*

`)),s+=`${t.content}

`,t.expandedContent&&t.expandedContent!==t.content&&(s+=`---

`,s+=`**Detailed Information:**

${t.expandedContent}

`),t.mnemonic&&(s+=`---

`,s+=`**Memory Aid:** ${t.mnemonic}

`),s+=`**Topics:** ${t.topics.join(", ")}`,t.sources&&t.sources.length>0&&(s+=`

**Sources:**
`,t.sources.forEach((f,X)=>{s+=`${X+1}. ${f}
`}));const o=[...t.topics||[],"admin:feed"];await S(s,"tool",t.title,o),await x(t.id)},w=async()=>{await r("trash"),await N(t.id)},L=async()=>{await r("quiz"),await k(t.id)},q=async()=>{await r("skip");const s=`Can you explain more about ${t.title}? ${t.topics.length>0?`I'm particularly interested in ${t.topics.slice(0,2).join(" and ")}.`:""} Please provide detailed information and examples.`;y("/chat",{state:{initialQuery:s,autoSubmit:!0,clearChat:!0}})},U=()=>{h(!0)},F=()=>{let s=window.location.origin;!window.location.hostname.includes("localhost")&&!window.location.hostname.includes("127.0.0.1")&&(s="https://ai.syntithenai.com");const o={type:"feed_item",title:t.title,content:t.content,topics:t.topics,image:t.image,sources:t.sources,expandedContent:t.expandedContent,mnemonic:t.mnemonic},f=btoa(JSON.stringify(o));return`${s}/feed/share/${f}`},B=()=>{const s=F(),o=encodeURIComponent(s);window.open(`https://www.facebook.com/sharer/sharer.php?u=${o}`,"_blank")},u=()=>{const s=F(),o=encodeURIComponent(`Check out this interesting article: ${t.title}

${s}`);window.open(`https://bsky.app/intent/compose?text=${o}`,"_blank")},d=()=>{const s=F(),o=encodeURIComponent(`Check out this interesting article: ${t.title}`),f=encodeURIComponent(s);window.open(`https://twitter.com/intent/tweet?text=${o}&url=${f}`,"_blank")},v=()=>{const s=F(),o=encodeURIComponent(s),f=encodeURIComponent(t.title);window.open(`https://reddit.com/submit?url=${o}&title=${f}`,"_blank")},D=()=>{const s=F(),o=encodeURIComponent(s);window.open(`https://www.quora.com/share?url=${o}`,"_blank")},j=()=>{const s=encodeURIComponent(`Check out: ${t.title}`),o=encodeURIComponent(`I thought you might find this interesting:

${t.title}

${F()}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${s}&body=${o}`,"_blank")},A=async()=>{try{await navigator.clipboard.writeText(F()),R("Link copied to clipboard!")}catch(s){console.error("Failed to copy link:",s)}},Q=()=>{if(!p.isSwiping)return"";const{progress:s,direction:o}=p,f=s*100;return`translateX(${o==="right"?f:-f}px)`},G=()=>{if(!p.isSwiping)return"transparent";const{progress:s,direction:o}=p,f=Math.min(s*.3,.3);return o==="right"?`rgba(34, 197, 94, ${f})`:`rgba(239, 68, 68, ${f})`};return e.jsxs("div",{ref:i,className:"bg-white sm:rounded-lg shadow-sm overflow-hidden transition-all hover:shadow-md cursor-pointer relative",style:{transform:Q(),backgroundColor:G(),transition:p.isSwiping?"none":"all 0.2s ease",display:"block",visibility:"visible",minHeight:"100px"},onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),children:[p.isSwiping&&e.jsxs(e.Fragment,{children:[p.direction==="right"&&e.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-green-600 flex items-center gap-2",children:[e.jsx(K,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:n("feed.stash")})]}),p.direction==="left"&&e.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-red-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:n("feed.trash")}),e.jsx(W,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?n("feed.didYouKnow"):n("feed.questionAnswer")}),t.stashed&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-700",children:n("feed.stashed")})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:t.title}),t.image&&e.jsxs("div",{className:"mb-3 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-48 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{onClick:()=>m(!0),className:"cursor-pointer hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors",title:"Click to read full article",children:[e.jsx("p",{className:"text-gray-700 mb-3 line-clamp-3",children:typeof t.content=="string"?t.content:t.content?.summary||"No content available"}),t.mnemonic&&e.jsx("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 mb-3 rounded",children:e.jsxs("p",{className:"text-sm font-medium text-purple-900",children:["ðŸ’¡ ",typeof t.mnemonic=="string"?t.mnemonic:JSON.stringify(t.mnemonic)]})}),t.expandedContent&&e.jsx("p",{className:"text-xs text-blue-600 hover:text-blue-700 font-medium mb-3",children:"Click to read more..."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(ee,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,o)=>e.jsxs("span",{children:[e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(s)}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 hover:underline",title:`Search Google for "${s}"`,children:s}),o<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},o))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-3 mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 font-semibold",children:[n("feed.sources"),":"]}),e.jsx("div",{className:"space-y-1",children:t.sources.slice(0,2).map((s,o)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s})]},o))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 grid grid-cols-5 gap-2",children:[e.jsxs("button",{onClick:w,className:"flex flex-col items-center justify-center gap-2 p-4 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg transition-colors",title:"Downvote - Hide similar content",children:[e.jsx(Ne,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Block"})]}),e.jsxs("button",{onClick:g,disabled:t.stashed,className:"flex flex-col items-center justify-center gap-2 p-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Save to Swag",children:[e.jsx(be,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:t.stashed?"Saved":"Save"})]}),e.jsxs("button",{onClick:L,disabled:c,className:"flex flex-col items-center justify-center gap-2 p-4 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate Quiz",children:[c?e.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Y,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Quiz"})]}),e.jsxs("button",{onClick:q,className:"flex flex-col items-center justify-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors",title:"Discuss in Chat",children:[e.jsx(oe,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Chat"})]}),e.jsxs("button",{onClick:U,className:"flex flex-col items-center justify-center gap-2 p-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors",title:"Share this article",children:[e.jsx(O,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Share"})]})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>m(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?n("feed.didYouKnow"):n("feed.questionAnswer")}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.title})]}),e.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close",children:e.jsx(V,{className:"h-6 w-6 text-gray-500"})})]}),e.jsxs("div",{className:"p-6",children:[t.image&&e.jsxs("div",{className:"mb-4 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-64 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.content})]}),t.mnemonic&&e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-4 mb-4 rounded",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-900 mb-2",children:["ðŸ’¡ ",t.mnemonic]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Topics:"}),e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(t.topics.join(" "))}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 hover:underline",title:`Search Google for "${t.topics.join(", ")}"`,children:t.topics.join(", ")})]})]}),t.expandedContent&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"ðŸ“– Deep Dive"}),e.jsx(ce,{text:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2),variant:"icon",shouldSummarize:!1})]}),e.jsx("div",{className:"text-gray-700 leading-relaxed space-y-3 whitespace-pre-line",children:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(ee,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,o)=>e.jsxs("span",{children:[e.jsx("a",{href:`https://www.google.com/search?q=${encodeURIComponent(s)}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 hover:text-blue-600 hover:underline",title:`Search Google for "${s}"`,children:s}),o<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},o))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2 font-semibold",children:[n("feed.sources"),":"]}),e.jsx("div",{className:"space-y-2",children:t.sources.map((s,o)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:s})]},o))})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-4 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{await g(),m(!1)},className:`flex-1 px-4 py-3 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors ${t.stashed?"bg-green-100 text-green-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[e.jsx(K,{className:"h-5 w-5"}),t.stashed?n("feed.stashed"):n("feed.stash")]}),e.jsx("button",{onClick:async()=>{await L(),m(!1)},disabled:c,className:`flex-1 px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium text-sm flex items-center justify-center gap-2 ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n("quiz.generating")]}):e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"h-5 w-5"}),n("feed.quiz")]})}),e.jsx("button",{onClick:async()=>{await w(),m(!1)},className:"px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium text-sm flex items-center justify-center gap-2",children:e.jsx(W,{className:"h-5 w-5"})})]})]})}),I&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>h(!1),children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Share Article"}),e.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:t.title}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:A,className:"w-full px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(O,{className:"h-5 w-5"}),"Copy Link"]}),e.jsxs("button",{onClick:d,className:"w-full px-4 py-3 bg-[#1DA1F2] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]}),e.jsxs("button",{onClick:v,className:"w-full px-4 py-3 bg-[#FF4500] hover:bg-[#e03d00] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:B,className:"w-full px-4 py-3 bg-[#1877F2] hover:bg-[#166fe5] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:u,className:"w-full px-4 py-3 bg-[#0085ff] hover:bg-[#0073e6] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:D,className:"w-full px-4 py-3 bg-[#B92B27] hover:bg-[#a02522] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),e.jsxs("button",{onClick:j,className:"w-full px-4 py-3 bg-[#EA4335] hover:bg-[#d33426] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]})})})]})}function Se(t){return{title:t.title,questions:t.questions.map(n=>({id:n.id,prompt:n.prompt,choices:n.choices,answerId:n.correctChoiceId,explanation:n.explanation}))}}function Ie({quiz:t,onClose:n}){const y=Se(t);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsx(ue,{quiz:y,onClose:n,onComplete:(x,N)=>{console.log(`Feed quiz completed: ${x}/${N}`)}})})})}function $e({availableTags:t,selectedTags:n,onChange:y,placeholder:x="Select tags...",className:N=""}){const b=a=>{n.includes(a)?y(n.filter(S=>S!==a)):y([...n,a])},k=()=>{y([])};return e.jsxs("div",{className:`space-y-2 ${N}`,children:[n.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-md",children:[n.map(a=>e.jsxs("button",{onClick:()=>b(a),className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors",children:[a,e.jsx(V,{className:"w-3 h-3"})]},a)),e.jsx("button",{onClick:k,className:"px-2 py-1 text-xs font-medium text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 underline",children:"Clear all"})]}),e.jsx("div",{className:"relative",children:e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"cursor-pointer list-none px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:n.length===0?x:`${n.length} tag(s) selected`})}),e.jsx("div",{className:"absolute z-10 mt-1 w-full max-h-60 overflow-auto bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-lg",children:t.length===0?e.jsx("div",{className:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400",children:"No tags available"}):e.jsx("div",{className:"py-1",children:t.map(a=>e.jsx("button",{onClick:()=>b(a),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${n.includes(a)?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 font-medium":"text-gray-700 dark:text-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:a}),n.includes(a)&&e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})},a))})})]})})]})}function Le(){const{t}=te(),{isAuthenticated:n}=ie(),{getAllTags:y,snippets:x}=ne(),{getCurrentProjectId:N}=de(),[b,k]=l.useState(""),{items:a,preferences:S,currentQuiz:R,isLoading:c,isGenerating:i,generationStatus:z,error:m,selectedTags:I,generateMore:h,refresh:T,closeQuiz:E,updateSelectedTags:_,updateSearchTerms:$}=se(),p=l.useRef(null),C=l.useRef(null),M=l.useRef(null),r=l.useRef(i),g=l.useRef(c),w=l.useRef(h);l.useEffect(()=>{r.current=i,g.current=c,w.current=h},[i,c,h]),l.useEffect(()=>{console.log("ðŸŽ¯ FeedPage: items changed:",a.length,"items"),console.log("ðŸŽ¯ Item titles:",a.map(u=>u.title)),console.log("ðŸŽ¯ Item IDs:",a.map(u=>u.id))},[a]),l.useEffect(()=>{if(!(!M.current||!n))return C.current&&C.current.disconnect(),C.current=new IntersectionObserver(u=>{const[d]=u;console.log("ðŸ‘ï¸ IntersectionObserver fired:",{isIntersecting:d.isIntersecting,itemsLength:a.length,snippetsLength:x.length});const v=x.some(G=>G.tags&&G.tags.some(s=>!s.startsWith("admin:"))),D=a.length>0||v,j=g.current,A=r.current,Q=w.current;console.log("ðŸ” Infinite scroll check:",{isIntersecting:d.isIntersecting,currentIsLoading:j,currentIsGenerating:A,shouldAllowInfiniteScroll:D,hasSnippetTags:v,itemsLength:a.length}),d.isIntersecting&&!j&&!A&&D?(console.log("ðŸ“œ Infinite scroll triggered - generating more items..."),Q()):d.isIntersecting&&!D?console.log("ðŸ“œ Infinite scroll blocked: no items and no snippet tags"):d.isIntersecting&&(j||A)&&console.log("ðŸ“œ Infinite scroll blocked: already generating/loading")},{root:null,rootMargin:"200px",threshold:.1}),C.current.observe(M.current),()=>{C.current&&C.current.disconnect()}},[n]);const L=l.useRef(!1);l.useEffect(()=>{if(c){console.log("ðŸŽ¬ Initial load effect: still loading, skipping...");return}if(L.current)return;const u=N();console.log("ðŸŽ¬ Initial load effect triggered:",{isAuthenticated:n,itemsLength:a.length,initialLoadAttempted:L.current,isLoading:c,isGenerating:i,snippetsCount:x.length,currentProjectId:u||"All Projects"});const d=x.filter(j=>j.tags&&j.tags.some(A=>!A.startsWith("admin:"))),v=d.length>0;console.log("ðŸ·ï¸ Total snippets:",x.length),console.log("ðŸ·ï¸ Snippets with non-admin tags:",d.length),d.length>0&&d.length<=5&&console.log("ðŸ·ï¸ Sample snippets with tags:",d.slice(0,5).map(j=>({id:j.id,title:j.title,tags:j.tags?.filter(A=>!A.startsWith("admin:")),projectId:j.projectId||"none"}))),console.log("ðŸ·ï¸ Has snippet tags:",v);const D=v;n&&a.length===0&&D?(console.log("ðŸŽ¬ Initial load: starting feed generation (user has snippet tags in current project)"),L.current=!0,h()):(console.log("â¸ï¸ Initial load: skipping auto-generation",{isAuthenticated:n,hasItems:a.length>0,hasSnippetTags:v,snippetCount:x.length,reason:v?"Already has items or not authenticated":"No snippet tags in current project - show interests input"}),L.current=!0)},[n,a.length,c,x,S.searchTerms.length]);const q=l.useCallback(async()=>{await T(),await h()},[T,h]),U=l.useCallback(async()=>{console.log("ðŸ“± Generate Feed button clicked"),console.log("ðŸ” generateMore function exists:",!!h),console.log("ðŸ” generateMore type:",typeof h);try{console.log("ðŸš€ About to call generateMore()..."),await h(),console.log("âœ… generateMore() completed")}catch(u){console.error("âŒ Generate failed:",u)}},[h]);console.log("ðŸŽ¨ FeedPage render:",{isAuthenticated:n,isLoading:c,isGenerating:i,itemsCount:a.length,hasError:!!m});const B=!x.some(u=>u.tags&&u.tags.some(d=>!d.startsWith("admin:")))&&a.length===0&&!i;return n?e.jsxs("div",{ref:p,className:"bg-gray-50 pb-20",style:{minHeight:"100vh"},children:[e.jsx("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{className:"h-6 w-6 text-blue-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("feed.title")})]}),e.jsx("button",{onClick:q,disabled:c||i,className:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:t("feed.refresh"),children:e.jsx(he,{className:`h-5 w-5 text-gray-600 ${c||i?"animate-spin":""}`})})]}),(()=>{const u=!B;return e.jsxs(e.Fragment,{children:[u&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600 uppercase tracking-wide",children:"Filter by Swag Tags"}),e.jsx($e,{availableTags:y(),selectedTags:I,onChange:_,placeholder:"All tags (no filter)"}),I.length>0&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Feed will use only Swag content tagged with: ",e.jsx("span",{className:"font-medium",children:I.join(", ")})]})]}),B&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"What are your interests?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:b,onChange:d=>k(d.target.value),onKeyDown:async d=>{if(d.key==="Enter"&&b.trim()&&!i){const v=[b.trim()];await $(v),k(""),await h(v)}},placeholder:"e.g., artificial intelligence, space exploration, history...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),e.jsx("button",{onClick:async()=>{if(b.trim()&&!i){const d=[b.trim()];await $(d),k(""),await h(d)}},disabled:!b.trim()||i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Generate"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Add some interests to start generating your personalized feed. You can also add Swag content with tags to automatically generate based on your saved knowledge."})]})]})})()]})}),m&&e.jsx("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(me,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-900 mb-1",children:t("errors.error")}),e.jsx("p",{className:"text-sm text-red-700",children:m})]})]})}),(!B||i)&&e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4 space-y-4",children:[a.map((u,d)=>(console.log(`ðŸŽ´ Rendering FeedItemCard ${d+1}/${a.length}:`,u.id,u.title),e.jsx(Ce,{item:u},u.id))),a.length===0&&!c&&!i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(P,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t("feed.noItems")}),e.jsxs("p",{className:"text-gray-600 mb-6",children:[t("feed.emptyMessage"),e.jsx("br",{}),t("feed.emptySubMessage")]}),e.jsx("button",{onClick:U,disabled:i,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium",children:t(i?"feed.generating":"feed.generateFeed")})]}),(c||i)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(we,{className:"h-8 w-8 text-blue-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:t(i?"feed.generating":"common.loading")}),z&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 animate-pulse",children:z})]})]})]}),a.length>2&&e.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:["â†“ Scroll down to see more items (",a.length," total) â†“"]}),e.jsx("div",{ref:M,className:"h-4"}),R&&e.jsx(Ie,{quiz:R,onClose:E})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md text-center",children:[e.jsx(P,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t("feed.title")}),e.jsx("p",{className:"text-gray-600 mb-4",children:t("feed.emptyMessage")}),e.jsx("p",{className:"text-sm text-gray-500",children:t("common.pleaseSignIn")})]})})}export{Le as default};

import{c as X,r as L,j as r,b9 as fe,bg as ie}from"./index-Drh4wbhL.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ge=X("circle-check",ke);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],pe=X("circle-x",Ie);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Pe=X("rotate-ccw",Ee);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],De=X("trophy",qe);var ce={};(function E(a,o,c,w){var n=!!(a.Worker&&a.Blob&&a.Promise&&a.OffscreenCanvas&&a.OffscreenCanvasRenderingContext2D&&a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype.transferControlToOffscreen&&a.URL&&a.URL.createObjectURL),u=typeof Path2D=="function"&&typeof DOMMatrix=="function",f=(function(){if(!a.OffscreenCanvas)return!1;try{var t=new OffscreenCanvas(1,1),e=t.getContext("2d");e.fillRect(0,0,1,1);var s=t.transferToImageBitmap();e.createPattern(s,"no-repeat")}catch{return!1}return!0})();function b(){}function g(t){var e=o.exports.Promise,s=e!==void 0?e:a.Promise;return typeof s=="function"?new s(t):(t(b,b),null)}var S=(function(t,e){return{transform:function(s){if(t)return s;if(e.has(s))return e.get(s);var l=new OffscreenCanvas(s.width,s.height),h=l.getContext("2d");return h.drawImage(s,0,0),e.set(s,l),l},clear:function(){e.clear()}}})(f,new Map),y=(function(){var t=Math.floor(16.666666666666668),e,s,l={},h=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(m){var p=Math.random();return l[p]=requestAnimationFrame(function i(x){h===x||h+t-1<x?(h=x,delete l[p],m()):l[p]=requestAnimationFrame(i)}),p},s=function(m){l[m]&&cancelAnimationFrame(l[m])}):(e=function(m){return setTimeout(m,t)},s=function(m){return clearTimeout(m)}),{frame:e,cancel:s}})(),q=(function(){var t,e,s={};function l(h){function m(p,i){h.postMessage({options:p||{},callback:i})}h.init=function(i){var x=i.transferControlToOffscreen();h.postMessage({canvas:x},[x])},h.fire=function(i,x,M){if(e)return m(i,null),e;var C=Math.random().toString(36).slice(2);return e=g(function(N){function T(P){P.data.callback===C&&(delete s[C],h.removeEventListener("message",T),e=null,S.clear(),M(),N())}h.addEventListener("message",T),m(i,C),s[C]=T.bind(null,{data:{callback:C}})}),e},h.reset=function(){h.postMessage({reset:!0});for(var i in s)s[i](),delete s[i]}}return function(){if(t)return t;if(!c&&n){var h=["var CONFETTI, SIZE = {}, module = {};","("+E.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{t=new Worker(URL.createObjectURL(new Blob([h])))}catch(m){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",m),null}l(t)}return t}})(),A={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function B(t,e){return e?e(t):t}function k(t){return t!=null}function d(t,e,s){return B(t&&k(t[e])?t[e]:A[e],s)}function Y(t){return t<0?0:Math.floor(t)}function K(t,e){return Math.floor(Math.random()*(e-t))+t}function G(t){return parseInt(t,16)}function J(t){return t.map(ee)}function ee(t){var e=String(t).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:G(e.substring(0,2)),g:G(e.substring(2,4)),b:G(e.substring(4,6))}}function te(t){var e=d(t,"origin",Object);return e.x=d(e,"x",Number),e.y=d(e,"y",Number),e}function re(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function j(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function I(t){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=t,e}function R(t,e,s,l,h,m,p,i,x){t.save(),t.translate(e,s),t.rotate(m),t.scale(l,h),t.arc(0,0,1,p,i,x),t.restore()}function O(t){var e=t.angle*(Math.PI/180),s=t.spread*(Math.PI/180);return{x:t.x,y:t.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:t.startVelocity*.5+Math.random()*t.startVelocity,angle2D:-e+(.5*s-Math.random()*s),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:t.color,shape:t.shape,tick:0,totalTicks:t.ticks,decay:t.decay,drift:t.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:t.gravity*3,ovalScalar:.6,scalar:t.scalar,flat:t.flat}}function ae(t,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var s=e.tick++/e.totalTicks,l=e.x+e.random*e.tiltCos,h=e.y+e.random*e.tiltSin,m=e.wobbleX+e.random*e.tiltCos,p=e.wobbleY+e.random*e.tiltSin;if(t.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-s)+")",t.beginPath(),u&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))t.fill(xe(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(m-l)*.1,Math.abs(p-h)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var i=Math.PI/10*e.wobble,x=Math.abs(m-l)*.1,M=Math.abs(p-h)*.1,C=e.shape.bitmap.width*e.scalar,N=e.shape.bitmap.height*e.scalar,T=new DOMMatrix([Math.cos(i)*x,Math.sin(i)*x,-Math.sin(i)*M,Math.cos(i)*M,e.x,e.y]);T.multiplySelf(new DOMMatrix(e.shape.matrix));var P=t.createPattern(S.transform(e.shape.bitmap),"no-repeat");P.setTransform(T),t.globalAlpha=1-s,t.fillStyle=P,t.fillRect(e.x-C/2,e.y-N/2,C,N),t.globalAlpha=1}else if(e.shape==="circle")t.ellipse?t.ellipse(e.x,e.y,Math.abs(m-l)*e.ovalScalar,Math.abs(p-h)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):R(t,e.x,e.y,Math.abs(m-l)*e.ovalScalar,Math.abs(p-h)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var v=Math.PI/2*3,D=4*e.scalar,z=8*e.scalar,F=e.x,_=e.y,U=5,Q=Math.PI/U;U--;)F=e.x+Math.cos(v)*z,_=e.y+Math.sin(v)*z,t.lineTo(F,_),v+=Q,F=e.x+Math.cos(v)*D,_=e.y+Math.sin(v)*D,t.lineTo(F,_),v+=Q;else t.moveTo(Math.floor(e.x),Math.floor(e.y)),t.lineTo(Math.floor(e.wobbleX),Math.floor(h)),t.lineTo(Math.floor(m),Math.floor(p)),t.lineTo(Math.floor(l),Math.floor(e.wobbleY));return t.closePath(),t.fill(),e.tick<e.totalTicks}function ne(t,e,s,l,h){var m=e.slice(),p=t.getContext("2d"),i,x,M=g(function(C){function N(){i=x=null,p.clearRect(0,0,l.width,l.height),S.clear(),h(),C()}function T(){c&&!(l.width===w.width&&l.height===w.height)&&(l.width=t.width=w.width,l.height=t.height=w.height),!l.width&&!l.height&&(s(t),l.width=t.width,l.height=t.height),p.clearRect(0,0,l.width,l.height),m=m.filter(function(P){return ae(p,P)}),m.length?i=y.frame(T):N()}i=y.frame(T),x=N});return{addFettis:function(C){return m=m.concat(C),M},canvas:t,promise:M,reset:function(){i&&y.cancel(i),x&&x()}}}function Z(t,e){var s=!t,l=!!d(e||{},"resize"),h=!1,m=d(e,"disableForReducedMotion",Boolean),p=n&&!!d(e||{},"useWorker"),i=p?q():null,x=s?re:j,M=t&&i?!!t.__confetti_initialized:!1,C=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,N;function T(v,D,z){for(var F=d(v,"particleCount",Y),_=d(v,"angle",Number),U=d(v,"spread",Number),Q=d(v,"startVelocity",Number),we=d(v,"decay",Number),ye=d(v,"gravity",Number),Se=d(v,"drift",Number),de=d(v,"colors",J),Me=d(v,"ticks",Number),ue=d(v,"shapes"),je=d(v,"scalar"),Ne=!!d(v,"flat"),he=te(v),me=F,oe=[],Ce=t.width*he.x,Te=t.height*he.y;me--;)oe.push(O({x:Ce,y:Te,angle:_,spread:U,startVelocity:Q,color:de[me%de.length],shape:ue[K(0,ue.length)],ticks:Me,decay:we,gravity:ye,drift:Se,scalar:je,flat:Ne}));return N?N.addFettis(oe):(N=ne(t,oe,x,D,z),N.promise)}function P(v){var D=m||d(v,"disableForReducedMotion",Boolean),z=d(v,"zIndex",Number);if(D&&C)return g(function(Q){Q()});s&&N?t=N.canvas:s&&!t&&(t=I(z),document.body.appendChild(t)),l&&!M&&x(t);var F={width:t.width,height:t.height};i&&!M&&i.init(t),M=!0,i&&(t.__confetti_initialized=!0);function _(){if(i){var Q={getBoundingClientRect:function(){if(!s)return t.getBoundingClientRect()}};x(Q),i.postMessage({resize:{width:Q.width,height:Q.height}});return}F.width=F.height=null}function U(){N=null,l&&(h=!1,a.removeEventListener("resize",_)),s&&t&&(document.body.contains(t)&&document.body.removeChild(t),t=null,M=!1)}return l&&!h&&(h=!0,a.addEventListener("resize",_,!1)),i?i.fire(v,F,U):T(v,F,U)}return P.reset=function(){i&&i.reset(),N&&N.reset()},P}var se;function le(){return se||(se=Z(null,{useWorker:!0,resize:!0})),se}function xe(t,e,s,l,h,m,p){var i=new Path2D(t),x=new Path2D;x.addPath(i,new DOMMatrix(e));var M=new Path2D;return M.addPath(x,new DOMMatrix([Math.cos(p)*h,Math.sin(p)*h,-Math.sin(p)*m,Math.cos(p)*m,s,l])),M}function be(t){if(!u)throw new Error("path confetti are not supported in this browser");var e,s;typeof t=="string"?e=t:(e=t.path,s=t.matrix);var l=new Path2D(e),h=document.createElement("canvas"),m=h.getContext("2d");if(!s){for(var p=1e3,i=p,x=p,M=0,C=0,N,T,P=0;P<p;P+=2)for(var v=0;v<p;v+=2)m.isPointInPath(l,P,v,"nonzero")&&(i=Math.min(i,P),x=Math.min(x,v),M=Math.max(M,P),C=Math.max(C,v));N=M-i,T=C-x;var D=10,z=Math.min(D/N,D/T);s=[z,0,0,z,-Math.round(N/2+i)*z,-Math.round(T/2+x)*z]}return{type:"path",path:e,matrix:s}}function ve(t){var e,s=1,l="#000000",h='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof t=="string"?e=t:(e=t.text,s="scalar"in t?t.scalar:s,h="fontFamily"in t?t.fontFamily:h,l="color"in t?t.color:l);var m=10*s,p=""+m+"px "+h,i=new OffscreenCanvas(m,m),x=i.getContext("2d");x.font=p;var M=x.measureText(e),C=Math.ceil(M.actualBoundingBoxRight+M.actualBoundingBoxLeft),N=Math.ceil(M.actualBoundingBoxAscent+M.actualBoundingBoxDescent),T=2,P=M.actualBoundingBoxLeft+T,v=M.actualBoundingBoxAscent+T;C+=T+T,N+=T+T,i=new OffscreenCanvas(C,N),x=i.getContext("2d"),x.font=p,x.fillStyle=l,x.fillText(e,P,v);var D=1/s;return{type:"bitmap",bitmap:i.transferToImageBitmap(),matrix:[D,0,0,D,-C*D/2,-N*D/2]}}o.exports=function(){return le().apply(this,arguments)},o.exports.reset=function(){le().reset()},o.exports.create=Z,o.exports.shapeFromPath=be,o.exports.shapeFromText=ve})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),ce,!1);const Ae=ce.exports;ce.exports.create;const Re="quiz_analytics",ze=1,$="quizResults",W="topicPerformance",V="achievements",H="studyStreak";class Fe{db=null;initPromise=null;async init(){return this.initPromise?this.initPromise:(this.initPromise=new Promise((a,o)=>{if(!window.indexedDB){console.warn("IndexedDB not supported"),o(new Error("IndexedDB not supported"));return}const c=indexedDB.open(Re,ze);c.onerror=()=>{console.error("Failed to open quiz analytics database:",c.error),o(c.error)},c.onsuccess=()=>{this.db=c.result,console.log("âœ… Quiz analytics database initialized"),a()},c.onupgradeneeded=w=>{const n=w.target.result;if(!n.objectStoreNames.contains($)){const u=n.createObjectStore($,{keyPath:"id"});u.createIndex("timestamp","timestamp",{unique:!1}),u.createIndex("sourceSnippetId","sourceSnippetId",{unique:!1}),u.createIndex("sourceFeedItemId","sourceFeedItemId",{unique:!1}),u.createIndex("topics","topics",{unique:!1,multiEntry:!0}),u.createIndex("synced","synced",{unique:!1}),console.log("âœ… Quiz results store created")}if(!n.objectStoreNames.contains(W)){const u=n.createObjectStore(W,{keyPath:"topic"});u.createIndex("lastQuizDate","lastQuizDate",{unique:!1}),u.createIndex("averageScore","averageScore",{unique:!1}),console.log("âœ… Topic performance store created")}n.objectStoreNames.contains(V)||(n.createObjectStore(V,{keyPath:"id"}).createIndex("unlocked","unlocked",{unique:!1}),console.log("âœ… Achievements store created")),n.objectStoreNames.contains(H)||(n.createObjectStore(H,{keyPath:"id"}),console.log("âœ… Study streak store created"))}}),this.initPromise)}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const o=Math.random()*16|0;return(a==="x"?o:o&3|8).toString(16)})}getMidnightUTC(a){const o=new Date(a);return o.setUTCHours(0,0,0,0),o.getTime()}extractTopics(a,o){const c=new Set,w=["machine learning","ai","artificial intelligence","deep learning","python","javascript","typescript","java","c++","sql","react","angular","vue","node","express","aws","azure","cloud","docker","kubernetes","database","api","rest","graphql","algorithms","data structures","security","testing","frontend","backend","fullstack","devops"],n=(a+" "+o.map(u=>u.questionText).join(" ")).toLowerCase();for(const u of w)if(n.includes(u)){const f=u.split(" ").map(b=>b.charAt(0).toUpperCase()+b.slice(1)).join(" ");c.add(f)}return c.size===0&&c.add("General Knowledge"),Array.from(c)}calculateTrend(a,o){const c=a.filter(S=>S.topics.includes(o)).sort((S,y)=>S.timestamp-y.timestamp);if(c.length<3)return"stable";const w=Math.floor(c.length*2/3),n=c.slice(0,w),u=c.slice(w),f=n.reduce((S,y)=>S+y.score,0)/n.length,g=u.reduce((S,y)=>S+y.score,0)/u.length-f;return g>5?"improving":g<-5?"declining":"stable"}async updateStreak(a){if(await this.init(),!this.db)throw new Error("Database not initialized");const o=this.getMidnightUTC(a);return new Promise((c,w)=>{const u=this.db.transaction([H],"readwrite").objectStore(H),f=u.get(1);f.onsuccess=()=>{let b=f.result||{id:1,currentStreak:0,longestStreak:0,lastQuizDate:0,streakDates:[]};b.streakDates.includes(o)||(b.streakDates.push(o),b.streakDates.sort((q,A)=>q-A));let g=0;const S=[...b.streakDates].sort((q,A)=>A-q);for(let q=0;q<S.length;q++){const A=o-q*24*60*60*1e3;if(S[q]===A)g++;else break}b.currentStreak=g,b.longestStreak=Math.max(b.longestStreak,g),b.lastQuizDate=o;const y=u.put(b);y.onsuccess=()=>{console.log(`âœ… Streak updated: ${g} days`),c()},y.onerror=()=>w(y.error)},f.onerror=()=>w(f.error)})}async updateTopicPerformance(a){if(await this.init(),!this.db)throw new Error("Database not initialized");const o=await this.getQuizResults();return new Promise((c,w)=>{const u=this.db.transaction([W],"readwrite").objectStore(W);let f=0,b=!1;for(const g of a.topics){const S=u.get(g);S.onsuccess=()=>{const y=o.filter(k=>k.topics.includes(g)),q=y.flatMap(k=>k.questionStats.filter(d=>d.topic===g||k.topics.includes(g))),A={topic:g,quizzesTaken:y.length,questionsSeen:q.length,questionsCorrect:q.filter(k=>k.correct).length,averageScore:y.length>0?y.reduce((k,d)=>k+d.score,0)/y.length:0,bestScore:y.length>0?Math.max(...y.map(k=>k.score)):0,worstScore:y.length>0?Math.min(...y.map(k=>k.score)):0,lastQuizDate:a.timestamp,totalTimeSpent:y.reduce((k,d)=>k+d.timeSpent,0),trend:this.calculateTrend(o,g)},B=u.put(A);B.onsuccess=()=>{f++,f===a.topics.length&&!b&&c()},B.onerror=()=>{b||(b=!0,w(B.error))}},S.onerror=()=>{b||(b=!0,w(S.error))}}})}async saveQuizResult(a){if(await this.init(),!this.db)throw new Error("Database not initialized");const o=this.generateUUID(),c=this.extractTopics(a.title,a.questionStats),w=a.questionStats.map(u=>({...u,topic:c[0]})),n={...a,id:o,topics:c,questionStats:w,synced:!1};return new Promise((u,f)=>{const S=this.db.transaction([$],"readwrite").objectStore($).add(n);S.onsuccess=async()=>{console.log("âœ… Quiz analytics saved:",o),await this.updateTopicPerformance(n),await this.updateStreak(n.timestamp),u(o)},S.onerror=()=>{console.error("Failed to save quiz analytics:",S.error),f(S.error)}})}async getQuizResults(a){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((o,c)=>{const f=this.db.transaction([$],"readonly").objectStore($).index("timestamp").openCursor(null,"prev"),b=[];f.onsuccess=()=>{const g=f.result;g&&(!a||b.length<a)?(b.push(g.value),g.continue()):o(b)},f.onerror=()=>c(f.error)})}async getTopicPerformance(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((a,o)=>{const n=this.db.transaction([W],"readonly").objectStore(W).getAll();n.onsuccess=()=>a(n.result),n.onerror=()=>o(n.error)})}async getStudyStreak(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((a,o)=>{const n=this.db.transaction([H],"readonly").objectStore(H).get(1);n.onsuccess=()=>a(n.result||null),n.onerror=()=>o(n.error)})}async getAchievements(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((a,o)=>{const n=this.db.transaction([V],"readonly").objectStore(V).getAll();n.onsuccess=()=>a(n.result),n.onerror=()=>o(n.error)})}async saveAchievements(a){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((o,c)=>{const n=this.db.transaction([V],"readwrite").objectStore(V);let u=0,f=!1;for(const b of a){const g=n.put(b);g.onsuccess=()=>{u++,u===a.length&&!f&&o()},g.onerror=()=>{f||(f=!0,c(g.error))}}a.length===0&&o()})}async clearAllData(){if(await this.init(),!this.db)throw new Error("Database not initialized");const a=[$,W,V,H];for(const o of a)await new Promise((c,w)=>{const f=this.db.transaction([o],"readwrite").objectStore(o).clear();f.onsuccess=()=>c(),f.onerror=()=>w(f.error)});console.log("âœ… All quiz analytics data cleared")}async exportToCSV(){const a=await this.getQuizResults(),o=["Quiz ID","Timestamp","Title","Topics","Total Questions","Correct Answers","Score (%)","Time Spent (s)","Start Time","End Time"],c=a.map(n=>[n.id,new Date(n.timestamp).toISOString(),n.title,n.topics.join("; "),n.totalQuestions.toString(),n.correctAnswers.toString(),n.score.toString(),Math.round(n.timeSpent/1e3).toString(),new Date(n.startTime).toISOString(),new Date(n.endTime).toISOString()]);return[o,...c].map(n=>n.map(u=>`"${u}"`).join(",")).join(`
`)}}const Oe=new Fe,Be=({quiz:E,onClose:a,onComplete:o})=>{const[c,w]=L.useState(0),[n,u]=L.useState(null),[f,b]=L.useState("question"),[g,S]=L.useState(0),[y,q]=L.useState([]),A=L.useRef(Date.now()),B=L.useRef(Date.now()),k=L.useRef([]),d=E.questions[c],Y=c+1,K=E.questions.length;if(L.useEffect(()=>{B.current=Date.now()},[c]),!d||!E.questions||E.questions.length===0)return r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(fe,{className:"w-6 h-6 text-blue-600 animate-pulse"}),r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:E.title})]}),r.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:r.jsx(ie,{className:"w-5 h-5 text-gray-600"})})]}),r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Generating quiz questions..."})]})]});const G=j=>{if(f!=="question")return;u(j);const I=j===d.answerId;I&&S(g+1);const R={questionId:d.id,questionPrompt:d.prompt,selectedChoiceId:j,correctChoiceId:d.answerId,correct:I,explanation:d.explanation||""};q([...y,R]);const O=Date.now()-B.current,ae=d.choices.find(Z=>Z.id===j),ne=d.choices.find(Z=>Z.id===d.answerId);k.current.push({questionId:d.id,questionText:d.prompt,correct:I,timeSpent:O,attempts:1,selectedAnswer:ae?.text||"",correctAnswer:ne?.text||""}),b("answered")},J=async()=>{if(c<E.questions.length-1)w(c+1),u(null),b("question");else{b("completed");const j=Date.now(),I=j-A.current;try{await Oe.saveQuizResult({timestamp:j,title:E.title,totalQuestions:E.questions.length,correctAnswers:g,score:Math.round(g/E.questions.length*100),timeSpent:I,startTime:A.current,endTime:j,questionStats:k.current}),console.log("âœ… Quiz analytics saved")}catch(O){console.error("Failed to save quiz analytics:",O)}g/E.questions.length*100>=70&&Ae({particleCount:100,spread:70,origin:{y:.6}}),o&&o(g,E.questions.length,y)}},ee=()=>{w(0),u(null),b("question"),S(0),q([]),A.current=Date.now(),B.current=Date.now(),k.current=[]},te=j=>{const I="w-full p-4 text-left rounded-lg border-2 transition-all duration-200";if(f==="question")return`${I} border-gray-300 hover:border-blue-400 hover:bg-blue-50 cursor-pointer`;const R=n===j.id,O=j.id===d.answerId;return O?`${I} border-green-500 bg-green-50 text-green-900`:R&&!O?`${I} border-red-500 bg-red-50 text-red-900`:`${I} border-gray-300 bg-gray-50 text-gray-500 cursor-not-allowed`},re=j=>{if(f==="question")return null;const I=n===j.id,R=j.id===d.answerId;return R?r.jsx(ge,{className:"w-5 h-5 text-green-600"}):I&&!R?r.jsx(pe,{className:"w-5 h-5 text-red-600"}):null};if(f==="completed"){const j=Math.round(g/E.questions.length*100),I=j>=70;return r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(De,{className:`w-8 h-8 ${I?"text-yellow-500":"text-gray-400"}`}),r.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Quiz Complete!"})]}),r.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:r.jsx(ie,{className:"w-5 h-5 text-gray-600"})})]}),r.jsxs("div",{className:"text-center mb-8",children:[r.jsxs("div",{className:`text-6xl font-bold mb-2 ${I?"text-green-600":"text-orange-600"}`,children:[j,"%"]}),r.jsxs("div",{className:"text-xl text-gray-600 mb-4",children:[g," out of ",E.questions.length," correct"]}),r.jsx("div",{className:`text-lg font-semibold ${I?"text-green-600":"text-orange-600"}`,children:I?"ðŸŽ‰ Great job!":"ðŸ’ª Keep practicing!"})]}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Review"}),r.jsx("div",{className:"space-y-2",children:y.map((R,O)=>r.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${R.correct?"bg-green-50":"bg-red-50"}`,children:[R.correct?r.jsx(ge,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):r.jsx(pe,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),r.jsxs("span",{className:"text-sm text-gray-700",children:["Question ",O+1]})]},R.questionId))})]}),r.jsxs("div",{className:"flex gap-3",children:[r.jsxs("button",{onClick:ee,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[r.jsx(Pe,{className:"w-4 h-4"}),"Retake Quiz"]}),r.jsx("button",{onClick:a,className:"flex-1 py-3 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Close"})]})]})}return r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[r.jsxs("div",{className:"flex justify-between items-start mb-6",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[r.jsx(fe,{className:"w-6 h-6 text-blue-600"}),r.jsx("h2",{className:"text-xl font-bold text-gray-800",children:E.title})]}),r.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[r.jsxs("span",{className:"font-medium",children:["Question ",Y," of ",K]}),r.jsxs("span",{children:["Score: ",g,"/",K]})]})]}),r.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:r.jsx(ie,{className:"w-5 h-5 text-gray-600"})})]}),r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${Y/K*100}%`}})})}),r.jsxs("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:d.prompt}),r.jsx("div",{className:"space-y-3",children:d.choices.map(j=>r.jsx("button",{onClick:()=>G(j.id),disabled:f!=="question",className:te(j),children:r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsx("span",{className:"flex-1 text-left",children:j.text}),re(j)]})},j.id))})]}),f==="answered"&&d.explanation&&r.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded",children:[r.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Explanation"}),r.jsx("p",{className:"text-blue-800 text-sm",children:d.explanation})]}),r.jsxs("div",{className:"flex gap-3",children:[f==="answered"&&r.jsx("button",{onClick:J,className:"flex-1 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:c<E.questions.length-1?"Next Question â†’":"Finish Quiz"}),r.jsx("button",{onClick:a,className:"py-3 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Quit"})]})]})};export{Be as Q,De as T};

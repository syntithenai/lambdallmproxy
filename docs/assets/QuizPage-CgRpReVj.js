import{c as W,r as n,j as e,b7 as ae,u as ie,aH as ne,b8 as oe,a as le,b9 as ce,ba as de,bb as ue,q as f,bc as N,bd as xe,be as ge,bf as he}from"./index-h-5_Q0aY.js";import{T as V,Q as me}from"./QuizCard-Cevj6pNT.js";import{s as pe}from"./quizSync-Bi52iRep.js";import{c as be,a as ye}from"./quizShareUtils-DsXwyzmi.js";import{C as we}from"./calendar-DV_yrM4C.js";import{C as fe}from"./clock-Du5xxtMl.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ve=W("arrow-left",je);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ze=W("trending-up",ke),Ne=({quiz:d,onClose:s,enrichment:b,sharedBy:h})=>{const[o,q]=n.useState(""),[S,v]=n.useState(!1),[Q,c]=n.useState(!0);n.useEffect(()=>{try{const i=be(d,{sharedBy:h,enrichment:b}),y=ye(i);q(y)}catch(i){console.error("Failed to generate quiz share URL:",i)}finally{c(!1)}},[d,h,b]);const k=async()=>{try{await navigator.clipboard.writeText(o),v(!0),setTimeout(()=>v(!1),2e3)}catch(i){console.error("Failed to copy to clipboard:",i)}},M=()=>{const i=`Test your knowledge: ${d.title}`,y=`https://twitter.com/intent/tweet?text=${encodeURIComponent(i)}&url=${encodeURIComponent(o)}`;window.open(y,"_blank")},C=()=>{const i=`https://reddit.com/submit?url=${encodeURIComponent(o)}&title=${encodeURIComponent(d.title)}`;window.open(i,"_blank")},p=()=>{const i=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(o)}`;window.open(i,"_blank")},R=()=>{const i=encodeURIComponent(`Quiz: ${d.title}`),y=encodeURIComponent(`Test your knowledge with this quiz:

${o}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${i}&body=${y}`,"_blank")},F=()=>{const i=encodeURIComponent(`Test your knowledge: ${d.title}

${o}`);window.open(`https://bsky.app/intent/compose?text=${i}`,"_blank")},I=()=>{const i=encodeURIComponent(o);window.open(`https://www.quora.com/share?url=${i}`,"_blank")};return Q?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3",children:"Generating share link..."})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:s,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Share Quiz"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:d.title}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["ðŸ“ ",d.questions.length," question",d.questions.length!==1?"s":"",b&&" â€¢ âœ¨ AI-enriched"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Shareable URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:o,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:i=>i.currentTarget.select()}),e.jsx("button",{onClick:k,className:`px-4 py-2 rounded-md font-medium transition-colors ${S?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:S?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["URL length: ",o.length.toLocaleString()," characters"]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Scan with Mobile Device"}),o.length>2953?e.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg text-center",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium",children:"URL too long for QR code"}),e.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:'Use the "Copy" button above to share the link'})]}):e.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:e.jsx(ae,{value:o,size:200,level:"M"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:M,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),e.jsxs("button",{onClick:C,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:R,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Email"]}),e.jsxs("button",{onClick:F,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085FF] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.038.416-.054-3.912.448-6.327 1.282-6.327 3.444 0 2.162 2.556 3.06 6.524 3.06C11.395 20.061 12 24 12 24s.605-3.939 4.38-3.939c3.968 0 6.524-.898 6.524-3.06 0-2.162-2.415-2.996-6.327-3.444.14.016.28.034.416.054 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.788.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:I,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02623] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8.275 15.844a4.64 4.64 0 01-.213-.4c-.328-.666-.524-1.363-.524-2.118 0-2.647 2.08-4.907 4.826-4.907 2.746 0 4.826 2.26 4.826 4.907 0 .755-.196 1.452-.524 2.118a5.127 5.127 0 01-.213.4c.213.08.427.12.64.12 1.15 0 2.12-.87 2.72-1.882.6-1.012.86-2.144.86-3.296 0-1.192-.28-2.344-.86-3.356-.58-1.012-1.57-1.862-2.72-1.862-.213 0-.427.04-.64.12.066-.12.132-.26.213-.4.328-.666.524-1.363.524-2.118 0-2.647-2.08-4.907-4.826-4.907-2.746 0-4.826 2.26-4.826 4.907 0 .755.196 1.452.524 2.118.065.14.147.28.213.4a2.51 2.51 0 00-.64-.12c-1.15 0-2.12.87-2.72 1.882-.6 1.012-.86 2.144-.86 3.296 0 1.192.28 2.344.86 3.356.58 1.012 1.57 1.862 2.72 1.862.213 0 .427-.04.64-.12z"})}),"Quora"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[e.jsx("p",{children:"ðŸ’¡ Anyone with this URL can take the quiz"}),e.jsx("p",{children:"ðŸ”’ Quiz data is compressed and encoded in the URL (no server storage)"}),e.jsx("p",{children:"â±ï¸ Links never expire and work offline once loaded"}),e.jsx("p",{children:"ðŸ“Š Results are only stored locally (not synced back to you)"})]})]}),e.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Close"})})]})})};function Le(){const d=ie(),{t:s}=ne(),{showSuccess:b,showError:h,showWarning:o}=oe(),{getToken:q,user:S}=le(),{getCurrentProjectId:v,currentProject:Q}=ce(),{snippets:c}=de(),[k,M]=n.useState([]),C=n.useMemo(()=>{const t=Q?.id||null;return t?k.filter(a=>a.projectId===t):k.filter(a=>!a.projectId)},[k,Q]),[p,R]=n.useState(null),[F,I]=n.useState(!0),[i,y]=n.useState(0),[B,$]=n.useState(!1),[O,L]=n.useState(!1),[T,z]=n.useState(null),[w,P]=n.useState(null),[E,_]=n.useState(null);n.useEffect(()=>{u();const t=()=>{console.log("ðŸ”” Quiz saved event received, reloading statistics"),u()};return window.addEventListener("quiz-saved",t),()=>{window.removeEventListener("quiz-saved",t)}},[]),n.useEffect(()=>{if(i===0||!(()=>{const r=localStorage.getItem("google_drive_access_token"),x=localStorage.getItem("auto_sync_enabled")==="true";return r&&r.length>0&&x})())return;const a=setTimeout(async()=>{try{(await ue.syncQuizProgress()).success&&console.log("âœ… Quiz progress synced to Google Drive")}catch(r){console.error("âŒ Failed to sync quiz progress:",r)}},1e4);return()=>clearTimeout(a)},[i]),n.useEffect(()=>{const t=()=>{document.hidden||(console.log("Quiz page visible - reloading statistics"),u())};return document.addEventListener("visibilitychange",t),window.addEventListener("focus",u),()=>{document.removeEventListener("visibilitychange",t),window.removeEventListener("focus",u)}},[]);const u=async()=>{try{I(!0);const[t,a]=await Promise.all([f.getQuizStatistics(20),f.getStatisticsSummary()]);console.log("ðŸ“Š Loaded quiz statistics:",{totalQuizzes:t.length,completed:t.filter(r=>r.completed).length,incomplete:t.filter(r=>!r.completed).length,quizzes:t.map(r=>({id:r.id.substring(0,8),title:r.quizTitle,completed:r.completed,hasQuizData:!!r.quizData}))}),M(t),R(a)}catch(t){console.error("Failed to load quiz statistics:",t),h(s("quiz.errorLoadingStats"))}finally{I(!1)}},X=async(t,a)=>{if(confirm(s("quiz.confirmDelete",{title:a})))try{await f.deleteQuizStatistic(t),b(s("quiz.quizDeleted")),await u()}catch(r){console.error("Failed to delete quiz:",r),h(s("quiz.errorDeletingQuiz"))}},Y=async t=>{if(t.quizData){console.log("âœ… Using stored quiz data:",t.quizTitle),P({snippetIds:t.snippetIds,startTime:Date.now(),enrichment:t.enrichment,quizId:t.id}),z(t.quizData),L(!0);return}console.log("âš ï¸ Quiz data not available for:",t.quizTitle),h("Quiz data not available. Please generate a new quiz instead.")},J=async()=>{if(c.length===0){o("No snippets available. Please add some snippets first.");return}try{$(!0);const t=await q();if(!t){h("Authentication required. Please sign in.");return}const a=[],r=c.map(l=>`## ${l.title||"Untitled"}

${l.content}`).join(`

`);if(r.trim().length===0){o("All snippets are empty. Please add content to your snippets.");return}console.log(`ðŸŽ¯ Generating quiz from ${c.length} snippet(s), ${r.length} characters`);const x=!0,m=Date.now(),g={title:`Quiz: ${c[0]?.title||"Untitled"}${c.length>1?` +${c.length-1}`:""}`,questions:[]},j=v(),H=S?.email,D=await f.saveGeneratedQuiz(g.title,c.map(l=>l.id),0,x,g,j||void 0,H);console.log("ðŸ’¾ Placeholder quiz saved to database:",D,"projectId:",j,"userId:",H),P({snippetIds:c.map(l=>l.id),startTime:m,enrichment:x,quizId:D}),z(g),await he(r,x,a,t,(l,A,se)=>{console.log(`âœ… Question ${A+1}/${se} received:`,l.prompt),z(U=>{if(!U)return U;const G={...U,questions:[...U.questions,l]};return D&&f.updateQuizData(D,G).catch(re=>console.error("Failed to update quiz in DB:",re)),G})},async(l,A)=>{console.log(`âœ… Quiz complete: ${l} questions in ${A}ms`),b(`Quiz ready with ${l} questions!`),$(!1),await u(),L(!0)},l=>{console.error("Quiz generation error:",l),h(l),$(!1),L(!1),z(null)}),console.log("ðŸŽ¯ Streaming quiz generation started")}catch(t){console.error("Failed to generate quiz:",t),h(t instanceof Error?t.message:"Failed to generate quiz. Please try again."),$(!1)}},K=t=>{const a=Math.floor(t/6e4),r=Math.floor(t%6e4/1e3);return`${a}:${r.toString().padStart(2,"0")}`},Z=t=>{const a=new Date(t),x=new Date().getTime()-a.getTime(),m=Math.floor(x/(1e3*60*60*24));return m===0?s("quiz.today"):m===1?s("quiz.yesterday"):m<7?s("quiz.daysAgo",{days:m}):a.toLocaleDateString()},ee=t=>t>=90?"text-green-600 dark:text-green-400":t>=70?"text-blue-600 dark:text-blue-400":t>=50?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",te=t=>t>=90?"bg-green-100 dark:bg-green-900/30":t>=70?"bg-blue-100 dark:bg-blue-900/30":t>=50?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30";return F?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:s("quiz.loadingStats")})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4 pb-24",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>d("/"),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-lg transition-colors",title:s("quiz.backToChat"),children:e.jsx(ve,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-2 quiz-page-header","data-testid":"quiz-page-title",children:[e.jsx(N,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"}),s("quiz.title")]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:s("quiz.subtitle")})]})]}),e.jsxs("button",{onClick:J,disabled:B||c.length===0,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white rounded-lg transition-colors flex items-center gap-2",title:c.length===0?"No snippets available":"Generate quiz from all snippets",children:[e.jsx(N,{className:"w-5 h-5"}),B?"Generating...":s("quiz.createNewQuiz")]})]}),p&&p.totalQuizzes>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:s("quiz.totalQuizzes")}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:p.totalQuizzes})]}),e.jsx(V,{className:"w-12 h-12 text-yellow-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:s("quiz.averageScore")}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[p.averagePercentage.toFixed(0),"%"]})]}),e.jsx(ze,{className:"w-12 h-12 text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:s("quiz.highestScore")}),e.jsxs("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[p.highestScore.toFixed(0),"%"]})]}),e.jsx(V,{className:"w-12 h-12 text-green-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:s("quiz.questionsAnswered")}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:p.totalQuestionsAnswered})]}),e.jsx(N,{className:"w-12 h-12 text-indigo-500"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:s("quiz.recentQuizzes")})}),C.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(N,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:s("quiz.noQuizzesYet")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s("quiz.noQuizzesDescription")}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4 max-w-md mx-auto",children:["ðŸ’¡ ",s("quiz.quizMeHelp")]})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:C.map(t=>e.jsx("div",{className:`p-6 transition-colors cursor-pointer ${t.completed?"hover:bg-gray-50 dark:hover:bg-gray-750":"bg-yellow-50 dark:bg-yellow-900/20 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 border-l-4 border-yellow-500"}`,onClick:()=>Y(t),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.quizTitle}),t.completed?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${te(t.percentage)} ${ee(t.percentage)}`,children:[t.score,"/",t.totalQuestions," (",t.percentage,"%)"]}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded text-xs font-medium",children:s("quiz.clickToRetake")||"Click to Retake"})]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-semibold bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200",children:s("quiz.clickToRestart")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),Z(t.completedAt)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"w-4 h-4"}),K(t.timeTaken)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-4 h-4"}),s("quiz.snippetCount",{count:t.snippetIds.length})]}),t.enrichment&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded text-xs font-medium",children:s("quiz.enriched")}),!t.synced&&e.jsx("span",{className:"px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 rounded text-xs font-medium",children:s("quiz.notSynced")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.quizData&&e.jsx("button",{onClick:a=>{a.stopPropagation(),_({quiz:t.quizData,enrichment:t.enrichment||!1})},className:"p-2 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:s("quiz.shareQuiz")||"Share Quiz",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),X(t.id,t.quizTitle)},className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:s("quiz.deleteQuiz"),children:e.jsx(ge,{className:"w-5 h-5"})})]})]})},t.id))})]})]}),O&&T&&w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx(me,{quiz:{title:T.title,questions:T.questions.map(t=>({id:t.id,prompt:t.prompt,choices:t.choices,answerId:t.correctChoiceId||t.answerId,explanation:t.explanation}))},onClose:()=>{console.log("âŒ Quiz modal closed without completion"),console.log("ðŸ“ Quiz should remain in database as incomplete"),L(!1),z(null),P(null),u()},onComplete:async(t,a,r)=>{const x=Math.round(t/a*100),m=Date.now()-w.startTime;try{if(w.quizId){await f.updateQuizCompletion(w.quizId,t,m,r);const g=await q();g&&pe(w.quizId,g).then(j=>{j&&(console.log("âœ… Quiz statistic synced to Google Sheets"),u())}).catch(j=>{console.error("Failed to sync quiz statistic:",j)})}else{console.warn("No quizId found, using fallback save method");const g=v();await f.saveQuizStatistic({quizTitle:T.title,snippetIds:w.snippetIds,score:t,totalQuestions:a,timeTaken:m,completedAt:new Date().toISOString(),answers:r,enrichment:w.enrichment,completed:!0,projectId:g||void 0})}b(`Quiz completed! Score: ${t}/${a} (${x}%)`),await u(),y(Date.now())}catch(g){console.error("Failed to save quiz statistic:",g),o(`Quiz completed! Score: ${t}/${a} (${x}%) - Statistics not saved`)}}})}),E&&e.jsx(Ne,{quiz:E.quiz,enrichment:E.enrichment,onClose:()=>_(null)})]})}export{Le as default};

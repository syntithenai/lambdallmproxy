const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CaLBu1It.js","assets/index-CZRIoQTw.css"])))=>i.map(i=>d[i]);
import{c as q,r as n,aH as oe,u as de,bw as ce,ba as ie,b8 as ue,bx as Z,j as e,be as he,bc as ee,by as te,bd as K,bi as Q,bz as xe,aT as ge,l as me,a as pe,bA as J,bB as fe}from"./index-CaLBu1It.js";import{C as se}from"./calendar-eyWpFimr.js";import{Q as be}from"./QuizCard-D7Isc62N.js";import{L as ne}from"./loader-circle-BEC9dfTK.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],we=q("arrow-up",ye);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],je=q("bookmark",ve);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ke=q("circle-alert",Ne);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ae=q("external-link",Ce);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],re=q("save",Se);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],$e=q("search",Ie);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],le=q("tag",Me);function Le(t={}){const{threshold:c=100,onSwipeStart:C,onSwipeEnd:f,onSwipeProgress:k}=t,[G,F]=n.useState({direction:null,progress:0,isSwiping:!1}),S=n.useRef(0),M=n.useRef(0),g=n.useRef(0),m=n.useRef(!1),x=n.useRef(null),L=n.useCallback((l,h)=>{S.current=l,g.current=h,M.current=l,m.current=!1,F({direction:null,progress:0,isSwiping:!1}),C&&C()},[C]),d=n.useCallback((l,h)=>{if(S.current===0)return;M.current=l;const y=l-S.current,U=h-g.current;if(!m.current&&Math.abs(y)>Math.abs(U)&&Math.abs(y)>10&&(m.current=!0),m.current){const D=y>0?"right":"left",z=Math.min(Math.abs(y)/c,1);F({direction:D,progress:z,isSwiping:!0}),k&&k(z,D)}},[c,k]),u=n.useCallback(()=>{if(!m.current){S.current=0,g.current=0;return}const l=M.current-S.current,h=l>0?"right":"left",y=Math.abs(l);m.current=!1,S.current=0,g.current=0,M.current=0,F({direction:null,progress:0,isSwiping:!1}),y>=c&&f?f(h):f&&f(null)},[c,f]),b=n.useCallback(l=>{const h=l.touches[0];L(h.clientX,h.clientY)},[L]),A=n.useCallback(l=>{const h=l.touches[0];d(h.clientX,h.clientY),m.current&&l.preventDefault()},[d]),w=n.useCallback(()=>{u()},[u]),R=n.useCallback(l=>{L(l.clientX,l.clientY)},[L]),E=n.useCallback(l=>{d(l.clientX,l.clientY)},[d]),p=n.useCallback(()=>{u()},[u]),B=n.useCallback(l=>{x.current=l,l.addEventListener("touchstart",b,{passive:!0}),l.addEventListener("touchmove",A,{passive:!1}),l.addEventListener("touchend",w,{passive:!0}),l.addEventListener("mousedown",R),document.addEventListener("mousemove",E),document.addEventListener("mouseup",p)},[b,A,w,R,E,p]),I=n.useCallback(()=>{const l=x.current;l&&(l.removeEventListener("touchstart",b),l.removeEventListener("touchmove",A),l.removeEventListener("touchend",w),l.removeEventListener("mousedown",R),document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",p))},[b,A,w,R,E,p]);return n.useEffect(()=>()=>{I()},[I]),{swipeState:G,attachListeners:B,detachListeners:I}}function Ae({item:t}){const{t:c}=oe(),C=de(),{stashItem:f,markViewed:k,startQuiz:G,generatingQuizForItem:F,generateMore:S}=ce(),{addSnippet:M}=ie(),{showSuccess:g}=ue(),m=F===t.id,x=n.useRef(null),[L,d]=n.useState(!1),[u,b]=n.useState(!1),[A,w]=n.useState(!1),R=n.useRef(Date.now()),E=w,{swipeState:p,attachListeners:B,detachListeners:I}=Le({threshold:100,onSwipeEnd:s=>{s==="right"&&h()}});n.useEffect(()=>{const s="ontouchstart"in window&&window.innerWidth<768;return x.current&&s&&B(x.current),()=>{s&&I()}},[B,I]),n.useEffect(()=>{if(!t.viewed){const s=setTimeout(()=>{k(t.id),l("view")},1e3);return()=>clearTimeout(s)}},[t.id,t.viewed,k]);const l=async s=>{const r=Date.now()-R.current,i=t.type==="did-you-know"?"didYouKnow":"questionAnswer";await Z.saveInteraction({feedItemId:t.id,action:s,timeSpent:r,itemType:i,topics:t.topics||[],source:t.sources?.[0]||"unknown",content:t.content||""})},h=async()=>{await l("stash");let s=`**${t.title}**

`;if(t.image){const i=t.image.startsWith("data:"),v=t.image.length;console.log("ðŸ“¸ Stashing item with image:",{isDataUri:i,imageSize:v,imageSource:t.imageSource,imageProvider:t.imageProvider,imageUrl:i?`data:... (${(v/1024).toFixed(1)} KB)`:t.image});let T=t.image;if(i)try{const{imageStorage:_}=await ge(async()=>{const{imageStorage:j}=await import("./index-CaLBu1It.js").then(N=>N.cV);return{imageStorage:j}},__vite__mapDeps([0,1]));T=await _.saveImage(t.image),console.log(`âœ… Saved image to IndexedDB: ${T} (${(v/1024).toFixed(1)} KB)`)}catch(_){console.error("âŒ Failed to save image to IndexedDB, using data URI:",_)}s+=`![${t.title}](${T})

`,t.imageAttribution&&(s+=`*Image: ${t.imageAttribution}*

`)}s+=`${t.content}

`,t.expandedContent&&t.expandedContent!==t.content&&(s+=`---

`,s+=`**Detailed Information:**

${t.expandedContent}

`),t.mnemonic&&(s+=`---

`,s+=`**Memory Aid:** ${t.mnemonic}

`),s+=`**Topics:** ${t.topics.join(", ")}`,t.sources&&t.sources.length>0&&(s+=`

**Sources:**
`,t.sources.forEach((i,v)=>{s+=`${v+1}. ${i}
`}));const r=[...t.topics||[],"admin:feed"];await M(s,"tool",t.title,r),await f(t.id)},y=async()=>{await l("quiz"),await G(t.id)},U=async()=>{await l("skip");const s=`Can you explain more about ${t.title}? ${t.topics.length>0?`I'm particularly interested in ${t.topics.slice(0,2).join(" and ")}.`:""} Please provide detailed information and examples.`,r=`You are a helpful AI assistant. The user is asking questions about the following article:

Title: ${t.title}

Content:
${t.expandedContent}

${t.topics.length>0?`Topics: ${t.topics.join(", ")}`:""}

Please use this article as context to answer the user's questions. You can provide additional information beyond what's in the article, but reference the article content when relevant.`;C("/chat",{state:{initialQuery:s,systemMessage:r,autoSubmit:!0,clearChat:!0}})},D=()=>{b(!0)},z=async(s,r)=>{s.preventDefault(),s.stopPropagation(),console.log("ðŸ·ï¸ Tag clicked, regenerating feed with topic:",r),window.scrollTo({top:0,behavior:"smooth"}),g(`ðŸ” Generating feed items about "${r}"`),d(!1),await S([r])},$=()=>{const s="https://ai.syntithenai.com",r=j=>{if(!j)return;const N=150;return j.length<=N?j:j.slice(0,N)+"..."},i=j=>!j||!Array.isArray(j)?[]:j.slice(0,3).map(N=>({url:typeof N=="string"?N:N.url,title:typeof N=="string"?N:N.title?.slice(0,60)||N.url})),v={type:"feed_item",title:t.title,content:t.content?.slice(0,200),topics:t.topics?.slice(0,5),image:t.image,sources:i(t.sources),expandedContent:r(t.expandedContent)},T=JSON.stringify(v),_=me.compressToEncodedURIComponent(T);return`${s}/feed/share/${_}`},H=()=>{const s=$(),r=encodeURIComponent(s);window.open(`https://www.facebook.com/sharer/sharer.php?u=${r}`,"_blank")},P=()=>{const s=$(),r=encodeURIComponent(`Check out this interesting article: ${t.title}

${s}`);window.open(`https://bsky.app/intent/compose?text=${r}`,"_blank")},V=()=>{const s=$(),r=encodeURIComponent(`Check out this interesting article: ${t.title}`),i=encodeURIComponent(s);window.open(`https://twitter.com/intent/tweet?text=${r}&url=${i}`,"_blank")},Y=()=>{const s=$(),r=encodeURIComponent(s),i=encodeURIComponent(t.title);window.open(`https://reddit.com/submit?url=${r}&title=${i}`,"_blank")},X=()=>{const s=$(),r=encodeURIComponent(s);window.open(`https://www.quora.com/share?url=${r}`,"_blank")},O=()=>{const s=encodeURIComponent(`Check out: ${t.title}`),r=encodeURIComponent(`I thought you might find this interesting:

${t.title}

${$()}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${s}&body=${r}`,"_blank")},W=async()=>{try{await navigator.clipboard.writeText($()),g("Link copied to clipboard!")}catch(s){console.error("Failed to copy link:",s)}},a=()=>{if(!p.isSwiping)return"";const{progress:s,direction:r}=p,i=s*100;return`translateX(${r==="right"?i:-i}px)`},o=()=>{if(!p.isSwiping)return"transparent";const{progress:s,direction:r}=p,i=Math.min(s*.3,.3);return r==="right"?`rgba(34, 197, 94, ${i})`:`rgba(239, 68, 68, ${i})`};return e.jsxs("div",{ref:x,className:"bg-white sm:rounded-lg shadow-sm overflow-hidden transition-all hover:shadow-md cursor-pointer relative",style:{transform:a(),backgroundColor:o(),transition:p.isSwiping?"none":"all 0.2s ease",display:"block",visibility:"visible",minHeight:"100px"},onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),children:[p.isSwiping&&e.jsxs(e.Fragment,{children:[p.direction==="right"&&e.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-green-600 flex items-center gap-2",children:[e.jsx(je,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:c("feed.stash")})]}),p.direction==="left"&&e.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-red-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:c("feed.trash")}),e.jsx(he,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?c("feed.didYouKnow"):c("feed.questionAnswer")}),t.stashed&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-700",children:c("feed.stashed")})]}),e.jsx("h3",{onClick:()=>d(!0),className:"text-lg font-bold text-gray-900 mb-2 cursor-pointer hover:text-blue-600 transition-colors",children:t.title}),t.image&&e.jsxs("div",{className:"mb-3 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,onClick:()=>d(!0),className:"w-full h-48 object-cover cursor-pointer hover:opacity-90 transition-opacity"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{onClick:()=>d(!0),className:"cursor-pointer hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors",title:"Click to read full article",children:[e.jsx("p",{className:"text-gray-700 mb-3 line-clamp-3",children:typeof t.content=="string"?t.content:t.content?.summary||"No content available"}),t.mnemonic&&e.jsx("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 mb-3 rounded",children:e.jsxs("p",{className:"text-sm font-medium text-purple-900",children:["ðŸ’¡ ",typeof t.mnemonic=="string"?t.mnemonic:JSON.stringify(t.mnemonic)]})}),t.expandedContent&&e.jsx("p",{className:"text-xs text-blue-600 hover:text-blue-700 font-medium mb-3",children:"Click to read more..."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(le,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,r)=>e.jsxs("span",{children:[e.jsx("button",{onClick:i=>z(i,s),className:"text-gray-700 hover:text-blue-600 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${s}"`,children:s}),r<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},r))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-3 mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 font-semibold",children:[c("feed.sources"),":"]}),e.jsx("div",{className:"space-y-1",children:t.sources.slice(0,2).map((s,r)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(ae,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s})]},r))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:h,className:"flex flex-col items-center justify-center gap-2 p-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors",title:"Save to Swag",children:[e.jsx(re,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Save"})]}),e.jsxs("button",{onClick:y,disabled:m,className:"flex flex-col items-center justify-center gap-2 p-4 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate Quiz",children:[m?e.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(ee,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Quiz"})]}),e.jsxs("button",{onClick:U,className:"flex flex-col items-center justify-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors",title:"Discuss in Chat",children:[e.jsx(te,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Chat"})]}),e.jsxs("button",{onClick:D,className:"flex flex-col items-center justify-center gap-2 p-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors",title:"Share this article",children:[e.jsx(K,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Share"})]})]})]}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>d(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-[90%] max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?c("feed.didYouKnow"):c("feed.questionAnswer")}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.title})]}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close",children:e.jsx(Q,{className:"h-6 w-6 text-gray-500"})})]}),e.jsxs("div",{className:"p-6",children:[t.image&&e.jsxs("div",{className:"mb-4 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-64 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.content})]}),t.mnemonic&&e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-4 mb-4 rounded",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-900 mb-2",children:["ðŸ’¡ ",t.mnemonic]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Topics:"}),e.jsx("button",{onClick:s=>z(s,t.topics.join(" ")),className:"text-blue-600 hover:text-blue-700 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${t.topics.join(", ")}"`,children:t.topics.join(", ")})]})]}),t.expandedContent&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"ðŸ“– Deep Dive"}),e.jsx(xe,{text:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2),variant:"icon"})]}),e.jsx("div",{className:"text-gray-700 leading-relaxed space-y-3 whitespace-pre-line",children:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(le,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,r)=>e.jsxs("span",{children:[e.jsx("button",{onClick:i=>z(i,s),className:"text-gray-700 hover:text-blue-600 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${s}"`,children:s}),r<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},r))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2 font-semibold",children:[c("feed.sources"),":"]}),e.jsx("div",{className:"space-y-2",children:t.sources.map((s,r)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:s})]},r))})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-4 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{await h(),d(!1)},className:"flex-1 px-4 py-3 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(re,{className:"h-5 w-5"}),"Save"]}),e.jsx("button",{onClick:async()=>{await y(),d(!1)},disabled:m,className:"flex-1 px-4 py-3 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),c("quiz.generating")]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-5 w-5"}),c("feed.quiz")]})}),e.jsxs("button",{onClick:async()=>{await U(),d(!1)},className:"flex-1 px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(te,{className:"h-5 w-5"}),"Chat"]}),e.jsxs("button",{onClick:()=>{D(),d(!1)},className:"flex-1 px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(K,{className:"h-5 w-5"}),"Share"]})]})]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>b(!1),children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Share Article"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(Q,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:t.title}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:W,className:"w-full px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"Copy Link"]}),e.jsxs("button",{onClick:V,className:"w-full px-4 py-3 bg-[#1DA1F2] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]}),e.jsxs("button",{onClick:Y,className:"w-full px-4 py-3 bg-[#FF4500] hover:bg-[#e03d00] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:H,className:"w-full px-4 py-3 bg-[#1877F2] hover:bg-[#166fe5] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:P,className:"w-full px-4 py-3 bg-[#0085ff] hover:bg-[#0073e6] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:X,className:"w-full px-4 py-3 bg-[#B92B27] hover:bg-[#a02522] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),e.jsxs("button",{onClick:O,className:"w-full px-4 py-3 bg-[#EA4335] hover:bg-[#d33426] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]})})})]})}function Re(t){return{title:t.title,questions:t.questions.map(c=>({id:c.id,prompt:c.prompt,choices:c.choices,answerId:c.correctChoiceId,explanation:c.explanation}))}}function Ee({quiz:t,onClose:c}){const C=Re(t);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsx(be,{quiz:C,onClose:c,onComplete:(f,k)=>{console.log(`Feed quiz completed: ${f}/${k}`)}})})})}function Fe(){const{t}=oe(),{isAuthenticated:c}=pe(),{snippets:C}=ie(),[f,k]=n.useState(""),[G,F]=n.useState(!1),[S,M]=n.useState("adult"),[g,m]=n.useState([]),{items:x,currentQuiz:L,isLoading:d,isGenerating:u,generationStatus:b,error:A,generateMore:w,refresh:R,closeQuiz:E,clearAllItems:p,stopGeneration:B,lastSearchCriteria:I}=ce(),l=n.useRef(null),h=n.useRef(null),y=n.useRef(null),U=n.useRef(u),D=n.useRef(d),z=n.useRef(w),$=n.useRef(I);n.useEffect(()=>{console.log("ðŸ”„ FeedPage: isGenerating changed:",u),console.log("ðŸ”„ FeedPage: generationStatus:",b),U.current=u,D.current=d,z.current=w,$.current=I},[u,d,w,b,I]);const H=n.useMemo(()=>{const a={};return C.forEach(o=>{o.tags?.forEach(s=>{s.startsWith("admin:")||(a[s]=(a[s]||0)+1)})}),Object.entries(a).sort((o,s)=>s[1]-o[1]).slice(0,10).map(([o])=>o)},[C]),P=n.useCallback(async()=>{const a=f.trim(),o=[...g];a&&o.push(a),o.length!==0&&(console.log("ðŸ” Searching with criteria:",o),await p(),await w(o),k(""))},[f,g,p,w]),V=n.useCallback(a=>{m(o=>o.includes(a)?(console.log("ðŸ·ï¸ Deselecting tag:",a),o.filter(r=>r!==a)):(console.log("ðŸ·ï¸ Selecting tag:",a),[...o,a]))},[]),Y=n.useCallback(()=>{console.log("ðŸ·ï¸ Selecting all tags"),m(H)},[H]),X=n.useCallback(()=>{console.log("ðŸ·ï¸ Deselecting all tags"),m([])},[]);n.useEffect(()=>{console.log("ðŸŽ¯ FeedPage: items changed:",x.length,"items"),console.log("ðŸŽ¯ Item titles:",x.map(a=>a.title)),console.log("ðŸŽ¯ Item IDs:",x.map(a=>a.id))},[x]),n.useEffect(()=>{(async()=>{const o=await Z.getMaturityLevel();M(o)})()},[]),n.useEffect(()=>{if(!(!y.current||!c))return h.current&&h.current.disconnect(),h.current=new IntersectionObserver(a=>{const[o]=a,s=$.current;console.log("ðŸ‘ï¸ IntersectionObserver fired:",{isIntersecting:o.isIntersecting,itemsLength:x.length,lastSearchCriteria:s});const r=s&&s.length>0,i=x.length>0,v=i||r,T=D.current,_=U.current,j=z.current;console.log("ðŸ” Infinite scroll check:",{isIntersecting:o.isIntersecting,currentIsLoading:T,currentIsGenerating:_,shouldAllowInfiniteScroll:v,hasActiveSearchCriteria:r,hasExistingItems:i,itemsLength:x.length}),o.isIntersecting&&!T&&!_&&v?(console.log("ðŸ“œ Infinite scroll triggered - generating more items..."),console.log("ðŸ“œ Reason: hasExistingItems="+i+", hasActiveSearchCriteria="+r),j()):o.isIntersecting&&!v?(console.log("ðŸ“œ Infinite scroll blocked: no items and no active search criteria (need user interests input or clicked tag)"),console.log("ðŸ“œ Debug: itemsLength="+x.length+", lastSearchCriteria="+(s?s.join(", "):"null"))):o.isIntersecting&&(T||_)&&console.log("ðŸ“œ Infinite scroll blocked: already generating/loading")},{root:null,rootMargin:"200px",threshold:.1}),h.current.observe(y.current),()=>{h.current&&h.current.disconnect()}},[c]),n.useEffect(()=>{const a=()=>{F(window.scrollY>300)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[]);const O=n.useCallback(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),W=n.useCallback(async()=>{await R()},[R]);return console.log("ðŸŽ¨ FeedPage render:",{isAuthenticated:c,isLoading:d,isGenerating:u,itemsCount:x.length,hasError:!!A}),c?e.jsxs("div",{ref:l,className:"bg-gray-50 pb-20",style:{minHeight:"100vh"},children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:[u&&e.jsx("div",{className:"bg-blue-50 border-b border-blue-200 px-2 sm:px-4 py-2",children:e.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"h-4 w-4 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800 font-medium",children:b||"Generating feed items..."})]}),e.jsxs("button",{onClick:a=>{console.log("ðŸ”´ Stop button clicked!",a),B()},className:"px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-1.5 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(Q,{className:"h-4 w-4"}),"Stop"]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-6 w-6 text-blue-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("feed.title")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:W,disabled:d||u,className:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:t("feed.refresh"),children:e.jsx(fe,{className:`h-5 w-5 text-gray-600 ${d||u?"animate-spin":""}`})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ðŸŽ“ Content Maturity Level"}),e.jsxs("select",{value:S,onChange:async a=>{const o=a.target.value;M(o),await Z.setMaturityLevel(o),window.dispatchEvent(new Event("feed-maturity-changed"))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"child",children:"Child (Ages 6-12) - Simple language, educational content"}),e.jsx("option",{value:"youth",children:"Youth (Ages 13-17) - Age-appropriate topics, moderate complexity"}),e.jsx("option",{value:"adult",children:"Adult (18+) - General audience, varied complexity"}),e.jsx("option",{value:"academic",children:"Academic - Advanced topics, research-focused, technical"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"What are your interests?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:f,onChange:a=>k(a.target.value),onKeyDown:a=>{a.key==="Enter"&&(f.trim()||g.length>0)&&!u&&P()},placeholder:"e.g., artificial intelligence, space exploration, history...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:u}),e.jsxs("button",{onClick:P,disabled:!f.trim()&&g.length===0||u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Search"]})]})]}),H.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Select tags to include in search:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Y,className:"text-xs px-2 py-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded transition-colors",children:"Select All"}),e.jsx("button",{onClick:X,className:"text-xs px-2 py-1 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded transition-colors",children:"Select None"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:H.map(a=>{const o=g.includes(a);return e.jsx("button",{onClick:()=>V(a),disabled:u,className:`px-3 py-1.5 rounded-full disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium ${o?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:a},a)})}),g.length>0&&e.jsxs("p",{className:"text-xs text-blue-600",children:[g.length," tag",g.length!==1?"s":""," selected"]})]}),H.length===0&&e.jsx("p",{className:"text-xs text-gray-500",children:"Add some interests above or save content with tags in Swag to see tag suggestions here."})]})]})]}),A&&e.jsx("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ke,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-900 mb-1",children:t("errors.error")}),e.jsx("p",{className:"text-sm text-red-700",children:A})]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4 space-y-4",children:[x.map((a,o)=>(console.log(`ðŸŽ´ Rendering FeedItemCard ${o+1}/${x.length}:`,a.id,a.title),e.jsx(Ae,{item:a},a.id))),x.length===0&&!d&&!u&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(J,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t("feed.noItems")}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Use the search or tag buttons above to generate your personalized feed"})]}),(d||u)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(ne,{className:"h-8 w-8 text-blue-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:t(u?"feed.generating":"common.loading")}),b&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 animate-pulse",children:b})]}),u&&e.jsxs("button",{onClick:a=>{console.log("ðŸ”´ Bottom stop button clicked!",a),B()},className:"mt-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(Q,{className:"h-4 w-4"}),"Stop Generation"]})]})]}),x.length>2&&e.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:["â†“ Scroll down to see more items (",x.length," total) â†“"]}),e.jsx("div",{ref:y,className:"h-4"}),G&&e.jsx("button",{onClick:O,className:"fixed bottom-6 right-6 bg-blue-600 text-white rounded-full p-3 shadow-lg hover:bg-blue-700 transition-all duration-300 hover:scale-110 z-50",title:"Scroll to top","aria-label":"Scroll to top",children:e.jsx(we,{className:"h-6 w-6"})}),L&&e.jsx(Ee,{quiz:L,onClose:E})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md text-center",children:[e.jsx(J,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t("feed.title")}),e.jsx("p",{className:"text-gray-600 mb-4",children:t("feed.emptyMessage")}),e.jsx("p",{className:"text-sm text-gray-500",children:t("common.pleaseSignIn")})]})})}export{Fe as default};

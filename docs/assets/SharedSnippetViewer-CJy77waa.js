import{L as g,u,b,a as j,r as d,j as e,M as f}from"./index-BnI9vT9b.js";function o(r){try{const a=g.decompressFromEncodedURIComponent(r);if(!a)return null;const s=JSON.parse(a);return!s.version||s.shareType!=="snippet"||!s.content?(console.error("Invalid snippet share data structure"),null):s}catch(a){return console.error("Failed to decode snippet share data:",a),null}}function y(){const r=window.location.hash;if(r.includes("/snippet/shared?data=")){const t=r.match(/data=([^&]+)/);if(t)return o(t[1])}const s=new URLSearchParams(window.location.search).get("snippet");return s?o(s):null}const v=()=>{const r=u(),[a]=b(),{isAuthenticated:s}=j(),[t,c]=d.useState(null),[x,h]=d.useState(!0),[i,l]=d.useState(null);d.useEffect(()=>{try{const n=y();n?(c(n),console.log("ðŸ“„ Loaded shared snippet:",n.title||"Untitled")):l("Invalid or missing snippet data in URL")}catch(n){console.error("Failed to load shared snippet:",n),l("Failed to decode snippet data")}finally{h(!1)}},[a]);const p=()=>{r(s?"/":"/login?redirect=/")};return x?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading shared snippet..."})]})}):i||!t?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 text-center",children:[e.jsx("div",{className:"text-red-500 text-5xl mb-4",children:"âš ï¸"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Unable to Load Snippet"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:i||"The shared snippet could not be found or loaded."}),e.jsx("button",{onClick:p,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:s?"Go to Chat":"Go to Login"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx("div",{className:"fixed top-0 right-0 left-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 shadow-sm z-10",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-2xl",children:"ðŸ“„"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Shared Snippet"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"View only â€¢ No login required"})]})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>r("/login?redirect="+encodeURIComponent(window.location.href)),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2 text-sm font-medium",children:"Login"})})]})}),e.jsx("div",{className:"pt-20 pb-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:t.title||"Untitled Snippet"}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),new Date(t.timestamp).toLocaleString()]}),t.sourceType&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t.sourceType==="user"?"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200":t.sourceType==="assistant"?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":"bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200"}`,children:t.sourceType}),t.metadata&&e.jsxs("div",{className:"flex items-center gap-1 text-xs",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),t.metadata.originalSize.toLocaleString()," chars",t.metadata.compressedSize&&e.jsxs("span",{className:"text-gray-400",children:["(",((1-t.metadata.compressedSize/t.metadata.originalSize)*100).toFixed(0),"% compressed)"]})]})]}),t.tags&&t.tags.length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap mt-3",children:t.tags.map((n,m)=>e.jsxs("span",{className:"px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-full",children:["#",n]},m))})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"prose dark:prose-invert max-w-none",children:e.jsx(f,{content:t.content})})})]}),e.jsx("div",{className:"mt-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6 text-blue-600 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-200 mb-1",children:"This is a shared snippet"}),e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:["Someone shared this content with you. No login is required to view it.",!s&&e.jsx("span",{children:" Login to create an account and start using chat features."})]})]})]})})]})})]})};export{v as SharedSnippetViewer};

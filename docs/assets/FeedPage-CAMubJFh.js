const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-h-5_Q0aY.js","assets/index--o78WQYb.css"])))=>i.map(i=>d[i]);
import{c as D,r as n,aH as le,u as de,br as ce,ba as ie,b8 as ue,bs as Z,j as e,be as he,bc as ee,bt as te,bd as K,bj as V,bu as xe,aT as me,l as ge,a as pe,bv as J,bw as fe}from"./index-h-5_Q0aY.js";import{C as se}from"./calendar-DV_yrM4C.js";import{Q as be}from"./QuizCard-Cevj6pNT.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],we=D("arrow-up",ye);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],je=D("bookmark",ve);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ke=D("circle-alert",Ne);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ne=D("external-link",Ce);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],ae=D("loader-circle",Se);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],re=D("save",Ie);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Me=D("search",$e);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],oe=D("tag",Le);function Re(t={}){const{threshold:l=100,onSwipeStart:C,onSwipeEnd:p,onSwipeProgress:N}=t,[H,F]=n.useState({direction:null,progress:0,isSwiping:!1}),S=n.useRef(0),A=n.useRef(0),d=n.useRef(0),f=n.useRef(!1),b=n.useRef(null),i=n.useCallback((o,x)=>{S.current=o,d.current=x,A.current=o,f.current=!1,F({direction:null,progress:0,isSwiping:!1}),C&&C()},[C]),u=n.useCallback((o,x)=>{if(S.current===0)return;A.current=o;const v=o-S.current,U=x-d.current;if(!f.current&&Math.abs(v)>Math.abs(U)&&Math.abs(v)>10&&(f.current=!0),f.current){const T=v>0?"right":"left",M=Math.min(Math.abs(v)/l,1);F({direction:T,progress:M,isSwiping:!0}),N&&N(M,T)}},[l,N]),I=n.useCallback(()=>{if(!f.current){S.current=0,d.current=0;return}const o=A.current-S.current,x=o>0?"right":"left",v=Math.abs(o);f.current=!1,S.current=0,d.current=0,A.current=0,F({direction:null,progress:0,isSwiping:!1}),v>=l&&p?p(x):p&&p(null)},[l,p]),g=n.useCallback(o=>{const x=o.touches[0];i(x.clientX,x.clientY)},[i]),E=n.useCallback(o=>{const x=o.touches[0];u(x.clientX,x.clientY),f.current&&o.preventDefault()},[u]),z=n.useCallback(()=>{I()},[I]),k=n.useCallback(o=>{i(o.clientX,o.clientY)},[i]),$=n.useCallback(o=>{u(o.clientX,o.clientY)},[u]),m=n.useCallback(()=>{I()},[I]),B=n.useCallback(o=>{b.current=o,o.addEventListener("touchstart",g,{passive:!0}),o.addEventListener("touchmove",E,{passive:!1}),o.addEventListener("touchend",z,{passive:!0}),o.addEventListener("mousedown",k),document.addEventListener("mousemove",$),document.addEventListener("mouseup",m)},[g,E,z,k,$,m]),y=n.useCallback(()=>{const o=b.current;o&&(o.removeEventListener("touchstart",g),o.removeEventListener("touchmove",E),o.removeEventListener("touchend",z),o.removeEventListener("mousedown",k),document.removeEventListener("mousemove",$),document.removeEventListener("mouseup",m))},[g,E,z,k,$,m]);return n.useEffect(()=>()=>{y()},[y]),{swipeState:H,attachListeners:B,detachListeners:y}}function Ae({item:t}){const{t:l}=le(),C=de(),{stashItem:p,markViewed:N,startQuiz:H,generatingQuizForItem:F,generateMore:S}=ce(),{addSnippet:A}=ie(),{showSuccess:d}=ue(),f=F===t.id,b=n.useRef(null),[i,u]=n.useState(!1),[I,g]=n.useState(!1),[E,z]=n.useState(!1),k=n.useRef(Date.now()),$=z,{swipeState:m,attachListeners:B,detachListeners:y}=Re({threshold:100,onSwipeEnd:s=>{s==="right"&&x()}});n.useEffect(()=>{const s="ontouchstart"in window&&window.innerWidth<768;return b.current&&s&&B(b.current),()=>{s&&y()}},[B,y]),n.useEffect(()=>{if(!t.viewed){const s=setTimeout(()=>{N(t.id),o("view")},1e3);return()=>clearTimeout(s)}},[t.id,t.viewed,N]);const o=async s=>{const r=Date.now()-k.current,c=t.type==="did-you-know"?"didYouKnow":"questionAnswer";await Z.saveInteraction({feedItemId:t.id,action:s,timeSpent:r,itemType:c,topics:t.topics||[],source:t.sources?.[0]||"unknown",content:t.content||""})},x=async()=>{await o("stash");let s=`**${t.title}**

`;if(t.image){const c=t.image.startsWith("data:"),_=t.image.length;console.log("ðŸ“¸ Stashing item with image:",{isDataUri:c,imageSize:_,imageSource:t.imageSource,imageProvider:t.imageProvider,imageUrl:c?`data:... (${(_/1024).toFixed(1)} KB)`:t.image});let Q=t.image;if(c)try{const{imageStorage:Y}=await me(async()=>{const{imageStorage:R}=await import("./index-h-5_Q0aY.js").then(j=>j.cP);return{imageStorage:R}},__vite__mapDeps([0,1]));Q=await Y.saveImage(t.image),console.log(`âœ… Saved image to IndexedDB: ${Q} (${(_/1024).toFixed(1)} KB)`)}catch(Y){console.error("âŒ Failed to save image to IndexedDB, using data URI:",Y)}s+=`![${t.title}](${Q})

`,t.imageAttribution&&(s+=`*Image: ${t.imageAttribution}*

`)}s+=`${t.content}

`,t.expandedContent&&t.expandedContent!==t.content&&(s+=`---

`,s+=`**Detailed Information:**

${t.expandedContent}

`),t.mnemonic&&(s+=`---

`,s+=`**Memory Aid:** ${t.mnemonic}

`),s+=`**Topics:** ${t.topics.join(", ")}`,t.sources&&t.sources.length>0&&(s+=`

**Sources:**
`,t.sources.forEach((c,_)=>{s+=`${_+1}. ${c}
`}));const r=[...t.topics||[],"admin:feed"];await A(s,"tool",t.title,r),await p(t.id)},v=async()=>{await o("quiz"),await H(t.id)},U=async()=>{await o("skip");const s=`Can you explain more about ${t.title}? ${t.topics.length>0?`I'm particularly interested in ${t.topics.slice(0,2).join(" and ")}.`:""} Please provide detailed information and examples.`,r=`You are a helpful AI assistant. The user is asking questions about the following article:

Title: ${t.title}

Content:
${t.expandedContent}

${t.topics.length>0?`Topics: ${t.topics.join(", ")}`:""}

Please use this article as context to answer the user's questions. You can provide additional information beyond what's in the article, but reference the article content when relevant.`;C("/chat",{state:{initialQuery:s,systemMessage:r,autoSubmit:!0,clearChat:!0}})},T=()=>{g(!0)},M=async(s,r)=>{s.preventDefault(),s.stopPropagation(),console.log("ðŸ·ï¸ Tag clicked, regenerating feed with topic:",r),window.scrollTo({top:0,behavior:"smooth"}),d(`ðŸ” Generating feed items about "${r}"`),u(!1),await S([r])},L=()=>{const s="https://ai.syntithenai.com",r=R=>{if(!R)return;const j=150;return R.length<=j?R:R.slice(0,j)+"..."},c=R=>!R||!Array.isArray(R)?[]:R.slice(0,3).map(j=>({url:typeof j=="string"?j:j.url,title:typeof j=="string"?j:j.title?.slice(0,60)||j.url})),_={type:"feed_item",title:t.title,content:t.content?.slice(0,200),topics:t.topics?.slice(0,5),image:t.image,sources:c(t.sources),expandedContent:r(t.expandedContent)},Q=JSON.stringify(_),Y=ge.compressToEncodedURIComponent(Q);return`${s}/feed/share/${Y}`},X=()=>{const s=L(),r=encodeURIComponent(s);window.open(`https://www.facebook.com/sharer/sharer.php?u=${r}`,"_blank")},O=()=>{const s=L(),r=encodeURIComponent(`Check out this interesting article: ${t.title}

${s}`);window.open(`https://bsky.app/intent/compose?text=${r}`,"_blank")},W=()=>{const s=L(),r=encodeURIComponent(`Check out this interesting article: ${t.title}`),c=encodeURIComponent(s);window.open(`https://twitter.com/intent/tweet?text=${r}&url=${c}`,"_blank")},a=()=>{const s=L(),r=encodeURIComponent(s),c=encodeURIComponent(t.title);window.open(`https://reddit.com/submit?url=${r}&title=${c}`,"_blank")},h=()=>{const s=L(),r=encodeURIComponent(s);window.open(`https://www.quora.com/share?url=${r}`,"_blank")},w=()=>{const s=encodeURIComponent(`Check out: ${t.title}`),r=encodeURIComponent(`I thought you might find this interesting:

${t.title}

${L()}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${s}&body=${r}`,"_blank")},q=async()=>{try{await navigator.clipboard.writeText(L()),d("Link copied to clipboard!")}catch(s){console.error("Failed to copy link:",s)}},G=()=>{if(!m.isSwiping)return"";const{progress:s,direction:r}=m,c=s*100;return`translateX(${r==="right"?c:-c}px)`},P=()=>{if(!m.isSwiping)return"transparent";const{progress:s,direction:r}=m,c=Math.min(s*.3,.3);return r==="right"?`rgba(34, 197, 94, ${c})`:`rgba(239, 68, 68, ${c})`};return e.jsxs("div",{ref:b,className:"bg-white sm:rounded-lg shadow-sm overflow-hidden transition-all hover:shadow-md cursor-pointer relative",style:{transform:G(),backgroundColor:P(),transition:m.isSwiping?"none":"all 0.2s ease",display:"block",visibility:"visible",minHeight:"100px"},onMouseEnter:()=>$(!0),onMouseLeave:()=>$(!1),children:[m.isSwiping&&e.jsxs(e.Fragment,{children:[m.direction==="right"&&e.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-green-600 flex items-center gap-2",children:[e.jsx(je,{className:"h-6 w-6"}),e.jsx("span",{className:"font-semibold",children:l("feed.stash")})]}),m.direction==="left"&&e.jsxs("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-red-600 flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:l("feed.trash")}),e.jsx(he,{className:"h-6 w-6"})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?l("feed.didYouKnow"):l("feed.questionAnswer")}),t.stashed&&e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded bg-green-100 text-green-700",children:l("feed.stashed")})]}),e.jsx("h3",{onClick:()=>u(!0),className:"text-lg font-bold text-gray-900 mb-2 cursor-pointer hover:text-blue-600 transition-colors",children:t.title}),t.image&&e.jsxs("div",{className:"mb-3 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,onClick:()=>u(!0),className:"w-full h-48 object-cover cursor-pointer hover:opacity-90 transition-opacity"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{onClick:()=>u(!0),className:"cursor-pointer hover:bg-gray-50 rounded-lg p-2 -m-2 transition-colors",title:"Click to read full article",children:[e.jsx("p",{className:"text-gray-700 mb-3 line-clamp-3",children:typeof t.content=="string"?t.content:t.content?.summary||"No content available"}),t.mnemonic&&e.jsx("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-3 mb-3 rounded",children:e.jsxs("p",{className:"text-sm font-medium text-purple-900",children:["ðŸ’¡ ",typeof t.mnemonic=="string"?t.mnemonic:JSON.stringify(t.mnemonic)]})}),t.expandedContent&&e.jsx("p",{className:"text-xs text-blue-600 hover:text-blue-700 font-medium mb-3",children:"Click to read more..."})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(oe,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,r)=>e.jsxs("span",{children:[e.jsx("button",{onClick:c=>M(c,s),className:"text-gray-700 hover:text-blue-600 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${s}"`,children:s}),r<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},r))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-3 mb-3",children:[e.jsxs("p",{className:"text-xs text-gray-500 mb-1 font-semibold",children:[l("feed.sources"),":"]}),e.jsx("div",{className:"space-y-1",children:t.sources.slice(0,2).map((s,r)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(ne,{className:"h-3 w-3"}),e.jsx("span",{className:"truncate",children:s})]},r))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 grid grid-cols-4 gap-2",children:[e.jsxs("button",{onClick:x,className:"flex flex-col items-center justify-center gap-2 p-4 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg transition-colors",title:"Save to Swag",children:[e.jsx(re,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Save"})]}),e.jsxs("button",{onClick:v,disabled:f,className:"flex flex-col items-center justify-center gap-2 p-4 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate Quiz",children:[f?e.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(ee,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Quiz"})]}),e.jsxs("button",{onClick:U,className:"flex flex-col items-center justify-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-colors",title:"Discuss in Chat",children:[e.jsx(te,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Chat"})]}),e.jsxs("button",{onClick:T,className:"flex flex-col items-center justify-center gap-2 p-4 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-colors",title:"Share this article",children:[e.jsx(K,{className:"h-6 w-6"}),e.jsx("span",{className:"text-xs font-medium",children:"Share"})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>u(!1),children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-[90%] max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded ${t.type==="did-you-know"?"bg-blue-100 text-blue-700":"bg-purple-100 text-purple-700"}`,children:t.type==="did-you-know"?l("feed.didYouKnow"):l("feed.questionAnswer")}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.title})]}),e.jsx("button",{onClick:()=>u(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close",children:e.jsx(V,{className:"h-6 w-6 text-gray-500"})})]}),e.jsxs("div",{className:"p-6",children:[t.image&&e.jsxs("div",{className:"mb-4 rounded-lg overflow-hidden",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-64 object-cover"}),t.imageAttribution&&e.jsx("div",{className:"text-xs text-gray-500 mt-2 bg-gray-50 p-2 rounded",dangerouslySetInnerHTML:{__html:t.imageAttributionHtml||t.imageAttribution}})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.content})]}),t.mnemonic&&e.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-4 mb-4 rounded",children:[e.jsxs("p",{className:"text-sm font-medium text-purple-900 mb-2",children:["ðŸ’¡ ",t.mnemonic]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Topics:"}),e.jsx("button",{onClick:s=>M(s,t.topics.join(" ")),className:"text-blue-600 hover:text-blue-700 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${t.topics.join(", ")}"`,children:t.topics.join(", ")})]})]}),t.expandedContent&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"ðŸ“– Deep Dive"}),e.jsx(xe,{text:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2),variant:"icon",shouldSummarize:!1})]}),e.jsx("div",{className:"text-gray-700 leading-relaxed space-y-3 whitespace-pre-line",children:typeof t.expandedContent=="string"?t.expandedContent:JSON.stringify(t.expandedContent,null,2)})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 mb-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:(()=>{try{const s=new Date(t.createdAt);return isNaN(s.getTime())?"Recently":s.toLocaleDateString()}catch{return"Recently"}})()})]}),t.topics.length>0&&e.jsxs("div",{className:"flex items-center gap-1 flex-wrap",children:[e.jsx(oe,{className:"h-4 w-4"}),t.topics.slice(0,3).map((s,r)=>e.jsxs("span",{children:[e.jsx("button",{onClick:c=>M(c,s),className:"text-gray-700 hover:text-blue-600 hover:underline cursor-pointer bg-transparent border-0 p-0",title:`Generate feed items about "${s}"`,children:s}),r<Math.min(t.topics.length,3)-1&&e.jsx("span",{className:"text-gray-500",children:", "})]},r))]})]}),t.sources.length>0&&e.jsxs("div",{className:"border-t border-gray-200 pt-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700 mb-2 font-semibold",children:[l("feed.sources"),":"]}),e.jsx("div",{className:"space-y-2",children:t.sources.map((s,r)=>e.jsxs("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center gap-1",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{className:"truncate",children:s})]},r))})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-gray-50 border-t border-gray-200 p-4 flex gap-3",children:[e.jsxs("button",{onClick:async()=>{await x(),u(!1)},className:"flex-1 px-4 py-3 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(re,{className:"h-5 w-5"}),"Save"]}),e.jsx("button",{onClick:async()=>{await v(),u(!1)},disabled:f,className:"flex-1 px-4 py-3 bg-purple-50 hover:bg-purple-100 text-purple-700 rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l("quiz.generating")]}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-5 w-5"}),l("feed.quiz")]})}),e.jsxs("button",{onClick:async()=>{await U(),u(!1)},className:"flex-1 px-4 py-3 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(te,{className:"h-5 w-5"}),"Chat"]}),e.jsxs("button",{onClick:()=>{T(),u(!1)},className:"flex-1 px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg font-medium text-sm flex items-center justify-center gap-2 transition-colors",children:[e.jsx(K,{className:"h-5 w-5"}),"Share"]})]})]})}),I&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",onClick:()=>g(!1),children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Share Article"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(V,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:t.title}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:q,className:"w-full px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx(K,{className:"h-5 w-5"}),"Copy Link"]}),e.jsxs("button",{onClick:W,className:"w-full px-4 py-3 bg-[#1DA1F2] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]}),e.jsxs("button",{onClick:a,className:"w-full px-4 py-3 bg-[#FF4500] hover:bg-[#e03d00] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:X,className:"w-full px-4 py-3 bg-[#1877F2] hover:bg-[#166fe5] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:O,className:"w-full px-4 py-3 bg-[#0085ff] hover:bg-[#0073e6] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:h,className:"w-full px-4 py-3 bg-[#B92B27] hover:bg-[#a02522] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),e.jsxs("button",{onClick:w,className:"w-full px-4 py-3 bg-[#EA4335] hover:bg-[#d33426] text-white rounded-lg transition-colors font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]})})})]})}function Ee(t){return{title:t.title,questions:t.questions.map(l=>({id:l.id,prompt:l.prompt,choices:l.choices,answerId:l.correctChoiceId,explanation:l.explanation}))}}function ze({quiz:t,onClose:l}){const C=Ee(t);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-2xl",children:e.jsx(be,{quiz:C,onClose:l,onComplete:(p,N)=>{console.log(`Feed quiz completed: ${p}/${N}`)}})})})}function Fe(){const{t}=le(),{isAuthenticated:l}=pe(),{snippets:C}=ie(),[p,N]=n.useState(""),[H,F]=n.useState(!1),[S,A]=n.useState("adult"),{items:d,currentQuiz:f,isLoading:b,isGenerating:i,generationStatus:u,error:I,generateMore:g,refresh:E,closeQuiz:z,clearAllItems:k,stopGeneration:$,lastSearchCriteria:m}=ce(),B=n.useRef(null),y=n.useRef(null),o=n.useRef(null),x=n.useRef(i),v=n.useRef(b),U=n.useRef(g),T=n.useRef(m);n.useEffect(()=>{console.log("ðŸ”„ FeedPage: isGenerating changed:",i),console.log("ðŸ”„ FeedPage: generationStatus:",u),x.current=i,v.current=b,U.current=g,T.current=m},[i,b,g,u,m]);const M=n.useMemo(()=>{const a={};return C.forEach(h=>{h.tags?.forEach(w=>{w.startsWith("admin:")||(a[w]=(a[w]||0)+1)})}),Object.entries(a).sort((h,w)=>w[1]-h[1]).slice(0,10).map(([h])=>h)},[C]),L=n.useCallback(async()=>{const a=p.trim();a&&(console.log("ðŸ” Searching interests:",a),await k(),await g([a]),N(""))},[p,k,g]),X=n.useCallback(async a=>{console.log("ðŸ·ï¸ Searching tag:",a),await k(),await g([a])},[k,g]);n.useEffect(()=>{console.log("ðŸŽ¯ FeedPage: items changed:",d.length,"items"),console.log("ðŸŽ¯ Item titles:",d.map(a=>a.title)),console.log("ðŸŽ¯ Item IDs:",d.map(a=>a.id))},[d]),n.useEffect(()=>{(async()=>{const h=await Z.getMaturityLevel();A(h)})()},[]),n.useEffect(()=>{if(!(!o.current||!l))return y.current&&y.current.disconnect(),y.current=new IntersectionObserver(a=>{const[h]=a,w=T.current;console.log("ðŸ‘ï¸ IntersectionObserver fired:",{isIntersecting:h.isIntersecting,itemsLength:d.length,lastSearchCriteria:w});const q=w&&w.length>0,G=d.length>0,P=G||q,s=v.current,r=x.current,c=U.current;console.log("ðŸ” Infinite scroll check:",{isIntersecting:h.isIntersecting,currentIsLoading:s,currentIsGenerating:r,shouldAllowInfiniteScroll:P,hasActiveSearchCriteria:q,hasExistingItems:G,itemsLength:d.length}),h.isIntersecting&&!s&&!r&&P?(console.log("ðŸ“œ Infinite scroll triggered - generating more items..."),console.log("ðŸ“œ Reason: hasExistingItems="+G+", hasActiveSearchCriteria="+q),c()):h.isIntersecting&&!P?(console.log("ðŸ“œ Infinite scroll blocked: no items and no active search criteria (need user interests input or clicked tag)"),console.log("ðŸ“œ Debug: itemsLength="+d.length+", lastSearchCriteria="+(w?w.join(", "):"null"))):h.isIntersecting&&(s||r)&&console.log("ðŸ“œ Infinite scroll blocked: already generating/loading")},{root:null,rootMargin:"200px",threshold:.1}),y.current.observe(o.current),()=>{y.current&&y.current.disconnect()}},[l]),n.useEffect(()=>{const a=()=>{F(window.scrollY>300)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[]);const O=n.useCallback(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]),W=n.useCallback(async()=>{await E()},[E]);return console.log("ðŸŽ¨ FeedPage render:",{isAuthenticated:l,isLoading:b,isGenerating:i,itemsCount:d.length,hasError:!!I}),l?e.jsxs("div",{ref:B,className:"bg-gray-50 pb-20",style:{minHeight:"100vh"},children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 sticky top-0 z-10",children:[i&&e.jsx("div",{className:"bg-blue-50 border-b border-blue-200 px-2 sm:px-4 py-2",children:e.jsxs("div",{className:"max-w-2xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-4 w-4 text-blue-600 animate-spin"}),e.jsx("span",{className:"text-sm text-blue-800 font-medium",children:u||"Generating feed items..."})]}),e.jsxs("button",{onClick:a=>{console.log("ðŸ”´ Stop button clicked!",a),$()},className:"px-3 py-1.5 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-1.5 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(V,{className:"h-4 w-4"}),"Stop"]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-6 w-6 text-blue-500"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t("feed.title")})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:W,disabled:b||i,className:"p-2 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:t("feed.refresh"),children:e.jsx(fe,{className:`h-5 w-5 text-gray-600 ${b||i?"animate-spin":""}`})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"ðŸŽ“ Content Maturity Level"}),e.jsxs("select",{value:S,onChange:async a=>{const h=a.target.value;A(h),await Z.setMaturityLevel(h),window.dispatchEvent(new Event("feed-maturity-changed"))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"child",children:"Child (Ages 6-12) - Simple language, educational content"}),e.jsx("option",{value:"youth",children:"Youth (Ages 13-17) - Age-appropriate topics, moderate complexity"}),e.jsx("option",{value:"adult",children:"Adult (18+) - General audience, varied complexity"}),e.jsx("option",{value:"academic",children:"Academic - Advanced topics, research-focused, technical"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"What are your interests?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:p,onChange:a=>N(a.target.value),onKeyDown:a=>{a.key==="Enter"&&p.trim()&&!i&&L()},placeholder:"e.g., artificial intelligence, space exploration, history...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:i}),e.jsxs("button",{onClick:L,disabled:!p.trim()||i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Search"]})]})]}),M.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Or browse by your saved tags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:M.map(a=>e.jsx("button",{onClick:()=>X(a),disabled:i,className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded-full hover:bg-blue-100 hover:text-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm font-medium",children:a},a))})]}),M.length===0&&e.jsx("p",{className:"text-xs text-gray-500",children:"Add some interests above or save content with tags in Swag to see tag suggestions here."})]})]})]}),I&&e.jsx("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[e.jsx(ke,{className:"h-5 w-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-red-900 mb-1",children:t("errors.error")}),e.jsx("p",{className:"text-sm text-red-700",children:I})]})]})}),e.jsxs("div",{className:"max-w-2xl mx-auto px-2 sm:px-4 py-4 space-y-4",children:[d.map((a,h)=>(console.log(`ðŸŽ´ Rendering FeedItemCard ${h+1}/${d.length}:`,a.id,a.title),e.jsx(Ae,{item:a},a.id))),d.length===0&&!b&&!i&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-12 text-center",children:[e.jsx(J,{className:"mx-auto h-16 w-16 text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t("feed.noItems")}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Use the search or tag buttons above to generate your personalized feed"})]}),(b||i)&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 gap-3",children:[e.jsx(ae,{className:"h-8 w-8 text-blue-500 animate-spin"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:t(i?"feed.generating":"common.loading")}),u&&e.jsx("p",{className:"text-sm text-gray-600 mt-1 animate-pulse",children:u})]}),i&&e.jsxs("button",{onClick:a=>{console.log("ðŸ”´ Bottom stop button clicked!",a),$()},className:"mt-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm font-medium shadow-md hover:shadow-lg",title:"Stop feed generation",children:[e.jsx(V,{className:"h-4 w-4"}),"Stop Generation"]})]})]}),d.length>2&&e.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:["â†“ Scroll down to see more items (",d.length," total) â†“"]}),e.jsx("div",{ref:o,className:"h-4"}),H&&e.jsx("button",{onClick:O,className:"fixed bottom-6 right-6 bg-blue-600 text-white rounded-full p-3 shadow-lg hover:bg-blue-700 transition-all duration-300 hover:scale-110 z-50",title:"Scroll to top","aria-label":"Scroll to top",children:e.jsx(we,{className:"h-6 w-6"})}),f&&e.jsx(ze,{quiz:f,onClose:z})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-8 max-w-md text-center",children:[e.jsx(J,{className:"mx-auto h-12 w-12 text-blue-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t("feed.title")}),e.jsx("p",{className:"text-gray-600 mb-4",children:t("feed.emptyMessage")}),e.jsx("p",{className:"text-sm text-gray-500",children:t("common.pleaseSignIn")})]})})}export{Fe as default};

import{c as _,r as u,e as W,bE as ee,j as e,bF as te,bG as X,bH as se,bI as re,bJ as Y,bK as ae,bL as oe,bM as ne,bN as ie,bO as le,bP as K,aR as J,u as de,aT as ce,a as ue,m as ge,by as he,q as $,bs as G,bQ as Z,aQ as xe,Q as me}from"./index-Ba9w6Zmy.js";import{s as be}from"./quizSync-CjhMzUAc.js";import{c as pe,a as ye}from"./quizShareUtils-BK_Bl_yY.js";import{C as we}from"./calendar-CLVqjBxp.js";import{C as fe}from"./clock-DHZIxpxC.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ve=_("arrow-left",je);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Ne=_("check",ke);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ce=_("square-pen",ze);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Se=_("trending-up",qe),Qe=({quiz:g,onClose:l,enrichment:N,sharedBy:y})=>{const[w,E]=u.useState(""),[o,f]=u.useState(!1),[n,z]=u.useState(!0),[b,v]=u.useState("url"),[x,S]=u.useState(""),[Q,I]=u.useState(""),[D,M]=u.useState(!1),[C,k]=u.useState(null),[L,j]=u.useState(!1),{showSuccess:A,showError:q}=W();u.useEffect(()=>{const i=g.title,d=ee("quiz",i);d&&(k(d),S(d.webViewLink),d.documentId&&I(`https://drive.google.com/file/d/${d.documentId}/view`))},[g.title]),u.useEffect(()=>{try{const i=pe(g,{sharedBy:y,enrichment:N}),d=ye(i);E(d)}catch(i){console.error("Failed to generate quiz share URL:",i)}finally{z(!1)}},[g,y,N]);const s=async()=>{const i=b==="google-docs"?x:w;try{await navigator.clipboard.writeText(i),f(!0),setTimeout(()=>f(!1),2e3)}catch(d){console.error("Failed to copy to clipboard:",d)}},a=()=>{const i=b==="google-docs"?x:w,d=`Test your knowledge: ${g.title}`,F=`https://twitter.com/intent/tweet?text=${encodeURIComponent(d)}&url=${encodeURIComponent(i)}`;window.open(F,"_blank")},c=()=>{const d=`https://reddit.com/submit?url=${encodeURIComponent(b==="google-docs"?x:w)}&title=${encodeURIComponent(g.title)}`;window.open(d,"_blank")},m=()=>{const d=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(b==="google-docs"?x:w)}`;window.open(d,"_blank")},p=()=>{const i=b==="google-docs"?x:w,d=encodeURIComponent(`Quiz: ${g.title}`),F=encodeURIComponent(`Test your knowledge with this quiz:

${i}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${d}&body=${F}`,"_blank")},R=()=>{const i=b==="google-docs"?x:w,d=encodeURIComponent(`Test your knowledge: ${g.title}

${i}`);window.open(`https://bsky.app/intent/compose?text=${d}`,"_blank")},B=()=>{const d=encodeURIComponent(b==="google-docs"?x:w);window.open(`https://www.quora.com/share?url=${d}`,"_blank")},H=async()=>{if(!(x||D)){M(!0);try{const i=await Y();if(!i)throw new Error("Please sign in to create Google Docs");const{documentId:d}=await ae(g.title,g,i),t=`${window.location.hostname==="localhost"?window.location.origin:"https://ai.syntithenai.com"}/#/quiz/shared?docId=${d}`,r=`https://drive.google.com/file/d/${d}/view`;S(t),I(r),v("google-docs");const h=g.title;oe("quiz",h,d,t),k({documentId:d,webViewLink:t,sharedAt:new Date().toISOString(),contentType:"quiz"}),console.log(`âœ… Created shared quiz document: ${d}`),console.log(`ðŸ“„ Preview URL: ${t}`),console.log(`ðŸ“„ Google Drive URL: ${r}`)}catch(i){console.error("Failed to create Google Doc:",i),alert("Failed to create Google Doc. Please try again.")}finally{M(!1)}}},O=async()=>{if(C){j(!0);try{const i=await Y();if(!i)throw new Error("Please sign in to stop sharing");await ne(C.documentId,i);const d=g.title;ie("quiz",d),k(null),S(""),console.log(`âœ… Stopped sharing quiz: ${d}`),A("Document sharing stopped successfully")}catch(i){console.error("Failed to stop sharing:",i),q("Failed to stop sharing. Please try again.")}finally{j(!1)}}};return n?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3",children:"Generating share link..."})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:l,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Share Quiz"}),e.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:g.title}),e.jsxs("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:["ðŸ“ ",g.questions.length," question",g.questions.length!==1?"s":"",N&&" â€¢ âœ¨ AI-enriched"]})]}),e.jsxs("div",{className:"flex gap-2 p-1 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsxs("button",{onClick:()=>v("url"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-colors ${b==="url"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[e.jsx(te,{className:"w-4 h-4"}),"URL Share"]}),e.jsxs("button",{onClick:()=>v("google-docs"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-colors ${b==="google-docs"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[e.jsx(X,{className:"w-4 h-4"}),"Google Docs"]})]}),b==="url"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Shareable URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:i=>i.currentTarget.select()}),e.jsx("button",{onClick:s,className:`px-4 py-2 rounded-md font-medium transition-colors ${o?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),e.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["URL length: ",w.length.toLocaleString()," characters"]})]}),w.length<=2e3&&e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Scan with Mobile Device"}),e.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:e.jsx(se,{value:w,size:200,level:"L"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:a,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),e.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:m,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Email"]}),e.jsxs("button",{onClick:R,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085FF] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.038.416-.054-3.912.448-6.327 1.282-6.327 3.444 0 2.162 2.556 3.06 6.524 3.06C11.395 20.061 12 24 12 24s.605-3.939 4.38-3.939c3.968 0 6.524-.898 6.524-3.06 0-2.162-2.415-2.996-6.327-3.444.14.016.28.034.416.054 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.788.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:B,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02623] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8.275 15.844a4.64 4.64 0 01-.213-.4c-.328-.666-.524-1.363-.524-2.118 0-2.647 2.08-4.907 4.826-4.907 2.746 0 4.826 2.26 4.826 4.907 0 .755-.196 1.452-.524 2.118a5.127 5.127 0 01-.213.4c.213.08.427.12.64.12 1.15 0 2.12-.87 2.72-1.882.6-1.012.86-2.144.86-3.296 0-1.192-.28-2.344-.86-3.356-.58-1.012-1.57-1.862-2.72-1.862-.213 0-.427.04-.64.12.066-.12.132-.26.213-.4.328-.666.524-1.363.524-2.118 0-2.647-2.08-4.907-4.826-4.907-2.746 0-4.826 2.26-4.826 4.907 0 .755.196 1.452.524 2.118.065.14.147.28.213.4a2.51 2.51 0 00-.64-.12c-1.15 0-2.12.87-2.72 1.882-.6 1.012-.86 2.144-.86 3.296 0 1.192.28 2.344.86 3.356.58 1.012 1.57 1.862 2.72 1.862.213 0 .427-.04.64-.12z"})}),"Quora"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[e.jsx("p",{children:"ðŸ’¡ Anyone with this URL can take the quiz"}),e.jsx("p",{children:"ðŸ”’ Quiz data is compressed and encoded in the URL (no server storage)"}),e.jsx("p",{children:"â±ï¸ Links never expire and work offline once loaded"}),e.jsx("p",{children:"ðŸ“Š Results are only stored locally (not synced back to you)"})]})]}),b==="google-docs"&&e.jsx("div",{children:x?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Google Docs Link"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:x,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:i=>i.target.select()}),e.jsx("button",{onClick:s,className:`px-4 py-2 rounded-md font-medium transition-colors ${o?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:o?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),e.jsxs("div",{className:"mt-3 flex gap-2",children:[e.jsxs("a",{href:Q,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-center inline-flex items-center justify-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Open in Google Drive"]}),C&&e.jsx("button",{onClick:O,disabled:L,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors inline-flex items-center justify-center gap-2",children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Stopping..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Stop Sharing"]})})]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"âœ… Document is publicly accessible (anyone with link can view)"}),Q&&e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:a,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),e.jsxs("button",{onClick:c,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),e.jsxs("button",{onClick:m,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),e.jsxs("button",{onClick:p,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Email"]}),e.jsxs("button",{onClick:R,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085FF] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.038.416-.054-3.912.448-6.327 1.282-6.327 3.444 0 2.162 2.556 3.06 6.524 3.06C11.395 20.061 12 24 12 24s.605-3.939 4.38-3.939c3.968 0 6.524-.898 6.524-3.06 0-2.162-2.415-2.996-6.327-3.444.14.016.28.034.416.054 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.788.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),e.jsxs("button",{onClick:B,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02623] transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8.275 15.844a4.64 4.64 0 01-.213-.4c-.328-.666-.524-1.363-.524-2.118 0-2.647 2.08-4.907 4.826-4.907 2.746 0 4.826 2.26 4.826 4.907 0 .755-.196 1.452-.524 2.118a5.127 5.127 0 01-.213.4c.213.08.427.12.64.12 1.15 0 2.12-.87 2.72-1.882.6-1.012.86-2.144.86-3.296 0-1.192-.28-2.344-.86-3.356-.58-1.012-1.57-1.862-2.72-1.862-.213 0-.427.04-.64.12.066-.12.132-.26.213-.4.328-.666.524-1.363.524-2.118 0-2.647-2.08-4.907-4.826-4.907-2.746 0-4.826 2.26-4.826 4.907 0 .755.196 1.452.524 2.118.065.14.147.28.213.4a2.51 2.51 0 00-.64-.12c-1.15 0-2.12.87-2.72 1.882-.6 1.012-.86 2.144-.86 3.296 0 1.192.28 2.344.86 3.356.58 1.012 1.57 1.862 2.72 1.862.213 0 .427-.04.64-.12z"})}),"Quora"]})]})]})]}):e.jsxs("div",{className:"text-center p-6 bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx(X,{className:"w-12 h-12 mx-auto mb-3 text-blue-600"}),e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Create Google Doc"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Create a publicly accessible Google Document with quiz data as JSON"}),e.jsx("button",{onClick:H,disabled:D,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:D?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating Document..."]}):"Create Google Doc"})]})})]}),e.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:e.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Close"})})]})})},Ie=({quiz:g,onSave:l,onClose:N})=>{const{showError:y,showWarning:w}=W(),E={...g,questions:g.questions.map(s=>({...s,answerId:s.answerId||s.correctChoiceId||s.choices&&s.choices[0]?.id||"a"}))},[o,f]=u.useState(JSON.parse(JSON.stringify(E))),[n,z]=u.useState(0),[b,v]=u.useState(!1);u.useEffect(()=>{console.log("ðŸ“ Quiz Editor - Loaded quiz:",{title:g.title,questionCount:g.questions.length,firstQuestion:g.questions[0],normalized:E.questions[0]})},[]),u.useEffect(()=>{const s=JSON.stringify(g)!==JSON.stringify(o);v(s)},[g,o]);const x=o.questions[n];u.useEffect(()=>{x&&console.log("ðŸ“‹ Current Question:",{index:n,answerId:x.answerId,choices:x.choices.map(s=>({id:s.id,text:s.text.substring(0,30)}))})},[n,x]);const S=s=>{f({...o,title:s})},Q=s=>{const a=[...o.questions];a[n]={...a[n],prompt:s},f({...o,questions:a})},I=s=>{const a=[...o.questions];a[n]={...a[n],explanation:s},f({...o,questions:a})},D=(s,a)=>{const c=[...o.questions],m=[...c[n].choices];m[s]={...m[s],text:a},c[n]={...c[n],choices:m},f({...o,questions:c})},M=s=>{console.log("âœ… Setting correct answer:",{questionIndex:n,choiceId:s,currentAnswerId:o.questions[n].answerId});const a=[...o.questions];a[n]={...a[n],answerId:s},f({...o,questions:a})},C=()=>{const s=[...o.questions],a=[...s[n].choices],c=String.fromCharCode(97+a.length);a.push({id:c,text:""}),s[n]={...s[n],choices:a},f({...o,questions:s})},k=s=>{const a=[...o.questions],c=[...a[n].choices],m=c[s].id;if(c.length<=2){w("A question must have at least 2 choices");return}c.splice(s,1);let p=a[n].answerId;p===m&&(p=c[0].id),a[n]={...a[n],choices:c,answerId:p},f({...o,questions:a})},L=()=>{const a={id:`q${o.questions.length+1}`,prompt:"",choices:[{id:"a",text:""},{id:"b",text:""}],answerId:"a",explanation:""};f({...o,questions:[...o.questions,a]}),z(o.questions.length)},j=()=>{if(o.questions.length<=1){w("A quiz must have at least 1 question");return}if(!confirm(`Delete question ${n+1}?`))return;const s=[...o.questions];s.splice(n,1),f({...o,questions:s}),n>=s.length&&z(s.length-1)},A=()=>{if(!o.title.trim()){y("Quiz title is required");return}for(let a=0;a<o.questions.length;a++){const c=o.questions[a];if(!c.prompt.trim()){y(`Question ${a+1} is missing a prompt`);return}if(c.choices.length<2){y(`Question ${a+1} must have at least 2 choices`);return}for(let p=0;p<c.choices.length;p++)if(!c.choices[p].text.trim()){y(`Question ${a+1}, choice ${p+1} is empty`);return}if(!c.choices.some(p=>p.id===c.answerId)){y(`Question ${a+1} has an invalid correct answer`),console.error("Invalid correct answer:",{question:a+1,answerId:c.answerId,availableChoices:c.choices.map(p=>p.id)});return}}const s={...o,questions:o.questions.map(a=>{const{correctChoiceId:c,...m}=a;return m})};console.log("ðŸ’¾ Editor saving cleaned quiz:",{title:s.title,questionCount:s.questions.length,firstQuestion:{answerId:s.questions[0].answerId,hasCorrectChoiceId:"correctChoiceId"in o.questions[0]}}),l(s)},q=()=>{b&&!confirm("You have unsaved changes. Are you sure you want to close?")||N()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Quiz"}),e.jsx("button",{onClick:q,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(le,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quiz Title"}),e.jsx("input",{type:"text",value:o.title,onChange:s=>S(s.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter quiz title"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:["Question ",n+1," of ",o.questions.length]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>z(Math.max(0,n-1)),disabled:n===0,className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:"Previous question",children:"â—€"}),e.jsx("select",{value:n,onChange:s=>z(parseInt(s.target.value)),className:"px-3 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:o.questions.map((s,a)=>e.jsxs("option",{value:a,children:["Question ",a+1]},a))}),e.jsx("button",{onClick:()=>z(Math.min(o.questions.length-1,n+1)),disabled:n===o.questions.length-1,className:"px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors",title:"Next question",children:"â–¶"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:L,className:"px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm flex items-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),"Add Question"]}),e.jsxs("button",{onClick:j,disabled:o.questions.length<=1,className:"px-3 py-1 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors text-sm flex items-center gap-1",children:[e.jsx(J,{className:"w-4 h-4"}),"Delete"]})]})]}),x&&e.jsxs("div",{className:"space-y-4 border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Question Prompt"}),e.jsx("textarea",{value:x.prompt,onChange:s=>Q(s.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,placeholder:"Enter the question"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Answer Choices"}),e.jsxs("button",{onClick:C,className:"px-2 py-1 bg-blue-600 text-white rounded text-xs flex items-center gap-1 hover:bg-blue-700 transition-colors",children:[e.jsx(K,{className:"w-3 h-3"}),"Add Choice"]})]}),e.jsx("div",{className:"space-y-2",children:x.choices.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>M(s.id),className:`flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-colors ${x.answerId===s.id?"border-green-500 bg-green-500":"border-gray-300 dark:border-gray-600 hover:border-green-500"}`,title:"Mark as correct answer",children:x.answerId===s.id&&e.jsx(Ne,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"flex-shrink-0 w-6 text-sm font-medium text-gray-600 dark:text-gray-400",children:s.id.toUpperCase()}),e.jsx("input",{type:"text",value:s.text,onChange:c=>D(a,c.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:`Choice ${s.id.toUpperCase()}`}),e.jsx("button",{onClick:()=>k(a),disabled:x.choices.length<=2,className:"flex-shrink-0 p-2 text-red-600 hover:text-red-700 disabled:text-gray-400 disabled:cursor-not-allowed",title:"Delete choice",children:e.jsx(J,{className:"w-4 h-4"})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Explanation (Optional)"}),e.jsx("textarea",{value:x.explanation||"",onChange:s=>I(s.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,placeholder:"Optional explanation for the correct answer"})]})]})]}),e.jsxs("div",{className:"flex justify-between items-center gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:b&&e.jsx("span",{className:"text-orange-600 dark:text-orange-400",children:"â— Unsaved changes"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:q,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:A,disabled:!b,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:"Save Changes"})]})]})]})})};function Me(){const g=de(),{t:l}=ce(),{showSuccess:N,showError:y,showWarning:w}=W(),{getToken:E}=ue(),{getCurrentProjectId:o,currentProject:f}=ge(),[n,z]=u.useState([]),b=u.useMemo(()=>{const t=f?.id||null;return t?n.filter(r=>r.projectId===t):n.filter(r=>!r.projectId)},[n,f]),[v,x]=u.useState(null),[S,Q]=u.useState(!0),[I,D]=u.useState(0),[M,C]=u.useState(!1),[k,L]=u.useState(null),[j,A]=u.useState(null),[q,s]=u.useState(null),[a,c]=u.useState(null);u.useEffect(()=>{m();const t=()=>{console.log("ðŸ”” Quiz saved event received, reloading statistics"),m()};return window.addEventListener("quiz-saved",t),()=>{window.removeEventListener("quiz-saved",t)}},[]),u.useEffect(()=>{if(I===0||!(()=>{const h=localStorage.getItem("google_drive_access_token"),U=localStorage.getItem("auto_sync_enabled")==="true";return h&&h.length>0&&U})())return;const r=setTimeout(async()=>{try{(await he.syncQuizProgress()).success&&console.log("âœ… Quiz progress synced to Google Drive")}catch(h){console.error("âŒ Failed to sync quiz progress:",h)}},1e4);return()=>clearTimeout(r)},[I]),u.useEffect(()=>{const t=()=>{document.hidden||(console.log("Quiz page visible - reloading statistics"),m())};return document.addEventListener("visibilitychange",t),window.addEventListener("focus",m),()=>{document.removeEventListener("visibilitychange",t),window.removeEventListener("focus",m)}},[]);const m=async()=>{try{Q(!0);const[t,r]=await Promise.all([$.getQuizStatistics(20),$.getStatisticsSummary()]);console.log("ðŸ“Š Loaded quiz statistics:",{totalQuizzes:t.length,completed:t.filter(h=>h.completed).length,incomplete:t.filter(h=>!h.completed).length,quizzes:t.map(h=>({id:h.id.substring(0,8),title:h.quizTitle,completed:h.completed,hasQuizData:!!h.quizData,firstQuestionAnswerId:h.quizData?.questions?.[0]?.answerId}))}),z(t),x(r)}catch(t){console.error("Failed to load quiz statistics:",t),y(l("quiz.errorLoadingStats"))}finally{Q(!1)}},p=async(t,r)=>{if(confirm(l("quiz.confirmDelete",{title:r})))try{await $.deleteQuizStatistic(t),N(l("quiz.quizDeleted")),await m()}catch(h){console.error("Failed to delete quiz:",h),y(l("quiz.errorDeletingQuiz"))}},R=t=>{if(!t.quizData){y("Quiz data not available for editing");return}c({quiz:t.quizData,statId:t.id})},B=async t=>{if(a)try{console.log("ðŸ’¾ Saving edited quiz:",{statId:a.statId,title:t.title,questionCount:t.questions.length,firstQuestionAnswerId:t.questions[0]?.answerId}),await $.updateQuizData(a.statId,t),N("Quiz updated successfully"),c(null),await m(),console.log("âœ… Quiz saved and statistics reloaded")}catch(r){y("Failed to update quiz"),console.error("Quiz update error:",r)}},H=async t=>{try{const r=await $.getQuizStatistic(t.id);if(!r){y("Quiz not found");return}if(!r.quizData){console.log("âš ï¸ Quiz data not available for:",r.quizTitle),y("Quiz data not available. Please generate a new quiz instead.");return}console.log("ðŸŽ® Starting quiz (fresh from DB):",{title:r.quizTitle,statId:r.id,questionCount:r.quizData?.questions?.length,firstQuestionAnswerId:r.quizData?.questions?.[0]?.answerId}),A({snippetIds:r.snippetIds,startTime:Date.now(),enrichment:r.enrichment,quizId:r.id}),console.log("ðŸ“¦ Setting currentQuiz state:",{title:r.quizData.title,questionCount:r.quizData.questions.length,firstQuestion:{id:r.quizData.questions[0].id,answerId:r.quizData.questions[0].answerId,correctChoiceId:r.quizData.questions[0].correctChoiceId}}),L(r.quizData),C(!0)}catch(r){console.error("Failed to load quiz:",r),y("Failed to load quiz")}},O=t=>{const r=Math.floor(t/6e4),h=Math.floor(t%6e4/1e3);return`${r}:${h.toString().padStart(2,"0")}`},i=t=>{const r=new Date(t),U=new Date().getTime()-r.getTime(),T=Math.floor(U/(1e3*60*60*24));return T===0?l("quiz.today"):T===1?l("quiz.yesterday"):T<7?l("quiz.daysAgo",{days:T}):r.toLocaleDateString()},d=t=>t>=90?"text-green-600 dark:text-green-400":t>=70?"text-blue-600 dark:text-blue-400":t>=50?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400",F=t=>t>=90?"bg-green-100 dark:bg-green-900/30":t>=70?"bg-blue-100 dark:bg-blue-900/30":t>=50?"bg-yellow-100 dark:bg-yellow-900/30":"bg-red-100 dark:bg-red-900/30";return S?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:l("quiz.loadingStats")})}):e.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4 pb-24",children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>g("/"),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-800 rounded-lg transition-colors",title:l("quiz.backToChat"),children:e.jsx(ve,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white flex items-center gap-2 quiz-page-header","data-testid":"quiz-page-title",children:[e.jsx(G,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"}),l("quiz.title")]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:l("quiz.subtitle")})]})]})}),v&&v.totalQuizzes>0&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:l("quiz.totalQuizzes")}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:v.totalQuizzes})]}),e.jsx(Z,{className:"w-12 h-12 text-yellow-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:l("quiz.averageScore")}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:[v.averagePercentage.toFixed(0),"%"]})]}),e.jsx(Se,{className:"w-12 h-12 text-blue-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:l("quiz.highestScore")}),e.jsxs("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:[v.highestScore.toFixed(0),"%"]})]}),e.jsx(Z,{className:"w-12 h-12 text-green-500"})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:l("quiz.questionsAnswered")}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:v.totalQuestionsAnswered})]}),e.jsx(G,{className:"w-12 h-12 text-indigo-500"})]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:l("quiz.recentQuizzes")})}),b.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(G,{className:"w-16 h-16 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:l("quiz.noQuizzesYet")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:l("quiz.noQuizzesDescription")}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4 max-w-md mx-auto",children:["ðŸ’¡ ",l("quiz.quizMeHelp")]})]}):e.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:b.map(t=>e.jsx("div",{className:`p-6 transition-colors cursor-pointer ${t.completed?"hover:bg-gray-50 dark:hover:bg-gray-750":"bg-yellow-50 dark:bg-yellow-900/20 hover:bg-yellow-100 dark:hover:bg-yellow-900/30 border-l-4 border-yellow-500"}`,onClick:()=>H(t),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:t.quizTitle}),t.completed?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${F(t.percentage)} ${d(t.percentage)}`,children:[t.score,"/",t.totalQuestions," (",t.percentage,"%)"]}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 rounded text-xs font-medium",children:l("quiz.clickToRetake")||"Click to Retake"})]}):e.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-semibold bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200",children:l("quiz.clickToRestart")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"w-4 h-4"}),i(t.completedAt)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"w-4 h-4"}),O(t.timeTaken)]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"}),l("quiz.snippetCount",{count:t.snippetIds.length})]}),t.enrichment&&e.jsx("span",{className:"px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded text-xs font-medium",children:l("quiz.enriched")}),!t.synced&&e.jsx("span",{className:"px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400 rounded text-xs font-medium",children:l("quiz.notSynced")})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.quizData&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),R(t)},className:"p-2 text-gray-400 hover:text-purple-600 dark:hover:text-purple-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 rounded-lg transition-colors",title:"Edit Quiz",children:e.jsx(Ce,{className:"w-5 h-5"})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),s({quiz:t.quizData,enrichment:t.enrichment||!1})},className:"p-2 text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg transition-colors",title:l("quiz.shareQuiz")||"Share Quiz",children:e.jsx(xe,{className:"w-5 h-5"})})]}),e.jsx("button",{onClick:r=>{r.stopPropagation(),p(t.id,t.quizTitle)},className:"p-2 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",title:l("quiz.deleteQuiz"),children:e.jsx(J,{className:"w-5 h-5"})})]})]})},t.id))})]})]}),M&&k&&j&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx(me,{quiz:(()=>{const t={title:k.title,questions:k.questions.map(r=>({id:r.id,prompt:r.prompt,choices:r.choices,answerId:r.answerId||r.correctChoiceId,explanation:r.explanation}))};return console.log("ðŸŽ¯ Passing quiz to QuizCard:",{title:t.title,questionCount:t.questions.length,firstQuestion:{id:t.questions[0].id,answerId:t.questions[0].answerId,originalAnswerId:k.questions[0].answerId,originalCorrectChoiceId:k.questions[0].correctChoiceId}}),t})(),onClose:()=>{console.log("âŒ Quiz modal closed without completion"),console.log("ðŸ“ Quiz should remain in database as incomplete"),C(!1),L(null),A(null),m()},onComplete:async(t,r,h)=>{const U=Math.round(t/r*100),T=Date.now()-j.startTime;try{if(j.quizId){await $.updateQuizCompletion(j.quizId,t,T,h);const P=await E();P&&be(j.quizId,P).then(V=>{V&&(console.log("âœ… Quiz statistic synced to Google Sheets"),m())}).catch(V=>{console.error("Failed to sync quiz statistic:",V)})}else{console.warn("No quizId found, using fallback save method");const P=o();await $.saveQuizStatistic({quizTitle:k.title,snippetIds:j.snippetIds,score:t,totalQuestions:r,timeTaken:T,completedAt:new Date().toISOString(),answers:h,enrichment:j.enrichment,completed:!0,projectId:P||void 0})}N(`Quiz completed! Score: ${t}/${r} (${U}%)`),await m(),D(Date.now())}catch(P){console.error("Failed to save quiz statistic:",P),w(`Quiz completed! Score: ${t}/${r} (${U}%) - Statistics not saved`)}}},j.quizId||Date.now())}),q&&e.jsx(Qe,{quiz:q.quiz,enrichment:q.enrichment,onClose:()=>s(null)}),a&&e.jsx(Ie,{quiz:a.quiz,onSave:B,onClose:()=>c(null)})]})}export{Me as default};

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-BgwRgTgO.js","assets/mixin-D3UDm--6.js","assets/hls-CELkTLgi.js","assets/react-6yh3z1qW.js","assets/index-CzhhGkFT.js","assets/dagre-6UL2VRFP-C8fUn5EQ.js","assets/graph-CrwziaQC.js","assets/_baseUniq-DLoGu_Eh.js","assets/layout-DnhZk70C.js","assets/_basePickBy-DBzCvoUL.js","assets/clone-D0aMEe7z.js","assets/cose-bilkent-S5V4N54A-BkfD0FQ4.js","assets/cytoscape.esm-DtBltrT8.js","assets/c4Diagram-YG6GDRKO-DrSPZLYj.js","assets/chunk-TZMSLE5B-CDGXbGRx.js","assets/flowDiagram-NV44I4VS-I8YGEdNz.js","assets/chunk-FMBD7UC4-DduGyolw.js","assets/chunk-55IACEB6-DUddMMx3.js","assets/chunk-QN33PNHL-D5pPClfZ.js","assets/channel-Ddrh1-pm.js","assets/erDiagram-Q2GNP2WA-C0OwjZqH.js","assets/gitGraphDiagram-NY62KEGX-Bf8-7ukw.js","assets/chunk-4BX2VUAB-o4nHFhj3.js","assets/chunk-QZHKN3VN-CzQtBaHZ.js","assets/treemap-KMMF4GRG-C5my6k_6.js","assets/ganttDiagram-LVOFAZNH-lgv3C4vH.js","assets/linear-DhdreaaM.js","assets/init-Gi6I4Gst.js","assets/defaultLocale-C4B-KCzX.js","assets/infoDiagram-ER5ION4S-4Vvq_qi5.js","assets/pieDiagram-ADFJNKIX-B9vZy7N4.js","assets/arc-BOQMStX_.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-AYHSOK5B-0pxOt2Y5.js","assets/xychartDiagram-PRI3JC2R-DDGSKkFQ.js","assets/requirementDiagram-UZGBJVZJ-BWU2n5RW.js","assets/sequenceDiagram-WL72ISMW-BmpULOhB.js","assets/classDiagram-2ON5EDUG-BGdlxuoR.js","assets/chunk-B4BG7PRW-BJS9BrSk.js","assets/classDiagram-v2-WZHVMYZB-BGdlxuoR.js","assets/stateDiagram-FKZM4ZOC-DuWb9AjL.js","assets/chunk-DI55MBZ5-n3jCKYay.js","assets/stateDiagram-v2-4FDKWEC3-FMNcHS7x.js","assets/journeyDiagram-XKPGCS4Q-CQME5Dyx.js","assets/timeline-definition-IT6M3QCI-DzkVFeOB.js","assets/mindmap-definition-VGOIOE7T-wwdUAZDS.js","assets/kanban-definition-3W4ZIXB7-DLKiBjLb.js","assets/sankeyDiagram-TZEHDZUN-7CsYBkdB.js","assets/diagram-S2PKOQOG-Bee4dERD.js","assets/diagram-QEK2KX5R-CaOH9FFA.js","assets/blockDiagram-VD42YOAC-DJyg46GX.js","assets/architectureDiagram-VXUJARFQ-pnmSoS_n.js","assets/diagram-PSM6KHXK-BFnEm6TM.js","assets/SettingsPage-DksCBMEA.js","assets/clock-CLLU6ims.js","assets/SettingsPage-CYM99hmN.css","assets/SwagPage-CtvlMrME.js","assets/TagAutocomplete-C420LHBA.js","assets/TagAutocomplete-ColNjS-V.css","assets/quizSync-Bwxxk9nX.js","assets/SwagPage-C9Ya2yOB.css","assets/SnippetViewPage-DJrasvNm.js","assets/tag-CQacTKyP.js","assets/QuizPage-Dtz7OxHe.js","assets/quizShareUtils-lBs1i8d3.js","assets/calendar-D11I0Qwn.js","assets/FeedPage-2v1a6a1L.js","assets/loader-circle-BOs7g56h.js","assets/BillingPage-BfgKwe7t.js","assets/BillingPage-CLxBDKkQ.css","assets/SharedQuizViewer-Ba5g4Ah1.js","assets/MusicPage-BwSIXG5o.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var KB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function eP(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){var a=!1;try{a=this instanceof n}catch{}return a?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var a=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return t[n]}})}),r}var av={exports:{}},xp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sE;function XB(){if(sE)return xp;sE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,s){var i=null;if(s!==void 0&&(i=""+s),a.key!==void 0&&(i=""+a.key),"key"in a){s={};for(var l in a)l!=="key"&&(s[l]=a[l])}else s=a;return a=s.ref,{$$typeof:t,type:n,key:i,ref:a!==void 0?a:null,props:s}}return xp.Fragment=e,xp.jsx=r,xp.jsxs=r,xp}var iE;function JB(){return iE||(iE=1,av.exports=XB()),av.exports}var u=JB(),sv={exports:{}},vp={},iv={exports:{}},ov={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oE;function ZB(){return oE||(oE=1,(function(t){function e(H,re){var ne=H.length;H.push(re);e:for(;0<ne;){var ve=ne-1>>>1,O=H[ve];if(0<a(O,re))H[ve]=re,H[ne]=O,ne=ve;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var re=H[0],ne=H.pop();if(ne!==re){H[0]=ne;e:for(var ve=0,O=H.length,I=O>>>1;ve<I;){var K=2*(ve+1)-1,U=H[K],ce=K+1,ye=H[ce];if(0>a(U,ne))ce<O&&0>a(ye,U)?(H[ve]=ye,H[ce]=ne,ve=ce):(H[ve]=U,H[K]=ne,ve=K);else if(ce<O&&0>a(ye,ne))H[ve]=ye,H[ce]=ne,ve=ce;else break e}}return re}function a(H,re){var ne=H.sortIndex-re.sortIndex;return ne!==0?ne:H.id-re.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],p=1,g=null,m=3,y=!1,x=!1,w=!1,T=!1,k=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function F(H){for(var re=r(d);re!==null;){if(re.callback===null)n(d);else if(re.startTime<=H)n(d),re.sortIndex=re.expirationTime,e(c,re);else break;re=r(d)}}function D(H){if(w=!1,F(H),!x)if(r(c)!==null)x=!0,B||(B=!0,te());else{var re=r(d);re!==null&&W(D,re.startTime-H)}}var B=!1,M=-1,$=5,Z=-1;function z(){return T?!0:!(t.unstable_now()-Z<$)}function ee(){if(T=!1,B){var H=t.unstable_now();Z=H;var re=!0;try{e:{x=!1,w&&(w=!1,_(M),M=-1),y=!0;var ne=m;try{t:{for(F(H),g=r(c);g!==null&&!(g.expirationTime>H&&z());){var ve=g.callback;if(typeof ve=="function"){g.callback=null,m=g.priorityLevel;var O=ve(g.expirationTime<=H);if(H=t.unstable_now(),typeof O=="function"){g.callback=O,F(H),re=!0;break t}g===r(c)&&n(c),F(H)}else n(c);g=r(c)}if(g!==null)re=!0;else{var I=r(d);I!==null&&W(D,I.startTime-H),re=!1}}break e}finally{g=null,m=ne,y=!1}re=void 0}}finally{re?te():B=!1}}}var te;if(typeof P=="function")te=function(){P(ee)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,Q=X.port2;X.port1.onmessage=ee,te=function(){Q.postMessage(null)}}else te=function(){k(ee,0)};function W(H,re){M=k(function(){H(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_next=function(H){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var ne=m;m=re;try{return H()}finally{m=ne}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(H,re){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var ne=m;m=H;try{return re()}finally{m=ne}},t.unstable_scheduleCallback=function(H,re,ne){var ve=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?ve+ne:ve):ne=ve,H){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ne+O,H={id:p++,callback:re,priorityLevel:H,startTime:ne,expirationTime:O,sortIndex:-1},ne>ve?(H.sortIndex=ne,e(d,H),r(c)===null&&H===r(d)&&(w?(_(M),M=-1):w=!0,W(D,ne-ve))):(H.sortIndex=O,e(c,H),x||y||(x=!0,B||(B=!0,te()))),H},t.unstable_shouldYield=z,t.unstable_wrapCallback=function(H){var re=m;return function(){var ne=m;m=re;try{return H.apply(this,arguments)}finally{m=ne}}}})(ov)),ov}var lE;function eF(){return lE||(lE=1,iv.exports=ZB()),iv.exports}var lv={exports:{}},qr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function tF(){if(cE)return qr;cE=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.for("react.activity"),m=Symbol.iterator;function y(I){return I===null||typeof I!="object"?null:(I=m&&I[m]||I["@@iterator"],typeof I=="function"?I:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function k(I,K,U){this.props=I,this.context=K,this.refs=T,this.updater=U||x}k.prototype.isReactComponent={},k.prototype.setState=function(I,K){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,K,"setState")},k.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function _(){}_.prototype=k.prototype;function P(I,K,U){this.props=I,this.context=K,this.refs=T,this.updater=U||x}var F=P.prototype=new _;F.constructor=P,w(F,k.prototype),F.isPureReactComponent=!0;var D=Array.isArray;function B(){}var M={H:null,A:null,T:null,S:null},$=Object.prototype.hasOwnProperty;function Z(I,K,U){var ce=U.ref;return{$$typeof:t,type:I,key:K,ref:ce!==void 0?ce:null,props:U}}function z(I,K){return Z(I.type,K,I.props)}function ee(I){return typeof I=="object"&&I!==null&&I.$$typeof===t}function te(I){var K={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(U){return K[U]})}var X=/\/+/g;function Q(I,K){return typeof I=="object"&&I!==null&&I.key!=null?te(""+I.key):K.toString(36)}function W(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(B,B):(I.status="pending",I.then(function(K){I.status==="pending"&&(I.status="fulfilled",I.value=K)},function(K){I.status==="pending"&&(I.status="rejected",I.reason=K)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function H(I,K,U,ce,ye){var Ae=typeof I;(Ae==="undefined"||Ae==="boolean")&&(I=null);var fe=!1;if(I===null)fe=!0;else switch(Ae){case"bigint":case"string":case"number":fe=!0;break;case"object":switch(I.$$typeof){case t:case e:fe=!0;break;case p:return fe=I._init,H(fe(I._payload),K,U,ce,ye)}}if(fe)return ye=ye(I),fe=ce===""?"."+Q(I,0):ce,D(ye)?(U="",fe!=null&&(U=fe.replace(X,"$&/")+"/"),H(ye,K,U,"",function(se){return se})):ye!=null&&(ee(ye)&&(ye=z(ye,U+(ye.key==null||I&&I.key===ye.key?"":(""+ye.key).replace(X,"$&/")+"/")+fe)),K.push(ye)),1;fe=0;var Ne=ce===""?".":ce+":";if(D(I))for(var Te=0;Te<I.length;Te++)ce=I[Te],Ae=Ne+Q(ce,Te),fe+=H(ce,K,U,Ae,ye);else if(Te=y(I),typeof Te=="function")for(I=Te.call(I),Te=0;!(ce=I.next()).done;)ce=ce.value,Ae=Ne+Q(ce,Te++),fe+=H(ce,K,U,Ae,ye);else if(Ae==="object"){if(typeof I.then=="function")return H(W(I),K,U,ce,ye);throw K=String(I),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return fe}function re(I,K,U){if(I==null)return I;var ce=[],ye=0;return H(I,ce,"","",function(Ae){return K.call(U,Ae,ye++)}),ce}function ne(I){if(I._status===-1){var K=I._result;K=K(),K.then(function(U){(I._status===0||I._status===-1)&&(I._status=1,I._result=U)},function(U){(I._status===0||I._status===-1)&&(I._status=2,I._result=U)}),I._status===-1&&(I._status=0,I._result=K)}if(I._status===1)return I._result.default;throw I._result}var ve=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(K))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},O={map:re,forEach:function(I,K,U){re(I,function(){K.apply(this,arguments)},U)},count:function(I){var K=0;return re(I,function(){K++}),K},toArray:function(I){return re(I,function(K){return K})||[]},only:function(I){if(!ee(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return qr.Activity=g,qr.Children=O,qr.Component=k,qr.Fragment=r,qr.Profiler=a,qr.PureComponent=P,qr.StrictMode=n,qr.Suspense=c,qr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=M,qr.__COMPILER_RUNTIME={__proto__:null,c:function(I){return M.H.useMemoCache(I)}},qr.cache=function(I){return function(){return I.apply(null,arguments)}},qr.cacheSignal=function(){return null},qr.cloneElement=function(I,K,U){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var ce=w({},I.props),ye=I.key;if(K!=null)for(Ae in K.key!==void 0&&(ye=""+K.key),K)!$.call(K,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&K.ref===void 0||(ce[Ae]=K[Ae]);var Ae=arguments.length-2;if(Ae===1)ce.children=U;else if(1<Ae){for(var fe=Array(Ae),Ne=0;Ne<Ae;Ne++)fe[Ne]=arguments[Ne+2];ce.children=fe}return Z(I.type,ye,ce)},qr.createContext=function(I){return I={$$typeof:i,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:s,_context:I},I},qr.createElement=function(I,K,U){var ce,ye={},Ae=null;if(K!=null)for(ce in K.key!==void 0&&(Ae=""+K.key),K)$.call(K,ce)&&ce!=="key"&&ce!=="__self"&&ce!=="__source"&&(ye[ce]=K[ce]);var fe=arguments.length-2;if(fe===1)ye.children=U;else if(1<fe){for(var Ne=Array(fe),Te=0;Te<fe;Te++)Ne[Te]=arguments[Te+2];ye.children=Ne}if(I&&I.defaultProps)for(ce in fe=I.defaultProps,fe)ye[ce]===void 0&&(ye[ce]=fe[ce]);return Z(I,Ae,ye)},qr.createRef=function(){return{current:null}},qr.forwardRef=function(I){return{$$typeof:l,render:I}},qr.isValidElement=ee,qr.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:ne}},qr.memo=function(I,K){return{$$typeof:d,type:I,compare:K===void 0?null:K}},qr.startTransition=function(I){var K=M.T,U={};M.T=U;try{var ce=I(),ye=M.S;ye!==null&&ye(U,ce),typeof ce=="object"&&ce!==null&&typeof ce.then=="function"&&ce.then(B,ve)}catch(Ae){ve(Ae)}finally{K!==null&&U.types!==null&&(K.types=U.types),M.T=K}},qr.unstable_useCacheRefresh=function(){return M.H.useCacheRefresh()},qr.use=function(I){return M.H.use(I)},qr.useActionState=function(I,K,U){return M.H.useActionState(I,K,U)},qr.useCallback=function(I,K){return M.H.useCallback(I,K)},qr.useContext=function(I){return M.H.useContext(I)},qr.useDebugValue=function(){},qr.useDeferredValue=function(I,K){return M.H.useDeferredValue(I,K)},qr.useEffect=function(I,K){return M.H.useEffect(I,K)},qr.useEffectEvent=function(I){return M.H.useEffectEvent(I)},qr.useId=function(){return M.H.useId()},qr.useImperativeHandle=function(I,K,U){return M.H.useImperativeHandle(I,K,U)},qr.useInsertionEffect=function(I,K){return M.H.useInsertionEffect(I,K)},qr.useLayoutEffect=function(I,K){return M.H.useLayoutEffect(I,K)},qr.useMemo=function(I,K){return M.H.useMemo(I,K)},qr.useOptimistic=function(I,K){return M.H.useOptimistic(I,K)},qr.useReducer=function(I,K,U){return M.H.useReducer(I,K,U)},qr.useRef=function(I){return M.H.useRef(I)},qr.useState=function(I){return M.H.useState(I)},qr.useSyncExternalStore=function(I,K,U){return M.H.useSyncExternalStore(I,K,U)},qr.useTransition=function(){return M.H.useTransition()},qr.version="19.2.0",qr}var uE;function Kg(){return uE||(uE=1,lv.exports=tF()),lv.exports}var cv={exports:{}},hs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function rF(){if(dE)return hs;dE=1;var t=Kg();function e(c){var d="https://react.dev/errors/"+c;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+c+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function s(c,d,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:g==null?null:""+g,children:c,containerInfo:d,implementation:p}}var i=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,d){if(c==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return hs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,hs.createPortal=function(c,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(c,d,null,p)},hs.flushSync=function(c){var d=i.T,p=n.p;try{if(i.T=null,n.p=2,c)return c()}finally{i.T=d,n.p=p,n.d.f()}},hs.preconnect=function(c,d){typeof c=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(c,d))},hs.prefetchDNS=function(c){typeof c=="string"&&n.d.D(c)},hs.preinit=function(c,d){if(typeof c=="string"&&d&&typeof d.as=="string"){var p=d.as,g=l(p,d.crossOrigin),m=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(c,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:g,integrity:m,fetchPriority:y}):p==="script"&&n.d.X(c,{crossOrigin:g,integrity:m,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},hs.preinitModule=function(c,d){if(typeof c=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=l(d.as,d.crossOrigin);n.d.M(c,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(c)},hs.preload=function(c,d){if(typeof c=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,g=l(p,d.crossOrigin);n.d.L(c,p,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},hs.preloadModule=function(c,d){if(typeof c=="string")if(d){var p=l(d.as,d.crossOrigin);n.d.m(c,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(c)},hs.requestFormReset=function(c){n.d.r(c)},hs.unstable_batchedUpdates=function(c,d){return c(d)},hs.useFormState=function(c,d,p){return i.H.useFormState(c,d,p)},hs.useFormStatus=function(){return i.H.useHostTransitionStatus()},hs.version="19.2.0",hs}var hE;function tP(){if(hE)return cv.exports;hE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),cv.exports=rF(),cv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE;function nF(){if(pE)return vp;pE=1;var t=eF(),e=Kg(),r=tP();function n(o){var h="https://react.dev/errors/"+o;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)h+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var h=o,f=o;if(o.alternate)for(;h.return;)h=h.return;else{o=h;do h=o,(h.flags&4098)!==0&&(f=h.return),o=h.return;while(o)}return h.tag===3?f:null}function i(o){if(o.tag===13){var h=o.memoizedState;if(h===null&&(o=o.alternate,o!==null&&(h=o.memoizedState)),h!==null)return h.dehydrated}return null}function l(o){if(o.tag===31){var h=o.memoizedState;if(h===null&&(o=o.alternate,o!==null&&(h=o.memoizedState)),h!==null)return h.dehydrated}return null}function c(o){if(s(o)!==o)throw Error(n(188))}function d(o){var h=o.alternate;if(!h){if(h=s(o),h===null)throw Error(n(188));return h!==o?null:o}for(var f=o,b=h;;){var S=f.return;if(S===null)break;var E=S.alternate;if(E===null){if(b=S.return,b!==null){f=b;continue}break}if(S.child===E.child){for(E=S.child;E;){if(E===f)return c(S),o;if(E===b)return c(S),h;E=E.sibling}throw Error(n(188))}if(f.return!==b.return)f=S,b=E;else{for(var q=!1,ae=S.child;ae;){if(ae===f){q=!0,f=S,b=E;break}if(ae===b){q=!0,b=S,f=E;break}ae=ae.sibling}if(!q){for(ae=E.child;ae;){if(ae===f){q=!0,f=E,b=S;break}if(ae===b){q=!0,b=E,f=S;break}ae=ae.sibling}if(!q)throw Error(n(189))}}if(f.alternate!==b)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?o:h}function p(o){var h=o.tag;if(h===5||h===26||h===27||h===6)return o;for(o=o.child;o!==null;){if(h=p(o),h!==null)return h;o=o.sibling}return null}var g=Object.assign,m=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),_=Symbol.for("react.consumer"),P=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),$=Symbol.for("react.lazy"),Z=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function te(o){return o===null||typeof o!="object"?null:(o=ee&&o[ee]||o["@@iterator"],typeof o=="function"?o:null)}var X=Symbol.for("react.client.reference");function Q(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===X?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case w:return"Fragment";case k:return"Profiler";case T:return"StrictMode";case D:return"Suspense";case B:return"SuspenseList";case Z:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case x:return"Portal";case P:return o.displayName||"Context";case _:return(o._context.displayName||"Context")+".Consumer";case F:var h=o.render;return o=o.displayName,o||(o=h.displayName||h.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case M:return h=o.displayName||null,h!==null?h:Q(o.type)||"Memo";case $:h=o._payload,o=o._init;try{return Q(o(h))}catch{}}return null}var W=Array.isArray,H=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},ve=[],O=-1;function I(o){return{current:o}}function K(o){0>O||(o.current=ve[O],ve[O]=null,O--)}function U(o,h){O++,ve[O]=o.current,o.current=h}var ce=I(null),ye=I(null),Ae=I(null),fe=I(null);function Ne(o,h){switch(U(Ae,h),U(ye,o),U(ce,null),h.nodeType){case 9:case 11:o=(o=h.documentElement)&&(o=o.namespaceURI)?A2(o):0;break;default:if(o=h.tagName,h=h.namespaceURI)h=A2(h),o=N2(h,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}K(ce),U(ce,o)}function Te(){K(ce),K(ye),K(Ae)}function se(o){o.memoizedState!==null&&U(fe,o);var h=ce.current,f=N2(h,o.type);h!==f&&(U(ye,o),U(ce,f))}function be(o){ye.current===o&&(K(ce),K(ye)),fe.current===o&&(K(fe),fp._currentValue=ne)}var xe,me;function de(o){if(xe===void 0)try{throw Error()}catch(f){var h=f.stack.trim().match(/\n( *(at )?)/);xe=h&&h[1]||"",me=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+xe+o+me}var he=!1;function Ie(o,h){if(!o||he)return"";he=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var b={DetermineComponentFrameRoot:function(){try{if(h){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(it){var rt=it}Reflect.construct(o,[],xt)}else{try{xt.call()}catch(it){rt=it}o.call(xt.prototype)}}else{try{throw Error()}catch(it){rt=it}(xt=o())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(it){if(it&&rt&&typeof it.stack=="string")return[it.stack,rt.stack]}return[null,null]}};b.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(b.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(b.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var E=b.DetermineComponentFrameRoot(),q=E[0],ae=E[1];if(q&&ae){var Ce=q.split(`
`),et=ae.split(`
`);for(S=b=0;b<Ce.length&&!Ce[b].includes("DetermineComponentFrameRoot");)b++;for(;S<et.length&&!et[S].includes("DetermineComponentFrameRoot");)S++;if(b===Ce.length||S===et.length)for(b=Ce.length-1,S=et.length-1;1<=b&&0<=S&&Ce[b]!==et[S];)S--;for(;1<=b&&0<=S;b--,S--)if(Ce[b]!==et[S]){if(b!==1||S!==1)do if(b--,S--,0>S||Ce[b]!==et[S]){var pt=`
`+Ce[b].replace(" at new "," at ");return o.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",o.displayName)),pt}while(1<=b&&0<=S);break}}}finally{he=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?de(f):""}function ze(o,h){switch(o.tag){case 26:case 27:case 5:return de(o.type);case 16:return de("Lazy");case 13:return o.child!==h&&h!==null?de("Suspense Fallback"):de("Suspense");case 19:return de("SuspenseList");case 0:case 15:return Ie(o.type,!1);case 11:return Ie(o.type.render,!1);case 1:return Ie(o.type,!0);case 31:return de("Activity");default:return""}}function nt(o){try{var h="",f=null;do h+=ze(o,f),f=o,o=o.return;while(o);return h}catch(b){return`
Error generating stack: `+b.message+`
`+b.stack}}var mt=Object.prototype.hasOwnProperty,ht=t.unstable_scheduleCallback,er=t.unstable_cancelCallback,ct=t.unstable_shouldYield,Dt=t.unstable_requestPaint,kt=t.unstable_now,fr=t.unstable_getCurrentPriorityLevel,qe=t.unstable_ImmediatePriority,st=t.unstable_UserBlockingPriority,Gt=t.unstable_NormalPriority,Kt=t.unstable_LowPriority,lr=t.unstable_IdlePriority,Qe=t.log,Yt=t.unstable_setDisableYieldValue,ur=null,_t=null;function sr(o){if(typeof Qe=="function"&&Yt(o),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(ur,o)}catch{}}var vt=Math.clz32?Math.clz32:Ja,pn=Math.log,Ar=Math.LN2;function Ja(o){return o>>>=0,o===0?32:31-(pn(o)/Ar|0)|0}var zt=256,Ca=262144,Bs=4194304;function qn(o){var h=o&42;if(h!==0)return h;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Se(o,h,f){var b=o.pendingLanes;if(b===0)return 0;var S=0,E=o.suspendedLanes,q=o.pingedLanes;o=o.warmLanes;var ae=b&134217727;return ae!==0?(b=ae&~E,b!==0?S=qn(b):(q&=ae,q!==0?S=qn(q):f||(f=ae&~o,f!==0&&(S=qn(f))))):(ae=b&~E,ae!==0?S=qn(ae):q!==0?S=qn(q):f||(f=b&~o,f!==0&&(S=qn(f)))),S===0?0:h!==0&&h!==S&&(h&E)===0&&(E=S&-S,f=h&-h,E>=f||E===32&&(f&4194048)!==0)?h:S}function ut(o,h){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&h)===0}function Nt(o,h){switch(o){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xr(){var o=Bs;return Bs<<=1,(Bs&62914560)===0&&(Bs=4194304),o}function Kr(o){for(var h=[],f=0;31>f;f++)h.push(o);return h}function Xr(o,h){o.pendingLanes|=h,h!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function tr(o,h,f,b,S,E){var q=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var ae=o.entanglements,Ce=o.expirationTimes,et=o.hiddenUpdates;for(f=q&~f;0<f;){var pt=31-vt(f),xt=1<<pt;ae[pt]=0,Ce[pt]=-1;var rt=et[pt];if(rt!==null)for(et[pt]=null,pt=0;pt<rt.length;pt++){var it=rt[pt];it!==null&&(it.lane&=-536870913)}f&=~xt}b!==0&&Vt(o,b,0),E!==0&&S===0&&o.tag!==0&&(o.suspendedLanes|=E&~(q&~h))}function Vt(o,h,f){o.pendingLanes|=h,o.suspendedLanes&=~h;var b=31-vt(h);o.entangledLanes|=h,o.entanglements[b]=o.entanglements[b]|1073741824|f&261930}function Qt(o,h){var f=o.entangledLanes|=h;for(o=o.entanglements;f;){var b=31-vt(f),S=1<<b;S&h|o[b]&h&&(o[b]|=h),f&=~S}}function Or(o,h){var f=h&-h;return f=(f&42)!==0?1:Hr(f),(f&(o.suspendedLanes|h))!==0?0:f}function Hr(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Dn(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function Ba(){var o=re.p;return o!==0?o:(o=window.event,o===void 0?32:J2(o.type))}function Za(o,h){var f=re.p;try{return re.p=o,h()}finally{re.p=f}}var Ea=Math.random().toString(36).slice(2),an="__reactFiber$"+Ea,tn="__reactProps$"+Ea,ca="__reactContainer$"+Ea,_a="__reactEvents$"+Ea,Zi="__reactListeners$"+Ea,Zn="__reactHandles$"+Ea,Pi="__reactResources$"+Ea,rr="__reactMarker$"+Ea;function De(o){delete o[an],delete o[tn],delete o[_a],delete o[Zi],delete o[Zn]}function bt(o){var h=o[an];if(h)return h;for(var f=o.parentNode;f;){if(h=f[ca]||f[an]){if(f=h.alternate,h.child!==null||f!==null&&f.child!==null)for(o=O2(o);o!==null;){if(f=o[an])return f;o=O2(o)}return h}o=f,f=o.parentNode}return null}function Mt(o){if(o=o[an]||o[ca]){var h=o.tag;if(h===5||h===6||h===13||h===31||h===26||h===27||h===3)return o}return null}function zr(o){var h=o.tag;if(h===5||h===26||h===27||h===6)return o.stateNode;throw Error(n(33))}function rn(o){var h=o[Pi];return h||(h=o[Pi]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function jr(o){o[rr]=!0}var ir=new Set,Kn={};function Hn(o,h){Tt(o,h),Tt(o+"Capture",h)}function Tt(o,h){for(Kn[o]=h,o=0;o<h.length;o++)ir.add(h[o])}var qt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Lr={},Gr={};function Gn(o){return mt.call(Gr,o)?!0:mt.call(Lr,o)?!1:qt.test(o)?Gr[o]=!0:(Lr[o]=!0,!1)}function vr(o,h,f){if(Gn(h))if(f===null)o.removeAttribute(h);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(h);return;case"boolean":var b=h.toLowerCase().slice(0,5);if(b!=="data-"&&b!=="aria-"){o.removeAttribute(h);return}}o.setAttribute(h,""+f)}}function Fa(o,h,f){if(f===null)o.removeAttribute(h);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttribute(h,""+f)}}function ua(o,h,f,b){if(b===null)o.removeAttribute(f);else{switch(typeof b){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(h,f,""+b)}}function yn(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function xa(o){var h=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function ko(o,h,f){var b=Object.getOwnPropertyDescriptor(o.constructor.prototype,h);if(!o.hasOwnProperty(h)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var S=b.get,E=b.set;return Object.defineProperty(o,h,{configurable:!0,get:function(){return S.call(this)},set:function(q){f=""+q,E.call(this,q)}}),Object.defineProperty(o,h,{enumerable:b.enumerable}),{getValue:function(){return f},setValue:function(q){f=""+q},stopTracking:function(){o._valueTracker=null,delete o[h]}}}}function ci(o){if(!o._valueTracker){var h=xa(o)?"checked":"value";o._valueTracker=ko(o,h,""+o[h])}}function Ii(o){if(!o)return!1;var h=o._valueTracker;if(!h)return!0;var f=h.getValue(),b="";return o&&(b=xa(o)?o.checked?"true":"false":o.value),o=b,o!==f?(h.setValue(o),!0):!1}function _r(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Cs=/[\n"\\]/g;function da(o){return o.replace(Cs,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Fs(o,h,f,b,S,E,q,ae){o.name="",q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"?o.type=q:o.removeAttribute("type"),h!=null?q==="number"?(h===0&&o.value===""||o.value!=h)&&(o.value=""+yn(h)):o.value!==""+yn(h)&&(o.value=""+yn(h)):q!=="submit"&&q!=="reset"||o.removeAttribute("value"),h!=null?cs(o,q,yn(h)):f!=null?cs(o,q,yn(f)):b!=null&&o.removeAttribute("value"),S==null&&E!=null&&(o.defaultChecked=!!E),S!=null&&(o.checked=S&&typeof S!="function"&&typeof S!="symbol"),ae!=null&&typeof ae!="function"&&typeof ae!="symbol"&&typeof ae!="boolean"?o.name=""+yn(ae):o.removeAttribute("name")}function ui(o,h,f,b,S,E,q,ae){if(E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(o.type=E),h!=null||f!=null){if(!(E!=="submit"&&E!=="reset"||h!=null)){ci(o);return}f=f!=null?""+yn(f):"",h=h!=null?""+yn(h):f,ae||h===o.value||(o.value=h),o.defaultValue=h}b=b??S,b=typeof b!="function"&&typeof b!="symbol"&&!!b,o.checked=ae?o.checked:!!b,o.defaultChecked=!!b,q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(o.name=q),ci(o)}function cs(o,h,f){h==="number"&&_r(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function An(o,h,f,b){if(o=o.options,h){h={};for(var S=0;S<f.length;S++)h["$"+f[S]]=!0;for(f=0;f<o.length;f++)S=h.hasOwnProperty("$"+o[f].value),o[f].selected!==S&&(o[f].selected=S),S&&b&&(o[f].defaultSelected=!0)}else{for(f=""+yn(f),h=null,S=0;S<o.length;S++){if(o[S].value===f){o[S].selected=!0,b&&(o[S].defaultSelected=!0);return}h!==null||o[S].disabled||(h=o[S])}h!==null&&(h.selected=!0)}}function To(o,h,f){if(h!=null&&(h=""+yn(h),h!==o.value&&(o.value=h),f==null)){o.defaultValue!==h&&(o.defaultValue=h);return}o.defaultValue=f!=null?""+yn(f):""}function zs(o,h,f,b){if(h==null){if(b!=null){if(f!=null)throw Error(n(92));if(W(b)){if(1<b.length)throw Error(n(93));b=b[0]}f=b}f==null&&(f=""),h=f}f=yn(h),o.defaultValue=f,b=o.textContent,b===f&&b!==""&&b!==null&&(o.value=b),ci(o)}function kr(o,h){if(h){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=h;return}}o.textContent=h}var di=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wr(o,h,f){var b=h.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?b?o.setProperty(h,""):h==="float"?o.cssFloat="":o[h]="":b?o.setProperty(h,f):typeof f!="number"||f===0||di.has(h)?h==="float"?o.cssFloat=f:o[h]=(""+f).trim():o[h]=f+"px"}function xn(o,h,f){if(h!=null&&typeof h!="object")throw Error(n(62));if(o=o.style,f!=null){for(var b in f)!f.hasOwnProperty(b)||h!=null&&h.hasOwnProperty(b)||(b.indexOf("--")===0?o.setProperty(b,""):b==="float"?o.cssFloat="":o[b]="");for(var S in h)b=h[S],h.hasOwnProperty(S)&&f[S]!==b&&wr(o,S,b)}else for(var E in h)h.hasOwnProperty(E)&&wr(o,E,h[E])}function $s(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Us=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ha=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Nn(o){return ha.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function Bt(){}var ar=null;function Pr(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Vr=null,$r=null;function jn(o){var h=Mt(o);if(h&&(o=h.stateNode)){var f=o[tn]||null;e:switch(o=h.stateNode,h.type){case"input":if(Fs(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),h=f.name,f.type==="radio"&&h!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+da(""+h)+'"][type="radio"]'),h=0;h<f.length;h++){var b=f[h];if(b!==o&&b.form===o.form){var S=b[tn]||null;if(!S)throw Error(n(90));Fs(b,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(h=0;h<f.length;h++)b=f[h],b.form===o.form&&Ii(b)}break e;case"textarea":To(o,f.value,f.defaultValue);break e;case"select":h=f.value,h!=null&&An(o,!!f.multiple,h,!1)}}}var hi=!1;function Es(o,h,f){if(hi)return o(h,f);hi=!0;try{var b=o(h);return b}finally{if(hi=!1,(Vr!==null||$r!==null)&&(em(),Vr&&(h=Vr,o=$r,$r=Vr=null,jn(h),o)))for(h=0;h<o.length;h++)jn(o[h])}}function _s(o,h){var f=o.stateNode;if(f===null)return null;var b=f[tn]||null;if(b===null)return null;f=b[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(o=o.type,b=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!b;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(n(231,h,typeof f));return f}var Aa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$l=!1;if(Aa)try{var za={};Object.defineProperty(za,"passive",{get:function(){$l=!0}}),window.addEventListener("test",za,za),window.removeEventListener("test",za,za)}catch{$l=!1}var qs=null,pi=null,gi=null;function eo(){if(gi)return gi;var o,h=pi,f=h.length,b,S="value"in qs?qs.value:qs.textContent,E=S.length;for(o=0;o<f&&h[o]===S[o];o++);var q=f-o;for(b=1;b<=q&&h[f-b]===S[E-b];b++);return gi=S.slice(o,1<b?1-b:void 0)}function Co(o){var h=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&h===13&&(o=13)):o=h,o===10&&(o=13),32<=o||o===13?o:0}function fi(){return!0}function Qu(){return!1}function pa(o){function h(f,b,S,E,q){this._reactName=f,this._targetInst=S,this.type=b,this.nativeEvent=E,this.target=q,this.currentTarget=null;for(var ae in o)o.hasOwnProperty(ae)&&(f=o[ae],this[ae]=f?f(E):E[ae]);return this.isDefaultPrevented=(E.defaultPrevented!=null?E.defaultPrevented:E.returnValue===!1)?fi:Qu,this.isPropagationStopped=Qu,this}return g(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=fi)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=fi)},persist:function(){},isPersistent:fi}),h}var Hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eo=pa(Hs),mi=g({},Hs,{view:0,detail:0}),Ya=pa(mi),es,Gs,nl,Ul=g({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:us,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==nl&&(nl&&o.type==="mousemove"?(es=o.screenX-nl.screenX,Gs=o.screenY-nl.screenY):Gs=es=0,nl=o),es)},movementY:function(o){return"movementY"in o?o.movementY:Gs}}),al=pa(Ul),ql=g({},Ul,{dataTransfer:0}),to=pa(ql),_o=g({},mi,{relatedTarget:0}),yi=pa(_o),Hl=g({},Hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ku=pa(Hl),ea=g({},Hs,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ao=pa(ea),zc=g({},Hs,{data:0}),sl=pa(zc),$c={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},va={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vs(o){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(o):(o=va[o])?!!h[o]:!1}function us(){return Vs}var Xu=g({},mi,{key:function(o){if(o.key){var h=$c[o.key]||o.key;if(h!=="Unidentified")return h}return o.type==="keypress"?(o=Co(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Gl[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:us,charCode:function(o){return o.type==="keypress"?Co(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Co(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Vl=pa(Xu),Ju=g({},Ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Uc=pa(Ju),Wl=g({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:us}),bi=pa(Wl),Ri=g({},Hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),il=pa(Ri),qc=g({},Ul,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),ol=pa(qc),Hc=g({},Hs,{newState:0,oldState:0}),Gc=pa(Hc),Fh=[9,13,27,32],ds=Aa&&"CompositionEvent"in window,Di=null;Aa&&"documentMode"in document&&(Di=document.documentMode);var zh=Aa&&"TextEvent"in window&&!Di,Yl=Aa&&(!ds||Di&&8<Di&&11>=Di),Ql=" ",Zu=!1;function Vc(o,h){switch(o){case"keyup":return Fh.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ed(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var ro=!1;function td(o,h){switch(o){case"compositionend":return ed(h);case"keypress":return h.which!==32?null:(Zu=!0,Ql);case"textInput":return o=h.data,o===Ql&&Zu?null:o;default:return null}}function rd(o,h){if(ro)return o==="compositionend"||!ds&&Vc(o,h)?(o=eo(),gi=pi=qs=null,ro=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Yl&&h.locale!=="ko"?null:h.data;default:return null}}var nd={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kl(o){var h=o&&o.nodeName&&o.nodeName.toLowerCase();return h==="input"?!!nd[o.type]:h==="textarea"}function Wc(o,h,f,b){Vr?$r?$r.push(b):$r=[b]:Vr=b,h=om(h,"onChange"),0<h.length&&(f=new Eo("onChange","change",null,f,b),o.push({event:f,listeners:h}))}var No=null,ll=null;function Y(o){S2(o,0)}function oe(o){var h=zr(o);if(Ii(h))return o}function Ge(o,h){if(o==="change")return h}var yt=!1;if(Aa){var tt;if(Aa){var ie="oninput"in document;if(!ie){var dt=document.createElement("div");dt.setAttribute("oninput","return;"),ie=typeof dt.oninput=="function"}tt=ie}else tt=!1;yt=tt&&(!document.documentMode||9<document.documentMode)}function We(){No&&(No.detachEvent("onpropertychange",Ct),ll=No=null)}function Ct(o){if(o.propertyName==="value"&&oe(ll)){var h=[];Wc(h,ll,o,Pr(o)),Es(Y,h)}}function Oe(o,h,f){o==="focusin"?(We(),No=h,ll=f,No.attachEvent("onpropertychange",Ct)):o==="focusout"&&We()}function gt(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return oe(ll)}function It(o,h){if(o==="click")return oe(h)}function Ke(o,h){if(o==="input"||o==="change")return oe(h)}function Rt(o,h){return o===h&&(o!==0||1/o===1/h)||o!==o&&h!==h}var br=typeof Object.is=="function"?Object.is:Rt;function v(o,h){if(br(o,h))return!0;if(typeof o!="object"||o===null||typeof h!="object"||h===null)return!1;var f=Object.keys(o),b=Object.keys(h);if(f.length!==b.length)return!1;for(b=0;b<f.length;b++){var S=f[b];if(!mt.call(h,S)||!br(o[S],h[S]))return!1}return!0}function C(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function R(o,h){var f=C(o);o=0;for(var b;f;){if(f.nodeType===3){if(b=o+f.textContent.length,o<=h&&b>=h)return{node:f,offset:h-o};o=b}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=C(f)}}function j(o,h){return o&&h?o===h?!0:o&&o.nodeType===3?!1:h&&h.nodeType===3?j(o,h.parentNode):"contains"in o?o.contains(h):o.compareDocumentPosition?!!(o.compareDocumentPosition(h)&16):!1:!1}function G(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var h=_r(o.document);h instanceof o.HTMLIFrameElement;){try{var f=typeof h.contentWindow.location.href=="string"}catch{f=!1}if(f)o=h.contentWindow;else break;h=_r(o.document)}return h}function J(o){var h=o&&o.nodeName&&o.nodeName.toLowerCase();return h&&(h==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||h==="textarea"||o.contentEditable==="true")}var le=Aa&&"documentMode"in document&&11>=document.documentMode,ge=null,Ee=null,Re=null,$e=!1;function ke(o,h,f){var b=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;$e||ge==null||ge!==_r(b)||(b=ge,"selectionStart"in b&&J(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Re&&v(Re,b)||(Re=b,b=om(Ee,"onSelect"),0<b.length&&(h=new Eo("onSelect","select",null,h,f),o.push({event:h,listeners:b}),h.target=ge)))}function Ue(o,h){var f={};return f[o.toLowerCase()]=h.toLowerCase(),f["Webkit"+o]="webkit"+h,f["Moz"+o]="moz"+h,f}var Pe={animationend:Ue("Animation","AnimationEnd"),animationiteration:Ue("Animation","AnimationIteration"),animationstart:Ue("Animation","AnimationStart"),transitionrun:Ue("Transition","TransitionRun"),transitionstart:Ue("Transition","TransitionStart"),transitioncancel:Ue("Transition","TransitionCancel"),transitionend:Ue("Transition","TransitionEnd")},je={},Be={};Aa&&(Be=document.createElement("div").style,"AnimationEvent"in window||(delete Pe.animationend.animation,delete Pe.animationiteration.animation,delete Pe.animationstart.animation),"TransitionEvent"in window||delete Pe.transitionend.transition);function Fe(o){if(je[o])return je[o];if(!Pe[o])return o;var h=Pe[o],f;for(f in h)if(h.hasOwnProperty(f)&&f in Be)return je[o]=h[f];return o}var Le=Fe("animationend"),V=Fe("animationiteration"),at=Fe("animationstart"),ot=Fe("transitionrun"),jt=Fe("transitionstart"),Ht=Fe("transitioncancel"),Lt=Fe("transitionend"),Ft=new Map,Wt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wt.push("scrollEnd");function Et(o,h){Ft.set(o,h),Hn(h,[o])}var nr=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},Xe=[],_e=0,Ve=0;function Xt(){for(var o=_e,h=Ve=_e=0;h<o;){var f=Xe[h];Xe[h++]=null;var b=Xe[h];Xe[h++]=null;var S=Xe[h];Xe[h++]=null;var E=Xe[h];if(Xe[h++]=null,b!==null&&S!==null){var q=b.pending;q===null?S.next=S:(S.next=q.next,q.next=S),b.pending=S}E!==0&&ta(f,S,E)}}function At(o,h,f,b){Xe[_e++]=o,Xe[_e++]=h,Xe[_e++]=f,Xe[_e++]=b,Ve|=b,o.lanes|=b,o=o.alternate,o!==null&&(o.lanes|=b)}function St(o,h,f,b){return At(o,h,f,b),Wr(o)}function Tr(o,h){return At(o,null,null,h),Wr(o)}function ta(o,h,f){o.lanes|=f;var b=o.alternate;b!==null&&(b.lanes|=f);for(var S=!1,E=o.return;E!==null;)E.childLanes|=f,b=E.alternate,b!==null&&(b.childLanes|=f),E.tag===22&&(o=E.stateNode,o===null||o._visibility&1||(S=!0)),o=E,E=E.return;return o.tag===3?(E=o.stateNode,S&&h!==null&&(S=31-vt(f),o=E.hiddenUpdates,b=o[S],b===null?o[S]=[h]:b.push(h),h.lane=f|536870912),E):null}function Wr(o){if(50<lp)throw lp=0,Ax=null,Error(n(185));for(var h=o.return;h!==null;)o=h,h=o.return;return o.tag===3?o.stateNode:null}var Jr={};function kn(o,h,f,b){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ga(o,h,f,b){return new kn(o,h,f,b)}function Pn(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Vn(o,h){var f=o.alternate;return f===null?(f=ga(o.tag,h,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=h,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,h=o.dependencies,f.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function no(o,h){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=h,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,h=f.dependencies,o.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),o}function Tf(o,h,f,b,S,E){var q=0;if(b=o,typeof o=="function")Pn(o)&&(q=1);else if(typeof o=="string")q=BB(o,f,ce.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case Z:return o=ga(31,f,h,S),o.elementType=Z,o.lanes=E,o;case w:return Yc(f.children,S,E,h);case T:q=8,S|=24;break;case k:return o=ga(12,f,h,S|2),o.elementType=k,o.lanes=E,o;case D:return o=ga(13,f,h,S),o.elementType=D,o.lanes=E,o;case B:return o=ga(19,f,h,S),o.elementType=B,o.lanes=E,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case P:q=10;break e;case _:q=9;break e;case F:q=11;break e;case M:q=14;break e;case $:q=16,b=null;break e}q=29,f=Error(n(130,o===null?"null":typeof o,"")),b=null}return h=ga(q,f,h,S),h.elementType=o,h.type=b,h.lanes=E,h}function Yc(o,h,f,b){return o=ga(7,o,b,h),o.lanes=f,o}function wb(o,h,f){return o=ga(6,o,null,h),o.lanes=f,o}function sT(o){var h=ga(18,null,null,0);return h.stateNode=o,h}function Sb(o,h,f){return h=ga(4,o.children!==null?o.children:[],o.key,h),h.lanes=f,h.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},h}var iT=new WeakMap;function Li(o,h){if(typeof o=="object"&&o!==null){var f=iT.get(o);return f!==void 0?f:(h={value:o,source:h,stack:nt(h)},iT.set(o,h),h)}return{value:o,source:h,stack:nt(h)}}var ad=[],sd=0,Cf=null,$h=0,Mi=[],Oi=0,Xl=null,Po=1,Io="";function cl(o,h){ad[sd++]=$h,ad[sd++]=Cf,Cf=o,$h=h}function oT(o,h,f){Mi[Oi++]=Po,Mi[Oi++]=Io,Mi[Oi++]=Xl,Xl=o;var b=Po;o=Io;var S=32-vt(b)-1;b&=~(1<<S),f+=1;var E=32-vt(h)+S;if(30<E){var q=S-S%5;E=(b&(1<<q)-1).toString(32),b>>=q,S-=q,Po=1<<32-vt(h)+S|f<<S|b,Io=E+o}else Po=1<<E|f<<S|b,Io=o}function kb(o){o.return!==null&&(cl(o,1),oT(o,1,0))}function Tb(o){for(;o===Cf;)Cf=ad[--sd],ad[sd]=null,$h=ad[--sd],ad[sd]=null;for(;o===Xl;)Xl=Mi[--Oi],Mi[Oi]=null,Io=Mi[--Oi],Mi[Oi]=null,Po=Mi[--Oi],Mi[Oi]=null}function lT(o,h){Mi[Oi++]=Po,Mi[Oi++]=Io,Mi[Oi++]=Xl,Po=h.id,Io=h.overflow,Xl=o}var ts=null,ra=null,bn=!1,Jl=null,ji=!1,Cb=Error(n(519));function Zl(o){var h=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Uh(Li(h,o)),Cb}function cT(o){var h=o.stateNode,f=o.type,b=o.memoizedProps;switch(h[an]=o,h[tn]=b,f){case"dialog":on("cancel",h),on("close",h);break;case"iframe":case"object":case"embed":on("load",h);break;case"video":case"audio":for(f=0;f<up.length;f++)on(up[f],h);break;case"source":on("error",h);break;case"img":case"image":case"link":on("error",h),on("load",h);break;case"details":on("toggle",h);break;case"input":on("invalid",h),ui(h,b.value,b.defaultValue,b.checked,b.defaultChecked,b.type,b.name,!0);break;case"select":on("invalid",h);break;case"textarea":on("invalid",h),zs(h,b.value,b.defaultValue,b.children)}f=b.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||h.textContent===""+f||b.suppressHydrationWarning===!0||E2(h.textContent,f)?(b.popover!=null&&(on("beforetoggle",h),on("toggle",h)),b.onScroll!=null&&on("scroll",h),b.onScrollEnd!=null&&on("scrollend",h),b.onClick!=null&&(h.onclick=Bt),h=!0):h=!1,h||Zl(o,!0)}function uT(o){for(ts=o.return;ts;)switch(ts.tag){case 5:case 31:case 13:ji=!1;return;case 27:case 3:ji=!0;return;default:ts=ts.return}}function id(o){if(o!==ts)return!1;if(!bn)return uT(o),bn=!0,!1;var h=o.tag,f;if((f=h!==3&&h!==27)&&((f=h===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||qx(o.type,o.memoizedProps)),f=!f),f&&ra&&Zl(o),uT(o),h===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));ra=M2(o)}else if(h===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));ra=M2(o)}else h===27?(h=ra,pc(o.type)?(o=Yx,Yx=null,ra=o):ra=h):ra=ts?Fi(o.stateNode.nextSibling):null;return!0}function Qc(){ra=ts=null,bn=!1}function Eb(){var o=Jl;return o!==null&&(Ks===null?Ks=o:Ks.push.apply(Ks,o),Jl=null),o}function Uh(o){Jl===null?Jl=[o]:Jl.push(o)}var _b=I(null),Kc=null,ul=null;function ec(o,h,f){U(_b,h._currentValue),h._currentValue=f}function dl(o){o._currentValue=_b.current,K(_b)}function Ab(o,h,f){for(;o!==null;){var b=o.alternate;if((o.childLanes&h)!==h?(o.childLanes|=h,b!==null&&(b.childLanes|=h)):b!==null&&(b.childLanes&h)!==h&&(b.childLanes|=h),o===f)break;o=o.return}}function Nb(o,h,f,b){var S=o.child;for(S!==null&&(S.return=o);S!==null;){var E=S.dependencies;if(E!==null){var q=S.child;E=E.firstContext;e:for(;E!==null;){var ae=E;E=S;for(var Ce=0;Ce<h.length;Ce++)if(ae.context===h[Ce]){E.lanes|=f,ae=E.alternate,ae!==null&&(ae.lanes|=f),Ab(E.return,f,o),b||(q=null);break e}E=ae.next}}else if(S.tag===18){if(q=S.return,q===null)throw Error(n(341));q.lanes|=f,E=q.alternate,E!==null&&(E.lanes|=f),Ab(q,f,o),q=null}else q=S.child;if(q!==null)q.return=S;else for(q=S;q!==null;){if(q===o){q=null;break}if(S=q.sibling,S!==null){S.return=q.return,q=S;break}q=q.return}S=q}}function od(o,h,f,b){o=null;for(var S=h,E=!1;S!==null;){if(!E){if((S.flags&524288)!==0)E=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var q=S.alternate;if(q===null)throw Error(n(387));if(q=q.memoizedProps,q!==null){var ae=S.type;br(S.pendingProps.value,q.value)||(o!==null?o.push(ae):o=[ae])}}else if(S===fe.current){if(q=S.alternate,q===null)throw Error(n(387));q.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(o!==null?o.push(fp):o=[fp])}S=S.return}o!==null&&Nb(h,o,f,b),h.flags|=262144}function Ef(o){for(o=o.firstContext;o!==null;){if(!br(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Xc(o){Kc=o,ul=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function rs(o){return dT(Kc,o)}function _f(o,h){return Kc===null&&Xc(o),dT(o,h)}function dT(o,h){var f=h._currentValue;if(h={context:h,memoizedValue:f,next:null},ul===null){if(o===null)throw Error(n(308));ul=h,o.dependencies={lanes:0,firstContext:h},o.flags|=524288}else ul=ul.next=h;return f}var Lj=typeof AbortController<"u"?AbortController:function(){var o=[],h=this.signal={aborted:!1,addEventListener:function(f,b){o.push(b)}};this.abort=function(){h.aborted=!0,o.forEach(function(f){return f()})}},Mj=t.unstable_scheduleCallback,Oj=t.unstable_NormalPriority,Na={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pb(){return{controller:new Lj,data:new Map,refCount:0}}function qh(o){o.refCount--,o.refCount===0&&Mj(Oj,function(){o.controller.abort()})}var Hh=null,Ib=0,ld=0,cd=null;function jj(o,h){if(Hh===null){var f=Hh=[];Ib=0,ld=Lx(),cd={status:"pending",value:void 0,then:function(b){f.push(b)}}}return Ib++,h.then(hT,hT),h}function hT(){if(--Ib===0&&Hh!==null){cd!==null&&(cd.status="fulfilled");var o=Hh;Hh=null,ld=0,cd=null;for(var h=0;h<o.length;h++)(0,o[h])()}}function Bj(o,h){var f=[],b={status:"pending",value:null,reason:null,then:function(S){f.push(S)}};return o.then(function(){b.status="fulfilled",b.value=h;for(var S=0;S<f.length;S++)(0,f[S])(h)},function(S){for(b.status="rejected",b.reason=S,S=0;S<f.length;S++)(0,f[S])(void 0)}),b}var pT=H.S;H.S=function(o,h){KC=kt(),typeof h=="object"&&h!==null&&typeof h.then=="function"&&jj(o,h),pT!==null&&pT(o,h)};var Jc=I(null);function Rb(){var o=Jc.current;return o!==null?o:Wn.pooledCache}function Af(o,h){h===null?U(Jc,Jc.current):U(Jc,h.pool)}function gT(){var o=Rb();return o===null?null:{parent:Na._currentValue,pool:o}}var ud=Error(n(460)),Db=Error(n(474)),Nf=Error(n(542)),Pf={then:function(){}};function fT(o){return o=o.status,o==="fulfilled"||o==="rejected"}function mT(o,h,f){switch(f=o[f],f===void 0?o.push(h):f!==h&&(h.then(Bt,Bt),h=f),h.status){case"fulfilled":return h.value;case"rejected":throw o=h.reason,bT(o),o;default:if(typeof h.status=="string")h.then(Bt,Bt);else{if(o=Wn,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=h,o.status="pending",o.then(function(b){if(h.status==="pending"){var S=h;S.status="fulfilled",S.value=b}},function(b){if(h.status==="pending"){var S=h;S.status="rejected",S.reason=b}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw o=h.reason,bT(o),o}throw eu=h,ud}}function Zc(o){try{var h=o._init;return h(o._payload)}catch(f){throw f!==null&&typeof f=="object"&&typeof f.then=="function"?(eu=f,ud):f}}var eu=null;function yT(){if(eu===null)throw Error(n(459));var o=eu;return eu=null,o}function bT(o){if(o===ud||o===Nf)throw Error(n(483))}var dd=null,Gh=0;function If(o){var h=Gh;return Gh+=1,dd===null&&(dd=[]),mT(dd,o,h)}function Vh(o,h){h=h.props.ref,o.ref=h!==void 0?h:null}function Rf(o,h){throw h.$$typeof===m?Error(n(525)):(o=Object.prototype.toString.call(h),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":o)))}function xT(o){function h(He,Me){if(o){var Ze=He.deletions;Ze===null?(He.deletions=[Me],He.flags|=16):Ze.push(Me)}}function f(He,Me){if(!o)return null;for(;Me!==null;)h(He,Me),Me=Me.sibling;return null}function b(He){for(var Me=new Map;He!==null;)He.key!==null?Me.set(He.key,He):Me.set(He.index,He),He=He.sibling;return Me}function S(He,Me){return He=Vn(He,Me),He.index=0,He.sibling=null,He}function E(He,Me,Ze){return He.index=Ze,o?(Ze=He.alternate,Ze!==null?(Ze=Ze.index,Ze<Me?(He.flags|=67108866,Me):Ze):(He.flags|=67108866,Me)):(He.flags|=1048576,Me)}function q(He){return o&&He.alternate===null&&(He.flags|=67108866),He}function ae(He,Me,Ze,ft){return Me===null||Me.tag!==6?(Me=wb(Ze,He.mode,ft),Me.return=He,Me):(Me=S(Me,Ze),Me.return=He,Me)}function Ce(He,Me,Ze,ft){var Cr=Ze.type;return Cr===w?pt(He,Me,Ze.props.children,ft,Ze.key):Me!==null&&(Me.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===$&&Zc(Cr)===Me.type)?(Me=S(Me,Ze.props),Vh(Me,Ze),Me.return=He,Me):(Me=Tf(Ze.type,Ze.key,Ze.props,null,He.mode,ft),Vh(Me,Ze),Me.return=He,Me)}function et(He,Me,Ze,ft){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Ze.containerInfo||Me.stateNode.implementation!==Ze.implementation?(Me=Sb(Ze,He.mode,ft),Me.return=He,Me):(Me=S(Me,Ze.children||[]),Me.return=He,Me)}function pt(He,Me,Ze,ft,Cr){return Me===null||Me.tag!==7?(Me=Yc(Ze,He.mode,ft,Cr),Me.return=He,Me):(Me=S(Me,Ze),Me.return=He,Me)}function xt(He,Me,Ze){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=wb(""+Me,He.mode,Ze),Me.return=He,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case y:return Ze=Tf(Me.type,Me.key,Me.props,null,He.mode,Ze),Vh(Ze,Me),Ze.return=He,Ze;case x:return Me=Sb(Me,He.mode,Ze),Me.return=He,Me;case $:return Me=Zc(Me),xt(He,Me,Ze)}if(W(Me)||te(Me))return Me=Yc(Me,He.mode,Ze,null),Me.return=He,Me;if(typeof Me.then=="function")return xt(He,If(Me),Ze);if(Me.$$typeof===P)return xt(He,_f(He,Me),Ze);Rf(He,Me)}return null}function rt(He,Me,Ze,ft){var Cr=Me!==null?Me.key:null;if(typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint")return Cr!==null?null:ae(He,Me,""+Ze,ft);if(typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case y:return Ze.key===Cr?Ce(He,Me,Ze,ft):null;case x:return Ze.key===Cr?et(He,Me,Ze,ft):null;case $:return Ze=Zc(Ze),rt(He,Me,Ze,ft)}if(W(Ze)||te(Ze))return Cr!==null?null:pt(He,Me,Ze,ft,null);if(typeof Ze.then=="function")return rt(He,Me,If(Ze),ft);if(Ze.$$typeof===P)return rt(He,Me,_f(He,Ze),ft);Rf(He,Ze)}return null}function it(He,Me,Ze,ft,Cr){if(typeof ft=="string"&&ft!==""||typeof ft=="number"||typeof ft=="bigint")return He=He.get(Ze)||null,ae(Me,He,""+ft,Cr);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case y:return He=He.get(ft.key===null?Ze:ft.key)||null,Ce(Me,He,ft,Cr);case x:return He=He.get(ft.key===null?Ze:ft.key)||null,et(Me,He,ft,Cr);case $:return ft=Zc(ft),it(He,Me,Ze,ft,Cr)}if(W(ft)||te(ft))return He=He.get(Ze)||null,pt(Me,He,ft,Cr,null);if(typeof ft.then=="function")return it(He,Me,Ze,If(ft),Cr);if(ft.$$typeof===P)return it(He,Me,Ze,_f(Me,ft),Cr);Rf(Me,ft)}return null}function cr(He,Me,Ze,ft){for(var Cr=null,Tn=null,yr=Me,Zr=Me=0,fn=null;yr!==null&&Zr<Ze.length;Zr++){yr.index>Zr?(fn=yr,yr=null):fn=yr.sibling;var Cn=rt(He,yr,Ze[Zr],ft);if(Cn===null){yr===null&&(yr=fn);break}o&&yr&&Cn.alternate===null&&h(He,yr),Me=E(Cn,Me,Zr),Tn===null?Cr=Cn:Tn.sibling=Cn,Tn=Cn,yr=fn}if(Zr===Ze.length)return f(He,yr),bn&&cl(He,Zr),Cr;if(yr===null){for(;Zr<Ze.length;Zr++)yr=xt(He,Ze[Zr],ft),yr!==null&&(Me=E(yr,Me,Zr),Tn===null?Cr=yr:Tn.sibling=yr,Tn=yr);return bn&&cl(He,Zr),Cr}for(yr=b(yr);Zr<Ze.length;Zr++)fn=it(yr,He,Zr,Ze[Zr],ft),fn!==null&&(o&&fn.alternate!==null&&yr.delete(fn.key===null?Zr:fn.key),Me=E(fn,Me,Zr),Tn===null?Cr=fn:Tn.sibling=fn,Tn=fn);return o&&yr.forEach(function(bc){return h(He,bc)}),bn&&cl(He,Zr),Cr}function Rr(He,Me,Ze,ft){if(Ze==null)throw Error(n(151));for(var Cr=null,Tn=null,yr=Me,Zr=Me=0,fn=null,Cn=Ze.next();yr!==null&&!Cn.done;Zr++,Cn=Ze.next()){yr.index>Zr?(fn=yr,yr=null):fn=yr.sibling;var bc=rt(He,yr,Cn.value,ft);if(bc===null){yr===null&&(yr=fn);break}o&&yr&&bc.alternate===null&&h(He,yr),Me=E(bc,Me,Zr),Tn===null?Cr=bc:Tn.sibling=bc,Tn=bc,yr=fn}if(Cn.done)return f(He,yr),bn&&cl(He,Zr),Cr;if(yr===null){for(;!Cn.done;Zr++,Cn=Ze.next())Cn=xt(He,Cn.value,ft),Cn!==null&&(Me=E(Cn,Me,Zr),Tn===null?Cr=Cn:Tn.sibling=Cn,Tn=Cn);return bn&&cl(He,Zr),Cr}for(yr=b(yr);!Cn.done;Zr++,Cn=Ze.next())Cn=it(yr,He,Zr,Cn.value,ft),Cn!==null&&(o&&Cn.alternate!==null&&yr.delete(Cn.key===null?Zr:Cn.key),Me=E(Cn,Me,Zr),Tn===null?Cr=Cn:Tn.sibling=Cn,Tn=Cn);return o&&yr.forEach(function(QB){return h(He,QB)}),bn&&cl(He,Zr),Cr}function zn(He,Me,Ze,ft){if(typeof Ze=="object"&&Ze!==null&&Ze.type===w&&Ze.key===null&&(Ze=Ze.props.children),typeof Ze=="object"&&Ze!==null){switch(Ze.$$typeof){case y:e:{for(var Cr=Ze.key;Me!==null;){if(Me.key===Cr){if(Cr=Ze.type,Cr===w){if(Me.tag===7){f(He,Me.sibling),ft=S(Me,Ze.props.children),ft.return=He,He=ft;break e}}else if(Me.elementType===Cr||typeof Cr=="object"&&Cr!==null&&Cr.$$typeof===$&&Zc(Cr)===Me.type){f(He,Me.sibling),ft=S(Me,Ze.props),Vh(ft,Ze),ft.return=He,He=ft;break e}f(He,Me);break}else h(He,Me);Me=Me.sibling}Ze.type===w?(ft=Yc(Ze.props.children,He.mode,ft,Ze.key),ft.return=He,He=ft):(ft=Tf(Ze.type,Ze.key,Ze.props,null,He.mode,ft),Vh(ft,Ze),ft.return=He,He=ft)}return q(He);case x:e:{for(Cr=Ze.key;Me!==null;){if(Me.key===Cr)if(Me.tag===4&&Me.stateNode.containerInfo===Ze.containerInfo&&Me.stateNode.implementation===Ze.implementation){f(He,Me.sibling),ft=S(Me,Ze.children||[]),ft.return=He,He=ft;break e}else{f(He,Me);break}else h(He,Me);Me=Me.sibling}ft=Sb(Ze,He.mode,ft),ft.return=He,He=ft}return q(He);case $:return Ze=Zc(Ze),zn(He,Me,Ze,ft)}if(W(Ze))return cr(He,Me,Ze,ft);if(te(Ze)){if(Cr=te(Ze),typeof Cr!="function")throw Error(n(150));return Ze=Cr.call(Ze),Rr(He,Me,Ze,ft)}if(typeof Ze.then=="function")return zn(He,Me,If(Ze),ft);if(Ze.$$typeof===P)return zn(He,Me,_f(He,Ze),ft);Rf(He,Ze)}return typeof Ze=="string"&&Ze!==""||typeof Ze=="number"||typeof Ze=="bigint"?(Ze=""+Ze,Me!==null&&Me.tag===6?(f(He,Me.sibling),ft=S(Me,Ze),ft.return=He,He=ft):(f(He,Me),ft=wb(Ze,He.mode,ft),ft.return=He,He=ft),q(He)):f(He,Me)}return function(He,Me,Ze,ft){try{Gh=0;var Cr=zn(He,Me,Ze,ft);return dd=null,Cr}catch(yr){if(yr===ud||yr===Nf)throw yr;var Tn=ga(29,yr,null,He.mode);return Tn.lanes=ft,Tn.return=He,Tn}finally{}}}var tu=xT(!0),vT=xT(!1),tc=!1;function Lb(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Mb(o,h){o=o.updateQueue,h.updateQueue===o&&(h.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function rc(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function nc(o,h,f){var b=o.updateQueue;if(b===null)return null;if(b=b.shared,(_n&2)!==0){var S=b.pending;return S===null?h.next=h:(h.next=S.next,S.next=h),b.pending=h,h=Wr(o),ta(o,null,f),h}return At(o,b,h,f),Wr(o)}function Wh(o,h,f){if(h=h.updateQueue,h!==null&&(h=h.shared,(f&4194048)!==0)){var b=h.lanes;b&=o.pendingLanes,f|=b,h.lanes=f,Qt(o,f)}}function Ob(o,h){var f=o.updateQueue,b=o.alternate;if(b!==null&&(b=b.updateQueue,f===b)){var S=null,E=null;if(f=f.firstBaseUpdate,f!==null){do{var q={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};E===null?S=E=q:E=E.next=q,f=f.next}while(f!==null);E===null?S=E=h:E=E.next=h}else S=E=h;f={baseState:b.baseState,firstBaseUpdate:S,lastBaseUpdate:E,shared:b.shared,callbacks:b.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=h:o.next=h,f.lastBaseUpdate=h}var jb=!1;function Yh(){if(jb){var o=cd;if(o!==null)throw o}}function Qh(o,h,f,b){jb=!1;var S=o.updateQueue;tc=!1;var E=S.firstBaseUpdate,q=S.lastBaseUpdate,ae=S.shared.pending;if(ae!==null){S.shared.pending=null;var Ce=ae,et=Ce.next;Ce.next=null,q===null?E=et:q.next=et,q=Ce;var pt=o.alternate;pt!==null&&(pt=pt.updateQueue,ae=pt.lastBaseUpdate,ae!==q&&(ae===null?pt.firstBaseUpdate=et:ae.next=et,pt.lastBaseUpdate=Ce))}if(E!==null){var xt=S.baseState;q=0,pt=et=Ce=null,ae=E;do{var rt=ae.lane&-536870913,it=rt!==ae.lane;if(it?(gn&rt)===rt:(b&rt)===rt){rt!==0&&rt===ld&&(jb=!0),pt!==null&&(pt=pt.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var cr=o,Rr=ae;rt=h;var zn=f;switch(Rr.tag){case 1:if(cr=Rr.payload,typeof cr=="function"){xt=cr.call(zn,xt,rt);break e}xt=cr;break e;case 3:cr.flags=cr.flags&-65537|128;case 0:if(cr=Rr.payload,rt=typeof cr=="function"?cr.call(zn,xt,rt):cr,rt==null)break e;xt=g({},xt,rt);break e;case 2:tc=!0}}rt=ae.callback,rt!==null&&(o.flags|=64,it&&(o.flags|=8192),it=S.callbacks,it===null?S.callbacks=[rt]:it.push(rt))}else it={lane:rt,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},pt===null?(et=pt=it,Ce=xt):pt=pt.next=it,q|=rt;if(ae=ae.next,ae===null){if(ae=S.shared.pending,ae===null)break;it=ae,ae=it.next,it.next=null,S.lastBaseUpdate=it,S.shared.pending=null}}while(!0);pt===null&&(Ce=xt),S.baseState=Ce,S.firstBaseUpdate=et,S.lastBaseUpdate=pt,E===null&&(S.shared.lanes=0),lc|=q,o.lanes=q,o.memoizedState=xt}}function wT(o,h){if(typeof o!="function")throw Error(n(191,o));o.call(h)}function ST(o,h){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)wT(f[o],h)}var hd=I(null),Df=I(0);function kT(o,h){o=vl,U(Df,o),U(hd,h),vl=o|h.baseLanes}function Bb(){U(Df,vl),U(hd,hd.current)}function Fb(){vl=Df.current,K(hd),K(Df)}var xi=I(null),Bi=null;function ac(o){var h=o.alternate;U(wa,wa.current&1),U(xi,o),Bi===null&&(h===null||hd.current!==null||h.memoizedState!==null)&&(Bi=o)}function zb(o){U(wa,wa.current),U(xi,o),Bi===null&&(Bi=o)}function TT(o){o.tag===22?(U(wa,wa.current),U(xi,o),Bi===null&&(Bi=o)):sc()}function sc(){U(wa,wa.current),U(xi,xi.current)}function vi(o){K(xi),Bi===o&&(Bi=null),K(wa)}var wa=I(0);function Lf(o){for(var h=o;h!==null;){if(h.tag===13){var f=h.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||Vx(f)||Wx(f)))return h}else if(h.tag===19&&(h.memoizedProps.revealOrder==="forwards"||h.memoizedProps.revealOrder==="backwards"||h.memoizedProps.revealOrder==="unstable_legacy-backwards"||h.memoizedProps.revealOrder==="together")){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var hl=0,Yr=null,Bn=null,Pa=null,Mf=!1,pd=!1,ru=!1,Of=0,Kh=0,gd=null,Fj=0;function ma(){throw Error(n(321))}function $b(o,h){if(h===null)return!1;for(var f=0;f<h.length&&f<o.length;f++)if(!br(o[f],h[f]))return!1;return!0}function Ub(o,h,f,b,S,E){return hl=E,Yr=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,H.H=o===null||o.memoizedState===null?oC:nx,ru=!1,E=f(b,S),ru=!1,pd&&(E=ET(h,f,b,S)),CT(o),E}function CT(o){H.H=Zh;var h=Bn!==null&&Bn.next!==null;if(hl=0,Pa=Bn=Yr=null,Mf=!1,Kh=0,gd=null,h)throw Error(n(300));o===null||Ia||(o=o.dependencies,o!==null&&Ef(o)&&(Ia=!0))}function ET(o,h,f,b){Yr=o;var S=0;do{if(pd&&(gd=null),Kh=0,pd=!1,25<=S)throw Error(n(301));if(S+=1,Pa=Bn=null,o.updateQueue!=null){var E=o.updateQueue;E.lastEffect=null,E.events=null,E.stores=null,E.memoCache!=null&&(E.memoCache.index=0)}H.H=lC,E=h(f,b)}while(pd);return E}function zj(){var o=H.H,h=o.useState()[0];return h=typeof h.then=="function"?Xh(h):h,o=o.useState()[0],(Bn!==null?Bn.memoizedState:null)!==o&&(Yr.flags|=1024),h}function qb(){var o=Of!==0;return Of=0,o}function Hb(o,h,f){h.updateQueue=o.updateQueue,h.flags&=-2053,o.lanes&=~f}function Gb(o){if(Mf){for(o=o.memoizedState;o!==null;){var h=o.queue;h!==null&&(h.pending=null),o=o.next}Mf=!1}hl=0,Pa=Bn=Yr=null,pd=!1,Kh=Of=0,gd=null}function As(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pa===null?Yr.memoizedState=Pa=o:Pa=Pa.next=o,Pa}function Sa(){if(Bn===null){var o=Yr.alternate;o=o!==null?o.memoizedState:null}else o=Bn.next;var h=Pa===null?Yr.memoizedState:Pa.next;if(h!==null)Pa=h,Bn=o;else{if(o===null)throw Yr.alternate===null?Error(n(467)):Error(n(310));Bn=o,o={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Pa===null?Yr.memoizedState=Pa=o:Pa=Pa.next=o}return Pa}function jf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xh(o){var h=Kh;return Kh+=1,gd===null&&(gd=[]),o=mT(gd,o,h),h=Yr,(Pa===null?h.memoizedState:Pa.next)===null&&(h=h.alternate,H.H=h===null||h.memoizedState===null?oC:nx),o}function Bf(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return Xh(o);if(o.$$typeof===P)return rs(o)}throw Error(n(438,String(o)))}function Vb(o){var h=null,f=Yr.updateQueue;if(f!==null&&(h=f.memoCache),h==null){var b=Yr.alternate;b!==null&&(b=b.updateQueue,b!==null&&(b=b.memoCache,b!=null&&(h={data:b.data.map(function(S){return S.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),f===null&&(f=jf(),Yr.updateQueue=f),f.memoCache=h,f=h.data[h.index],f===void 0)for(f=h.data[h.index]=Array(o),b=0;b<o;b++)f[b]=z;return h.index++,f}function pl(o,h){return typeof h=="function"?h(o):h}function Ff(o){var h=Sa();return Wb(h,Bn,o)}function Wb(o,h,f){var b=o.queue;if(b===null)throw Error(n(311));b.lastRenderedReducer=f;var S=o.baseQueue,E=b.pending;if(E!==null){if(S!==null){var q=S.next;S.next=E.next,E.next=q}h.baseQueue=S=E,b.pending=null}if(E=o.baseState,S===null)o.memoizedState=E;else{h=S.next;var ae=q=null,Ce=null,et=h,pt=!1;do{var xt=et.lane&-536870913;if(xt!==et.lane?(gn&xt)===xt:(hl&xt)===xt){var rt=et.revertLane;if(rt===0)Ce!==null&&(Ce=Ce.next={lane:0,revertLane:0,gesture:null,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),xt===ld&&(pt=!0);else if((hl&rt)===rt){et=et.next,rt===ld&&(pt=!0);continue}else xt={lane:0,revertLane:et.revertLane,gesture:null,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null},Ce===null?(ae=Ce=xt,q=E):Ce=Ce.next=xt,Yr.lanes|=rt,lc|=rt;xt=et.action,ru&&f(E,xt),E=et.hasEagerState?et.eagerState:f(E,xt)}else rt={lane:xt,revertLane:et.revertLane,gesture:et.gesture,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null},Ce===null?(ae=Ce=rt,q=E):Ce=Ce.next=rt,Yr.lanes|=xt,lc|=xt;et=et.next}while(et!==null&&et!==h);if(Ce===null?q=E:Ce.next=ae,!br(E,o.memoizedState)&&(Ia=!0,pt&&(f=cd,f!==null)))throw f;o.memoizedState=E,o.baseState=q,o.baseQueue=Ce,b.lastRenderedState=E}return S===null&&(b.lanes=0),[o.memoizedState,b.dispatch]}function Yb(o){var h=Sa(),f=h.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=o;var b=f.dispatch,S=f.pending,E=h.memoizedState;if(S!==null){f.pending=null;var q=S=S.next;do E=o(E,q.action),q=q.next;while(q!==S);br(E,h.memoizedState)||(Ia=!0),h.memoizedState=E,h.baseQueue===null&&(h.baseState=E),f.lastRenderedState=E}return[E,b]}function _T(o,h,f){var b=Yr,S=Sa(),E=bn;if(E){if(f===void 0)throw Error(n(407));f=f()}else f=h();var q=!br((Bn||S).memoizedState,f);if(q&&(S.memoizedState=f,Ia=!0),S=S.queue,Xb(PT.bind(null,b,S,o),[o]),S.getSnapshot!==h||q||Pa!==null&&Pa.memoizedState.tag&1){if(b.flags|=2048,fd(9,{destroy:void 0},NT.bind(null,b,S,f,h),null),Wn===null)throw Error(n(349));E||(hl&127)!==0||AT(b,h,f)}return f}function AT(o,h,f){o.flags|=16384,o={getSnapshot:h,value:f},h=Yr.updateQueue,h===null?(h=jf(),Yr.updateQueue=h,h.stores=[o]):(f=h.stores,f===null?h.stores=[o]:f.push(o))}function NT(o,h,f,b){h.value=f,h.getSnapshot=b,IT(h)&&RT(o)}function PT(o,h,f){return f(function(){IT(h)&&RT(o)})}function IT(o){var h=o.getSnapshot;o=o.value;try{var f=h();return!br(o,f)}catch{return!0}}function RT(o){var h=Tr(o,2);h!==null&&Xs(h,o,2)}function Qb(o){var h=As();if(typeof o=="function"){var f=o;if(o=f(),ru){sr(!0);try{f()}finally{sr(!1)}}}return h.memoizedState=h.baseState=o,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:o},h}function DT(o,h,f,b){return o.baseState=f,Wb(o,Bn,typeof b=="function"?b:pl)}function $j(o,h,f,b,S){if(Uf(o))throw Error(n(485));if(o=h.action,o!==null){var E={payload:S,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(q){E.listeners.push(q)}};H.T!==null?f(!0):E.isTransition=!1,b(E),f=h.pending,f===null?(E.next=h.pending=E,LT(h,E)):(E.next=f.next,h.pending=f.next=E)}}function LT(o,h){var f=h.action,b=h.payload,S=o.state;if(h.isTransition){var E=H.T,q={};H.T=q;try{var ae=f(S,b),Ce=H.S;Ce!==null&&Ce(q,ae),MT(o,h,ae)}catch(et){Kb(o,h,et)}finally{E!==null&&q.types!==null&&(E.types=q.types),H.T=E}}else try{E=f(S,b),MT(o,h,E)}catch(et){Kb(o,h,et)}}function MT(o,h,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(b){OT(o,h,b)},function(b){return Kb(o,h,b)}):OT(o,h,f)}function OT(o,h,f){h.status="fulfilled",h.value=f,jT(h),o.state=f,h=o.pending,h!==null&&(f=h.next,f===h?o.pending=null:(f=f.next,h.next=f,LT(o,f)))}function Kb(o,h,f){var b=o.pending;if(o.pending=null,b!==null){b=b.next;do h.status="rejected",h.reason=f,jT(h),h=h.next;while(h!==b)}o.action=null}function jT(o){o=o.listeners;for(var h=0;h<o.length;h++)(0,o[h])()}function BT(o,h){return h}function FT(o,h){if(bn){var f=Wn.formState;if(f!==null){e:{var b=Yr;if(bn){if(ra){t:{for(var S=ra,E=ji;S.nodeType!==8;){if(!E){S=null;break t}if(S=Fi(S.nextSibling),S===null){S=null;break t}}E=S.data,S=E==="F!"||E==="F"?S:null}if(S){ra=Fi(S.nextSibling),b=S.data==="F!";break e}}Zl(b)}b=!1}b&&(h=f[0])}}return f=As(),f.memoizedState=f.baseState=h,b={pending:null,lanes:0,dispatch:null,lastRenderedReducer:BT,lastRenderedState:h},f.queue=b,f=aC.bind(null,Yr,b),b.dispatch=f,b=Qb(!1),E=rx.bind(null,Yr,!1,b.queue),b=As(),S={state:h,dispatch:null,action:o,pending:null},b.queue=S,f=$j.bind(null,Yr,S,E,f),S.dispatch=f,b.memoizedState=o,[h,f,!1]}function zT(o){var h=Sa();return $T(h,Bn,o)}function $T(o,h,f){if(h=Wb(o,h,BT)[0],o=Ff(pl)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var b=Xh(h)}catch(q){throw q===ud?Nf:q}else b=h;h=Sa();var S=h.queue,E=S.dispatch;return f!==h.memoizedState&&(Yr.flags|=2048,fd(9,{destroy:void 0},Uj.bind(null,S,f),null)),[b,E,o]}function Uj(o,h){o.action=h}function UT(o){var h=Sa(),f=Bn;if(f!==null)return $T(h,f,o);Sa(),h=h.memoizedState,f=Sa();var b=f.queue.dispatch;return f.memoizedState=o,[h,b,!1]}function fd(o,h,f,b){return o={tag:o,create:f,deps:b,inst:h,next:null},h=Yr.updateQueue,h===null&&(h=jf(),Yr.updateQueue=h),f=h.lastEffect,f===null?h.lastEffect=o.next=o:(b=f.next,f.next=o,o.next=b,h.lastEffect=o),o}function qT(){return Sa().memoizedState}function zf(o,h,f,b){var S=As();Yr.flags|=o,S.memoizedState=fd(1|h,{destroy:void 0},f,b===void 0?null:b)}function $f(o,h,f,b){var S=Sa();b=b===void 0?null:b;var E=S.memoizedState.inst;Bn!==null&&b!==null&&$b(b,Bn.memoizedState.deps)?S.memoizedState=fd(h,E,f,b):(Yr.flags|=o,S.memoizedState=fd(1|h,E,f,b))}function HT(o,h){zf(8390656,8,o,h)}function Xb(o,h){$f(2048,8,o,h)}function qj(o){Yr.flags|=4;var h=Yr.updateQueue;if(h===null)h=jf(),Yr.updateQueue=h,h.events=[o];else{var f=h.events;f===null?h.events=[o]:f.push(o)}}function GT(o){var h=Sa().memoizedState;return qj({ref:h,nextImpl:o}),function(){if((_n&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}function VT(o,h){return $f(4,2,o,h)}function WT(o,h){return $f(4,4,o,h)}function YT(o,h){if(typeof h=="function"){o=o();var f=h(o);return function(){typeof f=="function"?f():h(null)}}if(h!=null)return o=o(),h.current=o,function(){h.current=null}}function QT(o,h,f){f=f!=null?f.concat([o]):null,$f(4,4,YT.bind(null,h,o),f)}function Jb(){}function KT(o,h){var f=Sa();h=h===void 0?null:h;var b=f.memoizedState;return h!==null&&$b(h,b[1])?b[0]:(f.memoizedState=[o,h],o)}function XT(o,h){var f=Sa();h=h===void 0?null:h;var b=f.memoizedState;if(h!==null&&$b(h,b[1]))return b[0];if(b=o(),ru){sr(!0);try{o()}finally{sr(!1)}}return f.memoizedState=[b,h],b}function Zb(o,h,f){return f===void 0||(hl&1073741824)!==0&&(gn&261930)===0?o.memoizedState=h:(o.memoizedState=f,o=JC(),Yr.lanes|=o,lc|=o,f)}function JT(o,h,f,b){return br(f,h)?f:hd.current!==null?(o=Zb(o,f,b),br(o,h)||(Ia=!0),o):(hl&42)===0||(hl&1073741824)!==0&&(gn&261930)===0?(Ia=!0,o.memoizedState=f):(o=JC(),Yr.lanes|=o,lc|=o,h)}function ZT(o,h,f,b,S){var E=re.p;re.p=E!==0&&8>E?E:8;var q=H.T,ae={};H.T=ae,rx(o,!1,h,f);try{var Ce=S(),et=H.S;if(et!==null&&et(ae,Ce),Ce!==null&&typeof Ce=="object"&&typeof Ce.then=="function"){var pt=Bj(Ce,b);Jh(o,h,pt,ki(o))}else Jh(o,h,b,ki(o))}catch(xt){Jh(o,h,{then:function(){},status:"rejected",reason:xt},ki())}finally{re.p=E,q!==null&&ae.types!==null&&(q.types=ae.types),H.T=q}}function Hj(){}function ex(o,h,f,b){if(o.tag!==5)throw Error(n(476));var S=eC(o).queue;ZT(o,S,h,ne,f===null?Hj:function(){return tC(o),f(b)})}function eC(o){var h=o.memoizedState;if(h!==null)return h;h={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:ne},next:null};var f={};return h.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:pl,lastRenderedState:f},next:null},o.memoizedState=h,o=o.alternate,o!==null&&(o.memoizedState=h),h}function tC(o){var h=eC(o);h.next===null&&(h=o.alternate.memoizedState),Jh(o,h.next.queue,{},ki())}function tx(){return rs(fp)}function rC(){return Sa().memoizedState}function nC(){return Sa().memoizedState}function Gj(o){for(var h=o.return;h!==null;){switch(h.tag){case 24:case 3:var f=ki();o=rc(f);var b=nc(h,o,f);b!==null&&(Xs(b,h,f),Wh(b,h,f)),h={cache:Pb()},o.payload=h;return}h=h.return}}function Vj(o,h,f){var b=ki();f={lane:b,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Uf(o)?sC(h,f):(f=St(o,h,f,b),f!==null&&(Xs(f,o,b),iC(f,h,b)))}function aC(o,h,f){var b=ki();Jh(o,h,f,b)}function Jh(o,h,f,b){var S={lane:b,revertLane:0,gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null};if(Uf(o))sC(h,S);else{var E=o.alternate;if(o.lanes===0&&(E===null||E.lanes===0)&&(E=h.lastRenderedReducer,E!==null))try{var q=h.lastRenderedState,ae=E(q,f);if(S.hasEagerState=!0,S.eagerState=ae,br(ae,q))return At(o,h,S,0),Wn===null&&Xt(),!1}catch{}finally{}if(f=St(o,h,S,b),f!==null)return Xs(f,o,b),iC(f,h,b),!0}return!1}function rx(o,h,f,b){if(b={lane:2,revertLane:Lx(),gesture:null,action:b,hasEagerState:!1,eagerState:null,next:null},Uf(o)){if(h)throw Error(n(479))}else h=St(o,f,b,2),h!==null&&Xs(h,o,2)}function Uf(o){var h=o.alternate;return o===Yr||h!==null&&h===Yr}function sC(o,h){pd=Mf=!0;var f=o.pending;f===null?h.next=h:(h.next=f.next,f.next=h),o.pending=h}function iC(o,h,f){if((f&4194048)!==0){var b=h.lanes;b&=o.pendingLanes,f|=b,h.lanes=f,Qt(o,f)}}var Zh={readContext:rs,use:Bf,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useLayoutEffect:ma,useInsertionEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useSyncExternalStore:ma,useId:ma,useHostTransitionStatus:ma,useFormState:ma,useActionState:ma,useOptimistic:ma,useMemoCache:ma,useCacheRefresh:ma};Zh.useEffectEvent=ma;var oC={readContext:rs,use:Bf,useCallback:function(o,h){return As().memoizedState=[o,h===void 0?null:h],o},useContext:rs,useEffect:HT,useImperativeHandle:function(o,h,f){f=f!=null?f.concat([o]):null,zf(4194308,4,YT.bind(null,h,o),f)},useLayoutEffect:function(o,h){return zf(4194308,4,o,h)},useInsertionEffect:function(o,h){zf(4,2,o,h)},useMemo:function(o,h){var f=As();h=h===void 0?null:h;var b=o();if(ru){sr(!0);try{o()}finally{sr(!1)}}return f.memoizedState=[b,h],b},useReducer:function(o,h,f){var b=As();if(f!==void 0){var S=f(h);if(ru){sr(!0);try{f(h)}finally{sr(!1)}}}else S=h;return b.memoizedState=b.baseState=S,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:S},b.queue=o,o=o.dispatch=Vj.bind(null,Yr,o),[b.memoizedState,o]},useRef:function(o){var h=As();return o={current:o},h.memoizedState=o},useState:function(o){o=Qb(o);var h=o.queue,f=aC.bind(null,Yr,h);return h.dispatch=f,[o.memoizedState,f]},useDebugValue:Jb,useDeferredValue:function(o,h){var f=As();return Zb(f,o,h)},useTransition:function(){var o=Qb(!1);return o=ZT.bind(null,Yr,o.queue,!0,!1),As().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,h,f){var b=Yr,S=As();if(bn){if(f===void 0)throw Error(n(407));f=f()}else{if(f=h(),Wn===null)throw Error(n(349));(gn&127)!==0||AT(b,h,f)}S.memoizedState=f;var E={value:f,getSnapshot:h};return S.queue=E,HT(PT.bind(null,b,E,o),[o]),b.flags|=2048,fd(9,{destroy:void 0},NT.bind(null,b,E,f,h),null),f},useId:function(){var o=As(),h=Wn.identifierPrefix;if(bn){var f=Io,b=Po;f=(b&~(1<<32-vt(b)-1)).toString(32)+f,h="_"+h+"R_"+f,f=Of++,0<f&&(h+="H"+f.toString(32)),h+="_"}else f=Fj++,h="_"+h+"r_"+f.toString(32)+"_";return o.memoizedState=h},useHostTransitionStatus:tx,useFormState:FT,useActionState:FT,useOptimistic:function(o){var h=As();h.memoizedState=h.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=f,h=rx.bind(null,Yr,!0,f),f.dispatch=h,[o,h]},useMemoCache:Vb,useCacheRefresh:function(){return As().memoizedState=Gj.bind(null,Yr)},useEffectEvent:function(o){var h=As(),f={impl:o};return h.memoizedState=f,function(){if((_n&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}},nx={readContext:rs,use:Bf,useCallback:KT,useContext:rs,useEffect:Xb,useImperativeHandle:QT,useInsertionEffect:VT,useLayoutEffect:WT,useMemo:XT,useReducer:Ff,useRef:qT,useState:function(){return Ff(pl)},useDebugValue:Jb,useDeferredValue:function(o,h){var f=Sa();return JT(f,Bn.memoizedState,o,h)},useTransition:function(){var o=Ff(pl)[0],h=Sa().memoizedState;return[typeof o=="boolean"?o:Xh(o),h]},useSyncExternalStore:_T,useId:rC,useHostTransitionStatus:tx,useFormState:zT,useActionState:zT,useOptimistic:function(o,h){var f=Sa();return DT(f,Bn,o,h)},useMemoCache:Vb,useCacheRefresh:nC};nx.useEffectEvent=GT;var lC={readContext:rs,use:Bf,useCallback:KT,useContext:rs,useEffect:Xb,useImperativeHandle:QT,useInsertionEffect:VT,useLayoutEffect:WT,useMemo:XT,useReducer:Yb,useRef:qT,useState:function(){return Yb(pl)},useDebugValue:Jb,useDeferredValue:function(o,h){var f=Sa();return Bn===null?Zb(f,o,h):JT(f,Bn.memoizedState,o,h)},useTransition:function(){var o=Yb(pl)[0],h=Sa().memoizedState;return[typeof o=="boolean"?o:Xh(o),h]},useSyncExternalStore:_T,useId:rC,useHostTransitionStatus:tx,useFormState:UT,useActionState:UT,useOptimistic:function(o,h){var f=Sa();return Bn!==null?DT(f,Bn,o,h):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:Vb,useCacheRefresh:nC};lC.useEffectEvent=GT;function ax(o,h,f,b){h=o.memoizedState,f=f(b,h),f=f==null?h:g({},h,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var sx={enqueueSetState:function(o,h,f){o=o._reactInternals;var b=ki(),S=rc(b);S.payload=h,f!=null&&(S.callback=f),h=nc(o,S,b),h!==null&&(Xs(h,o,b),Wh(h,o,b))},enqueueReplaceState:function(o,h,f){o=o._reactInternals;var b=ki(),S=rc(b);S.tag=1,S.payload=h,f!=null&&(S.callback=f),h=nc(o,S,b),h!==null&&(Xs(h,o,b),Wh(h,o,b))},enqueueForceUpdate:function(o,h){o=o._reactInternals;var f=ki(),b=rc(f);b.tag=2,h!=null&&(b.callback=h),h=nc(o,b,f),h!==null&&(Xs(h,o,f),Wh(h,o,f))}};function cC(o,h,f,b,S,E,q){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(b,E,q):h.prototype&&h.prototype.isPureReactComponent?!v(f,b)||!v(S,E):!0}function uC(o,h,f,b){o=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(f,b),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(f,b),h.state!==o&&sx.enqueueReplaceState(h,h.state,null)}function nu(o,h){var f=h;if("ref"in h){f={};for(var b in h)b!=="ref"&&(f[b]=h[b])}if(o=o.defaultProps){f===h&&(f=g({},f));for(var S in o)f[S]===void 0&&(f[S]=o[S])}return f}function dC(o){nr(o)}function hC(o){console.error(o)}function pC(o){nr(o)}function qf(o,h){try{var f=o.onUncaughtError;f(h.value,{componentStack:h.stack})}catch(b){setTimeout(function(){throw b})}}function gC(o,h,f){try{var b=o.onCaughtError;b(f.value,{componentStack:f.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function ix(o,h,f){return f=rc(f),f.tag=3,f.payload={element:null},f.callback=function(){qf(o,h)},f}function fC(o){return o=rc(o),o.tag=3,o}function mC(o,h,f,b){var S=f.type.getDerivedStateFromError;if(typeof S=="function"){var E=b.value;o.payload=function(){return S(E)},o.callback=function(){gC(h,f,b)}}var q=f.stateNode;q!==null&&typeof q.componentDidCatch=="function"&&(o.callback=function(){gC(h,f,b),typeof S!="function"&&(cc===null?cc=new Set([this]):cc.add(this));var ae=b.stack;this.componentDidCatch(b.value,{componentStack:ae!==null?ae:""})})}function Wj(o,h,f,b,S){if(f.flags|=32768,b!==null&&typeof b=="object"&&typeof b.then=="function"){if(h=f.alternate,h!==null&&od(h,f,S,!0),f=xi.current,f!==null){switch(f.tag){case 31:case 13:return Bi===null?tm():f.alternate===null&&ya===0&&(ya=3),f.flags&=-257,f.flags|=65536,f.lanes=S,b===Pf?f.flags|=16384:(h=f.updateQueue,h===null?f.updateQueue=new Set([b]):h.add(b),Ix(o,b,S)),!1;case 22:return f.flags|=65536,b===Pf?f.flags|=16384:(h=f.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([b])},f.updateQueue=h):(f=h.retryQueue,f===null?h.retryQueue=new Set([b]):f.add(b)),Ix(o,b,S)),!1}throw Error(n(435,f.tag))}return Ix(o,b,S),tm(),!1}if(bn)return h=xi.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=S,b!==Cb&&(o=Error(n(422),{cause:b}),Uh(Li(o,f)))):(b!==Cb&&(h=Error(n(423),{cause:b}),Uh(Li(h,f))),o=o.current.alternate,o.flags|=65536,S&=-S,o.lanes|=S,b=Li(b,f),S=ix(o.stateNode,b,S),Ob(o,S),ya!==4&&(ya=2)),!1;var E=Error(n(520),{cause:b});if(E=Li(E,f),op===null?op=[E]:op.push(E),ya!==4&&(ya=2),h===null)return!0;b=Li(b,f),f=h;do{switch(f.tag){case 3:return f.flags|=65536,o=S&-S,f.lanes|=o,o=ix(f.stateNode,b,o),Ob(f,o),!1;case 1:if(h=f.type,E=f.stateNode,(f.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(cc===null||!cc.has(E))))return f.flags|=65536,S&=-S,f.lanes|=S,S=fC(S),mC(S,o,f,b),Ob(f,S),!1}f=f.return}while(f!==null);return!1}var ox=Error(n(461)),Ia=!1;function ns(o,h,f,b){h.child=o===null?vT(h,null,f,b):tu(h,o.child,f,b)}function yC(o,h,f,b,S){f=f.render;var E=h.ref;if("ref"in b){var q={};for(var ae in b)ae!=="ref"&&(q[ae]=b[ae])}else q=b;return Xc(h),b=Ub(o,h,f,q,E,S),ae=qb(),o!==null&&!Ia?(Hb(o,h,S),gl(o,h,S)):(bn&&ae&&kb(h),h.flags|=1,ns(o,h,b,S),h.child)}function bC(o,h,f,b,S){if(o===null){var E=f.type;return typeof E=="function"&&!Pn(E)&&E.defaultProps===void 0&&f.compare===null?(h.tag=15,h.type=E,xC(o,h,E,b,S)):(o=Tf(f.type,null,b,h,h.mode,S),o.ref=h.ref,o.return=h,h.child=o)}if(E=o.child,!fx(o,S)){var q=E.memoizedProps;if(f=f.compare,f=f!==null?f:v,f(q,b)&&o.ref===h.ref)return gl(o,h,S)}return h.flags|=1,o=Vn(E,b),o.ref=h.ref,o.return=h,h.child=o}function xC(o,h,f,b,S){if(o!==null){var E=o.memoizedProps;if(v(E,b)&&o.ref===h.ref)if(Ia=!1,h.pendingProps=b=E,fx(o,S))(o.flags&131072)!==0&&(Ia=!0);else return h.lanes=o.lanes,gl(o,h,S)}return lx(o,h,f,b,S)}function vC(o,h,f,b){var S=b.children,E=o!==null?o.memoizedState:null;if(o===null&&h.stateNode===null&&(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.mode==="hidden"){if((h.flags&128)!==0){if(E=E!==null?E.baseLanes|f:f,o!==null){for(b=h.child=o.child,S=0;b!==null;)S=S|b.lanes|b.childLanes,b=b.sibling;b=S&~E}else b=0,h.child=null;return wC(o,h,E,f,b)}if((f&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},o!==null&&Af(h,E!==null?E.cachePool:null),E!==null?kT(h,E):Bb(),TT(h);else return b=h.lanes=536870912,wC(o,h,E!==null?E.baseLanes|f:f,f,b)}else E!==null?(Af(h,E.cachePool),kT(h,E),sc(),h.memoizedState=null):(o!==null&&Af(h,null),Bb(),sc());return ns(o,h,S,f),h.child}function ep(o,h){return o!==null&&o.tag===22||h.stateNode!==null||(h.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.sibling}function wC(o,h,f,b,S){var E=Rb();return E=E===null?null:{parent:Na._currentValue,pool:E},h.memoizedState={baseLanes:f,cachePool:E},o!==null&&Af(h,null),Bb(),TT(h),o!==null&&od(o,h,b,!0),h.childLanes=S,null}function Hf(o,h){return h=Vf({mode:h.mode,children:h.children},o.mode),h.ref=o.ref,o.child=h,h.return=o,h}function SC(o,h,f){return tu(h,o.child,null,f),o=Hf(h,h.pendingProps),o.flags|=2,vi(h),h.memoizedState=null,o}function Yj(o,h,f){var b=h.pendingProps,S=(h.flags&128)!==0;if(h.flags&=-129,o===null){if(bn){if(b.mode==="hidden")return o=Hf(h,b),h.lanes=536870912,ep(null,o);if(zb(h),(o=ra)?(o=L2(o,ji),o=o!==null&&o.data==="&"?o:null,o!==null&&(h.memoizedState={dehydrated:o,treeContext:Xl!==null?{id:Po,overflow:Io}:null,retryLane:536870912,hydrationErrors:null},f=sT(o),f.return=h,h.child=f,ts=h,ra=null)):o=null,o===null)throw Zl(h);return h.lanes=536870912,null}return Hf(h,b)}var E=o.memoizedState;if(E!==null){var q=E.dehydrated;if(zb(h),S)if(h.flags&256)h.flags&=-257,h=SC(o,h,f);else if(h.memoizedState!==null)h.child=o.child,h.flags|=128,h=null;else throw Error(n(558));else if(Ia||od(o,h,f,!1),S=(f&o.childLanes)!==0,Ia||S){if(b=Wn,b!==null&&(q=Or(b,f),q!==0&&q!==E.retryLane))throw E.retryLane=q,Tr(o,q),Xs(b,o,q),ox;tm(),h=SC(o,h,f)}else o=E.treeContext,ra=Fi(q.nextSibling),ts=h,bn=!0,Jl=null,ji=!1,o!==null&&lT(h,o),h=Hf(h,b),h.flags|=4096;return h}return o=Vn(o.child,{mode:b.mode,children:b.children}),o.ref=h.ref,h.child=o,o.return=h,o}function Gf(o,h){var f=h.ref;if(f===null)o!==null&&o.ref!==null&&(h.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(o===null||o.ref!==f)&&(h.flags|=4194816)}}function lx(o,h,f,b,S){return Xc(h),f=Ub(o,h,f,b,void 0,S),b=qb(),o!==null&&!Ia?(Hb(o,h,S),gl(o,h,S)):(bn&&b&&kb(h),h.flags|=1,ns(o,h,f,S),h.child)}function kC(o,h,f,b,S,E){return Xc(h),h.updateQueue=null,f=ET(h,b,f,S),CT(o),b=qb(),o!==null&&!Ia?(Hb(o,h,E),gl(o,h,E)):(bn&&b&&kb(h),h.flags|=1,ns(o,h,f,E),h.child)}function TC(o,h,f,b,S){if(Xc(h),h.stateNode===null){var E=Jr,q=f.contextType;typeof q=="object"&&q!==null&&(E=rs(q)),E=new f(b,E),h.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,E.updater=sx,h.stateNode=E,E._reactInternals=h,E=h.stateNode,E.props=b,E.state=h.memoizedState,E.refs={},Lb(h),q=f.contextType,E.context=typeof q=="object"&&q!==null?rs(q):Jr,E.state=h.memoizedState,q=f.getDerivedStateFromProps,typeof q=="function"&&(ax(h,f,q,b),E.state=h.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(q=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),q!==E.state&&sx.enqueueReplaceState(E,E.state,null),Qh(h,b,E,S),Yh(),E.state=h.memoizedState),typeof E.componentDidMount=="function"&&(h.flags|=4194308),b=!0}else if(o===null){E=h.stateNode;var ae=h.memoizedProps,Ce=nu(f,ae);E.props=Ce;var et=E.context,pt=f.contextType;q=Jr,typeof pt=="object"&&pt!==null&&(q=rs(pt));var xt=f.getDerivedStateFromProps;pt=typeof xt=="function"||typeof E.getSnapshotBeforeUpdate=="function",ae=h.pendingProps!==ae,pt||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(ae||et!==q)&&uC(h,E,b,q),tc=!1;var rt=h.memoizedState;E.state=rt,Qh(h,b,E,S),Yh(),et=h.memoizedState,ae||rt!==et||tc?(typeof xt=="function"&&(ax(h,f,xt,b),et=h.memoizedState),(Ce=tc||cC(h,f,Ce,b,rt,et,q))?(pt||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(h.flags|=4194308)):(typeof E.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=b,h.memoizedState=et),E.props=b,E.state=et,E.context=q,b=Ce):(typeof E.componentDidMount=="function"&&(h.flags|=4194308),b=!1)}else{E=h.stateNode,Mb(o,h),q=h.memoizedProps,pt=nu(f,q),E.props=pt,xt=h.pendingProps,rt=E.context,et=f.contextType,Ce=Jr,typeof et=="object"&&et!==null&&(Ce=rs(et)),ae=f.getDerivedStateFromProps,(et=typeof ae=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(q!==xt||rt!==Ce)&&uC(h,E,b,Ce),tc=!1,rt=h.memoizedState,E.state=rt,Qh(h,b,E,S),Yh();var it=h.memoizedState;q!==xt||rt!==it||tc||o!==null&&o.dependencies!==null&&Ef(o.dependencies)?(typeof ae=="function"&&(ax(h,f,ae,b),it=h.memoizedState),(pt=tc||cC(h,f,pt,b,rt,it,Ce)||o!==null&&o.dependencies!==null&&Ef(o.dependencies))?(et||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(b,it,Ce),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(b,it,Ce)),typeof E.componentDidUpdate=="function"&&(h.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof E.componentDidUpdate!="function"||q===o.memoizedProps&&rt===o.memoizedState||(h.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&rt===o.memoizedState||(h.flags|=1024),h.memoizedProps=b,h.memoizedState=it),E.props=b,E.state=it,E.context=Ce,b=pt):(typeof E.componentDidUpdate!="function"||q===o.memoizedProps&&rt===o.memoizedState||(h.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||q===o.memoizedProps&&rt===o.memoizedState||(h.flags|=1024),b=!1)}return E=b,Gf(o,h),b=(h.flags&128)!==0,E||b?(E=h.stateNode,f=b&&typeof f.getDerivedStateFromError!="function"?null:E.render(),h.flags|=1,o!==null&&b?(h.child=tu(h,o.child,null,S),h.child=tu(h,null,f,S)):ns(o,h,f,S),h.memoizedState=E.state,o=h.child):o=gl(o,h,S),o}function CC(o,h,f,b){return Qc(),h.flags|=256,ns(o,h,f,b),h.child}var cx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ux(o){return{baseLanes:o,cachePool:gT()}}function dx(o,h,f){return o=o!==null?o.childLanes&~f:0,h&&(o|=Si),o}function EC(o,h,f){var b=h.pendingProps,S=!1,E=(h.flags&128)!==0,q;if((q=E)||(q=o!==null&&o.memoizedState===null?!1:(wa.current&2)!==0),q&&(S=!0,h.flags&=-129),q=(h.flags&32)!==0,h.flags&=-33,o===null){if(bn){if(S?ac(h):sc(),(o=ra)?(o=L2(o,ji),o=o!==null&&o.data!=="&"?o:null,o!==null&&(h.memoizedState={dehydrated:o,treeContext:Xl!==null?{id:Po,overflow:Io}:null,retryLane:536870912,hydrationErrors:null},f=sT(o),f.return=h,h.child=f,ts=h,ra=null)):o=null,o===null)throw Zl(h);return Wx(o)?h.lanes=32:h.lanes=536870912,null}var ae=b.children;return b=b.fallback,S?(sc(),S=h.mode,ae=Vf({mode:"hidden",children:ae},S),b=Yc(b,S,f,null),ae.return=h,b.return=h,ae.sibling=b,h.child=ae,b=h.child,b.memoizedState=ux(f),b.childLanes=dx(o,q,f),h.memoizedState=cx,ep(null,b)):(ac(h),hx(h,ae))}var Ce=o.memoizedState;if(Ce!==null&&(ae=Ce.dehydrated,ae!==null)){if(E)h.flags&256?(ac(h),h.flags&=-257,h=px(o,h,f)):h.memoizedState!==null?(sc(),h.child=o.child,h.flags|=128,h=null):(sc(),ae=b.fallback,S=h.mode,b=Vf({mode:"visible",children:b.children},S),ae=Yc(ae,S,f,null),ae.flags|=2,b.return=h,ae.return=h,b.sibling=ae,h.child=b,tu(h,o.child,null,f),b=h.child,b.memoizedState=ux(f),b.childLanes=dx(o,q,f),h.memoizedState=cx,h=ep(null,b));else if(ac(h),Wx(ae)){if(q=ae.nextSibling&&ae.nextSibling.dataset,q)var et=q.dgst;q=et,b=Error(n(419)),b.stack="",b.digest=q,Uh({value:b,source:null,stack:null}),h=px(o,h,f)}else if(Ia||od(o,h,f,!1),q=(f&o.childLanes)!==0,Ia||q){if(q=Wn,q!==null&&(b=Or(q,f),b!==0&&b!==Ce.retryLane))throw Ce.retryLane=b,Tr(o,b),Xs(q,o,b),ox;Vx(ae)||tm(),h=px(o,h,f)}else Vx(ae)?(h.flags|=192,h.child=o.child,h=null):(o=Ce.treeContext,ra=Fi(ae.nextSibling),ts=h,bn=!0,Jl=null,ji=!1,o!==null&&lT(h,o),h=hx(h,b.children),h.flags|=4096);return h}return S?(sc(),ae=b.fallback,S=h.mode,Ce=o.child,et=Ce.sibling,b=Vn(Ce,{mode:"hidden",children:b.children}),b.subtreeFlags=Ce.subtreeFlags&65011712,et!==null?ae=Vn(et,ae):(ae=Yc(ae,S,f,null),ae.flags|=2),ae.return=h,b.return=h,b.sibling=ae,h.child=b,ep(null,b),b=h.child,ae=o.child.memoizedState,ae===null?ae=ux(f):(S=ae.cachePool,S!==null?(Ce=Na._currentValue,S=S.parent!==Ce?{parent:Ce,pool:Ce}:S):S=gT(),ae={baseLanes:ae.baseLanes|f,cachePool:S}),b.memoizedState=ae,b.childLanes=dx(o,q,f),h.memoizedState=cx,ep(o.child,b)):(ac(h),f=o.child,o=f.sibling,f=Vn(f,{mode:"visible",children:b.children}),f.return=h,f.sibling=null,o!==null&&(q=h.deletions,q===null?(h.deletions=[o],h.flags|=16):q.push(o)),h.child=f,h.memoizedState=null,f)}function hx(o,h){return h=Vf({mode:"visible",children:h},o.mode),h.return=o,o.child=h}function Vf(o,h){return o=ga(22,o,null,h),o.lanes=0,o}function px(o,h,f){return tu(h,o.child,null,f),o=hx(h,h.pendingProps.children),o.flags|=2,h.memoizedState=null,o}function _C(o,h,f){o.lanes|=h;var b=o.alternate;b!==null&&(b.lanes|=h),Ab(o.return,h,f)}function gx(o,h,f,b,S,E){var q=o.memoizedState;q===null?o.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:b,tail:f,tailMode:S,treeForkCount:E}:(q.isBackwards=h,q.rendering=null,q.renderingStartTime=0,q.last=b,q.tail=f,q.tailMode=S,q.treeForkCount=E)}function AC(o,h,f){var b=h.pendingProps,S=b.revealOrder,E=b.tail;b=b.children;var q=wa.current,ae=(q&2)!==0;if(ae?(q=q&1|2,h.flags|=128):q&=1,U(wa,q),ns(o,h,b,f),b=bn?$h:0,!ae&&o!==null&&(o.flags&128)!==0)e:for(o=h.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&_C(o,f,h);else if(o.tag===19)_C(o,f,h);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===h)break e;for(;o.sibling===null;){if(o.return===null||o.return===h)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(S){case"forwards":for(f=h.child,S=null;f!==null;)o=f.alternate,o!==null&&Lf(o)===null&&(S=f),f=f.sibling;f=S,f===null?(S=h.child,h.child=null):(S=f.sibling,f.sibling=null),gx(h,!1,S,f,E,b);break;case"backwards":case"unstable_legacy-backwards":for(f=null,S=h.child,h.child=null;S!==null;){if(o=S.alternate,o!==null&&Lf(o)===null){h.child=S;break}o=S.sibling,S.sibling=f,f=S,S=o}gx(h,!0,f,null,E,b);break;case"together":gx(h,!1,null,null,void 0,b);break;default:h.memoizedState=null}return h.child}function gl(o,h,f){if(o!==null&&(h.dependencies=o.dependencies),lc|=h.lanes,(f&h.childLanes)===0)if(o!==null){if(od(o,h,f,!1),(f&h.childLanes)===0)return null}else return null;if(o!==null&&h.child!==o.child)throw Error(n(153));if(h.child!==null){for(o=h.child,f=Vn(o,o.pendingProps),h.child=f,f.return=h;o.sibling!==null;)o=o.sibling,f=f.sibling=Vn(o,o.pendingProps),f.return=h;f.sibling=null}return h.child}function fx(o,h){return(o.lanes&h)!==0?!0:(o=o.dependencies,!!(o!==null&&Ef(o)))}function Qj(o,h,f){switch(h.tag){case 3:Ne(h,h.stateNode.containerInfo),ec(h,Na,o.memoizedState.cache),Qc();break;case 27:case 5:se(h);break;case 4:Ne(h,h.stateNode.containerInfo);break;case 10:ec(h,h.type,h.memoizedProps.value);break;case 31:if(h.memoizedState!==null)return h.flags|=128,zb(h),null;break;case 13:var b=h.memoizedState;if(b!==null)return b.dehydrated!==null?(ac(h),h.flags|=128,null):(f&h.child.childLanes)!==0?EC(o,h,f):(ac(h),o=gl(o,h,f),o!==null?o.sibling:null);ac(h);break;case 19:var S=(o.flags&128)!==0;if(b=(f&h.childLanes)!==0,b||(od(o,h,f,!1),b=(f&h.childLanes)!==0),S){if(b)return AC(o,h,f);h.flags|=128}if(S=h.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),U(wa,wa.current),b)break;return null;case 22:return h.lanes=0,vC(o,h,f,h.pendingProps);case 24:ec(h,Na,o.memoizedState.cache)}return gl(o,h,f)}function NC(o,h,f){if(o!==null)if(o.memoizedProps!==h.pendingProps)Ia=!0;else{if(!fx(o,f)&&(h.flags&128)===0)return Ia=!1,Qj(o,h,f);Ia=(o.flags&131072)!==0}else Ia=!1,bn&&(h.flags&1048576)!==0&&oT(h,$h,h.index);switch(h.lanes=0,h.tag){case 16:e:{var b=h.pendingProps;if(o=Zc(h.elementType),h.type=o,typeof o=="function")Pn(o)?(b=nu(o,b),h.tag=1,h=TC(null,h,o,b,f)):(h.tag=0,h=lx(null,h,o,b,f));else{if(o!=null){var S=o.$$typeof;if(S===F){h.tag=11,h=yC(null,h,o,b,f);break e}else if(S===M){h.tag=14,h=bC(null,h,o,b,f);break e}}throw h=Q(o)||o,Error(n(306,h,""))}}return h;case 0:return lx(o,h,h.type,h.pendingProps,f);case 1:return b=h.type,S=nu(b,h.pendingProps),TC(o,h,b,S,f);case 3:e:{if(Ne(h,h.stateNode.containerInfo),o===null)throw Error(n(387));b=h.pendingProps;var E=h.memoizedState;S=E.element,Mb(o,h),Qh(h,b,null,f);var q=h.memoizedState;if(b=q.cache,ec(h,Na,b),b!==E.cache&&Nb(h,[Na],f,!0),Yh(),b=q.element,E.isDehydrated)if(E={element:b,isDehydrated:!1,cache:q.cache},h.updateQueue.baseState=E,h.memoizedState=E,h.flags&256){h=CC(o,h,b,f);break e}else if(b!==S){S=Li(Error(n(424)),h),Uh(S),h=CC(o,h,b,f);break e}else{switch(o=h.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(ra=Fi(o.firstChild),ts=h,bn=!0,Jl=null,ji=!0,f=vT(h,null,b,f),h.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Qc(),b===S){h=gl(o,h,f);break e}ns(o,h,b,f)}h=h.child}return h;case 26:return Gf(o,h),o===null?(f=z2(h.type,null,h.pendingProps,null))?h.memoizedState=f:bn||(f=h.type,o=h.pendingProps,b=lm(Ae.current).createElement(f),b[an]=h,b[tn]=o,as(b,f,o),jr(b),h.stateNode=b):h.memoizedState=z2(h.type,o.memoizedProps,h.pendingProps,o.memoizedState),null;case 27:return se(h),o===null&&bn&&(b=h.stateNode=j2(h.type,h.pendingProps,Ae.current),ts=h,ji=!0,S=ra,pc(h.type)?(Yx=S,ra=Fi(b.firstChild)):ra=S),ns(o,h,h.pendingProps.children,f),Gf(o,h),o===null&&(h.flags|=4194304),h.child;case 5:return o===null&&bn&&((S=b=ra)&&(b=CB(b,h.type,h.pendingProps,ji),b!==null?(h.stateNode=b,ts=h,ra=Fi(b.firstChild),ji=!1,S=!0):S=!1),S||Zl(h)),se(h),S=h.type,E=h.pendingProps,q=o!==null?o.memoizedProps:null,b=E.children,qx(S,E)?b=null:q!==null&&qx(S,q)&&(h.flags|=32),h.memoizedState!==null&&(S=Ub(o,h,zj,null,null,f),fp._currentValue=S),Gf(o,h),ns(o,h,b,f),h.child;case 6:return o===null&&bn&&((o=f=ra)&&(f=EB(f,h.pendingProps,ji),f!==null?(h.stateNode=f,ts=h,ra=null,o=!0):o=!1),o||Zl(h)),null;case 13:return EC(o,h,f);case 4:return Ne(h,h.stateNode.containerInfo),b=h.pendingProps,o===null?h.child=tu(h,null,b,f):ns(o,h,b,f),h.child;case 11:return yC(o,h,h.type,h.pendingProps,f);case 7:return ns(o,h,h.pendingProps,f),h.child;case 8:return ns(o,h,h.pendingProps.children,f),h.child;case 12:return ns(o,h,h.pendingProps.children,f),h.child;case 10:return b=h.pendingProps,ec(h,h.type,b.value),ns(o,h,b.children,f),h.child;case 9:return S=h.type._context,b=h.pendingProps.children,Xc(h),S=rs(S),b=b(S),h.flags|=1,ns(o,h,b,f),h.child;case 14:return bC(o,h,h.type,h.pendingProps,f);case 15:return xC(o,h,h.type,h.pendingProps,f);case 19:return AC(o,h,f);case 31:return Yj(o,h,f);case 22:return vC(o,h,f,h.pendingProps);case 24:return Xc(h),b=rs(Na),o===null?(S=Rb(),S===null&&(S=Wn,E=Pb(),S.pooledCache=E,E.refCount++,E!==null&&(S.pooledCacheLanes|=f),S=E),h.memoizedState={parent:b,cache:S},Lb(h),ec(h,Na,S)):((o.lanes&f)!==0&&(Mb(o,h),Qh(h,null,null,f),Yh()),S=o.memoizedState,E=h.memoizedState,S.parent!==b?(S={parent:b,cache:b},h.memoizedState=S,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=S),ec(h,Na,b)):(b=E.cache,ec(h,Na,b),b!==S.cache&&Nb(h,[Na],f,!0))),ns(o,h,h.pendingProps.children,f),h.child;case 29:throw h.pendingProps}throw Error(n(156,h.tag))}function fl(o){o.flags|=4}function mx(o,h,f,b,S){if((h=(o.mode&32)!==0)&&(h=!1),h){if(o.flags|=16777216,(S&335544128)===S)if(o.stateNode.complete)o.flags|=8192;else if(r2())o.flags|=8192;else throw eu=Pf,Db}else o.flags&=-16777217}function PC(o,h){if(h.type!=="stylesheet"||(h.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!G2(h))if(r2())o.flags|=8192;else throw eu=Pf,Db}function Wf(o,h){h!==null&&(o.flags|=4),o.flags&16384&&(h=o.tag!==22?xr():536870912,o.lanes|=h,xd|=h)}function tp(o,h){if(!bn)switch(o.tailMode){case"hidden":h=o.tail;for(var f=null;h!==null;)h.alternate!==null&&(f=h),h=h.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var b=null;f!==null;)f.alternate!==null&&(b=f),f=f.sibling;b===null?h||o.tail===null?o.tail=null:o.tail.sibling=null:b.sibling=null}}function na(o){var h=o.alternate!==null&&o.alternate.child===o.child,f=0,b=0;if(h)for(var S=o.child;S!==null;)f|=S.lanes|S.childLanes,b|=S.subtreeFlags&65011712,b|=S.flags&65011712,S.return=o,S=S.sibling;else for(S=o.child;S!==null;)f|=S.lanes|S.childLanes,b|=S.subtreeFlags,b|=S.flags,S.return=o,S=S.sibling;return o.subtreeFlags|=b,o.childLanes=f,h}function Kj(o,h,f){var b=h.pendingProps;switch(Tb(h),h.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return na(h),null;case 1:return na(h),null;case 3:return f=h.stateNode,b=null,o!==null&&(b=o.memoizedState.cache),h.memoizedState.cache!==b&&(h.flags|=2048),dl(Na),Te(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(id(h)?fl(h):o===null||o.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Eb())),na(h),null;case 26:var S=h.type,E=h.memoizedState;return o===null?(fl(h),E!==null?(na(h),PC(h,E)):(na(h),mx(h,S,null,b,f))):E?E!==o.memoizedState?(fl(h),na(h),PC(h,E)):(na(h),h.flags&=-16777217):(o=o.memoizedProps,o!==b&&fl(h),na(h),mx(h,S,o,b,f)),null;case 27:if(be(h),f=Ae.current,S=h.type,o!==null&&h.stateNode!=null)o.memoizedProps!==b&&fl(h);else{if(!b){if(h.stateNode===null)throw Error(n(166));return na(h),null}o=ce.current,id(h)?cT(h):(o=j2(S,b,f),h.stateNode=o,fl(h))}return na(h),null;case 5:if(be(h),S=h.type,o!==null&&h.stateNode!=null)o.memoizedProps!==b&&fl(h);else{if(!b){if(h.stateNode===null)throw Error(n(166));return na(h),null}if(E=ce.current,id(h))cT(h);else{var q=lm(Ae.current);switch(E){case 1:E=q.createElementNS("http://www.w3.org/2000/svg",S);break;case 2:E=q.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;default:switch(S){case"svg":E=q.createElementNS("http://www.w3.org/2000/svg",S);break;case"math":E=q.createElementNS("http://www.w3.org/1998/Math/MathML",S);break;case"script":E=q.createElement("div"),E.innerHTML="<script><\/script>",E=E.removeChild(E.firstChild);break;case"select":E=typeof b.is=="string"?q.createElement("select",{is:b.is}):q.createElement("select"),b.multiple?E.multiple=!0:b.size&&(E.size=b.size);break;default:E=typeof b.is=="string"?q.createElement(S,{is:b.is}):q.createElement(S)}}E[an]=h,E[tn]=b;e:for(q=h.child;q!==null;){if(q.tag===5||q.tag===6)E.appendChild(q.stateNode);else if(q.tag!==4&&q.tag!==27&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===h)break e;for(;q.sibling===null;){if(q.return===null||q.return===h)break e;q=q.return}q.sibling.return=q.return,q=q.sibling}h.stateNode=E;e:switch(as(E,S,b),S){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}b&&fl(h)}}return na(h),mx(h,h.type,o===null?null:o.memoizedProps,h.pendingProps,f),null;case 6:if(o&&h.stateNode!=null)o.memoizedProps!==b&&fl(h);else{if(typeof b!="string"&&h.stateNode===null)throw Error(n(166));if(o=Ae.current,id(h)){if(o=h.stateNode,f=h.memoizedProps,b=null,S=ts,S!==null)switch(S.tag){case 27:case 5:b=S.memoizedProps}o[an]=h,o=!!(o.nodeValue===f||b!==null&&b.suppressHydrationWarning===!0||E2(o.nodeValue,f)),o||Zl(h,!0)}else o=lm(o).createTextNode(b),o[an]=h,h.stateNode=o}return na(h),null;case 31:if(f=h.memoizedState,o===null||o.memoizedState!==null){if(b=id(h),f!==null){if(o===null){if(!b)throw Error(n(318));if(o=h.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(557));o[an]=h}else Qc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;na(h),o=!1}else f=Eb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=f),o=!0;if(!o)return h.flags&256?(vi(h),h):(vi(h),null);if((h.flags&128)!==0)throw Error(n(558))}return na(h),null;case 13:if(b=h.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(S=id(h),b!==null&&b.dehydrated!==null){if(o===null){if(!S)throw Error(n(318));if(S=h.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(n(317));S[an]=h}else Qc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;na(h),S=!1}else S=Eb(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=S),S=!0;if(!S)return h.flags&256?(vi(h),h):(vi(h),null)}return vi(h),(h.flags&128)!==0?(h.lanes=f,h):(f=b!==null,o=o!==null&&o.memoizedState!==null,f&&(b=h.child,S=null,b.alternate!==null&&b.alternate.memoizedState!==null&&b.alternate.memoizedState.cachePool!==null&&(S=b.alternate.memoizedState.cachePool.pool),E=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(E=b.memoizedState.cachePool.pool),E!==S&&(b.flags|=2048)),f!==o&&f&&(h.child.flags|=8192),Wf(h,h.updateQueue),na(h),null);case 4:return Te(),o===null&&Bx(h.stateNode.containerInfo),na(h),null;case 10:return dl(h.type),na(h),null;case 19:if(K(wa),b=h.memoizedState,b===null)return na(h),null;if(S=(h.flags&128)!==0,E=b.rendering,E===null)if(S)tp(b,!1);else{if(ya!==0||o!==null&&(o.flags&128)!==0)for(o=h.child;o!==null;){if(E=Lf(o),E!==null){for(h.flags|=128,tp(b,!1),o=E.updateQueue,h.updateQueue=o,Wf(h,o),h.subtreeFlags=0,o=f,f=h.child;f!==null;)no(f,o),f=f.sibling;return U(wa,wa.current&1|2),bn&&cl(h,b.treeForkCount),h.child}o=o.sibling}b.tail!==null&&kt()>Jf&&(h.flags|=128,S=!0,tp(b,!1),h.lanes=4194304)}else{if(!S)if(o=Lf(E),o!==null){if(h.flags|=128,S=!0,o=o.updateQueue,h.updateQueue=o,Wf(h,o),tp(b,!0),b.tail===null&&b.tailMode==="hidden"&&!E.alternate&&!bn)return na(h),null}else 2*kt()-b.renderingStartTime>Jf&&f!==536870912&&(h.flags|=128,S=!0,tp(b,!1),h.lanes=4194304);b.isBackwards?(E.sibling=h.child,h.child=E):(o=b.last,o!==null?o.sibling=E:h.child=E,b.last=E)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=kt(),o.sibling=null,f=wa.current,U(wa,S?f&1|2:f&1),bn&&cl(h,b.treeForkCount),o):(na(h),null);case 22:case 23:return vi(h),Fb(),b=h.memoizedState!==null,o!==null?o.memoizedState!==null!==b&&(h.flags|=8192):b&&(h.flags|=8192),b?(f&536870912)!==0&&(h.flags&128)===0&&(na(h),h.subtreeFlags&6&&(h.flags|=8192)):na(h),f=h.updateQueue,f!==null&&Wf(h,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==f&&(h.flags|=2048),o!==null&&K(Jc),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),h.memoizedState.cache!==f&&(h.flags|=2048),dl(Na),na(h),null;case 25:return null;case 30:return null}throw Error(n(156,h.tag))}function Xj(o,h){switch(Tb(h),h.tag){case 1:return o=h.flags,o&65536?(h.flags=o&-65537|128,h):null;case 3:return dl(Na),Te(),o=h.flags,(o&65536)!==0&&(o&128)===0?(h.flags=o&-65537|128,h):null;case 26:case 27:case 5:return be(h),null;case 31:if(h.memoizedState!==null){if(vi(h),h.alternate===null)throw Error(n(340));Qc()}return o=h.flags,o&65536?(h.flags=o&-65537|128,h):null;case 13:if(vi(h),o=h.memoizedState,o!==null&&o.dehydrated!==null){if(h.alternate===null)throw Error(n(340));Qc()}return o=h.flags,o&65536?(h.flags=o&-65537|128,h):null;case 19:return K(wa),null;case 4:return Te(),null;case 10:return dl(h.type),null;case 22:case 23:return vi(h),Fb(),o!==null&&K(Jc),o=h.flags,o&65536?(h.flags=o&-65537|128,h):null;case 24:return dl(Na),null;case 25:return null;default:return null}}function IC(o,h){switch(Tb(h),h.tag){case 3:dl(Na),Te();break;case 26:case 27:case 5:be(h);break;case 4:Te();break;case 31:h.memoizedState!==null&&vi(h);break;case 13:vi(h);break;case 19:K(wa);break;case 10:dl(h.type);break;case 22:case 23:vi(h),Fb(),o!==null&&K(Jc);break;case 24:dl(Na)}}function rp(o,h){try{var f=h.updateQueue,b=f!==null?f.lastEffect:null;if(b!==null){var S=b.next;f=S;do{if((f.tag&o)===o){b=void 0;var E=f.create,q=f.inst;b=E(),q.destroy=b}f=f.next}while(f!==S)}}catch(ae){Mn(h,h.return,ae)}}function ic(o,h,f){try{var b=h.updateQueue,S=b!==null?b.lastEffect:null;if(S!==null){var E=S.next;b=E;do{if((b.tag&o)===o){var q=b.inst,ae=q.destroy;if(ae!==void 0){q.destroy=void 0,S=h;var Ce=f,et=ae;try{et()}catch(pt){Mn(S,Ce,pt)}}}b=b.next}while(b!==E)}}catch(pt){Mn(h,h.return,pt)}}function RC(o){var h=o.updateQueue;if(h!==null){var f=o.stateNode;try{ST(h,f)}catch(b){Mn(o,o.return,b)}}}function DC(o,h,f){f.props=nu(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(b){Mn(o,h,b)}}function np(o,h){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var b=o.stateNode;break;case 30:b=o.stateNode;break;default:b=o.stateNode}typeof f=="function"?o.refCleanup=f(b):f.current=b}}catch(S){Mn(o,h,S)}}function Ro(o,h){var f=o.ref,b=o.refCleanup;if(f!==null)if(typeof b=="function")try{b()}catch(S){Mn(o,h,S)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(S){Mn(o,h,S)}else f.current=null}function LC(o){var h=o.type,f=o.memoizedProps,b=o.stateNode;try{e:switch(h){case"button":case"input":case"select":case"textarea":f.autoFocus&&b.focus();break e;case"img":f.src?b.src=f.src:f.srcSet&&(b.srcset=f.srcSet)}}catch(S){Mn(o,o.return,S)}}function yx(o,h,f){try{var b=o.stateNode;xB(b,o.type,f,h),b[tn]=h}catch(S){Mn(o,o.return,S)}}function MC(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&pc(o.type)||o.tag===4}function bx(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||MC(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&pc(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function xx(o,h,f){var b=o.tag;if(b===5||b===6)o=o.stateNode,h?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,h):(h=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,h.appendChild(o),f=f._reactRootContainer,f!=null||h.onclick!==null||(h.onclick=Bt));else if(b!==4&&(b===27&&pc(o.type)&&(f=o.stateNode,h=null),o=o.child,o!==null))for(xx(o,h,f),o=o.sibling;o!==null;)xx(o,h,f),o=o.sibling}function Yf(o,h,f){var b=o.tag;if(b===5||b===6)o=o.stateNode,h?f.insertBefore(o,h):f.appendChild(o);else if(b!==4&&(b===27&&pc(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(Yf(o,h,f),o=o.sibling;o!==null;)Yf(o,h,f),o=o.sibling}function OC(o){var h=o.stateNode,f=o.memoizedProps;try{for(var b=o.type,S=h.attributes;S.length;)h.removeAttributeNode(S[0]);as(h,b,f),h[an]=o,h[tn]=f}catch(E){Mn(o,o.return,E)}}var ml=!1,Ra=!1,vx=!1,jC=typeof WeakSet=="function"?WeakSet:Set,Qa=null;function Jj(o,h){if(o=o.containerInfo,$x=fm,o=G(o),J(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var b=f.getSelection&&f.getSelection();if(b&&b.rangeCount!==0){f=b.anchorNode;var S=b.anchorOffset,E=b.focusNode;b=b.focusOffset;try{f.nodeType,E.nodeType}catch{f=null;break e}var q=0,ae=-1,Ce=-1,et=0,pt=0,xt=o,rt=null;t:for(;;){for(var it;xt!==f||S!==0&&xt.nodeType!==3||(ae=q+S),xt!==E||b!==0&&xt.nodeType!==3||(Ce=q+b),xt.nodeType===3&&(q+=xt.nodeValue.length),(it=xt.firstChild)!==null;)rt=xt,xt=it;for(;;){if(xt===o)break t;if(rt===f&&++et===S&&(ae=q),rt===E&&++pt===b&&(Ce=q),(it=xt.nextSibling)!==null)break;xt=rt,rt=xt.parentNode}xt=it}f=ae===-1||Ce===-1?null:{start:ae,end:Ce}}else f=null}f=f||{start:0,end:0}}else f=null;for(Ux={focusedElem:o,selectionRange:f},fm=!1,Qa=h;Qa!==null;)if(h=Qa,o=h.child,(h.subtreeFlags&1028)!==0&&o!==null)o.return=h,Qa=o;else for(;Qa!==null;){switch(h=Qa,E=h.alternate,o=h.flags,h.tag){case 0:if((o&4)!==0&&(o=h.updateQueue,o=o!==null?o.events:null,o!==null))for(f=0;f<o.length;f++)S=o[f],S.ref.impl=S.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&E!==null){o=void 0,f=h,S=E.memoizedProps,E=E.memoizedState,b=f.stateNode;try{var cr=nu(f.type,S);o=b.getSnapshotBeforeUpdate(cr,E),b.__reactInternalSnapshotBeforeUpdate=o}catch(Rr){Mn(f,f.return,Rr)}}break;case 3:if((o&1024)!==0){if(o=h.stateNode.containerInfo,f=o.nodeType,f===9)Gx(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Gx(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=h.sibling,o!==null){o.return=h.return,Qa=o;break}Qa=h.return}}function BC(o,h,f){var b=f.flags;switch(f.tag){case 0:case 11:case 15:bl(o,f),b&4&&rp(5,f);break;case 1:if(bl(o,f),b&4)if(o=f.stateNode,h===null)try{o.componentDidMount()}catch(q){Mn(f,f.return,q)}else{var S=nu(f.type,h.memoizedProps);h=h.memoizedState;try{o.componentDidUpdate(S,h,o.__reactInternalSnapshotBeforeUpdate)}catch(q){Mn(f,f.return,q)}}b&64&&RC(f),b&512&&np(f,f.return);break;case 3:if(bl(o,f),b&64&&(o=f.updateQueue,o!==null)){if(h=null,f.child!==null)switch(f.child.tag){case 27:case 5:h=f.child.stateNode;break;case 1:h=f.child.stateNode}try{ST(o,h)}catch(q){Mn(f,f.return,q)}}break;case 27:h===null&&b&4&&OC(f);case 26:case 5:bl(o,f),h===null&&b&4&&LC(f),b&512&&np(f,f.return);break;case 12:bl(o,f);break;case 31:bl(o,f),b&4&&$C(o,f);break;case 13:bl(o,f),b&4&&UC(o,f),b&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=oB.bind(null,f),_B(o,f))));break;case 22:if(b=f.memoizedState!==null||ml,!b){h=h!==null&&h.memoizedState!==null||Ra,S=ml;var E=Ra;ml=b,(Ra=h)&&!E?xl(o,f,(f.subtreeFlags&8772)!==0):bl(o,f),ml=S,Ra=E}break;case 30:break;default:bl(o,f)}}function FC(o){var h=o.alternate;h!==null&&(o.alternate=null,FC(h)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(h=o.stateNode,h!==null&&De(h)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var sa=null,Ws=!1;function yl(o,h,f){for(f=f.child;f!==null;)zC(o,h,f),f=f.sibling}function zC(o,h,f){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(ur,f)}catch{}switch(f.tag){case 26:Ra||Ro(f,h),yl(o,h,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Ra||Ro(f,h);var b=sa,S=Ws;pc(f.type)&&(sa=f.stateNode,Ws=!1),yl(o,h,f),hp(f.stateNode),sa=b,Ws=S;break;case 5:Ra||Ro(f,h);case 6:if(b=sa,S=Ws,sa=null,yl(o,h,f),sa=b,Ws=S,sa!==null)if(Ws)try{(sa.nodeType===9?sa.body:sa.nodeName==="HTML"?sa.ownerDocument.body:sa).removeChild(f.stateNode)}catch(E){Mn(f,h,E)}else try{sa.removeChild(f.stateNode)}catch(E){Mn(f,h,E)}break;case 18:sa!==null&&(Ws?(o=sa,R2(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),_d(o)):R2(sa,f.stateNode));break;case 4:b=sa,S=Ws,sa=f.stateNode.containerInfo,Ws=!0,yl(o,h,f),sa=b,Ws=S;break;case 0:case 11:case 14:case 15:ic(2,f,h),Ra||ic(4,f,h),yl(o,h,f);break;case 1:Ra||(Ro(f,h),b=f.stateNode,typeof b.componentWillUnmount=="function"&&DC(f,h,b)),yl(o,h,f);break;case 21:yl(o,h,f);break;case 22:Ra=(b=Ra)||f.memoizedState!==null,yl(o,h,f),Ra=b;break;default:yl(o,h,f)}}function $C(o,h){if(h.memoizedState===null&&(o=h.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{_d(o)}catch(f){Mn(h,h.return,f)}}}function UC(o,h){if(h.memoizedState===null&&(o=h.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{_d(o)}catch(f){Mn(h,h.return,f)}}function Zj(o){switch(o.tag){case 31:case 13:case 19:var h=o.stateNode;return h===null&&(h=o.stateNode=new jC),h;case 22:return o=o.stateNode,h=o._retryCache,h===null&&(h=o._retryCache=new jC),h;default:throw Error(n(435,o.tag))}}function Qf(o,h){var f=Zj(o);h.forEach(function(b){if(!f.has(b)){f.add(b);var S=lB.bind(null,o,b);b.then(S,S)}})}function Ys(o,h){var f=h.deletions;if(f!==null)for(var b=0;b<f.length;b++){var S=f[b],E=o,q=h,ae=q;e:for(;ae!==null;){switch(ae.tag){case 27:if(pc(ae.type)){sa=ae.stateNode,Ws=!1;break e}break;case 5:sa=ae.stateNode,Ws=!1;break e;case 3:case 4:sa=ae.stateNode.containerInfo,Ws=!0;break e}ae=ae.return}if(sa===null)throw Error(n(160));zC(E,q,S),sa=null,Ws=!1,E=S.alternate,E!==null&&(E.return=null),S.return=null}if(h.subtreeFlags&13886)for(h=h.child;h!==null;)qC(h,o),h=h.sibling}var ao=null;function qC(o,h){var f=o.alternate,b=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Ys(h,o),Qs(o),b&4&&(ic(3,o,o.return),rp(3,o),ic(5,o,o.return));break;case 1:Ys(h,o),Qs(o),b&512&&(Ra||f===null||Ro(f,f.return)),b&64&&ml&&(o=o.updateQueue,o!==null&&(b=o.callbacks,b!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?b:f.concat(b))));break;case 26:var S=ao;if(Ys(h,o),Qs(o),b&512&&(Ra||f===null||Ro(f,f.return)),b&4){var E=f!==null?f.memoizedState:null;if(b=o.memoizedState,f===null)if(b===null)if(o.stateNode===null){e:{b=o.type,f=o.memoizedProps,S=S.ownerDocument||S;t:switch(b){case"title":E=S.getElementsByTagName("title")[0],(!E||E[rr]||E[an]||E.namespaceURI==="http://www.w3.org/2000/svg"||E.hasAttribute("itemprop"))&&(E=S.createElement(b),S.head.insertBefore(E,S.querySelector("head > title"))),as(E,b,f),E[an]=o,jr(E),b=E;break e;case"link":var q=q2("link","href",S).get(b+(f.href||""));if(q){for(var ae=0;ae<q.length;ae++)if(E=q[ae],E.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&E.getAttribute("rel")===(f.rel==null?null:f.rel)&&E.getAttribute("title")===(f.title==null?null:f.title)&&E.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){q.splice(ae,1);break t}}E=S.createElement(b),as(E,b,f),S.head.appendChild(E);break;case"meta":if(q=q2("meta","content",S).get(b+(f.content||""))){for(ae=0;ae<q.length;ae++)if(E=q[ae],E.getAttribute("content")===(f.content==null?null:""+f.content)&&E.getAttribute("name")===(f.name==null?null:f.name)&&E.getAttribute("property")===(f.property==null?null:f.property)&&E.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&E.getAttribute("charset")===(f.charSet==null?null:f.charSet)){q.splice(ae,1);break t}}E=S.createElement(b),as(E,b,f),S.head.appendChild(E);break;default:throw Error(n(468,b))}E[an]=o,jr(E),b=E}o.stateNode=b}else H2(S,o.type,o.stateNode);else o.stateNode=U2(S,b,o.memoizedProps);else E!==b?(E===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):E.count--,b===null?H2(S,o.type,o.stateNode):U2(S,b,o.memoizedProps)):b===null&&o.stateNode!==null&&yx(o,o.memoizedProps,f.memoizedProps)}break;case 27:Ys(h,o),Qs(o),b&512&&(Ra||f===null||Ro(f,f.return)),f!==null&&b&4&&yx(o,o.memoizedProps,f.memoizedProps);break;case 5:if(Ys(h,o),Qs(o),b&512&&(Ra||f===null||Ro(f,f.return)),o.flags&32){S=o.stateNode;try{kr(S,"")}catch(cr){Mn(o,o.return,cr)}}b&4&&o.stateNode!=null&&(S=o.memoizedProps,yx(o,S,f!==null?f.memoizedProps:S)),b&1024&&(vx=!0);break;case 6:if(Ys(h,o),Qs(o),b&4){if(o.stateNode===null)throw Error(n(162));b=o.memoizedProps,f=o.stateNode;try{f.nodeValue=b}catch(cr){Mn(o,o.return,cr)}}break;case 3:if(dm=null,S=ao,ao=cm(h.containerInfo),Ys(h,o),ao=S,Qs(o),b&4&&f!==null&&f.memoizedState.isDehydrated)try{_d(h.containerInfo)}catch(cr){Mn(o,o.return,cr)}vx&&(vx=!1,HC(o));break;case 4:b=ao,ao=cm(o.stateNode.containerInfo),Ys(h,o),Qs(o),ao=b;break;case 12:Ys(h,o),Qs(o);break;case 31:Ys(h,o),Qs(o),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,Qf(o,b)));break;case 13:Ys(h,o),Qs(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Xf=kt()),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,Qf(o,b)));break;case 22:S=o.memoizedState!==null;var Ce=f!==null&&f.memoizedState!==null,et=ml,pt=Ra;if(ml=et||S,Ra=pt||Ce,Ys(h,o),Ra=pt,ml=et,Qs(o),b&8192)e:for(h=o.stateNode,h._visibility=S?h._visibility&-2:h._visibility|1,S&&(f===null||Ce||ml||Ra||au(o)),f=null,h=o;;){if(h.tag===5||h.tag===26){if(f===null){Ce=f=h;try{if(E=Ce.stateNode,S)q=E.style,typeof q.setProperty=="function"?q.setProperty("display","none","important"):q.display="none";else{ae=Ce.stateNode;var xt=Ce.memoizedProps.style,rt=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;ae.style.display=rt==null||typeof rt=="boolean"?"":(""+rt).trim()}}catch(cr){Mn(Ce,Ce.return,cr)}}}else if(h.tag===6){if(f===null){Ce=h;try{Ce.stateNode.nodeValue=S?"":Ce.memoizedProps}catch(cr){Mn(Ce,Ce.return,cr)}}}else if(h.tag===18){if(f===null){Ce=h;try{var it=Ce.stateNode;S?D2(it,!0):D2(Ce.stateNode,!1)}catch(cr){Mn(Ce,Ce.return,cr)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===o)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===o)break e;for(;h.sibling===null;){if(h.return===null||h.return===o)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}b&4&&(b=o.updateQueue,b!==null&&(f=b.retryQueue,f!==null&&(b.retryQueue=null,Qf(o,f))));break;case 19:Ys(h,o),Qs(o),b&4&&(b=o.updateQueue,b!==null&&(o.updateQueue=null,Qf(o,b)));break;case 30:break;case 21:break;default:Ys(h,o),Qs(o)}}function Qs(o){var h=o.flags;if(h&2){try{for(var f,b=o.return;b!==null;){if(MC(b)){f=b;break}b=b.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var S=f.stateNode,E=bx(o);Yf(o,E,S);break;case 5:var q=f.stateNode;f.flags&32&&(kr(q,""),f.flags&=-33);var ae=bx(o);Yf(o,ae,q);break;case 3:case 4:var Ce=f.stateNode.containerInfo,et=bx(o);xx(o,et,Ce);break;default:throw Error(n(161))}}catch(pt){Mn(o,o.return,pt)}o.flags&=-3}h&4096&&(o.flags&=-4097)}function HC(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var h=o;HC(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),o=o.sibling}}function bl(o,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)BC(o,h.alternate,h),h=h.sibling}function au(o){for(o=o.child;o!==null;){var h=o;switch(h.tag){case 0:case 11:case 14:case 15:ic(4,h,h.return),au(h);break;case 1:Ro(h,h.return);var f=h.stateNode;typeof f.componentWillUnmount=="function"&&DC(h,h.return,f),au(h);break;case 27:hp(h.stateNode);case 26:case 5:Ro(h,h.return),au(h);break;case 22:h.memoizedState===null&&au(h);break;case 30:au(h);break;default:au(h)}o=o.sibling}}function xl(o,h,f){for(f=f&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;){var b=h.alternate,S=o,E=h,q=E.flags;switch(E.tag){case 0:case 11:case 15:xl(S,E,f),rp(4,E);break;case 1:if(xl(S,E,f),b=E,S=b.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(et){Mn(b,b.return,et)}if(b=E,S=b.updateQueue,S!==null){var ae=b.stateNode;try{var Ce=S.shared.hiddenCallbacks;if(Ce!==null)for(S.shared.hiddenCallbacks=null,S=0;S<Ce.length;S++)wT(Ce[S],ae)}catch(et){Mn(b,b.return,et)}}f&&q&64&&RC(E),np(E,E.return);break;case 27:OC(E);case 26:case 5:xl(S,E,f),f&&b===null&&q&4&&LC(E),np(E,E.return);break;case 12:xl(S,E,f);break;case 31:xl(S,E,f),f&&q&4&&$C(S,E);break;case 13:xl(S,E,f),f&&q&4&&UC(S,E);break;case 22:E.memoizedState===null&&xl(S,E,f),np(E,E.return);break;case 30:break;default:xl(S,E,f)}h=h.sibling}}function wx(o,h){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(o=h.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&qh(f))}function Sx(o,h){o=null,h.alternate!==null&&(o=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==o&&(h.refCount++,o!=null&&qh(o))}function so(o,h,f,b){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)GC(o,h,f,b),h=h.sibling}function GC(o,h,f,b){var S=h.flags;switch(h.tag){case 0:case 11:case 15:so(o,h,f,b),S&2048&&rp(9,h);break;case 1:so(o,h,f,b);break;case 3:so(o,h,f,b),S&2048&&(o=null,h.alternate!==null&&(o=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==o&&(h.refCount++,o!=null&&qh(o)));break;case 12:if(S&2048){so(o,h,f,b),o=h.stateNode;try{var E=h.memoizedProps,q=E.id,ae=E.onPostCommit;typeof ae=="function"&&ae(q,h.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(Ce){Mn(h,h.return,Ce)}}else so(o,h,f,b);break;case 31:so(o,h,f,b);break;case 13:so(o,h,f,b);break;case 23:break;case 22:E=h.stateNode,q=h.alternate,h.memoizedState!==null?E._visibility&2?so(o,h,f,b):ap(o,h):E._visibility&2?so(o,h,f,b):(E._visibility|=2,md(o,h,f,b,(h.subtreeFlags&10256)!==0||!1)),S&2048&&wx(q,h);break;case 24:so(o,h,f,b),S&2048&&Sx(h.alternate,h);break;default:so(o,h,f,b)}}function md(o,h,f,b,S){for(S=S&&((h.subtreeFlags&10256)!==0||!1),h=h.child;h!==null;){var E=o,q=h,ae=f,Ce=b,et=q.flags;switch(q.tag){case 0:case 11:case 15:md(E,q,ae,Ce,S),rp(8,q);break;case 23:break;case 22:var pt=q.stateNode;q.memoizedState!==null?pt._visibility&2?md(E,q,ae,Ce,S):ap(E,q):(pt._visibility|=2,md(E,q,ae,Ce,S)),S&&et&2048&&wx(q.alternate,q);break;case 24:md(E,q,ae,Ce,S),S&&et&2048&&Sx(q.alternate,q);break;default:md(E,q,ae,Ce,S)}h=h.sibling}}function ap(o,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var f=o,b=h,S=b.flags;switch(b.tag){case 22:ap(f,b),S&2048&&wx(b.alternate,b);break;case 24:ap(f,b),S&2048&&Sx(b.alternate,b);break;default:ap(f,b)}h=h.sibling}}var sp=8192;function yd(o,h,f){if(o.subtreeFlags&sp)for(o=o.child;o!==null;)VC(o,h,f),o=o.sibling}function VC(o,h,f){switch(o.tag){case 26:yd(o,h,f),o.flags&sp&&o.memoizedState!==null&&FB(f,ao,o.memoizedState,o.memoizedProps);break;case 5:yd(o,h,f);break;case 3:case 4:var b=ao;ao=cm(o.stateNode.containerInfo),yd(o,h,f),ao=b;break;case 22:o.memoizedState===null&&(b=o.alternate,b!==null&&b.memoizedState!==null?(b=sp,sp=16777216,yd(o,h,f),sp=b):yd(o,h,f));break;default:yd(o,h,f)}}function WC(o){var h=o.alternate;if(h!==null&&(o=h.child,o!==null)){h.child=null;do h=o.sibling,o.sibling=null,o=h;while(o!==null)}}function ip(o){var h=o.deletions;if((o.flags&16)!==0){if(h!==null)for(var f=0;f<h.length;f++){var b=h[f];Qa=b,QC(b,o)}WC(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)YC(o),o=o.sibling}function YC(o){switch(o.tag){case 0:case 11:case 15:ip(o),o.flags&2048&&ic(9,o,o.return);break;case 3:ip(o);break;case 12:ip(o);break;case 22:var h=o.stateNode;o.memoizedState!==null&&h._visibility&2&&(o.return===null||o.return.tag!==13)?(h._visibility&=-3,Kf(o)):ip(o);break;default:ip(o)}}function Kf(o){var h=o.deletions;if((o.flags&16)!==0){if(h!==null)for(var f=0;f<h.length;f++){var b=h[f];Qa=b,QC(b,o)}WC(o)}for(o=o.child;o!==null;){switch(h=o,h.tag){case 0:case 11:case 15:ic(8,h,h.return),Kf(h);break;case 22:f=h.stateNode,f._visibility&2&&(f._visibility&=-3,Kf(h));break;default:Kf(h)}o=o.sibling}}function QC(o,h){for(;Qa!==null;){var f=Qa;switch(f.tag){case 0:case 11:case 15:ic(8,f,h);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var b=f.memoizedState.cachePool.pool;b!=null&&b.refCount++}break;case 24:qh(f.memoizedState.cache)}if(b=f.child,b!==null)b.return=f,Qa=b;else e:for(f=o;Qa!==null;){b=Qa;var S=b.sibling,E=b.return;if(FC(b),b===f){Qa=null;break e}if(S!==null){S.return=E,Qa=S;break e}Qa=E}}}var eB={getCacheForType:function(o){var h=rs(Na),f=h.data.get(o);return f===void 0&&(f=o(),h.data.set(o,f)),f},cacheSignal:function(){return rs(Na).controller.signal}},tB=typeof WeakMap=="function"?WeakMap:Map,_n=0,Wn=null,sn=null,gn=0,Ln=0,wi=null,oc=!1,bd=!1,kx=!1,vl=0,ya=0,lc=0,su=0,Tx=0,Si=0,xd=0,op=null,Ks=null,Cx=!1,Xf=0,KC=0,Jf=1/0,Zf=null,cc=null,$a=0,uc=null,vd=null,wl=0,Ex=0,_x=null,XC=null,lp=0,Ax=null;function ki(){return(_n&2)!==0&&gn!==0?gn&-gn:H.T!==null?Lx():Ba()}function JC(){if(Si===0)if((gn&536870912)===0||bn){var o=Ca;Ca<<=1,(Ca&3932160)===0&&(Ca=262144),Si=o}else Si=536870912;return o=xi.current,o!==null&&(o.flags|=32),Si}function Xs(o,h,f){(o===Wn&&(Ln===2||Ln===9)||o.cancelPendingCommit!==null)&&(wd(o,0),dc(o,gn,Si,!1)),Xr(o,f),((_n&2)===0||o!==Wn)&&(o===Wn&&((_n&2)===0&&(su|=f),ya===4&&dc(o,gn,Si,!1)),Do(o))}function ZC(o,h,f){if((_n&6)!==0)throw Error(n(327));var b=!f&&(h&127)===0&&(h&o.expiredLanes)===0||ut(o,h),S=b?aB(o,h):Px(o,h,!0),E=b;do{if(S===0){bd&&!b&&dc(o,h,0,!1);break}else{if(f=o.current.alternate,E&&!rB(f)){S=Px(o,h,!1),E=!1;continue}if(S===2){if(E=h,o.errorRecoveryDisabledLanes&E)var q=0;else q=o.pendingLanes&-536870913,q=q!==0?q:q&536870912?536870912:0;if(q!==0){h=q;e:{var ae=o;S=op;var Ce=ae.current.memoizedState.isDehydrated;if(Ce&&(wd(ae,q).flags|=256),q=Px(ae,q,!1),q!==2){if(kx&&!Ce){ae.errorRecoveryDisabledLanes|=E,su|=E,S=4;break e}E=Ks,Ks=S,E!==null&&(Ks===null?Ks=E:Ks.push.apply(Ks,E))}S=q}if(E=!1,S!==2)continue}}if(S===1){wd(o,0),dc(o,h,0,!0);break}e:{switch(b=o,E=S,E){case 0:case 1:throw Error(n(345));case 4:if((h&4194048)!==h)break;case 6:dc(b,h,Si,!oc);break e;case 2:Ks=null;break;case 3:case 5:break;default:throw Error(n(329))}if((h&62914560)===h&&(S=Xf+300-kt(),10<S)){if(dc(b,h,Si,!oc),Se(b,0,!0)!==0)break e;wl=h,b.timeoutHandle=P2(e2.bind(null,b,f,Ks,Zf,Cx,h,Si,su,xd,oc,E,"Throttled",-0,0),S);break e}e2(b,f,Ks,Zf,Cx,h,Si,su,xd,oc,E,null,-0,0)}}break}while(!0);Do(o)}function e2(o,h,f,b,S,E,q,ae,Ce,et,pt,xt,rt,it){if(o.timeoutHandle=-1,xt=h.subtreeFlags,xt&8192||(xt&16785408)===16785408){xt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Bt},VC(h,E,xt);var cr=(E&62914560)===E?Xf-kt():(E&4194048)===E?KC-kt():0;if(cr=zB(xt,cr),cr!==null){wl=E,o.cancelPendingCommit=cr(l2.bind(null,o,h,E,f,b,S,q,ae,Ce,pt,xt,null,rt,it)),dc(o,E,q,!et);return}}l2(o,h,E,f,b,S,q,ae,Ce)}function rB(o){for(var h=o;;){var f=h.tag;if((f===0||f===11||f===15)&&h.flags&16384&&(f=h.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var b=0;b<f.length;b++){var S=f[b],E=S.getSnapshot;S=S.value;try{if(!br(E(),S))return!1}catch{return!1}}if(f=h.child,h.subtreeFlags&16384&&f!==null)f.return=h,h=f;else{if(h===o)break;for(;h.sibling===null;){if(h.return===null||h.return===o)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function dc(o,h,f,b){h&=~Tx,h&=~su,o.suspendedLanes|=h,o.pingedLanes&=~h,b&&(o.warmLanes|=h),b=o.expirationTimes;for(var S=h;0<S;){var E=31-vt(S),q=1<<E;b[E]=-1,S&=~q}f!==0&&Vt(o,f,h)}function em(){return(_n&6)===0?(cp(0),!1):!0}function Nx(){if(sn!==null){if(Ln===0)var o=sn.return;else o=sn,ul=Kc=null,Gb(o),dd=null,Gh=0,o=sn;for(;o!==null;)IC(o.alternate,o),o=o.return;sn=null}}function wd(o,h){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,SB(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),wl=0,Nx(),Wn=o,sn=f=Vn(o.current,null),gn=h,Ln=0,wi=null,oc=!1,bd=ut(o,h),kx=!1,xd=Si=Tx=su=lc=ya=0,Ks=op=null,Cx=!1,(h&8)!==0&&(h|=h&32);var b=o.entangledLanes;if(b!==0)for(o=o.entanglements,b&=h;0<b;){var S=31-vt(b),E=1<<S;h|=o[S],b&=~E}return vl=h,Xt(),f}function t2(o,h){Yr=null,H.H=Zh,h===ud||h===Nf?(h=yT(),Ln=3):h===Db?(h=yT(),Ln=4):Ln=h===ox?8:h!==null&&typeof h=="object"&&typeof h.then=="function"?6:1,wi=h,sn===null&&(ya=1,qf(o,Li(h,o.current)))}function r2(){var o=xi.current;return o===null?!0:(gn&4194048)===gn?Bi===null:(gn&62914560)===gn||(gn&536870912)!==0?o===Bi:!1}function n2(){var o=H.H;return H.H=Zh,o===null?Zh:o}function a2(){var o=H.A;return H.A=eB,o}function tm(){ya=4,oc||(gn&4194048)!==gn&&xi.current!==null||(bd=!0),(lc&134217727)===0&&(su&134217727)===0||Wn===null||dc(Wn,gn,Si,!1)}function Px(o,h,f){var b=_n;_n|=2;var S=n2(),E=a2();(Wn!==o||gn!==h)&&(Zf=null,wd(o,h)),h=!1;var q=ya;e:do try{if(Ln!==0&&sn!==null){var ae=sn,Ce=wi;switch(Ln){case 8:Nx(),q=6;break e;case 3:case 2:case 9:case 6:xi.current===null&&(h=!0);var et=Ln;if(Ln=0,wi=null,Sd(o,ae,Ce,et),f&&bd){q=0;break e}break;default:et=Ln,Ln=0,wi=null,Sd(o,ae,Ce,et)}}nB(),q=ya;break}catch(pt){t2(o,pt)}while(!0);return h&&o.shellSuspendCounter++,ul=Kc=null,_n=b,H.H=S,H.A=E,sn===null&&(Wn=null,gn=0,Xt()),q}function nB(){for(;sn!==null;)s2(sn)}function aB(o,h){var f=_n;_n|=2;var b=n2(),S=a2();Wn!==o||gn!==h?(Zf=null,Jf=kt()+500,wd(o,h)):bd=ut(o,h);e:do try{if(Ln!==0&&sn!==null){h=sn;var E=wi;t:switch(Ln){case 1:Ln=0,wi=null,Sd(o,h,E,1);break;case 2:case 9:if(fT(E)){Ln=0,wi=null,i2(h);break}h=function(){Ln!==2&&Ln!==9||Wn!==o||(Ln=7),Do(o)},E.then(h,h);break e;case 3:Ln=7;break e;case 4:Ln=5;break e;case 7:fT(E)?(Ln=0,wi=null,i2(h)):(Ln=0,wi=null,Sd(o,h,E,7));break;case 5:var q=null;switch(sn.tag){case 26:q=sn.memoizedState;case 5:case 27:var ae=sn;if(q?G2(q):ae.stateNode.complete){Ln=0,wi=null;var Ce=ae.sibling;if(Ce!==null)sn=Ce;else{var et=ae.return;et!==null?(sn=et,rm(et)):sn=null}break t}}Ln=0,wi=null,Sd(o,h,E,5);break;case 6:Ln=0,wi=null,Sd(o,h,E,6);break;case 8:Nx(),ya=6;break e;default:throw Error(n(462))}}sB();break}catch(pt){t2(o,pt)}while(!0);return ul=Kc=null,H.H=b,H.A=S,_n=f,sn!==null?0:(Wn=null,gn=0,Xt(),ya)}function sB(){for(;sn!==null&&!ct();)s2(sn)}function s2(o){var h=NC(o.alternate,o,vl);o.memoizedProps=o.pendingProps,h===null?rm(o):sn=h}function i2(o){var h=o,f=h.alternate;switch(h.tag){case 15:case 0:h=kC(f,h,h.pendingProps,h.type,void 0,gn);break;case 11:h=kC(f,h,h.pendingProps,h.type.render,h.ref,gn);break;case 5:Gb(h);default:IC(f,h),h=sn=no(h,vl),h=NC(f,h,vl)}o.memoizedProps=o.pendingProps,h===null?rm(o):sn=h}function Sd(o,h,f,b){ul=Kc=null,Gb(h),dd=null,Gh=0;var S=h.return;try{if(Wj(o,S,h,f,gn)){ya=1,qf(o,Li(f,o.current)),sn=null;return}}catch(E){if(S!==null)throw sn=S,E;ya=1,qf(o,Li(f,o.current)),sn=null;return}h.flags&32768?(bn||b===1?o=!0:bd||(gn&536870912)!==0?o=!1:(oc=o=!0,(b===2||b===9||b===3||b===6)&&(b=xi.current,b!==null&&b.tag===13&&(b.flags|=16384))),o2(h,o)):rm(h)}function rm(o){var h=o;do{if((h.flags&32768)!==0){o2(h,oc);return}o=h.return;var f=Kj(h.alternate,h,vl);if(f!==null){sn=f;return}if(h=h.sibling,h!==null){sn=h;return}sn=h=o}while(h!==null);ya===0&&(ya=5)}function o2(o,h){do{var f=Xj(o.alternate,o);if(f!==null){f.flags&=32767,sn=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!h&&(o=o.sibling,o!==null)){sn=o;return}sn=o=f}while(o!==null);ya=6,sn=null}function l2(o,h,f,b,S,E,q,ae,Ce){o.cancelPendingCommit=null;do nm();while($a!==0);if((_n&6)!==0)throw Error(n(327));if(h!==null){if(h===o.current)throw Error(n(177));if(E=h.lanes|h.childLanes,E|=Ve,tr(o,f,E,q,ae,Ce),o===Wn&&(sn=Wn=null,gn=0),vd=h,uc=o,wl=f,Ex=E,_x=S,XC=b,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,cB(Gt,function(){return p2(),null})):(o.callbackNode=null,o.callbackPriority=0),b=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||b){b=H.T,H.T=null,S=re.p,re.p=2,q=_n,_n|=4;try{Jj(o,h,f)}finally{_n=q,re.p=S,H.T=b}}$a=1,c2(),u2(),d2()}}function c2(){if($a===1){$a=0;var o=uc,h=vd,f=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||f){f=H.T,H.T=null;var b=re.p;re.p=2;var S=_n;_n|=4;try{qC(h,o);var E=Ux,q=G(o.containerInfo),ae=E.focusedElem,Ce=E.selectionRange;if(q!==ae&&ae&&ae.ownerDocument&&j(ae.ownerDocument.documentElement,ae)){if(Ce!==null&&J(ae)){var et=Ce.start,pt=Ce.end;if(pt===void 0&&(pt=et),"selectionStart"in ae)ae.selectionStart=et,ae.selectionEnd=Math.min(pt,ae.value.length);else{var xt=ae.ownerDocument||document,rt=xt&&xt.defaultView||window;if(rt.getSelection){var it=rt.getSelection(),cr=ae.textContent.length,Rr=Math.min(Ce.start,cr),zn=Ce.end===void 0?Rr:Math.min(Ce.end,cr);!it.extend&&Rr>zn&&(q=zn,zn=Rr,Rr=q);var He=R(ae,Rr),Me=R(ae,zn);if(He&&Me&&(it.rangeCount!==1||it.anchorNode!==He.node||it.anchorOffset!==He.offset||it.focusNode!==Me.node||it.focusOffset!==Me.offset)){var Ze=xt.createRange();Ze.setStart(He.node,He.offset),it.removeAllRanges(),Rr>zn?(it.addRange(Ze),it.extend(Me.node,Me.offset)):(Ze.setEnd(Me.node,Me.offset),it.addRange(Ze))}}}}for(xt=[],it=ae;it=it.parentNode;)it.nodeType===1&&xt.push({element:it,left:it.scrollLeft,top:it.scrollTop});for(typeof ae.focus=="function"&&ae.focus(),ae=0;ae<xt.length;ae++){var ft=xt[ae];ft.element.scrollLeft=ft.left,ft.element.scrollTop=ft.top}}fm=!!$x,Ux=$x=null}finally{_n=S,re.p=b,H.T=f}}o.current=h,$a=2}}function u2(){if($a===2){$a=0;var o=uc,h=vd,f=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||f){f=H.T,H.T=null;var b=re.p;re.p=2;var S=_n;_n|=4;try{BC(o,h.alternate,h)}finally{_n=S,re.p=b,H.T=f}}$a=3}}function d2(){if($a===4||$a===3){$a=0,Dt();var o=uc,h=vd,f=wl,b=XC;(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?$a=5:($a=0,vd=uc=null,h2(o,o.pendingLanes));var S=o.pendingLanes;if(S===0&&(cc=null),Dn(f),h=h.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(ur,h,void 0,(h.current.flags&128)===128)}catch{}if(b!==null){h=H.T,S=re.p,re.p=2,H.T=null;try{for(var E=o.onRecoverableError,q=0;q<b.length;q++){var ae=b[q];E(ae.value,{componentStack:ae.stack})}}finally{H.T=h,re.p=S}}(wl&3)!==0&&nm(),Do(o),S=o.pendingLanes,(f&261930)!==0&&(S&42)!==0?o===Ax?lp++:(lp=0,Ax=o):lp=0,cp(0)}}function h2(o,h){(o.pooledCacheLanes&=h)===0&&(h=o.pooledCache,h!=null&&(o.pooledCache=null,qh(h)))}function nm(){return c2(),u2(),d2(),p2()}function p2(){if($a!==5)return!1;var o=uc,h=Ex;Ex=0;var f=Dn(wl),b=H.T,S=re.p;try{re.p=32>f?32:f,H.T=null,f=_x,_x=null;var E=uc,q=wl;if($a=0,vd=uc=null,wl=0,(_n&6)!==0)throw Error(n(331));var ae=_n;if(_n|=4,YC(E.current),GC(E,E.current,q,f),_n=ae,cp(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(ur,E)}catch{}return!0}finally{re.p=S,H.T=b,h2(o,h)}}function g2(o,h,f){h=Li(f,h),h=ix(o.stateNode,h,2),o=nc(o,h,2),o!==null&&(Xr(o,2),Do(o))}function Mn(o,h,f){if(o.tag===3)g2(o,o,f);else for(;h!==null;){if(h.tag===3){g2(h,o,f);break}else if(h.tag===1){var b=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(cc===null||!cc.has(b))){o=Li(f,o),f=fC(2),b=nc(h,f,2),b!==null&&(mC(f,b,h,o),Xr(b,2),Do(b));break}}h=h.return}}function Ix(o,h,f){var b=o.pingCache;if(b===null){b=o.pingCache=new tB;var S=new Set;b.set(h,S)}else S=b.get(h),S===void 0&&(S=new Set,b.set(h,S));S.has(f)||(kx=!0,S.add(f),o=iB.bind(null,o,h,f),h.then(o,o))}function iB(o,h,f){var b=o.pingCache;b!==null&&b.delete(h),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,Wn===o&&(gn&f)===f&&(ya===4||ya===3&&(gn&62914560)===gn&&300>kt()-Xf?(_n&2)===0&&wd(o,0):Tx|=f,xd===gn&&(xd=0)),Do(o)}function f2(o,h){h===0&&(h=xr()),o=Tr(o,h),o!==null&&(Xr(o,h),Do(o))}function oB(o){var h=o.memoizedState,f=0;h!==null&&(f=h.retryLane),f2(o,f)}function lB(o,h){var f=0;switch(o.tag){case 31:case 13:var b=o.stateNode,S=o.memoizedState;S!==null&&(f=S.retryLane);break;case 19:b=o.stateNode;break;case 22:b=o.stateNode._retryCache;break;default:throw Error(n(314))}b!==null&&b.delete(h),f2(o,f)}function cB(o,h){return ht(o,h)}var am=null,kd=null,Rx=!1,sm=!1,Dx=!1,hc=0;function Do(o){o!==kd&&o.next===null&&(kd===null?am=kd=o:kd=kd.next=o),sm=!0,Rx||(Rx=!0,dB())}function cp(o,h){if(!Dx&&sm){Dx=!0;do for(var f=!1,b=am;b!==null;){if(o!==0){var S=b.pendingLanes;if(S===0)var E=0;else{var q=b.suspendedLanes,ae=b.pingedLanes;E=(1<<31-vt(42|o)+1)-1,E&=S&~(q&~ae),E=E&201326741?E&201326741|1:E?E|2:0}E!==0&&(f=!0,x2(b,E))}else E=gn,E=Se(b,b===Wn?E:0,b.cancelPendingCommit!==null||b.timeoutHandle!==-1),(E&3)===0||ut(b,E)||(f=!0,x2(b,E));b=b.next}while(f);Dx=!1}}function uB(){m2()}function m2(){sm=Rx=!1;var o=0;hc!==0&&wB()&&(o=hc);for(var h=kt(),f=null,b=am;b!==null;){var S=b.next,E=y2(b,h);E===0?(b.next=null,f===null?am=S:f.next=S,S===null&&(kd=f)):(f=b,(o!==0||(E&3)!==0)&&(sm=!0)),b=S}$a!==0&&$a!==5||cp(o),hc!==0&&(hc=0)}function y2(o,h){for(var f=o.suspendedLanes,b=o.pingedLanes,S=o.expirationTimes,E=o.pendingLanes&-62914561;0<E;){var q=31-vt(E),ae=1<<q,Ce=S[q];Ce===-1?((ae&f)===0||(ae&b)!==0)&&(S[q]=Nt(ae,h)):Ce<=h&&(o.expiredLanes|=ae),E&=~ae}if(h=Wn,f=gn,f=Se(o,o===h?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),b=o.callbackNode,f===0||o===h&&(Ln===2||Ln===9)||o.cancelPendingCommit!==null)return b!==null&&b!==null&&er(b),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||ut(o,f)){if(h=f&-f,h===o.callbackPriority)return h;switch(b!==null&&er(b),Dn(f)){case 2:case 8:f=st;break;case 32:f=Gt;break;case 268435456:f=lr;break;default:f=Gt}return b=b2.bind(null,o),f=ht(f,b),o.callbackPriority=h,o.callbackNode=f,h}return b!==null&&b!==null&&er(b),o.callbackPriority=2,o.callbackNode=null,2}function b2(o,h){if($a!==0&&$a!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(nm()&&o.callbackNode!==f)return null;var b=gn;return b=Se(o,o===Wn?b:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),b===0?null:(ZC(o,b,h),y2(o,kt()),o.callbackNode!=null&&o.callbackNode===f?b2.bind(null,o):null)}function x2(o,h){if(nm())return null;ZC(o,h,!0)}function dB(){kB(function(){(_n&6)!==0?ht(qe,uB):m2()})}function Lx(){if(hc===0){var o=ld;o===0&&(o=zt,zt<<=1,(zt&261888)===0&&(zt=256)),hc=o}return hc}function v2(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Nn(""+o)}function w2(o,h){var f=h.ownerDocument.createElement("input");return f.name=h.name,f.value=h.value,o.id&&f.setAttribute("form",o.id),h.parentNode.insertBefore(f,h),o=new FormData(o),f.parentNode.removeChild(f),o}function hB(o,h,f,b,S){if(h==="submit"&&f&&f.stateNode===S){var E=v2((S[tn]||null).action),q=b.submitter;q&&(h=(h=q[tn]||null)?v2(h.formAction):q.getAttribute("formAction"),h!==null&&(E=h,q=null));var ae=new Eo("action","action",null,b,S);o.push({event:ae,listeners:[{instance:null,listener:function(){if(b.defaultPrevented){if(hc!==0){var Ce=q?w2(S,q):new FormData(S);ex(f,{pending:!0,data:Ce,method:S.method,action:E},null,Ce)}}else typeof E=="function"&&(ae.preventDefault(),Ce=q?w2(S,q):new FormData(S),ex(f,{pending:!0,data:Ce,method:S.method,action:E},E,Ce))},currentTarget:S}]})}}for(var Mx=0;Mx<Wt.length;Mx++){var Ox=Wt[Mx],pB=Ox.toLowerCase(),gB=Ox[0].toUpperCase()+Ox.slice(1);Et(pB,"on"+gB)}Et(Le,"onAnimationEnd"),Et(V,"onAnimationIteration"),Et(at,"onAnimationStart"),Et("dblclick","onDoubleClick"),Et("focusin","onFocus"),Et("focusout","onBlur"),Et(ot,"onTransitionRun"),Et(jt,"onTransitionStart"),Et(Ht,"onTransitionCancel"),Et(Lt,"onTransitionEnd"),Tt("onMouseEnter",["mouseout","mouseover"]),Tt("onMouseLeave",["mouseout","mouseover"]),Tt("onPointerEnter",["pointerout","pointerover"]),Tt("onPointerLeave",["pointerout","pointerover"]),Hn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Hn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Hn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Hn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Hn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var up="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fB=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(up));function S2(o,h){h=(h&4)!==0;for(var f=0;f<o.length;f++){var b=o[f],S=b.event;b=b.listeners;e:{var E=void 0;if(h)for(var q=b.length-1;0<=q;q--){var ae=b[q],Ce=ae.instance,et=ae.currentTarget;if(ae=ae.listener,Ce!==E&&S.isPropagationStopped())break e;E=ae,S.currentTarget=et;try{E(S)}catch(pt){nr(pt)}S.currentTarget=null,E=Ce}else for(q=0;q<b.length;q++){if(ae=b[q],Ce=ae.instance,et=ae.currentTarget,ae=ae.listener,Ce!==E&&S.isPropagationStopped())break e;E=ae,S.currentTarget=et;try{E(S)}catch(pt){nr(pt)}S.currentTarget=null,E=Ce}}}}function on(o,h){var f=h[_a];f===void 0&&(f=h[_a]=new Set);var b=o+"__bubble";f.has(b)||(k2(h,o,2,!1),f.add(b))}function jx(o,h,f){var b=0;h&&(b|=4),k2(f,o,b,h)}var im="_reactListening"+Math.random().toString(36).slice(2);function Bx(o){if(!o[im]){o[im]=!0,ir.forEach(function(f){f!=="selectionchange"&&(fB.has(f)||jx(f,!1,o),jx(f,!0,o))});var h=o.nodeType===9?o:o.ownerDocument;h===null||h[im]||(h[im]=!0,jx("selectionchange",!1,h))}}function k2(o,h,f,b){switch(J2(h)){case 2:var S=qB;break;case 8:S=HB;break;default:S=Zx}f=S.bind(null,h,f,o),S=void 0,!$l||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(S=!0),b?S!==void 0?o.addEventListener(h,f,{capture:!0,passive:S}):o.addEventListener(h,f,!0):S!==void 0?o.addEventListener(h,f,{passive:S}):o.addEventListener(h,f,!1)}function Fx(o,h,f,b,S){var E=b;if((h&1)===0&&(h&2)===0&&b!==null)e:for(;;){if(b===null)return;var q=b.tag;if(q===3||q===4){var ae=b.stateNode.containerInfo;if(ae===S)break;if(q===4)for(q=b.return;q!==null;){var Ce=q.tag;if((Ce===3||Ce===4)&&q.stateNode.containerInfo===S)return;q=q.return}for(;ae!==null;){if(q=bt(ae),q===null)return;if(Ce=q.tag,Ce===5||Ce===6||Ce===26||Ce===27){b=E=q;continue e}ae=ae.parentNode}}b=b.return}Es(function(){var et=E,pt=Pr(f),xt=[];e:{var rt=Ft.get(o);if(rt!==void 0){var it=Eo,cr=o;switch(o){case"keypress":if(Co(f)===0)break e;case"keydown":case"keyup":it=Vl;break;case"focusin":cr="focus",it=yi;break;case"focusout":cr="blur",it=yi;break;case"beforeblur":case"afterblur":it=yi;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":it=al;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":it=to;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":it=bi;break;case Le:case V:case at:it=Ku;break;case Lt:it=il;break;case"scroll":case"scrollend":it=Ya;break;case"wheel":it=ol;break;case"copy":case"cut":case"paste":it=Ao;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":it=Uc;break;case"toggle":case"beforetoggle":it=Gc}var Rr=(h&4)!==0,zn=!Rr&&(o==="scroll"||o==="scrollend"),He=Rr?rt!==null?rt+"Capture":null:rt;Rr=[];for(var Me=et,Ze;Me!==null;){var ft=Me;if(Ze=ft.stateNode,ft=ft.tag,ft!==5&&ft!==26&&ft!==27||Ze===null||He===null||(ft=_s(Me,He),ft!=null&&Rr.push(dp(Me,ft,Ze))),zn)break;Me=Me.return}0<Rr.length&&(rt=new it(rt,cr,null,f,pt),xt.push({event:rt,listeners:Rr}))}}if((h&7)===0){e:{if(rt=o==="mouseover"||o==="pointerover",it=o==="mouseout"||o==="pointerout",rt&&f!==ar&&(cr=f.relatedTarget||f.fromElement)&&(bt(cr)||cr[ca]))break e;if((it||rt)&&(rt=pt.window===pt?pt:(rt=pt.ownerDocument)?rt.defaultView||rt.parentWindow:window,it?(cr=f.relatedTarget||f.toElement,it=et,cr=cr?bt(cr):null,cr!==null&&(zn=s(cr),Rr=cr.tag,cr!==zn||Rr!==5&&Rr!==27&&Rr!==6)&&(cr=null)):(it=null,cr=et),it!==cr)){if(Rr=al,ft="onMouseLeave",He="onMouseEnter",Me="mouse",(o==="pointerout"||o==="pointerover")&&(Rr=Uc,ft="onPointerLeave",He="onPointerEnter",Me="pointer"),zn=it==null?rt:zr(it),Ze=cr==null?rt:zr(cr),rt=new Rr(ft,Me+"leave",it,f,pt),rt.target=zn,rt.relatedTarget=Ze,ft=null,bt(pt)===et&&(Rr=new Rr(He,Me+"enter",cr,f,pt),Rr.target=Ze,Rr.relatedTarget=zn,ft=Rr),zn=ft,it&&cr)t:{for(Rr=mB,He=it,Me=cr,Ze=0,ft=He;ft;ft=Rr(ft))Ze++;ft=0;for(var Cr=Me;Cr;Cr=Rr(Cr))ft++;for(;0<Ze-ft;)He=Rr(He),Ze--;for(;0<ft-Ze;)Me=Rr(Me),ft--;for(;Ze--;){if(He===Me||Me!==null&&He===Me.alternate){Rr=He;break t}He=Rr(He),Me=Rr(Me)}Rr=null}else Rr=null;it!==null&&T2(xt,rt,it,Rr,!1),cr!==null&&zn!==null&&T2(xt,zn,cr,Rr,!0)}}e:{if(rt=et?zr(et):window,it=rt.nodeName&&rt.nodeName.toLowerCase(),it==="select"||it==="input"&&rt.type==="file")var Tn=Ge;else if(Kl(rt))if(yt)Tn=Ke;else{Tn=gt;var yr=Oe}else it=rt.nodeName,!it||it.toLowerCase()!=="input"||rt.type!=="checkbox"&&rt.type!=="radio"?et&&$s(et.elementType)&&(Tn=Ge):Tn=It;if(Tn&&(Tn=Tn(o,et))){Wc(xt,Tn,f,pt);break e}yr&&yr(o,rt,et),o==="focusout"&&et&&rt.type==="number"&&et.memoizedProps.value!=null&&cs(rt,"number",rt.value)}switch(yr=et?zr(et):window,o){case"focusin":(Kl(yr)||yr.contentEditable==="true")&&(ge=yr,Ee=et,Re=null);break;case"focusout":Re=Ee=ge=null;break;case"mousedown":$e=!0;break;case"contextmenu":case"mouseup":case"dragend":$e=!1,ke(xt,f,pt);break;case"selectionchange":if(le)break;case"keydown":case"keyup":ke(xt,f,pt)}var Zr;if(ds)e:{switch(o){case"compositionstart":var fn="onCompositionStart";break e;case"compositionend":fn="onCompositionEnd";break e;case"compositionupdate":fn="onCompositionUpdate";break e}fn=void 0}else ro?Vc(o,f)&&(fn="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(fn="onCompositionStart");fn&&(Yl&&f.locale!=="ko"&&(ro||fn!=="onCompositionStart"?fn==="onCompositionEnd"&&ro&&(Zr=eo()):(qs=pt,pi="value"in qs?qs.value:qs.textContent,ro=!0)),yr=om(et,fn),0<yr.length&&(fn=new sl(fn,o,null,f,pt),xt.push({event:fn,listeners:yr}),Zr?fn.data=Zr:(Zr=ed(f),Zr!==null&&(fn.data=Zr)))),(Zr=zh?td(o,f):rd(o,f))&&(fn=om(et,"onBeforeInput"),0<fn.length&&(yr=new sl("onBeforeInput","beforeinput",null,f,pt),xt.push({event:yr,listeners:fn}),yr.data=Zr)),hB(xt,o,et,f,pt)}S2(xt,h)})}function dp(o,h,f){return{instance:o,listener:h,currentTarget:f}}function om(o,h){for(var f=h+"Capture",b=[];o!==null;){var S=o,E=S.stateNode;if(S=S.tag,S!==5&&S!==26&&S!==27||E===null||(S=_s(o,f),S!=null&&b.unshift(dp(o,S,E)),S=_s(o,h),S!=null&&b.push(dp(o,S,E))),o.tag===3)return b;o=o.return}return[]}function mB(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function T2(o,h,f,b,S){for(var E=h._reactName,q=[];f!==null&&f!==b;){var ae=f,Ce=ae.alternate,et=ae.stateNode;if(ae=ae.tag,Ce!==null&&Ce===b)break;ae!==5&&ae!==26&&ae!==27||et===null||(Ce=et,S?(et=_s(f,E),et!=null&&q.unshift(dp(f,et,Ce))):S||(et=_s(f,E),et!=null&&q.push(dp(f,et,Ce)))),f=f.return}q.length!==0&&o.push({event:h,listeners:q})}var yB=/\r\n?/g,bB=/\u0000|\uFFFD/g;function C2(o){return(typeof o=="string"?o:""+o).replace(yB,`
`).replace(bB,"")}function E2(o,h){return h=C2(h),C2(o)===h}function Fn(o,h,f,b,S,E){switch(f){case"children":typeof b=="string"?h==="body"||h==="textarea"&&b===""||kr(o,b):(typeof b=="number"||typeof b=="bigint")&&h!=="body"&&kr(o,""+b);break;case"className":Fa(o,"class",b);break;case"tabIndex":Fa(o,"tabindex",b);break;case"dir":case"role":case"viewBox":case"width":case"height":Fa(o,f,b);break;case"style":xn(o,b,E);break;case"data":if(h!=="object"){Fa(o,"data",b);break}case"src":case"href":if(b===""&&(h!=="a"||f!=="href")){o.removeAttribute(f);break}if(b==null||typeof b=="function"||typeof b=="symbol"||typeof b=="boolean"){o.removeAttribute(f);break}b=Nn(""+b),o.setAttribute(f,b);break;case"action":case"formAction":if(typeof b=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof E=="function"&&(f==="formAction"?(h!=="input"&&Fn(o,h,"name",S.name,S,null),Fn(o,h,"formEncType",S.formEncType,S,null),Fn(o,h,"formMethod",S.formMethod,S,null),Fn(o,h,"formTarget",S.formTarget,S,null)):(Fn(o,h,"encType",S.encType,S,null),Fn(o,h,"method",S.method,S,null),Fn(o,h,"target",S.target,S,null)));if(b==null||typeof b=="symbol"||typeof b=="boolean"){o.removeAttribute(f);break}b=Nn(""+b),o.setAttribute(f,b);break;case"onClick":b!=null&&(o.onclick=Bt);break;case"onScroll":b!=null&&on("scroll",o);break;case"onScrollEnd":b!=null&&on("scrollend",o);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(f=b.__html,f!=null){if(S.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"multiple":o.multiple=b&&typeof b!="function"&&typeof b!="symbol";break;case"muted":o.muted=b&&typeof b!="function"&&typeof b!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(b==null||typeof b=="function"||typeof b=="boolean"||typeof b=="symbol"){o.removeAttribute("xlink:href");break}f=Nn(""+b),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":b!=null&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(f,""+b):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":b&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":b===!0?o.setAttribute(f,""):b!==!1&&b!=null&&typeof b!="function"&&typeof b!="symbol"?o.setAttribute(f,b):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":b!=null&&typeof b!="function"&&typeof b!="symbol"&&!isNaN(b)&&1<=b?o.setAttribute(f,b):o.removeAttribute(f);break;case"rowSpan":case"start":b==null||typeof b=="function"||typeof b=="symbol"||isNaN(b)?o.removeAttribute(f):o.setAttribute(f,b);break;case"popover":on("beforetoggle",o),on("toggle",o),vr(o,"popover",b);break;case"xlinkActuate":ua(o,"http://www.w3.org/1999/xlink","xlink:actuate",b);break;case"xlinkArcrole":ua(o,"http://www.w3.org/1999/xlink","xlink:arcrole",b);break;case"xlinkRole":ua(o,"http://www.w3.org/1999/xlink","xlink:role",b);break;case"xlinkShow":ua(o,"http://www.w3.org/1999/xlink","xlink:show",b);break;case"xlinkTitle":ua(o,"http://www.w3.org/1999/xlink","xlink:title",b);break;case"xlinkType":ua(o,"http://www.w3.org/1999/xlink","xlink:type",b);break;case"xmlBase":ua(o,"http://www.w3.org/XML/1998/namespace","xml:base",b);break;case"xmlLang":ua(o,"http://www.w3.org/XML/1998/namespace","xml:lang",b);break;case"xmlSpace":ua(o,"http://www.w3.org/XML/1998/namespace","xml:space",b);break;case"is":vr(o,"is",b);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Us.get(f)||f,vr(o,f,b))}}function zx(o,h,f,b,S,E){switch(f){case"style":xn(o,b,E);break;case"dangerouslySetInnerHTML":if(b!=null){if(typeof b!="object"||!("__html"in b))throw Error(n(61));if(f=b.__html,f!=null){if(S.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"children":typeof b=="string"?kr(o,b):(typeof b=="number"||typeof b=="bigint")&&kr(o,""+b);break;case"onScroll":b!=null&&on("scroll",o);break;case"onScrollEnd":b!=null&&on("scrollend",o);break;case"onClick":b!=null&&(o.onclick=Bt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kn.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(S=f.endsWith("Capture"),h=f.slice(2,S?f.length-7:void 0),E=o[tn]||null,E=E!=null?E[f]:null,typeof E=="function"&&o.removeEventListener(h,E,S),typeof b=="function")){typeof E!="function"&&E!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(h,b,S);break e}f in o?o[f]=b:b===!0?o.setAttribute(f,""):vr(o,f,b)}}}function as(o,h,f){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":on("error",o),on("load",o);var b=!1,S=!1,E;for(E in f)if(f.hasOwnProperty(E)){var q=f[E];if(q!=null)switch(E){case"src":b=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:Fn(o,h,E,q,f,null)}}S&&Fn(o,h,"srcSet",f.srcSet,f,null),b&&Fn(o,h,"src",f.src,f,null);return;case"input":on("invalid",o);var ae=E=q=S=null,Ce=null,et=null;for(b in f)if(f.hasOwnProperty(b)){var pt=f[b];if(pt!=null)switch(b){case"name":S=pt;break;case"type":q=pt;break;case"checked":Ce=pt;break;case"defaultChecked":et=pt;break;case"value":E=pt;break;case"defaultValue":ae=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(n(137,h));break;default:Fn(o,h,b,pt,f,null)}}ui(o,E,ae,Ce,et,q,S,!1);return;case"select":on("invalid",o),b=q=E=null;for(S in f)if(f.hasOwnProperty(S)&&(ae=f[S],ae!=null))switch(S){case"value":E=ae;break;case"defaultValue":q=ae;break;case"multiple":b=ae;default:Fn(o,h,S,ae,f,null)}h=E,f=q,o.multiple=!!b,h!=null?An(o,!!b,h,!1):f!=null&&An(o,!!b,f,!0);return;case"textarea":on("invalid",o),E=S=b=null;for(q in f)if(f.hasOwnProperty(q)&&(ae=f[q],ae!=null))switch(q){case"value":b=ae;break;case"defaultValue":S=ae;break;case"children":E=ae;break;case"dangerouslySetInnerHTML":if(ae!=null)throw Error(n(91));break;default:Fn(o,h,q,ae,f,null)}zs(o,b,S,E);return;case"option":for(Ce in f)if(f.hasOwnProperty(Ce)&&(b=f[Ce],b!=null))switch(Ce){case"selected":o.selected=b&&typeof b!="function"&&typeof b!="symbol";break;default:Fn(o,h,Ce,b,f,null)}return;case"dialog":on("beforetoggle",o),on("toggle",o),on("cancel",o),on("close",o);break;case"iframe":case"object":on("load",o);break;case"video":case"audio":for(b=0;b<up.length;b++)on(up[b],o);break;case"image":on("error",o),on("load",o);break;case"details":on("toggle",o);break;case"embed":case"source":case"link":on("error",o),on("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(et in f)if(f.hasOwnProperty(et)&&(b=f[et],b!=null))switch(et){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,h));default:Fn(o,h,et,b,f,null)}return;default:if($s(h)){for(pt in f)f.hasOwnProperty(pt)&&(b=f[pt],b!==void 0&&zx(o,h,pt,b,f,void 0));return}}for(ae in f)f.hasOwnProperty(ae)&&(b=f[ae],b!=null&&Fn(o,h,ae,b,f,null))}function xB(o,h,f,b){switch(h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,E=null,q=null,ae=null,Ce=null,et=null,pt=null;for(it in f){var xt=f[it];if(f.hasOwnProperty(it)&&xt!=null)switch(it){case"checked":break;case"value":break;case"defaultValue":Ce=xt;default:b.hasOwnProperty(it)||Fn(o,h,it,null,b,xt)}}for(var rt in b){var it=b[rt];if(xt=f[rt],b.hasOwnProperty(rt)&&(it!=null||xt!=null))switch(rt){case"type":E=it;break;case"name":S=it;break;case"checked":et=it;break;case"defaultChecked":pt=it;break;case"value":q=it;break;case"defaultValue":ae=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(n(137,h));break;default:it!==xt&&Fn(o,h,rt,it,b,xt)}}Fs(o,q,ae,Ce,et,pt,E,S);return;case"select":it=q=ae=rt=null;for(E in f)if(Ce=f[E],f.hasOwnProperty(E)&&Ce!=null)switch(E){case"value":break;case"multiple":it=Ce;default:b.hasOwnProperty(E)||Fn(o,h,E,null,b,Ce)}for(S in b)if(E=b[S],Ce=f[S],b.hasOwnProperty(S)&&(E!=null||Ce!=null))switch(S){case"value":rt=E;break;case"defaultValue":ae=E;break;case"multiple":q=E;default:E!==Ce&&Fn(o,h,S,E,b,Ce)}h=ae,f=q,b=it,rt!=null?An(o,!!f,rt,!1):!!b!=!!f&&(h!=null?An(o,!!f,h,!0):An(o,!!f,f?[]:"",!1));return;case"textarea":it=rt=null;for(ae in f)if(S=f[ae],f.hasOwnProperty(ae)&&S!=null&&!b.hasOwnProperty(ae))switch(ae){case"value":break;case"children":break;default:Fn(o,h,ae,null,b,S)}for(q in b)if(S=b[q],E=f[q],b.hasOwnProperty(q)&&(S!=null||E!=null))switch(q){case"value":rt=S;break;case"defaultValue":it=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(n(91));break;default:S!==E&&Fn(o,h,q,S,b,E)}To(o,rt,it);return;case"option":for(var cr in f)if(rt=f[cr],f.hasOwnProperty(cr)&&rt!=null&&!b.hasOwnProperty(cr))switch(cr){case"selected":o.selected=!1;break;default:Fn(o,h,cr,null,b,rt)}for(Ce in b)if(rt=b[Ce],it=f[Ce],b.hasOwnProperty(Ce)&&rt!==it&&(rt!=null||it!=null))switch(Ce){case"selected":o.selected=rt&&typeof rt!="function"&&typeof rt!="symbol";break;default:Fn(o,h,Ce,rt,b,it)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rr in f)rt=f[Rr],f.hasOwnProperty(Rr)&&rt!=null&&!b.hasOwnProperty(Rr)&&Fn(o,h,Rr,null,b,rt);for(et in b)if(rt=b[et],it=f[et],b.hasOwnProperty(et)&&rt!==it&&(rt!=null||it!=null))switch(et){case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,h));break;default:Fn(o,h,et,rt,b,it)}return;default:if($s(h)){for(var zn in f)rt=f[zn],f.hasOwnProperty(zn)&&rt!==void 0&&!b.hasOwnProperty(zn)&&zx(o,h,zn,void 0,b,rt);for(pt in b)rt=b[pt],it=f[pt],!b.hasOwnProperty(pt)||rt===it||rt===void 0&&it===void 0||zx(o,h,pt,rt,b,it);return}}for(var He in f)rt=f[He],f.hasOwnProperty(He)&&rt!=null&&!b.hasOwnProperty(He)&&Fn(o,h,He,null,b,rt);for(xt in b)rt=b[xt],it=f[xt],!b.hasOwnProperty(xt)||rt===it||rt==null&&it==null||Fn(o,h,xt,rt,b,it)}function _2(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vB(){if(typeof performance.getEntriesByType=="function"){for(var o=0,h=0,f=performance.getEntriesByType("resource"),b=0;b<f.length;b++){var S=f[b],E=S.transferSize,q=S.initiatorType,ae=S.duration;if(E&&ae&&_2(q)){for(q=0,ae=S.responseEnd,b+=1;b<f.length;b++){var Ce=f[b],et=Ce.startTime;if(et>ae)break;var pt=Ce.transferSize,xt=Ce.initiatorType;pt&&_2(xt)&&(Ce=Ce.responseEnd,q+=pt*(Ce<ae?1:(ae-et)/(Ce-et)))}if(--b,h+=8*(E+q)/(S.duration/1e3),o++,10<o)break}}if(0<o)return h/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var $x=null,Ux=null;function lm(o){return o.nodeType===9?o:o.ownerDocument}function A2(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function N2(o,h){if(o===0)switch(h){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&h==="foreignObject"?0:o}function qx(o,h){return o==="textarea"||o==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Hx=null;function wB(){var o=window.event;return o&&o.type==="popstate"?o===Hx?!1:(Hx=o,!0):(Hx=null,!1)}var P2=typeof setTimeout=="function"?setTimeout:void 0,SB=typeof clearTimeout=="function"?clearTimeout:void 0,I2=typeof Promise=="function"?Promise:void 0,kB=typeof queueMicrotask=="function"?queueMicrotask:typeof I2<"u"?function(o){return I2.resolve(null).then(o).catch(TB)}:P2;function TB(o){setTimeout(function(){throw o})}function pc(o){return o==="head"}function R2(o,h){var f=h,b=0;do{var S=f.nextSibling;if(o.removeChild(f),S&&S.nodeType===8)if(f=S.data,f==="/$"||f==="/&"){if(b===0){o.removeChild(S),_d(h);return}b--}else if(f==="$"||f==="$?"||f==="$~"||f==="$!"||f==="&")b++;else if(f==="html")hp(o.ownerDocument.documentElement);else if(f==="head"){f=o.ownerDocument.head,hp(f);for(var E=f.firstChild;E;){var q=E.nextSibling,ae=E.nodeName;E[rr]||ae==="SCRIPT"||ae==="STYLE"||ae==="LINK"&&E.rel.toLowerCase()==="stylesheet"||f.removeChild(E),E=q}}else f==="body"&&hp(o.ownerDocument.body);f=S}while(f);_d(h)}function D2(o,h){var f=o;o=0;do{var b=f.nextSibling;if(f.nodeType===1?h?(f._stashedDisplay=f.style.display,f.style.display="none"):(f.style.display=f._stashedDisplay||"",f.getAttribute("style")===""&&f.removeAttribute("style")):f.nodeType===3&&(h?(f._stashedText=f.nodeValue,f.nodeValue=""):f.nodeValue=f._stashedText||""),b&&b.nodeType===8)if(f=b.data,f==="/$"){if(o===0)break;o--}else f!=="$"&&f!=="$?"&&f!=="$~"&&f!=="$!"||o++;f=b}while(f)}function Gx(o){var h=o.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var f=h;switch(h=h.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Gx(f),De(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function CB(o,h,f,b){for(;o.nodeType===1;){var S=f;if(o.nodeName.toLowerCase()!==h.toLowerCase()){if(!b&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(b){if(!o[rr])switch(h){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(E=o.getAttribute("rel"),E==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(E!==S.rel||o.getAttribute("href")!==(S.href==null||S.href===""?null:S.href)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||o.getAttribute("title")!==(S.title==null?null:S.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(E=o.getAttribute("src"),(E!==(S.src==null?null:S.src)||o.getAttribute("type")!==(S.type==null?null:S.type)||o.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&E&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(h==="input"&&o.type==="hidden"){var E=S.name==null?null:""+S.name;if(S.type==="hidden"&&o.getAttribute("name")===E)return o}else return o;if(o=Fi(o.nextSibling),o===null)break}return null}function EB(o,h,f){if(h==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Fi(o.nextSibling),o===null))return null;return o}function L2(o,h){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=Fi(o.nextSibling),o===null))return null;return o}function Vx(o){return o.data==="$?"||o.data==="$~"}function Wx(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function _B(o,h){var f=o.ownerDocument;if(o.data==="$~")o._reactRetry=h;else if(o.data!=="$?"||f.readyState!=="loading")h();else{var b=function(){h(),f.removeEventListener("DOMContentLoaded",b)};f.addEventListener("DOMContentLoaded",b),o._reactRetry=b}}function Fi(o){for(;o!=null;o=o.nextSibling){var h=o.nodeType;if(h===1||h===3)break;if(h===8){if(h=o.data,h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"||h==="F!"||h==="F")break;if(h==="/$"||h==="/&")return null}}return o}var Yx=null;function M2(o){o=o.nextSibling;for(var h=0;o;){if(o.nodeType===8){var f=o.data;if(f==="/$"||f==="/&"){if(h===0)return Fi(o.nextSibling);h--}else f!=="$"&&f!=="$!"&&f!=="$?"&&f!=="$~"&&f!=="&"||h++}o=o.nextSibling}return null}function O2(o){o=o.previousSibling;for(var h=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"){if(h===0)return o;h--}else f!=="/$"&&f!=="/&"||h++}o=o.previousSibling}return null}function j2(o,h,f){switch(h=lm(f),o){case"html":if(o=h.documentElement,!o)throw Error(n(452));return o;case"head":if(o=h.head,!o)throw Error(n(453));return o;case"body":if(o=h.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function hp(o){for(var h=o.attributes;h.length;)o.removeAttributeNode(h[0]);De(o)}var zi=new Map,B2=new Set;function cm(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Sl=re.d;re.d={f:AB,r:NB,D:PB,C:IB,L:RB,m:DB,X:MB,S:LB,M:OB};function AB(){var o=Sl.f(),h=em();return o||h}function NB(o){var h=Mt(o);h!==null&&h.tag===5&&h.type==="form"?tC(h):Sl.r(o)}var Td=typeof document>"u"?null:document;function F2(o,h,f){var b=Td;if(b&&typeof h=="string"&&h){var S=da(h);S='link[rel="'+o+'"][href="'+S+'"]',typeof f=="string"&&(S+='[crossorigin="'+f+'"]'),B2.has(S)||(B2.add(S),o={rel:o,crossOrigin:f,href:h},b.querySelector(S)===null&&(h=b.createElement("link"),as(h,"link",o),jr(h),b.head.appendChild(h)))}}function PB(o){Sl.D(o),F2("dns-prefetch",o,null)}function IB(o,h){Sl.C(o,h),F2("preconnect",o,h)}function RB(o,h,f){Sl.L(o,h,f);var b=Td;if(b&&o&&h){var S='link[rel="preload"][as="'+da(h)+'"]';h==="image"&&f&&f.imageSrcSet?(S+='[imagesrcset="'+da(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(S+='[imagesizes="'+da(f.imageSizes)+'"]')):S+='[href="'+da(o)+'"]';var E=S;switch(h){case"style":E=Cd(o);break;case"script":E=Ed(o)}zi.has(E)||(o=g({rel:"preload",href:h==="image"&&f&&f.imageSrcSet?void 0:o,as:h},f),zi.set(E,o),b.querySelector(S)!==null||h==="style"&&b.querySelector(pp(E))||h==="script"&&b.querySelector(gp(E))||(h=b.createElement("link"),as(h,"link",o),jr(h),b.head.appendChild(h)))}}function DB(o,h){Sl.m(o,h);var f=Td;if(f&&o){var b=h&&typeof h.as=="string"?h.as:"script",S='link[rel="modulepreload"][as="'+da(b)+'"][href="'+da(o)+'"]',E=S;switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":E=Ed(o)}if(!zi.has(E)&&(o=g({rel:"modulepreload",href:o},h),zi.set(E,o),f.querySelector(S)===null)){switch(b){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(gp(E)))return}b=f.createElement("link"),as(b,"link",o),jr(b),f.head.appendChild(b)}}}function LB(o,h,f){Sl.S(o,h,f);var b=Td;if(b&&o){var S=rn(b).hoistableStyles,E=Cd(o);h=h||"default";var q=S.get(E);if(!q){var ae={loading:0,preload:null};if(q=b.querySelector(pp(E)))ae.loading=5;else{o=g({rel:"stylesheet",href:o,"data-precedence":h},f),(f=zi.get(E))&&Qx(o,f);var Ce=q=b.createElement("link");jr(Ce),as(Ce,"link",o),Ce._p=new Promise(function(et,pt){Ce.onload=et,Ce.onerror=pt}),Ce.addEventListener("load",function(){ae.loading|=1}),Ce.addEventListener("error",function(){ae.loading|=2}),ae.loading|=4,um(q,h,b)}q={type:"stylesheet",instance:q,count:1,state:ae},S.set(E,q)}}}function MB(o,h){Sl.X(o,h);var f=Td;if(f&&o){var b=rn(f).hoistableScripts,S=Ed(o),E=b.get(S);E||(E=f.querySelector(gp(S)),E||(o=g({src:o,async:!0},h),(h=zi.get(S))&&Kx(o,h),E=f.createElement("script"),jr(E),as(E,"link",o),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},b.set(S,E))}}function OB(o,h){Sl.M(o,h);var f=Td;if(f&&o){var b=rn(f).hoistableScripts,S=Ed(o),E=b.get(S);E||(E=f.querySelector(gp(S)),E||(o=g({src:o,async:!0,type:"module"},h),(h=zi.get(S))&&Kx(o,h),E=f.createElement("script"),jr(E),as(E,"link",o),f.head.appendChild(E)),E={type:"script",instance:E,count:1,state:null},b.set(S,E))}}function z2(o,h,f,b){var S=(S=Ae.current)?cm(S):null;if(!S)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(h=Cd(f.href),f=rn(S).hoistableStyles,b=f.get(h),b||(b={type:"style",instance:null,count:0,state:null},f.set(h,b)),b):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=Cd(f.href);var E=rn(S).hoistableStyles,q=E.get(o);if(q||(S=S.ownerDocument||S,q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},E.set(o,q),(E=S.querySelector(pp(o)))&&!E._p&&(q.instance=E,q.state.loading=5),zi.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},zi.set(o,f),E||jB(S,o,f,q.state))),h&&b===null)throw Error(n(528,""));return q}if(h&&b!==null)throw Error(n(529,""));return null;case"script":return h=f.async,f=f.src,typeof f=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(h=Ed(f),f=rn(S).hoistableScripts,b=f.get(h),b||(b={type:"script",instance:null,count:0,state:null},f.set(h,b)),b):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function Cd(o){return'href="'+da(o)+'"'}function pp(o){return'link[rel="stylesheet"]['+o+"]"}function $2(o){return g({},o,{"data-precedence":o.precedence,precedence:null})}function jB(o,h,f,b){o.querySelector('link[rel="preload"][as="style"]['+h+"]")?b.loading=1:(h=o.createElement("link"),b.preload=h,h.addEventListener("load",function(){return b.loading|=1}),h.addEventListener("error",function(){return b.loading|=2}),as(h,"link",f),jr(h),o.head.appendChild(h))}function Ed(o){return'[src="'+da(o)+'"]'}function gp(o){return"script[async]"+o}function U2(o,h,f){if(h.count++,h.instance===null)switch(h.type){case"style":var b=o.querySelector('style[data-href~="'+da(f.href)+'"]');if(b)return h.instance=b,jr(b),b;var S=g({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return b=(o.ownerDocument||o).createElement("style"),jr(b),as(b,"style",S),um(b,f.precedence,o),h.instance=b;case"stylesheet":S=Cd(f.href);var E=o.querySelector(pp(S));if(E)return h.state.loading|=4,h.instance=E,jr(E),E;b=$2(f),(S=zi.get(S))&&Qx(b,S),E=(o.ownerDocument||o).createElement("link"),jr(E);var q=E;return q._p=new Promise(function(ae,Ce){q.onload=ae,q.onerror=Ce}),as(E,"link",b),h.state.loading|=4,um(E,f.precedence,o),h.instance=E;case"script":return E=Ed(f.src),(S=o.querySelector(gp(E)))?(h.instance=S,jr(S),S):(b=f,(S=zi.get(E))&&(b=g({},f),Kx(b,S)),o=o.ownerDocument||o,S=o.createElement("script"),jr(S),as(S,"link",b),o.head.appendChild(S),h.instance=S);case"void":return null;default:throw Error(n(443,h.type))}else h.type==="stylesheet"&&(h.state.loading&4)===0&&(b=h.instance,h.state.loading|=4,um(b,f.precedence,o));return h.instance}function um(o,h,f){for(var b=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=b.length?b[b.length-1]:null,E=S,q=0;q<b.length;q++){var ae=b[q];if(ae.dataset.precedence===h)E=ae;else if(E!==S)break}E?E.parentNode.insertBefore(o,E.nextSibling):(h=f.nodeType===9?f.head:f,h.insertBefore(o,h.firstChild))}function Qx(o,h){o.crossOrigin==null&&(o.crossOrigin=h.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=h.referrerPolicy),o.title==null&&(o.title=h.title)}function Kx(o,h){o.crossOrigin==null&&(o.crossOrigin=h.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=h.referrerPolicy),o.integrity==null&&(o.integrity=h.integrity)}var dm=null;function q2(o,h,f){if(dm===null){var b=new Map,S=dm=new Map;S.set(f,b)}else S=dm,b=S.get(f),b||(b=new Map,S.set(f,b));if(b.has(o))return b;for(b.set(o,null),f=f.getElementsByTagName(o),S=0;S<f.length;S++){var E=f[S];if(!(E[rr]||E[an]||o==="link"&&E.getAttribute("rel")==="stylesheet")&&E.namespaceURI!=="http://www.w3.org/2000/svg"){var q=E.getAttribute(h)||"";q=o+q;var ae=b.get(q);ae?ae.push(E):b.set(q,[E])}}return b}function H2(o,h,f){o=o.ownerDocument||o,o.head.insertBefore(f,h==="title"?o.querySelector("head > title"):null)}function BB(o,h,f){if(f===1||h.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href==="")break;return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError)break;switch(h.rel){case"stylesheet":return o=h.disabled,typeof h.precedence=="string"&&o==null;default:return!0}case"script":if(h.async&&typeof h.async!="function"&&typeof h.async!="symbol"&&!h.onLoad&&!h.onError&&h.src&&typeof h.src=="string")return!0}return!1}function G2(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function FB(o,h,f,b){if(f.type==="stylesheet"&&(typeof b.media!="string"||matchMedia(b.media).matches!==!1)&&(f.state.loading&4)===0){if(f.instance===null){var S=Cd(b.href),E=h.querySelector(pp(S));if(E){h=E._p,h!==null&&typeof h=="object"&&typeof h.then=="function"&&(o.count++,o=hm.bind(o),h.then(o,o)),f.state.loading|=4,f.instance=E,jr(E);return}E=h.ownerDocument||h,b=$2(b),(S=zi.get(S))&&Qx(b,S),E=E.createElement("link"),jr(E);var q=E;q._p=new Promise(function(ae,Ce){q.onload=ae,q.onerror=Ce}),as(E,"link",b),f.instance=E}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(f,h),(h=f.state.preload)&&(f.state.loading&3)===0&&(o.count++,f=hm.bind(o),h.addEventListener("load",f),h.addEventListener("error",f))}}var Xx=0;function zB(o,h){return o.stylesheets&&o.count===0&&gm(o,o.stylesheets),0<o.count||0<o.imgCount?function(f){var b=setTimeout(function(){if(o.stylesheets&&gm(o,o.stylesheets),o.unsuspend){var E=o.unsuspend;o.unsuspend=null,E()}},6e4+h);0<o.imgBytes&&Xx===0&&(Xx=62500*vB());var S=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&gm(o,o.stylesheets),o.unsuspend)){var E=o.unsuspend;o.unsuspend=null,E()}},(o.imgBytes>Xx?50:800)+h);return o.unsuspend=f,function(){o.unsuspend=null,clearTimeout(b),clearTimeout(S)}}:null}function hm(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)gm(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var pm=null;function gm(o,h){o.stylesheets=null,o.unsuspend!==null&&(o.count++,pm=new Map,h.forEach($B,o),pm=null,hm.call(o))}function $B(o,h){if(!(h.state.loading&4)){var f=pm.get(o);if(f)var b=f.get(null);else{f=new Map,pm.set(o,f);for(var S=o.querySelectorAll("link[data-precedence],style[data-precedence]"),E=0;E<S.length;E++){var q=S[E];(q.nodeName==="LINK"||q.getAttribute("media")!=="not all")&&(f.set(q.dataset.precedence,q),b=q)}b&&f.set(null,b)}S=h.instance,q=S.getAttribute("data-precedence"),E=f.get(q)||b,E===b&&f.set(null,S),f.set(q,S),this.count++,b=hm.bind(this),S.addEventListener("load",b),S.addEventListener("error",b),E?E.parentNode.insertBefore(S,E.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(S,o.firstChild)),h.state.loading|=4}}var fp={$$typeof:P,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function UB(o,h,f,b,S,E,q,ae,Ce){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Kr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kr(0),this.hiddenUpdates=Kr(null),this.identifierPrefix=b,this.onUncaughtError=S,this.onCaughtError=E,this.onRecoverableError=q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ce,this.incompleteTransitions=new Map}function V2(o,h,f,b,S,E,q,ae,Ce,et,pt,xt){return o=new UB(o,h,f,q,Ce,et,pt,xt,ae),h=1,E===!0&&(h|=24),E=ga(3,null,null,h),o.current=E,E.stateNode=o,h=Pb(),h.refCount++,o.pooledCache=h,h.refCount++,E.memoizedState={element:b,isDehydrated:f,cache:h},Lb(E),o}function W2(o){return o?(o=Jr,o):Jr}function Y2(o,h,f,b,S,E){S=W2(S),b.context===null?b.context=S:b.pendingContext=S,b=rc(h),b.payload={element:f},E=E===void 0?null:E,E!==null&&(b.callback=E),f=nc(o,b,h),f!==null&&(Xs(f,o,h),Wh(f,o,h))}function Q2(o,h){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<h?f:h}}function Jx(o,h){Q2(o,h),(o=o.alternate)&&Q2(o,h)}function K2(o){if(o.tag===13||o.tag===31){var h=Tr(o,67108864);h!==null&&Xs(h,o,67108864),Jx(o,67108864)}}function X2(o){if(o.tag===13||o.tag===31){var h=ki();h=Hr(h);var f=Tr(o,h);f!==null&&Xs(f,o,h),Jx(o,h)}}var fm=!0;function qB(o,h,f,b){var S=H.T;H.T=null;var E=re.p;try{re.p=2,Zx(o,h,f,b)}finally{re.p=E,H.T=S}}function HB(o,h,f,b){var S=H.T;H.T=null;var E=re.p;try{re.p=8,Zx(o,h,f,b)}finally{re.p=E,H.T=S}}function Zx(o,h,f,b){if(fm){var S=ev(b);if(S===null)Fx(o,h,b,mm,f),Z2(o,b);else if(VB(S,o,h,f,b))b.stopPropagation();else if(Z2(o,b),h&4&&-1<GB.indexOf(o)){for(;S!==null;){var E=Mt(S);if(E!==null)switch(E.tag){case 3:if(E=E.stateNode,E.current.memoizedState.isDehydrated){var q=qn(E.pendingLanes);if(q!==0){var ae=E;for(ae.pendingLanes|=2,ae.entangledLanes|=2;q;){var Ce=1<<31-vt(q);ae.entanglements[1]|=Ce,q&=~Ce}Do(E),(_n&6)===0&&(Jf=kt()+500,cp(0))}}break;case 31:case 13:ae=Tr(E,2),ae!==null&&Xs(ae,E,2),em(),Jx(E,2)}if(E=ev(b),E===null&&Fx(o,h,b,mm,f),E===S)break;S=E}S!==null&&b.stopPropagation()}else Fx(o,h,b,null,f)}}function ev(o){return o=Pr(o),tv(o)}var mm=null;function tv(o){if(mm=null,o=bt(o),o!==null){var h=s(o);if(h===null)o=null;else{var f=h.tag;if(f===13){if(o=i(h),o!==null)return o;o=null}else if(f===31){if(o=l(h),o!==null)return o;o=null}else if(f===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;o=null}else h!==o&&(o=null)}}return mm=o,null}function J2(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(fr()){case qe:return 2;case st:return 8;case Gt:case Kt:return 32;case lr:return 268435456;default:return 32}default:return 32}}var rv=!1,gc=null,fc=null,mc=null,mp=new Map,yp=new Map,yc=[],GB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Z2(o,h){switch(o){case"focusin":case"focusout":gc=null;break;case"dragenter":case"dragleave":fc=null;break;case"mouseover":case"mouseout":mc=null;break;case"pointerover":case"pointerout":mp.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":yp.delete(h.pointerId)}}function bp(o,h,f,b,S,E){return o===null||o.nativeEvent!==E?(o={blockedOn:h,domEventName:f,eventSystemFlags:b,nativeEvent:E,targetContainers:[S]},h!==null&&(h=Mt(h),h!==null&&K2(h)),o):(o.eventSystemFlags|=b,h=o.targetContainers,S!==null&&h.indexOf(S)===-1&&h.push(S),o)}function VB(o,h,f,b,S){switch(h){case"focusin":return gc=bp(gc,o,h,f,b,S),!0;case"dragenter":return fc=bp(fc,o,h,f,b,S),!0;case"mouseover":return mc=bp(mc,o,h,f,b,S),!0;case"pointerover":var E=S.pointerId;return mp.set(E,bp(mp.get(E)||null,o,h,f,b,S)),!0;case"gotpointercapture":return E=S.pointerId,yp.set(E,bp(yp.get(E)||null,o,h,f,b,S)),!0}return!1}function eE(o){var h=bt(o.target);if(h!==null){var f=s(h);if(f!==null){if(h=f.tag,h===13){if(h=i(f),h!==null){o.blockedOn=h,Za(o.priority,function(){X2(f)});return}}else if(h===31){if(h=l(f),h!==null){o.blockedOn=h,Za(o.priority,function(){X2(f)});return}}else if(h===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function ym(o){if(o.blockedOn!==null)return!1;for(var h=o.targetContainers;0<h.length;){var f=ev(o.nativeEvent);if(f===null){f=o.nativeEvent;var b=new f.constructor(f.type,f);ar=b,f.target.dispatchEvent(b),ar=null}else return h=Mt(f),h!==null&&K2(h),o.blockedOn=f,!1;h.shift()}return!0}function tE(o,h,f){ym(o)&&f.delete(h)}function WB(){rv=!1,gc!==null&&ym(gc)&&(gc=null),fc!==null&&ym(fc)&&(fc=null),mc!==null&&ym(mc)&&(mc=null),mp.forEach(tE),yp.forEach(tE)}function bm(o,h){o.blockedOn===h&&(o.blockedOn=null,rv||(rv=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,WB)))}var xm=null;function rE(o){xm!==o&&(xm=o,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){xm===o&&(xm=null);for(var h=0;h<o.length;h+=3){var f=o[h],b=o[h+1],S=o[h+2];if(typeof b!="function"){if(tv(b||f)===null)continue;break}var E=Mt(f);E!==null&&(o.splice(h,3),h-=3,ex(E,{pending:!0,data:S,method:f.method,action:b},b,S))}}))}function _d(o){function h(Ce){return bm(Ce,o)}gc!==null&&bm(gc,o),fc!==null&&bm(fc,o),mc!==null&&bm(mc,o),mp.forEach(h),yp.forEach(h);for(var f=0;f<yc.length;f++){var b=yc[f];b.blockedOn===o&&(b.blockedOn=null)}for(;0<yc.length&&(f=yc[0],f.blockedOn===null);)eE(f),f.blockedOn===null&&yc.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(b=0;b<f.length;b+=3){var S=f[b],E=f[b+1],q=S[tn]||null;if(typeof E=="function")q||rE(f);else if(q){var ae=null;if(E&&E.hasAttribute("formAction")){if(S=E,q=E[tn]||null)ae=q.formAction;else if(tv(S)!==null)continue}else ae=q.action;typeof ae=="function"?f[b+1]=ae:(f.splice(b,3),b-=3),rE(f)}}}function nE(){function o(E){E.canIntercept&&E.info==="react-transition"&&E.intercept({handler:function(){return new Promise(function(q){return S=q})},focusReset:"manual",scroll:"manual"})}function h(){S!==null&&(S(),S=null),b||setTimeout(f,20)}function f(){if(!b&&!navigation.transition){var E=navigation.currentEntry;E&&E.url!=null&&navigation.navigate(E.url,{state:E.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var b=!1,S=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",h),navigation.addEventListener("navigateerror",h),setTimeout(f,100),function(){b=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",h),navigation.removeEventListener("navigateerror",h),S!==null&&(S(),S=null)}}}function nv(o){this._internalRoot=o}vm.prototype.render=nv.prototype.render=function(o){var h=this._internalRoot;if(h===null)throw Error(n(409));var f=h.current,b=ki();Y2(f,b,o,h,null,null)},vm.prototype.unmount=nv.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var h=o.containerInfo;Y2(o.current,2,null,o,null,null),em(),h[ca]=null}};function vm(o){this._internalRoot=o}vm.prototype.unstable_scheduleHydration=function(o){if(o){var h=Ba();o={blockedOn:null,target:o,priority:h};for(var f=0;f<yc.length&&h!==0&&h<yc[f].priority;f++);yc.splice(f,0,o),f===0&&eE(o)}};var aE=e.version;if(aE!=="19.2.0")throw Error(n(527,aE,"19.2.0"));re.findDOMNode=function(o){var h=o._reactInternals;if(h===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=d(h),o=o!==null?p(o):null,o=o===null?null:o.stateNode,o};var YB={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:H,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wm.isDisabled&&wm.supportsFiber)try{ur=wm.inject(YB),_t=wm}catch{}}return vp.createRoot=function(o,h){if(!a(o))throw Error(n(299));var f=!1,b="",S=dC,E=hC,q=pC;return h!=null&&(h.unstable_strictMode===!0&&(f=!0),h.identifierPrefix!==void 0&&(b=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(E=h.onCaughtError),h.onRecoverableError!==void 0&&(q=h.onRecoverableError)),h=V2(o,1,!1,null,null,f,b,null,S,E,q,nE),o[ca]=h.current,Bx(o),new nv(h)},vp.hydrateRoot=function(o,h,f){if(!a(o))throw Error(n(299));var b=!1,S="",E=dC,q=hC,ae=pC,Ce=null;return f!=null&&(f.unstable_strictMode===!0&&(b=!0),f.identifierPrefix!==void 0&&(S=f.identifierPrefix),f.onUncaughtError!==void 0&&(E=f.onUncaughtError),f.onCaughtError!==void 0&&(q=f.onCaughtError),f.onRecoverableError!==void 0&&(ae=f.onRecoverableError),f.formState!==void 0&&(Ce=f.formState)),h=V2(o,1,!0,h,f??null,b,S,Ce,E,q,ae,nE),h.context=W2(null),f=h.current,b=ki(),b=Hr(b),S=rc(b),S.callback=null,nc(f,S,b),f=b,h.current.lanes=f,Xr(h,f),Do(h),o[ca]=h.current,Bx(o),new vm(h)},vp.version="19.2.0",vp}var gE;function aF(){if(gE)return sv.exports;gE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),sv.exports=nF(),sv.exports}var sF=aF();const Fr=t=>typeof t=="string",wp=()=>{let t,e;const r=new Promise((n,a)=>{t=n,e=a});return r.resolve=t,r.reject=e,r},fE=t=>t==null?"":""+t,iF=(t,e,r)=>{t.forEach(n=>{e[n]&&(r[n]=e[n])})},oF=/###/g,mE=t=>t&&t.indexOf("###")>-1?t.replace(oF,"."):t,yE=t=>!t||Fr(t),og=(t,e,r)=>{const n=Fr(e)?e.split("."):e;let a=0;for(;a<n.length-1;){if(yE(t))return{};const s=mE(n[a]);!t[s]&&r&&(t[s]=new r),Object.prototype.hasOwnProperty.call(t,s)?t=t[s]:t={},++a}return yE(t)?{}:{obj:t,k:mE(n[a])}},bE=(t,e,r)=>{const{obj:n,k:a}=og(t,e,Object);if(n!==void 0||e.length===1){n[a]=r;return}let s=e[e.length-1],i=e.slice(0,e.length-1),l=og(t,i,Object);for(;l.obj===void 0&&i.length;)s=`${i[i.length-1]}.${s}`,i=i.slice(0,i.length-1),l=og(t,i,Object),l?.obj&&typeof l.obj[`${l.k}.${s}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${s}`]=r},lF=(t,e,r,n)=>{const{obj:a,k:s}=og(t,e,Object);a[s]=a[s]||[],a[s].push(r)},C0=(t,e)=>{const{obj:r,k:n}=og(t,e);if(r&&Object.prototype.hasOwnProperty.call(r,n))return r[n]},cF=(t,e,r)=>{const n=C0(t,r);return n!==void 0?n:C0(e,r)},rP=(t,e,r)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in t?Fr(t[n])||t[n]instanceof String||Fr(e[n])||e[n]instanceof String?r&&(t[n]=e[n]):rP(t[n],e[n],r):t[n]=e[n]);return t},Ad=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var uF={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const dF=t=>Fr(t)?t.replace(/[&<>"'\/]/g,e=>uF[e]):t;class hF{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const r=this.regExpMap.get(e);if(r!==void 0)return r;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const pF=[" ",",","?","!",";"],gF=new hF(20),fF=(t,e,r)=>{e=e||"",r=r||"";const n=pF.filter(i=>e.indexOf(i)<0&&r.indexOf(i)<0);if(n.length===0)return!0;const a=gF.getRegExp(`(${n.map(i=>i==="?"?"\\?":i).join("|")})`);let s=!a.test(t);if(!s){const i=t.indexOf(r);i>0&&!a.test(t.substring(0,i))&&(s=!0)}return s},kw=(t,e,r=".")=>{if(!t)return;if(t[e])return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0;const n=e.split(r);let a=t;for(let s=0;s<n.length;){if(!a||typeof a!="object")return;let i,l="";for(let c=s;c<n.length;++c)if(c!==s&&(l+=r),l+=n[c],i=a[l],i!==void 0){if(["string","number","boolean"].indexOf(typeof i)>-1&&c<n.length-1)continue;s+=c-s+1;break}a=i}return a},Eg=t=>t?.replace("_","-"),mF={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){console?.[t]?.apply?.(console,e)}};class E0{constructor(e,r={}){this.init(e,r)}init(e,r={}){this.prefix=r.prefix||"i18next:",this.logger=e||mF,this.options=r,this.debug=r.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,r,n,a){return a&&!this.debug?null:(Fr(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[r](e))}create(e){return new E0(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new E0(this.logger,e)}}var Wo=new E0;class Ny{constructor(){this.observers={}}on(e,r){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const a=this.observers[n].get(r)||0;this.observers[n].set(r,a+1)}),this}off(e,r){if(this.observers[e]){if(!r){delete this.observers[e];return}this.observers[e].delete(r)}}emit(e,...r){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([a,s])=>{for(let i=0;i<s;i++)a(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([a,s])=>{for(let i=0;i<s;i++)a.apply(a,[e,...r])})}}class xE extends Ny{constructor(e,r={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const r=this.options.ns.indexOf(e);r>-1&&this.options.ns.splice(r,1)}getResource(e,r,n,a={}){const s=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,i=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,r],n&&(Array.isArray(n)?l.push(...n):Fr(n)&&s?l.push(...n.split(s)):l.push(n)));const c=C0(this.data,l);return!c&&!r&&!n&&e.indexOf(".")>-1&&(e=l[0],r=l[1],n=l.slice(2).join(".")),c||!i||!Fr(n)?c:kw(this.data?.[e]?.[r],n,s)}addResource(e,r,n,a,s={silent:!1}){const i=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let l=[e,r];n&&(l=l.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(l=e.split("."),a=r,r=l[1]),this.addNamespaces(r),bE(this.data,l,a),s.silent||this.emit("added",e,r,n,a)}addResources(e,r,n,a={silent:!1}){for(const s in n)(Fr(n[s])||Array.isArray(n[s]))&&this.addResource(e,r,s,n[s],{silent:!0});a.silent||this.emit("added",e,r,n)}addResourceBundle(e,r,n,a,s,i={silent:!1,skipCopy:!1}){let l=[e,r];e.indexOf(".")>-1&&(l=e.split("."),a=n,n=r,r=l[1]),this.addNamespaces(r);let c=C0(this.data,l)||{};i.skipCopy||(n=JSON.parse(JSON.stringify(n))),a?rP(c,n,s):c={...c,...n},bE(this.data,l,c),i.silent||this.emit("added",e,r,n)}removeResourceBundle(e,r){this.hasResourceBundle(e,r)&&delete this.data[e][r],this.removeNamespaces(r),this.emit("removed",e,r)}hasResourceBundle(e,r){return this.getResource(e,r)!==void 0}getResourceBundle(e,r){return r||(r=this.options.defaultNS),this.getResource(e,r)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const r=this.getDataByLanguage(e);return!!(r&&Object.keys(r)||[]).find(a=>r[a]&&Object.keys(r[a]).length>0)}toJSON(){return this.data}}var nP={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,r,n,a){return t.forEach(s=>{e=this.processors[s]?.process(e,r,n,a)??e}),e}};const aP=Symbol("i18next/PATH_KEY");function yF(){const t=[],e=Object.create(null);let r;return e.get=(n,a)=>(r?.revoke?.(),a===aP?t:(t.push(a),r=Proxy.revocable(n,e),r.proxy)),Proxy.revocable(Object.create(null),e).proxy}function Tw(t,e){const{[aP]:r}=t(yF());return r.join(e?.keySeparator??".")}const vE={},uv=t=>!Fr(t)&&typeof t!="boolean"&&typeof t!="number";class _0 extends Ny{constructor(e,r={}){super(),iF(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Wo.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,r={interpolation:{}}){const n={...r};if(e==null)return!1;const a=this.resolve(e,n);if(a?.res===void 0)return!1;const s=uv(a.res);return!(n.returnObjects===!1&&s)}extractFromKey(e,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let s=r.ns||this.options.defaultNS||[];const i=n&&e.indexOf(n)>-1,l=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!fF(e,n,a);if(i&&!l){const c=e.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:e,namespaces:Fr(s)?[s]:s};const d=e.split(n);(n!==a||n===a&&this.options.ns.indexOf(d[0])>-1)&&(s=d.shift()),e=d.join(a)}return{key:e,namespaces:Fr(s)?[s]:s}}translate(e,r,n){let a=typeof r=="object"?{...r}:r;if(typeof a!="object"&&this.options.overloadTranslationOptionHandler&&(a=this.options.overloadTranslationOptionHandler(arguments)),typeof a=="object"&&(a={...a}),a||(a={}),e==null)return"";typeof e=="function"&&(e=Tw(e,{...this.options,...a})),Array.isArray(e)||(e=[String(e)]);const s=a.returnDetails!==void 0?a.returnDetails:this.options.returnDetails,i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,{key:l,namespaces:c}=this.extractFromKey(e[e.length-1],a),d=c[c.length-1];let p=a.nsSeparator!==void 0?a.nsSeparator:this.options.nsSeparator;p===void 0&&(p=":");const g=a.lng||this.language,m=a.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(g?.toLowerCase()==="cimode")return m?s?{res:`${d}${p}${l}`,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:`${d}${p}${l}`:s?{res:l,usedKey:l,exactUsedKey:l,usedLng:g,usedNS:d,usedParams:this.getUsedParamsDetails(a)}:l;const y=this.resolve(e,a);let x=y?.res;const w=y?.usedKey||l,T=y?.exactUsedKey||l,k=["[object Number]","[object Function]","[object RegExp]"],_=a.joinArrays!==void 0?a.joinArrays:this.options.joinArrays,P=!this.i18nFormat||this.i18nFormat.handleAsObject,F=a.count!==void 0&&!Fr(a.count),D=_0.hasDefaultValue(a),B=F?this.pluralResolver.getSuffix(g,a.count,a):"",M=a.ordinal&&F?this.pluralResolver.getSuffix(g,a.count,{ordinal:!1}):"",$=F&&!a.ordinal&&a.count===0,Z=$&&a[`defaultValue${this.options.pluralSeparator}zero`]||a[`defaultValue${B}`]||a[`defaultValue${M}`]||a.defaultValue;let z=x;P&&!x&&D&&(z=Z);const ee=uv(z),te=Object.prototype.toString.apply(z);if(P&&z&&ee&&k.indexOf(te)<0&&!(Fr(_)&&Array.isArray(z))){if(!a.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const X=this.options.returnedObjectHandler?this.options.returnedObjectHandler(w,z,{...a,ns:c}):`key '${l} (${this.language})' returned an object instead of string.`;return s?(y.res=X,y.usedParams=this.getUsedParamsDetails(a),y):X}if(i){const X=Array.isArray(z),Q=X?[]:{},W=X?T:w;for(const H in z)if(Object.prototype.hasOwnProperty.call(z,H)){const re=`${W}${i}${H}`;D&&!x?Q[H]=this.translate(re,{...a,defaultValue:uv(Z)?Z[H]:void 0,joinArrays:!1,ns:c}):Q[H]=this.translate(re,{...a,joinArrays:!1,ns:c}),Q[H]===re&&(Q[H]=z[H])}x=Q}}else if(P&&Fr(_)&&Array.isArray(x))x=x.join(_),x&&(x=this.extendTranslation(x,e,a,n));else{let X=!1,Q=!1;!this.isValidLookup(x)&&D&&(X=!0,x=Z),this.isValidLookup(x)||(Q=!0,x=l);const H=(a.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&Q?void 0:x,re=D&&Z!==x&&this.options.updateMissing;if(Q||X||re){if(this.logger.log(re?"updateKey":"missingKey",g,d,l,re?Z:x),i){const I=this.resolve(l,{...a,keySeparator:!1});I&&I.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ne=[];const ve=this.languageUtils.getFallbackCodes(this.options.fallbackLng,a.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ve&&ve[0])for(let I=0;I<ve.length;I++)ne.push(ve[I]);else this.options.saveMissingTo==="all"?ne=this.languageUtils.toResolveHierarchy(a.lng||this.language):ne.push(a.lng||this.language);const O=(I,K,U)=>{const ce=D&&U!==x?U:H;this.options.missingKeyHandler?this.options.missingKeyHandler(I,d,K,ce,re,a):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(I,d,K,ce,re,a),this.emit("missingKey",I,d,K,x)};this.options.saveMissing&&(this.options.saveMissingPlurals&&F?ne.forEach(I=>{const K=this.pluralResolver.getSuffixes(I,a);$&&a[`defaultValue${this.options.pluralSeparator}zero`]&&K.indexOf(`${this.options.pluralSeparator}zero`)<0&&K.push(`${this.options.pluralSeparator}zero`),K.forEach(U=>{O([I],l+U,a[`defaultValue${U}`]||Z)})}):O(ne,l,Z))}x=this.extendTranslation(x,e,a,y,n),Q&&x===l&&this.options.appendNamespaceToMissingKey&&(x=`${d}${p}${l}`),(Q||X)&&this.options.parseMissingKeyHandler&&(x=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${d}${p}${l}`:l,X?x:void 0,a))}return s?(y.res=x,y.usedParams=this.getUsedParamsDetails(a),y):x}extendTranslation(e,r,n,a,s){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const c=Fr(e)&&(n?.interpolation?.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(c){const g=e.match(this.interpolator.nestingRegexp);d=g&&g.length}let p=n.replace&&!Fr(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),e=this.interpolator.interpolate(e,p,n.lng||this.language||a.usedLng,n),c){const g=e.match(this.interpolator.nestingRegexp),m=g&&g.length;d<m&&(n.nest=!1)}!n.lng&&a&&a.res&&(n.lng=this.language||a.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,(...g)=>s?.[0]===g[0]&&!n.context?(this.logger.warn(`It seems you are nesting recursively key: ${g[0]} in key: ${r[0]}`),null):this.translate(...g,r),n)),n.interpolation&&this.interpolator.reset()}const i=n.postProcess||this.options.postProcess,l=Fr(i)?[i]:i;return e!=null&&l?.length&&n.applyPostProcessor!==!1&&(e=nP.handle(l,e,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e,r={}){let n,a,s,i,l;return Fr(e)&&(e=[e]),e.forEach(c=>{if(this.isValidLookup(n))return;const d=this.extractFromKey(c,r),p=d.key;a=p;let g=d.namespaces;this.options.fallbackNS&&(g=g.concat(this.options.fallbackNS));const m=r.count!==void 0&&!Fr(r.count),y=m&&!r.ordinal&&r.count===0,x=r.context!==void 0&&(Fr(r.context)||typeof r.context=="number")&&r.context!=="",w=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);g.forEach(T=>{this.isValidLookup(n)||(l=T,!vE[`${w[0]}-${T}`]&&this.utils?.hasLoadedNamespace&&!this.utils?.hasLoadedNamespace(l)&&(vE[`${w[0]}-${T}`]=!0,this.logger.warn(`key "${a}" for languages "${w.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),w.forEach(k=>{if(this.isValidLookup(n))return;i=k;const _=[p];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(_,p,k,T,r);else{let F;m&&(F=this.pluralResolver.getSuffix(k,r.count,r));const D=`${this.options.pluralSeparator}zero`,B=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(m&&(r.ordinal&&F.indexOf(B)===0&&_.push(p+F.replace(B,this.options.pluralSeparator)),_.push(p+F),y&&_.push(p+D)),x){const M=`${p}${this.options.contextSeparator||"_"}${r.context}`;_.push(M),m&&(r.ordinal&&F.indexOf(B)===0&&_.push(M+F.replace(B,this.options.pluralSeparator)),_.push(M+F),y&&_.push(M+D))}}let P;for(;P=_.pop();)this.isValidLookup(n)||(s=P,n=this.getResource(k,T,P,r))}))})}),{res:n,usedKey:a,exactUsedKey:s,usedLng:i,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,r,n,a={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,r,n,a):this.resourceStore.getResource(e,r,n,a)}getUsedParamsDetails(e={}){const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!Fr(e.replace);let a=n?e.replace:e;if(n&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!n){a={...a};for(const s of r)delete a[s]}return a}static hasDefaultValue(e){const r="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&r===n.substring(0,r.length)&&e[n]!==void 0)return!0;return!1}}class wE{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Wo.create("languageUtils")}getScriptPartFromCode(e){if(e=Eg(e),!e||e.indexOf("-")<0)return null;const r=e.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(e){if(e=Eg(e),!e||e.indexOf("-")<0)return e;const r=e.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(e){if(Fr(e)&&e.indexOf("-")>-1){let r;try{r=Intl.getCanonicalLocales(e)[0]}catch{}return r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let r;return e.forEach(n=>{if(r)return;const a=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(a))&&(r=a)}),!r&&this.options.supportedLngs&&e.forEach(n=>{if(r)return;const a=this.getScriptPartFromCode(n);if(this.isSupportedCode(a))return r=a;const s=this.getLanguagePartFromCode(n);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(i=>{if(i===s)return i;if(!(i.indexOf("-")<0&&s.indexOf("-")<0)&&(i.indexOf("-")>0&&s.indexOf("-")<0&&i.substring(0,i.indexOf("-"))===s||i.indexOf(s)===0&&s.length>1))return i})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(e,r){if(!e)return[];if(typeof e=="function"&&(e=e(r)),Fr(e)&&(e=[e]),Array.isArray(e))return e;if(!r)return e.default||[];let n=e[r];return n||(n=e[this.getScriptPartFromCode(r)]),n||(n=e[this.formatLanguageCode(r)]),n||(n=e[this.getLanguagePartFromCode(r)]),n||(n=e.default),n||[]}toResolveHierarchy(e,r){const n=this.getFallbackCodes((r===!1?[]:r)||this.options.fallbackLng||[],e),a=[],s=i=>{i&&(this.isSupportedCode(i)?a.push(i):this.logger.warn(`rejecting language code not found in supportedLngs: ${i}`))};return Fr(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):Fr(e)&&s(this.formatLanguageCode(e)),n.forEach(i=>{a.indexOf(i)<0&&s(this.formatLanguageCode(i))}),a}}const SE={zero:0,one:1,two:2,few:3,many:4,other:5},kE={select:t=>t===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class bF{constructor(e,r={}){this.languageUtils=e,this.options=r,this.logger=Wo.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,r){this.rules[e]=r}clearCache(){this.pluralRulesCache={}}getRule(e,r={}){const n=Eg(e==="dev"?"en":e),a=r.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:n,type:a});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let i;try{i=new Intl.PluralRules(n,{type:a})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),kE;if(!e.match(/-|_/))return kE;const c=this.languageUtils.getLanguagePartFromCode(e);i=this.getRule(c,r)}return this.pluralRulesCache[s]=i,i}needsPlural(e,r={}){let n=this.getRule(e,r);return n||(n=this.getRule("dev",r)),n?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,r,n={}){return this.getSuffixes(e,n).map(a=>`${r}${a}`)}getSuffixes(e,r={}){let n=this.getRule(e,r);return n||(n=this.getRule("dev",r)),n?n.resolvedOptions().pluralCategories.sort((a,s)=>SE[a]-SE[s]).map(a=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${a}`):[]}getSuffix(e,r,n={}){const a=this.getRule(e,n);return a?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${a.select(r)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",r,n))}}const TE=(t,e,r,n=".",a=!0)=>{let s=cF(t,e,r);return!s&&a&&Fr(r)&&(s=kw(t,r,n),s===void 0&&(s=kw(e,r,n))),s},dv=t=>t.replace(/\$/g,"$$$$");class xF{constructor(e={}){this.logger=Wo.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(r=>r),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:a,prefix:s,prefixEscaped:i,suffix:l,suffixEscaped:c,formatSeparator:d,unescapeSuffix:p,unescapePrefix:g,nestingPrefix:m,nestingPrefixEscaped:y,nestingSuffix:x,nestingSuffixEscaped:w,nestingOptionsSeparator:T,maxReplaces:k,alwaysFormat:_}=e.interpolation;this.escape=r!==void 0?r:dF,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=s?Ad(s):i||"{{",this.suffix=l?Ad(l):c||"}}",this.formatSeparator=d||",",this.unescapePrefix=p?"":g||"-",this.unescapeSuffix=this.unescapePrefix?"":p||"",this.nestingPrefix=m?Ad(m):y||Ad("$t("),this.nestingSuffix=x?Ad(x):w||Ad(")"),this.nestingOptionsSeparator=T||",",this.maxReplaces=k||1e3,this.alwaysFormat=_!==void 0?_:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(r,n)=>r?.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}((?:[^()"']+|"[^"]*"|'[^']*'|\\((?:[^()]|"[^"]*"|'[^']*')*\\))*?)${this.nestingSuffix}`)}interpolate(e,r,n,a){let s,i,l;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=y=>{if(y.indexOf(this.formatSeparator)<0){const k=TE(r,c,y,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,n,{...a,...r,interpolationkey:y}):k}const x=y.split(this.formatSeparator),w=x.shift().trim(),T=x.join(this.formatSeparator).trim();return this.format(TE(r,c,w,this.options.keySeparator,this.options.ignoreJSONStructure),T,n,{...a,...r,interpolationkey:w})};this.resetRegExp();const p=a?.missingInterpolationHandler||this.options.missingInterpolationHandler,g=a?.interpolation?.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:y=>dv(y)},{regex:this.regexp,safeValue:y=>this.escapeValue?dv(this.escape(y)):dv(y)}].forEach(y=>{for(l=0;s=y.regex.exec(e);){const x=s[1].trim();if(i=d(x),i===void 0)if(typeof p=="function"){const T=p(e,s,a);i=Fr(T)?T:""}else if(a&&Object.prototype.hasOwnProperty.call(a,x))i="";else if(g){i=s[0];continue}else this.logger.warn(`missed to pass in variable ${x} for interpolating ${e}`),i="";else!Fr(i)&&!this.useRawValueToEscape&&(i=fE(i));const w=y.safeValue(i);if(e=e.replace(s[0],w),g?(y.regex.lastIndex+=i.length,y.regex.lastIndex-=s[0].length):y.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,r,n={}){let a,s,i;const l=(c,d)=>{const p=this.nestingOptionsSeparator;if(c.indexOf(p)<0)return c;const g=c.split(new RegExp(`${p}[ ]*{`));let m=`{${g[1]}`;c=g[0],m=this.interpolate(m,i);const y=m.match(/'/g),x=m.match(/"/g);((y?.length??0)%2===0&&!x||x.length%2!==0)&&(m=m.replace(/'/g,'"'));try{i=JSON.parse(m),d&&(i={...d,...i})}catch(w){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,w),`${c}${p}${m}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,c};for(;a=this.nestingRegexp.exec(e);){let c=[];i={...n},i=i.replace&&!Fr(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;const d=/{.*}/.test(a[1])?a[1].lastIndexOf("}")+1:a[1].indexOf(this.formatSeparator);if(d!==-1&&(c=a[1].slice(d).split(this.formatSeparator).map(p=>p.trim()).filter(Boolean),a[1]=a[1].slice(0,d)),s=r(l.call(this,a[1].trim(),i),i),s&&a[0]===e&&!Fr(s))return s;Fr(s)||(s=fE(s)),s||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),s=""),c.length&&(s=c.reduce((p,g)=>this.format(p,g,n.lng,{...n,interpolationkey:a[1].trim()}),s.trim())),e=e.replace(a[0],s),this.regexp.lastIndex=0}return e}}const vF=t=>{let e=t.toLowerCase().trim();const r={};if(t.indexOf("(")>-1){const n=t.split("(");e=n[0].toLowerCase().trim();const a=n[1].substring(0,n[1].length-1);e==="currency"&&a.indexOf(":")<0?r.currency||(r.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?r.range||(r.range=a.trim()):a.split(";").forEach(i=>{if(i){const[l,...c]=i.split(":"),d=c.join(":").trim().replace(/^'+|'+$/g,""),p=l.trim();r[p]||(r[p]=d),d==="false"&&(r[p]=!1),d==="true"&&(r[p]=!0),isNaN(d)||(r[p]=parseInt(d,10))}})}return{formatName:e,formatOptions:r}},CE=t=>{const e={};return(r,n,a)=>{let s=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(s={...s,[a.interpolationkey]:void 0});const i=n+JSON.stringify(s);let l=e[i];return l||(l=t(Eg(n),a),e[i]=l),l(r)}},wF=t=>(e,r,n)=>t(Eg(r),n)(e);class SF{constructor(e={}){this.logger=Wo.create("formatter"),this.options=e,this.init(e)}init(e,r={interpolation:{}}){this.formatSeparator=r.interpolation.formatSeparator||",";const n=r.cacheInBuiltFormats?CE:wF;this.formats={number:n((a,s)=>{const i=new Intl.NumberFormat(a,{...s});return l=>i.format(l)}),currency:n((a,s)=>{const i=new Intl.NumberFormat(a,{...s,style:"currency"});return l=>i.format(l)}),datetime:n((a,s)=>{const i=new Intl.DateTimeFormat(a,{...s});return l=>i.format(l)}),relativetime:n((a,s)=>{const i=new Intl.RelativeTimeFormat(a,{...s});return l=>i.format(l,s.range||"day")}),list:n((a,s)=>{const i=new Intl.ListFormat(a,{...s});return l=>i.format(l)})}}add(e,r){this.formats[e.toLowerCase().trim()]=r}addCached(e,r){this.formats[e.toLowerCase().trim()]=CE(r)}format(e,r,n,a={}){const s=r.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(l=>l.indexOf(")")>-1)){const l=s.findIndex(c=>c.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,l)].join(this.formatSeparator)}return s.reduce((l,c)=>{const{formatName:d,formatOptions:p}=vF(c);if(this.formats[d]){let g=l;try{const m=a?.formatParams?.[a.interpolationkey]||{},y=m.locale||m.lng||a.locale||a.lng||n;g=this.formats[d](l,y,{...p,...a,...m})}catch(m){this.logger.warn(m)}return g}else this.logger.warn(`there was no format function for ${d}`);return l},e)}}const kF=(t,e)=>{t.pending[e]!==void 0&&(delete t.pending[e],t.pendingCount--)};class TF extends Ny{constructor(e,r,n,a={}){super(),this.backend=e,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=a,this.logger=Wo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(n,a.backend,a)}queueLoad(e,r,n,a){const s={},i={},l={},c={};return e.forEach(d=>{let p=!0;r.forEach(g=>{const m=`${d}|${g}`;!n.reload&&this.store.hasResourceBundle(d,g)?this.state[m]=2:this.state[m]<0||(this.state[m]===1?i[m]===void 0&&(i[m]=!0):(this.state[m]=1,p=!1,i[m]===void 0&&(i[m]=!0),s[m]===void 0&&(s[m]=!0),c[g]===void 0&&(c[g]=!0)))}),p||(l[d]=!0)}),(Object.keys(s).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(s),pending:Object.keys(i),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(c)}}loaded(e,r,n){const a=e.split("|"),s=a[0],i=a[1];r&&this.emit("failedLoading",s,i,r),!r&&n&&this.store.addResourceBundle(s,i,n,void 0,void 0,{skipCopy:!0}),this.state[e]=r?-1:2,r&&n&&(this.state[e]=0);const l={};this.queue.forEach(c=>{lF(c.loaded,[s],i),kF(c,e),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(d=>{l[d]||(l[d]={});const p=c.loaded[d];p.length&&p.forEach(g=>{l[d][g]===void 0&&(l[d][g]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(c=>!c.done)}read(e,r,n,a=0,s=this.retryTimeout,i){if(!e.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:r,fcName:n,tried:a,wait:s,callback:i});return}this.readingCalls++;const l=(d,p)=>{if(this.readingCalls--,this.waitingReads.length>0){const g=this.waitingReads.shift();this.read(g.lng,g.ns,g.fcName,g.tried,g.wait,g.callback)}if(d&&p&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,r,n,a+1,s*2,i)},s);return}i(d,p)},c=this.backend[n].bind(this.backend);if(c.length===2){try{const d=c(e,r);d&&typeof d.then=="function"?d.then(p=>l(null,p)).catch(l):l(null,d)}catch(d){l(d)}return}return c(e,r,l)}prepareLoading(e,r,n={},a){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();Fr(e)&&(e=this.languageUtils.toResolveHierarchy(e)),Fr(r)&&(r=[r]);const s=this.queueLoad(e,r,n,a);if(!s.toLoad.length)return s.pending.length||a(),null;s.toLoad.forEach(i=>{this.loadOne(i)})}load(e,r,n){this.prepareLoading(e,r,{},n)}reload(e,r,n){this.prepareLoading(e,r,{reload:!0},n)}loadOne(e,r=""){const n=e.split("|"),a=n[0],s=n[1];this.read(a,s,"read",void 0,void 0,(i,l)=>{i&&this.logger.warn(`${r}loading namespace ${s} for language ${a} failed`,i),!i&&l&&this.logger.log(`${r}loaded namespace ${s} for language ${a}`,l),this.loaded(e,i,l)})}saveMissing(e,r,n,a,s,i={},l=()=>{}){if(this.services?.utils?.hasLoadedNamespace&&!this.services?.utils?.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend?.create){const c={...i,isUpdate:s},d=this.backend.create.bind(this.backend);if(d.length<6)try{let p;d.length===5?p=d(e,r,n,a,c):p=d(e,r,n,a),p&&typeof p.then=="function"?p.then(g=>l(null,g)).catch(l):l(null,p)}catch(p){l(p)}else d(e,r,n,a,l,c)}!e||!e[0]||this.store.addResource(e[0],r,n,a)}}}const EE=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if(typeof t[1]=="object"&&(e=t[1]),Fr(t[1])&&(e.defaultValue=t[1]),Fr(t[2])&&(e.tDescription=t[2]),typeof t[2]=="object"||typeof t[3]=="object"){const r=t[3]||t[2];Object.keys(r).forEach(n=>{e[n]=r[n]})}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),_E=t=>(Fr(t.ns)&&(t.ns=[t.ns]),Fr(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),Fr(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),t.supportedLngs?.indexOf?.("cimode")<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),typeof t.initImmediate=="boolean"&&(t.initAsync=t.initImmediate),t),Sm=()=>{},CF=t=>{Object.getOwnPropertyNames(Object.getPrototypeOf(t)).forEach(r=>{typeof t[r]=="function"&&(t[r]=t[r].bind(t))})};class _g extends Ny{constructor(e={},r){if(super(),this.options=_E(e),this.services={},this.logger=Wo,this.modules={external:[]},CF(this),r&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,r),this;setTimeout(()=>{this.init(e,r)},0)}}init(e={},r){this.isInitializing=!0,typeof e=="function"&&(r=e,e={}),e.defaultNS==null&&e.ns&&(Fr(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=EE();this.options={...n,...this.options,..._E(e)},this.options.interpolation={...n.interpolation,...this.options.interpolation},e.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=e.keySeparator),e.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=e.nsSeparator);const a=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?Wo.init(a(this.modules.logger),this.options):Wo.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:d=SF;const p=new wE(this.options);this.store=new xE(this.options.resources,this.options);const g=this.services;g.logger=Wo,g.resourceStore=this.store,g.languageUtils=p,g.pluralResolver=new bF(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.deprecate("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),d&&(!this.options.interpolation.format||this.options.interpolation.format===n.interpolation.format)&&(g.formatter=a(d),g.formatter.init&&g.formatter.init(g,this.options),this.options.interpolation.format=g.formatter.format.bind(g.formatter)),g.interpolator=new xF(this.options),g.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},g.backendConnector=new TF(a(this.modules.backend),g.resourceStore,g,this.options),g.backendConnector.on("*",(y,...x)=>{this.emit(y,...x)}),this.modules.languageDetector&&(g.languageDetector=a(this.modules.languageDetector),g.languageDetector.init&&g.languageDetector.init(g,this.options.detection,this.options)),this.modules.i18nFormat&&(g.i18nFormat=a(this.modules.i18nFormat),g.i18nFormat.init&&g.i18nFormat.init(this)),this.translator=new _0(this.services,this.options),this.translator.on("*",(y,...x)=>{this.emit(y,...x)}),this.modules.external.forEach(y=>{y.init&&y.init(this)})}if(this.format=this.options.interpolation.format,r||(r=Sm),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=(...p)=>this.store[d](...p)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=(...p)=>(this.store[d](...p),this)});const l=wp(),c=()=>{const d=(p,g)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(g),r(p,g)};if(this.languages&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initAsync?c():setTimeout(c,0),l}loadResources(e,r=Sm){let n=r;const a=Fr(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(a?.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const s=[],i=l=>{if(!l||l==="cimode")return;this.services.languageUtils.toResolveHierarchy(l).forEach(d=>{d!=="cimode"&&s.indexOf(d)<0&&s.push(d)})};a?i(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>i(c)),this.options.preload?.forEach?.(l=>i(l)),this.services.backendConnector.load(s,this.options.ns,l=>{!l&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(l)})}else n(null)}reloadResources(e,r,n){const a=wp();return typeof e=="function"&&(n=e,e=void 0),typeof r=="function"&&(n=r,r=void 0),e||(e=this.languages),r||(r=this.options.ns),n||(n=Sm),this.services.backendConnector.reload(e,r,s=>{a.resolve(),n(s)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&nP.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1)){for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,r){this.isLanguageChangingTo=e;const n=wp();this.emit("languageChanging",e);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},s=(l,c)=>{c?this.isLanguageChangingTo===e&&(a(c),this.translator.changeLanguage(c),this.isLanguageChangingTo=void 0,this.emit("languageChanged",c),this.logger.log("languageChanged",c)):this.isLanguageChangingTo=void 0,n.resolve((...d)=>this.t(...d)),r&&r(l,(...d)=>this.t(...d))},i=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const c=Fr(l)?l:l&&l[0],d=this.store.hasLanguageSomeTranslations(c)?c:this.services.languageUtils.getBestMatchFromCodes(Fr(l)?[l]:l);d&&(this.language||a(d),this.translator.language||this.translator.changeLanguage(d),this.services.languageDetector?.cacheUserLanguage?.(d)),this.loadResources(d,p=>{s(p,d)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?i(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(i):this.services.languageDetector.detect(i):i(e),n}getFixedT(e,r,n){const a=(s,i,...l)=>{let c;typeof i!="object"?c=this.options.overloadTranslationOptionHandler([s,i].concat(l)):c={...i},c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||n||a.keyPrefix);const d=this.options.keySeparator||".";let p;return c.keyPrefix&&Array.isArray(s)?p=s.map(g=>(typeof g=="function"&&(g=Tw(g,{...this.options,...i})),`${c.keyPrefix}${d}${g}`)):(typeof s=="function"&&(s=Tw(s,{...this.options,...i})),p=c.keyPrefix?`${c.keyPrefix}${d}${s}`:s),this.t(p,c)};return Fr(e)?a.lng=e:a.lngs=e,a.ns=r,a.keyPrefix=n,a}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,r={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(l,c)=>{const d=this.services.backendConnector.state[`${l}|${c}`];return d===-1||d===0||d===2};if(r.precheck){const l=r.precheck(this,i);if(l!==void 0)return l}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||i(n,e)&&(!a||i(s,e)))}loadNamespaces(e,r){const n=wp();return this.options.ns?(Fr(e)&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{n.resolve(),r&&r(a)}),n):(r&&r(),Promise.resolve())}loadLanguages(e,r){const n=wp();Fr(e)&&(e=[e]);const a=this.options.preload||[],s=e.filter(i=>a.indexOf(i)<0&&this.services.languageUtils.isSupportedCode(i));return s.length?(this.options.preload=a.concat(s),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const a=new Intl.Locale(e);if(a&&a.getTextInfo){const s=a.getTextInfo();if(s&&s.direction)return s.direction}}catch{}const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services?.languageUtils||new wE(EE());return e.toLowerCase().indexOf("-latn")>1?"ltr":r.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},r){return new _g(e,r)}cloneInstance(e={},r=Sm){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},s=new _g(a);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(l=>{s[l]=this[l]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},n){const l=Object.keys(this.store.data).reduce((c,d)=>(c[d]={...this.store.data[d]},c[d]=Object.keys(c[d]).reduce((p,g)=>(p[g]={...c[d][g]},p),c[d]),c),{});s.store=new xE(l,a),s.services.resourceStore=s.store}return s.translator=new _0(s.services,a),s.translator.on("*",(l,...c)=>{s.emit(l,...c)}),s.init(a,r),s.translator.options=a,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ws=_g.createInstance();ws.createInstance=_g.createInstance;ws.createInstance;ws.dir;ws.init;ws.loadResources;ws.reloadResources;ws.use;ws.changeLanguage;ws.getFixedT;ws.t;ws.exists;ws.setDefaultNamespace;ws.hasLoadedNamespace;ws.loadNamespaces;ws.loadLanguages;var N=Kg();const Ur=Dc(N),EF=(t,e,r,n)=>{const a=[r,{code:e,...n||{}}];if(t?.services?.logger?.forward)return t.services.logger.forward(a,"warn","react-i18next::",!0);Nu(a[0])&&(a[0]=`react-i18next:: ${a[0]}`),t?.services?.logger?.warn?t.services.logger.warn(...a):console?.warn&&console.warn(...a)},AE={},sP=(t,e,r,n)=>{Nu(r)&&AE[r]||(Nu(r)&&(AE[r]=new Date),EF(t,e,r,n))},iP=(t,e)=>()=>{if(t.isInitialized)e();else{const r=()=>{setTimeout(()=>{t.off("initialized",r)},0),e()};t.on("initialized",r)}},Cw=(t,e,r)=>{t.loadNamespaces(e,iP(t,r))},NE=(t,e,r,n)=>{if(Nu(r)&&(r=[r]),t.options.preload&&t.options.preload.indexOf(e)>-1)return Cw(t,r,n);r.forEach(a=>{t.options.ns.indexOf(a)<0&&t.options.ns.push(a)}),t.loadLanguages(e,iP(t,n))},_F=(t,e,r={})=>!e.languages||!e.languages.length?(sP(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(t,{lng:r.lng,precheck:(n,a)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&n.services.backendConnector.backend&&n.isLanguageChangingTo&&!a(n.isLanguageChangingTo,t))return!1}}),Nu=t=>typeof t=="string",AF=t=>typeof t=="object"&&t!==null,NF=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,PF={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},IF=t=>PF[t],RF=t=>t.replace(NF,IF);let Ew={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:RF};const DF=(t={})=>{Ew={...Ew,...t}},LF=()=>Ew;let oP;const MF=t=>{oP=t},OF=()=>oP,jF={type:"3rdParty",init(t){DF(t.options.react),MF(t)}},BF=N.createContext();class FF{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}var hv={exports:{}},pv={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PE;function zF(){if(PE)return pv;PE=1;var t=Kg();function e(g,m){return g===m&&(g!==0||1/g===1/m)||g!==g&&m!==m}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,a=t.useEffect,s=t.useLayoutEffect,i=t.useDebugValue;function l(g,m){var y=m(),x=n({inst:{value:y,getSnapshot:m}}),w=x[0].inst,T=x[1];return s(function(){w.value=y,w.getSnapshot=m,c(w)&&T({inst:w})},[g,y,m]),a(function(){return c(w)&&T({inst:w}),g(function(){c(w)&&T({inst:w})})},[g]),i(y),y}function c(g){var m=g.getSnapshot;g=g.value;try{var y=m();return!r(g,y)}catch{return!0}}function d(g,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return pv.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:p,pv}var IE;function $F(){return IE||(IE=1,hv.exports=zF()),hv.exports}var UF=$F();const qF=(t,e)=>Nu(e)?e:AF(e)&&Nu(e.defaultValue)?e.defaultValue:Array.isArray(t)?t[t.length-1]:t,HF={t:qF,ready:!1},GF=()=>()=>{},Lc=(t,e={})=>{const{i18n:r}=e,{i18n:n,defaultNS:a}=N.useContext(BF)||{},s=r||n||OF();s&&!s.reportNamespaces&&(s.reportNamespaces=new FF),s||sP(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const i=N.useMemo(()=>({...LF(),...s?.options?.react,...e}),[s,e]),{useSuspense:l,keyPrefix:c}=i,d=N.useMemo(()=>{const F=a||s?.options?.defaultNS;return Nu(F)?[F]:F||["translation"]},[t,a,s]);s?.reportNamespaces?.addUsedNamespaces?.(d);const p=N.useRef(0),g=N.useCallback(F=>{if(!s)return GF;const{bindI18n:D,bindI18nStore:B}=i,M=()=>{p.current+=1,F()};return D&&s.on(D,M),B&&s.store.on(B,M),()=>{D&&D.split(" ").forEach($=>s.off($,M)),B&&B.split(" ").forEach($=>s.store.off($,M))}},[s,i]),m=N.useRef(),y=N.useCallback(()=>{if(!s)return HF;const F=!!(s.isInitialized||s.initializedStoreOnce)&&d.every(z=>_F(z,s,i)),D=e.lng||s.language,B=p.current,M=m.current;if(M&&M.ready===F&&M.lng===D&&M.keyPrefix===c&&M.revision===B)return M;const Z={t:s.getFixedT(D,i.nsMode==="fallback"?d:d[0],c),ready:F,lng:D,keyPrefix:c,revision:B};return m.current=Z,Z},[s,d,c,i,e.lng]),[x,w]=N.useState(0),{t:T,ready:k}=UF.useSyncExternalStore(g,y,y);N.useEffect(()=>{if(s&&!k&&!l){const F=()=>w(D=>D+1);e.lng?NE(s,e.lng,d,F):Cw(s,d,F)}},[s,e.lng,d,k,l,x]);const _=s||{},P=N.useMemo(()=>{const F=[T,_,k];return F.t=T,F.i18n=_,F.ready=k,F},[T,_,k]);if(s&&l&&!k)throw new Promise(F=>{const D=()=>F();e.lng?NE(s,e.lng,d,D):Cw(s,d,D)});return P},{slice:VF,forEach:WF}=[];function YF(t){return WF.call(VF.call(arguments,1),e=>{if(e)for(const r in e)t[r]===void 0&&(t[r]=e[r])}),t}function QF(t){return typeof t!="string"?!1:[/<\s*script.*?>/i,/<\s*\/\s*script\s*>/i,/<\s*img.*?on\w+\s*=/i,/<\s*\w+\s*on\w+\s*=.*?>/i,/javascript\s*:/i,/vbscript\s*:/i,/expression\s*\(/i,/eval\s*\(/i,/alert\s*\(/i,/document\.cookie/i,/document\.write\s*\(/i,/window\.location/i,/innerHTML/i].some(r=>r.test(t))}const RE=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,KF=function(t,e){const n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{path:"/"},a=encodeURIComponent(e);let s=`${t}=${a}`;if(n.maxAge>0){const i=n.maxAge-0;if(Number.isNaN(i))throw new Error("maxAge should be a Number");s+=`; Max-Age=${Math.floor(i)}`}if(n.domain){if(!RE.test(n.domain))throw new TypeError("option domain is invalid");s+=`; Domain=${n.domain}`}if(n.path){if(!RE.test(n.path))throw new TypeError("option path is invalid");s+=`; Path=${n.path}`}if(n.expires){if(typeof n.expires.toUTCString!="function")throw new TypeError("option expires is invalid");s+=`; Expires=${n.expires.toUTCString()}`}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;case"none":s+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return n.partitioned&&(s+="; Partitioned"),s},DE={create(t,e,r,n){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};r&&(a.expires=new Date,a.expires.setTime(a.expires.getTime()+r*60*1e3)),n&&(a.domain=n),document.cookie=KF(t,e,a)},read(t){const e=`${t}=`,r=document.cookie.split(";");for(let n=0;n<r.length;n++){let a=r[n];for(;a.charAt(0)===" ";)a=a.substring(1,a.length);if(a.indexOf(e)===0)return a.substring(e.length,a.length)}return null},remove(t,e){this.create(t,"",-1,e)}};var XF={name:"cookie",lookup(t){let{lookupCookie:e}=t;if(e&&typeof document<"u")return DE.read(e)||void 0},cacheUserLanguage(t,e){let{lookupCookie:r,cookieMinutes:n,cookieDomain:a,cookieOptions:s}=e;r&&typeof document<"u"&&DE.create(r,t,n,a,s)}},JF={name:"querystring",lookup(t){let{lookupQuerystring:e}=t,r;if(typeof window<"u"){let{search:n}=window.location;!window.location.search&&window.location.hash?.indexOf("?")>-1&&(n=window.location.hash.substring(window.location.hash.indexOf("?")));const s=n.substring(1).split("&");for(let i=0;i<s.length;i++){const l=s[i].indexOf("=");l>0&&s[i].substring(0,l)===e&&(r=s[i].substring(l+1))}}return r}},ZF={name:"hash",lookup(t){let{lookupHash:e,lookupFromHashIndex:r}=t,n;if(typeof window<"u"){const{hash:a}=window.location;if(a&&a.length>2){const s=a.substring(1);if(e){const i=s.split("&");for(let l=0;l<i.length;l++){const c=i[l].indexOf("=");c>0&&i[l].substring(0,c)===e&&(n=i[l].substring(c+1))}}if(n)return n;if(!n&&r>-1){const i=a.match(/\/([a-zA-Z-]*)/g);return Array.isArray(i)?i[typeof r=="number"?r:0]?.replace("/",""):void 0}}}return n}};let Nd=null;const LE=()=>{if(Nd!==null)return Nd;try{if(Nd=typeof window<"u"&&window.localStorage!==null,!Nd)return!1;const t="i18next.translate.boo";window.localStorage.setItem(t,"foo"),window.localStorage.removeItem(t)}catch{Nd=!1}return Nd};var e8={name:"localStorage",lookup(t){let{lookupLocalStorage:e}=t;if(e&&LE())return window.localStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupLocalStorage:r}=e;r&&LE()&&window.localStorage.setItem(r,t)}};let Pd=null;const ME=()=>{if(Pd!==null)return Pd;try{if(Pd=typeof window<"u"&&window.sessionStorage!==null,!Pd)return!1;const t="i18next.translate.boo";window.sessionStorage.setItem(t,"foo"),window.sessionStorage.removeItem(t)}catch{Pd=!1}return Pd};var t8={name:"sessionStorage",lookup(t){let{lookupSessionStorage:e}=t;if(e&&ME())return window.sessionStorage.getItem(e)||void 0},cacheUserLanguage(t,e){let{lookupSessionStorage:r}=e;r&&ME()&&window.sessionStorage.setItem(r,t)}},r8={name:"navigator",lookup(t){const e=[];if(typeof navigator<"u"){const{languages:r,userLanguage:n,language:a}=navigator;if(r)for(let s=0;s<r.length;s++)e.push(r[s]);n&&e.push(n),a&&e.push(a)}return e.length>0?e:void 0}},n8={name:"htmlTag",lookup(t){let{htmlTag:e}=t,r;const n=e||(typeof document<"u"?document.documentElement:null);return n&&typeof n.getAttribute=="function"&&(r=n.getAttribute("lang")),r}},a8={name:"path",lookup(t){let{lookupFromPathIndex:e}=t;if(typeof window>"u")return;const r=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(r)?r[typeof e=="number"?e:0]?.replace("/",""):void 0}},s8={name:"subdomain",lookup(t){let{lookupFromSubdomainIndex:e}=t;const r=typeof e=="number"?e+1:1,n=typeof window<"u"&&window.location?.hostname?.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i);if(n)return n[r]}};let lP=!1;try{document.cookie,lP=!0}catch{}const cP=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];lP||cP.splice(1,1);const i8=()=>({order:cP,lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:t=>t});class uP{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(e,r)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{languageUtils:{}},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=e,this.options=YF(r,this.options||{},i8()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=a=>a.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=n,this.addDetector(XF),this.addDetector(JF),this.addDetector(e8),this.addDetector(t8),this.addDetector(r8),this.addDetector(n8),this.addDetector(a8),this.addDetector(s8),this.addDetector(ZF)}addDetector(e){return this.detectors[e.name]=e,this}detect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.order,r=[];return e.forEach(n=>{if(this.detectors[n]){let a=this.detectors[n].lookup(this.options);a&&typeof a=="string"&&(a=[a]),a&&(r=r.concat(a))}}),r=r.filter(n=>n!=null&&!QF(n)).map(n=>this.options.convertDetectedLanguage(n)),this.services&&this.services.languageUtils&&this.services.languageUtils.getBestMatchFromCodes?r:r.length>0?r[0]:null}cacheUserLanguage(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.caches;r&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(e)>-1||r.forEach(n=>{this.detectors[n]&&this.detectors[n].cacheUserLanguage(e,this.options)}))}}uP.type="languageDetector";const o8={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",close:"Close",loading:"Loading...",error:"Error",success:"Success",confirm:"Confirm",back:"Back",next:"Next",submit:"Submit",clear:"Clear",search:"Search",filter:"Filter",export:"Export",import:"Import",download:"Download",upload:"Upload",copy:"Copy",paste:"Paste",cut:"Cut",undo:"Undo",redo:"Redo",select:"Select",selectAll:"Select All",deselectAll:"Deselect All"},l8={signIn:"Sign in with Google",signInWithGoogle:"Sign in with Google",initializing:"Initializing...",signOut:"Sign Out",authRequired:"Authentication is required to use this application",tokenExpired:"Your session has expired. Please sign in again.",welcomeBack:"Welcome back!",signInPrompt:"Sign in to continue",signInRequired:"You must sign in to use this feature",signingIn:"Signing in...",signingOut:"Signing out...",researchAgent:"Research Agent",tagline:"AI-powered research assistant",secureAuth:"Secure authentication powered by Google",whyChooseTitle:"Why Choose Research Agent?",whyChooseIntro:"Unlike standard AI chatbots that simply answer questions, Research Agent is your comprehensive research companion built for deep investigation and knowledge building.",keyAdvantagesTitle:"Key Advantages:",webConnected:"Web-Connected Intelligence",webConnectedDesc:"Real-time web search and content extraction ensure you get current, accurate informationnot outdated training data",multiTool:"Multi-Tool Orchestration",multiToolDesc:"Seamlessly combines web search, code execution, YouTube transcripts, image generation, and document analysis in a single conversation",knowledgeBase:"Knowledge Base Integration",knowledgeBaseDesc:"Save findings to your personal knowledge base, create snippets, and build comprehensive research documents over time",advancedPlanning:"Advanced Planning",advancedPlanningDesc:"Generate structured research plans with expert personas, search strategies, and methodological approaches",costEffective:"Smart Model Selection",costEffectiveDesc:"Automatic selection of models that do the job economically or powerfully based on selection strategy. Bring your own keys to save 25%",transparency:"Full Transparency",transparencyDesc:"Track every API call, token usage, and cost in real-time billing dashboard",perfectFor:"Perfect for: Academic research, market analysis, content creation, technical documentation, competitive intelligence, and any task requiring thorough investigation."},c8={placeholder:"Type your message here...",send:"Send",retry:"Retry",stop:"Stop",thinking:"Thinking...",generating:"Generating response...",newChat:"New Chat",clearHistory:"Clear History",loadChat:"Load Chat",systemPrompt:"System Prompt",customInstructions:"Custom Instructions",temperature:"Temperature",maxTokens:"Max Tokens",model:"Model",provider:"Provider",history:"Chat History",continue:"Continue",regenerate:"Regenerate",edit:"Edit",delete:"Delete",copy:"Copy",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Please sign in to use this feature",providerRequired:"Please configure at least one provider in Settings",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:"Select All",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},u8={title:"Research Planning",query:"Research Query",generatePlan:"Generate Plan",savePlan:"Save Plan",loadSaved:"Load Saved",transferToChat:"Transfer to Chat",clearAll:"Clear All",debug:"Debug",planning:"Planning...",planGenerated:"Plan generated successfully",noPlan:"No plan generated yet",enterQuery:"Enter your research query or topic...",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},d8={title:"Settings",language:"Language",selectLanguage:"Select Language",providers:"Providers",cloudSync:"Cloud Sync",billing:"Billing",general:"General",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",serverProviders:"Server Providers",serverProvidersDescription:"View available providers configured on the server and their capabilities",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize smaller, cost-effective models. Falls back to larger models only when needed for complex tasks. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Balances cost vs. capability for optimal results",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"Voice",tts:"TTS",rag:"RAG"},appearance:"Appearance",theme:"Theme",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},h8={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},p8={title:"Billing Dashboard",balance:"Credit Balance",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Cost",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},g8={generic:"An error occurred",network:"Network error",timeout:"Request timed out",unauthorized:"Unauthorized access",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Please try again"},f8={title:"Knowledge Base",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Search snippets...",noSnippets:"No snippets found",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},m8={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},y8={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},b8={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},x8={title:"Feed",generateFeed:"Generate Feed",generating:"Generating content...",refresh:"Refresh",noItems:"No items yet",emptyMessage:"Your personalized feed will appear here",emptySubMessage:"We'll generate content based on your saved snippets and interests",didYouKnow:"Did You Know",questionAnswer:"Q&A",stash:"Grab",stashed:"Grabbed",trash:"Trash",quiz:"Quiz",swipeLeft:"Swipe left to trash",swipeRight:"Swipe right to grab",showMore:"Show more",showLess:"Show less",sources:"Sources",topics:"Topics",settings:{title:"Feed Settings",searchTerms:"Search Terms",searchTermsDesc:"Define up to 5 search topics to personalize your feed",addTerm:"Add Term",removeTerm:"Remove",maxTerms:"Maximum 5 search terms allowed",termExists:"This search term already exists",placeholder:"e.g., 'artificial intelligence', 'climate news'",learnedPreferences:"Learned Preferences",likedTopics:"Liked Topics",dislikedTopics:"Disliked Topics",stashToLearn:"Grab items to help the feed learn what you like",trashToLearn:"Trash items to help the feed learn what to avoid",tips:" Tips for Better Feeds",tipSpecific:'Be specific with search terms (e.g., "quantum computing" vs "technology")',tipStash:"Grab items you find interesting to refine future recommendations",tipTrash:"Trash irrelevant items to improve content quality",tipMix:"Mix broad and specific topics for variety"}},v8={title:"Quiz",subtitle:"Track your learning progress and quiz performance",startQuiz:"Start Quiz",nextQuestion:"Next Question",previousQuestion:"Previous",submitAnswer:"Submit Answer",viewResults:"View Results",retakeQuiz:"Retake Quiz",score:"Score",correct:"Correct",incorrect:"Incorrect",question:"Question",of:"of",yourAnswer:"Your answer",correctAnswer:"Correct answer",explanation:"Explanation",generating:"Generating quiz...",noQuizzes:"No quizzes yet",emptyMessage:"Generate a quiz from any saved snippet or feed item",performance:"Quiz Performance",totalQuizzes:"Total Quizzes",averageScore:"Average Score",questionsAnswered:"Questions Answered",statistics:"Quiz Statistics",createNewQuiz:"Create New Quiz",recentQuizzes:"Recent Quizzes",noQuizzesYet:"No quizzes completed yet",noQuizzesDescription:"Take a quiz from your saved content in SWAG to see your statistics here",goToSwag:"Go to SWAG",quizMe:"Quiz Me",quizMeHelp:"You can also generate quizzes from the Swag page by selecting snippets, or from the Feed page.",generatingQuiz:"Generating Quiz...",backToChat:"Back to Chat",loadingStats:"Loading statistics...",errorLoadingStats:"Failed to load quiz statistics",confirmDelete:"Are you sure you want to delete the quiz '{{title}}'?",quizDeleted:"Quiz deleted successfully",errorDeletingQuiz:"Failed to delete quiz",deleteQuiz:"Delete quiz",today:"Today",yesterday:"Yesterday",daysAgo:"{{days}} days ago",snippetCount:"{{count}} snippet",snippetCount_plural:"{{count}} snippets",enriched:"Enriched",notSynced:"Not Synced",highestScore:"Highest Score",lowestScore:"Lowest Score",clickToRestart:"Click to Restart",notCompleted:"Not Completed",clickToRetake:"Click to Retake"},w8={common:o8,auth:l8,chat:c8,planning:u8,settings:d8,languages:h8,billing:p8,errors:g8,swag:f8,tts:m8,playlist:y8,tools:b8,feed:x8,quiz:v8},S8={save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",close:"Cerrar",loading:"Cargando...",error:"Error",success:"xito",confirm:"Confirmar",back:"Atrs",next:"Siguiente",submit:"Enviar",clear:"Limpiar",search:"Buscar",filter:"Filtrar",export:"Exportar",import:"Importar",download:"Descargar",upload:"Subir",copy:"Copiar",paste:"Pegar",cut:"Cortar",undo:"Deshacer",redo:"Rehacer",select:"Seleccionar",selectAll:"Seleccionar todo",deselectAll:"Deseleccionar todo"},k8={signIn:"Iniciar sesin con Google",signInWithGoogle:"Iniciar sesin con Google",initializing:"Inicializando...",signOut:"Cerrar sesin",authRequired:"Se requiere autenticacin para usar esta aplicacin",tokenExpired:"Tu sesin ha expirado. Por favor inicia sesin nuevamente.",welcomeBack:"Bienvenido de nuevo!",signInPrompt:"Iniciar sesin para continuar",signInRequired:"Debes iniciar sesin para usar esta funcin",signingIn:"Iniciando sesin...",signingOut:"Cerrando sesin...",researchAgent:"Agente de Investigacin",tagline:"Asistente de investigacin con IA",secureAuth:"Autenticacin segura con tecnologa de Google",whyChooseTitle:"Por qu elegir Research Agent?",whyChooseIntro:"A diferencia de los chatbots de IA estndar que simplemente responden preguntas, Research Agent es tu compaero integral de investigacin diseado para investigaciones profundas y construccin de conocimiento.",keyAdvantagesTitle:"Ventajas Clave:",webConnected:"Inteligencia Conectada a la Web",webConnectedDesc:"La bsqueda web en tiempo real y extraccin de contenido garantizan informacin actual y precisa, no datos de entrenamiento obsoletos",multiTool:"Orquestacin Multi-Herramienta",multiToolDesc:"Combina perfectamente bsqueda web, ejecucin de cdigo, transcripciones de YouTube, generacin de imgenes y anlisis de documentos en una sola conversacin",knowledgeBase:"Integracin de Base de Conocimiento",knowledgeBaseDesc:"Guarda hallazgos en tu base de conocimiento personal, crea fragmentos y construye documentos de investigacin integrales con el tiempo",advancedPlanning:"Planificacin Avanzada",advancedPlanningDesc:"Genera planes de investigacin estructurados con personas expertas, estrategias de bsqueda y enfoques metodolgicos",costEffective:"Seleccin Inteligente de Modelos",costEffectiveDesc:"Seleccin automtica de modelos que hacen el trabajo de manera econmica o potente segn la estrategia de seleccin. Trae tus propias claves para ahorrar un 25%",transparency:"Transparencia Total",transparencyDesc:"Rastrea cada llamada API, uso de tokens y costos en el panel de facturacin en tiempo real",perfectFor:"Perfecto para: Investigacin acadmica, anlisis de mercado, creacin de contenido, documentacin tcnica, inteligencia competitiva y cualquier tarea que requiera investigacin exhaustiva."},T8={placeholder:"Escribe tu mensaje aqu...",send:"Enviar",retry:"Reintentar",stop:"Detener",thinking:"Pensando...",generating:"Generando respuesta...",newChat:"Nuevo Chat",clearHistory:"Limpiar Historial",loadChat:"Cargar Chat",systemPrompt:"Indicacin del Sistema",customInstructions:"Instrucciones Personalizadas",temperature:"Temperatura",maxTokens:"Tokens Mximos",model:"Modelo",provider:"Proveedor",history:"Historial de Chat",continue:"Continuar",regenerate:"Regenerar",edit:"Editar",delete:"Eliminar",copy:"Copiar",copied:"Copiado!",selectFiles:"Seleccionar Archivos",attachFiles:"Adjuntar Archivos",pasteImage:"Pegar Imagen",recording:"Grabando...",voiceInput:"Entrada de Voz",stopRecording:"Detener Grabacin",processing:"Procesando...",noMessages:"No hay mensajes an. Inicia una conversacin!",clearConfirm:"Ests seguro de que quieres limpiar todos los mensajes?",deleteConfirm:"Ests seguro de que quieres eliminar este mensaje?",loadingHistory:"Cargando historial de chat...",savingChat:"Guardando chat...",chatSaved:"Chat guardado exitosamente",chatLoaded:"Chat cargado exitosamente",errorSaving:"Error al guardar el chat",errorLoading:"Error al cargar el chat",signInRequired:"Por favor inicia sesin para usar esta funcin",providerRequired:"Por favor configura al menos un proveedor en Configuracin",messageError:"Error al enviar el mensaje",streamError:"Error en el flujo del mensaje",toolExecution:"Ejecutando herramienta...",toolExecuted:"Herramienta ejecutada exitosamente",toolError:"Error de ejecucin de herramienta",searchingWeb:"Buscando en la web...",scrapingContent:"Extrayendo contenido...",transcribingAudio:"Transcribiendo audio...",generatingImage:"Generando imagen...",generatingChart:"Generando grfico...",executingCode:"Ejecutando cdigo...",planningMode:"Modo de Planificacin",exitPlanning:"Salir de Planificacin",startPlanning:"Iniciar Planificacin",mcpServers:"Servidores MCP",addMCPServer:"Agregar Servidor MCP",mcpServerName:"Nombre del Servidor",mcpServerUrl:"URL del Servidor",exampleServers:"Servidores de Ejemplo",officialServers:"Servidores MCP Oficiales",sampleServers:"Servidores de Muestra",instructions:"Instrucciones",availableTools:"Herramientas Disponibles",enableServer:"Habilitar Servidor",disableServer:"Deshabilitar Servidor",removeServer:"Eliminar Servidor",serverAdded:"Servidor agregado exitosamente",serverRemoved:"Servidor eliminado exitosamente",invalidUrl:"Formato de URL invlido",nameRequired:"Se requiere el nombre del servidor",urlRequired:"Se requiere la URL del servidor",chatHistory:"Historial de Chat",examples:"Ejemplos",attachContext:"Adjuntar Contexto",attachContextTooltip:"Adjunta fragmentos de la base de conocimiento como contexto para esta conversacin",searchProvider:"Proveedor de Bsqueda:",functionCall:"Llamada de Funcin:",code:"Cdigo:",arguments:"Argumentos:",callId:"ID de Llamada:",result:"Resultado:",url:"URL:",viewRawHtml:"Ver HTML sin procesar sin comprimir",copyOutputToClipboard:"Copiar salida al portapapeles",copyCodeToClipboard:"Copiar cdigo al portapapeles",captureToSwag:"Capturar a Swag",captureOutputToSwag:"Capturar salida a Swag",captureCodeToSwag:"Capturar cdigo a Swag",grabImage:"Capturar imagen",noSummarization:"Sin resumen",usingProxy:"Usando proxy para mayor privacidad y evasin de deteccin de bots",contentExtracted:"Contenido extrado inteligentemente",truncatedToFit:"Truncado para ajustarse al modelo",scrapeMethod:"Mtodo de Extraccin:",tier:"Nivel",scrapeTime:"Tiempo de Extraccin:",totalTime:"Tiempo Total:",format:"Formato:",originalSize:"Tamao Original:",compressedSize:"Tamao Comprimido:",compression:"Compresin:",compressionStrategy:"Estrategia de Compresin:",basicExtraction:"Extraccin bsica",rawHtml:"HTML Sin Procesar ({{count}} caracteres)",rawText:"Texto Sin Procesar ({{count}} caracteres)",contentProcessingPipeline:"Pipeline de Procesamiento de Contenido:",size:"Tamao:",titlePrompt:"Ttulo/Indicacin",finalPrompt:"Indicacin Final",deleteChat:"Eliminar Chat",clearAllChats:"Limpiar Todos los Chats",confirmClearAll:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDelete:"Ests seguro de que quieres eliminar este chat?",noChatsYet:"No hay chats an",startChatting:"Comienza a chatear para ver el historial aqu",chatDeleted:"Chat eliminado",allChatsCleared:"Todos los chats limpiados",chatTitle:"Ttulo del Chat",enterChatTitle:"Ingresa un ttulo para este chat...",signInToChat:"Por favor inicia sesin para comenzar a chatear",streamingResponse:"Respuesta en transmisin...",imageAddedToSwag:"Imagen agregada a Swag!",imageAddedWithoutConversion:"Imagen agregada a Swag (sin conversin)!",contentCapturedToSwag:"Contenido capturado a Swag!",contentCapturedWithoutConversion:"Contenido capturado a Swag (sin conversin de imagen)!",planningTransferred:"Indicaciones de planificacin transferidas a nuevo chat",failedToTransfer:"Error al transferir datos de planificacin",addedToPlaylist:"{{count}} video{{plural}} agregado{{plural}} a la lista de reproduccin",transcriptionStopped:"Transcripcin detenida",failedToStopTranscription:"Error al detener la transcripcin: {{error}}",fileTypeNotSupported:"Tipo de archivo no compatible: {{name}}. Tipos compatibles: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"Archivo demasiado grande: {{name}} ({{size}}MB). Tamao mximo: {{maxSize}}MB",imageTokenWarning:"La imagen {{name}} puede usar muchos tokens (~{{tokens}}k). Considera usar una imagen ms pequea.",fileAdded:"{{name}} agregado",failedToProcess:"Error al procesar {{name}}",signInToSendMessages:"Por favor inicia sesin para enviar mensajes",foundRelevantChunks:" Se encontraron {{count}} fragmentos relevantes de la base de conocimiento",noRelevantContext:"No se encontr contexto relevante en la base de conocimiento",failedToRetrieveRag:"Error al recuperar el contexto RAG, continuando sin l",sessionExpired:"Tu sesin ha expirado. Por favor inicia sesin nuevamente.",todoLimitReached:"Lmite de progresin automtica de tareas alcanzado. Por favor contina manualmente.",snippetSaved:"Fragmento guardado: {{title}}",snippetDeleted:"Fragmento eliminado: {{title}}",copiedToClipboard:"Copiado al portapapeles!",outputCopied:"Salida copiada al portapapeles!",codeCopied:"Cdigo copiado al portapapeles!",inputPlaceholder:"Escribe tu mensaje... (Shift+Enter para nueva lnea,  para historial)",continueProcessing:"Continuar Procesamiento",stopGenerating:"Detener generacin de respuesta",sendMessage:"Enviar mensaje",chatMessageInput:"Entrada de mensaje de chat",editPlan:"Editar Plan",makeAPlan:"Hacer un Plan",close:"Cerrar",failedToLoadChat:"Error al cargar el chat",mcpServerNamePlaceholder:"Nombre del Servidor (ej., filesystem, github)",mcpServerUrlPlaceholder:"URL del Servidor (ej., http://localhost:3000)",noMcpServers:"No hay servidores MCP configurados",addServer:"Agregar Servidor",remove:"Eliminar",chatHistoryTitle:"Historial de Chat",noChatHistory:"No se encontr historial de chat. Inicia una conversacin para guardarla automticamente.",allChatHistoryCleared:"Todo el historial de chat limpiado",loadChatSuccess:"Chat cargado exitosamente",examplesTitle:"Ejemplos de Chat",tryExample:"Prueba este ejemplo",attachContextTitle:"Adjuntar Contexto de Swag",snippetsAttached:"{{count}} fragmento{{plural}} adjunto{{plural}}",attachSnippets:"Adjuntar Fragmentos",searchSnippets:"Buscar fragmentos...",selectAll:"Seleccionar Todo",selectNone:"Seleccionar Ninguno",deleteSelected:"Eliminar Seleccionados",cancel:"Cancelar",load:"Cargar",confirmDeleteChat:"Ests seguro de que quieres eliminar este chat?",confirmClearHistory:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDeleteSelected:"Ests seguro de que quieres eliminar {{count}} chat{{plural}} seleccionado{{plural}}?",chatLoadedFrom:"Cargado desde",chatSavedAt:"Guardado en",noTitle:"Sin ttulo",clearAttachedSnippets:"Limpiar todos los fragmentos adjuntos",mcpServerConfiguration:"Configuracin del Servidor MCP",typeMessageFirst:"Escribe un mensaje primero",typeMessage:"Escribe un mensaje",signInToSend:"Por favor inicia sesin para enviar mensajes"},C8={title:"Planificacin de Investigacin",query:"Consulta de Investigacin",generatePlan:"Generar Plan",savePlan:"Guardar Plan",loadSaved:"Cargar Guardado",transferToChat:"Transferir al Chat",clearAll:"Limpiar Todo",debug:"Depurar",planning:"Planificando...",planGenerated:"Plan generado exitosamente",noPlan:"An no se ha generado ningn plan",enterQuery:"Ingresa tu consulta o tema de investigacin...",researchFocus:"Enfoque de Investigacin",methodology:"Metodologa",expectedOutcome:"Resultado Esperado",initializing:"Inicializando...",processing:"Procesando...",signInToGenerate:"Inicia sesin para Generar Plan",generating:"Generando...",signInToUsePlanning:"Por favor inicia sesin para usar la planificacin",signInRequired:"Por favor inicia sesin con Google para usar la funcin de planificacin",authExpired:"Autenticacin expirada. Por favor cierra sesin e inicia sesin nuevamente para continuar.",authRequired:"Se requiere autenticacin. Por favor inicia sesin con Google para continuar.",enterResearchQuestion:"Por favor ingresa una pregunta de investigacin",debugCopied:"Informacin de depuracin copiada al portapapeles!",debugCopyFailed:"Error al copiar informacin de depuracin",savePlanTooltip:"Guarda el plan actual en tu lista de planes guardados",loadSavedPlans:"Cargar Planes Guardados",debugTooltip:"Copiar informacin de depuracin para solucin de problemas de Copilot",transferTooltip:"Transferir al Chat",clearAllTooltip:"Limpiar todos los datos de planificacin y comenzar de nuevo",systemPromptEditable:"Indicacin del Sistema Generada (Editable):",systemPromptHelp:"Esto define el rol y comportamiento de la IA. Edtalo segn sea necesario antes de transferir al chat.",userQueryEditable:"Consulta de Usuario Generada (Editable):",userQueryHelp:"Este es el mensaje que se enviar al chat. Edtalo para refinar tu consulta.",generatedPrompts:"Indicaciones Generadas",llmInfoTooltip:"Ver informacin de transparencia del LLM (modelo, tokens, costo)",llmCalls:"llamada",llmCallsPlural:"llamadas",cannotSavePlan:"No se puede guardar el plan: No se gener un plan vlido",planSavedSuccess:"Plan guardado exitosamente",planSaveFailed:"Error al guardar el plan",loadSavedPlan:"Cargar Plan Guardado",storage:"Almacenamiento",storageWarning:"El almacenamiento est al {{percentage}}% de su capacidad",storageWarningHelp:"Considera eliminar planes antiguos para liberar espacio.",noSavedPlans:"No se encontraron planes guardados",saved:"Guardado",load:"Cargar",simpleQueryDetected:"Consulta Simple Detectada",simpleQueryHelp:"Esta consulta puede responderse directamente sin planificacin extensa.",comprehensiveResearchPlan:" Plan de Investigacin Completo",analysisSummary:" Resumen del Anlisis",queryType:"Tipo de Consulta:",complexity:"Complejidad:",researchApproach:"Enfoque de Investigacin:",estimatedSources:"Fuentes Estimadas:",reasoning:"Razonamiento:",expertPersona:" Persona Experta",searchQueries:" Consultas de Bsqueda:",researchQuestions:" Preguntas de Investigacin:",suggestedSources:" Fuentes Sugeridas:",sources:"Fuentes:",variousRelevantSources:"Varias fuentes relevantes",researchMethodology:" Metodologa de Investigacin:",enhancedSystemPrompt:" Indicacin del Sistema Mejorada:",enhancedUserPrompt:" Indicacin de Usuario Mejorada:",debugRawLlmResponse:" Depurar: Campos de Respuesta Bruta del LLM",longFormDocumentPlan:" Plan de Documento de Formato Largo",longFormNote:"Nota: Esto se construir en etapas usando fragmentos. Cada seccin se investigar y escribir por separado, luego se combinar en un documento final.",documentStructure:" Estructura del Documento:",keywords:"Palabras Clave:",workflow:" Flujo de Trabajo:",needMoreInfo:" Se Necesita Ms Informacin",pleaseClarify:"Por favor aclara:",updateQueryDetails:"Actualiza tu consulta con ms detalles:",provideMoreDetails:"Proporciona detalles ms especficos...",regeneratePlanWithClarifications:"Regenerar Plan con Aclaraciones",moreInfoRequired:" Se Requiere Ms Informacin",planType:"Tipo de Plan:",detectedComplexityPatterns:" Patrones de Complejidad Detectados:",estimatedIterations:"Iteraciones Estimadas",toolsRequired:"Herramientas Requeridas",suggestedWorkflow:" Flujo de Trabajo Sugerido:",requiredTools:" Herramientas Requeridas:",guidanceQuestions:" Por favor responde estas preguntas para refinar tu plan:",updatePromptWithAnswers:"Actualiza tu indicacin de investigacin con las respuestas:",guidanceTip:" Consejo: Incluye las respuestas a las preguntas anteriores en tu consulta actualizada. Cuanto ms especfico seas, mejor podr la IA crear un plan de mltiples iteraciones efectivo con el uso apropiado de herramientas y ejemplos de pocos disparos.",guidanceExamplePlaceholder:`Ejemplo: Quiero construir un informe de investigacin completo sobre el cambio climtico:
1. Creando 25 tareas para diferentes subtemas (poltica, ciencia, economa, etc.)
2. Buscando en la web para cada tema y guardando los resultados en fragmentos
3. Generando grficos para visualizar puntos de datos clave
4. Combinando todos los fragmentos en un anlisis maestro

Por favor crea un plan detallado con ejemplos de pocos disparos que muestren cmo usar create_todo, search_web, create_snippet y generate_chart juntos en cada iteracin...`,generateDetailedExecutionPlan:" Generar Plan de Ejecucin Detallado",forcePlan:" Forzar Plan",forcePlanTooltip:"Deja que la IA responda las preguntas y fuerce la generacin del plan",reset:" Reiniciar",resetTooltip:"Limpiar modo de gua y volver al estado anterior",aboutGuidanceMode:"Acerca del Modo de Gua:",guidanceModeHelp:"Este modo detecta proyectos complejos que requieren mltiples iteraciones y uso extensivo de herramientas. Responde las preguntas anteriores para ayudar a crear un plan de ejecucin detallado con ejemplos de pocos disparos que muestren cmo usar tareas, fragmentos y mltiples llamadas de herramientas por iteracin.",forcingPlan:"Forzando generacin del plan...",forcePlanError:"Error al forzar el plan",forcePlanFailed:"Fall al forzar el plan",clarificationAnswer:"Por favor usa tu mejor criterio basndote en la consulta original."},E8={title:"Configuracin",language:"Idioma",selectLanguage:"Seleccionar Idioma",providers:"Proveedores",cloudSync:"Sincronizacin en la Nube",billing:"Facturacin",general:"General",generalDescription:"Configura ajustes generales de la aplicacin incluyendo idioma y preferencias de visualizacin",languageHelp:"Cambia el idioma de la interfaz e instruye a la IA para responder en tu idioma seleccionado",providerCredentials:"Credenciales de Proveedor",providerDescription:"Configura tus claves API de proveedor LLM. El backend selecciona automticamente el mejor modelo para cada solicitud",modelSelectionStrategy:"Estrategia de Seleccin de Modelo",modelStrategyDescription:"Elige cmo el sistema selecciona modelos para tus solicitudes. Esto equilibra costo, calidad y rendimiento",cheap:"Econmico (Recomendado)",cheapDescription:"Prioriza proveedores gratuitos (Groq, Gemini) y modelos ms pequeos capaces. Recurre a proveedores de pago solo cuando est limitado por tasa. Mejor para la mayora de los casos de uso",balanced:"Equilibrado",balancedDescription:"Elige modelos que hagan el trabajo de manera confiable sin comprometer la calidad. Usa nivel gratuito cuando la calidad es equivalente, modelos de pago cuando la calidad importa. Equilibra costo vs. capacidad",powerful:"Potente",powerfulDescription:"Usa los mejores modelos disponibles (GPT-4o, Gemini 2.5 Pro, o1) para mxima capacidad. Prioriza calidad sobre costo. Usa modelos de razonamiento para anlisis complejo",fastest:"Ms Rpido",fastestDescription:"Prioriza modelos de baja latencia (Groq) para respuestas rpidas. Puede sacrificar algo de calidad por velocidad en solicitudes simples. Excelente para sesiones interactivas",tavilyApiKey:"Clave API de Tavily (Opcional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Habilita bsqueda y extraccin web mejorada a travs de la API de Tavily. Recurre a DuckDuckGo si no se proporciona",enabledTools:"Herramientas Habilitadas",webSearch:"Bsqueda Web",webSearchDescription:"Busca en la web informacin actual, noticias y artculos",executeJs:"Ejecucin de JavaScript",executeJsDescription:"Ejecuta cdigo JavaScript para clculos y procesamiento de datos",scrapeUrl:"Extraccin Web",scrapeUrlDescription:"Extrae contenido de URLs y sitios web especficos",youtubeSearch:"Bsqueda en YouTube",youtubeDescription:"Busca videos en YouTube con soporte de transcripcin",transcribe:"Transcribir Audio/Video",transcribeDescription:"Convierte archivos de audio y video a transcripciones de texto",generateChart:"Generar Grficos",chartDescription:"Crea visualizaciones y grficos a partir de datos",generateImage:"Generar Imgenes",imageDescription:"Crea imgenes generadas por IA a partir de descripciones de texto",searchKnowledgeBase:"Buscar en Base de Conocimiento",ragDescription:"Busca en documentos cargados y base de conocimiento",manageTodos:"Gestionar Tareas",todosDescription:"Crea y gestiona listas de tareas y recordatorios",manageSnippets:"Gestionar Fragmentos",snippetsDescription:"Guarda y recupera fragmentos de cdigo y texto",askLlm:"Preguntar a LLM",askLlmDescription:"Delega sub-preguntas a otras instancias de LLM",generateReasoning:"Generar Cadena de Razonamiento",reasoningDescription:"Razonamiento analtico paso a paso para problemas complejos",proxySettings:"Configuracin de Proxy",proxyDescription:"Configura proxy HTTP/HTTPS para solicitudes web",enableProxy:"Habilitar Proxy",proxyUrl:"URL del Proxy",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Usuario (Opcional)",proxyPassword:"Contrasea (Opcional)",locationServices:"Servicios de Ubicacin",locationDescription:"Usa tu ubicacin para resultados de bsqueda localizados e informacin especfica de la regin",enableLocation:"Habilitar Servicios de Ubicacin",locationHelp:"Permite que las bsquedas web devuelvan resultados localmente relevantes",currentLocation:"Ubicacin Actual",requestLocation:"Solicitar Ubicacin",clearLocation:"Limpiar Ubicacin",locationPermission:"Permiso de Ubicacin",permissionGranted:"Concedido",permissionDenied:"Denegado",permissionPrompt:"No solicitado",tabs:{general:"General",provider:"Proveedor",cloud:"Sincronizacin en la Nube",tools:"Herramientas",proxy:"Proxy",location:"Ubicacin",voice:"Voz",tts:"TTS",rag:"RAG"},appearance:"Apariencia",theme:"Tema",darkMode:"Modo Oscuro",lightMode:"Modo Claro",notifications:"Notificaciones",privacy:"Privacidad",accessibility:"Accesibilidad",fontSize:"Tamao de Fuente",lineHeight:"Altura de Lnea"},_8={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},A8={title:"Panel de Facturacin",balance:"Saldo de Crdito",totalCost:"Costo Total",totalTokens:"Tokens Totales",totalRequests:"Solicitudes Totales",cost:"Costo",tokens:"Tokens",tokensIn:"Tokens Entrantes",tokensOut:"Tokens Salientes",timestamp:"Marca de Tiempo",noTransactions:"An no hay transacciones",creditsPurchased:"Crditos comprados exitosamente",insufficientCredits:"Crditos insuficientes",purchaseCredits:"Agregar Crdito",amount:"Monto",paymentMethod:"Mtodo de Pago",transactions:"Transacciones",overview:"Resumen",exportCSV:"Exportar CSV",clearData:"Limpiar Datos",clearDataConfirm:"Ests seguro de que quieres limpiar los datos de facturacin?",dataClearedSuccess:" xito: Se limpiaron {{count}} transacciones. {{remaining}} restantes.",dataClearError:" Error: {{message}}",noDataToExport:"No hay datos para exportar",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",type:"Tipo",provider:"Proveedor",model:"Modelo",duration:"Duracin",status:"Estado",allTypes:"Todos los Tipos",allProviders:"Todos los Proveedores",clearFilters:"Limpiar Filtros",quickRanges:"Rangos rpidos:",today:"Hoy",last7Days:"ltimos 7 Das",last30Days:"ltimos 30 Das",thisMonth:"Este Mes",byType:"Por Tipo",byProvider:"Por Proveedor",byModel:"Por Modelo",requests:"Solicitudes",groupByRequestId:" Agrupar por ID de Solicitud",itemsPerPage:"por pgina",totalRequestGroups:"{{count}} grupos de solicitudes totales (mostrando {{showing}}), {{ungrouped}} sin agrupar",totalTransactionsShowing:"{{total}} transacciones totales (mostrando {{showing}})",requestGroup:" Grupo de Solicitudes ({{count}} transacciones)",signInRequired:" Se Requiere Inicio de Sesin",signInToViewBilling:"Por favor inicia sesin con Google para ver tus datos de facturacin.",howToAccessBilling:" Cmo Acceder a los Datos de Facturacin:",signInStep1:'Haz clic en el botn "Iniciar sesin con Google" en la barra de navegacin superior',signInStep2:"Eso es todo! Tus datos de facturacin se cargarn automticamente",billingDataNote:" Tus datos de facturacin se almacenan en una Hoja de clculo de Google de cuenta de servicio centralizada y se recuperan automticamente. No se necesitan permisos adicionales ni acceso a Drive - solo inicia sesin con Google.",debugInfo:" Informacin de Depuracin",loading:"Cargando datos de facturacin...",errorLoading:" Error al Cargar Datos de Facturacin",retry:" Reintentar",noBillingData:"No hay datos de facturacin disponibles. Por favor espera...",noTransactionsMessage:"No se encontraron transacciones",noBillingDataYet:" An No Hay Datos de Facturacin",startUsingChat:"Comienza a usar el chat para generar registros de facturacin. Todo el uso de API se rastrea automticamente.",refresh:" Actualizar",usageOnly:"Solo uso (excl. crditos)",totalCredits:"Crditos Totales",userQueries:"Consultas de Usuario",llmCalls:"Llamadas LLM",userQueriesLlmCalls:"Consultas de Usuario / Llamadas LLM",newBalance:"Nuevo saldo:",creditsToAdd:"Crditos a agregar:",minimumPurchase:"La compra mnima es $5.00",addCreditsTitle:" Agregar Crditos",purchaseCreditsDescription:"Compra crditos para usar funciones de IA. Compra mnima: $5.00",enterAmount:"Ingresa el monto (mn $5.00)",tipUseOwnKeys:" Consejo: Agrega tus propias claves API en Configuracin para costos LLM de $0! Solo se aplican costos de infraestructura cuando usas tus propias claves.",loadingPayPal:"Cargando PayPal...",paypalNotLoaded:" SDK de PayPal no cargado. Por favor actualiza la pgina.",close:"Cerrar",clearBillingData:"Limpiar Datos de Facturacin",clearDataWarning:" Advertencia: Esta accin no se puede deshacer. Tus datos de facturacin se eliminarn permanentemente.",clearAll:"Limpiar Todo",clearByProvider:"Limpiar por Proveedor",clearByDateRange:"Limpiar por Rango de Fechas",clearAllDescription:"Esto eliminar todas las transacciones de tu hoja de facturacin.",considerExportFirst:"Considera exportar a CSV primero para tus registros.",selectProvider:"Seleccionar Proveedor:",selectProviderPlaceholder:"-- Seleccionar Proveedor --",clearProviderHint:"til para alinearse con los ciclos de facturacin del proveedor (ej., limpiar mensualmente).",clearDateRangeHint:"Dejar en blanco para limpiar desde el principio/hasta el final. Ambos pueden usarse juntos.",confirmUndoCheckbox:"Entiendo que esta accin no se puede deshacer",cancel:"Cancelar",page:"Pgina",of:"de",first:" Primera",prev:" Anterior",next:"Siguiente ",last:"ltima ",types:{chat:"Chat",embedding:"Incrustacin",guardrail_input:" Entrada de Guardarral",guardrail_output:" Salida de Guardarral",planning:"Planificacin",assessment:"Evaluacin",image_generation:" Generacin de Imagen",tts:" Texto a Voz",chat_iteration:"Iteracin de Chat",credit_added:"Crdito Agregado",summary:"Resumen",lambda_invocation:"Invocacin Lambda"}},N8={generic:"Ocurri un error",network:"Error de red",timeout:"Tiempo de espera agotado",unauthorized:"Acceso no autorizado",forbidden:"Acceso prohibido",notFound:"Recurso no encontrado",serverError:"Error del servidor",validationError:"Error de validacin",tryAgain:"Por favor intenta nuevamente"},P8={title:"Base de Conocimiento",newSnippet:"Nuevo Fragmento",editSnippet:"Editar Fragmento",deleteSnippet:"Eliminar Fragmento",searchSnippets:"Buscar fragmentos...",noSnippets:"No se encontraron fragmentos",tags:"Etiquetas",addTag:"Agregar Etiqueta",removeTag:"Eliminar Etiqueta",filterByTag:"Filtrar por Etiqueta",content:"Contenido",created:"Creado",modified:"Modificado",source:"Fuente"},I8={readAloud:"Leer en Voz Alta",stopReading:"Detener Lectura",pauseReading:"Pausar Lectura",resumeReading:"Reanudar Lectura",voice:"Voz",speed:"Velocidad",volume:"Volumen",provider:"Proveedor de TTS"},R8={title:"Lista de Reproduccin",addToPlaylist:"Agregar a Lista de Reproduccin",removeFromPlaylist:"Eliminar de Lista de Reproduccin",playNext:"Reproducir Siguiente",playNow:"Reproducir Ahora",clearPlaylist:"Limpiar Lista de Reproduccin",emptyPlaylist:"La lista de reproduccin est vaca"},D8={search:"Bsqueda Web",scrape:"Extraer Contenido",transcribe:"Transcribir",youtube:"YouTube",javascript:"Ejecutar JavaScript",generateChart:"Generar Grfico",generateImage:"Generar Imagen"},L8={title:"Feed",generateFeed:"Generar Feed",generating:"Generando...",refresh:"Actualizar",noItems:"An no hay elementos",emptyMessage:"Tu feed personalizado aparecer aqu",emptySubMessage:"Generaremos contenido basado en tus fragmentos guardados e intereses",didYouKnow:"Sabas que",questionAnswer:"Pregunta y Respuesta",stash:"Guardar",stashed:"Guardado",trash:"Eliminar",quiz:"Cuestionario",swipeLeft:"Desliza a la izquierda para eliminar",swipeRight:"Desliza a la derecha para guardar",showMore:"Mostrar ms",showLess:"Mostrar menos",sources:"Fuentes",topics:"Temas",settings:{title:"Configuracin del Feed",searchTerms:"Trminos de Bsqueda",searchTermsDesc:"Define hasta 5 temas de bsqueda para personalizar tu feed",addTerm:"Agregar Trmino",removeTerm:"Eliminar",maxTerms:"Mximo 5 trminos de bsqueda permitidos",termExists:"Este trmino de bsqueda ya existe",placeholder:"ej. 'inteligencia artificial', 'noticias climticas'",learnedPreferences:"Preferencias Aprendidas",likedTopics:"Temas Favoritos",dislikedTopics:"Temas No Deseados",stashToLearn:"Guarda elementos para ayudar al feed a aprender lo que te gusta",trashToLearn:"Elimina elementos para ayudar al feed a aprender qu evitar",tips:" Consejos para Mejores Feeds",tipSpecific:"S especfico con los trminos de bsqueda",tipStash:"Guarda elementos que encuentres interesantes",tipTrash:"Elimina elementos irrelevantes para mejorar la calidad",tipMix:"Mezcla temas amplios y especficos para variedad"}},M8={title:"Cuestionario",subtitle:"Sigue tu progreso de aprendizaje y rendimiento en cuestionarios",startQuiz:"Iniciar Cuestionario",nextQuestion:"Siguiente Pregunta",previousQuestion:"Anterior",submitAnswer:"Enviar Respuesta",viewResults:"Ver Resultados",retakeQuiz:"Repetir Cuestionario",score:"Puntuacin",correct:"Correcto",incorrect:"Incorrecto",question:"Pregunta",of:"de",yourAnswer:"Tu respuesta",correctAnswer:"Respuesta correcta",explanation:"Explicacin",generating:"Generando cuestionario...",noQuizzes:"An no hay cuestionarios",emptyMessage:"Genera un cuestionario desde cualquier fragmento guardado o elemento del feed",performance:"Rendimiento del Cuestionario",totalQuizzes:"Total de Cuestionarios",averageScore:"Puntuacin Promedio",questionsAnswered:"Preguntas Respondidas",statistics:"Estadsticas del Cuestionario",createNewQuiz:"Crear Nuevo Cuestionario",recentQuizzes:"Cuestionarios Recientes",noQuizzesYet:"An no hay cuestionarios completados",noQuizzesDescription:"Realiza un cuestionario desde tu contenido guardado en SWAG para ver tus estadsticas aqu",goToSwag:"Ir a SWAG",backToChat:"Volver al Chat",loadingStats:"Cargando estadsticas...",errorLoadingStats:"Error al cargar estadsticas del cuestionario",confirmDelete:"Ests seguro de que quieres eliminar el cuestionario '{{title}}'?",quizDeleted:"Cuestionario eliminado exitosamente",errorDeletingQuiz:"Error al eliminar el cuestionario",deleteQuiz:"Eliminar cuestionario",today:"Hoy",yesterday:"Ayer",daysAgo:"Hace {{days}} das",snippetCount:"{{count}} fragmento",snippetCount_plural:"{{count}} fragmentos",enriched:"Enriquecido",notSynced:"No Sincronizado",highestScore:"Puntuacin Ms Alta",lowestScore:"Puntuacin Ms Baja"},O8={common:S8,auth:k8,chat:T8,planning:C8,settings:E8,languages:_8,billing:A8,errors:N8,swag:P8,tts:I8,playlist:R8,tools:D8,feed:L8,quiz:M8},j8={save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",edit:"Modifier",close:"Fermer",loading:"Chargement...",error:"Erreur",success:"Succs",confirm:"Confirmer",back:"Retour",next:"Suivant",submit:"Soumettre",clear:"Effacer",search:"Rechercher",filter:"Filtrer",export:"Exporter",import:"Importer",download:"Tlcharger",upload:"Tlverser",copy:"Copier",paste:"Coller",cut:"Couper",undo:"Annuler",redo:"Refaire",select:"Slectionner",selectAll:"Tout slectionner",deselectAll:"Tout dslectionner"},B8={signIn:"Se connecter avec Google",signInWithGoogle:"Se connecter avec Google",initializing:"Initialisation...",signOut:"Se dconnecter",authRequired:"L'authentification est requise pour utiliser cette application",tokenExpired:"Votre session a expir. Veuillez vous reconnecter.",welcomeBack:"Content de vous revoir !",signInPrompt:"Se connecter pour continuer",signInRequired:"Vous devez vous connecter pour utiliser cette fonctionnalit",signingIn:"Connexion...",signingOut:"Dconnexion...",researchAgent:"Agent de Recherche",tagline:"Assistant de recherche aliment par l'IA",secureAuth:"Authentification scurise par Google",whyChooseTitle:"Pourquoi choisir Research Agent ?",whyChooseIntro:"Contrairement aux chatbots IA standards qui rpondent simplement aux questions, Research Agent est votre compagnon de recherche complet conu pour l'investigation approfondie et la construction de connaissances.",keyAdvantagesTitle:"Avantages Cls :",webConnected:"Intelligence Connecte au Web",webConnectedDesc:"La recherche web en temps rel et l'extraction de contenu garantissent des informations actuelles et prcises, pas des donnes d'entranement obsoltes",multiTool:"Orchestration Multi-Outils",multiToolDesc:"Combine de manire transparente la recherche web, l'excution de code, les transcriptions YouTube, la gnration d'images et l'analyse de documents dans une seule conversation",knowledgeBase:"Intgration de Base de Connaissances",knowledgeBaseDesc:"Sauvegardez les dcouvertes dans votre base de connaissances personnelle, crez des extraits et construisez des documents de recherche complets au fil du temps",advancedPlanning:"Planification Avance",advancedPlanningDesc:"Gnrez des plans de recherche structurs avec des personas experts, des stratgies de recherche et des approches mthodologiques",costEffective:"Slection Intelligente de Modles",costEffectiveDesc:"Slection automatique de modles qui font le travail de manire conomique ou puissante selon la stratgie de slection. Apportez vos propres cls pour conomiser 25%",transparency:"Transparence Totale",transparencyDesc:"Suivez chaque appel API, utilisation de jetons et cot dans le tableau de bord de facturation en temps rel",perfectFor:"Parfait pour : Recherche acadmique, analyse de march, cration de contenu, documentation technique, veille concurrentielle et toute tche ncessitant une investigation approfondie."},F8={placeholder:"Tapez votre message ici...",send:"Envoyer",retry:"Ressayer",stop:"Arrter",thinking:"Rflexion...",generating:"Gnration de la rponse...",newChat:"Nouveau Chat",clearHistory:"Effacer l'historique",loadChat:"Charger le chat",systemPrompt:"Instruction systme",customInstructions:"Instructions personnalises",temperature:"Temprature",maxTokens:"Tokens maximum",model:"Modle",provider:"Fournisseur",history:"Historique du chat",continue:"Continuer",regenerate:"Rgnrer",edit:"Modifier",delete:"Supprimer",copy:"Copier",copied:"Copi !",selectFiles:"Slectionner des fichiers",attachFiles:"Joindre des fichiers",pasteImage:"Coller une image",recording:"Enregistrement...",voiceInput:"Entre vocale",stopRecording:"Arrter l'enregistrement",processing:"Traitement...",noMessages:"Aucun message pour le moment. Commencez une conversation !",clearConfirm:"tes-vous sr de vouloir effacer tous les messages ?",deleteConfirm:"tes-vous sr de vouloir supprimer ce message ?",loadingHistory:"Chargement de l'historique du chat...",savingChat:"Enregistrement du chat...",chatSaved:"Chat enregistr avec succs",chatLoaded:"Chat charg avec succs",errorSaving:"Erreur lors de l'enregistrement du chat",errorLoading:"Erreur lors du chargement du chat",signInRequired:"Veuillez vous connecter pour utiliser cette fonctionnalit",providerRequired:"Veuillez configurer au moins un fournisseur dans les paramtres",messageError:"Erreur lors de l'envoi du message",streamError:"Erreur dans le flux du message",toolExecution:"Excution de l'outil...",toolExecuted:"Outil excut avec succs",toolError:"Erreur d'excution de l'outil",searchingWeb:"Recherche sur le web...",scrapingContent:"Extraction du contenu...",transcribingAudio:"Transcription de l'audio...",generatingImage:"Gnration de l'image...",generatingChart:"Gnration du graphique...",executingCode:"Excution du code...",planningMode:"Mode planification",exitPlanning:"Quitter la planification",startPlanning:"Dmarrer la planification",mcpServers:"Serveurs MCP",addMCPServer:"Ajouter un serveur MCP",mcpServerName:"Nombre del Servidor",mcpServerUrl:"URL del Servidor",exampleServers:"Servidores de Ejemplo",officialServers:"Servidores MCP Oficiales",sampleServers:"Servidores de Muestra",instructions:"Instrucciones",availableTools:"Herramientas Disponibles",enableServer:"Habilitar Servidor",disableServer:"Deshabilitar Servidor",removeServer:"Eliminar Servidor",serverAdded:"Servidor agregado exitosamente",serverRemoved:"Servidor eliminado exitosamente",invalidUrl:"Formato de URL invlido",nameRequired:"Se requiere el nombre del servidor",urlRequired:"Se requiere la URL del servidor",chatHistory:"Historique du chat",examples:"Ejemplos",attachContext:"Adjuntar Contexto",attachContextTooltip:"Adjunta fragmentos de la base de conocimiento como contexto para esta conversacin",searchProvider:"Proveedor de Bsqueda:",functionCall:"Llamada de Funcin:",code:"Cdigo:",arguments:"Argumentos:",callId:"ID de Llamada:",result:"Resultado:",url:"URL:",viewRawHtml:"Ver HTML sin procesar sin comprimir",copyOutputToClipboard:"Copiar salida al portapapeles",copyCodeToClipboard:"Copiar cdigo al portapapeles",captureToSwag:"Capturar a Swag",captureOutputToSwag:"Capturar salida a Swag",captureCodeToSwag:"Capturar cdigo a Swag",grabImage:"Capturar imagen",noSummarization:"Sin resumen",usingProxy:"Usando proxy para mayor privacidad y evasin de deteccin de bots",contentExtracted:"Contenido extrado inteligentemente",truncatedToFit:"Truncado para ajustarse al modelo",scrapeMethod:"Mtodo de Extraccin:",tier:"Nivel",scrapeTime:"Tiempo de Extraccin:",totalTime:"Tiempo Total:",format:"Formato:",originalSize:"Tamao Original:",compressedSize:"Tamao Comprimido:",compression:"Compresin:",compressionStrategy:"Estrategia de Compresin:",basicExtraction:"Extraccin bsica",rawHtml:"HTML Sin Procesar ({{count}} caracteres)",rawText:"Texto Sin Procesar ({{count}} caracteres)",contentProcessingPipeline:"Pipeline de Procesamiento de Contenido:",size:"Tamao:",titlePrompt:"Ttulo/Indicacin",finalPrompt:"Indicacin Final",deleteChat:"Eliminar Chat",clearAllChats:"Limpiar Todos los Chats",confirmClearAll:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDelete:"Ests seguro de que quieres eliminar este chat?",noChatsYet:"No hay chats an",startChatting:"Comienza a chatear para ver el historial aqu",chatDeleted:"Chat eliminado",allChatsCleared:"Todos los chats limpiados",chatTitle:"Ttulo del Chat",enterChatTitle:"Ingresa un ttulo para este chat...",signInToChat:"Por favor inicia sesin para comenzar a chatear",streamingResponse:"Respuesta en transmisin...",imageAddedToSwag:"Imagen agregada a Swag!",imageAddedWithoutConversion:"Imagen agregada a Swag (sin conversin)!",contentCapturedToSwag:"Contenido capturado a Swag!",contentCapturedWithoutConversion:"Contenido capturado a Swag (sin conversin de imagen)!",planningTransferred:"Indicaciones de planificacin transferidas a nuevo chat",failedToTransfer:"Error al transferir datos de planificacin",addedToPlaylist:"{{count}} video{{plural}} agregado{{plural}} a la lista de reproduccin",transcriptionStopped:"Transcripcin detenida",failedToStopTranscription:"Error al detener la transcripcin: {{error}}",fileTypeNotSupported:"Tipo de archivo no compatible: {{name}}. Tipos compatibles: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"Archivo demasiado grande: {{name}} ({{size}}MB). Tamao mximo: {{maxSize}}MB",imageTokenWarning:"La imagen {{name}} puede usar muchos tokens (~{{tokens}}k). Considera usar una imagen ms pequea.",fileAdded:"{{name}} agregado",failedToProcess:"Error al procesar {{name}}",signInToSendMessages:"Por favor inicia sesin para enviar mensajes",foundRelevantChunks:" Se encontraron {{count}} fragmentos relevantes de la base de conocimiento",noRelevantContext:"No se encontr contexto relevante en la base de conocimiento",failedToRetrieveRag:"Error al recuperar el contexto RAG, continuando sin l",sessionExpired:"Tu sesin ha expirado. Por favor inicia sesin nuevamente.",todoLimitReached:"Lmite de progresin automtica de tareas alcanzado. Por favor contina manualmente.",snippetSaved:"Fragmento guardado: {{title}}",snippetDeleted:"Fragmento eliminado: {{title}}",copiedToClipboard:"Copiado al portapapeles!",outputCopied:"Salida copiada al portapapeles!",codeCopied:"Cdigo copiado al portapapeles!",inputPlaceholder:"Escribe tu mensaje... (Shift+Enter para nueva lnea,  para historial)",continueProcessing:"Continuar Procesamiento",stopGenerating:"Detener generacin de respuesta",sendMessage:"Enviar mensaje",chatMessageInput:"Entrada de mensaje de chat",editPlan:"Editar Plan",makeAPlan:"Hacer un Plan",close:"Cerrar",failedToLoadChat:"Erreur lors du chargement du chat",mcpServerNamePlaceholder:"Nombre del Servidor (ej., filesystem, github)",mcpServerUrlPlaceholder:"URL del Servidor (ej., http://localhost:3000)",noMcpServers:"No hay servidores MCP configurados",addServer:"Agregar Servidor",remove:"Supprimer",chatHistoryTitle:"Historique du chat",noChatHistory:"No se encontr historial de chat. Inicia una conversacin para guardarla automticamente.",allChatHistoryCleared:"Todo el historial de chat limpiado",loadChatSuccess:"Chat charg avec succs",examplesTitle:"Ejemplos de Chat",tryExample:"Prueba este ejemplo",attachContextTitle:"Adjuntar Contexto de Swag",snippetsAttached:"{{count}} fragmento{{plural}} adjunto{{plural}}",attachSnippets:"Adjuntar Fragmentos",searchSnippets:"Buscar fragmentos...",selectAll:"Tout slectionner",selectNone:"Seleccionar Ninguno",deleteSelected:"Eliminar Seleccionados",cancel:"Cancelar",load:"Cargar",confirmDeleteChat:"Ests seguro de que quieres eliminar este chat?",confirmClearHistory:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDeleteSelected:"Ests seguro de que quieres eliminar {{count}} chat{{plural}} seleccionado{{plural}}?",chatLoadedFrom:"Cargado desde",chatSavedAt:"Guardado en",noTitle:"Sin ttulo",clearAttachedSnippets:"Limpiar todos los fragmentos adjuntos",mcpServerConfiguration:"Configuracin del Servidor MCP",typeMessageFirst:"Escribe un mensaje primero",typeMessage:"Escribe un mensaje",signInToSend:"Por favor inicia sesin para enviar mensajes"},z8={title:"Planification de la Recherche",query:"Consulta de Investigacin",generatePlan:"Gnrer un Plan",savePlan:"Guardar Plan",loadSaved:"Cargar Guardado",transferToChat:"Transferir al Chat",clearAll:"Limpiar Todo",debug:"Depurar",planning:"Planificando...",planGenerated:"Plan generado exitosamente",noPlan:"An no se ha generado ningn plan",enterQuery:"Ingresa tu consulta o tema de investigacin...",researchFocus:"Enfoque de Investigacin",methodology:"Metodologa",expectedOutcome:"Resultado Esperado",initializing:"Inicializando...",processing:"Traitement...",signInToGenerate:"Inicia sesin para Generar Plan",generating:"Generando...",signInToUsePlanning:"Por favor inicia sesin para usar la planificacin",signInRequired:"Por favor inicia sesin con Google para usar la funcin de planificacin",authExpired:"Autenticacin expirada. Por favor cierra sesin e inicia sesin nuevamente para continuar.",authRequired:"Se requiere autenticacin. Por favor inicia sesin con Google para continuar.",enterResearchQuestion:"Por favor ingresa una pregunta de investigacin",debugCopied:"Informacin de depuracin copiada al portapapeles!",debugCopyFailed:"Error al copiar informacin de depuracin",savePlanTooltip:"Guarda el plan actual en tu lista de planes guardados",loadSavedPlans:"Cargar Planes Guardados",debugTooltip:"Copiar informacin de depuracin para solucin de problemas de Copilot",transferTooltip:"Transferir al Chat",clearAllTooltip:"Limpiar todos los datos de planificacin y comenzar de nuevo",systemPromptEditable:"Indicacin del Sistema Generada (Editable):",systemPromptHelp:"Esto define el rol y comportamiento de la IA. Edtalo segn sea necesario antes de transferir al chat.",userQueryEditable:"Consulta de Usuario Generada (Editable):",userQueryHelp:"Este es el mensaje que se enviar al chat. Edtalo para refinar tu consulta.",generatedPrompts:"Indicaciones Generadas",llmInfoTooltip:"Ver informacin de transparencia del LLM (modelo, tokens, costo)",llmCalls:"llamada",llmCallsPlural:"llamadas",cannotSavePlan:"No se puede guardar el plan: No se gener un plan vlido",planSavedSuccess:"Plan guardado exitosamente",planSaveFailed:"Error al guardar el plan",loadSavedPlan:"Cargar Plan Guardado",storage:"Almacenamiento",storageWarning:"El almacenamiento est al {{percentage}}% de su capacidad",storageWarningHelp:"Considera eliminar planes antiguos para liberar espacio.",noSavedPlans:"No se encontraron planes guardados",saved:"Guardado",load:"Cargar",simpleQueryDetected:"Consulta Simple Detectada",simpleQueryHelp:"Esta consulta puede responderse directamente sin planificacin extensa.",comprehensiveResearchPlan:" Plan de Investigacin Completo",analysisSummary:" Resumen del Anlisis",queryType:"Tipo de Consulta:",complexity:"Complejidad:",researchApproach:"Enfoque de Investigacin:",estimatedSources:"Fuentes Estimadas:",reasoning:"Razonamiento:",expertPersona:" Persona Experta",searchQueries:" Consultas de Bsqueda:",researchQuestions:" Preguntas de Investigacin:",suggestedSources:" Fuentes Sugeridas:",sources:"Fuentes:",variousRelevantSources:"Varias fuentes relevantes",researchMethodology:" Metodologa de Investigacin:",enhancedSystemPrompt:" Indicacin del Sistema Mejorada:",enhancedUserPrompt:" Indicacin de Usuario Mejorada:",debugRawLlmResponse:" Depurar: Campos de Respuesta Bruta del LLM",longFormDocumentPlan:" Plan de Documento de Formato Largo",longFormNote:"Nota: Esto se construir en etapas usando fragmentos. Cada seccin se investigar y escribir por separado, luego se combinar en un documento final.",documentStructure:" Estructura del Documento:",keywords:"Palabras Clave:",workflow:" Flujo de Trabajo:",needMoreInfo:" Se Necesita Ms Informacin",pleaseClarify:"Por favor aclara:",updateQueryDetails:"Actualiza tu consulta con ms detalles:",provideMoreDetails:"Proporciona detalles ms especficos...",regeneratePlanWithClarifications:"Regenerar Plan con Aclaraciones",moreInfoRequired:" Se Requiere Ms Informacin",planType:"Tipo de Plan:",detectedComplexityPatterns:" Patrones de Complejidad Detectados:",estimatedIterations:"Iteraciones Estimadas",toolsRequired:"Herramientas Requeridas",suggestedWorkflow:" Flujo de Trabajo Sugerido:",requiredTools:" Herramientas Requeridas:",guidanceQuestions:" Por favor responde estas preguntas para refinar tu plan:",updatePromptWithAnswers:"Actualiza tu indicacin de investigacin con las respuestas:",guidanceTip:" Consejo: Incluye las respuestas a las preguntas anteriores en tu consulta actualizada. Cuanto ms especfico seas, mejor podr la IA crear un plan de mltiples iteraciones efectivo con el uso apropiado de herramientas y ejemplos de pocos disparos.",guidanceExamplePlaceholder:`Ejemplo: Quiero construir un informe de investigacin completo sobre el cambio climtico:
1. Creando 25 tareas para diferentes subtemas (poltica, ciencia, economa, etc.)
2. Buscando en la web para cada tema y guardando los resultados en fragmentos
3. Generando grficos para visualizar puntos de datos clave
4. Combinando todos los fragmentos en un anlisis maestro

Por favor crea un plan detallado con ejemplos de pocos disparos que muestren cmo usar create_todo, search_web, create_snippet y generate_chart juntos en cada iteracin...`,generateDetailedExecutionPlan:" Generar Plan de Ejecucin Detallado",forcePlan:" Forzar Plan",forcePlanTooltip:"Deja que la IA responda las preguntas y fuerce la generacin del plan",reset:" Reiniciar",resetTooltip:"Limpiar modo de gua y volver al estado anterior",aboutGuidanceMode:"Acerca del Modo de Gua:",guidanceModeHelp:"Este modo detecta proyectos complejos que requieren mltiples iteraciones y uso extensivo de herramientas. Responde las preguntas anteriores para ayudar a crear un plan de ejecucin detallado con ejemplos de pocos disparos que muestren cmo usar tareas, fragmentos y mltiples llamadas de herramientas por iteracin.",forcingPlan:"Forzando generacin del plan...",forcePlanError:"Error al forzar el plan",forcePlanFailed:"Fall al forzar el plan",clarificationAnswer:"Por favor usa tu mejor criterio basndote en la consulta original."},$8={title:"Paramtres",language:"Langue",selectLanguage:"Slectionner la Langue",providers:"Proveedores",cloudSync:"Sincronizacin en la Nube",billing:"Facturacin",general:"General",generalDescription:"Configura ajustes generales de la aplicacin incluyendo idioma y preferencias de visualizacin",languageHelp:"Cambia el idioma de la interfaz e instruye a la IA para responder en tu idioma seleccionado",providerCredentials:"Credenciales de Proveedor",providerDescription:"Configura tus claves API de proveedor LLM. El backend selecciona automticamente el mejor modelo para cada solicitud",modelSelectionStrategy:"Estrategia de Seleccin de Modelo",modelStrategyDescription:"Elige cmo el sistema selecciona modelos para tus solicitudes. Esto equilibra costo, calidad y rendimiento",cheap:"Econmico (Recomendado)",cheapDescription:"Prioriza proveedores gratuitos (Groq, Gemini) y modelos ms pequeos capaces. Recurre a proveedores de pago solo cuando est limitado por tasa. Mejor para la mayora de los casos de uso",balanced:"Equilibrado",balancedDescription:"Elige modelos que hagan el trabajo de manera confiable sin comprometer la calidad. Usa nivel gratuito cuando la calidad es equivalente, modelos de pago cuando la calidad importa. Equilibra costo vs. capacidad",powerful:"Potente",powerfulDescription:"Usa los mejores modelos disponibles (GPT-4o, Gemini 2.5 Pro, o1) para mxima capacidad. Prioriza calidad sobre costo. Usa modelos de razonamiento para anlisis complejo",fastest:"Ms Rpido",fastestDescription:"Prioriza modelos de baja latencia (Groq) para respuestas rpidas. Puede sacrificar algo de calidad por velocidad en solicitudes simples. Excelente para sesiones interactivas",tavilyApiKey:"Clave API de Tavily (Opcional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Habilita bsqueda y extraccin web mejorada a travs de la API de Tavily. Recurre a DuckDuckGo si no se proporciona",enabledTools:"Herramientas Habilitadas",webSearch:"Bsqueda Web",webSearchDescription:"Busca en la web informacin actual, noticias y artculos",executeJs:"Ejecucin de JavaScript",executeJsDescription:"Ejecuta cdigo JavaScript para clculos y procesamiento de datos",scrapeUrl:"Extraccin Web",scrapeUrlDescription:"Extrae contenido de URLs y sitios web especficos",youtubeSearch:"Bsqueda en YouTube",youtubeDescription:"Busca videos en YouTube con soporte de transcripcin",transcribe:"Transcribir Audio/Video",transcribeDescription:"Convierte archivos de audio y video a transcripciones de texto",generateChart:"Generar Grficos",chartDescription:"Crea visualizaciones y grficos a partir de datos",generateImage:"Generar Imgenes",imageDescription:"Crea imgenes generadas por IA a partir de descripciones de texto",searchKnowledgeBase:"Buscar en Base de Conocimiento",ragDescription:"Busca en documentos cargados y base de conocimiento",manageTodos:"Gestionar Tareas",todosDescription:"Crea y gestiona listas de tareas y recordatorios",manageSnippets:"Gestionar Fragmentos",snippetsDescription:"Guarda y recupera fragmentos de cdigo y texto",askLlm:"Preguntar a LLM",askLlmDescription:"Delega sub-preguntas a otras instancias de LLM",generateReasoning:"Generar Cadena de Razonamiento",reasoningDescription:"Razonamiento analtico paso a paso para problemas complejos",proxySettings:"Configuracin de Proxy",proxyDescription:"Configura proxy HTTP/HTTPS para solicitudes web",enableProxy:"Habilitar Proxy",proxyUrl:"URL del Proxy",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Usuario (Opcional)",proxyPassword:"Contrasea (Opcional)",locationServices:"Servicios de Ubicacin",locationDescription:"Usa tu ubicacin para resultados de bsqueda localizados e informacin especfica de la regin",enableLocation:"Habilitar Servicios de Ubicacin",locationHelp:"Permite que las bsquedas web devuelvan resultados localmente relevantes",currentLocation:"Ubicacin Actual",requestLocation:"Solicitar Ubicacin",clearLocation:"Limpiar Ubicacin",locationPermission:"Permiso de Ubicacin",permissionGranted:"Concedido",permissionDenied:"Denegado",permissionPrompt:"No solicitado",tabs:{general:"General",provider:"Fournisseur",cloud:"Sincronizacin en la Nube",tools:"Herramientas",proxy:"Proxy",location:"Ubicacin",voice:"Voix",tts:"TTS",rag:"RAG"},appearance:"Apariencia",theme:"Tema",darkMode:"Modo Oscuro",lightMode:"Modo Claro",notifications:"Notificaciones",privacy:"Privacidad",accessibility:"Accesibilidad",fontSize:"Tamao de Fuente",lineHeight:"Altura de Lnea"},U8={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},q8={title:"Panel de Facturacin",balance:"Saldo de Crdito",totalCost:"Costo Total",totalTokens:"Tokens Totales",totalRequests:"Solicitudes Totales",cost:"Costo",tokens:"Tokens",tokensIn:"Tokens Entrantes",tokensOut:"Tokens Salientes",timestamp:"Marca de Tiempo",noTransactions:"An no hay transacciones",creditsPurchased:"Crditos comprados exitosamente",insufficientCredits:"Crditos insuficientes",purchaseCredits:"Agregar Crdito",amount:"Monto",paymentMethod:"Mtodo de Pago",transactions:"Transacciones",overview:"Resumen",exportCSV:"Exportar CSV",clearData:"Limpiar Datos",clearDataConfirm:"Ests seguro de que quieres limpiar los datos de facturacin?",dataClearedSuccess:" xito: Se limpiaron {{count}} transacciones. {{remaining}} restantes.",dataClearError:" Error: {{message}}",noDataToExport:"No hay datos para exportar",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",type:"Tipo",provider:"Fournisseur",model:"Modle",duration:"Duracin",status:"Estado",allTypes:"Todos los Tipos",allProviders:"Todos los Proveedores",clearFilters:"Limpiar Filtros",quickRanges:"Rangos rpidos:",today:"Hoy",last7Days:"ltimos 7 Das",last30Days:"ltimos 30 Das",thisMonth:"Este Mes",byType:"Por Tipo",byProvider:"Por Proveedor",byModel:"Por Modelo",requests:"Solicitudes",groupByRequestId:" Agrupar por ID de Solicitud",itemsPerPage:"por pgina",totalRequestGroups:"{{count}} grupos de solicitudes totales (mostrando {{showing}}), {{ungrouped}} sin agrupar",totalTransactionsShowing:"{{total}} transacciones totales (mostrando {{showing}})",requestGroup:" Grupo de Solicitudes ({{count}} transacciones)",signInRequired:" Se Requiere Inicio de Sesin",signInToViewBilling:"Por favor inicia sesin con Google para ver tus datos de facturacin.",howToAccessBilling:" Cmo Acceder a los Datos de Facturacin:",signInStep1:'Haz clic en el botn "Iniciar sesin con Google" en la barra de navegacin superior',signInStep2:"Eso es todo! Tus datos de facturacin se cargarn automticamente",billingDataNote:" Tus datos de facturacin se almacenan en una Hoja de clculo de Google de cuenta de servicio centralizada y se recuperan automticamente. No se necesitan permisos adicionales ni acceso a Drive - solo inicia sesin con Google.",debugInfo:" Informacin de Depuracin",loading:"Cargando datos de facturacin...",errorLoading:" Error al Cargar Datos de Facturacin",retry:" Reintentar",noBillingData:"No hay datos de facturacin disponibles. Por favor espera...",noTransactionsMessage:"No se encontraron transacciones",noBillingDataYet:" An No Hay Datos de Facturacin",startUsingChat:"Comienza a usar el chat para generar registros de facturacin. Todo el uso de API se rastrea automticamente.",refresh:" Actualizar",usageOnly:"Solo uso (excl. crditos)",totalCredits:"Crditos Totales",userQueries:"Consultas de Usuario",llmCalls:"Llamadas LLM",userQueriesLlmCalls:"Consultas de Usuario / Llamadas LLM",newBalance:"Nuevo saldo:",creditsToAdd:"Crditos a agregar:",minimumPurchase:"La compra mnima es $5.00",addCreditsTitle:" Agregar Crditos",purchaseCreditsDescription:"Compra crditos para usar funciones de IA. Compra mnima: $5.00",enterAmount:"Ingresa el monto (mn $5.00)",tipUseOwnKeys:" Consejo: Agrega tus propias claves API en Configuracin para costos LLM de $0! Solo se aplican costos de infraestructura cuando usas tus propias claves.",loadingPayPal:"Cargando PayPal...",paypalNotLoaded:" SDK de PayPal no cargado. Por favor actualiza la pgina.",close:"Cerrar",clearBillingData:"Limpiar Datos de Facturacin",clearDataWarning:" Advertencia: Esta accin no se puede deshacer. Tus datos de facturacin se eliminarn permanentemente.",clearAll:"Limpiar Todo",clearByProvider:"Limpiar por Proveedor",clearByDateRange:"Limpiar por Rango de Fechas",clearAllDescription:"Esto eliminar todas las transacciones de tu hoja de facturacin.",considerExportFirst:"Considera exportar a CSV primero para tus registros.",selectProvider:"Seleccionar Proveedor:",selectProviderPlaceholder:"-- Seleccionar Proveedor --",clearProviderHint:"til para alinearse con los ciclos de facturacin del proveedor (ej., limpiar mensualmente).",clearDateRangeHint:"Dejar en blanco para limpiar desde el principio/hasta el final. Ambos pueden usarse juntos.",confirmUndoCheckbox:"Entiendo que esta accin no se puede deshacer",cancel:"Cancelar",page:"Pgina",of:"de",first:" Primera",prev:" Anterior",next:"Siguiente ",last:"ltima ",types:{chat:"Chat",embedding:"Incrustacin",guardrail_input:" Entrada de Guardarral",guardrail_output:" Salida de Guardarral",planning:"Planificacin",assessment:"Evaluacin",image_generation:" Generacin de Imagen",tts:" Texto a Voz",chat_iteration:"Iteracin de Chat",credit_added:"Crdito Agregado",summary:"Resumen",lambda_invocation:"Invocacin Lambda"}},H8={generic:"Ocurri un error",network:"Error de red",timeout:"Tiempo de espera agotado",unauthorized:"Acceso no autorizado",forbidden:"Acceso prohibido",notFound:"Recurso no encontrado",serverError:"Error del servidor",validationError:"Error de validacin",tryAgain:"Por favor intenta nuevamente"},G8={title:"Base de Conocimiento",newSnippet:"Nuevo Fragmento",editSnippet:"Editar Fragmento",deleteSnippet:"Eliminar Fragmento",searchSnippets:"Buscar fragmentos...",noSnippets:"No se encontraron fragmentos",tags:"Etiquetas",addTag:"Agregar Etiqueta",removeTag:"Eliminar Etiqueta",filterByTag:"Filtrar por Etiqueta",content:"Contenido",created:"Creado",modified:"Modificado",source:"Fuente"},V8={readAloud:"Leer en Voz Alta",stopReading:"Detener Lectura",pauseReading:"Pausar Lectura",resumeReading:"Reanudar Lectura",voice:"Voz",speed:"Velocidad",volume:"Volumen",provider:"Proveedor de TTS"},W8={title:"Lista de Reproduccin",addToPlaylist:"Agregar a Lista de Reproduccin",removeFromPlaylist:"Eliminar de Lista de Reproduccin",playNext:"Reproducir Siguiente",playNow:"Reproducir Ahora",clearPlaylist:"Limpiar Lista de Reproduccin",emptyPlaylist:"La lista de reproduccin est vaca"},Y8={search:"Bsqueda Web",scrape:"Extraer Contenido",transcribe:"Transcribir",youtube:"YouTube",javascript:"Ejecutar JavaScript",generateChart:"Generar Grfico",generateImage:"Generar Imagen"},Q8={title:"Fil d'actualits",generateFeed:"Gnrer le Fil",generating:"Gnration en cours...",refresh:"Actualiser",noItems:"Aucun lment pour l'instant",emptyMessage:"Votre fil personnalis apparatra ici",emptySubMessage:"Nous gnrerons du contenu bas sur vos extraits sauvegards et vos intrts",didYouKnow:"Le saviez-vous",questionAnswer:"Question & Rponse",stash:"Enregistrer",stashed:"Enregistr",trash:"Supprimer",quiz:"Quiz",swipeLeft:"Glissez  gauche pour supprimer",swipeRight:"Glissez  droite pour enregistrer",showMore:"Afficher plus",showLess:"Afficher moins",sources:"Sources",topics:"Sujets",settings:{title:"Paramtres du Fil",searchTerms:"Termes de Recherche",searchTermsDesc:"Dfinissez jusqu' 5 sujets de recherche pour personnaliser votre fil",addTerm:"Ajouter un Terme",removeTerm:"Supprimer",maxTerms:"Maximum 5 termes de recherche autoriss",termExists:"Ce terme de recherche existe dj",placeholder:"ex. 'intelligence artificielle', 'actualits climatiques'",learnedPreferences:"Prfrences Apprises",likedTopics:"Sujets Apprcis",dislikedTopics:"Sujets Non Apprcis",stashToLearn:"Enregistrez des lments pour aider le fil  apprendre ce que vous aimez",trashToLearn:"Supprimez des lments pour aider le fil  apprendre ce qu'il faut viter",tips:" Conseils pour de Meilleurs Fils",tipSpecific:"Soyez prcis avec les termes de recherche",tipStash:"Enregistrez les lments que vous trouvez intressants",tipTrash:"Supprimez les lments non pertinents pour amliorer la qualit",tipMix:"Mlangez sujets larges et spcifiques pour la varit"}},K8={title:"Quiz",subtitle:"Suivez votre progression d'apprentissage et vos performances aux quiz",startQuiz:"Dmarrer le Quiz",nextQuestion:"Question Suivante",previousQuestion:"Prcdent",submitAnswer:"Soumettre la Rponse",viewResults:"Voir les Rsultats",retakeQuiz:"Refaire le Quiz",score:"Score",correct:"Correct",incorrect:"Incorrect",question:"Question",of:"de",yourAnswer:"Votre rponse",correctAnswer:"Bonne rponse",explanation:"Explication",generating:"Gnration du quiz...",noQuizzes:"Aucun quiz pour l'instant",emptyMessage:"Gnrez un quiz  partir de n'importe quel extrait sauvegard ou lment du fil",performance:"Performance au Quiz",totalQuizzes:"Total des Quiz",averageScore:"Score Moyen",questionsAnswered:"Questions Rpondues",statistics:"Statistiques du Quiz",createNewQuiz:"Crer un Nouveau Quiz",recentQuizzes:"Quiz Rcents",noQuizzesYet:"Aucun quiz complt pour l'instant",noQuizzesDescription:"Passez un quiz depuis votre contenu sauvegard dans SWAG pour voir vos statistiques ici",goToSwag:"Aller  SWAG",backToChat:"Retour au Chat",loadingStats:"Chargement des statistiques...",errorLoadingStats:"chec du chargement des statistiques du quiz",confirmDelete:"tes-vous sr de vouloir supprimer le quiz '{{title}}' ?",quizDeleted:"Quiz supprim avec succs",errorDeletingQuiz:"chec de la suppression du quiz",deleteQuiz:"Supprimer le quiz",today:"Aujourd'hui",yesterday:"Hier",daysAgo:"Il y a {{days}} jours",snippetCount:"{{count}} extrait",snippetCount_plural:"{{count}} extraits",enriched:"Enrichi",notSynced:"Non Synchronis",highestScore:"Meilleur Score",lowestScore:"Score le Plus Bas"},X8={common:j8,auth:B8,chat:F8,planning:z8,settings:$8,languages:U8,billing:q8,errors:H8,swag:G8,tts:V8,playlist:W8,tools:Y8,feed:Q8,quiz:K8},J8={save:"Speichern",cancel:"Abbrechen",delete:"Lschen",edit:"Bearbeiten",close:"Schlieen",loading:"Laden...",error:"Fehler",success:"Erfolg",confirm:"Besttigen",back:"Zurck",next:"Weiter",submit:"Absenden",clear:"Lschen",search:"Suchen",filter:"Filtern",export:"Exportieren",import:"Importieren",download:"Herunterladen",upload:"Hochladen",copy:"Kopieren",paste:"Einfgen",cut:"Ausschneiden",undo:"Rckgngig",redo:"Wiederholen",select:"Auswhlen",selectAll:"Alles auswhlen",deselectAll:"Alle abwhlen"},Z8={signIn:"Mit Google anmelden",signInWithGoogle:"Mit Google anmelden",initializing:"Initialisierung...",signOut:"Abmelden",authRequired:"Authentifizierung ist erforderlich, um diese Anwendung zu verwenden",tokenExpired:"Ihre Sitzung ist abgelaufen. Bitte melden Sie sich erneut an.",welcomeBack:"Willkommen zurck!",signInPrompt:"Anmelden, um fortzufahren",signInRequired:"Sie mssen sich anmelden, um diese Funktion zu nutzen",signingIn:"Anmelden...",signingOut:"Abmelden...",researchAgent:"Forschungsagent",tagline:"KI-gesttzter Forschungsassistent",secureAuth:"Sichere Authentifizierung von Google",whyChooseTitle:"Warum Research Agent whlen?",whyChooseIntro:"Im Gegensatz zu Standard-KI-Chatbots, die einfach nur Fragen beantworten, ist Research Agent Ihr umfassender Forschungsbegleiter fr tiefgehende Untersuchungen und Wissensaufbau.",keyAdvantagesTitle:"Hauptvorteile:",webConnected:"Web-verbundene Intelligenz",webConnectedDesc:"Echtzeit-Websuche und Content-Extraktion stellen aktuelle, przise Informationen sicher  keine veralteten Trainingsdaten",multiTool:"Multi-Tool-Orchestrierung",multiToolDesc:"Kombiniert nahtlos Websuche, Code-Ausfhrung, YouTube-Transkripte, Bildgenerierung und Dokumentanalyse in einer einzigen Konversation",knowledgeBase:"Wissensdatenbank-Integration",knowledgeBaseDesc:"Speichern Sie Erkenntnisse in Ihrer persnlichen Wissensdatenbank, erstellen Sie Snippets und bauen Sie im Laufe der Zeit umfassende Forschungsdokumente auf",advancedPlanning:"Erweiterte Planung",advancedPlanningDesc:"Generieren Sie strukturierte Forschungsplne mit Experten-Personas, Suchstrategien und methodischen Anstzen",costEffective:"Intelligente Modellauswahl",costEffectiveDesc:"Automatische Auswahl von Modellen, die die Aufgabe wirtschaftlich oder leistungsstark erledigen, basierend auf der Auswahlstrategie. Verwenden Sie Ihre eigenen Schlssel, um 25% zu sparen",transparency:"Volle Transparenz",transparencyDesc:"Verfolgen Sie jeden API-Aufruf, Token-Verbrauch und Kosten im Echtzeit-Abrechnungs-Dashboard",perfectFor:"Perfekt fr: Akademische Forschung, Marktanalyse, Content-Erstellung, technische Dokumentation, Competitive Intelligence und jede Aufgabe, die grndliche Untersuchungen erfordert."},e9={placeholder:"Geben Sie Ihre Nachricht hier ein...",send:"Senden",retry:"Wiederholen",stop:"Stoppen",thinking:"Denken...",generating:"Antwort wird generiert...",newChat:"Neuer Chat",clearHistory:"Verlauf lschen",loadChat:"Chat laden",systemPrompt:"Systemaufforderung",customInstructions:"Benutzerdefinierte Anweisungen",temperature:"Temperatur",maxTokens:"Maximale Tokens",model:"Modell",provider:"Anbieter",history:"Chat-Verlauf",continue:"Fortsetzen",regenerate:"Neu generieren",edit:"Bearbeiten",delete:"Lschen",copy:"Kopieren",copied:"Kopiert!",selectFiles:"Dateien auswhlen",attachFiles:"Dateien anhngen",pasteImage:"Bild einfgen",recording:"Aufnahme...",voiceInput:"Spracheingabe",stopRecording:"Aufnahme stoppen",processing:"Verarbeitung...",noMessages:"Noch keine Nachrichten. Starten Sie ein Gesprch!",clearConfirm:"Sind Sie sicher, dass Sie alle Nachrichten lschen mchten?",deleteConfirm:"Sind Sie sicher, dass Sie diese Nachricht lschen mchten?",loadingHistory:"Chat-Verlauf wird geladen...",savingChat:"Chat wird gespeichert...",chatSaved:"Chat erfolgreich gespeichert",chatLoaded:"Chat erfolgreich geladen",errorSaving:"Fehler beim Speichern des Chats",errorLoading:"Fehler beim Laden des Chats",signInRequired:"Bitte melden Sie sich an, um diese Funktion zu nutzen",providerRequired:"Bitte konfigurieren Sie mindestens einen Anbieter in den Einstellungen",messageError:"Fehler beim Senden der Nachricht",streamError:"Fehler im Nachrichtenfluss",toolExecution:"Tool wird ausgefhrt...",toolExecuted:"Tool erfolgreich ausgefhrt",toolError:"Tool-Ausfhrungsfehler",searchingWeb:"Suche im Web...",scrapingContent:"Inhalt wird extrahiert...",transcribingAudio:"Audio wird transkribiert...",generatingImage:"Bild wird generiert...",generatingChart:"Diagramm wird erstellt...",executingCode:"Code wird ausgefhrt...",planningMode:"Planungsmodus",exitPlanning:"Planung beenden",startPlanning:"Planung starten",mcpServers:"MCP-Server",addMCPServer:"MCP-Server hinzufgen",mcpServerName:"Nombre del Servidor",mcpServerUrl:"URL del Servidor",exampleServers:"Servidores de Ejemplo",officialServers:"Servidores MCP Oficiales",sampleServers:"Servidores de Muestra",instructions:"Instrucciones",availableTools:"Herramientas Disponibles",enableServer:"Habilitar Servidor",disableServer:"Deshabilitar Servidor",removeServer:"Eliminar Servidor",serverAdded:"Servidor agregado exitosamente",serverRemoved:"Servidor eliminado exitosamente",invalidUrl:"Formato de URL invlido",nameRequired:"Se requiere el nombre del servidor",urlRequired:"Se requiere la URL del servidor",chatHistory:"Chat-Verlauf",examples:"Ejemplos",attachContext:"Adjuntar Contexto",attachContextTooltip:"Adjunta fragmentos de la base de conocimiento como contexto para esta conversacin",searchProvider:"Proveedor de Bsqueda:",functionCall:"Llamada de Funcin:",code:"Cdigo:",arguments:"Argumentos:",callId:"ID de Llamada:",result:"Resultado:",url:"URL:",viewRawHtml:"Ver HTML sin procesar sin comprimir",copyOutputToClipboard:"Copiar salida al portapapeles",copyCodeToClipboard:"Copiar cdigo al portapapeles",captureToSwag:"Capturar a Swag",captureOutputToSwag:"Capturar salida a Swag",captureCodeToSwag:"Capturar cdigo a Swag",grabImage:"Capturar imagen",noSummarization:"Sin resumen",usingProxy:"Usando proxy para mayor privacidad y evasin de deteccin de bots",contentExtracted:"Contenido extrado inteligentemente",truncatedToFit:"Truncado para ajustarse al modelo",scrapeMethod:"Mtodo de Extraccin:",tier:"Nivel",scrapeTime:"Tiempo de Extraccin:",totalTime:"Tiempo Total:",format:"Formato:",originalSize:"Tamao Original:",compressedSize:"Tamao Comprimido:",compression:"Compresin:",compressionStrategy:"Estrategia de Compresin:",basicExtraction:"Extraccin bsica",rawHtml:"HTML Sin Procesar ({{count}} caracteres)",rawText:"Texto Sin Procesar ({{count}} caracteres)",contentProcessingPipeline:"Pipeline de Procesamiento de Contenido:",size:"Tamao:",titlePrompt:"Ttulo/Indicacin",finalPrompt:"Indicacin Final",deleteChat:"Eliminar Chat",clearAllChats:"Limpiar Todos los Chats",confirmClearAll:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDelete:"Ests seguro de que quieres eliminar este chat?",noChatsYet:"No hay chats an",startChatting:"Comienza a chatear para ver el historial aqu",chatDeleted:"Chat eliminado",allChatsCleared:"Todos los chats limpiados",chatTitle:"Ttulo del Chat",enterChatTitle:"Ingresa un ttulo para este chat...",signInToChat:"Por favor inicia sesin para comenzar a chatear",streamingResponse:"Respuesta en transmisin...",imageAddedToSwag:"Imagen agregada a Swag!",imageAddedWithoutConversion:"Imagen agregada a Swag (sin conversin)!",contentCapturedToSwag:"Contenido capturado a Swag!",contentCapturedWithoutConversion:"Contenido capturado a Swag (sin conversin de imagen)!",planningTransferred:"Indicaciones de planificacin transferidas a nuevo chat",failedToTransfer:"Error al transferir datos de planificacin",addedToPlaylist:"{{count}} video{{plural}} agregado{{plural}} a la lista de reproduccin",transcriptionStopped:"Transcripcin detenida",failedToStopTranscription:"Error al detener la transcripcin: {{error}}",fileTypeNotSupported:"Tipo de archivo no compatible: {{name}}. Tipos compatibles: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"Archivo demasiado grande: {{name}} ({{size}}MB). Tamao mximo: {{maxSize}}MB",imageTokenWarning:"La imagen {{name}} puede usar muchos tokens (~{{tokens}}k). Considera usar una imagen ms pequea.",fileAdded:"{{name}} agregado",failedToProcess:"Error al procesar {{name}}",signInToSendMessages:"Por favor inicia sesin para enviar mensajes",foundRelevantChunks:" Se encontraron {{count}} fragmentos relevantes de la base de conocimiento",noRelevantContext:"No se encontr contexto relevante en la base de conocimiento",failedToRetrieveRag:"Error al recuperar el contexto RAG, continuando sin l",sessionExpired:"Tu sesin ha expirado. Por favor inicia sesin nuevamente.",todoLimitReached:"Lmite de progresin automtica de tareas alcanzado. Por favor contina manualmente.",snippetSaved:"Fragmento guardado: {{title}}",snippetDeleted:"Fragmento eliminado: {{title}}",copiedToClipboard:"Copiado al portapapeles!",outputCopied:"Salida copiada al portapapeles!",codeCopied:"Cdigo copiado al portapapeles!",inputPlaceholder:"Escribe tu mensaje... (Shift+Enter para nueva lnea,  para historial)",continueProcessing:"Continuar Procesamiento",stopGenerating:"Detener generacin de respuesta",sendMessage:"Enviar mensaje",chatMessageInput:"Entrada de mensaje de chat",editPlan:"Editar Plan",makeAPlan:"Hacer un Plan",close:"Cerrar",failedToLoadChat:"Fehler beim Laden des Chats",mcpServerNamePlaceholder:"Nombre del Servidor (ej., filesystem, github)",mcpServerUrlPlaceholder:"URL del Servidor (ej., http://localhost:3000)",noMcpServers:"No hay servidores MCP configurados",addServer:"Agregar Servidor",remove:"Lschen",chatHistoryTitle:"Chat-Verlauf",noChatHistory:"No se encontr historial de chat. Inicia una conversacin para guardarla automticamente.",allChatHistoryCleared:"Todo el historial de chat limpiado",loadChatSuccess:"Chat erfolgreich geladen",examplesTitle:"Ejemplos de Chat",tryExample:"Prueba este ejemplo",attachContextTitle:"Adjuntar Contexto de Swag",snippetsAttached:"{{count}} fragmento{{plural}} adjunto{{plural}}",attachSnippets:"Adjuntar Fragmentos",searchSnippets:"Buscar fragmentos...",selectAll:"Alles auswhlen",selectNone:"Seleccionar Ninguno",deleteSelected:"Eliminar Seleccionados",cancel:"Cancelar",load:"Cargar",confirmDeleteChat:"Ests seguro de que quieres eliminar este chat?",confirmClearHistory:"Ests seguro de que quieres limpiar todo el historial de chat?",confirmDeleteSelected:"Ests seguro de que quieres eliminar {{count}} chat{{plural}} seleccionado{{plural}}?",chatLoadedFrom:"Cargado desde",chatSavedAt:"Guardado en",noTitle:"Sin ttulo",clearAttachedSnippets:"Limpiar todos los fragmentos adjuntos",mcpServerConfiguration:"Configuracin del Servidor MCP",typeMessageFirst:"Escribe un mensaje primero",typeMessage:"Escribe un mensaje",signInToSend:"Por favor inicia sesin para enviar mensajes"},t9={title:"Forschungsplanung",query:"Consulta de Investigacin",generatePlan:"Plan Generieren",savePlan:"Guardar Plan",loadSaved:"Cargar Guardado",transferToChat:"Transferir al Chat",clearAll:"Limpiar Todo",debug:"Depurar",planning:"Planificando...",planGenerated:"Plan generado exitosamente",noPlan:"An no se ha generado ningn plan",enterQuery:"Ingresa tu consulta o tema de investigacin...",researchFocus:"Enfoque de Investigacin",methodology:"Metodologa",expectedOutcome:"Resultado Esperado",initializing:"Inicializando...",processing:"Verarbeitung...",signInToGenerate:"Inicia sesin para Generar Plan",generating:"Generando...",signInToUsePlanning:"Por favor inicia sesin para usar la planificacin",signInRequired:"Por favor inicia sesin con Google para usar la funcin de planificacin",authExpired:"Autenticacin expirada. Por favor cierra sesin e inicia sesin nuevamente para continuar.",authRequired:"Se requiere autenticacin. Por favor inicia sesin con Google para continuar.",enterResearchQuestion:"Por favor ingresa una pregunta de investigacin",debugCopied:"Informacin de depuracin copiada al portapapeles!",debugCopyFailed:"Error al copiar informacin de depuracin",savePlanTooltip:"Guarda el plan actual en tu lista de planes guardados",loadSavedPlans:"Cargar Planes Guardados",debugTooltip:"Copiar informacin de depuracin para solucin de problemas de Copilot",transferTooltip:"Transferir al Chat",clearAllTooltip:"Limpiar todos los datos de planificacin y comenzar de nuevo",systemPromptEditable:"Indicacin del Sistema Generada (Editable):",systemPromptHelp:"Esto define el rol y comportamiento de la IA. Edtalo segn sea necesario antes de transferir al chat.",userQueryEditable:"Consulta de Usuario Generada (Editable):",userQueryHelp:"Este es el mensaje que se enviar al chat. Edtalo para refinar tu consulta.",generatedPrompts:"Indicaciones Generadas",llmInfoTooltip:"Ver informacin de transparencia del LLM (modelo, tokens, costo)",llmCalls:"llamada",llmCallsPlural:"llamadas",cannotSavePlan:"No se puede guardar el plan: No se gener un plan vlido",planSavedSuccess:"Plan guardado exitosamente",planSaveFailed:"Error al guardar el plan",loadSavedPlan:"Cargar Plan Guardado",storage:"Almacenamiento",storageWarning:"El almacenamiento est al {{percentage}}% de su capacidad",storageWarningHelp:"Considera eliminar planes antiguos para liberar espacio.",noSavedPlans:"No se encontraron planes guardados",saved:"Guardado",load:"Cargar",simpleQueryDetected:"Consulta Simple Detectada",simpleQueryHelp:"Esta consulta puede responderse directamente sin planificacin extensa.",comprehensiveResearchPlan:" Plan de Investigacin Completo",analysisSummary:" Resumen del Anlisis",queryType:"Tipo de Consulta:",complexity:"Complejidad:",researchApproach:"Enfoque de Investigacin:",estimatedSources:"Fuentes Estimadas:",reasoning:"Razonamiento:",expertPersona:" Persona Experta",searchQueries:" Consultas de Bsqueda:",researchQuestions:" Preguntas de Investigacin:",suggestedSources:" Fuentes Sugeridas:",sources:"Fuentes:",variousRelevantSources:"Varias fuentes relevantes",researchMethodology:" Metodologa de Investigacin:",enhancedSystemPrompt:" Indicacin del Sistema Mejorada:",enhancedUserPrompt:" Indicacin de Usuario Mejorada:",debugRawLlmResponse:" Depurar: Campos de Respuesta Bruta del LLM",longFormDocumentPlan:" Plan de Documento de Formato Largo",longFormNote:"Nota: Esto se construir en etapas usando fragmentos. Cada seccin se investigar y escribir por separado, luego se combinar en un documento final.",documentStructure:" Estructura del Documento:",keywords:"Palabras Clave:",workflow:" Flujo de Trabajo:",needMoreInfo:" Se Necesita Ms Informacin",pleaseClarify:"Por favor aclara:",updateQueryDetails:"Actualiza tu consulta con ms detalles:",provideMoreDetails:"Proporciona detalles ms especficos...",regeneratePlanWithClarifications:"Regenerar Plan con Aclaraciones",moreInfoRequired:" Se Requiere Ms Informacin",planType:"Tipo de Plan:",detectedComplexityPatterns:" Patrones de Complejidad Detectados:",estimatedIterations:"Iteraciones Estimadas",toolsRequired:"Herramientas Requeridas",suggestedWorkflow:" Flujo de Trabajo Sugerido:",requiredTools:" Herramientas Requeridas:",guidanceQuestions:" Por favor responde estas preguntas para refinar tu plan:",updatePromptWithAnswers:"Actualiza tu indicacin de investigacin con las respuestas:",guidanceTip:" Consejo: Incluye las respuestas a las preguntas anteriores en tu consulta actualizada. Cuanto ms especfico seas, mejor podr la IA crear un plan de mltiples iteraciones efectivo con el uso apropiado de herramientas y ejemplos de pocos disparos.",guidanceExamplePlaceholder:`Ejemplo: Quiero construir un informe de investigacin completo sobre el cambio climtico:
1. Creando 25 tareas para diferentes subtemas (poltica, ciencia, economa, etc.)
2. Buscando en la web para cada tema y guardando los resultados en fragmentos
3. Generando grficos para visualizar puntos de datos clave
4. Combinando todos los fragmentos en un anlisis maestro

Por favor crea un plan detallado con ejemplos de pocos disparos que muestren cmo usar create_todo, search_web, create_snippet y generate_chart juntos en cada iteracin...`,generateDetailedExecutionPlan:" Generar Plan de Ejecucin Detallado",forcePlan:" Forzar Plan",forcePlanTooltip:"Deja que la IA responda las preguntas y fuerce la generacin del plan",reset:" Reiniciar",resetTooltip:"Limpiar modo de gua y volver al estado anterior",aboutGuidanceMode:"Acerca del Modo de Gua:",guidanceModeHelp:"Este modo detecta proyectos complejos que requieren mltiples iteraciones y uso extensivo de herramientas. Responde las preguntas anteriores para ayudar a crear un plan de ejecucin detallado con ejemplos de pocos disparos que muestren cmo usar tareas, fragmentos y mltiples llamadas de herramientas por iteracin.",forcingPlan:"Forzando generacin del plan...",forcePlanError:"Error al forzar el plan",forcePlanFailed:"Fall al forzar el plan",clarificationAnswer:"Por favor usa tu mejor criterio basndote en la consulta original."},r9={title:"Einstellungen",language:"Sprache",selectLanguage:"Sprache Auswhlen",providers:"Proveedores",cloudSync:"Sincronizacin en la Nube",billing:"Facturacin",general:"General",generalDescription:"Configura ajustes generales de la aplicacin incluyendo idioma y preferencias de visualizacin",languageHelp:"Cambia el idioma de la interfaz e instruye a la IA para responder en tu idioma seleccionado",providerCredentials:"Credenciales de Proveedor",providerDescription:"Configura tus claves API de proveedor LLM. El backend selecciona automticamente el mejor modelo para cada solicitud",modelSelectionStrategy:"Estrategia de Seleccin de Modelo",modelStrategyDescription:"Elige cmo el sistema selecciona modelos para tus solicitudes. Esto equilibra costo, calidad y rendimiento",cheap:"Econmico (Recomendado)",cheapDescription:"Prioriza proveedores gratuitos (Groq, Gemini) y modelos ms pequeos capaces. Recurre a proveedores de pago solo cuando est limitado por tasa. Mejor para la mayora de los casos de uso",balanced:"Equilibrado",balancedDescription:"Elige modelos que hagan el trabajo de manera confiable sin comprometer la calidad. Usa nivel gratuito cuando la calidad es equivalente, modelos de pago cuando la calidad importa. Equilibra costo vs. capacidad",powerful:"Potente",powerfulDescription:"Usa los mejores modelos disponibles (GPT-4o, Gemini 2.5 Pro, o1) para mxima capacidad. Prioriza calidad sobre costo. Usa modelos de razonamiento para anlisis complejo",fastest:"Ms Rpido",fastestDescription:"Prioriza modelos de baja latencia (Groq) para respuestas rpidas. Puede sacrificar algo de calidad por velocidad en solicitudes simples. Excelente para sesiones interactivas",tavilyApiKey:"Clave API de Tavily (Opcional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Habilita bsqueda y extraccin web mejorada a travs de la API de Tavily. Recurre a DuckDuckGo si no se proporciona",enabledTools:"Herramientas Habilitadas",webSearch:"Bsqueda Web",webSearchDescription:"Busca en la web informacin actual, noticias y artculos",executeJs:"Ejecucin de JavaScript",executeJsDescription:"Ejecuta cdigo JavaScript para clculos y procesamiento de datos",scrapeUrl:"Extraccin Web",scrapeUrlDescription:"Extrae contenido de URLs y sitios web especficos",youtubeSearch:"Bsqueda en YouTube",youtubeDescription:"Busca videos en YouTube con soporte de transcripcin",transcribe:"Transcribir Audio/Video",transcribeDescription:"Convierte archivos de audio y video a transcripciones de texto",generateChart:"Generar Grficos",chartDescription:"Crea visualizaciones y grficos a partir de datos",generateImage:"Generar Imgenes",imageDescription:"Crea imgenes generadas por IA a partir de descripciones de texto",searchKnowledgeBase:"Buscar en Base de Conocimiento",ragDescription:"Busca en documentos cargados y base de conocimiento",manageTodos:"Gestionar Tareas",todosDescription:"Crea y gestiona listas de tareas y recordatorios",manageSnippets:"Gestionar Fragmentos",snippetsDescription:"Guarda y recupera fragmentos de cdigo y texto",askLlm:"Preguntar a LLM",askLlmDescription:"Delega sub-preguntas a otras instancias de LLM",generateReasoning:"Generar Cadena de Razonamiento",reasoningDescription:"Razonamiento analtico paso a paso para problemas complejos",proxySettings:"Configuracin de Proxy",proxyDescription:"Configura proxy HTTP/HTTPS para solicitudes web",enableProxy:"Habilitar Proxy",proxyUrl:"URL del Proxy",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Usuario (Opcional)",proxyPassword:"Contrasea (Opcional)",locationServices:"Servicios de Ubicacin",locationDescription:"Usa tu ubicacin para resultados de bsqueda localizados e informacin especfica de la regin",enableLocation:"Habilitar Servicios de Ubicacin",locationHelp:"Permite que las bsquedas web devuelvan resultados localmente relevantes",currentLocation:"Ubicacin Actual",requestLocation:"Solicitar Ubicacin",clearLocation:"Limpiar Ubicacin",locationPermission:"Permiso de Ubicacin",permissionGranted:"Concedido",permissionDenied:"Denegado",permissionPrompt:"No solicitado",tabs:{general:"General",provider:"Anbieter",cloud:"Sincronizacin en la Nube",tools:"Herramientas",proxy:"Proxy",location:"Ubicacin",voice:"Stimme",tts:"TTS",rag:"RAG"},appearance:"Apariencia",theme:"Tema",darkMode:"Modo Oscuro",lightMode:"Modo Claro",notifications:"Notificaciones",privacy:"Privacidad",accessibility:"Accesibilidad",fontSize:"Tamao de Fuente",lineHeight:"Altura de Lnea"},n9={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},a9={title:"Panel de Facturacin",balance:"Saldo de Crdito",totalCost:"Costo Total",totalTokens:"Tokens Totales",totalRequests:"Solicitudes Totales",cost:"Costo",tokens:"Tokens",tokensIn:"Tokens Entrantes",tokensOut:"Tokens Salientes",timestamp:"Marca de Tiempo",noTransactions:"An no hay transacciones",creditsPurchased:"Crditos comprados exitosamente",insufficientCredits:"Crditos insuficientes",purchaseCredits:"Agregar Crdito",amount:"Monto",paymentMethod:"Mtodo de Pago",transactions:"Transacciones",overview:"Resumen",exportCSV:"Exportar CSV",clearData:"Limpiar Datos",clearDataConfirm:"Ests seguro de que quieres limpiar los datos de facturacin?",dataClearedSuccess:" xito: Se limpiaron {{count}} transacciones. {{remaining}} restantes.",dataClearError:" Error: {{message}}",noDataToExport:"No hay datos para exportar",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",type:"Tipo",provider:"Anbieter",model:"Modell",duration:"Duracin",status:"Estado",allTypes:"Todos los Tipos",allProviders:"Todos los Proveedores",clearFilters:"Limpiar Filtros",quickRanges:"Rangos rpidos:",today:"Hoy",last7Days:"ltimos 7 Das",last30Days:"ltimos 30 Das",thisMonth:"Este Mes",byType:"Por Tipo",byProvider:"Por Proveedor",byModel:"Por Modelo",requests:"Solicitudes",groupByRequestId:" Agrupar por ID de Solicitud",itemsPerPage:"por pgina",totalRequestGroups:"{{count}} grupos de solicitudes totales (mostrando {{showing}}), {{ungrouped}} sin agrupar",totalTransactionsShowing:"{{total}} transacciones totales (mostrando {{showing}})",requestGroup:" Grupo de Solicitudes ({{count}} transacciones)",signInRequired:" Se Requiere Inicio de Sesin",signInToViewBilling:"Por favor inicia sesin con Google para ver tus datos de facturacin.",howToAccessBilling:" Cmo Acceder a los Datos de Facturacin:",signInStep1:'Haz clic en el botn "Iniciar sesin con Google" en la barra de navegacin superior',signInStep2:"Eso es todo! Tus datos de facturacin se cargarn automticamente",billingDataNote:" Tus datos de facturacin se almacenan en una Hoja de clculo de Google de cuenta de servicio centralizada y se recuperan automticamente. No se necesitan permisos adicionales ni acceso a Drive - solo inicia sesin con Google.",debugInfo:" Informacin de Depuracin",loading:"Cargando datos de facturacin...",errorLoading:" Error al Cargar Datos de Facturacin",retry:" Reintentar",noBillingData:"No hay datos de facturacin disponibles. Por favor espera...",noTransactionsMessage:"No se encontraron transacciones",noBillingDataYet:" An No Hay Datos de Facturacin",startUsingChat:"Comienza a usar el chat para generar registros de facturacin. Todo el uso de API se rastrea automticamente.",refresh:" Actualizar",usageOnly:"Solo uso (excl. crditos)",totalCredits:"Crditos Totales",userQueries:"Consultas de Usuario",llmCalls:"Llamadas LLM",userQueriesLlmCalls:"Consultas de Usuario / Llamadas LLM",newBalance:"Nuevo saldo:",creditsToAdd:"Crditos a agregar:",minimumPurchase:"La compra mnima es $5.00",addCreditsTitle:" Agregar Crditos",purchaseCreditsDescription:"Compra crditos para usar funciones de IA. Compra mnima: $5.00",enterAmount:"Ingresa el monto (mn $5.00)",tipUseOwnKeys:" Consejo: Agrega tus propias claves API en Configuracin para costos LLM de $0! Solo se aplican costos de infraestructura cuando usas tus propias claves.",loadingPayPal:"Cargando PayPal...",paypalNotLoaded:" SDK de PayPal no cargado. Por favor actualiza la pgina.",close:"Cerrar",clearBillingData:"Limpiar Datos de Facturacin",clearDataWarning:" Advertencia: Esta accin no se puede deshacer. Tus datos de facturacin se eliminarn permanentemente.",clearAll:"Limpiar Todo",clearByProvider:"Limpiar por Proveedor",clearByDateRange:"Limpiar por Rango de Fechas",clearAllDescription:"Esto eliminar todas las transacciones de tu hoja de facturacin.",considerExportFirst:"Considera exportar a CSV primero para tus registros.",selectProvider:"Seleccionar Proveedor:",selectProviderPlaceholder:"-- Seleccionar Proveedor --",clearProviderHint:"til para alinearse con los ciclos de facturacin del proveedor (ej., limpiar mensualmente).",clearDateRangeHint:"Dejar en blanco para limpiar desde el principio/hasta el final. Ambos pueden usarse juntos.",confirmUndoCheckbox:"Entiendo que esta accin no se puede deshacer",cancel:"Cancelar",page:"Pgina",of:"de",first:" Primera",prev:" Anterior",next:"Siguiente ",last:"ltima ",types:{chat:"Chat",embedding:"Incrustacin",guardrail_input:" Entrada de Guardarral",guardrail_output:" Salida de Guardarral",planning:"Planificacin",assessment:"Evaluacin",image_generation:" Generacin de Imagen",tts:" Texto a Voz",chat_iteration:"Iteracin de Chat",credit_added:"Crdito Agregado",summary:"Resumen",lambda_invocation:"Invocacin Lambda"}},s9={generic:"Ocurri un error",network:"Error de red",timeout:"Tiempo de espera agotado",unauthorized:"Acceso no autorizado",forbidden:"Acceso prohibido",notFound:"Recurso no encontrado",serverError:"Error del servidor",validationError:"Error de validacin",tryAgain:"Por favor intenta nuevamente"},i9={title:"Base de Conocimiento",newSnippet:"Nuevo Fragmento",editSnippet:"Editar Fragmento",deleteSnippet:"Eliminar Fragmento",searchSnippets:"Buscar fragmentos...",noSnippets:"No se encontraron fragmentos",tags:"Etiquetas",addTag:"Agregar Etiqueta",removeTag:"Eliminar Etiqueta",filterByTag:"Filtrar por Etiqueta",content:"Contenido",created:"Creado",modified:"Modificado",source:"Fuente"},o9={readAloud:"Leer en Voz Alta",stopReading:"Detener Lectura",pauseReading:"Pausar Lectura",resumeReading:"Reanudar Lectura",voice:"Voz",speed:"Velocidad",volume:"Volumen",provider:"Proveedor de TTS"},l9={title:"Lista de Reproduccin",addToPlaylist:"Agregar a Lista de Reproduccin",removeFromPlaylist:"Eliminar de Lista de Reproduccin",playNext:"Reproducir Siguiente",playNow:"Reproducir Ahora",clearPlaylist:"Limpiar Lista de Reproduccin",emptyPlaylist:"La lista de reproduccin est vaca"},c9={search:"Bsqueda Web",scrape:"Extraer Contenido",transcribe:"Transcribir",youtube:"YouTube",javascript:"Ejecutar JavaScript",generateChart:"Generar Grfico",generateImage:"Generar Imagen"},u9={title:"Feed",generateFeed:"Feed generieren",generating:"Wird generiert...",refresh:"Aktualisieren",noItems:"Noch keine Eintrge",emptyMessage:"Ihr personalisierter Feed wird hier angezeigt",emptySubMessage:"Wir erstellen Inhalte basierend auf Ihren gespeicherten Snippets und Interessen",didYouKnow:"Wussten Sie",questionAnswer:"Frage & Antwort",stash:"Speichern",stashed:"Gespeichert",trash:"Lschen",quiz:"Quiz",swipeLeft:"Nach links wischen zum Lschen",swipeRight:"Nach rechts wischen zum Speichern",showMore:"Mehr anzeigen",showLess:"Weniger anzeigen",sources:"Quellen",topics:"Themen",settings:{title:"Feed-Einstellungen",searchTerms:"Suchbegriffe",searchTermsDesc:"Definieren Sie bis zu 5 Suchthemen, um Ihren Feed zu personalisieren",addTerm:"Begriff hinzufgen",removeTerm:"Entfernen",maxTerms:"Maximal 5 Suchbegriffe erlaubt",termExists:"Dieser Suchbegriff existiert bereits",placeholder:"z.B. 'knstliche Intelligenz', 'Klimanachrichten'",learnedPreferences:"Gelernte Prferenzen",likedTopics:"Beliebte Themen",dislikedTopics:"Unbeliebte Themen",stashToLearn:"Speichern Sie Eintrge, damit der Feed lernt, was Ihnen gefllt",trashToLearn:"Lschen Sie Eintrge, damit der Feed lernt, was vermieden werden soll",tips:" Tipps fr bessere Feeds",tipSpecific:"Seien Sie spezifisch mit Suchbegriffen",tipStash:"Speichern Sie interessante Eintrge",tipTrash:"Lschen Sie irrelevante Eintrge, um die Qualitt zu verbessern",tipMix:"Mischen Sie breite und spezifische Themen fr Vielfalt"}},d9={title:"Quiz",startQuiz:"Quiz starten",nextQuestion:"Nchste Frage",previousQuestion:"Zurck",submitAnswer:"Antwort absenden",viewResults:"Ergebnisse anzeigen",retakeQuiz:"Quiz wiederholen",score:"Punktzahl",correct:"Richtig",incorrect:"Falsch",question:"Frage",of:"von",yourAnswer:"Ihre Antwort",correctAnswer:"Richtige Antwort",explanation:"Erklrung",generating:"Quiz wird erstellt...",noQuizzes:"Noch keine Quizze",emptyMessage:"Erstellen Sie ein Quiz aus einem gespeicherten Snippet oder Feed-Eintrag",performance:"Quiz-Leistung",totalQuizzes:"Gesamte Quizze",averageScore:"Durchschnittliche Punktzahl",questionsAnswered:"Beantwortete Fragen",statistics:"Quiz-Statistiken",subtitle:"Verfolgen Sie Ihren Lernfortschritt und Ihre Quiz-Leistung",createNewQuiz:"Neues Quiz Erstellen",recentQuizzes:"Letzte Quiz",noQuizzesYet:"Noch keine Quiz abgeschlossen",noQuizzesDescription:"Machen Sie ein Quiz aus Ihrem gespeicherten Inhalt in SWAG, um Ihre Statistiken hier zu sehen",goToSwag:"Zu SWAG Gehen",backToChat:"Zurck zum Chat",loadingStats:"Statistiken werden geladen...",errorLoadingStats:"Fehler beim Laden der Quiz-Statistiken",confirmDelete:"Sind Sie sicher, dass Sie das Quiz '{{title}}' lschen mchten?",quizDeleted:"Quiz erfolgreich gelscht",errorDeletingQuiz:"Fehler beim Lschen des Quiz",deleteQuiz:"Quiz lschen",today:"Heute",yesterday:"Gestern",daysAgo:"Vor {{days}} Tagen",snippetCount:"{{count}} Snippet",snippetCount_plural:"{{count}} Snippets",enriched:"Angereichert",notSynced:"Nicht Synchronisiert",highestScore:"Hchste Punktzahl",lowestScore:"Niedrigste Punktzahl"},h9={common:J8,auth:Z8,chat:e9,planning:t9,settings:r9,languages:n9,billing:a9,errors:s9,swag:i9,tts:o9,playlist:l9,tools:c9,feed:u9,quiz:d9},p9={save:"",cancel:"",delete:"",edit:"",close:"",loading:"...",error:"",success:"",confirm:"",back:"",next:"",submit:"",clear:"",search:"",filter:"",export:"",import:"",download:"",upload:"",copy:"",paste:"",cut:"",undo:"",redo:"",select:"",selectAll:"",deselectAll:""},g9={signIn:" Google ",signInWithGoogle:" Google ",initializing:"...",signOut:"",authRequired:"",tokenExpired:"",welcomeBack:"",signInPrompt:"",signInRequired:"",signingIn:"...",signingOut:"...",researchAgent:"",tagline:"AI",secureAuth:" Google ",whyChooseTitle:" Research Agent",whyChooseIntro:" AI Research Agent ",keyAdvantagesTitle:"",webConnected:"",webConnectedDesc:"",multiTool:"",multiToolDesc:"YouTube ",knowledgeBase:"",knowledgeBaseDesc:"",advancedPlanning:"",advancedPlanningDesc:"",costEffective:"",costEffectiveDesc:"25%",transparency:"",transparencyDesc:" API ",perfectFor:""},f9={placeholder:"...",send:"",retry:"Retry",stop:"",thinking:"...",generating:"Generating response...",newChat:"New Chat",clearHistory:"Clear History",loadChat:"Load Chat",systemPrompt:"System Prompt",customInstructions:"Custom Instructions",temperature:"Temperature",maxTokens:"Max Tokens",model:"Model",provider:"Provider",history:"Chat History",continue:"Continue",regenerate:"Regenerate",edit:"",delete:"",copy:"",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Please sign in to use this feature",providerRequired:"Please configure at least one provider in Settings",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:"",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},m9={title:"",query:"Research Query",generatePlan:"",savePlan:"Save Plan",loadSaved:"Load Saved",transferToChat:"Transfer to Chat",clearAll:"Clear All",debug:"Debug",planning:"Planning...",planGenerated:"Plan generated successfully",noPlan:"No plan generated yet",enterQuery:"Enter your research query or topic...",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},y9={title:"",language:"",selectLanguage:"",providers:"Providers",cloudSync:"Cloud Sync",billing:"Billing",general:"General",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"",tts:"TTS",rag:"RAG"},appearance:"Appearance",theme:"Theme",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},b9={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},x9={title:"Billing Dashboard",balance:"Credit Balance",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Cost",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},v9={generic:"An error occurred",network:"Network error",timeout:"Request timed out",unauthorized:"Unauthorized access",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Please try again"},w9={title:"Knowledge Base",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Search snippets...",noSnippets:"No snippets found",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},S9={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},k9={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},T9={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},C9={title:"",generateFeed:"",generating:"...",refresh:"",noItems:"",emptyMessage:"",emptySubMessage:"",didYouKnow:"",questionAnswer:"",stash:"",stashed:"",trash:"",quiz:"",swipeLeft:"",swipeRight:"",showMore:"",showLess:"",sources:"",topics:"",settings:{title:"",searchTerms:"",searchTermsDesc:"5",addTerm:"",removeTerm:"",maxTerms:"5",termExists:"",placeholder:"''''",learnedPreferences:"",likedTopics:"",dislikedTopics:"",stashToLearn:"",trashToLearn:"",tips:" ",tipSpecific:"",tipStash:"",tipTrash:"",tipMix:""}},E9={title:"",startQuiz:"",nextQuestion:"",previousQuestion:"",submitAnswer:"",viewResults:"",retakeQuiz:"",score:"",correct:"",incorrect:"",question:"",of:"",yourAnswer:"",correctAnswer:"",explanation:"",generating:"...",noQuizzes:"",emptyMessage:"",performance:"",totalQuizzes:"",averageScore:"",questionsAnswered:"",statistics:"",subtitle:"",createNewQuiz:"",recentQuizzes:"",noQuizzesYet:"",noQuizzesDescription:" SWAG ",goToSwag:" SWAG",backToChat:"",loadingStats:"...",errorLoadingStats:"",confirmDelete:"'{{title}}'",quizDeleted:"",errorDeletingQuiz:"",deleteQuiz:"",today:"",yesterday:"",daysAgo:"{{days}} ",snippetCount:"{{count}} ",snippetCount_plural:"{{count}} ",enriched:"",notSynced:"",highestScore:"",lowestScore:""},_9={common:p9,auth:g9,chat:f9,planning:m9,settings:y9,languages:b9,billing:x9,errors:v9,swag:w9,tts:S9,playlist:k9,tools:T9,feed:C9,quiz:E9},A9={save:"",cancel:"",delete:"",edit:"",close:"",loading:"...",error:"",success:"",confirm:"",back:"",next:"",submit:"",clear:"",search:"",filter:"",export:"",import:"",download:"",upload:"",copy:"",paste:"",cut:"",undo:"",redo:"",select:"",selectAll:"",deselectAll:""},N9={signIn:"Google",signInWithGoogle:"Google",initializing:"...",signOut:"",authRequired:"",tokenExpired:"",welcomeBack:"",signInPrompt:"",signInRequired:"",signingIn:"...",signingOut:"...",researchAgent:"",tagline:"AI",secureAuth:"Google",whyChooseTitle:"Research Agent",whyChooseIntro:"AIResearch Agent",keyAdvantagesTitle:"",webConnected:"Web",webConnectedDesc:"Web",multiTool:"",multiToolDesc:"WebYouTube",knowledgeBase:"",knowledgeBaseDesc:"",advancedPlanning:"",advancedPlanningDesc:"",costEffective:"",costEffectiveDesc:"25%",transparency:"",transparencyDesc:"API",perfectFor:""},P9={placeholder:"...",send:"",retry:"Retry",stop:"",thinking:"...",generating:"Generating response...",newChat:"New Chat",clearHistory:"Clear History",loadChat:"Load Chat",systemPrompt:"System Prompt",customInstructions:"Custom Instructions",temperature:"Temperature",maxTokens:"Max Tokens",model:"Model",provider:"Provider",history:"Chat History",continue:"Continue",regenerate:"Regenerate",edit:"",delete:"",copy:"",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Please sign in to use this feature",providerRequired:"Please configure at least one provider in Settings",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:"",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},I9={title:"",query:"Research Query",generatePlan:"",savePlan:"Save Plan",loadSaved:"Load Saved",transferToChat:"Transfer to Chat",clearAll:"Clear All",debug:"Debug",planning:"Planning...",planGenerated:"Plan generated successfully",noPlan:"No plan generated yet",enterQuery:"Enter your research query or topic...",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},R9={title:"",language:"",selectLanguage:"",providers:"Providers",cloudSync:"Cloud Sync",billing:"Billing",general:"General",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"",tts:"TTS",rag:"RAG"},appearance:"Appearance",theme:"Theme",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},D9={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},L9={title:"Billing Dashboard",balance:"Credit Balance",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Cost",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},M9={generic:"An error occurred",network:"Network error",timeout:"Request timed out",unauthorized:"Unauthorized access",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Please try again"},O9={title:"Knowledge Base",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Search snippets...",noSnippets:"No snippets found",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},j9={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},B9={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},F9={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},z9={title:"",generateFeed:"",generating:"...",refresh:"",noItems:"",emptyMessage:"",emptySubMessage:"",didYouKnow:"",questionAnswer:"",stash:"",stashed:"",trash:"",quiz:"",swipeLeft:"",swipeRight:"",showMore:"",showLess:"",sources:"",topics:"",settings:{title:"",searchTerms:"",searchTermsDesc:"5",addTerm:"",removeTerm:"",maxTerms:"5",termExists:"",placeholder:"''''",learnedPreferences:"",likedTopics:"",dislikedTopics:"",stashToLearn:"",trashToLearn:"",tips:" ",tipSpecific:"",tipStash:"",tipTrash:"",tipMix:""}},$9={title:"",startQuiz:"",nextQuestion:"",previousQuestion:"",submitAnswer:"",viewResults:"",retakeQuiz:"",score:"",correct:"",incorrect:"",question:"",of:"",yourAnswer:"",correctAnswer:"",explanation:"",generating:"...",noQuizzes:"",emptyMessage:"",performance:"",totalQuizzes:"",averageScore:"",questionsAnswered:"",statistics:"",subtitle:"",createNewQuiz:"",recentQuizzes:"",noQuizzesYet:"",noQuizzesDescription:"SWAG",goToSwag:"SWAG",backToChat:"",loadingStats:"...",errorLoadingStats:"",confirmDelete:"'{{title}}'",quizDeleted:"",errorDeletingQuiz:"",deleteQuiz:"",today:"",yesterday:"",daysAgo:"{{days}}",snippetCount:"{{count}}",snippetCount_plural:"{{count}}",enriched:"",notSynced:"",highestScore:"",lowestScore:""},U9={common:A9,auth:N9,chat:P9,planning:I9,settings:R9,languages:D9,billing:L9,errors:M9,swag:O9,tts:j9,playlist:B9,tools:F9,feed:z9,quiz:$9},q9={save:"",cancel:"",delete:"",edit:"",close:"",loading:" ...",error:"",success:"",confirm:"",back:"",next:"",submit:"",clear:"",search:"",filter:"",export:"",import:"",download:"",upload:"",copy:"",paste:"",cut:"",undo:"",redo:"",select:"",selectAll:" ",deselectAll:"  "},H9={signIn:"   Google",signInWithGoogle:"   Google",initializing:" ...",signOut:" ",authRequired:"    ",tokenExpired:"  .     .",welcomeBack:" !",signInPrompt:"  ",signInRequired:"      ",signingIn:"  ...",signingOut:"  ...",researchAgent:" ",tagline:"    ",secureAuth:"   Google",whyChooseTitle:"  Research Agent",whyChooseIntro:"            Research Agent         .",keyAdvantagesTitle:" :",webConnected:"  ",webConnectedDesc:"            -    ",multiTool:"  ",multiToolDesc:"          YouTube       ",knowledgeBase:"  ",knowledgeBaseDesc:"                ",advancedPlanning:" ",advancedPlanningDesc:"           ",costEffective:"  ",costEffectiveDesc:"             .     25%",transparency:" ",transparencyDesc:"   API         ",perfectFor:" :               ."},G9={placeholder:"  ...",send:"",retry:"Retry",stop:"",thinking:" ...",generating:"Generating response...",newChat:"New Chat",clearHistory:"Clear History",loadChat:"Load Chat",systemPrompt:"System Prompt",customInstructions:"Custom Instructions",temperature:"Temperature",maxTokens:"Max Tokens",model:"Model",provider:"Provider",history:"Chat History",continue:"Continue",regenerate:"Regenerate",edit:"",delete:"",copy:"",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Please sign in to use this feature",providerRequired:"Please configure at least one provider in Settings",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:" ",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},V9={title:" ",query:"Research Query",generatePlan:" ",savePlan:"Save Plan",loadSaved:"Load Saved",transferToChat:"Transfer to Chat",clearAll:"Clear All",debug:"Debug",planning:"Planning...",planGenerated:"Plan generated successfully",noPlan:"No plan generated yet",enterQuery:"Enter your research query or topic...",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},W9={title:"",language:"",selectLanguage:" ",providers:"Providers",cloudSync:"Cloud Sync",billing:"Billing",general:"General",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"",tts:"TTS",rag:"RAG"},appearance:"Appearance",theme:"Theme",darkMode:"Dark Mode",lightMode:"Light Mode",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},Y9={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},Q9={title:"Billing Dashboard",balance:"Credit Balance",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Cost",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},K9={generic:"An error occurred",network:"Network error",timeout:"Request timed out",unauthorized:"Unauthorized access",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Please try again"},X9={title:"Knowledge Base",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Search snippets...",noSnippets:"No snippets found",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},J9={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},Z9={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},e7={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},t7={title:"",generateFeed:" ",generating:" ...",refresh:"",noItems:"   ",emptyMessage:"   ",emptySubMessage:"       ",didYouKnow:"  ",questionAnswer:" ",stash:"",stashed:"",trash:"",quiz:"",swipeLeft:"  ",swipeRight:"  ",showMore:" ",showLess:" ",sources:"",topics:"",settings:{title:" ",searchTerms:" ",searchTermsDesc:"    5    ",addTerm:" ",removeTerm:"",maxTerms:"  5  ",termExists:"    ",placeholder:": ' ', ' '",learnedPreferences:" ",likedTopics:" ",dislikedTopics:"  ",stashToLearn:"       ",trashToLearn:"        ",tips:"   ",tipSpecific:"    ",tipStash:"     ",tipTrash:"      ",tipMix:"    "}},r7={title:"",startQuiz:" ",nextQuestion:" ",previousQuestion:"",submitAnswer:" ",viewResults:" ",retakeQuiz:" ",score:"",correct:"",incorrect:"",question:"",of:"",yourAnswer:"",correctAnswer:" ",explanation:"",generating:"  ...",noQuizzes:"   ",emptyMessage:"         ",performance:" ",totalQuizzes:" ",averageScore:" ",questionsAnswered:"  ",statistics:" ",subtitle:"    ",createNewQuiz:"  ",recentQuizzes:" ",noQuizzesYet:"    ",noQuizzesDescription:"       SWAG   ",goToSwag:"  SWAG",backToChat:"  ",loadingStats:"  ...",errorLoadingStats:"   ",confirmDelete:"        '{{title}}'",quizDeleted:"   ",errorDeletingQuiz:"  ",deleteQuiz:" ",today:"",yesterday:"",daysAgo:" {{days}} ",snippetCount:"{{count}} ",snippetCount_plural:"{{count}} ",enriched:"",notSynced:" ",highestScore:" ",lowestScore:" "},n7={common:q9,auth:H9,chat:G9,planning:V9,settings:W9,languages:Y9,billing:Q9,errors:K9,swag:X9,tts:J9,playlist:Z9,tools:e7,feed:t7,quiz:r7},a7={save:"Opslaan",cancel:"Annuleren",delete:"Verwijderen",edit:"Bewerken",close:"Sluiten",loading:"Laden...",error:"Fout",success:"Succes",confirm:"Bevestigen",back:"Terug",next:"Volgende",submit:"Verzenden",clear:"Wissen",search:"Zoeken",filter:"Filteren",export:"Exporteren",import:"Importeren",download:"Downloaden",upload:"Uploaden",copy:"Kopiren",paste:"Plakken",cut:"Knippen",undo:"Ongedaan maken",redo:"Opnieuw",select:"Selecteren",selectAll:"Alles selecteren",deselectAll:"Alles deselecteren"},s7={signIn:"Inloggen met Google",signInWithGoogle:"Inloggen met Google",initializing:"Initialiseren...",signOut:"Uitloggen",authRequired:"Authenticatie is vereist om deze applicatie te gebruiken",tokenExpired:"Uw sessie is verlopen. Log opnieuw in.",welcomeBack:"Welkom terug!",signInPrompt:"Inloggen om door te gaan",signInRequired:"U moet inloggen om deze functie te gebruiken",signingIn:"Inloggen...",signingOut:"Uitloggen...",researchAgent:"Onderzoeksagent",tagline:"AI-aangedreven onderzoeksassistent",secureAuth:"Veilige authenticatie mogelijk gemaakt door Google",whyChooseTitle:"Waarom kiezen voor Research Agent?",whyChooseIntro:"In tegenstelling tot standaard AI-chatbots die simpelweg vragen beantwoorden, is Research Agent uw uitgebreide onderzoekspartner gebouwd voor diepgaand onderzoek en kennisopbouw.",keyAdvantagesTitle:"Belangrijkste Voordelen:",webConnected:"Web-verbonden Intelligentie",webConnectedDesc:"Real-time webzoeken en content-extractie zorgen voor actuele, nauwkeurige informatie  geen verouderde trainingsgegevens",multiTool:"Multi-Tool Orkestratie",multiToolDesc:"Combineert naadloos webzoeken, code-uitvoering, YouTube-transcripties, beeldgeneratie en documentanalyse in n gesprek",knowledgeBase:"Kennisbank Integratie",knowledgeBaseDesc:"Sla bevindingen op in uw persoonlijke kennisbank, creer fragmenten en bouw uitgebreide onderzoeksdocumenten in de loop van de tijd",advancedPlanning:"Geavanceerde Planning",advancedPlanningDesc:"Genereer gestructureerde onderzoeksplannen met expert-persona's, zoekstrategien en methodologische benaderingen",costEffective:"Slimme Modelselectie",costEffectiveDesc:"Automatische selectie van modellen die het werk economisch of krachtig uitvoeren op basis van de selectiestrategie. Gebruik je eigen sleutels om 25% te besparen",transparency:"Volledige Transparantie",transparencyDesc:"Volg elke API-aanroep, token-gebruik en kosten in real-time facturatie-dashboard",perfectFor:"Perfect voor: Academisch onderzoek, marktanalyse, contentcreatie, technische documentatie, competitieve intelligentie en elke taak die grondig onderzoek vereist."},i7={placeholder:"Typ hier uw bericht...",send:"Verzenden",retry:"Opnieuw proberen",stop:"Stoppen",thinking:"Denken...",generating:"Antwoord genereren...",newChat:"Nieuwe chat",clearHistory:"Geschiedenis wissen",loadChat:"Chat laden",systemPrompt:"Systeemprompt",customInstructions:"Aangepaste instructies",temperature:"Temperatuur",maxTokens:"Max tokens",model:"Model",provider:"Provider",history:"Chatgeschiedenis",continue:"Doorgaan",regenerate:"Opnieuw genereren",edit:"Bewerken",delete:"Verwijderen",copy:"Kopiren",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Log in om deze functie te gebruiken",providerRequired:"Configureer minimaal n provider in Instellingen",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:"Alles selecteren",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},o7={title:"Onderzoeksplanning",query:"Onderzoeksvraag",generatePlan:"Plan genereren",savePlan:"Plan opslaan",loadSaved:"Load Saved",transferToChat:"Overdragen naar chat",clearAll:"Alles wissen",debug:"Debug",planning:"Plannen...",planGenerated:"Plan succesvol gegenereerd",noPlan:"Nog geen plan gegenereerd",enterQuery:"Voer uw onderzoeksvraag in",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},l7={title:"Instellingen",language:"Taal",selectLanguage:"Selecteer taal",providers:"Providers",cloudSync:"Cloudsynchronisatie",billing:"Facturering",general:"Algemeen",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"Stem",tts:"TTS",rag:"RAG"},appearance:"Uiterlijk",theme:"Thema",darkMode:"Donkere modus",lightMode:"Lichte modus",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},c7={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},u7={title:"Facturering",balance:"Saldo",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Kosten",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},d7={generic:"Er is een fout opgetreden",network:"Netwerkfout",timeout:"Request timed out",unauthorized:"Ongeautoriseerde toegang",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Probeer het opnieuw"},h7={title:"Kennisbank",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Zoek fragmenten...",noSnippets:"Geen fragmenten gevonden",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},p7={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},g7={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},f7={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},m7={title:"Feed",generateFeed:"Feed Genereren",generating:"Genereren...",refresh:"Vernieuwen",noItems:"Nog geen items",emptyMessage:"Je gepersonaliseerde feed verschijnt hier",emptySubMessage:"We genereren content op basis van je opgeslagen snippets en interesses",didYouKnow:"Wist je dat",questionAnswer:"Vraag & Antwoord",stash:"Opslaan",stashed:"Opgeslagen",trash:"Verwijderen",quiz:"Quiz",swipeLeft:"Veeg naar links om te verwijderen",swipeRight:"Veeg naar rechts om op te slaan",showMore:"Meer tonen",showLess:"Minder tonen",sources:"Bronnen",topics:"Onderwerpen",settings:{title:"Feed Instellingen",searchTerms:"Zoektermen",searchTermsDesc:"Definieer maximaal 5 zoekonderwerpen om je feed te personaliseren",addTerm:"Term Toevoegen",removeTerm:"Verwijderen",maxTerms:"Maximaal 5 zoektermen toegestaan",termExists:"Deze zoekterm bestaat al",placeholder:"bijv. 'kunstmatige intelligentie', 'klimaatnieuws'",learnedPreferences:"Geleerde Voorkeuren",likedTopics:"Favoriete Onderwerpen",dislikedTopics:"Ongewenste Onderwerpen",stashToLearn:"Sla items op om de feed te helpen leren wat je leuk vindt",trashToLearn:"Verwijder items om de feed te helpen leren wat te vermijden",tips:" Tips voor Betere Feeds",tipSpecific:"Wees specifiek met zoektermen",tipStash:"Sla interessante items op",tipTrash:"Verwijder irrelevante items om de kwaliteit te verbeteren",tipMix:"Mix brede en specifieke onderwerpen voor varieteit"}},y7={title:"Quiz",startQuiz:"Quiz Starten",nextQuestion:"Volgende Vraag",previousQuestion:"Vorige",submitAnswer:"Antwoord Indienen",viewResults:"Resultaten Bekijken",retakeQuiz:"Quiz Herhalen",score:"Score",correct:"Correct",incorrect:"Incorrect",question:"Vraag",of:"van",yourAnswer:"Jouw antwoord",correctAnswer:"Juiste antwoord",explanation:"Uitleg",generating:"Quiz genereren...",noQuizzes:"Nog geen quizzen",emptyMessage:"Genereer een quiz van een opgeslagen snippet of feed item",performance:"Quiz Prestaties",totalQuizzes:"Totaal Quizzen",averageScore:"Gemiddelde Score",questionsAnswered:"Beantwoorde Vragen",statistics:"Quiz Statistieken",subtitle:"Volg je leervoortgang en quizprestaties",createNewQuiz:"Nieuwe Quiz Maken",recentQuizzes:"Recente Quizzen",noQuizzesYet:"Nog geen voltooide quizzen",noQuizzesDescription:"Doe een quiz vanuit je opgeslagen inhoud in SWAG om je statistieken hier te zien",goToSwag:"Ga naar SWAG",backToChat:"Terug naar Chat",loadingStats:"Statistieken laden...",errorLoadingStats:"Fout bij het laden van quizstatistieken",confirmDelete:"Weet je zeker dat je de quiz '{{title}}' wilt verwijderen?",quizDeleted:"Quiz succesvol verwijderd",errorDeletingQuiz:"Fout bij het verwijderen van quiz",deleteQuiz:"Quiz verwijderen",today:"Vandaag",yesterday:"Gisteren",daysAgo:"{{days}} dagen geleden",snippetCount:"{{count}} fragment",snippetCount_plural:"{{count}} fragmenten",enriched:"Verrijkt",notSynced:"Niet Gesynchroniseerd",highestScore:"Hoogste Score",lowestScore:"Laagste Score"},b7={common:a7,auth:s7,chat:i7,planning:o7,settings:l7,languages:c7,billing:u7,errors:d7,swag:h7,tts:p7,playlist:g7,tools:f7,feed:m7,quiz:y7},x7={save:"Salvar",cancel:"Cancelar",delete:"Excluir",edit:"Editar",close:"Fechar",loading:"Carregando...",error:"Erro",success:"Sucesso",confirm:"Confirmar",back:"Voltar",next:"Prximo",submit:"Enviar",clear:"Limpar",search:"Buscar",filter:"Filtrar",export:"Exportar",import:"Importar",download:"Baixar",upload:"Enviar",copy:"Copiar",paste:"Colar",cut:"Recortar",undo:"Desfazer",redo:"Refazer",select:"Selecionar",selectAll:"Selecionar tudo",deselectAll:"Desselecionar tudo"},v7={signIn:"Entrar com Google",signInWithGoogle:"Entrar com Google",initializing:"Inicializando...",signOut:"Sair",authRequired:"A autenticao  necessria para usar este aplicativo",tokenExpired:"Sua sesso expirou. Por favor, entre novamente.",welcomeBack:"Bem-vindo de volta!",signInPrompt:"Entrar para continuar",signInRequired:"Voc deve entrar para usar este recurso",signingIn:"Entrando...",signingOut:"Saindo...",researchAgent:"Agente de Pesquisa",tagline:"Assistente de pesquisa com IA",secureAuth:"Autenticao segura fornecida pelo Google",whyChooseTitle:"Por que escolher o Research Agent?",whyChooseIntro:"Ao contrrio dos chatbots de IA padro que simplesmente respondem perguntas, o Research Agent  seu companheiro de pesquisa abrangente criado para investigao profunda e construo de conhecimento.",keyAdvantagesTitle:"Principais Vantagens:",webConnected:"Inteligncia Conectada  Web",webConnectedDesc:"Pesquisa web em tempo real e extrao de contedo garantem informaes atuais e precisas  no dados de treinamento desatualizados",multiTool:"Orquestrao Multi-Ferramentas",multiToolDesc:"Combina perfeitamente pesquisa web, execuo de cdigo, transcries do YouTube, gerao de imagens e anlise de documentos em uma nica conversa",knowledgeBase:"Integrao de Base de Conhecimento",knowledgeBaseDesc:"Salve descobertas em sua base de conhecimento pessoal, crie trechos e construa documentos de pesquisa abrangentes ao longo do tempo",advancedPlanning:"Planejamento Avanado",advancedPlanningDesc:"Gere planos de pesquisa estruturados com personas especializadas, estratgias de busca e abordagens metodolgicas",costEffective:"Seleo Inteligente de Modelos",costEffectiveDesc:"Seleo automtica de modelos que fazem o trabalho de forma econmica ou poderosa com base na estratgia de seleo. Traga suas prprias chaves para economizar 25%",transparency:"Transparncia Total",transparencyDesc:"Rastreie cada chamada de API, uso de tokens e custo no painel de cobrana em tempo real",perfectFor:"Perfeito para: Pesquisa acadmica, anlise de mercado, criao de contedo, documentao tcnica, inteligncia competitiva e qualquer tarefa que exija investigao minuciosa."},w7={placeholder:"Digite sua mensagem aqui...",send:"Enviar",retry:"Tentar novamente",stop:"Parar",thinking:"Pensando...",generating:"Gerando resposta...",newChat:"Nova conversa",clearHistory:"Limpar histrico",loadChat:"Carregar conversa",systemPrompt:"Prompt do sistema",customInstructions:"Instrues personalizadas",temperature:"Temperatura",maxTokens:"Mximo de tokens",model:"Modelo",provider:"Provedor",history:"Histrico de conversa",continue:"Continuar",regenerate:"Regenerar",edit:"Editar",delete:"Excluir",copy:"Copiar",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:"Por favor, entre para usar este recurso",providerRequired:"Configure pelo menos um provedor nas Configuraes",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:"Selecionar tudo",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},S7={title:"Planejamento de pesquisa",query:"Consulta de pesquisa",generatePlan:"Gerar plano",savePlan:"Salvar plano",loadSaved:"Load Saved",transferToChat:"Transferir para chat",clearAll:"Limpar tudo",debug:"Debug",planning:"Planejando...",planGenerated:"Plano gerado com sucesso",noPlan:"Nenhum plano gerado ainda",enterQuery:"Digite sua consulta de pesquisa",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},k7={title:"Configuraes",language:"Idioma",selectLanguage:"Selecionar idioma",providers:"Provedores",cloudSync:"Sincronizao na nuvem",billing:"Faturamento",general:"Geral",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"Voz",tts:"TTS",rag:"RAG"},appearance:"Aparncia",theme:"Tema",darkMode:"Modo escuro",lightMode:"Modo claro",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},T7={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},C7={title:"Faturamento",balance:"Saldo",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"Custo",tokens:"Tokens",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},E7={generic:"Ocorreu um erro",network:"Erro de rede",timeout:"Request timed out",unauthorized:"Acesso no autorizado",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:"Por favor, tente novamente"},_7={title:"Base de conhecimento",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:"Buscar trechos...",noSnippets:"Nenhum trecho encontrado",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},A7={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},N7={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},P7={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},I7={title:"Feed",generateFeed:"Gerar Feed",generating:"Gerando...",refresh:"Atualizar",noItems:"Ainda sem itens",emptyMessage:"Seu feed personalizado aparecer aqui",emptySubMessage:"Vamos gerar contedo baseado em seus trechos salvos e interesses",didYouKnow:"Voc sabia",questionAnswer:"Pergunta e Resposta",stash:"Guardar",stashed:"Guardado",trash:"Excluir",quiz:"Quiz",swipeLeft:"Deslize para a esquerda para excluir",swipeRight:"Deslize para a direita para guardar",showMore:"Mostrar mais",showLess:"Mostrar menos",sources:"Fontes",topics:"Tpicos",settings:{title:"Configuraes do Feed",searchTerms:"Termos de Busca",searchTermsDesc:"Defina at 5 tpicos de busca para personalizar seu feed",addTerm:"Adicionar Termo",removeTerm:"Remover",maxTerms:"Mximo de 5 termos de busca permitidos",termExists:"Este termo de busca j existe",placeholder:"ex. 'inteligncia artificial', 'notcias climticas'",learnedPreferences:"Preferncias Aprendidas",likedTopics:"Tpicos Favoritos",dislikedTopics:"Tpicos Indesejados",stashToLearn:"Guarde itens para ajudar o feed a aprender o que voc gosta",trashToLearn:"Exclua itens para ajudar o feed a aprender o que evitar",tips:" Dicas para Feeds Melhores",tipSpecific:"Seja especfico com os termos de busca",tipStash:"Guarde itens que voc acha interessantes",tipTrash:"Exclua itens irrelevantes para melhorar a qualidade",tipMix:"Misture tpicos amplos e especficos para variedade"}},R7={title:"Quiz",startQuiz:"Iniciar Quiz",nextQuestion:"Prxima Pergunta",previousQuestion:"Anterior",submitAnswer:"Enviar Resposta",viewResults:"Ver Resultados",retakeQuiz:"Refazer Quiz",score:"Pontuao",correct:"Correto",incorrect:"Incorreto",question:"Pergunta",of:"de",yourAnswer:"Sua resposta",correctAnswer:"Resposta correta",explanation:"Explicao",generating:"Gerando quiz...",noQuizzes:"Ainda sem quizzes",emptyMessage:"Gere um quiz de qualquer trecho salvo ou item do feed",performance:"Desempenho no Quiz",totalQuizzes:"Total de Quizzes",averageScore:"Pontuao Mdia",questionsAnswered:"Perguntas Respondidas",statistics:"Estatsticas do Quiz",subtitle:"Acompanhe seu progresso de aprendizado e desempenho em quizzes",createNewQuiz:"Criar Novo Quiz",recentQuizzes:"Quizzes Recentes",noQuizzesYet:"Nenhum quiz completado ainda",noQuizzesDescription:"Faa um quiz do seu contedo salvo no SWAG para ver suas estatsticas aqui",goToSwag:"Ir para SWAG",backToChat:"Voltar ao Chat",loadingStats:"Carregando estatsticas...",errorLoadingStats:"Falha ao carregar estatsticas do quiz",confirmDelete:"Tem certeza de que deseja excluir o quiz '{{title}}'?",quizDeleted:"Quiz excludo com sucesso",errorDeletingQuiz:"Falha ao excluir quiz",deleteQuiz:"Excluir quiz",today:"Hoje",yesterday:"Ontem",daysAgo:"H {{days}} dias",snippetCount:"{{count}} trecho",snippetCount_plural:"{{count}} trechos",enriched:"Enriquecido",notSynced:"No Sincronizado",highestScore:"Pontuao Mais Alta",lowestScore:"Pontuao Mais Baixa"},D7={common:x7,auth:v7,chat:w7,planning:S7,settings:k7,languages:T7,billing:C7,errors:E7,swag:_7,tts:A7,playlist:N7,tools:P7,feed:I7,quiz:R7},L7={save:"",cancel:"",delete:"",edit:"",close:"",loading:"...",error:"",success:"",confirm:"",back:"",next:"",submit:"",clear:"",search:"",filter:"",export:"",import:"",download:"",upload:"",copy:"",paste:"",cut:"",undo:"",redo:"",select:"",selectAll:" ",deselectAll:" "},M7={signIn:"  Google",signInWithGoogle:"  Google",initializing:"...",signOut:"",authRequired:"     ",tokenExpired:"  . ,  .",welcomeBack:" !",signInPrompt:",  ",signInRequired:"  ,    ",signingIn:"...",signingOut:"...",researchAgent:" ",tagline:"    ",secureAuth:"   Google",whyChooseTitle:"   Research Agent?",whyChooseIntro:"    AI-,     , Research Agent       ,       .",keyAdvantagesTitle:" :",webConnected:",   ",webConnectedDesc:"        ,       ",multiTool:"  ",multiToolDesc:"  -,  ,  YouTube,        ",knowledgeBase:"  ",knowledgeBaseDesc:"     ,         ",advancedPlanning:" ",advancedPlanningDesc:"      ,     ",costEffective:"  ",costEffectiveDesc:"  ,          .    ,   25%",transparency:" ",transparencyDesc:"   API,           ",perfectFor:" :  ,  ,  ,  ,     ,   ."},O7={placeholder:"   ...",send:"",retry:"",stop:"",thinking:"...",generating:" ...",newChat:" ",clearHistory:" ",loadChat:" ",systemPrompt:" ",customInstructions:" ",temperature:"",maxTokens:". ",model:"",provider:"",history:" ",continue:"",regenerate:"",edit:"",delete:"",copy:"",copied:"Copied!",selectFiles:"Select Files",attachFiles:"Attach Files",pasteImage:"Paste Image",recording:"Recording...",voiceInput:"Voice Input",stopRecording:"Stop Recording",processing:"Processing...",noMessages:"No messages yet. Start a conversation!",clearConfirm:"Are you sure you want to clear all messages?",deleteConfirm:"Are you sure you want to delete this message?",loadingHistory:"Loading chat history...",savingChat:"Saving chat...",chatSaved:"Chat saved successfully",chatLoaded:"Chat loaded successfully",errorSaving:"Error saving chat",errorLoading:"Error loading chat",signInRequired:", ,    ",providerRequired:"      ",messageError:"Error sending message",streamError:"Error in message stream",toolExecution:"Executing tool...",toolExecuted:"Tool executed successfully",toolError:"Tool execution error",searchingWeb:"Searching the web...",scrapingContent:"Scraping content...",transcribingAudio:"Transcribing audio...",generatingImage:"Generating image...",generatingChart:"Generating chart...",executingCode:"Executing code...",planningMode:"Planning Mode",exitPlanning:"Exit Planning",startPlanning:"Start Planning",mcpServers:"MCP Servers",addMCPServer:"Add MCP Server",mcpServerName:"Server Name",mcpServerUrl:"Server URL",exampleServers:"Example Servers",officialServers:"Official MCP Servers",sampleServers:"Sample Servers",instructions:"Instructions",availableTools:"Available Tools",enableServer:"Enable Server",disableServer:"Disable Server",removeServer:"Remove Server",serverAdded:"Server added successfully",serverRemoved:"Server removed successfully",invalidUrl:"Invalid URL format",nameRequired:"Server name is required",urlRequired:"Server URL is required",chatHistory:"Chat History",examples:"Examples",attachContext:"Attach Context",attachContextTooltip:"Attach knowledge base snippets as context for this conversation",searchProvider:"Search Provider:",functionCall:"Function Call:",code:"Code:",arguments:"Arguments:",callId:"Call ID:",result:"Result:",url:"URL:",viewRawHtml:"View raw uncompressed HTML",copyOutputToClipboard:"Copy output to clipboard",copyCodeToClipboard:"Copy code to clipboard",captureToSwag:"Capture to Swag",captureOutputToSwag:"Capture output to Swag",captureCodeToSwag:"Capture code to Swag",grabImage:"Grab image",noSummarization:"No summarization",usingProxy:"Using proxy for enhanced privacy and bot detection evasion",contentExtracted:"Content intelligently extracted",truncatedToFit:"Truncated to fit model",scrapeMethod:"Scrape Method:",tier:"Tier",scrapeTime:"Scrape Time:",totalTime:"Total Time:",format:"Format:",originalSize:"Original Size:",compressedSize:"Compressed Size:",compression:"Compression:",compressionStrategy:"Compression Strategy:",basicExtraction:"Basic extraction",rawHtml:"Raw HTML ({{count}} chars)",rawText:"Raw Text ({{count}} chars)",contentProcessingPipeline:"Content Processing Pipeline:",size:"Size:",titlePrompt:"Title/Prompt",finalPrompt:"Final Prompt",deleteChat:"Delete Chat",clearAllChats:"Clear All Chats",confirmClearAll:"Are you sure you want to clear all chat history?",confirmDelete:"Are you sure you want to delete this chat?",noChatsYet:"No chats yet",startChatting:"Start chatting to see history here",chatDeleted:"Chat deleted",allChatsCleared:"All chats cleared",chatTitle:"Chat Title",enterChatTitle:"Enter a title for this chat...",signInToChat:"Please sign in to start chatting",streamingResponse:"Streaming response...",imageAddedToSwag:"Image added to Swag!",imageAddedWithoutConversion:"Image added to Swag (without conversion)!",contentCapturedToSwag:"Content captured to Swag!",contentCapturedWithoutConversion:"Content captured to Swag (without image conversion)!",planningTransferred:"Planning prompts transferred to new chat",failedToTransfer:"Failed to transfer planning data",addedToPlaylist:"Added {{count}} video{{plural}} to playlist",transcriptionStopped:"Transcription stopped",failedToStopTranscription:"Failed to stop transcription: {{error}}",fileTypeNotSupported:"File type not supported: {{name}}. Supported types: JPEG, PNG, GIF, WebP, PDF",fileTooLarge:"File too large: {{name}} ({{size}}MB). Max size: {{maxSize}}MB",imageTokenWarning:"Image {{name}} may use many tokens (~{{tokens}}k). Consider using a smaller image.",fileAdded:"Added {{name}}",failedToProcess:"Failed to process {{name}}",signInToSendMessages:"Please sign in to send messages",foundRelevantChunks:" Found {{count}} relevant chunks from knowledge base",noRelevantContext:"No relevant context found in knowledge base",failedToRetrieveRag:"Failed to retrieve RAG context, continuing without it",sessionExpired:"Your session has expired. Please sign in again.",todoLimitReached:"Todo auto-progression limit reached. Please continue manually.",snippetSaved:"Saved snippet: {{title}}",snippetDeleted:"Deleted snippet: {{title}}",copiedToClipboard:"Copied to clipboard!",outputCopied:"Output copied to clipboard!",codeCopied:"Code copied to clipboard!",inputPlaceholder:"Type your message... (Shift+Enter for new line,  for history)",continueProcessing:"Continue Processing",stopGenerating:"Stop generating response",sendMessage:"Send message",chatMessageInput:"Chat message input",editPlan:"Edit Plan",makeAPlan:"Make A Plan",close:"Close",failedToLoadChat:"Failed to load chat",mcpServerNamePlaceholder:"Server Name (e.g., filesystem, github)",mcpServerUrlPlaceholder:"Server URL (e.g., http://localhost:3000)",noMcpServers:"No MCP servers configured",addServer:"Add Server",remove:"Remove",chatHistoryTitle:"Chat History",noChatHistory:"No chat history found. Start a conversation to save it automatically.",allChatHistoryCleared:"All chat history cleared",loadChatSuccess:"Chat loaded successfully",examplesTitle:"Chat Examples",tryExample:"Try this example",attachContextTitle:"Attach Context from Swag",snippetsAttached:"{{count}} snippet{{plural}} attached",attachSnippets:"Attach Snippets",searchSnippets:"Search snippets...",selectAll:" ",selectNone:"Select None",deleteSelected:"Delete Selected",cancel:"Cancel",load:"Load",confirmDeleteChat:"Are you sure you want to delete this chat?",confirmClearHistory:"Are you sure you want to clear all chat history?",confirmDeleteSelected:"Are you sure you want to delete {{count}} selected chat{{plural}}?",chatLoadedFrom:"Loaded from",chatSavedAt:"Saved at",noTitle:"No title",clearAttachedSnippets:"Clear all attached snippets",mcpServerConfiguration:"MCP Server Configuration",typeMessageFirst:"Type a message first",typeMessage:"Type a message",signInToSend:"Please sign in to send messages"},j7={title:" ",query:" ",generatePlan:" ",savePlan:" ",loadSaved:"Load Saved",transferToChat:"  ",clearAll:" ",debug:"Debug",planning:"...",planGenerated:"  ",noPlan:"   ",enterQuery:"   ",researchFocus:"Research Focus",methodology:"Methodology",expectedOutcome:"Expected Outcome",initializing:"Initializing...",processing:"Processing...",signInToGenerate:"Sign in to Generate Plan",generating:"Generating...",signInToUsePlanning:"Please sign in to use planning",signInRequired:"Please sign in with Google to use the planning feature",authExpired:"Authentication expired. Please sign out and sign in again to continue.",authRequired:"Authentication required. Please sign in with Google to continue.",enterResearchQuestion:"Please enter a research question",debugCopied:"Debug info copied to clipboard!",debugCopyFailed:"Failed to copy debug info",savePlanTooltip:"Save the current plan to your saved plans list",loadSavedPlans:"Load Saved Plans",debugTooltip:"Copy debug info for Copilot troubleshooting",transferTooltip:"Transfer to Chat",clearAllTooltip:"Clear all planning data and start fresh",systemPromptEditable:"Generated System Prompt (Editable):",systemPromptHelp:"This defines the AI's role and behavior. Edit as needed before transferring to chat.",userQueryEditable:"Generated User Query (Editable):",userQueryHelp:"This is the message that will be sent to the chat. Edit to refine your query.",generatedPrompts:"Generated Prompts",llmInfoTooltip:"View LLM transparency info (model, tokens, cost)",llmCalls:"call",llmCallsPlural:"calls",cannotSavePlan:"Cannot save plan: No valid plan generated",planSavedSuccess:"Plan saved successfully",planSaveFailed:"Failed to save plan",loadSavedPlan:"Load Saved Plan",storage:"Storage",storageWarning:"Storage is {{percentage}}% full",storageWarningHelp:"Consider deleting old plans to free up space.",noSavedPlans:"No saved plans found",saved:"Saved",load:"Load",simpleQueryDetected:"Simple Query Detected",simpleQueryHelp:"This query can be answered directly without extensive planning.",comprehensiveResearchPlan:" Comprehensive Research Plan",analysisSummary:" Analysis Summary",queryType:"Query Type:",complexity:"Complexity:",researchApproach:"Research Approach:",estimatedSources:"Estimated Sources:",reasoning:"Reasoning:",expertPersona:" Expert Persona",searchQueries:" Search Queries:",researchQuestions:" Research Questions:",suggestedSources:" Suggested Sources:",sources:"Sources:",variousRelevantSources:"Various relevant sources",researchMethodology:" Research Methodology:",enhancedSystemPrompt:" Enhanced System Prompt:",enhancedUserPrompt:" Enhanced User Prompt:",debugRawLlmResponse:" Debug: Raw LLM Response Fields",longFormDocumentPlan:" Long-Form Document Plan",longFormNote:"Note: This will be built in stages using snippets. Each section will be researched and written separately, then combined into a final document.",documentStructure:" Document Structure:",keywords:"Keywords:",workflow:" Workflow:",needMoreInfo:" Need More Information",pleaseClarify:"Please clarify:",updateQueryDetails:"Update your query with more details:",provideMoreDetails:"Provide more specific details...",regeneratePlanWithClarifications:"Regenerate Plan with Clarifications",moreInfoRequired:" More Info Required",planType:"Plan Type:",detectedComplexityPatterns:" Detected Complexity Patterns:",estimatedIterations:"Estimated Iterations",toolsRequired:"Tools Required",suggestedWorkflow:" Suggested Workflow:",requiredTools:" Required Tools:",guidanceQuestions:" Please answer these questions to refine your plan:",updatePromptWithAnswers:"Update your research prompt with answers:",guidanceTip:" Tip: Include answers to the questions above in your updated query. The more specific you are, the better the AI can create an effective multi-iteration plan with proper tool usage and few-shot examples.",guidanceExamplePlaceholder:`Example: I want to build a comprehensive research report on climate change by:
1. Creating 25 todos for different sub-topics (policy, science, economics, etc.)
2. Searching the web for each topic and saving results to snippets
3. Generating charts to visualize key data points
4. Combining all snippets into a master analysis

Please create a detailed plan with few-shot examples showing how to use create_todo, search_web, create_snippet, and generate_chart together in each iteration...`,generateDetailedExecutionPlan:" Generate Detailed Execution Plan",forcePlan:" Force Plan",forcePlanTooltip:"Let AI answer the questions and force plan generation",reset:" Reset",resetTooltip:"Clear guidance mode and return to previous state",aboutGuidanceMode:"About Guidance Mode:",guidanceModeHelp:"This mode detects complex projects that require multiple iterations and extensive tool usage. Answer the questions above to help create a detailed execution plan with few-shot examples showing how to use todos, snippets, and multiple tool calls per iteration.",forcingPlan:"Forcing plan generation...",forcePlanError:"Force plan error",forcePlanFailed:"Force plan failed",clarificationAnswer:"Please use your best judgment based on the original query."},B7={title:"",language:"",selectLanguage:" ",providers:"",cloudSync:" ",billing:"",general:"",generalDescription:"Configure general application settings including language and display preferences",languageHelp:"Changes the interface language and instructs the AI to respond in your selected language",providerCredentials:"Provider Credentials",providerDescription:"Configure your LLM provider API keys. The backend automatically selects the best model for each request",modelSelectionStrategy:"Model Selection Strategy",modelStrategyDescription:"Choose how the system selects models for your requests. This balances cost, quality, and performance",cheap:"Cheap (Recommended)",cheapDescription:"Prioritize free providers (Groq, Gemini) and smallest capable models. Falls back to paid providers only when rate-limited. Best for most use cases",balanced:"Balanced",balancedDescription:"Choose models that reliably do the job without compromising quality. Uses free tier when quality is equivalent, paid models when quality matters. Balances cost vs. capability",powerful:"Powerful",powerfulDescription:"Use the best available models (GPT-4o, Gemini 2.5 Pro, o1) for maximum capability. Prioritizes quality over cost. Uses reasoning models for complex analysis",fastest:"Fastest",fastestDescription:"Prioritize low-latency models (Groq) for quick responses. May sacrifice some quality for speed in simple requests. Great for interactive sessions",tavilyApiKey:"Tavily API Key (Optional)",tavilyPlaceholder:"tvly-...",tavilyHelp:"Enables enhanced web search and scraping via Tavily API. Falls back to DuckDuckGo if not provided",enabledTools:"Enabled Tools",webSearch:"Web Search",webSearchDescription:"Search the web for current information, news, and articles",executeJs:"JavaScript Execution",executeJsDescription:"Execute JavaScript code for calculations and data processing",scrapeUrl:"Web Scraping",scrapeUrlDescription:"Extract content from specific URLs and websites",youtubeSearch:"YouTube Search",youtubeDescription:"Search YouTube for videos with transcript support",transcribe:"Transcribe Audio/Video",transcribeDescription:"Convert audio and video files to text transcriptions",generateChart:"Generate Charts",chartDescription:"Create visualizations and charts from data",generateImage:"Generate Images",imageDescription:"Create AI-generated images from text descriptions",searchKnowledgeBase:"Search Knowledge Base",ragDescription:"Search through uploaded documents and knowledge base",manageTodos:"Manage To-Dos",todosDescription:"Create and manage task lists and reminders",manageSnippets:"Manage Snippets",snippetsDescription:"Save and retrieve code snippets and text",askLlm:"Ask LLM",askLlmDescription:"Delegate sub-questions to other LLM instances",generateReasoning:"Generate Reasoning Chain",reasoningDescription:"Step-by-step analytical reasoning for complex problems",proxySettings:"Proxy Configuration",proxyDescription:"Configure HTTP/HTTPS proxy for web requests",enableProxy:"Enable Proxy",proxyUrl:"Proxy URL",proxyUrlPlaceholder:"http://proxy.example.com:8080",proxyUsername:"Username (Optional)",proxyPassword:"Password (Optional)",locationServices:"Location Services",locationDescription:"Use your location for localized search results and region-specific information",enableLocation:"Enable Location Services",locationHelp:"Allows web searches to return locally relevant results",currentLocation:"Current Location",requestLocation:"Request Location",clearLocation:"Clear Location",locationPermission:"Location Permission",permissionGranted:"Granted",permissionDenied:"Denied",permissionPrompt:"Not requested",tabs:{general:"General",provider:"Provider",cloud:"Cloud Sync",tools:"Tools",proxy:"Proxy",location:"Location",voice:"",tts:"TTS",rag:"RAG"},appearance:" ",theme:"",darkMode:" ",lightMode:" ",notifications:"Notifications",privacy:"Privacy",accessibility:"Accessibility",fontSize:"Font Size",lineHeight:"Line Height"},F7={en:"English",es:"Espaol",fr:"Franais",de:"Deutsch",zh:"",ja:"",ar:"",nl:"Nederlands",pt:"Portugus",ru:""},z7={title:"",balance:"",totalCost:"Total Cost",totalTokens:"Total Tokens",totalRequests:"Total Requests",cost:"",tokens:"",tokensIn:"Tokens In",tokensOut:"Tokens Out",timestamp:"Timestamp",noTransactions:"No transactions yet",creditsPurchased:"Credits purchased successfully",insufficientCredits:"Insufficient credits",purchaseCredits:"Add Credit",amount:"Amount",paymentMethod:"Payment Method",transactions:"Transactions",overview:"Overview",exportCSV:"Export CSV",clearData:"Clear Data",clearDataConfirm:"Are you sure you want to clear billing data?",dataClearedSuccess:" Success: Cleared {{count}} transactions. {{remaining}} remaining.",dataClearError:" Error: {{message}}",noDataToExport:"No data to export",startDate:"Start Date",endDate:"End Date",type:"Type",provider:"Provider",model:"Model",duration:"Duration",status:"Status",allTypes:"All Types",allProviders:"All Providers",clearFilters:"Clear Filters",quickRanges:"Quick ranges:",today:"Today",last7Days:"Last 7 Days",last30Days:"Last 30 Days",thisMonth:"This Month",byType:"By Type",byProvider:"By Provider",byModel:"By Model",requests:"Requests",groupByRequestId:" Group by Request ID",itemsPerPage:"per page",totalRequestGroups:"{{count}} total request groups (showing {{showing}}), {{ungrouped}} ungrouped",totalTransactionsShowing:"{{total}} total transactions (showing {{showing}})",requestGroup:" Request Group ({{count}} transactions)",signInRequired:" Sign In Required",signInToViewBilling:"Please sign in with Google to view your billing data.",howToAccessBilling:" How to Access Billing Data:",signInStep1:'Click the "Sign in with Google" button in the top navigation bar',signInStep2:"That's it! Your billing data will load automatically",billingDataNote:" Your billing data is stored in a centralized service account Google Sheet and retrieved automatically. No additional permissions or Drive access needed - just sign in with Google.",debugInfo:" Debug Info",loading:"Loading billing data...",errorLoading:" Error Loading Billing Data",retry:" Retry",noBillingData:"No billing data available. Please wait...",noTransactionsMessage:"No transactions found",noBillingDataYet:" No Billing Data Yet",startUsingChat:"Start using the chat to generate billing records. All API usage is automatically tracked.",refresh:" Refresh",usageOnly:"Usage only (excl. credits)",totalCredits:"Total Credits",userQueries:"User Queries",llmCalls:"LLM Calls",userQueriesLlmCalls:"User Queries / LLM Calls",newBalance:"New balance:",creditsToAdd:"Credits to add:",minimumPurchase:"Minimum purchase is $5.00",addCreditsTitle:" Add Credits",purchaseCreditsDescription:"Purchase credits to use AI features. Minimum purchase: $5.00",enterAmount:"Enter amount (min $5.00)",tipUseOwnKeys:" Tip: Add your own API keys in Settings for $0 LLM costs! Only infrastructure costs apply when using your own keys.",loadingPayPal:"Loading PayPal...",paypalNotLoaded:" PayPal SDK not loaded. Please refresh the page.",close:"Close",clearBillingData:"Clear Billing Data",clearDataWarning:" Warning: This action cannot be undone. Your billing data will be permanently deleted.",clearAll:"Clear All",clearByProvider:"Clear by Provider",clearByDateRange:"Clear by Date Range",clearAllDescription:"This will delete all transactions from your billing sheet.",considerExportFirst:"Consider exporting to CSV first for your records.",selectProvider:"Select Provider:",selectProviderPlaceholder:"-- Select Provider --",clearProviderHint:"Useful for aligning with provider billing cycles (e.g., clear monthly).",clearDateRangeHint:"Leave blank to clear from beginning/to end. Both can be used together.",confirmUndoCheckbox:"I understand this action cannot be undone",cancel:"Cancel",page:"Page",of:"of",first:" First",prev:" Prev",next:"Next ",last:"Last ",types:{chat:"Chat",embedding:"Embedding",guardrail_input:" Guardrail Input",guardrail_output:" Guardrail Output",planning:"Planning",assessment:"Assessment",image_generation:" Image Generation",tts:" Text-to-Speech",chat_iteration:"Chat Iteration",credit_added:"Credit Added",summary:"Summary",lambda_invocation:"Lambda Invocation"}},$7={generic:" ",network:" ",timeout:"Request timed out",unauthorized:" ",forbidden:"Access forbidden",notFound:"Resource not found",serverError:"Server error",validationError:"Validation error",tryAgain:",  "},U7={title:" ",newSnippet:"New Snippet",editSnippet:"Edit Snippet",deleteSnippet:"Delete Snippet",searchSnippets:" ...",noSnippets:"  ",tags:"Tags",addTag:"Add Tag",removeTag:"Remove Tag",filterByTag:"Filter by Tag",content:"Content",created:"Created",modified:"Modified",source:"Source"},q7={readAloud:"Read Aloud",stopReading:"Stop Reading",pauseReading:"Pause Reading",resumeReading:"Resume Reading",voice:"Voice",speed:"Speed",volume:"Volume",provider:"TTS Provider"},H7={title:"Playlist",addToPlaylist:"Add to Playlist",removeFromPlaylist:"Remove from Playlist",playNext:"Play Next",playNow:"Play Now",clearPlaylist:"Clear Playlist",emptyPlaylist:"Playlist is empty"},G7={search:"Web Search",scrape:"Scrape Content",transcribe:"Transcribe",youtube:"YouTube",javascript:"Execute JavaScript",generateChart:"Generate Chart",generateImage:"Generate Image"},V7={title:"",generateFeed:" ",generating:"...",refresh:"",noItems:"  ",emptyMessage:"    ",emptySubMessage:"         ",didYouKnow:"  ",questionAnswer:"  ",stash:"",stashed:"",trash:"",quiz:"",swipeLeft:" ,  ",swipeRight:" ,  ",showMore:" ",showLess:" ",sources:"",topics:"",settings:{title:" ",searchTerms:" ",searchTermsDesc:"  5      ",addTerm:" ",removeTerm:"",maxTerms:" 5  ",termExists:"    ",placeholder:", ' ', ' '",learnedPreferences:" ",likedTopics:" ",dislikedTopics:" ",stashToLearn:" ,    ,   ",trashToLearn:" ,    ,  ",tips:"    ",tipSpecific:"    ",tipStash:"  ",tipTrash:"     ",tipMix:"      "}},W7={title:"",startQuiz:" ",nextQuestion:" ",previousQuestion:"",submitAnswer:" ",viewResults:" ",retakeQuiz:" ",score:"",correct:"",incorrect:"",question:"",of:"",yourAnswer:" ",correctAnswer:" ",explanation:"",generating:" ...",noQuizzes:"  ",emptyMessage:"        ",performance:" ",totalQuizzes:" ",averageScore:" ",questionsAnswered:" ",statistics:" ",subtitle:"       ",createNewQuiz:"  ",recentQuizzes:" ",noQuizzesYet:"   ",noQuizzesDescription:"      SWAG,     ",goToSwag:"  SWAG",backToChat:"  ",loadingStats:" ...",errorLoadingStats:"    ",confirmDelete:" ,     '{{title}}'?",quizDeleted:"  ",errorDeletingQuiz:"   ",deleteQuiz:" ",today:"",yesterday:"",daysAgo:"{{days}}  ",snippetCount:"{{count}} ",snippetCount_plural:"{{count}} ",enriched:"",notSynced:" ",highestScore:" ",lowestScore:" "},Y7={common:L7,auth:M7,chat:O7,planning:j7,settings:B7,languages:F7,billing:z7,errors:$7,swag:U7,tts:q7,playlist:H7,tools:G7,feed:V7,quiz:W7};ws.use(uP).use(jF).init({resources:{en:{translation:w8},es:{translation:O8},fr:{translation:X8},de:{translation:h9},zh:{translation:_9},ja:{translation:U9},ar:{translation:n7},nl:{translation:b7},pt:{translation:D7},ru:{translation:Y7}},fallbackLng:"en",interpolation:{escapeValue:!1},detection:{order:["localStorage","navigator"],caches:["localStorage"]}});const Q7="modulepreload",K7=function(t){return"/"+t},OE={},Zt=function(e,r,n){let a=Promise.resolve();if(r&&r.length>0){let c=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=i?.nonce||i?.getAttribute("nonce");a=c(r.map(d=>{if(d=K7(d),d in OE)return;OE[d]=!0;const p=d.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":Q7,p||(m.as="script"),m.crossOrigin="",m.href=d,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((y,x)=>{m.addEventListener("load",y),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return a.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})};/**
 * react-router v7.9.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var jE="popstate";function X7(t={}){function e(n,a){let{pathname:s,search:i,hash:l}=n.location;return _w("",{pathname:s,search:i,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:Ag(a)}return Z7(e,r,null,t)}function fa(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function bo(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function J7(){return Math.random().toString(36).substring(2,10)}function BE(t,e){return{usr:t.state,key:t.key,idx:e}}function _w(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?kh(e):e,state:r,key:e&&e.key||n||J7()}}function Ag({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function kh(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function Z7(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,l="POP",c=null,d=p();d==null&&(d=0,i.replaceState({...i.state,idx:d},""));function p(){return(i.state||{idx:null}).idx}function g(){l="POP";let T=p(),k=T==null?null:T-d;d=T,c&&c({action:l,location:w.location,delta:k})}function m(T,k){l="PUSH";let _=_w(w.location,T,k);d=p()+1;let P=BE(_,d),F=w.createHref(_);try{i.pushState(P,"",F)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;a.location.assign(F)}s&&c&&c({action:l,location:w.location,delta:1})}function y(T,k){l="REPLACE";let _=_w(w.location,T,k);d=p();let P=BE(_,d),F=w.createHref(_);i.replaceState(P,"",F),s&&c&&c({action:l,location:w.location,delta:0})}function x(T){return ez(T)}let w={get action(){return l},get location(){return t(a,i)},listen(T){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(jE,g),c=T,()=>{a.removeEventListener(jE,g),c=null}},createHref(T){return e(a,T)},createURL:x,encodeLocation(T){let k=x(T);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:m,replace:y,go(T){return i.go(T)}};return w}function ez(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),fa(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:Ag(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function dP(t,e,r="/"){return tz(t,e,r,!1)}function tz(t,e,r,n){let a=typeof e=="string"?kh(e):e,s=Dl(a.pathname||"/",r);if(s==null)return null;let i=hP(t);rz(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=pz(s);l=dz(i[c],d,n)}return l}function hP(t,e=[],r=[],n="",a=!1){let s=(i,l,c=a,d)=>{let p={relativePath:d===void 0?i.path||"":d,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&c)return;fa(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let g=Nl([n,p.relativePath]),m=r.concat(p);i.children&&i.children.length>0&&(fa(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),hP(i.children,e,m,g,c)),!(i.path==null&&!i.index)&&e.push({path:g,score:cz(g,i.index),routesMeta:m})};return t.forEach((i,l)=>{if(i.path===""||!i.path?.includes("?"))s(i,l);else for(let c of pP(i.path))s(i,l,!0,c)}),e}function pP(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=pP(n.join("/")),l=[];return l.push(...i.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function rz(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:uz(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var nz=/^:[\w-]+$/,az=3,sz=2,iz=1,oz=10,lz=-2,FE=t=>t==="*";function cz(t,e){let r=t.split("/"),n=r.length;return r.some(FE)&&(n+=lz),e&&(n+=sz),r.filter(a=>!FE(a)).reduce((a,s)=>a+(nz.test(s)?az:s===""?iz:oz),n)}function uz(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function dz(t,e,r=!1){let{routesMeta:n}=t,a={},s="/",i=[];for(let l=0;l<n.length;++l){let c=n[l],d=l===n.length-1,p=s==="/"?e:e.slice(s.length)||"/",g=A0({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},p),m=c.route;if(!g&&d&&r&&!n[n.length-1].route.index&&(g=A0({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},p)),!g)return null;Object.assign(a,g.params),i.push({params:a,pathname:Nl([s,g.pathname]),pathnameBase:yz(Nl([s,g.pathnameBase])),route:m}),g.pathnameBase!=="/"&&(s=Nl([s,g.pathnameBase]))}return i}function A0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=hz(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((d,{paramName:p,isOptional:g},m)=>{if(p==="*"){let x=l[m]||"";i=s.slice(0,s.length-x.length).replace(/(.)\/+$/,"$1")}const y=l[m];return g&&!y?d[p]=void 0:d[p]=(y||"").replace(/%2F/g,"/"),d},{}),pathname:s,pathnameBase:i,pattern:t}}function hz(t,e=!1,r=!0){bo(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function pz(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return bo(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Dl(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function gz(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?kh(t):t;return{pathname:r?r.startsWith("/")?r:fz(r,e):e,search:bz(n),hash:xz(a)}}function fz(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function gv(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function mz(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function gP(t){let e=mz(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function fP(t,e,r,n=!1){let a;typeof t=="string"?a=kh(t):(a={...t},fa(!a.pathname||!a.pathname.includes("?"),gv("?","pathname","search",a)),fa(!a.pathname||!a.pathname.includes("#"),gv("#","pathname","hash",a)),fa(!a.search||!a.search.includes("#"),gv("#","search","hash",a)));let s=t===""||a.pathname==="",i=s?"/":a.pathname,l;if(i==null)l=r;else{let g=e.length-1;if(!n&&i.startsWith("..")){let m=i.split("/");for(;m[0]==="..";)m.shift(),g-=1;a.pathname=m.join("/")}l=g>=0?e[g]:"/"}let c=gz(a,l),d=i&&i!=="/"&&i.endsWith("/"),p=(s||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||p)&&(c.pathname+="/"),c}var Nl=t=>t.join("/").replace(/\/\/+/g,"/"),yz=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),bz=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,xz=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function vz(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var mP=["POST","PUT","PATCH","DELETE"];new Set(mP);var wz=["GET",...mP];new Set(wz);var Th=N.createContext(null);Th.displayName="DataRouter";var Py=N.createContext(null);Py.displayName="DataRouterState";N.createContext(!1);var yP=N.createContext({isTransitioning:!1});yP.displayName="ViewTransition";var Sz=N.createContext(new Map);Sz.displayName="Fetchers";var kz=N.createContext(null);kz.displayName="Await";var Xo=N.createContext(null);Xo.displayName="Navigation";var Xg=N.createContext(null);Xg.displayName="Location";var Jo=N.createContext({outlet:null,matches:[],isDataRoute:!1});Jo.displayName="Route";var yS=N.createContext(null);yS.displayName="RouteError";function Tz(t,{relative:e}={}){fa(Jg(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=N.useContext(Xo),{hash:a,pathname:s,search:i}=Zg(t,{relative:e}),l=s;return r!=="/"&&(l=s==="/"?r:Nl([r,s])),n.createHref({pathname:l,search:i,hash:a})}function Jg(){return N.useContext(Xg)!=null}function xo(){return fa(Jg(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(Xg).location}var bP="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function xP(t){N.useContext(Xo).static||N.useLayoutEffect(t)}function Xi(){let{isDataRoute:t}=N.useContext(Jo);return t?jz():Cz()}function Cz(){fa(Jg(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Th),{basename:e,navigator:r}=N.useContext(Xo),{matches:n}=N.useContext(Jo),{pathname:a}=xo(),s=JSON.stringify(gP(n)),i=N.useRef(!1);return xP(()=>{i.current=!0}),N.useCallback((c,d={})=>{if(bo(i.current,bP),!i.current)return;if(typeof c=="number"){r.go(c);return}let p=fP(c,JSON.parse(s),a,d.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Nl([e,p.pathname])),(d.replace?r.replace:r.push)(p,d.state,d)},[e,r,s,a,t])}N.createContext(null);function gxe(){let{matches:t}=N.useContext(Jo),e=t[t.length-1];return e?e.params:{}}function Zg(t,{relative:e}={}){let{matches:r}=N.useContext(Jo),{pathname:n}=xo(),a=JSON.stringify(gP(r));return N.useMemo(()=>fP(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function Ez(t,e){return vP(t,e)}function vP(t,e,r,n,a){fa(Jg(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=N.useContext(Xo),{matches:i}=N.useContext(Jo),l=i[i.length-1],c=l?l.params:{},d=l?l.pathname:"/",p=l?l.pathnameBase:"/",g=l&&l.route;{let _=g&&g.path||"";wP(d,!g||_.endsWith("*")||_.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${_}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${_}"> to <Route path="${_==="/"?"*":`${_}/*`}">.`)}let m=xo(),y;if(e){let _=typeof e=="string"?kh(e):e;fa(p==="/"||_.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${_.pathname}" was given in the \`location\` prop.`),y=_}else y=m;let x=y.pathname||"/",w=x;if(p!=="/"){let _=p.replace(/^\//,"").split("/");w="/"+x.replace(/^\//,"").split("/").slice(_.length).join("/")}let T=dP(t,{pathname:w});bo(g||T!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),bo(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=Iz(T&&T.map(_=>Object.assign({},_,{params:Object.assign({},c,_.params),pathname:Nl([p,s.encodeLocation?s.encodeLocation(_.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?p:Nl([p,s.encodeLocation?s.encodeLocation(_.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:_.pathnameBase])})),i,r,n,a);return e&&k?N.createElement(Xg.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},k):k}function _z(){let t=Oz(),e=vz(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},s={padding:"2px 4px",backgroundColor:n},i=null;return console.error("Error handled by React Router default ErrorBoundary:",t),i=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:s},"ErrorBoundary")," or"," ",N.createElement("code",{style:s},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),r?N.createElement("pre",{style:a},r):null,i)}var Az=N.createElement(_z,null),Nz=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.unstable_onError?this.props.unstable_onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?N.createElement(Jo.Provider,{value:this.props.routeContext},N.createElement(yS.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Pz({routeContext:t,match:e,children:r}){let n=N.useContext(Th);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(Jo.Provider,{value:t},r)}function Iz(t,e=[],r=null,n=null,a=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let s=t,i=r?.errors;if(i!=null){let d=s.findIndex(p=>p.route.id&&i?.[p.route.id]!==void 0);fa(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,d+1))}let l=!1,c=-1;if(r)for(let d=0;d<s.length;d++){let p=s[d];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(c=d),p.route.id){let{loaderData:g,errors:m}=r,y=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!m||m[p.route.id]===void 0);if(p.route.lazy||y){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((d,p,g)=>{let m,y=!1,x=null,w=null;r&&(m=i&&p.route.id?i[p.route.id]:void 0,x=p.route.errorElement||Az,l&&(c<0&&g===0?(wP("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,w=null):c===g&&(y=!0,w=p.route.hydrateFallbackElement||null)));let T=e.concat(s.slice(0,g+1)),k=()=>{let _;return m?_=x:y?_=w:p.route.Component?_=N.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=d,N.createElement(Pz,{match:p,routeContext:{outlet:d,matches:T,isDataRoute:r!=null},children:_})};return r&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?N.createElement(Nz,{location:r.location,revalidation:r.revalidation,component:x,error:m,children:k(),routeContext:{outlet:null,matches:T,isDataRoute:!0},unstable_onError:n}):k()},null)}function bS(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Rz(t){let e=N.useContext(Th);return fa(e,bS(t)),e}function Dz(t){let e=N.useContext(Py);return fa(e,bS(t)),e}function Lz(t){let e=N.useContext(Jo);return fa(e,bS(t)),e}function xS(t){let e=Lz(t),r=e.matches[e.matches.length-1];return fa(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function Mz(){return xS("useRouteId")}function Oz(){let t=N.useContext(yS),e=Dz("useRouteError"),r=xS("useRouteError");return t!==void 0?t:e.errors?.[r]}function jz(){let{router:t}=Rz("useNavigate"),e=xS("useNavigate"),r=N.useRef(!1);return xP(()=>{r.current=!0}),N.useCallback(async(a,s={})=>{bo(r.current,bP),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...s}))},[t,e])}var zE={};function wP(t,e,r){!e&&!zE[t]&&(zE[t]=!0,bo(!1,r))}N.memo(Bz);function Bz({routes:t,future:e,state:r,unstable_onError:n}){return vP(t,void 0,r,n,e)}function ss(t){fa(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Fz({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:s=!1}){fa(!Jg(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let i=t.replace(/^\/*/,"/"),l=N.useMemo(()=>({basename:i,navigator:a,static:s,future:{}}),[i,a,s]);typeof r=="string"&&(r=kh(r));let{pathname:c="/",search:d="",hash:p="",state:g=null,key:m="default"}=r,y=N.useMemo(()=>{let x=Dl(c,i);return x==null?null:{location:{pathname:x,search:d,hash:p,state:g,key:m},navigationType:n}},[i,c,d,p,g,m,n]);return bo(y!=null,`<Router basename="${i}"> is not able to match the URL "${c}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:N.createElement(Xo.Provider,{value:l},N.createElement(Xg.Provider,{children:e,value:y}))}function zz({children:t,location:e}){return Ez(Aw(t),e)}function Aw(t,e=[]){let r=[];return N.Children.forEach(t,(n,a)=>{if(!N.isValidElement(n))return;let s=[...e,a];if(n.type===N.Fragment){r.push.apply(r,Aw(n.props.children,s));return}fa(n.type===ss,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),fa(!n.props.index||!n.props.children,"An index route cannot have child routes.");let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Aw(n.props.children,s)),r.push(i)}),r}var Jm="get",Zm="application/x-www-form-urlencoded";function Iy(t){return t!=null&&typeof t.tagName=="string"}function $z(t){return Iy(t)&&t.tagName.toLowerCase()==="button"}function Uz(t){return Iy(t)&&t.tagName.toLowerCase()==="form"}function qz(t){return Iy(t)&&t.tagName.toLowerCase()==="input"}function Hz(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Gz(t,e){return t.button===0&&(!e||e==="_self")&&!Hz(t)}function Nw(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function Vz(t,e){let r=Nw(t);return e&&e.forEach((n,a)=>{r.has(a)||e.getAll(a).forEach(s=>{r.append(a,s)})}),r}var km=null;function Wz(){if(km===null)try{new FormData(document.createElement("form"),0),km=!1}catch{km=!0}return km}var Yz=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function fv(t){return t!=null&&!Yz.has(t)?(bo(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Zm}"`),null):t}function Qz(t,e){let r,n,a,s,i;if(Uz(t)){let l=t.getAttribute("action");n=l?Dl(l,e):null,r=t.getAttribute("method")||Jm,a=fv(t.getAttribute("enctype"))||Zm,s=new FormData(t)}else if($z(t)||qz(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(n=c?Dl(c,e):null,r=t.getAttribute("formmethod")||l.getAttribute("method")||Jm,a=fv(t.getAttribute("formenctype"))||fv(l.getAttribute("enctype"))||Zm,s=new FormData(l,t),!Wz()){let{name:d,type:p,value:g}=t;if(p==="image"){let m=d?`${d}.`:"";s.append(`${m}x`,"0"),s.append(`${m}y`,"0")}else d&&s.append(d,g)}}else{if(Iy(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Jm,n=null,a=Zm,i=t}return s&&a==="text/plain"&&(i=s,s=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:s,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function vS(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Kz(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Dl(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function Xz(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Jz(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function Zz(t,e,r){let n=await Promise.all(t.map(async a=>{let s=e.routes[a.route.id];if(s){let i=await Xz(s,r);return i.links?i.links():[]}return[]}));return n$(n.flat(1).filter(Jz).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function $E(t,e,r,n,a,s){let i=(c,d)=>r[d]?c.route.id!==r[d].route.id:!0,l=(c,d)=>r[d].pathname!==c.pathname||r[d].route.path?.endsWith("*")&&r[d].params["*"]!==c.params["*"];return s==="assets"?e.filter((c,d)=>i(c,d)||l(c,d)):s==="data"?e.filter((c,d)=>{let p=n.routes[c.route.id];if(!p||!p.hasLoader)return!1;if(i(c,d)||l(c,d))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:r[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function e$(t,e,{includeHydrateFallback:r}={}){return t$(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let s=[a.module];return a.clientActionModule&&(s=s.concat(a.clientActionModule)),a.clientLoaderModule&&(s=s.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(s=s.concat(a.hydrateFallbackModule)),a.imports&&(s=s.concat(a.imports)),s}).flat(1))}function t$(t){return[...new Set(t)]}function r$(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function n$(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let s=JSON.stringify(r$(a));return r.has(s)||(r.add(s),n.push({key:s,link:a})),n},[])}function SP(){let t=N.useContext(Th);return vS(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function a$(){let t=N.useContext(Py);return vS(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var wS=N.createContext(void 0);wS.displayName="FrameworkContext";function kP(){let t=N.useContext(wS);return vS(t,"You must render this element inside a <HydratedRouter> element"),t}function s$(t,e){let r=N.useContext(wS),[n,a]=N.useState(!1),[s,i]=N.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:d,onMouseLeave:p,onTouchStart:g}=e,m=N.useRef(null);N.useEffect(()=>{if(t==="render"&&i(!0),t==="viewport"){let w=k=>{k.forEach(_=>{i(_.isIntersecting)})},T=new IntersectionObserver(w,{threshold:.5});return m.current&&T.observe(m.current),()=>{T.disconnect()}}},[t]),N.useEffect(()=>{if(n){let w=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(w)}}},[n]);let y=()=>{a(!0)},x=()=>{a(!1),i(!1)};return r?t!=="intent"?[s,m,{}]:[s,m,{onFocus:Sp(l,y),onBlur:Sp(c,x),onMouseEnter:Sp(d,y),onMouseLeave:Sp(p,x),onTouchStart:Sp(g,y)}]:[!1,m,{}]}function Sp(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function i$({page:t,...e}){let{router:r}=SP(),n=N.useMemo(()=>dP(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?N.createElement(l$,{page:t,matches:n,...e}):null}function o$(t){let{manifest:e,routeModules:r}=kP(),[n,a]=N.useState([]);return N.useEffect(()=>{let s=!1;return Zz(t,e,r).then(i=>{s||a(i)}),()=>{s=!0}},[t,e,r]),n}function l$({page:t,matches:e,...r}){let n=xo(),{manifest:a,routeModules:s}=kP(),{basename:i}=SP(),{loaderData:l,matches:c}=a$(),d=N.useMemo(()=>$E(t,e,c,a,n,"data"),[t,e,c,a,n]),p=N.useMemo(()=>$E(t,e,c,a,n,"assets"),[t,e,c,a,n]),g=N.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let x=new Set,w=!1;if(e.forEach(k=>{let _=a.routes[k.route.id];!_||!_.hasLoader||(!d.some(P=>P.route.id===k.route.id)&&k.route.id in l&&s[k.route.id]?.shouldRevalidate||_.hasClientLoader?w=!0:x.add(k.route.id))}),x.size===0)return[];let T=Kz(t,i,"data");return w&&x.size>0&&T.searchParams.set("_routes",e.filter(k=>x.has(k.route.id)).map(k=>k.route.id).join(",")),[T.pathname+T.search]},[i,l,n,a,d,e,t,s]),m=N.useMemo(()=>e$(p,a),[p,a]),y=o$(p);return N.createElement(N.Fragment,null,g.map(x=>N.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...r})),m.map(x=>N.createElement("link",{key:x,rel:"modulepreload",href:x,...r})),y.map(({key:x,link:w})=>N.createElement("link",{key:x,nonce:r.nonce,...w})))}function c$(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var TP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{TP&&(window.__reactRouterVersion="7.9.5")}catch{}function u$({basename:t,children:e,window:r}){let n=N.useRef();n.current==null&&(n.current=X7({window:r,v5Compat:!0}));let a=n.current,[s,i]=N.useState({action:a.action,location:a.location}),l=N.useCallback(c=>{N.startTransition(()=>i(c))},[i]);return N.useLayoutEffect(()=>a.listen(l),[a,l]),N.createElement(Fz,{basename:t,children:e,location:s.location,navigationType:s.action,navigator:a})}var CP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,SS=N.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:s,replace:i,state:l,target:c,to:d,preventScrollReset:p,viewTransition:g,...m},y){let{basename:x}=N.useContext(Xo),w=typeof d=="string"&&CP.test(d),T,k=!1;if(typeof d=="string"&&w&&(T=d,TP))try{let Z=new URL(window.location.href),z=d.startsWith("//")?new URL(Z.protocol+d):new URL(d),ee=Dl(z.pathname,x);z.origin===Z.origin&&ee!=null?d=ee+z.search+z.hash:k=!0}catch{bo(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=Tz(d,{relative:a}),[P,F,D]=s$(n,m),B=g$(d,{replace:i,state:l,target:c,preventScrollReset:p,relative:a,viewTransition:g});function M(Z){e&&e(Z),Z.defaultPrevented||B(Z)}let $=N.createElement("a",{...m,...D,href:T||_,onClick:k||s?e:M,ref:c$(y,F),target:c,"data-discover":!w&&r==="render"?"true":void 0});return P&&!w?N.createElement(N.Fragment,null,$,N.createElement(i$,{page:_})):$});SS.displayName="Link";var d$=N.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:s,to:i,viewTransition:l,children:c,...d},p){let g=Zg(i,{relative:d.relative}),m=xo(),y=N.useContext(Py),{navigator:x,basename:w}=N.useContext(Xo),T=y!=null&&x$(g)&&l===!0,k=x.encodeLocation?x.encodeLocation(g).pathname:g.pathname,_=m.pathname,P=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;r||(_=_.toLowerCase(),P=P?P.toLowerCase():null,k=k.toLowerCase()),P&&w&&(P=Dl(P,w)||P);const F=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let D=_===k||!a&&_.startsWith(k)&&_.charAt(F)==="/",B=P!=null&&(P===k||!a&&P.startsWith(k)&&P.charAt(k.length)==="/"),M={isActive:D,isPending:B,isTransitioning:T},$=D?e:void 0,Z;typeof n=="function"?Z=n(M):Z=[n,D?"active":null,B?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let z=typeof s=="function"?s(M):s;return N.createElement(SS,{...d,"aria-current":$,className:Z,ref:p,style:z,to:i,viewTransition:l},typeof c=="function"?c(M):c)});d$.displayName="NavLink";var h$=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:s,method:i=Jm,action:l,onSubmit:c,relative:d,preventScrollReset:p,viewTransition:g,...m},y)=>{let x=y$(),w=b$(l,{relative:d}),T=i.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&CP.test(l),_=P=>{if(c&&c(P),P.defaultPrevented)return;P.preventDefault();let F=P.nativeEvent.submitter,D=F?.getAttribute("formmethod")||i;x(F||P.currentTarget,{fetcherKey:e,method:D,navigate:r,replace:a,state:s,relative:d,preventScrollReset:p,viewTransition:g})};return N.createElement("form",{ref:y,method:T,action:w,onSubmit:n?c:_,...m,"data-discover":!k&&t==="render"?"true":void 0})});h$.displayName="Form";function p$(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function EP(t){let e=N.useContext(Th);return fa(e,p$(t)),e}function g$(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:s,viewTransition:i}={}){let l=Xi(),c=xo(),d=Zg(t,{relative:s});return N.useCallback(p=>{if(Gz(p,e)){p.preventDefault();let g=r!==void 0?r:Ag(c)===Ag(d);l(t,{replace:g,state:n,preventScrollReset:a,relative:s,viewTransition:i})}},[c,l,d,r,n,e,t,a,s,i])}function fxe(t){bo(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=N.useRef(Nw(t)),r=N.useRef(!1),n=xo(),a=N.useMemo(()=>Vz(n.search,r.current?null:e.current),[n.search]),s=Xi(),i=N.useCallback((l,c)=>{const d=Nw(typeof l=="function"?l(new URLSearchParams(a)):l);r.current=!0,s("?"+d,c)},[s,a]);return[a,i]}var f$=0,m$=()=>`__${String(++f$)}__`;function y$(){let{router:t}=EP("useSubmit"),{basename:e}=N.useContext(Xo),r=Mz();return N.useCallback(async(n,a={})=>{let{action:s,method:i,encType:l,formData:c,body:d}=Qz(n,e);if(a.navigate===!1){let p=a.fetcherKey||m$();await t.fetch(p,r,a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||i,formEncType:a.encType||l,flushSync:a.flushSync})}else await t.navigate(a.action||s,{preventScrollReset:a.preventScrollReset,formData:c,body:d,formMethod:a.method||i,formEncType:a.encType||l,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function b$(t,{relative:e}={}){let{basename:r}=N.useContext(Xo),n=N.useContext(Jo);fa(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),s={...Zg(t||".",{relative:e})},i=xo();if(t==null){s.search=i.search;let l=new URLSearchParams(s.search),c=l.getAll("index");if(c.some(p=>p==="")){l.delete("index"),c.filter(g=>g).forEach(g=>l.append("index",g));let p=l.toString();s.search=p?`?${p}`:""}}return(!t||t===".")&&a.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Nl([r,s.pathname])),Ag(s)}function x$(t,{relative:e}={}){let r=N.useContext(yP);fa(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=EP("useViewTransitionState"),a=Zg(t,{relative:e});if(!r.isTransitioning)return!1;let s=Dl(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Dl(r.nextLocation.pathname,n)||r.nextLocation.pathname;return A0(a.pathname,i)!=null||A0(a.pathname,s)!=null}var v$=tP();const w$=Dc(v$);let Tu=null;function Id(t){Tu=t,console.log(" User storage scoped to:",t||"anonymous")}function Pw(){return Tu}function _P(t){return`${Tu?`user:${Tu}`:"anonymous"}:${t}`}function AP(t){const e=_P(t),r=localStorage.getItem(e);return console.log(` userStorage.getItem("${t}")  scopedKey: "${e}", hasValue: ${!!r}`),r}function e0(t,e){const r=_P(t);console.log(` userStorage.setItem("${t}")  scopedKey: "${r}"`),localStorage.setItem(r,e)}function S$(){if(!Tu){console.warn(" clearUserStorage called but no user is logged in");return}const t=`user:${Tu}:`,e=[];for(let r=0;r<localStorage.length;r++){const n=localStorage.key(r);n&&n.startsWith(t)&&e.push(n)}e.forEach(r=>localStorage.removeItem(r)),console.log(` Cleared ${e.length} user-scoped settings for ${Tu}`)}function mv(t,e){console.log(` Migrating ${e.length} keys to user-scoped storage for ${t}`),e.forEach(r=>{const n=localStorage.getItem(r);if(n!==null){const a=`user:${t}:${r}`;localStorage.getItem(a)===null?(localStorage.setItem(a,n),console.log(`   Migrated: ${r}  ${a}`)):console.log(`   Skipped: ${a} already exists`),localStorage.removeItem(r)}}),console.log(" Migration complete")}const yv=["app_settings","proxy_settings","feed_maturity_level","feed_last_search","auto_sync_enabled","google_drive_access_token","user_email","rag_config","rag_spreadsheet_id","rag_google_linked","last_active_chat_id","image_editor_images","image_editor_selection","image_editor_command","imageEditorPromptHistory","swag-google-docs-cache","swag-recent-tags","swag-snippets","saved_plans","playlists","chat_history"],k$="lambdallmproxy",T$=1,$i="app_data",Rd=5*1024*1024,kp=250*1024*1024;class kc extends Error{code;estimatedSize;limit;constructor(e,r,n,a){super(e),this.name="StorageError",this.code=r,this.estimatedSize=n,this.limit=a}}class C${db=null;initPromise=null;useIndexedDB=!0;async initDB(){return this.initPromise?this.initPromise:(this.initPromise=new Promise(e=>{if(!window.indexedDB){console.warn("IndexedDB not supported, falling back to localStorage"),this.useIndexedDB=!1,e();return}const r=indexedDB.open(k$,T$);r.onerror=()=>{console.error("IndexedDB error:",r.error),this.useIndexedDB=!1,e()},r.onsuccess=()=>{this.db=r.result,this.useIndexedDB=!0,e()},r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains($i)||a.createObjectStore($i)}}),this.initPromise)}getDataSize(e){try{return new Blob([JSON.stringify(e)]).size}catch{return JSON.stringify(e).length*2}}async getItem(e){if(await this.initDB(),this.useIndexedDB&&this.db)try{return await this.getFromIndexedDB(e)}catch(r){console.warn("IndexedDB read failed, trying localStorage:",r)}try{const r=localStorage.getItem(e);return r?JSON.parse(r):null}catch(r){return console.error("Failed to read from localStorage:",r),null}}async setItem(e,r){await this.initDB();const n=this.getDataSize(r);if(this.useIndexedDB&&this.db)try{if(n>kp)throw new kc(`Data size (${this.formatBytes(n)}) exceeds IndexedDB limit (${this.formatBytes(kp)}). Consider reducing the amount of stored data.`,"QUOTA_EXCEEDED",n,kp);await this.setToIndexedDB(e,r);return}catch(a){if(a instanceof kc)throw a;console.warn("IndexedDB write failed, trying localStorage:",a),this.useIndexedDB=!1}try{if(n>Rd)throw new kc(`Data size (${this.formatBytes(n)}) exceeds localStorage limit (${this.formatBytes(Rd)}). Try using fewer or smaller snippets, or clear old data.`,"QUOTA_EXCEEDED",n,Rd);localStorage.setItem(e,JSON.stringify(r))}catch(a){throw a instanceof kc?a:a instanceof DOMException&&(a.name==="QuotaExceededError"||a.code===22)?new kc(`Storage quota exceeded (${this.formatBytes(n)}). Please delete some snippets to free up space.`,"QUOTA_EXCEEDED",n,Rd):new kc(`Failed to save data: ${a instanceof Error?a.message:"Unknown error"}`,"UNKNOWN")}}async removeItem(e){if(await this.initDB(),this.useIndexedDB&&this.db)try{await this.removeFromIndexedDB(e)}catch(r){console.warn("Failed to remove from IndexedDB:",r)}try{localStorage.removeItem(e)}catch(r){console.warn("Failed to remove from localStorage:",r)}}async clear(){if(await this.initDB(),this.useIndexedDB&&this.db)try{await this.clearIndexedDB()}catch(e){console.warn("Failed to clear IndexedDB:",e)}try{localStorage.clear()}catch(e){console.warn("Failed to clear localStorage:",e)}}async getStats(){await this.initDB();const e=[];let r=0;if(this.useIndexedDB&&this.db){const n=await this.getAllKeysFromIndexedDB();for(const a of n){const s=await this.getFromIndexedDB(a);e.push(a),r+=this.getDataSize(s)}return{type:"indexeddb",keys:e,totalSize:r,limit:kp,percentUsed:r/kp*100}}else{for(let n=0;n<localStorage.length;n++){const a=localStorage.key(n);if(a){e.push(a);const s=localStorage.getItem(a);s&&(r+=this.getDataSize(s))}}return{type:"localstorage",keys:e,totalSize:r,limit:Rd,percentUsed:r/Rd*100}}}getFromIndexedDB(e){return new Promise((r,n)=>{if(!this.db){n(new Error("Database not initialized"));return}const i=this.db.transaction([$i],"readonly").objectStore($i).get(e);i.onsuccess=()=>{r(i.result??null)},i.onerror=()=>{n(i.error)}})}setToIndexedDB(e,r){return new Promise((n,a)=>{if(!this.db){a(new Error("Database not initialized"));return}const l=this.db.transaction([$i],"readwrite").objectStore($i).put(r,e);l.onsuccess=()=>{n()},l.onerror=()=>{a(l.error)}})}removeFromIndexedDB(e){return new Promise((r,n)=>{if(!this.db){n(new Error("Database not initialized"));return}const i=this.db.transaction([$i],"readwrite").objectStore($i).delete(e);i.onsuccess=()=>{r()},i.onerror=()=>{n(i.error)}})}clearIndexedDB(){return new Promise((e,r)=>{if(!this.db){r(new Error("Database not initialized"));return}const s=this.db.transaction([$i],"readwrite").objectStore($i).clear();s.onsuccess=()=>{e()},s.onerror=()=>{r(s.error)}})}getAllKeysFromIndexedDB(){return new Promise((e,r)=>{if(!this.db){r(new Error("Database not initialized"));return}const s=this.db.transaction([$i],"readonly").objectStore($i).getAllKeys();s.onsuccess=()=>{e(s.result)},s.onerror=()=>{r(s.error)}})}formatBytes(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(2)+" KB":(e/(1024*1024)).toFixed(2)+" MB"}}const Go=new C$,mxe=Object.freeze(Object.defineProperty({__proto__:null,StorageError:kc,storage:Go},Symbol.toStringTag,{value:"Module"})),E$="548179877633-cfvhlc5roj9prus33jlarcm540i495qi.apps.googleusercontent.com",Tp=["openid","email","profile"].join(" "),UE=["openid","email","profile","https://www.googleapis.com/auth/drive.file"].join(" "),mn={ACCESS_TOKEN:"google_access_token",REFRESH_TOKEN:"google_refresh_token",TOKEN_EXPIRATION:"google_token_expiration",GRANTED_SCOPES:"google_granted_scopes",USER_EMAIL:"user_email",USER_NAME:"user_name",USER_PICTURE:"user_picture",USER_SUB:"user_sub"};class _${tokenClient=null;accessToken=null;authCallbacks=[];currentScopes=Tp;constructor(){this.migrateTokensToGlobal(),this.accessToken=localStorage.getItem(mn.ACCESS_TOKEN),this.currentScopes=localStorage.getItem(mn.GRANTED_SCOPES)||Tp,console.log(" [GoogleAuth Constructor] Initialized:",{hasToken:!!this.accessToken,tokenLength:this.accessToken?.length,currentScopes:this.currentScopes})}migrateTokensToGlobal(){const e=localStorage.getItem("user_email");if(!e)return;const r=`user:${e}:`,n=[mn.ACCESS_TOKEN,mn.REFRESH_TOKEN,mn.TOKEN_EXPIRATION,mn.GRANTED_SCOPES,mn.USER_NAME,mn.USER_PICTURE,mn.USER_SUB];let a=!1;n.forEach(s=>{const i=`${r}${s}`,l=localStorage.getItem(i),c=localStorage.getItem(s);l&&!c&&(localStorage.setItem(s,l),localStorage.removeItem(i),a=!0)}),a&&console.log(" Migrated auth tokens from user-scoped to global storage")}onAuthChange(e){this.authCallbacks.push(e),e(this.isAuthenticated())}notifyAuthChange(e){this.authCallbacks.forEach(r=>{try{r(e)}catch(n){console.error("Auth callback error:",n)}})}async init(){return new Promise((e,r)=>{if(console.log(" Initializing Google OAuth2..."),typeof google<"u"&&google.accounts){console.log(" Google Identity Services already loaded"),this.initializeTokenClient(),this.checkAndRefreshToken(),e();return}console.log(" Loading Google Identity Services library...");const n=document.createElement("script");n.src="https://accounts.google.com/gsi/client",n.onload=()=>{console.log(" Google Identity Services library loaded"),this.initializeTokenClient(),this.checkAndRefreshToken(),e()},n.onerror=()=>{const a="Failed to load Google Identity Services library";console.error("",a),r(new Error(a))},document.head.appendChild(n)})}checkAndRefreshToken(){if(!this.getAccessToken()){console.log(" No existing token found"),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!1}}));return}const r=localStorage.getItem(mn.TOKEN_EXPIRATION);if(!r){console.log(" Token exists but no expiration - keeping as-is"),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!0,refreshed:!1}}));return}const n=parseInt(r,10),a=Date.now(),s=n-a,i=Math.floor(s/6e4);console.log(` Found existing token, expires in ${i} minutes`),s<300*1e3&&(console.log(" Token expiring soon but skipping auto-refresh to avoid popup"),console.log(" Token will be used until it expires, then user will need to reconnect")),console.log(" Using existing token (no auto-refresh)"),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!0,refreshed:!1}}))}initializeTokenClient(){this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:E$,scope:this.currentScopes,callback:e=>{this.handleTokenResponse(e).catch(r=>{console.error(" Token response handler error:",r),this.notifyAuthChange(!1),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!1,refreshed:!1,error:!0}}))})},error_callback:e=>{console.error(" OAuth2 error:",e),this.notifyAuthChange(!1),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!1,refreshed:!1,error:!0}}))}})}async handleTokenResponse(e){if(console.log(" OAuth2 token received:",{hasToken:!!e.access_token,expiresIn:e.expires_in,hasRefreshToken:!!e.refresh_token,hasIdToken:!!e.id_token,scope:e.scope}),e.access_token){const r=e.access_token.trim().replace(/[\r\n]/g,"");if(this.accessToken=r,localStorage.setItem(mn.ACCESS_TOKEN,r),e.scope&&(this.currentScopes=e.scope,localStorage.setItem(mn.GRANTED_SCOPES,e.scope),console.log(" Granted scopes:",e.scope)),e.expires_in){const n=Date.now()+e.expires_in*1e3;localStorage.setItem(mn.TOKEN_EXPIRATION,n.toString())}if(e.refresh_token&&localStorage.setItem(mn.REFRESH_TOKEN,e.refresh_token),e.id_token?(console.log(" Extracting user info from ID token"),this.extractUserProfile(e.id_token)):(console.log(" No ID token, fetching user info from Google API"),await this.fetchUserInfo(r)),localStorage.setItem("google_drive_access_token",r),e.expires_in){const n=Date.now()+e.expires_in*1e3;localStorage.setItem("google_drive_token_expiration",n.toString())}console.log(" Google authentication successful"),this.notifyAuthChange(!0),window.dispatchEvent(new CustomEvent("google-auth-success",{detail:{accessToken:r}})),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!0,refreshed:!0}}))}}async fetchUserInfo(e){try{console.log(" Fetching user info from Google API...");const r=await fetch("https://www.googleapis.com/oauth2/v2/userinfo",{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`Failed to fetch user info: ${r.status}`);const n=await r.json();console.log(" User info fetched:",{email:n.email,name:n.name}),n.email&&localStorage.setItem(mn.USER_EMAIL,n.email),n.name&&localStorage.setItem(mn.USER_NAME,n.name),n.picture&&localStorage.setItem(mn.USER_PICTURE,n.picture),n.id&&localStorage.setItem(mn.USER_SUB,n.id)}catch(r){console.error(" Failed to fetch user info:",r)}}extractUserProfile(e){try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(n).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")),s=JSON.parse(a);s.email&&localStorage.setItem(mn.USER_EMAIL,s.email),s.name&&localStorage.setItem(mn.USER_NAME,s.name),s.picture&&localStorage.setItem(mn.USER_PICTURE,s.picture),s.sub&&localStorage.setItem(mn.USER_SUB,s.sub),console.log(" User profile extracted:",{email:s.email,name:s.name})}catch(r){console.error("Failed to extract user profile from ID token:",r)}}async signIn(){this.tokenClient||await this.init(),console.log(" Requesting Google sign-in with scopes:",this.currentScopes);const e=!!localStorage.getItem(mn.ACCESS_TOKEN),r=e?"":"consent";console.log(` Sign-in mode: ${r||"silent"} (hasExistingToken: ${e})`),this.tokenClient.requestAccessToken({prompt:r})}async signInWithDriveAccess(){this.tokenClient||await this.init(),console.log(" Requesting Google sign-in WITH Drive access..."),this.currentScopes=UE,this.initializeTokenClient(),this.tokenClient.requestAccessToken({prompt:"consent"})}signOut(){console.log(" Signing out...");const e=this.getAccessToken();e&&this.revokeToken(e).catch(r=>console.warn("Failed to revoke token with Google:",r)),Object.values(mn).forEach(r=>{localStorage.removeItem(r)}),localStorage.removeItem("google_drive_access_token"),localStorage.removeItem("google_drive_token_expiration"),this.accessToken=null,this.currentScopes=Tp,this.notifyAuthChange(!1),window.dispatchEvent(new CustomEvent("google-auth-signout"))}async requestDriveAccess(){try{return console.log(" Requesting Google Drive permissions..."),this.currentScopes=UE,this.tokenClient?this.initializeTokenClient():await this.init(),new Promise(e=>{const r=this.tokenClient.callback;this.tokenClient.callback=async n=>{await this.handleTokenResponse(n),this.tokenClient.callback=r;const a=n.scope?.includes("drive.file");e(a||!1)},this.tokenClient.requestAccessToken({prompt:"consent"})})}catch(e){return console.error(" Failed to request Drive access:",e),!1}}async revokeDriveAccess(){try{return console.log(" Removing Google Drive permissions (keeping basic auth)..."),this.currentScopes=Tp,localStorage.setItem(mn.GRANTED_SCOPES,Tp),localStorage.removeItem("google_drive_access_token"),localStorage.removeItem("google_drive_token_expiration"),this.initializeTokenClient(),window.dispatchEvent(new CustomEvent("google-drive-disconnected")),console.log(" Drive permissions removed, basic auth retained"),!0}catch(e){return console.error(" Failed to revoke Drive access:",e),!1}}async revokeToken(e){try{const r=await fetch(`https://oauth2.googleapis.com/revoke?token=${e}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"}});r.ok?console.log(" Token revoked with Google"):console.warn(" Token revocation returned:",r.status)}catch(r){throw console.error(" Failed to revoke token:",r),r}}hasDriveAccess(){const e=localStorage.getItem(mn.GRANTED_SCOPES)||"",r=e.includes("drive.file");return console.log(" Checking Drive access:",{grantedScopes:e.substring(0,100)+"...",hasDrive:r}),r}isAuthenticated(){if(!this.getAccessToken())return console.log(" [isAuthenticated] No token found"),!1;const r=localStorage.getItem(mn.TOKEN_EXPIRATION);if(r){const n=parseInt(r,10),a=Date.now(),s=a>=n,i=n-a,l=Math.floor(i/6e4);if(console.log(" [isAuthenticated] Token check:",{hasToken:!0,expirationStr:r,expiration:new Date(n).toISOString(),now:new Date(a).toISOString(),minutesUntilExpiry:l,isExpired:s}),s)return console.log(" Token expired - user needs to re-authenticate or wait for automatic refresh"),!1}else console.log(" [isAuthenticated] No expiration found, assuming valid");return console.log(" [isAuthenticated] Token is valid"),!0}attemptSilentRefresh(){if(console.log(""),console.log(" attemptSilentRefresh() called"),console.log("Stack trace:",new Error().stack),console.log(""),!this.tokenClient){console.warn(" Cannot refresh: token client not initialized"),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!1,refreshed:!1}}));return}const e=localStorage.getItem(mn.GRANTED_SCOPES)||"",r=this.currentScopes;console.log(" Scope comparison:"),console.log("  Granted:",e),console.log("  Current:",r);const n=new Set(e.split(" ").filter(i=>i)),a=new Set(r.split(" ").filter(i=>i)),s=n.size===a.size&&[...a].every(i=>n.has(i));if(console.log("  Match:",s),!s){console.log(" Scopes changed - skipping silent refresh to prevent unwanted auth dialog"),console.log(" Granted:",e),console.log(" Current:",r),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!0,refreshed:!1,scopesMismatch:!0}}));return}console.log("    CALLING requestAccessToken() - AUTH DIALOG MAY APPEAR    "),console.log(" Attempting silent token refresh (scopes match)...");try{this.tokenClient.requestAccessToken({prompt:""})}catch(i){console.error(" Silent refresh failed:",i),window.dispatchEvent(new CustomEvent("google-auth-init-complete",{detail:{hasToken:!1,refreshed:!1}}))}}reloadToken(){this.accessToken=localStorage.getItem(mn.ACCESS_TOKEN),console.log(" Token reloaded from localStorage:",this.accessToken?"present":"missing")}clearAccessToken(){this.accessToken=null,console.log(" Cleared cached access token")}getAccessToken(){return this.accessToken||(this.accessToken=localStorage.getItem(mn.ACCESS_TOKEN)),this.accessToken}getUserProfile(){let e=localStorage.getItem(mn.USER_EMAIL);if(!e){const r=Object.keys(localStorage).find(n=>n.endsWith(":user_email"));r&&(e=localStorage.getItem(r))}return e?{email:e,name:localStorage.getItem(mn.USER_NAME)||void 0,picture:localStorage.getItem(mn.USER_PICTURE)||void 0,sub:localStorage.getItem(mn.USER_SUB)||void 0}:null}isTokenExpiringSoon(){const e=localStorage.getItem(mn.TOKEN_EXPIRATION);if(!e)return!0;const r=parseInt(e,10),n=600*1e3;return Date.now()>=r-n}async refreshToken(){console.log(""),console.log(" refreshToken() called"),console.log("Stack trace:",new Error().stack),console.log("");const e=localStorage.getItem(mn.GRANTED_SCOPES)||"",r=this.currentScopes;console.log(" Scope comparison in refreshToken:"),console.log("  Granted:",e),console.log("  Current:",r);const n=new Set(e.split(" ").filter(i=>i)),a=new Set(r.split(" ").filter(i=>i)),s=n.size===a.size&&[...a].every(i=>n.has(i));if(console.log("  Match:",s),!s)return console.log(" Scopes changed - skipping refresh to prevent unwanted auth dialog"),!1;console.log(" Scopes match - proceeding with silent refresh...");try{return this.tokenClient?new Promise(i=>{const l=this.tokenClient.callback;this.tokenClient.callback=c=>{this.handleTokenResponse(c).then(()=>{console.log(" Token refreshed silently"),i(!0)}).catch(d=>{console.error(" Token refresh failed:",d),i(!1)}).finally(()=>{this.tokenClient.callback=l})},console.log("    CALLING requestAccessToken() from refreshToken() - AUTH DIALOG MAY APPEAR    "),this.tokenClient.requestAccessToken({prompt:""}),setTimeout(()=>{console.warn(" Token refresh timeout"),this.tokenClient.callback=l,i(!1)},1e4)}):(console.warn(" Token client not initialized"),!1)}catch(i){return console.error(" Token refresh error:",i),!1}}async ensureValidToken(){return this.isAuthenticated()?(console.log(" Returning existing token without refresh check"),this.getAccessToken()):(console.log(" Not authenticated"),null)}}const Yn=new _$,Ng=Object.freeze(Object.defineProperty({__proto__:null,googleAuth:Yn},Symbol.toStringTag,{value:"Module"})),NP=N.createContext(void 0),oi=()=>{const t=N.useContext(NP);if(!t)throw new Error("useAuth must be used within AuthProvider");return t},A$=({children:t})=>{const[e,r]=N.useState(()=>{const l=Yn.isAuthenticated(),c=Yn.getUserProfile(),d=Yn.getAccessToken();return console.log(" AuthProvider initializing with state from googleAuth:",{isAuthenticated:l,hasToken:!!d,userEmail:c?.email,tokenLength:d?.length}),d&&!l&&console.warn(" Token exists but isAuthenticated returned false - token may be expired, will attempt refresh"),{user:c?{email:c.email,name:c.name||"",picture:c.picture||"",sub:c.sub||""}:null,accessToken:d,isAuthenticated:l}});N.useLayoutEffect(()=>{e.user?.email?(Id(e.user.email),console.log(" Set current user scope:",e.user.email)):(Id(null),console.log(" Set current user scope: anonymous"))},[]),N.useEffect(()=>{const l=c=>{const d=c,{hasToken:p,refreshed:g}=d.detail;if(console.log(" GoogleAuth init complete:",{hasToken:p,refreshed:g}),p){const m=Yn.isAuthenticated(),y=Yn.getUserProfile(),x=Yn.getAccessToken();if(console.log(" Checking auth state after init:",{isAuthenticated:m,hasToken:!!x,userEmail:y?.email}),m&&y&&x){const w={email:y.email,name:y.name||"",picture:y.picture||"",sub:y.sub||""};r({user:w,accessToken:x,isAuthenticated:!0}),Id(w.email),mv(w.email,[...yv]),console.log(" AuthContext restored session for:",w.email)}}};return window.addEventListener("google-auth-init-complete",l),()=>window.removeEventListener("google-auth-init-complete",l)},[]),N.useEffect(()=>{const l=()=>{const d=Yn.getUserProfile(),p=Yn.getAccessToken();if(d&&p){const g={email:d.email,name:d.name||"",picture:d.picture||"",sub:d.sub||""};r({user:g,accessToken:p,isAuthenticated:!0}),Id(g.email),mv(g.email,[...yv]),console.log(" AuthContext updated from googleAuth success event:",g.email)}},c=()=>{S$(),r({user:null,accessToken:null,isAuthenticated:!1}),Id(null),console.log(" AuthContext updated from googleAuth signout event")};return window.addEventListener("google-auth-success",l),window.addEventListener("google-auth-signout",c),()=>{window.removeEventListener("google-auth-success",l),window.removeEventListener("google-auth-signout",c)}},[]);const n=N.useCallback(l=>{try{const c=l.split(".");if(c.length!==3){console.error(" Invalid JWT format");return}const d=JSON.parse(atob(c[1].replace(/-/g,"+").replace(/_/g,"/")));if(!d.email){console.error(" Invalid token: missing email");return}const p={email:d.email,name:d.name||"",picture:d.picture||"",sub:d.sub||""},g=d.exp?d.exp*1e3:Date.now()+36e5;localStorage.setItem("google_access_token",l),localStorage.setItem("google_token_expiration",g.toString()),localStorage.setItem("user_email",p.email),localStorage.setItem("user_name",p.name),p.picture&&localStorage.setItem("user_picture",p.picture),Yn.reloadToken(),r({user:p,accessToken:l,isAuthenticated:!0}),Id(p.email),mv(p.email,[...yv]),console.log(" User logged in via JWT credential:",p.email)}catch(c){console.error(" Login failed:",c)}},[]),a=N.useCallback(()=>{Yn.signOut()},[]),s=N.useCallback(async()=>(console.log(" Token refresh not implemented - user must re-authenticate when token expires"),!1),[]),i=N.useCallback(async()=>{const l=await Yn.ensureValidToken();return!l&&e.isAuthenticated?(console.log(" Token expired, logging out"),a(),null):l},[e.isAuthenticated,a]);return N.useEffect(()=>{if(e.isAuthenticated&&typeof google<"u"&&google?.accounts?.id)try{google.accounts.id.cancel(),console.log(" Cancelled any pending Google One Tap prompts (user authenticated)")}catch{console.log("No Google One Tap prompt to cancel")}},[e.isAuthenticated]),N.useEffect(()=>{if(!e.isAuthenticated||!e.accessToken)return;console.log(" Starting token refresh monitor (check every 30s, only refresh if expiring)");const l=async()=>{if(!await Yn.ensureValidToken())console.warn(" Token validation failed, logging out"),a();else{const p=Yn.getAccessToken();p!==e.accessToken&&Yn.getUserProfile()&&(console.log(" Token refreshed, updating state"),r(m=>({...m,accessToken:p})))}};l();const c=setInterval(l,30*1e3);return()=>{console.log(" Stopping token refresh monitor"),clearInterval(c)}},[e.isAuthenticated,e.accessToken,a]),u.jsx(NP.Provider,{value:{...e,login:n,logout:a,refreshToken:s,getToken:i},children:t})},N$="ProjectDB",P$=1,Ui="projects",bv="llm_proxy_current_project";class I${db=null;async init(){return new Promise((e,r)=>{const n=indexedDB.open(N$,P$);n.onerror=()=>{console.error(" Failed to open ProjectDB:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log(" ProjectDB initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result;if(!s.objectStoreNames.contains(Ui)){const i=s.createObjectStore(Ui,{keyPath:"id"});i.createIndex("name","name",{unique:!1}),i.createIndex("createdAt","createdAt",{unique:!1}),i.createIndex("updatedAt","updatedAt",{unique:!1}),console.log(" Projects object store created")}}})}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}async ensureDB(){if(this.db||await this.init(),!this.db)throw new Error("Failed to initialize ProjectDB");return this.db}async createProject(e){const r=await this.ensureDB(),n=e.trim();if(!n)throw new Error("Project name cannot be empty");if((await this.getAllProjects()).some(i=>i.name.toLowerCase()===n.toLowerCase()))throw new Error(`Project "${n}" already exists`);const s={id:this.generateUUID(),name:n,createdAt:Date.now(),updatedAt:Date.now()};return new Promise((i,l)=>{const p=r.transaction([Ui],"readwrite").objectStore(Ui).add(s);p.onsuccess=()=>{console.log(` Project created: ${s.name}`),i(s)},p.onerror=()=>{console.error(" Failed to create project:",p.error),l(p.error)}})}async getAllProjects(){const e=await this.ensureDB();return new Promise((r,n)=>{const i=e.transaction([Ui],"readonly").objectStore(Ui).getAll();i.onsuccess=()=>{const l=i.result||[];l.sort((c,d)=>c.name.toLowerCase().localeCompare(d.name.toLowerCase())),r(l)},i.onerror=()=>{console.error(" Failed to get all projects:",i.error),n(i.error)}})}async getProject(e){const r=await this.ensureDB();return new Promise((n,a)=>{const l=r.transaction([Ui],"readonly").objectStore(Ui).get(e);l.onsuccess=()=>{n(l.result||null)},l.onerror=()=>{console.error(" Failed to get project:",l.error),a(l.error)}})}async updateProject(e,r){const n=await this.ensureDB(),a=await this.getProject(e);if(!a)throw new Error(`Project with ID ${e} not found`);if(r.name!==void 0){const i=r.name.trim();if(!i)throw new Error("Project name cannot be empty");if((await this.getAllProjects()).some(c=>c.id!==e&&c.name.toLowerCase()===i.toLowerCase()))throw new Error(`Project "${i}" already exists`);r.name=i}const s={...a,...r,updatedAt:Date.now()};return new Promise((i,l)=>{const p=n.transaction([Ui],"readwrite").objectStore(Ui).put(s);p.onsuccess=()=>{console.log(` Project updated: ${s.name}`),i()},p.onerror=()=>{console.error(" Failed to update project:",p.error),l(p.error)}})}async deleteProject(e){const r=await this.ensureDB(),n=await this.getProject(e);if(!n)throw new Error(`Project with ID ${e} not found`);return new Promise((a,s)=>{const c=r.transaction([Ui],"readwrite").objectStore(Ui).delete(e);c.onsuccess=()=>{console.log(` Project deleted: ${n.name}`),this.getCurrentProject()===e&&this.setCurrentProject(null),a()},c.onerror=()=>{console.error(" Failed to delete project:",c.error),s(c.error)}})}getCurrentProject(){try{return localStorage.getItem(bv)}catch(e){return console.error(" Failed to get current project:",e),null}}setCurrentProject(e){try{e===null?(localStorage.removeItem(bv),console.log(" Current project cleared")):(localStorage.setItem(bv,e),console.log(` Current project set: ${e}`)),window.dispatchEvent(new CustomEvent("projectChanged",{detail:{projectId:e}}))}catch(r){console.error(" Failed to set current project:",r)}}clearCurrentProject(){this.setCurrentProject(null)}}const jo=new I$;jo.init().catch(t=>{console.error(" Failed to initialize ProjectDB:",t)});const PP=N.createContext(void 0),R$=({children:t})=>{const[e,r]=N.useState([]),[n,a]=N.useState(null),[s,i]=N.useState(!0),l=N.useCallback(async()=>{try{i(!0);const T=await jo.getAllProjects();r(T);const k=jo.getCurrentProject();if(k){const _=T.find(P=>P.id===k);a(_||null),_||jo.setCurrentProject(null)}}catch(T){console.error(" Failed to load projects:",T)}finally{i(!1)}},[]),c=N.useCallback(async T=>{try{const k=await jo.createProject(T);return await l(),jo.setCurrentProject(k.id),a(k),k}catch(k){throw console.error(" Failed to create project:",k),k}},[l]),d=N.useCallback(async(T,k)=>{try{await jo.updateProject(T,{name:k}),await l()}catch(_){throw console.error(" Failed to update project:",_),_}},[l]),p=N.useCallback(async T=>{try{await jo.deleteProject(T),await l()}catch(k){throw console.error(" Failed to delete project:",k),k}},[l]),g=N.useCallback(T=>{if(jo.setCurrentProject(T),T===null)a(null);else{const k=e.find(_=>_.id===T);a(k||null)}},[e]),m=N.useCallback(()=>{g(null)},[g]),y=N.useCallback(()=>jo.getCurrentProject(),[]),x=N.useCallback(T=>T&&e.find(_=>_.id===T)?.name||"",[e]);N.useEffect(()=>{l()},[l]),N.useEffect(()=>{const T=k=>{const{projectId:_}=k.detail;if(_===null)a(null);else{const P=e.find(F=>F.id===_);a(P||null)}};return window.addEventListener("projectChanged",T),()=>{window.removeEventListener("projectChanged",T)}},[e]);const w={projects:e,currentProject:n,isLoading:s,loadProjects:l,createProject:c,updateProject:d,deleteProject:p,selectProject:g,clearProject:m,getCurrentProjectId:y,getProjectName:x};return u.jsx(PP.Provider,{value:w,children:t})},ef=()=>{const t=N.useContext(PP);if(!t)throw new Error("useProject must be used within a ProjectProvider");return t},IP=N.createContext(void 0),D$=({children:t})=>{const[e,r]=N.useState([]),[n,a]=N.useState(!1),s=c=>{a(!1),r(d=>{const p=d.findIndex(g=>g.query.toLowerCase()===c.query.toLowerCase());if(p>=0){const g=[...d];return g[p]=c,g}else return[...d,c]})},i=c=>{r(c)},l=()=>{a(!0),r([])};return u.jsx(IP.Provider,{value:{searchResults:e,addSearchResult:s,setSearchResults:i,clearSearchResults:l,wasCleared:n},children:t})},L$=()=>{const t=N.useContext(IP);if(t===void 0)throw new Error("useSearchResults must be used within a SearchResultsProvider");return t},Iw=(t,e)=>e.some(r=>t instanceof r);let qE,HE;function M$(){return qE||(qE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function O$(){return HE||(HE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Rw=new WeakMap,xv=new WeakMap,Ry=new WeakMap;function j$(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",s),t.removeEventListener("error",i)},s=()=>{r(Cu(t.result)),a()},i=()=>{n(t.error),a()};t.addEventListener("success",s),t.addEventListener("error",i)});return Ry.set(e,t),e}function B$(t){if(Rw.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",i),t.removeEventListener("abort",i)},s=()=>{r(),a()},i=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",s),t.addEventListener("error",i),t.addEventListener("abort",i)});Rw.set(t,e)}let Dw={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Rw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Cu(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function RP(t){Dw=t(Dw)}function F$(t){return O$().includes(t)?function(...e){return t.apply(Lw(this),e),Cu(this.request)}:function(...e){return Cu(t.apply(Lw(this),e))}}function z$(t){return typeof t=="function"?F$(t):(t instanceof IDBTransaction&&B$(t),Iw(t,M$())?new Proxy(t,Dw):t)}function Cu(t){if(t instanceof IDBRequest)return j$(t);if(xv.has(t))return xv.get(t);const e=z$(t);return e!==t&&(xv.set(t,e),Ry.set(e,t)),e}const Lw=t=>Ry.get(t);function Dy(t,e,{blocked:r,upgrade:n,blocking:a,terminated:s}={}){const i=indexedDB.open(t,e),l=Cu(i);return n&&i.addEventListener("upgradeneeded",c=>{n(Cu(i.result),c.oldVersion,c.newVersion,Cu(i.transaction),c)}),r&&i.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),l.then(c=>{s&&c.addEventListener("close",()=>s()),a&&c.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const $$=["get","getKey","getAll","getAllKeys","count"],U$=["put","add","delete","clear"],vv=new Map;function GE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(vv.get(e))return vv.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=U$.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||$$.includes(r)))return;const s=async function(i,...l){const c=this.transaction(i,a?"readwrite":"readonly");let d=c.store;return n&&(d=d.index(l.shift())),(await Promise.all([d[r](...l),a&&c.done]))[0]};return vv.set(e,s),s}RP(t=>({...t,get:(e,r,n)=>GE(e,r)||t.get(e,r,n),has:(e,r)=>!!GE(e,r)||t.has(e,r)}));const q$=["continue","continuePrimaryKey","advance"],VE={},Mw=new WeakMap,DP=new WeakMap,H$={get(t,e){if(!q$.includes(e))return t[e];let r=VE[e];return r||(r=VE[e]=function(...n){Mw.set(this,DP.get(this)[e](...n))}),r}};async function*G$(...t){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...t)),!e)return;e=e;const r=new Proxy(e,H$);for(DP.set(r,e),Ry.set(r,Lw(e));e;)yield r,e=await(Mw.get(r)||e.continue()),Mw.delete(r)}function WE(t,e){return e===Symbol.asyncIterator&&Iw(t,[IDBIndex,IDBObjectStore,IDBCursor])||e==="iterate"&&Iw(t,[IDBIndex,IDBObjectStore])}RP(t=>({...t,get(e,r,n){return WE(e,r)?G$:t.get(e,r,n)},has(e,r){return WE(e,r)||t.has(e,r)}}));class V${queue=[];batchInterval=3e4;batchTimer=null;onExecute;constructor(e){this.onExecute=e}queueSync(e,r="normal"){this.queue.push({adapterName:e,priority:r,timestamp:Date.now()}),r==="high"?this.executeBatch():(this.batchTimer&&clearTimeout(this.batchTimer),this.batchTimer=setTimeout(()=>{this.executeBatch()},this.batchInterval))}async executeBatch(){if(this.queue.length===0)return;const e=[...new Set(this.queue.map(r=>r.adapterName))];this.queue=[],console.log(` Executing batch sync for: ${e.join(", ")}`);try{await this.onExecute(e)}catch(r){console.error(" Batch sync failed:",r)}}clear(){this.batchTimer&&(clearTimeout(this.batchTimer),this.batchTimer=null),this.queue=[]}setBatchInterval(e){this.batchInterval=e}}class W${adapters=new Map;scheduler;syncStatus={syncing:!1,lastSyncTime:null,nextSyncTime:null,adapterStatuses:{}};syncInterval=300*1e3;syncTimer=null;enabled=!1;statusListeners=[];constructor(){this.scheduler=new V$(e=>this.executeBatchSync(e))}registerAdapter(e){this.adapters.set(e.name,e),this.syncStatus.adapterStatuses[e.name]={name:e.name,enabled:e.enabled,status:"idle",lastSync:null,nextSync:null,itemCount:0,error:null},console.log(` Registered sync adapter: ${e.name}`)}unregisterAdapter(e){this.adapters.delete(e),delete this.syncStatus.adapterStatuses[e],console.log(` Unregistered sync adapter: ${e}`)}setAdapterEnabled(e,r){const n=this.adapters.get(e);n&&(n.enabled=r,this.syncStatus.adapterStatuses[e]&&(this.syncStatus.adapterStatuses[e].enabled=r),console.log(`${r?"":""} Adapter ${e} ${r?"enabled":"disabled"}`))}queueSync(e,r="normal"){if(!this.enabled){console.log(` Unified sync is disabled, skipping: ${e}`);return}const n=this.adapters.get(e);if(!n){console.warn(` Adapter not found: ${e}`);return}if(!n.enabled){console.log(` Adapter ${e} is disabled, skipping sync`);return}this.scheduler.queueSync(e,r)}async syncAdapter(e){const r=this.adapters.get(e);if(!r)throw new Error(`Adapter not found: ${e}`);return r.enabled?await this._syncAdapter(r):{success:!1,action:"no-change",timestamp:Date.now(),itemCount:0,error:`Adapter ${e} is disabled`}}async _syncAdapter(e){const r=this.syncStatus.adapterStatuses[e.name];try{if(r.status="syncing",this.notifyStatusChange(),!await e.shouldSync())return r.status="idle",this.notifyStatusChange(),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const a=await e.getLocalData(),s=await e.getLastModified(),i=await e.pull();if(!i||i.length===0)return a&&(Array.isArray(a)?a.length>0:Object.keys(a).length>0)?(await e.push(a),r.status="success",r.lastSync=Date.now(),r.itemCount=Array.isArray(a)?a.length:1,r.error=null,this.notifyStatusChange(),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:r.itemCount}):(r.status="idle",this.notifyStatusChange(),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0});const l=Array.isArray(i)&&i.length>0?Math.max(...i.map(c=>c.timestamp||0)):i.timestamp||0;if(l>s){if(e.mergeData){const c=e.mergeData(a,i);await e.setLocalData(c)}else await e.setLocalData(i);return r.status="success",r.lastSync=Date.now(),r.itemCount=Array.isArray(i)?i.length:1,r.error=null,this.notifyStatusChange(),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:r.itemCount}}else return s>l?(await e.push(a),r.status="success",r.lastSync=Date.now(),r.itemCount=Array.isArray(a)?a.length:1,r.error=null,this.notifyStatusChange(),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:r.itemCount}):(r.status="success",r.lastSync=Date.now(),r.error=null,this.notifyStatusChange(),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0})}catch(n){const a=n instanceof Error?n.message:String(n);return console.error(` Error syncing ${e.name}:`,a),r.status="error",r.error=a,this.notifyStatusChange(),{success:!1,action:"no-change",timestamp:Date.now(),itemCount:0,error:a}}}async executeBatchSync(e){this.syncStatus.syncing=!0,this.notifyStatusChange(),(await Promise.allSettled(e.map(n=>{const a=this.adapters.get(n);return a?this._syncAdapter(a):Promise.reject(`Adapter not found: ${n}`)}))).forEach((n,a)=>{const s=e[a];if(n.status==="fulfilled"){const i=n.value;i.success&&i.action!=="no-change"&&console.log(` ${s}: ${i.action} (${i.itemCount} items)`)}else console.error(` ${s}: ${n.reason}`)}),this.syncStatus.syncing=!1,this.syncStatus.lastSyncTime=Date.now(),this.notifyStatusChange()}async syncAll(){const e={};this.syncStatus.syncing=!0,this.notifyStatusChange();for(const[r,n]of this.adapters)n.enabled&&(e[r]=await this._syncAdapter(n));return this.syncStatus.syncing=!1,this.syncStatus.lastSyncTime=Date.now(),this.notifyStatusChange(),e}start(e){e&&(this.syncInterval=e),this.enabled=!0,this.syncAll().then(()=>{console.log(" Initial unified sync complete")}),this.syncTimer=setInterval(()=>{this.syncAll()},this.syncInterval),console.log(` Unified sync started (interval: ${this.syncInterval/1e3/60} minutes)`)}stop(){this.enabled=!1,this.syncTimer&&(clearInterval(this.syncTimer),this.syncTimer=null),this.scheduler.clear(),console.log(" Unified sync stopped")}isEnabled(){return this.enabled}getStatus(){return{...this.syncStatus}}onStatusChange(e){return this.statusListeners.push(e),()=>{const r=this.statusListeners.indexOf(e);r>-1&&this.statusListeners.splice(r,1)}}notifyStatusChange(){const e=this.getStatus();this.statusListeners.forEach(r=>{try{r(e)}catch(n){console.error("Error in status listener:",n)}})}setDebounceInterval(e){this.scheduler.setBatchInterval(e)}setSyncInterval(e){this.syncInterval=e,this.syncTimer&&(this.stop(),this.start())}}const Ha=new W$,lg=t=>{const e=document.createElement("div");return e.textContent=t,e.innerHTML},Y$=async t=>{try{console.log(` Fetching image from URL: ${t.substring(0,100)}...`);const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const r=await e.blob(),n=await new Promise((a,s)=>{const i=new FileReader;i.onloadend=()=>a(i.result),i.onerror=s,i.readAsDataURL(r)});return console.log(` Converted to base64 (${(n.length/1024).toFixed(1)} KB)`),n}catch(e){throw console.error(` Failed to fetch image from ${t}:`,e),e}},Q$=async t=>{let e=t;const r=/swag-image:\/\/[A-Za-z0-9_]+/g,n=t.match(r)||[];if(n.length>0){console.log(` Found ${n.length} swag-image references, loading from IndexedDB...`);const{imageStorage:i}=await Zt(async()=>{const{imageStorage:l}=await Promise.resolve().then(()=>Ow);return{imageStorage:l}},[]);e=await i.processContentForDisplay(e),console.log(" Loaded swag-image references from IndexedDB")}const a=/!\[([^\]]*)\]\((https?:\/\/[^\)]+)\)/g,s=[...e.matchAll(a)];if(s.length>0){console.log(` Found ${s.length} HTTP image URLs, fetching and converting to base64...`);const i=new Map;for(const l of s){const[,,c]=l;if(!i.has(c))try{const d=await Y$(c);i.set(c,d)}catch{console.warn(` Skipping image that failed to fetch: ${c}`),i.set(c,c)}}i.forEach((l,c)=>{const d=new RegExp(`!\\[([^\\]]*)\\]\\(${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\)`,"g");e=e.replace(d,`![$1](${l})`)}),console.log(` Converted ${i.size} HTTP image URLs to base64`)}return e},K$=t=>{const e=new Map;let r=0,n=t.replace(/!\[([^\]]*)\]\((data:image\/[^;]+;base64,[^\)]+)\)/g,(a,s,i)=>{const l=`__IMAGE_PLACEHOLDER_${r++}__`;return e.set(l,{alt:s,dataUrl:i}),l});return n=n.replace(/(data:image\/[^;]+;base64,[^\s<"']+)/g,a=>{const s=`__IMAGE_PLACEHOLDER_${r++}__`;return e.set(s,{alt:"Image",dataUrl:a}),s}),n=lg(n),n=n.replace(/```(\w*)\n([\s\S]*?)```/g,"<pre><code>$2</code></pre>"),n=n.replace(/`([^`]+)`/g,"<code>$1</code>"),n=n.replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>"),n=n.replace(/\*([^*]+)\*/g,"<em>$1</em>"),n=n.replace(/(https?:\/\/[^\s<]+)/g,'<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>'),n=n.replace(/\n/g,"<br>"),e.forEach((a,s)=>{n=n.replace(s,`<img src="${a.dataUrl}" alt="${lg(a.alt)}" />`)}),n};let LP=null;const X$="google_docs_access_token";LP=localStorage.getItem(X$);const ms=async()=>{console.log(" Requesting Google Auth from centralized googleAuth service...");const{googleAuth:t}=await Zt(async()=>{const{googleAuth:r}=await Promise.resolve().then(()=>Ng);return{googleAuth:r}},void 0);if(!t.isAuthenticated())throw console.error(" User not authenticated - please log in first"),new Error("Please log in with Google Drive first (Settings  Cloud Sync)");const e=t.getAccessToken();if(!e)throw console.error(" No access token available"),new Error("No access token available - please reconnect Google Drive");return console.log(" Using access token from googleAuth service"),e},yxe=async()=>{console.log(" Listing Google Docs...");const t=await ms();console.log(" Using token:",t.substring(0,20)+"...");const e="mimeType='application/vnd.google-apps.spreadsheet' and trashed=false and name='Research Agent Swag'";console.log(" Query:",e),console.log(" Making API request to Google Drive...");const r=await fetch("https://www.googleapis.com/drive/v3/files?q="+encodeURIComponent(e)+"&fields=files(id,name,modifiedTime,properties,description)&orderBy=modifiedTime desc",{headers:{Authorization:"Bearer "+t}});if(console.log(" Response status:",r.status,r.statusText),!r.ok){const s=await r.json().catch(()=>({}));console.error(" API Error:",s);const l="Failed to list documents: "+(s.error?.message||r.statusText)+". Please grant permissions and try again.";throw console.error("",l),new Error(l)}const n=await r.json();console.log(" Documents retrieved:",n.files?.length||0);const a=n.files.filter(s=>s.name==="Research Agent Swag");return console.log(' Documents with exact name "Research Agent Swag":',a.length),a.map(s=>({id:s.id,name:s.name,modifiedTime:s.modifiedTime}))},bxe=async(t,e)=>{console.log(" Appending to Google Doc:",t);const r=await ms();console.log(" Using token:",r.substring(0,20)+"..."),console.log(" Getting document details...");const n=await fetch("https://docs.googleapis.com/v1/documents/"+t,{headers:{Authorization:"Bearer "+r}});if(!n.ok){const l=await n.json().catch(()=>({}));console.error(" API Error:",l);const d="Failed to get document: "+(l.error?.message||n.statusText)+". Please grant permissions and try again.";throw console.error("",d),new Error(d)}const a=await n.json(),s=a.body.content[a.body.content.length-1].endIndex-1;console.log(" End index:",s),console.log(" Appending content...");const i=await fetch("https://docs.googleapis.com/v1/documents/"+t+":batchUpdate",{method:"POST",headers:{Authorization:"Bearer "+r,"Content-Type":"application/json"},body:JSON.stringify({requests:[{insertText:{location:{index:s},text:`

`+e+`
`}}]})});if(!i.ok){const l=await i.json().catch(()=>({}));console.error(" API Error:",l);const d="Failed to append to document: "+(l.error?.message||i.statusText)+". Please grant permissions and try again.";throw console.error("",d),new Error(d)}console.log(" Content appended successfully")},xxe=()=>!!LP,YE="Research Agent",MP=async()=>{console.log(" Finding or creating Research Agent folder...");const t=await ms(),e=`mimeType='application/vnd.google-apps.folder' and name='${YE}' and trashed=false`;console.log(" Searching for folder:",e);const r=await fetch("https://www.googleapis.com/drive/v3/files?q="+encodeURIComponent(e)+"&fields=files(id,name)",{headers:{Authorization:"Bearer "+t}});if(!r.ok){const i=await r.json().catch(()=>({}));throw new Error("Failed to search for folder: "+(i.error?.message||r.statusText))}const n=await r.json();if(n.files&&n.files.length>0){const i=n.files[0].id;return console.log(" Found existing folder:",i),i}console.log(" Creating new folder...");const a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify({name:YE,mimeType:"application/vnd.google-apps.folder",description:"Storage for Research Agent settings and snippets"})});if(!a.ok){const i=await a.json().catch(()=>({}));throw new Error("Failed to create folder: "+(i.error?.message||a.statusText))}const s=await a.json();return console.log(" Created new folder:",s.id),s.id},vxe=async t=>{console.log(" Creating Google Doc in Research Agent folder:",t);const e=await ms(),r=await MP();console.log(" Making API request to Google Docs...");const n=await fetch("https://docs.googleapis.com/v1/documents",{method:"POST",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:JSON.stringify({title:t})});if(console.log(" Response status:",n.status,n.statusText),!n.ok){const c="Failed to create document: "+((await n.json().catch(()=>({}))).error?.message||n.statusText)+". Please grant permissions and try again.";throw console.error("",c),new Error(c)}const s=(await n.json()).documentId;try{console.log(" Moving document to Research Agent folder..."),(await fetch(`https://www.googleapis.com/drive/v3/files/${s}?addParents=${r}&fields=id,parents`,{method:"PATCH",headers:{Authorization:"Bearer "+e}})).ok?console.log(" Document moved to folder"):console.warn(" Could not move document to folder (document still created)")}catch(i){console.warn(" Could not move document to folder:",i)}try{console.log("  Adding app metadata to document..."),(await fetch(`https://www.googleapis.com/drive/v3/files/${s}?fields=id`,{method:"PATCH",headers:{Authorization:"Bearer "+e,"Content-Type":"application/json"},body:JSON.stringify({properties:{createdByApp:"LambdaLLMProxy-Swag",appVersion:"1.0"},description:"Created by LLM Proxy Swag feature"})})).ok?console.log(" Metadata added successfully"):console.warn(" Could not add metadata (document still created)")}catch(i){console.warn(" Could not add metadata:",i)}return{id:s,name:t,modifiedTime:new Date().toISOString()}},OP=async t=>{const e=await MP(),r=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='shares' and '${e}' in parents and mimeType='application/vnd.google-apps.folder' and trashed=false`,{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw new Error(`Failed to search for shares folder: ${r.statusText}`);const n=await r.json();if(n.files&&n.files.length>0)return n.files[0].id;const a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({name:"shares",mimeType:"application/vnd.google-apps.folder",parents:[e]})});if(!a.ok)throw new Error(`Failed to create shares folder: ${a.statusText}`);return(await a.json()).id},jP=async(t,e)=>{const r=await fetch(`https://www.googleapis.com/drive/v3/files/${t}/permissions`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({role:"reader",type:"anyone"})});if(!r.ok)throw new Error(`Failed to set public permissions: ${r.statusText}`);const n=await fetch(`https://www.googleapis.com/drive/v3/files/${t}?fields=webViewLink`,{headers:{Authorization:`Bearer ${e}`}});if(!n.ok)throw new Error(`Failed to get document link: ${n.statusText}`);return(await n.json()).webViewLink},J$=async(t,e,r,n)=>{let a="";{const m=e,y=m.content?await Q$(m.content):"";a=`
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>${lg(m.title||"Shared Snippet")}</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 800px; margin: 40px auto; padding: 20px; line-height: 1.6; color: #333; }
    h1 { color: #1a1a1a; border-bottom: 3px solid #4285f4; padding-bottom: 10px; }
    .metadata { color: #666; font-size: 0.9em; font-style: italic; margin: 10px 0; }
    .tags { margin: 20px 0; }
    .tag { display: inline-block; background: #e8f0fe; color: #1967d2; padding: 4px 12px; margin: 4px; border-radius: 12px; font-size: 0.85em; }
    .content { margin: 20px 0; white-space: pre-wrap; }
    code { background: #f1f3f4; padding: 2px 6px; border-radius: 3px; font-family: 'Courier New', monospace; }
    pre { background: #f1f3f4; padding: 15px; border-radius: 5px; overflow-x: auto; }
    pre code { background: none; padding: 0; }
    img { max-width: 100%; height: auto; margin: 20px 0; border-radius: 8px; }
  </style>
</head>
<body>
  <h1>${lg(m.title||"Untitled Snippet")}</h1>
  <div class="metadata">Shared from Research Agent  ${new Date(m.timestamp||Date.now()).toLocaleDateString()}</div>
  ${m.swags&&m.swags.length>0?`
  <div class="tags">
    ${m.swags.map(x=>`<span class="tag">${lg(x)}</span>`).join("")}
  </div>
  `:""}
  <div class="content">${K$(y)}</div>
</body>
</html>`}const s=await OP(n),i={name:`${t}.html`,mimeType:"text/html",parents:[s]},l=new FormData;l.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"})),l.append("file",new Blob([a],{type:"text/html"}));const c=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${n}`},body:l});if(!c.ok)throw new Error(`Failed to create HTML file: ${c.statusText}`);const p=(await c.json()).id,g=await jP(p,n);return{documentId:p,webViewLink:g}},wxe=async(t,e,r)=>{const n={type:"quiz",title:e.title||t,description:e.description||"",questions:e.questions||[],timestamp:e.timestamp||Date.now(),swags:e.swags||[],createdBy:"Research Agent",sharedAt:new Date().toISOString()},a=JSON.stringify(n,null,2),s=await OP(r),i={name:`${t}.json`,mimeType:"application/json",parents:[s]},l=new FormData;l.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"})),l.append("file",new Blob([a],{type:"application/json"}));const c=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${r}`},body:l});if(!c.ok)throw new Error(`Failed to create quiz JSON file: ${c.statusText}`);const p=(await c.json()).id,g=await jP(p,r);return{documentId:p,webViewLink:g}},Z$=async(t,e)=>{console.log(` Deleting shared document: ${t}`);const r=await fetch(`https://www.googleapis.com/drive/v3/files/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`Failed to delete file: ${r.statusText}`);console.log(" Successfully deleted shared document")},Sxe=async(t,e)=>{console.log(` Downloading file content: ${t}`,e?"(authenticated)":"(public)");const{getCurrentApiBase:r}=await Zt(async()=>{const{getCurrentApiBase:p}=await Promise.resolve().then(()=>CS);return{getCurrentApiBase:p}},void 0),n=await r(),{googleAuth:a}=await Zt(async()=>{const{googleAuth:p}=await Promise.resolve().then(()=>Ng);return{googleAuth:p}},void 0),s=a.getAccessToken();if(!s)throw new Error("Authentication required to view shared content. Please sign in with Google.");if(!e){const p=`${n}/drive-proxy?fileId=${t}`;console.log(` Fetching via proxy: ${p}`);const g=await fetch(p,{headers:{Authorization:`Bearer ${s}`}});if(!g.ok){const y=await g.text();throw console.error(" Failed to download file via proxy:",{status:g.status,statusText:g.statusText,url:p,errorBody:y.substring(0,500)}),g.status===401?new Error("Authentication required. Please sign in with Google."):new Error(`Failed to download file: ${g.status} ${g.statusText||"Unknown error"}`)}const m=await g.text();return console.log(` Downloaded file content via proxy (${m.length} bytes)`),m}const i=`https://www.googleapis.com/drive/v3/files/${t}?alt=media`,l={Authorization:`Bearer ${e}`};console.log(` Fetching from: ${i}`);const c=await fetch(i,{headers:l});if(!c.ok){const p=await c.text();throw console.error(" Failed to download file:",{status:c.status,statusText:c.statusText,url:i,hasAuth:!!e,errorBody:p.substring(0,500)}),new Error(`Failed to download file: ${c.status} ${c.statusText||"Unknown error"}`)}const d=await c.text();return console.log(` Downloaded file content (${d.length} bytes)`),d},eU="PlanningDB",tU=1,qi="plans",Tm=50;class rU{db=null;initPromise=null;async init(){return this.initPromise?this.initPromise:(this.initPromise=this._init(),this.initPromise)}async _init(){if(!this.db)try{this.db=await Dy(eU,tU,{upgrade(e){const r=e.createObjectStore(qi,{keyPath:"id"});r.createIndex("by-timestamp","timestamp"),r.createIndex("by-query","query"),console.log(" PlanningDB object store created")}}),console.log(" PlanningDB initialized"),await this.migrateFromLocalStorage()}catch(e){throw console.error(" Error initializing PlanningDB:",e),e}}async migrateFromLocalStorage(){if(localStorage.getItem("plans_migrated_to_idb")==="true"){console.log(" Plans already migrated to IndexedDB");return}try{const r=localStorage.getItem("llm_proxy_planning_cache");if(!r){console.log(" No plans in localStorage to migrate"),localStorage.setItem("plans_migrated_to_idb","true");return}const n=JSON.parse(r);if(!Array.isArray(n)||n.length===0){console.log(" No valid plans in localStorage to migrate"),localStorage.setItem("plans_migrated_to_idb","true");return}const a=this.db.transaction(qi,"readwrite"),s=a.objectStore(qi);let i=0;for(const l of n)try{await s.put(l),i++}catch(c){console.error(`Error migrating plan ${l.id}:`,c)}await a.done,console.log(` Migrated ${i} of ${n.length} plans from localStorage to IndexedDB`),localStorage.setItem("plans_migrated_to_idb","true")}catch(r){throw console.error(" Error during plan migration:",r),r}}async ensureInit(){this.db||await this.init()}async savePlan(e){await this.ensureInit();try{await this.db.put(qi,e),console.log(` Plan saved to IndexedDB: ${e.query.substring(0,50)}...`),await this.pruneOldPlans()}catch(r){throw console.error(" Error saving plan to IndexedDB:",r),r}}async getAllPlans(){await this.ensureInit();try{return(await this.db.getAll(qi)).sort((r,n)=>n.timestamp-r.timestamp)}catch(e){return console.error(" Error reading plans from IndexedDB:",e),[]}}async getPlan(e){await this.ensureInit();try{return await this.db.get(qi,e)}catch(r){console.error(` Error reading plan ${e} from IndexedDB:`,r);return}}async deletePlan(e){await this.ensureInit();try{await this.db.delete(qi,e),console.log(` Plan deleted from IndexedDB: ${e}`)}catch(r){throw console.error(` Error deleting plan ${e} from IndexedDB:`,r),r}}async clear(){await this.ensureInit();try{await this.db.clear(qi),console.log(" All plans cleared from IndexedDB")}catch(e){throw console.error(" Error clearing plans from IndexedDB:",e),e}}async replacePlans(e){await this.ensureInit();try{const r=this.db.transaction(qi,"readwrite"),n=r.objectStore(qi);await n.clear();for(const a of e)await n.put(a);await r.done,console.log(` Replaced all plans with ${e.length} items from sync`)}catch(r){throw console.error(" Error replacing plans in IndexedDB:",r),r}}async getPlansModifiedSince(e){await this.ensureInit();try{return(await this.getAllPlans()).filter(n=>n.timestamp>e)}catch(r){return console.error(" Error getting modified plans:",r),[]}}async pruneOldPlans(){try{const e=await this.getAllPlans();if(e.length<=Tm)return;const n=e.sort((i,l)=>l.timestamp-i.timestamp).slice(Tm),a=this.db.transaction(qi,"readwrite"),s=a.objectStore(qi);for(const i of n)await s.delete(i.id);await a.done,console.log(` Pruned ${n.length} old plans (keeping ${Tm} most recent)`)}catch(e){console.error(" Error pruning old plans:",e)}}async getStorageEstimate(){if("storage"in navigator&&"estimate"in navigator.storage)try{const e=await navigator.storage.estimate(),r=e.usage||0,n=e.quota||0,a=n>0?r/n*100:0;return{usage:r,quota:n,percentage:a}}catch(e){return console.error("Error getting storage estimate:",e),null}return null}async requestPersistentStorage(){if("storage"in navigator&&"persist"in navigator.storage)try{if(!await navigator.storage.persisted()){const r=await navigator.storage.persist();return console.log("Persistent storage request:",r?"granted":"denied"),r}return console.log("Storage is already persistent"),!0}catch(e){return console.error("Error requesting persistent storage:",e),!1}return console.warn("Persistent storage API not available"),!1}mergePlans(e,r){const n=new Map;return e.forEach(a=>{const s=a.query.trim().toLowerCase();n.set(s,a)}),r.forEach(a=>{const s=a.query.trim().toLowerCase(),i=n.get(s);(!i||a.timestamp>i.timestamp)&&n.set(s,a)}),Array.from(n.values()).sort((a,s)=>s.timestamp-a.timestamp).slice(0,Tm)}}const Pl=new rU;function BP(){return`plan_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}const kxe=Object.freeze(Object.defineProperty({__proto__:null,generatePlanId:BP,planningDB:Pl},Symbol.toStringTag,{value:"Module"}));function nU(){return BP()}async function Pg(){try{return await Pl.getAllPlans()}catch(t){return console.error("Error reading planning cache:",t),[]}}async function FP(t,e,r,n){try{const a=await Pg(),s=t.trim().toLowerCase(),i=a.find(c=>c.query.trim().toLowerCase()===s),l={id:i?.id||nU(),query:t.trim(),plan:e,systemPrompt:r,userPrompt:n,timestamp:Date.now()};await Pl.savePlan(l),console.log(`Plan saved ${i?"(replaced duplicate)":"(new)"}:`,t.trim()),Ha.isEnabled()&&Ha.queueSync("plans","high"),ls.triggerAutoSync()}catch(a){throw console.error("Error saving plan to cache:",a),a instanceof DOMException&&(a.name==="QuotaExceededError"||a.code===22)?(console.error("Storage quota exceeded. Consider:",`
1. Deleting old saved plans`,`
2. Clearing browser data`,`
3. Using persistent storage (navigator.storage.persist())`),new Error("Storage quota exceeded. Please delete some old plans to free up space, or clear your browser cache.")):a}}async function aU(t){try{await Pl.deletePlan(t),Ha.isEnabled()&&Ha.queueSync("plans","high"),ls.triggerAutoSync()}catch(e){throw console.error("Error deleting cached plan:",e),e}}async function sU(){try{await Pl.clear()}catch(t){throw console.error("Error clearing planning cache:",t),t}}async function iU(){return await Pl.getStorageEstimate()}const QE="rag_embeddings",oU=2,Js="chunks",Lo="metadata",Dd="search_cache";class lU{db=null;initPromise=null;async resetDatabase(){console.log(" Deleting and recreating RAG database..."),this.db&&(this.db.close(),this.db=null),this.initPromise=null,await new Promise((e,r)=>{const n=indexedDB.deleteDatabase(QE);n.onsuccess=()=>{console.log(" Database deleted successfully"),e()},n.onerror=()=>{console.error(" Failed to delete database:",n.error),r(n.error)},n.onblocked=()=>{console.warn(" Database deletion blocked - close all tabs using this database")}}),await this.init(),console.log(" Database recreated successfully")}async init(){return this.initPromise?this.initPromise:(this.initPromise=new Promise((e,r)=>{if(!window.indexedDB){console.warn("IndexedDB not supported"),r(new Error("IndexedDB not supported"));return}const n=indexedDB.open(QE,oU);n.onerror=()=>{console.error("RAG IndexedDB error:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log("RAG IndexedDB initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result,i=a.oldVersion;if(!s.objectStoreNames.contains(Js)){const l=s.createObjectStore(Js,{keyPath:"id"});l.createIndex("snippet_id","snippet_id",{unique:!1}),l.createIndex("created_at","created_at",{unique:!1})}s.objectStoreNames.contains(Lo)||s.createObjectStore(Lo,{keyPath:"snippet_id"}),i<2&&!s.objectStoreNames.contains(Dd)&&s.createObjectStore(Dd,{keyPath:"query"}).createIndex("created_at","created_at",{unique:!1})}}),this.initPromise)}async hasEmbedding(e){return await this.init(),this.db?new Promise((r,n)=>{const l=this.db.transaction([Js],"readonly").objectStore(Js).index("snippet_id").count(IDBKeyRange.only(e));l.onsuccess=()=>{r(l.result>0)},l.onerror=()=>{console.error("Error checking embedding:",l.error),n(l.error)}}):!1}async getEmbeddingDetails(e){return await this.init(),this.db?new Promise(r=>{try{if(!this.db||this.db.name===void 0){r({hasEmbedding:!1,chunkCount:0,chunks:[]});return}const n=this.db.transaction([Js,Lo],"readonly");n.onerror=()=>{console.warn("Transaction error in getEmbeddingDetails:",n.error),r({hasEmbedding:!1,chunkCount:0,chunks:[]})},n.onabort=()=>{console.warn("Transaction aborted in getEmbeddingDetails"),r({hasEmbedding:!1,chunkCount:0,chunks:[]})};const i=n.objectStore(Js).index("snippet_id").getAll(IDBKeyRange.only(e)),c=n.objectStore(Lo).get(e);n.oncomplete=()=>{const d=i.result,p=c.result;r({hasEmbedding:d.length>0,chunkCount:d.length,chunks:d.sort((g,m)=>g.chunk_index-m.chunk_index),metadata:p})}}catch(n){console.warn("Error in getEmbeddingDetails:",n),r({hasEmbedding:!1,chunkCount:0,chunks:[]})}}):{hasEmbedding:!1,chunkCount:0,chunks:[]}}async bulkCheckEmbeddings(e){if(await this.init(),!this.db)return{};const r={};for(const n of e)try{r[n]=await this.hasEmbedding(n)}catch(a){console.error(`Error checking embedding for ${n}:`,a),r[n]=!1}return r}async saveChunks(e,r){if(await this.init(),!this.db)throw new Error("Database not initialized");return console.log(" saveChunks called with:",{chunkCount:e.length,firstChunk:e[0],firstChunkKeys:e[0]?Object.keys(e[0]):[],hasId:e[0]?.id!==void 0,idValue:e[0]?.id,idType:typeof e[0]?.id,chunkStringified:JSON.stringify(e[0],null,2)}),new Promise(async(n,a)=>{const s=e[0]?.snippet_id||r?.snippet_id;if(s)try{console.log(` Deleting old chunks for snippet: ${s}`),await this.deleteChunks(s),console.log(" Deleted old chunks for snippet")}catch(c){console.warn(" Failed to delete old chunks:",c)}const i=this.db.transaction([Js,Lo],"readwrite"),l=i.objectStore(Js);console.log(" IndexedDB Store Info:",{storeName:l.name,keyPath:l.keyPath,autoIncrement:l.autoIncrement,indexNames:Array.from(l.indexNames)});for(let c=0;c<e.length;c++){const d=e[c];try{const p=d.snippet_id||r?.snippet_id||"unknown",g=d.chunk_index??c,m=d.id||`${p}_chunk_${g}`;if(!m||m==="undefined_chunk_0"||m==="_chunk_0")throw console.error(" Invalid chunk ID generated:",{chunkId:m,snippetId:p,chunkIndex:g,chunk:d}),new Error(`Invalid chunk ID: ${m}`);const y=Array.isArray(d.embedding)?[...d.embedding]:Array.from(d.embedding||[]),x={id:m,snippet_id:p,chunk_text:d.chunk_text||"",embedding:y,chunk_index:g,embedding_model:d.embedding_model||"text-embedding-3-small",created_at:d.created_at||new Date().toISOString()};if(!x.id)throw new Error(`Chunk missing id property after normalization: ${JSON.stringify(Object.keys(x))}`);const w=x.id;if(!w)throw new Error(`Cannot access id property via bracket notation: ${w}`);const T=Object.getPrototypeOf(x);if(T!==Object.prototype)throw new Error(`Chunk has non-plain prototype: ${T?.constructor?.name}`);console.log(" Putting chunk:",{id:x.id,snippetId:x.snippet_id,chunkIndex:x.chunk_index,embeddingLength:x.embedding.length,embeddingType:x.embedding.constructor.name,allKeys:Object.keys(x),idDescriptor:Object.getOwnPropertyDescriptor(x,"id"),objectType:typeof x,prototypeChainDepth:(()=>{let P=0,F=x;for(;F&&P<10;)F=Object.getPrototypeOf(F),P++;return P})()});const k=JSON.stringify(x),_=JSON.parse(k);if(!_.id)throw new Error(`Chunk id lost during JSON serialization! Original: ${x.id}`);console.log(" Chunk survived JSON round-trip with id:",_.id),await new Promise((P,F)=>{const D=l.put(_);D.onsuccess=()=>{P()},D.onerror=()=>{console.error(" PUT request failed:",{chunk:x,error:D.error,errorName:D.error?.name,errorMessage:D.error?.message,chunkKeys:Object.keys(x),hasIdProperty:"id"in x,idValue:x.id}),F(D.error)}})}catch(p){throw console.error(" Error putting chunk:",{chunk:d,error:p}),p}}r&&i.objectStore(Lo).put(r),i.oncomplete=()=>{console.log(`Saved ${e.length} chunks to IndexedDB`),n()},i.onerror=()=>{console.error("Error saving chunks:",i.error),a(i.error)}})}async deleteChunks(e){if(await this.init(),!!this.db)return new Promise((r,n)=>{const a=this.db.transaction([Js,Lo],"readwrite"),l=a.objectStore(Js).index("snippet_id").openCursor(IDBKeyRange.only(e));l.onsuccess=d=>{const p=d.target.result;p&&(p.delete(),p.continue())},a.objectStore(Lo).delete(e),a.oncomplete=()=>{console.log(`Deleted chunks for snippet ${e}`),r()},a.onerror=()=>{console.error("Error deleting chunks:",a.error),n(a.error)}})}async getAllEmbeddedSnippetIds(){return await this.init(),this.db?new Promise((e,r)=>{const s=this.db.transaction([Lo],"readonly").objectStore(Lo).getAllKeys();s.onsuccess=()=>{e(s.result)},s.onerror=()=>{console.error("Error getting embedded snippet IDs:",s.error),r(s.error)}}):[]}async cacheQueryEmbedding(e,r,n){if(await this.init(),!!this.db)return new Promise((a,s)=>{const i=this.db.transaction([Dd],"readwrite"),l=i.objectStore(Dd),c={query:e,embedding:r,model:n,created_at:Date.now()};l.put(c),i.oncomplete=()=>{a()},i.onerror=()=>{console.error("Error caching query embedding:",i.error),s(i.error)}})}async getCachedQueryEmbedding(e){return await this.init(),this.db?new Promise((r,n)=>{const i=this.db.transaction([Dd],"readonly").objectStore(Dd).get(e);i.onsuccess=()=>{const l=i.result;r(l?{embedding:l.embedding,model:l.model}:null)},i.onerror=()=>{console.error("Error getting cached query:",i.error),n(i.error)}}):null}cosineSimilarity(e,r){if(e.length!==r.length)throw new Error("Vectors must have same length");let n=0,a=0,s=0;for(let i=0;i<e.length;i++)n+=e[i]*r[i],a+=e[i]*e[i],s+=r[i]*r[i];return n/(Math.sqrt(a)*Math.sqrt(s))}async vectorSearch(e,r=5,n=.5){return await this.init(),this.db?new Promise((a,s)=>{const c=this.db.transaction([Js],"readonly").objectStore(Js).getAll();c.onsuccess=()=>{const p=c.result.map(y=>({snippet_id:y.snippet_id,chunk_id:y.id,chunk_text:y.chunk_text,chunk_index:y.chunk_index,score:this.cosineSimilarity(e,y.embedding)})),g=[...p].sort((y,x)=>x.score-y.score);console.log(` Vector search - Top 10 scores (threshold: ${n}):`,g.slice(0,10).map(y=>({score:y.score.toFixed(4),snippet_id:y.snippet_id,chunk_preview:y.chunk_text.substring(0,100)+"..."})));const m=p.filter(y=>y.score>=n).sort((y,x)=>x.score-y.score).slice(0,r);console.log(` Returning ${m.length} results above threshold ${n}`),a(m)},c.onerror=()=>{console.error("Error performing vector search:",c.error),s(c.error)}}):[]}async getAllChunks(){return await this.init(),this.db?new Promise((e,r)=>{const s=this.db.transaction([Js],"readonly").objectStore(Js).getAll();s.onsuccess=()=>{e(s.result)},s.onerror=()=>{console.error("Error getting all chunks:",s.error),r(s.error)}}):[]}}const Is=new lU,Txe=Object.freeze(Object.defineProperty({__proto__:null,ragDB:Is},Symbol.toStringTag,{value:"Module"})),cU="ChatHistoryDB",uU=1,Da="chats";class dU{db=null;initPromise=null;async init(){return this.db?this.db:this.initPromise?this.initPromise:(this.initPromise=new Promise((e,r)=>{const n=indexedDB.open(cU,uU);n.onerror=()=>{console.error("Failed to open IndexedDB:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log("IndexedDB initialized successfully"),e(this.db)},n.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains(Da)||(s.createObjectStore(Da,{keyPath:"id"}).createIndex("timestamp","timestamp",{unique:!1}),console.log("Created chat history object store"))}}),this.initPromise)}async saveChat(e,r,n,a){try{const l=(await this.init()).transaction([Da],"readwrite").objectStore(Da),c={id:e,messages:r,timestamp:Date.now(),title:n,...a?.systemPrompt&&{systemPrompt:a.systemPrompt},...a?.planningQuery&&{planningQuery:a.planningQuery},...a?.generatedSystemPrompt&&{generatedSystemPrompt:a.generatedSystemPrompt},...a?.generatedUserQuery&&{generatedUserQuery:a.generatedUserQuery},...a?.selectedSnippetIds&&{selectedSnippetIds:a.selectedSnippetIds},...a?.todosState&&{todosState:a.todosState},...a?.projectId&&{projectId:a.projectId}};await new Promise((d,p)=>{const g=l.put(c);g.onsuccess=()=>d(),g.onerror=()=>p(g.error)}),console.log(`Saved chat ${e} to IndexedDB with planning/todos metadata`),ls.triggerAutoSync()}catch(s){throw console.error("Error saving chat to IndexedDB:",s),s}}async getChat(e){try{const a=(await this.init()).transaction([Da],"readonly").objectStore(Da);return new Promise((s,i)=>{const l=a.get(e);l.onsuccess=()=>{const c=l.result;s(c?c.messages:null)},l.onerror=()=>i(l.error)})}catch(r){return console.error("Error getting chat from IndexedDB:",r),null}}async getChatWithMetadata(e){try{const a=(await this.init()).transaction([Da],"readonly").objectStore(Da);return new Promise((s,i)=>{const l=a.get(e);l.onsuccess=()=>{const c=l.result;s(c||null)},l.onerror=()=>i(l.error)})}catch(r){return console.error("Error getting chat with metadata from IndexedDB:",r),null}}async getAllChats(){try{const n=(await this.init()).transaction([Da],"readonly").objectStore(Da);return new Promise((a,s)=>{const i=n.getAll();i.onsuccess=()=>a(i.result||[]),i.onerror=()=>s(i.error)})}catch(e){return console.error("Error getting all chats from IndexedDB:",e),[]}}async deleteChat(e){try{const a=(await this.init()).transaction([Da],"readwrite").objectStore(Da);await new Promise((s,i)=>{const l=a.delete(e);l.onsuccess=()=>s(),l.onerror=()=>i(l.error)}),console.log(`Deleted chat ${e} from IndexedDB`),ls.triggerAutoSync()}catch(r){throw console.error("Error deleting chat from IndexedDB:",r),r}}async clearAllChats(){try{const n=(await this.init()).transaction([Da],"readwrite").objectStore(Da);await new Promise((a,s)=>{const i=n.clear();i.onsuccess=()=>a(),i.onerror=()=>s(i.error)}),console.log("Cleared all chats from IndexedDB")}catch(e){throw console.error("Error clearing all chats from IndexedDB:",e),e}}async getOldestChats(e){try{const s=(await this.init()).transaction([Da],"readonly").objectStore(Da).index("timestamp");return new Promise((i,l)=>{const c=s.openCursor(),d=[];c.onsuccess=p=>{const g=p.target.result;g&&d.length<e?(d.push(g.value),g.continue()):i(d)},c.onerror=()=>l(c.error)})}catch(r){return console.error("Error getting oldest chats:",r),[]}}async getCount(){try{const n=(await this.init()).transaction([Da],"readonly").objectStore(Da);return new Promise((a,s)=>{const i=n.count();i.onsuccess=()=>a(i.result),i.onerror=()=>s(i.error)})}catch(e){return console.error("Error getting chat count:",e),0}}async cleanupOldChats(e){try{const r=await this.getAllChats();if(r.length<=e)return 0;const a=r.sort((c,d)=>c.timestamp-d.timestamp).slice(0,r.length-e),i=(await this.init()).transaction([Da],"readwrite"),l=i.objectStore(Da);for(const c of a)l.delete(c.id);return await new Promise((c,d)=>{i.oncomplete=()=>c(),i.onerror=()=>d(i.error)}),console.log(`Cleaned up ${a.length} old chats`),a.length}catch(r){return console.error("Error cleaning up old chats:",r),0}}async migrateFromLocalStorage(){try{let e=0;const r=Object.keys(localStorage).filter(n=>n.startsWith("chat_history_"));for(const n of r)try{const a=localStorage.getItem(n);if(a){const s=JSON.parse(a),i=n.replace("chat_history_","");await this.saveChat(i,s),localStorage.removeItem(n),e++}}catch(a){console.error(`Error migrating ${n}:`,a)}return e>0&&console.log(`Migrated ${e} chat histories from localStorage to IndexedDB`),e}catch(e){return console.error("Error during migration:",e),0}}}const _i=new dU,Cxe=Object.freeze(Object.defineProperty({__proto__:null,chatHistoryDB:_i},Symbol.toStringTag,{value:"Module"})),hU="quiz_statistics",pU=1,ia="statistics";class gU{db=null;initPromise=null;async init(){return this.initPromise?this.initPromise:(this.initPromise=new Promise((e,r)=>{if(!window.indexedDB){console.warn("IndexedDB not supported"),r(new Error("IndexedDB not supported"));return}const n=indexedDB.open(hU,pU);n.onerror=()=>{console.error("Failed to open quiz database:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log(" Quiz database initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result;if(!s.objectStoreNames.contains(ia)){const i=s.createObjectStore(ia,{keyPath:"id"});i.createIndex("completedAt","completedAt",{unique:!1}),i.createIndex("score","score",{unique:!1}),i.createIndex("percentage","percentage",{unique:!1}),i.createIndex("synced","synced",{unique:!1}),console.log(" Quiz statistics store created")}}}),this.initPromise)}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}async saveQuizStatistic(e){if(await this.init(),!this.db)throw new Error("Database not initialized");const r=this.generateUUID(),n=Math.round(e.score/e.totalQuestions*100),a={...e,id:r,synced:!1,percentage:n,completed:e.completed??!0};return new Promise((s,i)=>{const d=this.db.transaction([ia],"readwrite").objectStore(ia).add(a);d.onsuccess=()=>{console.log(" Quiz statistic saved:",r),ls.triggerAutoSync(),s(r)},d.onerror=()=>{console.error("Failed to save quiz statistic:",d.error),i(d.error)}})}async quizExistsByTitle(e,r){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((n,a)=>{const l=this.db.transaction([ia],"readonly").objectStore(ia).getAll();l.onsuccess=()=>{const d=l.result.some(p=>p.quizTitle===e&&(!r||p.projectId===r));n(d)},l.onerror=()=>{console.error("Failed to check quiz existence:",l.error),a(l.error)}})}async saveGeneratedQuiz(e,r,n,a,s,i,l){if(await this.init(),!this.db)throw new Error("Database not initialized");if(await this.quizExistsByTitle(e,i))return console.log(` Quiz "${e}" already exists, skipping duplicate save`),"";const d=this.generateUUID(),p={id:d,quizTitle:e,snippetIds:r,score:0,totalQuestions:n,percentage:0,timeTaken:0,completedAt:"",answers:[],enrichment:a,synced:!1,completed:!1,quizData:s,projectId:i,userId:l};return new Promise((g,m)=>{const w=this.db.transaction([ia],"readwrite").objectStore(ia).add(p);w.onsuccess=()=>{console.log(" Generated quiz saved:",d),g(d)},w.onerror=()=>{console.error("Failed to save generated quiz:",w.error),m(w.error)}})}async updateQuizData(e,r){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((n,a)=>{const i=this.db.transaction([ia],"readwrite").objectStore(ia),l=i.get(e);l.onsuccess=()=>{const c=l.result;if(!c){a(new Error("Quiz not found"));return}console.log(" Updating quiz data:",{id:e,oldQuizData:{title:c.quizData?.title,questionCount:c.quizData?.questions?.length,firstQuestionAnswerId:c.quizData?.questions?.[0]?.answerId},newQuizData:{title:r?.title,questionCount:r?.questions?.length,firstQuestionAnswerId:r?.questions?.[0]?.answerId}});const d={...c,quizData:r},p=i.put(d);p.onsuccess=()=>{console.log(" Quiz data updated in IndexedDB:",e),n()},p.onerror=()=>{console.error("Failed to update quiz data:",p.error),a(p.error)}},l.onerror=()=>{console.error("Failed to get quiz:",l.error),a(l.error)}})}async updateQuizCompletion(e,r,n,a){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((s,i)=>{const c=this.db.transaction([ia],"readwrite").objectStore(ia),d=c.get(e);d.onsuccess=()=>{const p=d.result;if(!p){i(new Error("Quiz not found"));return}const g=Math.round(r/p.totalQuestions*100),m={...p,score:r,percentage:g,timeTaken:n,answers:a,completedAt:new Date().toISOString(),completed:!0},y=c.put(m);y.onsuccess=()=>{console.log(" Quiz completion updated:",e),s()},y.onerror=()=>{console.error("Failed to update quiz completion:",y.error),i(y.error)}},d.onerror=()=>{console.error("Failed to get quiz:",d.error),i(d.error)}})}async getQuizStatistics(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction([ia],"readonly").objectStore(ia).getAll();i.onsuccess=()=>{const l=i.result,c=l.sort((p,g)=>!p.completedAt&&!g.completedAt?0:p.completedAt?g.completedAt?new Date(g.completedAt).getTime()-new Date(p.completedAt).getTime():1:-1),d=e?c.slice(0,e):c;console.log(" getQuizStatistics results:",{total:l.length,incomplete:l.filter(p=>!p.completedAt).length,completed:l.filter(p=>p.completedAt).length,returned:d.length}),r(d)},i.onerror=()=>{console.error("Failed to get quiz statistics:",i.error),n(i.error)}})}async getQuizStatistic(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction([ia],"readonly").objectStore(ia).get(e);i.onsuccess=()=>{const l=i.result||null;l&&console.log(" Retrieved quiz from DB:",{id:e.substring(0,8),title:l.quizTitle,hasQuizData:!!l.quizData,firstQuestionAnswerId:l.quizData?.questions?.[0]?.answerId}),r(l)},i.onerror=()=>{console.error("Failed to get quiz statistic:",i.error),n(i.error)}})}async deleteQuizStatistic(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction([ia],"readwrite").objectStore(ia).delete(e);i.onsuccess=()=>{console.log(" Quiz statistic deleted:",e),r()},i.onerror=()=>{console.error("Failed to delete quiz statistic:",i.error),n(i.error)}})}async markAsSynced(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const s=this.db.transaction([ia],"readwrite").objectStore(ia);let i=0,l=!1;for(const c of e){const d=s.get(c);d.onsuccess=()=>{const p=d.result;if(p){p.synced=!0;const g=s.put(p);g.onsuccess=()=>{i++,i===e.length&&!l&&(console.log(` Marked ${e.length} quiz statistics as synced`),r())},g.onerror=()=>{l||(l=!0,n(g.error))}}else i++,i===e.length&&!l&&r()},d.onerror=()=>{l||(l=!0,n(d.error))}}})}async getUnsyncedStatistics(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const i=this.db.transaction([ia],"readonly").objectStore(ia).index("synced").openCursor(IDBKeyRange.only(!1)),l=[];i.onsuccess=()=>{const c=i.result;c?(l.push(c.value),c.continue()):e(l)},i.onerror=()=>{console.error("Failed to get unsynced statistics:",i.error),r(i.error)}})}async getStatisticsSummary(){const r=(await this.getQuizStatistics()).filter(l=>l.completed);if(r.length===0)return{totalQuizzes:0,averageScore:0,averagePercentage:0,highestScore:0,lowestScore:0,totalQuestionsAnswered:0,totalCorrectAnswers:0};const n=r.reduce((l,c)=>l+c.score,0),a=r.reduce((l,c)=>l+c.totalQuestions,0),s=r.reduce((l,c)=>l+c.score,0),i=r.map(l=>l.percentage);return{totalQuizzes:r.length,averageScore:n/r.length,averagePercentage:i.reduce((l,c)=>l+c,0)/r.length,highestScore:Math.max(...i),lowestScore:Math.min(...i),totalQuestionsAnswered:a,totalCorrectAnswers:s}}async clearAllStatistics(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction([ia],"readwrite").objectStore(ia).clear();s.onsuccess=()=>{console.log(" All quiz statistics cleared"),e()},s.onerror=()=>{console.error("Failed to clear quiz statistics:",s.error),r(s.error)}})}}const yu=new gU,fU=Object.freeze(Object.defineProperty({__proto__:null,quizDB:yu},Symbol.toStringTag,{value:"Module"}));class mU{dbName="swag-images";storeName="images";db=null;dbReady;constructor(){this.dbReady=this.initDB()}async initDB(){return new Promise((e,r)=>{const n=indexedDB.open(this.dbName,1);n.onerror=()=>{console.error(" Failed to open IndexedDB:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log(" IndexedDB initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result;s.objectStoreNames.contains(this.storeName)||(s.createObjectStore(this.storeName,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1}),console.log(" Created IndexedDB object store"))}})}async ensureReady(){await this.dbReady}async saveImage(e){if(await this.ensureReady(),!this.db)throw new Error("IndexedDB not initialized");const r=e.match(/data:([^;]+);base64,/),n=r?r[1]:"image/png",a=e.length,s=`img_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;let i,l;try{const d=await this.getImageDimensions(e);i=d.width,l=d.height}catch(d){console.warn("Could not extract image dimensions:",d)}const c={id:s,data:e,size:a,mimeType:n,width:i,height:l,createdAt:Date.now()};return new Promise((d,p)=>{const y=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(c);y.onsuccess=()=>{console.log(` Saved image: ${s} (${(a/1024).toFixed(2)} KB)`),d(`swag-image://${s}`)},y.onerror=()=>{console.error(" Failed to save image:",y.error),p(y.error)}})}async updateImage(e,r){if(await this.ensureReady(),!this.db)throw new Error("IndexedDB not initialized");const n=r.match(/data:([^;]+);base64,/),a=n?n[1]:"image/png",s=r.length;let i,l;try{const d=await this.getImageDimensions(r);i=d.width,l=d.height}catch(d){console.warn("Could not extract image dimensions:",d)}const c={id:e,data:r,size:s,mimeType:a,width:i,height:l,createdAt:Date.now()};return new Promise((d,p)=>{const y=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).put(c);y.onsuccess=()=>{console.log(` Updated image: ${e} (${(s/1024).toFixed(2)} KB)`),d()},y.onerror=()=>{console.error(" Failed to update image:",y.error),p(y.error)}})}async getImage(e){if(await this.ensureReady(),!this.db)throw new Error("IndexedDB not initialized");const r=e.replace("swag-image://","");return new Promise((n,a)=>{const l=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(r);l.onsuccess=()=>{const c=l.result;c?n(c.data):(console.debug(` Image not found in IndexedDB: ${r} (may have been deleted or not synced yet)`),a(new Error(`Image not found: ${r}`)))},l.onerror=()=>{console.error(" Failed to get image:",l.error),a(l.error)}})}async getImageMetadata(e){if(await this.ensureReady(),!this.db)return null;const r=e.replace("swag-image://","");return new Promise((n,a)=>{const l=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(r);l.onsuccess=()=>{const c=l.result;if(c){const{data:d,...p}=c;n(p)}else n(null)},l.onerror=()=>{a(l.error)}})}async deleteImage(e){if(await this.ensureReady(),!this.db)throw new Error("IndexedDB not initialized");const r=e.replace("swag-image://","");return new Promise((n,a)=>{const l=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(r);l.onsuccess=()=>{console.log(` Deleted image: ${r}`),n()},l.onerror=()=>{console.error(" Failed to delete image:",l.error),a(l.error)}})}async getAllImages(){return await this.ensureReady(),this.db?new Promise((e,r)=>{const s=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();s.onsuccess=()=>{e(s.result)},s.onerror=()=>{r(s.error)}}):[]}async getStorageSize(){return(await this.getAllImages()).reduce((r,n)=>r+n.size,0)}async clearAll(){if(await this.ensureReady(),!this.db)throw new Error("IndexedDB not initialized");return new Promise((e,r)=>{const s=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();s.onsuccess=()=>{console.log(" Cleared all images"),e()},s.onerror=()=>{r(s.error)}})}getImageDimensions(e){return new Promise((r,n)=>{const a=new Image;a.onload=()=>{r({width:a.width,height:a.height})},a.onerror=n,a.src=e})}async processContentForSave(e){const r=/(data:image\/[^;]+;base64,[A-Za-z0-9+/=]+)/g,n=e.match(r)||[];if(n.length===0)return e;console.log(` Processing ${n.length} images for storage...`);const a=n[0];a&&console.log(" First image preview:",a.substring(0,100)+"...");let s=e;const i=[...new Set(n)];for(const l of i)try{console.log(` Saving image (${(l.length/1024).toFixed(1)} KB)...`);const c=await this.saveImage(l);console.log(` Saved as: ${c}`),s=s.split(l).join(c)}catch(c){console.error("Failed to save image, keeping original:",c)}return s}async processContentForDisplay(e){const r=/(swag-image:\/\/[A-Za-z0-9_]+)/g,n=e.match(r)||[];if(n.length===0)return e;console.log(` processContentForDisplay: Found ${n.length} image references to load`),console.log(" References:",n);let a=e;const s=[...new Set(n)],i=s.map(async p=>{try{console.log(` Loading image from IndexedDB: ${p}`);const g=await this.getImage(p);return console.log(` Loaded image ${p}: ${(g.length/1024).toFixed(1)} KB`),{ref:p,base64:g,success:!0}}catch(g){return console.error(` Image not found in IndexedDB: ${p}`,g),console.error(' This will show as "Image Not Found" grey box'),{ref:p,base64:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzk5OSI+SW1hZ2UgTm90IEZvdW5kPC90ZXh0Pjwvc3ZnPg==",success:!1}}}),l=await Promise.all(i),c=l.filter(p=>p.success).length,d=l.filter(p=>!p.success).length;console.log(` Image loading summary: ${c} succeeded, ${d} failed`);for(const{ref:p,base64:g}of l)a=a.split(p).join(g);return console.log(` processContentForDisplay: Replaced ${s.length} references with base64 data`),a}async garbageCollect(e){if(console.log(" Starting garbage collection..."),console.log(` Checking ${e.length} snippets`),e.length===0)return console.log("  SKIPPING: No snippets loaded yet - not safe to garbage collect"),0;const r=await this.getAllImages();console.log(` Found ${r.length} images in IndexedDB`);const n=e.join(`
`);console.log(` Total content length: ${n.length} characters`);const a=n.match(/swag-image:\/\/img_[^"\s<>]+/g)||[];console.log(` Found ${a.length} swag-image references in content:`,a);let s=0;for(const i of r){const l=`swag-image://${i.id}`,c=n.includes(l),d=600*1e3,p=Date.now()-(i.createdAt||0);if(c)console.log(` Keeping referenced image: ${i.id} (found in content)`);else{if(p<d){console.log(`  Skipping deletion for recent image: ${i.id} (age ${(p/1e3).toFixed(1)}s) - protected by retention policy`);continue}console.log(`  DELETING orphaned image: ${i.id} (${(i.size/1024).toFixed(2)} KB)`),console.log("  This image reference was NOT found in any snippet content");try{await this.deleteImage(l),s++}catch(g){console.error(`Failed to delete orphaned image ${i.id}:`,g)}}}return s>0?console.log(`  GARBAGE COLLECTED ${s} ORPHANED IMAGES`):console.log("  No orphaned images found - all images are referenced"),s}}const po=new mU,Ow=Object.freeze(Object.defineProperty({__proto__:null,imageStorage:po},Symbol.toStringTag,{value:"Module"})),Cp="Research Agent",wv="saved_plans.json",Sv="saved_playlists.json",KE="saved_snippets.json",XE="saved_embeddings.json",kv="chat_history.json",Tv="quiz_progress.json",Cv="settings.json",yU="saved_images.json",JE="sync_metadata.json";let Cm=null;class bU{autoSyncTimer=null;AUTO_SYNC_DEBOUNCE_MS=1e4;syncInProgress=!1;currentSyncOperation=null;syncProgress=0;syncTotal=0;isSyncInProgress(){return this.syncInProgress}getSyncStatus(){return{inProgress:this.syncInProgress,operation:this.currentSyncOperation,progress:this.syncProgress,total:this.syncTotal}}updateSyncProgress(e,r,n){this.currentSyncOperation=e,this.syncProgress=r,this.syncTotal=n,console.log(` Sync progress: ${e} (${r}/${n})`),window.dispatchEvent(new CustomEvent("sync-progress",{detail:{operation:e,progress:r,total:n}}))}async isAuthenticated(){try{const e=localStorage.getItem("google_access_token");return e?(await fetch("https://www.googleapis.com/drive/v3/about?fields=user",{headers:{Authorization:`Bearer ${e}`}})).ok:!1}catch(e){return console.error("Error checking authentication:",e),!1}}async getAppFolder(){if(Cm)return Cm;const e=await ms(),r=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${Cp}' and mimeType='application/vnd.google-apps.folder' and trashed=false&fields=files(id,name,modifiedTime)&orderBy=modifiedTime desc`,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error("Failed to search for app folder");const n=await r.json();if(n.files&&n.files.length>0){const i=n.files[0];return n.files.length>1?(console.warn(` Found ${n.files.length} folders named "${Cp}". Using the most recent one (ID: ${i.id}). Consider deleting duplicate folders in Google Drive.`),console.warn(" Duplicate folder IDs:",n.files.map(l=>l.id).join(", "))):console.log(` Using existing Drive folder: ${Cp} (ID: ${i.id})`),Cm=i.id,i.id}console.log(` Creating new Drive folder: ${Cp} (trashed folders are ignored)`);const a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({name:Cp,mimeType:"application/vnd.google-apps.folder"})});if(!a.ok)throw new Error("Failed to create app folder");const s=await a.json();return Cm=s.id,s.id}async uploadFile(e,r){const n=await ms(),a=await this.getAppFolder(),s=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${e}' and '${a}' in parents and trashed=false`,{headers:{Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error(`Failed to search for file: ${e}`);const i=await s.json();if(i.files&&i.files.length>0){const l=i.files[0].id;if(console.log(` Updating existing file: ${e}`),!(await fetch(`https://www.googleapis.com/upload/drive/v3/files/${l}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:r})).ok)throw new Error(`Failed to update file: ${e}`)}else{console.log(` Creating new file: ${e} (trashed files are ignored)`);const l={name:e,parents:[a]},c=new FormData;if(c.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),c.append("file",new Blob([r],{type:"application/json"})),!(await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${n}`},body:c})).ok)throw new Error(`Failed to create file: ${e}`)}}async downloadFile(e){try{const r=await ms(),n=await this.getAppFolder(),a=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${e}' and '${n}' in parents and trashed=false`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`Failed to search for file: ${e}`);const s=await a.json();if(!s.files||s.files.length===0)return console.log(` File not found in Drive (may be trashed): ${e}`),null;const i=s.files[0].id;console.log(` Downloading file from Drive: ${e}`);const l=await fetch(`https://www.googleapis.com/drive/v3/files/${i}?alt=media`,{headers:{Authorization:`Bearer ${r}`}});if(!l.ok)throw new Error(`Failed to download file: ${e}`);return await l.text()}catch(r){return console.error(`Error downloading file ${e}:`,r),null}}async syncPlans(){try{const e=await Pg(),r=e.length>0?Math.max(...e.map(i=>i.timestamp)):0,n=await this.downloadFile(wv);if(!n)return e.length>0?(await this.uploadPlans(e),await this.updateSyncMetadata("plans",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const a=JSON.parse(n),s=a.length>0?Math.max(...a.map(i=>i.timestamp)):0;return s>r?(await this.mergePlans(a),await this.updateSyncMetadata("plans",a.length),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:a.length}):r>s?(await this.uploadPlans(e),await this.updateSyncMetadata("plans",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):{success:!0,action:"no-change",timestamp:Date.now(),itemCount:e.length}}catch(e){return console.error("Error syncing plans:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e instanceof Error?e.message:"Unknown error"}}}async uploadPlans(e){const r=JSON.stringify(e,null,2);await this.uploadFile(wv,r)}async downloadPlans(){const e=await this.downloadFile(wv);return e?JSON.parse(e):[]}async mergePlans(e){const r=await Pg(),n=new Map;r.forEach(s=>{const i=s.query.trim().toLowerCase();n.set(i,s)}),e.forEach(s=>{const i=s.query.trim().toLowerCase(),l=n.get(i);(!l||s.timestamp>l.timestamp)&&n.set(i,s)});const a=Array.from(n.values()).sort((s,i)=>i.timestamp-s.timestamp).slice(0,50);await sU();for(const s of a)await FP(s.query,s.plan,s.systemPrompt,s.userPrompt)}async syncPlaylists(){try{await ni.init();const e=await ni.exportAllPlaylists(),r=e.length>0?Math.max(...e.map(i=>i.updatedAt)):0,n=await this.downloadFile(Sv);if(!n)return e.length>0?(await this.uploadPlaylists(e),await this.updateSyncMetadata("playlists",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const a=JSON.parse(n),s=a.length>0?Math.max(...a.map(i=>i.updatedAt)):0;if(s>r){const i=await ni.importAndMergePlaylists(a);return await this.updateSyncMetadata("playlists",i),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:i}}else return r>s?(await this.uploadPlaylists(e),await this.updateSyncMetadata("playlists",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):{success:!0,action:"no-change",timestamp:Date.now(),itemCount:e.length}}catch(e){return console.error("Error syncing playlists:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e instanceof Error?e.message:"Unknown error"}}}async uploadPlaylists(e){const r=JSON.stringify(e,null,2);await this.uploadFile(Sv,r)}async downloadPlaylists(){const e=await this.downloadFile(Sv);return e?JSON.parse(e):[]}async syncSnippets(){try{const e=await Go.getItem("swag-snippets")||[],r=await this.downloadSnippets();if(e.length===0&&r.length===0)return{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const n=e.length>0?Math.max(...e.map(s=>s.updateDate||s.timestamp)):0,a=r.length>0?Math.max(...r.map(s=>s.updateDate||s.timestamp)):0;return e.length===0?(await Go.setItem("swag-snippets",r),await this.updateSyncMetadata("snippets",r.length),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:r.length}):r.length===0?(await this.uploadSnippets(e),await this.updateSyncMetadata("snippets",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):n>a?(await this.uploadSnippets(e),await this.updateSyncMetadata("snippets",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):a>n?(await Go.setItem("swag-snippets",r),await this.updateSyncMetadata("snippets",r.length),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:r.length}):(await this.updateSyncMetadata("snippets",e.length),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:e.length})}catch(e){return console.error("Error syncing snippets:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e instanceof Error?e.message:"Unknown error"}}}async syncEmbeddings(){try{const e=await Is.getAllChunks(),r=await this.downloadEmbeddings();if(e.length===0&&r.length===0)return{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const n=e.length>0?Math.max(...e.map(s=>new Date(s.created_at).getTime())):0,a=r.length>0?Math.max(...r.map(s=>new Date(s.created_at).getTime())):0;return e.length===0?(await Is.saveChunks(r),await this.updateSyncMetadata("embeddings",r.length),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:r.length}):r.length===0?(await this.uploadEmbeddings(e),await this.updateSyncMetadata("embeddings",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):n>a?(await this.uploadEmbeddings(e),await this.updateSyncMetadata("embeddings",e.length),{success:!0,action:"uploaded",timestamp:Date.now(),itemCount:e.length}):a>n?(await Is.saveChunks(r),await this.updateSyncMetadata("embeddings",r.length),{success:!0,action:"downloaded",timestamp:Date.now(),itemCount:r.length}):(await this.updateSyncMetadata("embeddings",e.length),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:e.length})}catch(e){return console.error("Error syncing embeddings:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e instanceof Error?e.message:"Unknown error"}}}async uploadSnippets(e){const r=JSON.stringify(e,null,2);await this.uploadFile(KE,r)}async downloadSnippets(){const e=await this.downloadFile(KE);return e?JSON.parse(e):[]}async uploadEmbeddings(e){const r=JSON.stringify(e,null,2);await this.uploadFile(XE,r)}async downloadEmbeddings(){const e=await this.downloadFile(XE);return e?JSON.parse(e):[]}async syncChatHistory(){try{const e=await _i.getAllChats(),r=await this.downloadFile(kv),n=r?JSON.parse(r):[],a=e.length>0?Math.max(...e.map(c=>c.timestamp)):0,s=n.length>0?Math.max(...n.map(c=>c.timestamp)):0;let i="no-change",l=e.length;if(e.length===0&&n.length>0){console.log(` Downloading ${n.length} chat(s) from Google Drive...`);for(const c of n)await _i.saveChat(c.id,c.messages,c.title,{systemPrompt:c.systemPrompt,planningQuery:c.planningQuery,generatedSystemPrompt:c.generatedSystemPrompt,generatedUserQuery:c.generatedUserQuery,selectedSnippetIds:c.selectedSnippetIds,todosState:c.todosState});i="downloaded",l=n.length}else if(n.length===0&&e.length>0)console.log(` Uploading ${e.length} chat(s) to Google Drive...`),await this.uploadChatHistory(e),i="uploaded";else if(a>s)console.log(` Uploading ${e.length} chat(s) (local newer)...`),await this.uploadChatHistory(e),i="uploaded";else if(s>a){console.log(` Downloading ${n.length} chat(s) (remote newer)...`);const c=await _i.getAllChats();for(const d of c)await _i.deleteChat(d.id);for(const d of n)await _i.saveChat(d.id,d.messages,d.title,{systemPrompt:d.systemPrompt,planningQuery:d.planningQuery,generatedSystemPrompt:d.generatedSystemPrompt,generatedUserQuery:d.generatedUserQuery,selectedSnippetIds:d.selectedSnippetIds,todosState:d.todosState});i="downloaded",l=n.length}return i!=="no-change"&&await this.updateSyncMetadata("chatHistory",l),{success:!0,action:i,timestamp:Date.now(),itemCount:l}}catch(e){return console.error("Failed to sync chat history:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e.message}}}async uploadChatHistory(e){const r=JSON.stringify(e,null,2);await this.uploadFile(kv,r)}async downloadChatHistory(){const e=await this.downloadFile(kv);return e?JSON.parse(e):[]}async syncQuizProgress(){try{await yu.init();const e=await yu.getQuizStatistics(),r=await this.downloadFile(Tv),n=r?JSON.parse(r):[],a=e.length>0?Math.max(...e.map(c=>new Date(c.completedAt).getTime())):0,s=n.length>0?Math.max(...n.map(c=>new Date(c.completedAt).getTime())):0;let i="no-change",l=e.length;if(e.length===0&&n.length>0){console.log(` Downloading ${n.length} quiz statistic(s) from Google Drive...`);for(const c of n)await yu.saveQuizStatistic({quizTitle:c.quizTitle,snippetIds:c.snippetIds,score:c.score,totalQuestions:c.totalQuestions,timeTaken:c.timeTaken,completedAt:c.completedAt,answers:c.answers,enrichment:c.enrichment,completed:c.completed,quizData:c.quizData});i="downloaded",l=n.length}else if(n.length===0&&e.length>0)console.log(` Uploading ${e.length} quiz statistic(s) to Google Drive...`),await this.uploadQuizProgress(e),i="uploaded";else if(a>s)console.log(` Uploading ${e.length} quiz statistic(s) (local newer)...`),await this.uploadQuizProgress(e),i="uploaded";else if(s>a){console.log(` Downloading ${n.length} quiz statistic(s) (remote newer)...`),await yu.clearAllStatistics();for(const c of n)await yu.saveQuizStatistic({quizTitle:c.quizTitle,snippetIds:c.snippetIds,score:c.score,totalQuestions:c.totalQuestions,timeTaken:c.timeTaken,completedAt:c.completedAt,answers:c.answers,enrichment:c.enrichment,completed:c.completed,quizData:c.quizData});i="downloaded",l=n.length}return i!=="no-change"&&await this.updateSyncMetadata("quizProgress",l),{success:!0,action:i,timestamp:Date.now(),itemCount:l}}catch(e){return console.error("Failed to sync quiz progress:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e.message}}}async uploadQuizProgress(e){const r=JSON.stringify(e,null,2);await this.uploadFile(Tv,r)}async downloadQuizProgress(){const e=await this.downloadFile(Tv);return e?JSON.parse(e):[]}async syncSettings(){try{const e=["auto_sync_enabled","proxy_settings","rag_config","playbackRate","volume","repeatMode","shuffleMode","videoQuality","user_location","has_completed_welcome_wizard"],r={};e.forEach(g=>{const m=localStorage.getItem(g);m!==null&&(r[g]=m)});const n=Object.keys(r).length>0,a=Date.now(),s=await this.downloadFile(Cv),i=s?JSON.parse(s):null,l=i?.settings||null,c=i?.timestamp||0;let d="no-change",p=n?Object.keys(r).length:0;return!n&&l?(console.log(" Downloading settings from Google Drive..."),Object.keys(l).forEach(g=>{localStorage.setItem(g,l[g])}),d="downloaded",p=Object.keys(l).length):n&&!l?(console.log(` Uploading ${Object.keys(r).length} setting(s) to Google Drive...`),await this.uploadSettings(r),d="uploaded"):n&&l&&a>c?(console.log(` Uploading ${Object.keys(r).length} setting(s) (local newer)...`),await this.uploadSettings(r),d="uploaded"):l&&c>a&&(console.log(` Downloading ${Object.keys(l).length} setting(s) (remote newer)...`),Object.keys(l).forEach(g=>{localStorage.setItem(g,l[g])}),d="downloaded",p=Object.keys(l).length),d!=="no-change"&&await this.updateSyncMetadata("settings",p),{success:!0,action:d,timestamp:Date.now(),itemCount:p}}catch(e){return console.error("Failed to sync settings:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e.message}}}async uploadSettings(e){const r={settings:e,timestamp:Date.now()},n=JSON.stringify(r,null,2);await this.uploadFile(Cv,n)}async downloadSettings(){const e=await this.downloadFile(Cv);return e&&JSON.parse(e).settings||null}async syncImages(){try{const e=await po.getAllImages(),r=await this.getOrCreateImagesFolder(),n=await this.listImagesInDrive(r),a=new Set(n.map(p=>p.name.replace(/\.(png|jpg|jpeg|gif|webp)$/i,"")));let s=0,i=0;for(const p of e)a.has(p.id)||(console.log(` Uploading image: ${p.id}`),await this.uploadImageFile(r,p),s++);const l=new Set(e.map(p=>p.id));for(const p of n){const g=p.name.replace(/\.(png|jpg|jpeg|gif|webp)$/i,"");l.has(g)||(console.log(` Downloading image: ${g}`),await this.downloadImageFile(p.id,g,p.name),i++)}let c="no-change",d=e.length;return s>0&&i===0?c="uploaded":i>0&&s===0?(c="downloaded",d=e.length+i):(s>0||i>0)&&(c="uploaded"),c!=="no-change"&&await this.updateSyncMetadata("images",d),{success:!0,action:c,timestamp:Date.now(),itemCount:d}}catch(e){return console.error("Failed to sync images:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e.message}}}async garbageCollectImages(){try{console.log(" Starting image garbage collection...");const e=await Go.getItem("swag-snippets"),n=(e&&typeof e=="string"?JSON.parse(e):[]).map(p=>p.content),a=await po.garbageCollect(n);a>0&&console.log(` Garbage collected ${a} orphaned images from IndexedDB`);const s=await po.getAllImages(),i=new Set(s.map(p=>p.id)),l=await this.getOrCreateImagesFolder(),c=await this.listImagesInDrive(l);let d=0;for(const p of c){const g=p.name.replace(/\.(png|jpg|jpeg|gif|webp)$/i,"");i.has(g)||(console.log(` Deleting orphaned image from Drive: ${g}`),await this.deleteImageFile(p.id),d++)}return d>0&&console.log(` Garbage collected ${d} orphaned images from Google Drive`),{deletedLocal:a,deletedDrive:d}}catch(e){return console.error("Failed to garbage collect images:",e),{deletedLocal:0,deletedDrive:0}}}async getOrCreateImagesFolder(){const e=await this.getAppFolder(),r=localStorage.getItem("google_access_token");if(!r)throw new Error("Not authenticated");const n=`name='Images' and '${e}' in parents and mimeType='application/vnd.google-apps.folder' and trashed=false`,a=await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(n)}&fields=files(id,name)`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`Failed to search for Images folder: ${a.statusText}`);const s=await a.json();if(s.files&&s.files.length>0)return s.files[0].id;const i=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({name:"Images",mimeType:"application/vnd.google-apps.folder",parents:[e]})});if(!i.ok)throw new Error(`Failed to create Images folder: ${i.statusText}`);const l=await i.json();return console.log(" Created Images folder in Google Drive"),l.id}async listImagesInDrive(e){const r=localStorage.getItem("google_access_token");if(!r)throw new Error("Not authenticated");const n=`'${e}' in parents and trashed=false and (mimeType contains 'image/')`,a=await fetch(`https://www.googleapis.com/drive/v3/files?q=${encodeURIComponent(n)}&fields=files(id,name)`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`Failed to list images: ${a.statusText}`);return(await a.json()).files||[]}async uploadImageFile(e,r){const n=localStorage.getItem("google_access_token");if(!n)throw new Error("Not authenticated");const a=r.data.split(",")[1],s=r.mimeType||"image/png",i=s.split("/")[1]||"png",l=`${r.id}.${i}`,c={name:l,parents:[e],mimeType:s},d="-------314159265358979323846",p=`\r
--`+d+`\r
`,g=`\r
--`+d+"--",m=p+`Content-Type: application/json; charset=UTF-8\r
\r
`+JSON.stringify(c)+p+"Content-Type: "+s+`\r
Content-Transfer-Encoding: base64\r
\r
`+a+g,y=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":`multipart/related; boundary=${d}`},body:m});if(!y.ok)throw new Error(`Failed to upload image: ${y.statusText}`);console.log(` Uploaded image file: ${l}`)}async downloadImageFile(e,r,n){const a=localStorage.getItem("google_access_token");if(!a)throw new Error("Not authenticated");const s=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error(`Failed to download image: ${s.statusText}`);const i=await s.blob(),l=new FileReader,c=await new Promise((m,y)=>{l.onloadend=()=>m(l.result),l.onerror=y,l.readAsDataURL(i)});let d=0,p=0;try{const m=new Image,y=await new Promise((x,w)=>{m.onload=()=>x({width:m.width,height:m.height}),m.onerror=w,m.src=c});d=y.width,p=y.height}catch(m){console.warn("Could not determine image dimensions:",m)}const g={id:r,data:c,size:c.length,mimeType:i.type,width:d,height:p,createdAt:Date.now()};await this.saveImageDirectly(g),console.log(` Downloaded and saved image: ${n}`)}async deleteImageFile(e){const r=localStorage.getItem("google_access_token");if(!r)throw new Error("Not authenticated");const n=await fetch(`https://www.googleapis.com/drive/v3/files/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});if(!n.ok)throw new Error(`Failed to delete image: ${n.statusText}`);console.log(` Deleted image file from Drive: ${e}`)}async uploadImages(e){const r={images:e,timestamp:Date.now()},n=JSON.stringify(r,null,2);await this.uploadFile(yU,n)}async downloadImagesToIndexedDB(e){await po.clearAll();for(const r of e)try{await this.saveImageDirectly(r)}catch(n){console.warn(` Failed to restore image ${r.id}:`,n)}}async saveImageDirectly(e){return new Promise((r,n)=>{const a=indexedDB.open("swag-images",1);a.onsuccess=()=>{const s=a.result,i=s.transaction(["images"],"readwrite"),c=i.objectStore("images").put(e);c.onsuccess=()=>r(),c.onerror=()=>n(c.error),i.oncomplete=()=>s.close()},a.onerror=()=>n(a.error)})}async syncAll(){if(this.syncInProgress)throw console.log(" Sync already in progress, skipping duplicate request"),new Error("Sync operation already in progress");try{this.syncInProgress=!0,this.updateSyncProgress("Starting sync...",0,8),window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:" Syncing data to Google Drive...",type:"info",persistent:!0,id:"cloud-sync"}})),this.updateSyncProgress("Syncing images",1,8);const e=await this.syncImages();this.updateSyncProgress("Syncing data",2,8);const[r,n,a,s,i,l,c]=await Promise.all([this.syncPlans(),this.syncPlaylists(),this.syncSnippets(),this.syncEmbeddings(),this.syncChatHistory(),this.syncQuizProgress(),this.syncSettings()]);return this.updateSyncProgress("Cleaning up orphaned images",7,8),await this.garbageCollectImages(),this.updateSyncProgress("Sync complete",8,8),console.log(" Sync completed successfully:",{plans:r.action,playlists:n.action,snippets:a.action,embeddings:s.action,chatHistory:i.action,quizProgress:l.action,settings:c.action,images:e.action}),window.dispatchEvent(new CustomEvent("remove-toast",{detail:{id:"cloud-sync"}})),window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:" Sync complete!",type:"success",duration:3e3}})),{plans:r,playlists:n,snippets:a,embeddings:s,chatHistory:i,quizProgress:l,settings:c,images:e}}catch(e){throw window.dispatchEvent(new CustomEvent("remove-toast",{detail:{id:"cloud-sync"}})),window.dispatchEvent(new CustomEvent("show-toast",{detail:{message:` Sync failed: ${e instanceof Error?e.message:"Unknown error"}`,type:"error",duration:7e3}})),e}finally{this.syncInProgress=!1,this.currentSyncOperation=null,this.syncProgress=0,this.syncTotal=0,window.dispatchEvent(new CustomEvent("sync-complete"))}}async getLastSyncTime(){return(await this.getSyncMetadata()).lastSyncTime}async getSyncMetadata(){const e=await this.downloadFile(JE);if(!e)return{lastSyncTime:0,lastPlansSync:0,lastPlaylistsSync:0,lastSnippetsSync:0,lastEmbeddingsSync:0,lastChatHistorySync:0,lastQuizProgressSync:0,lastSettingsSync:0,lastImagesSync:0,plansCount:0,playlistsCount:0,snippetsCount:0,embeddingsCount:0,chatHistoryCount:0,quizProgressCount:0,settingsCount:0,imagesCount:0};const r=JSON.parse(e);return{lastSyncTime:r.lastSyncTime||0,lastPlansSync:r.lastPlansSync||0,lastPlaylistsSync:r.lastPlaylistsSync||0,lastSnippetsSync:r.lastSnippetsSync||0,lastEmbeddingsSync:r.lastEmbeddingsSync||0,lastChatHistorySync:r.lastChatHistorySync||0,lastQuizProgressSync:r.lastQuizProgressSync||0,lastSettingsSync:r.lastSettingsSync||0,lastImagesSync:r.lastImagesSync||0,plansCount:r.plansCount||0,playlistsCount:r.playlistsCount||0,snippetsCount:r.snippetsCount||0,embeddingsCount:r.embeddingsCount||0,chatHistoryCount:r.chatHistoryCount||0,quizProgressCount:r.quizProgressCount||0,settingsCount:r.settingsCount||0,imagesCount:r.imagesCount||0}}async updateSyncMetadata(e,r){const n=await this.getSyncMetadata();n.lastSyncTime=Date.now(),e==="plans"?(n.lastPlansSync=Date.now(),n.plansCount=r):e==="playlists"?(n.lastPlaylistsSync=Date.now(),n.playlistsCount=r):e==="snippets"?(n.lastSnippetsSync=Date.now(),n.snippetsCount=r):e==="embeddings"?(n.lastEmbeddingsSync=Date.now(),n.embeddingsCount=r):e==="chatHistory"?(n.lastChatHistorySync=Date.now(),n.chatHistoryCount=r):e==="quizProgress"?(n.lastQuizProgressSync=Date.now(),n.quizProgressCount=r):e==="settings"?(n.lastSettingsSync=Date.now(),n.settingsCount=r):e==="images"&&(n.lastImagesSync=Date.now(),n.imagesCount=r);const a=JSON.stringify(n,null,2);await this.uploadFile(JE,a)}triggerAutoSync(){localStorage.getItem("auto_sync_enabled")==="true"&&(this.autoSyncTimer&&clearTimeout(this.autoSyncTimer),this.autoSyncTimer=setTimeout(async()=>{try{if(console.log(" Auto-sync triggered (debounced 10s)"),!await this.isAuthenticated()){console.log(" Auto-sync skipped: Not authenticated");return}await this.syncAll(),console.log(" Auto-sync completed")}catch(r){console.error(" Auto-sync failed:",r)}},this.AUTO_SYNC_DEBOUNCE_MS))}triggerSettingsSync(){this.triggerAutoSync()}async triggerImmediateSync(){try{if(console.log(" Immediate sync triggered"),!await this.isAuthenticated()){console.log(" Immediate sync skipped: Not authenticated");return}await this.syncAll(),console.log(" Immediate sync completed")}catch(e){throw console.error(" Immediate sync failed:",e),e}}}const ls=new bU;class xU{db=null;DB_NAME="youtube-playlist-db";DB_VERSION=1;async init(){if(!this.db)try{this.db=await Dy(this.DB_NAME,this.DB_VERSION,{upgrade(e){if(e.objectStoreNames.contains("currentPlaylist")||e.createObjectStore("currentPlaylist",{keyPath:"id"}),!e.objectStoreNames.contains("savedPlaylists")){const r=e.createObjectStore("savedPlaylists",{keyPath:"id",autoIncrement:!0});r.createIndex("by-name","name",{unique:!1}),r.createIndex("by-date","createdAt",{unique:!1})}}}),await this.migrateFromLocalStorage()}catch(e){throw console.error("Failed to initialize playlist database:",e),e}}async migrateFromLocalStorage(){try{const e=localStorage.getItem("youtube_playlist"),r=localStorage.getItem("youtube_current_track");if(e){const n=JSON.parse(e),a=r?parseInt(r,10):null,s=await this.db.get("currentPlaylist","current");(!s||s.tracks.length===0)&&(await this.saveCurrentPlaylist(n,a),console.log(" Migrated playlist from localStorage to IndexedDB"))}}catch(e){console.error("Failed to migrate from localStorage:",e)}}async saveCurrentPlaylist(e,r){await this.init(),await this.db.put("currentPlaylist",{id:"current",tracks:e,currentIndex:r,isPlaying:!1,updatedAt:Date.now()})}async loadCurrentPlaylist(){await this.init();const e=await this.db.get("currentPlaylist","current");return e?{tracks:e.tracks||[],currentIndex:e.currentIndex}:{tracks:[],currentIndex:null}}async clearCurrentPlaylist(){await this.init(),await this.db.delete("currentPlaylist","current")}async savePlaylist(e,r){if(await this.init(),!e||e.trim().length===0)throw new Error("Playlist name cannot be empty");const n=await this.db.add("savedPlaylists",{name:e.trim(),tracks:r,createdAt:Date.now(),updatedAt:Date.now()});return Ha.isEnabled()&&Ha.queueSync("playlists","high"),ls.triggerAutoSync(),n}async updatePlaylist(e,r,n){await this.init();const a=await this.db.get("savedPlaylists",e);if(!a)throw new Error("Playlist not found");await this.db.put("savedPlaylists",{...a,name:r.trim(),tracks:n,updatedAt:Date.now()}),Ha.isEnabled()&&Ha.queueSync("playlists","high"),ls.triggerAutoSync()}async loadPlaylist(e){return await this.init(),(await this.db.get("savedPlaylists",e))?.tracks||[]}async getPlaylist(e){return await this.init(),await this.db.get("savedPlaylists",e)}async listPlaylists(){return await this.init(),(await this.db.getAll("savedPlaylists")).map(r=>({id:r.id,name:r.name,trackCount:r.tracks.length,createdAt:r.createdAt,updatedAt:r.updatedAt})).sort((r,n)=>n.updatedAt-r.updatedAt)}async deletePlaylist(e){await this.init(),await this.db.delete("savedPlaylists",e),Ha.isEnabled()&&Ha.queueSync("playlists","high"),ls.triggerAutoSync()}async playlistExists(e){return await this.init(),(await this.db.getAllFromIndex("savedPlaylists","by-name",e.trim())).length>0}async searchPlaylists(e){await this.init();const r=await this.db.getAll("savedPlaylists"),n=e.toLowerCase();return r.filter(a=>a.name.toLowerCase().includes(n)).map(a=>({id:a.id,name:a.name,trackCount:a.tracks.length,createdAt:a.createdAt,updatedAt:a.updatedAt})).sort((a,s)=>s.updatedAt-a.updatedAt)}async exportPlaylist(e){await this.init();const r=await this.db.get("savedPlaylists",e);if(!r)throw new Error("Playlist not found");return JSON.stringify({name:r.name,tracks:r.tracks,exportedAt:Date.now(),version:1},null,2)}async importPlaylist(e){await this.init();try{const r=JSON.parse(e);if(!r.name||!Array.isArray(r.tracks))throw new Error("Invalid playlist format");const n=r.tracks.filter(a=>a.videoId&&a.url&&a.title);if(n.length===0)throw new Error("No valid tracks found in playlist");return await this.savePlaylist(r.name,n)}catch(r){throw r instanceof SyntaxError?new Error("Invalid JSON format"):r}}async getStats(){await this.init();const e=await this.db.get("currentPlaylist","current"),r=await this.db.getAll("savedPlaylists"),n=r.reduce((a,s)=>a+s.tracks.length,0);return{currentPlaylistSize:e?.tracks.length||0,savedPlaylistCount:r.length,totalSavedTracks:n,databaseSize:await this.estimateSize()}}async estimateSize(){await this.init();try{if("estimate"in navigator.storage)return`~${(((await navigator.storage.estimate()).usage||0)/(1024*1024)).toFixed(2)} MB`}catch{}return"Unknown"}async exportAllPlaylists(){return await this.init(),await this.db.getAll("savedPlaylists")}async importAndMergePlaylists(e){await this.init();const r=await this.db.getAll("savedPlaylists"),n=new Map(r.map(s=>[s.name.toLowerCase(),s]));let a=0;for(const s of e){const i=s.name.toLowerCase(),l=n.get(i);l?s.updatedAt>l.updatedAt&&(await this.db.put("savedPlaylists",{id:l.id,name:s.name,tracks:s.tracks,createdAt:l.createdAt,updatedAt:s.updatedAt}),a++):(await this.db.add("savedPlaylists",{id:0,name:s.name,tracks:s.tracks,createdAt:s.createdAt,updatedAt:s.updatedAt}),a++)}return a}async getPlaylistsModifiedSince(e){return await this.init(),(await this.db.getAll("savedPlaylists")).filter(n=>n.updatedAt>e)}async getLastModified(){await this.init();const e=await this.db.getAll("savedPlaylists");return e.length===0?0:Math.max(...e.map(r=>r.updatedAt))}close(){this.db&&(this.db.close(),this.db=null)}}const ni=new xU,Exe=Object.freeze(Object.defineProperty({__proto__:null,playlistDB:ni},Symbol.toStringTag,{value:"Module"})),zP=N.createContext(void 0),Ch=()=>{const t=N.useContext(zP);if(!t)throw new Error("usePlaylist must be used within PlaylistProvider");return t},vU=({children:t})=>{const[e,r]=N.useState([]),[n,a]=N.useState(null),[s,i]=N.useState(!1),[l,c]=N.useState([]),[d,p]=N.useState(!1),[g,m]=N.useState(!1),[y,x]=N.useState([]),[w,T]=N.useState("none"),[k,_]=N.useState(1),[P,F]=N.useState(1),[D,B]=N.useState("auto");N.useEffect(()=>{try{const se=localStorage.getItem("playbackRate");se&&_(parseFloat(se));const be=localStorage.getItem("volume");be&&F(parseFloat(be));const xe=localStorage.getItem("repeatMode");xe&&(xe==="none"||xe==="all"||xe==="one")&&T(xe);const me=localStorage.getItem("shuffleMode");me&&m(me==="true");const de=localStorage.getItem("videoQuality");de&&B(de)}catch(se){console.error("Failed to load preferences:",se)}},[]),N.useEffect(()=>{(async()=>{try{const{tracks:be,currentIndex:xe}=await ni.loadCurrentPlaylist();r(be),a(xe),p(!0)}catch(be){console.error("Failed to load playlist:",be),p(!0)}})()},[]),N.useEffect(()=>{O()},[]),N.useEffect(()=>{if(!d)return;const se=async()=>{try{await ni.saveCurrentPlaylist(e,n)}catch(xe){console.error("Failed to save playlist:",xe)}},be=setTimeout(()=>{se()},500);return()=>clearTimeout(be)},[e,n,d]);const M=N.useCallback(se=>{const be={...se,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,addedAt:Date.now()};r(xe=>[...xe,be])},[]),$=N.useCallback(se=>{r(be=>{const xe=[],me=new Set(be.map(Ie=>Ie.videoId)),de=new Set;return se.forEach((Ie,ze)=>{me.has(Ie.videoId)||de.has(Ie.videoId)||(de.add(Ie.videoId),xe.push({...Ie,id:`${Date.now()}-${ze}-${Math.random().toString(36).substr(2,9)}`,addedAt:Date.now()}))}),[...xe,...be].slice(0,500)})},[]),Z=N.useCallback(se=>{r(be=>{const xe=[],me=[],de=[],he=new Set;se.forEach((nt,mt)=>{if(he.has(nt.videoId))return;he.add(nt.videoId);const ht=be.findIndex(er=>er.videoId===nt.videoId);ht!==-1?xe.push({...be[ht],addedAt:Date.now()}):me.push({...nt,id:`${Date.now()}-${mt}-${Math.random().toString(36).substr(2,9)}`,addedAt:Date.now()})}),be.forEach(nt=>{he.has(nt.videoId)||de.push(nt)});const ze=[...xe,...me,...de].slice(0,500);if(n!==null&&be[n]){const nt=be[n].videoId,mt=ze.findIndex(ht=>ht.videoId===nt);mt!==-1?a(mt):(a(null),i(!1))}return ze})},[n]),z=N.useCallback(se=>{r(be=>{const xe=be.findIndex(me=>me.id===se);return xe===-1?be:(n!==null&&(xe===n?(i(!1),a(null)):xe<n&&a(n-1)),be.filter(me=>me.id!==se))})},[n]),ee=N.useCallback(()=>{r([]),a(null),i(!1)},[]),te=N.useCallback(se=>{se>=0&&se<e.length&&(a(se),i(!0))},[e.length]),X=N.useCallback(()=>{const se=e.map((be,xe)=>xe);n!==null&&se.splice(se.indexOf(n),1);for(let be=se.length-1;be>0;be--){const xe=Math.floor(Math.random()*(be+1));[se[be],se[xe]]=[se[xe],se[be]]}return n!==null&&se.unshift(n),se},[e,n]);N.useEffect(()=>{g&&x(X())},[g,e,X]);const Q=N.useCallback(()=>{if(e.length===0)return;if(n===null){a(0),i(!0);return}if(w==="one"){i(!0);return}const se=g?y:e.map((xe,me)=>me),be=se.indexOf(n);be<se.length-1?(a(se[be+1]),i(!0)):w==="all"?(a(se[0]),i(!0)):i(!1)},[e,n,g,y,w]),W=N.useCallback(()=>{if(e.length===0)return;if(n===null){a(e.length-1),i(!0);return}const se=g?y:e.map((xe,me)=>me),be=se.indexOf(n);be>0?(a(se[be-1]),i(!0)):(a(se[se.length-1]),i(!0))},[e,n,g,y]),H=N.useCallback(()=>{e.length!==0&&(n===null?(a(0),i(!0)):i(se=>!se))},[e.length,n]),re=N.useCallback(()=>{e.length!==0&&(n===null&&a(0),i(!0))},[e.length,n]),ne=N.useCallback(()=>{i(!1)},[]),ve=N.useCallback(se=>{const be=e.findIndex(xe=>xe.videoId===se);return be!==-1?(a(be),i(!0),!0):!1},[e]),O=N.useCallback(async()=>{try{const se=await ni.listPlaylists();c(se)}catch(se){console.error("Failed to load saved playlists:",se)}},[]),I=N.useCallback(async se=>{try{await ni.savePlaylist(se,e),await O()}catch(be){throw console.error("Failed to save playlist:",be),be}},[e,O]),K=N.useCallback(async se=>{try{const be=await ni.loadPlaylist(se);r(be),a(null),i(!1)}catch(be){throw console.error("Failed to load playlist:",be),be}},[]),U=N.useCallback(async se=>{try{await ni.deletePlaylist(se),await O()}catch(be){throw console.error("Failed to delete playlist:",be),be}},[O]);N.useEffect(()=>{const se=()=>{console.log(" [PlaylistContext] Sync complete, refreshing playlists..."),O()};return window.addEventListener("sync-complete",se),()=>{window.removeEventListener("sync-complete",se)}},[O]);const ce=N.useCallback(()=>{const se=!g;m(se),localStorage.setItem("shuffleMode",String(se)),se&&x(X())},[g,X]),ye=N.useCallback(se=>{T(se),localStorage.setItem("repeatMode",se)},[]),Ae=N.useCallback(se=>{_(se),localStorage.setItem("playbackRate",String(se))},[]),fe=N.useCallback(se=>{F(se),localStorage.setItem("volume",String(se))},[]),Ne=N.useCallback(se=>{B(se),localStorage.setItem("videoQuality",se)},[]),Te=n!==null&&e[n]?e[n]:null;return u.jsx(zP.Provider,{value:{playlist:e,currentTrackIndex:n,isPlaying:s,addTrack:M,addTracks:$,addTracksToStart:Z,removeTrack:z,clearPlaylist:ee,playTrack:te,playTrackByVideoId:ve,nextTrack:Q,previousTrack:W,togglePlayPause:H,play:re,pause:ne,currentTrack:Te,savedPlaylists:l,savePlaylistAs:I,loadPlaylist:K,deletePlaylist:U,refreshSavedPlaylists:O,shuffleMode:g,toggleShuffle:ce,repeatMode:w,setRepeatMode:ye,playbackRate:k,setPlaybackRate:Ae,volume:P,setVolume:fe,videoQuality:D,setVideoQuality:Ne},children:t})},$P=N.createContext(void 0),UP=()=>{const t=N.useContext($P);if(!t)throw new Error("usePlayer must be used within PlayerProvider");return t},wU=({children:t})=>{const e=N.useRef(null),{isPlaying:r,currentTrack:n,play:a,pause:s}=Ch(),[i,l]=N.useState(!1),[c,d]=N.useState(0),[p,g]=N.useState(0),m=N.useCallback(P=>{console.log("[PlayerContext] Registering player:",P),e.current=P},[]),y=N.useCallback(()=>{console.log("[PlayerContext] Unregistering player"),e.current=null},[]),x=N.useCallback(()=>{e.current?(console.log("[PlayerContext] Playing video via ref"),a()):(console.warn("[PlayerContext] Cannot play - no player registered"),a())},[a]),w=N.useCallback(()=>{e.current?(console.log("[PlayerContext] Pausing video via ref"),s()):(console.warn("[PlayerContext] Cannot pause - no player registered"),s())},[s]),T=N.useCallback(P=>{e.current&&e.current.seekTo?(console.log("[PlayerContext] Seeking to:",P),e.current.seekTo(P,"seconds")):console.warn("[PlayerContext] Cannot seek - no player registered")},[]),k=N.useCallback(()=>e.current&&e.current.getCurrentTime?e.current.getCurrentTime():0,[]),_=N.useCallback(()=>e.current&&e.current.getDuration?e.current.getDuration():0,[]);return N.useEffect(()=>{e.current&&console.log("[PlayerContext] Syncing player state - isPlaying:",r,"currentTrack:",n?.title)},[r,n]),u.jsx($P.Provider,{value:{playerRef:e,registerPlayer:m,unregisterPlayer:y,playVideo:x,pauseVideo:w,seekTo:T,getCurrentTime:k,getDuration:_,isLoading:i,setIsLoading:l,currentTime:c,duration:p,setCurrentTime:d,setDuration:g},children:t})},qP=N.createContext(void 0),jl=()=>{const t=N.useContext(qP);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},SU=({children:t})=>{const[e,r]=N.useState([]),n=N.useCallback(x=>{r(w=>w.filter(T=>T.id!==x))},[]),a=N.useCallback((x,w,T)=>{r(k=>k.map(_=>_.id===x?{..._,message:w,...T!==void 0&&{progress:T}}:_))},[]),s=N.useCallback(()=>{r([])},[]),i=N.useCallback((x,w="info",T=5e3)=>{const k=`toast-${Date.now()}-${Math.random()}`,_={id:k,message:x,type:w,duration:T};r(P=>[...P,_]),T>0&&setTimeout(()=>n(k),T)},[n]),l=N.useCallback((x,w="info",T)=>{const k=`toast-${Date.now()}-${Math.random()}`,_={id:k,message:x,type:w,duration:0,action:T};return r(P=>[...P,_]),k},[]),c=N.useCallback(x=>i(x,"error",7e3),[i]),d=N.useCallback(x=>i(x,"success",3e3),[i]),p=N.useCallback(x=>i(x,"warning",5e3),[i]),g=N.useCallback(x=>i(x,"info",4e3),[i]);N.useEffect(()=>{const x=T=>{const k=T,{message:_,type:P="info",duration:F=5e3,persistent:D=!1,id:B}=k.detail;D&&B?r(M=>{if(M.find(z=>z.id===B))return M;const Z={id:B,message:_,type:P,duration:0};return[...M,Z]}):i(_,P,F)},w=T=>{const k=T,{id:_}=k.detail;_&&n(_)};return window.addEventListener("show-toast",x),window.addEventListener("remove-toast",w),()=>{window.removeEventListener("show-toast",x),window.removeEventListener("remove-toast",w)}},[i,n]);const m=x=>`flex items-start gap-3 p-4 rounded-lg shadow-lg border backdrop-blur-sm transition-all duration-300 animate-slide-in ${{success:"bg-green-50/95 dark:bg-green-900/95 border-green-200 dark:border-green-700 text-green-800 dark:text-green-100",error:"bg-red-50/95 dark:bg-red-900/95 border-red-200 dark:border-red-700 text-red-800 dark:text-red-100",warning:"bg-yellow-50/95 dark:bg-yellow-900/95 border-yellow-200 dark:border-yellow-700 text-yellow-800 dark:text-yellow-100",info:"bg-blue-50/95 dark:bg-blue-900/95 border-blue-200 dark:border-blue-700 text-blue-800 dark:text-blue-100"}[x]}`,y=x=>({success:"",error:"",warning:"",info:""})[x];return u.jsxs(qP.Provider,{value:{showToast:i,showPersistentToast:l,removeToast:n,updateToast:a,showError:c,showSuccess:d,showWarning:p,showInfo:g,clearAllToasts:s},children:[t,u.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 max-w-md",children:e.map(x=>u.jsxs("div",{className:m(x.type),children:[u.jsx("span",{className:"text-xl font-bold",children:y(x.type)}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium",children:x.message}),x.progress!==void 0&&u.jsx("div",{className:"mt-2 w-full bg-current/20 rounded-full h-2 overflow-hidden",children:u.jsx("div",{className:"bg-current h-full transition-all duration-300 ease-out rounded-full",style:{width:`${Math.min(100,Math.max(0,x.progress))}%`}})})]}),x.action&&u.jsx("button",{onClick:x.action.onClick,className:"px-3 py-1 text-xs font-semibold rounded bg-current/10 hover:bg-current/20 transition-colors",children:x.action.label}),u.jsx("button",{onClick:()=>n(x.id),className:"text-current opacity-50 hover:opacity-100 transition-opacity",children:""})]},x.id))}),u.jsx("style",{children:`
        @keyframes slide-in {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in {
          animation: slide-in 0.3s ease-out;
        }
      `})]})};function ZE(t){const e=[],r=t.split(`
`);let n={};for(const a of r)if(a.startsWith("event:"))n.event=a.substring(6).trim();else if(a.startsWith("data:"))n.data=a.substring(5).trim();else if(a===""&&n.event&&n.data){try{const s=JSON.parse(n.data);e.push({event:n.event,data:s})}catch(s){console.error("Failed to parse SSE data:",n.data,s)}n={}}return e}async function kS(t,e,r,n){if(!t.body)throw new Error("Response body is null");const a=t.body.getReader(),s=new TextDecoder;let i="";try{for(;;){const{done:l,value:c}=await a.read();if(l){i.trim()&&ZE(i).forEach(g=>e(g.event,g.data)),r&&r();break}i+=s.decode(c,{stream:!0});const d=i.split(`

`);i=d.pop()||"";for(const p of d)p.trim()&&ZE(p+`

`).forEach(m=>e(m.event,m.data))}}catch(l){console.error("SSE stream error:",l),n&&n(l instanceof Error?l:new Error("Stream error"))}}async function TS(t,e,r,n,a,s=3,i=1e3,l){const d={"Content-Type":"application/json",Authorization:`Bearer ${r.trim().replace(/[\r\n]/g,"")}`,Accept:"text/event-stream"};l&&(d["X-Request-Id"]=l,console.log(" Using request ID for log grouping:",l)),a&&(d["X-YouTube-Token"]=a);const p=["google_access_token","gapi_access_token","google_drive_access_token"];let g=null,m="none";for(const k of p){const _=localStorage.getItem(k);if(_){g=_.trim().replace(/[\r\n]/g,""),m=k;break}}const y=localStorage.getItem("google_refresh_token");console.log(" Drive token check:",{hasDriveToken:!!g,hasRefreshToken:!!y,tokenLength:g?.length||0,source:m,availableKeys:p.filter(k=>!!localStorage.getItem(k))}),g?(d["X-Google-Access-Token"]=g,console.log(` Including Drive access token for Google Sheets operations (source: ${m})`)):(console.log(" No Drive access token available - snippet management will not work"),console.log("   Checked keys:",p)),y&&(d["X-Google-Refresh-Token"]=y.trim().replace(/[\r\n]/g,""),console.log(" Including Google refresh token for automatic token refresh"));let x=null;for(let k=0;k<s;k++)try{console.log(` SSE Request attempt ${k+1}/${s}:`,{url:t,method:"POST",hasToken:!!r,hasYoutubeToken:!!a,bodyKeys:e?Object.keys(e):[]});const _=await fetch(t,{method:"POST",headers:d,body:JSON.stringify(e),signal:n});if(console.log(" SSE Response received:",{status:_.status,statusText:_.statusText,ok:_.ok,headers:Object.fromEntries(_.headers.entries())}),!_.ok){if(_.status===429&&k<s-1){const P=_.headers.get("Retry-After");let F;if(P){const D=parseInt(P);if(!isNaN(D))F=D*1e3;else{const B=new Date(P);isNaN(B.getTime())?F=i*Math.pow(2,k):F=Math.max(0,B.getTime()-Date.now())}}else F=i*Math.pow(2,k);console.warn(` Rate limited (429), retrying in ${(F/1e3).toFixed(1)}s... (attempt ${k+1}/${s})`),await new Promise(D=>setTimeout(D,F));continue}throw new Error(`Request failed: ${_.status} ${_.statusText}`)}return _}catch(_){if(x=_,console.error(` SSE Request failed (attempt ${k+1}/${s}):`,{error:_ instanceof Error?_.message:String(_),errorName:_ instanceof Error?_.name:"Unknown",stack:_ instanceof Error?_.stack:void 0,url:t,attempt:k+1,maxRetries:s}),n?.aborted)throw console.log(" Request aborted by user"),new Error("Request aborted by user");if(k>=s-1){console.error(" Max retries reached, giving up");break}const P=i*Math.pow(2,k);console.warn(` Request failed, retrying in ${(P/1e3).toFixed(1)}s... (attempt ${k+1}/${s})`,_),await new Promise(F=>setTimeout(F,P))}const w=t.includes("localhost")||t.includes("127.0.0.1"),T=x?.message||"Unknown error";throw w&&(T.includes("fetch")||T.includes("ECONNREFUSED")||T.includes("NetworkError"))?new Error(" Dev server not running. Please start your dev server with `make dev` or `npm run dev`"):T.includes("fetch")||T.includes("NetworkError")?new Error(" Lambda API error: Cannot connect to server. Please check your internet connection or try again later."):x||new Error(`Request failed after ${s} attempts`)}class kU{db=null;version="1.0.0";defaultTTL=14400*1e3;maxStorageBytes=100*1024*1024;enabled=!0;initPromise=null;constructor(){this.initPromise=this.init()}async init(){try{if(localStorage.getItem("caching_disabled")==="true"){console.log(" Caching disabled by user preference"),this.enabled=!1;return}this.db=await Dy("ResearchAgentCache",1,{upgrade(r){r.objectStoreNames.contains("llm_responses")||r.createObjectStore("llm_responses",{keyPath:"messageHash"}).createIndex("timestamp","timestamp"),r.objectStoreNames.contains("search_results")||r.createObjectStore("search_results",{keyPath:"query"}).createIndex("timestamp","timestamp"),r.objectStoreNames.contains("tool_outputs")||r.createObjectStore("tool_outputs",{keyPath:"paramsHash"}).createIndex("timestamp","timestamp")}}),console.log(" Cache initialized successfully"),this.cleanup().catch(r=>console.error("Cleanup failed:",r)),setInterval(()=>{this.cleanup().catch(r=>console.error("Periodic cleanup failed:",r))},3600*1e3)}catch(e){console.error(" Failed to initialize IndexedDB cache:",e),this.enabled=!1}}async waitForInit(){this.initPromise&&await this.initPromise}async hashMessages(e){const r=JSON.stringify(e),a=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(s)).map(c=>c.toString(16).padStart(2,"0")).join("")}async hashObject(e){const r=JSON.stringify(e),a=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(s)).map(c=>c.toString(16).padStart(2,"0")).join("")}async getLLMResponse(e){if(await this.waitForInit(),!this.enabled||!this.db)return null;try{const r=await this.hashMessages(e),n=await this.db.get("llm_responses",r);return n?Date.now()-n.timestamp>n.ttl?(console.log(" Cache expired for LLM response"),await this.db.delete("llm_responses",r),null):n.version!==this.version?(console.log(" Cache version mismatch, invalidating"),await this.db.delete("llm_responses",r),null):(console.log(" Cache HIT for LLM response"),{...n.response,usage:n.usage,model:n.model,cached:!0}):(console.log(" Cache miss for LLM response"),null)}catch(r){return console.error("Error getting cached LLM response:",r),null}}async setLLMResponse(e,r,n,a){if(await this.waitForInit(),!(!this.enabled||!this.db))try{const s=await this.hashMessages(e);await this.db.put("llm_responses",{messageHash:s,messages:e.map(i=>({role:i.role,content:i.content?.substring(0,200)})),response:r,usage:n,model:a,timestamp:Date.now(),ttl:this.defaultTTL,version:this.version}),console.log(" Cached LLM response"),this.enforceStorageLimit().catch(i=>console.error("Storage limit enforcement failed:",i))}catch(s){console.error("Error caching LLM response:",s)}}async getSearchResults(e){if(await this.waitForInit(),!this.enabled||!this.db)return null;try{const r=await this.db.get("search_results",e);return r?Date.now()-r.timestamp>r.ttl?(console.log(" Cache expired for search results"),await this.db.delete("search_results",e),null):(console.log(" Cache HIT for search results"),r.results):(console.log(" Cache miss for search results"),null)}catch(r){return console.error("Error getting cached search results:",r),null}}async setSearchResults(e,r){if(await this.waitForInit(),!(!this.enabled||!this.db))try{await this.db.put("search_results",{query:e,results:r,timestamp:Date.now(),ttl:this.defaultTTL}),console.log(" Cached search results")}catch(n){console.error("Error caching search results:",n)}}async getToolOutput(e,r){if(await this.waitForInit(),!this.enabled||!this.db)return null;try{const n=await this.hashObject({tool:e,params:r}),a=await this.db.get("tool_outputs",n);return a?Date.now()-a.timestamp>a.ttl?(console.log(" Cache expired for tool output"),await this.db.delete("tool_outputs",n),null):(console.log(" Cache HIT for tool output"),a.output):(console.log(" Cache miss for tool output"),null)}catch(n){return console.error("Error getting cached tool output:",n),null}}async setToolOutput(e,r,n,a){if(await this.waitForInit(),!(!this.enabled||!this.db))try{const s=await this.hashObject({tool:e,params:r});await this.db.put("tool_outputs",{tool:e,paramsHash:s,output:n,timestamp:Date.now(),ttl:a||this.defaultTTL}),console.log(" Cached tool output")}catch(s){console.error("Error caching tool output:",s)}}async cleanup(){if(await this.waitForInit(),!!this.db)try{const e=Date.now(),r=["llm_responses","search_results","tool_outputs"];let n=0;for(const a of r){const s=this.db.transaction(a,"readwrite");let c=await s.objectStore(a).index("timestamp").openCursor();for(;c;){const d=c.value;e-d.timestamp>d.ttl&&(await c.delete(),n++),c=await c.continue()}await s.done}n>0&&console.log(` Cleaned up ${n} expired cache entries`)}catch(e){console.error("Error during cache cleanup:",e)}}async enforceStorageLimit(){if(await this.waitForInit(),!!this.db)try{if("storage"in navigator&&"estimate"in navigator.storage){const r=(await navigator.storage.estimate()).usage||0;if(r>this.maxStorageBytes){console.warn(` Cache storage limit exceeded (${(r/1024/1024).toFixed(2)}MB), evicting oldest entries`);const n=["llm_responses","search_results","tool_outputs"];for(const a of n){const s=this.db.transaction(a,"readwrite"),i=s.objectStore(a),c=await i.index("timestamp").getAllKeys(),d=Math.ceil(c.length*.1);if(d>0){const p=c.slice(0,d);for(const g of p)await i.delete(g);console.log(` Evicted ${d} entries from ${a}`)}await s.done}}}}catch(e){console.error("Error enforcing storage limit:",e)}}async clearAll(){if(await this.waitForInit(),!!this.db)try{await this.db.clear("llm_responses"),await this.db.clear("search_results"),await this.db.clear("tool_outputs"),console.log(" All cache cleared")}catch(e){console.error("Error clearing cache:",e)}}async getStats(){await this.waitForInit();const e={llmResponses:0,searchResults:0,toolOutputs:0,storageUsage:0,storageQuota:0,enabled:this.enabled};if(!this.db)return e;try{if(e.llmResponses=await this.db.count("llm_responses"),e.searchResults=await this.db.count("search_results"),e.toolOutputs=await this.db.count("tool_outputs"),"storage"in navigator&&"estimate"in navigator.storage){const r=await navigator.storage.estimate();e.storageUsage=r.usage||0,e.storageQuota=r.quota||0}}catch(r){console.error("Error getting cache stats:",r)}return e}setEnabled(e){this.enabled=e,localStorage.setItem("caching_disabled",e?"false":"true"),console.log(` Caching ${e?"enabled":"disabled"}`)}isEnabled(){return this.enabled}}const Vo=new kU,HP="https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws";console.log(" API Module Loading - Version: 2024-10-22-DYNAMIC-HOSTNAME");function GP(){const t=window.location.protocol,e=window.location.hostname,r="3000";console.log(" getLocalLambdaUrl() called:",{protocol:t,hostname:e,port:r});const n=`${t}//${e}:${r}`;return console.log(" getLocalLambdaUrl() returning:",n),n}console.log(" API Configuration:",{hostname:window.location.hostname,remote:HP,local:GP(),source:"env"});async function TU(){if(window.location.port==="8081"){const t=GP();return console.log(" Dev mode detected (port 8081) - Using local Lambda server at",t),t}return console.log(" Using VITE_API_BASE:","https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws"),"https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws"}let Vd=null,Qp=null,Ep=null;async function dn(){return Ep&&Ep!==window.location.hostname&&(console.log(` Hostname changed from ${Ep} to ${window.location.hostname}, clearing API cache`),Vd=null,Qp=null,Ep=null),Vd||(Qp||(Ep=window.location.hostname,Qp=TU().then(t=>(Vd=t,t))),Qp)}function VP(){Vd=null,Qp=null,console.log(" API base cache reset")}function CU(){Vd=HP,console.log(" Forced to use remote Lambda")}async function EU(){return dn()}function _U(){try{return localStorage.getItem("currentProjectId")}catch(t){return console.warn("Failed to get current project ID:",t),null}}function Bl(t,e={}){const r={"Content-Type":"application/json",Authorization:`Bearer ${t}`,...e},n=_U();return n&&(r["X-Project-ID"]=n),r}const AU=async(t,e,r)=>{const n=await dn(),a=await fetch(`${n}/proxy`,{method:"POST",headers:Bl(e),body:JSON.stringify(t),signal:r});if(!a.ok){const s=await a.json();throw new Error(s.error||"Request failed")}return a},jw=async(t,e,r,n,a,s,i,l)=>{const c=await dn(),d=r.filter(y=>y.enabled!==!1),p={};d.forEach(y=>{const{type:x,enabled:w,...T}=y;p[x]=T});const g={query:t,providers:p};n&&(g.model=n),l?.temperature!==void 0&&(g.temperature=l.temperature),l?.maxTokens!==void 0&&(g.max_tokens=l.maxTokens),l?.reasoningDepth!==void 0&&(g.reasoning_depth=l.reasoningDepth),l?.clarificationAnswers&&(g.clarificationAnswers=l.clarificationAnswers),l?.previousContext&&(g.previousContext=l.previousContext),l?.forcePlan&&(g.forcePlan=!0),l?.language&&(g.language=l.language);const m=await TS(`${c}/planning`,g,e,l?.signal);await kS(m,a,s,i)},NU=async(t,e,r={},n,a,s)=>{if(Vo.isEnabled()&&t.length===1)try{const g=await Vo.getSearchResults(t[0]);if(g){n("search_results",{results:g}),n("complete",{cached:!0}),a&&a();return}}catch(g){console.error("Cache lookup failed for search, continuing with API call:",g)}const i=await dn(),l=await TS(`${i}/search`,{queries:t,maxResults:r.maxResults||5,includeContent:r.includeContent!==!1},e);let c=[];await kS(l,(g,m)=>{Vo.isEnabled()&&g==="search_results"&&(c=m.results||[]),n(g,m)},async()=>{if(Vo.isEnabled()&&t.length===1&&c.length>0)try{await Vo.setSearchResults(t[0],c)}catch(g){console.error("Failed to cache search results:",g)}a&&a()},s)},Bw=async(t,e,r,n,a,s,i,l)=>{if(!t.stream&&!t.tools&&Vo.isEnabled())try{const w=await Vo.getLLMResponse(t.messages);if(w){r("content",{content:w.content}),r("complete",{response:w,usage:w.usage,model:w.model,cached:!0}),n&&n();return}}catch(w){console.error("Cache lookup failed, continuing with API call:",w)}const c=await dn(),d=await TS(`${c}/chat`,t,e,s,i,3,1e3,l);let p="",g=null,m;await kS(d,(w,T)=>{Vo.isEnabled()&&!t.tools&&(w==="content"&&(p+=T.content||""),w==="complete"&&(g=T.usage,m=T.model)),r(w,T)},async()=>{if(Vo.isEnabled()&&!t.tools&&p)try{await Vo.setLLMResponse(t.messages,{role:"assistant",content:p},g,m)}catch(w){console.error("Failed to cache response:",w)}n&&n()},a)},WP=async(t,e,r,n,a,s,i,l,c)=>{const d=await dn(),p={prompt:t,provider:e,model:r,modelKey:n,size:a,quality:s,style:i,accessToken:l,...c||{}};try{const g=await fetch(`${d}/generate-image`,{method:"POST",headers:Bl(l||""),body:JSON.stringify(p),credentials:"include"}),m=await g.json();return g.ok?m:{success:!1,error:m.error||`HTTP ${g.status}: ${g.statusText}`}}catch(g){return console.error("Image generation request failed:",g),{success:!1,error:g.message||"Failed to generate image"}}},PU=async()=>{const t=await dn();try{const e=await fetch(`${t}/health-check/image-providers`,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}catch(e){return console.error("Failed to fetch provider health:",e),{timestamp:new Date().toISOString(),providers:{},summary:{total:0,available:0,unavailable:0}}}},IU=async(t,e)=>{const r=await dn();try{const n=await fetch(`${r}/paypal/create-order`,{method:"POST",headers:Bl(e),body:JSON.stringify({amount:t}),credentials:"include"}),a=await n.json();return n.ok?{success:!0,orderId:a.orderId}:{success:!1,error:a.error||`HTTP ${n.status}: ${n.statusText}`}}catch(n){return console.error("PayPal order creation failed:",n),{success:!1,error:n.message||"Failed to create PayPal order"}}},RU=async(t,e)=>{const r=await dn();try{const n=await fetch(`${r}/paypal/capture-order`,{method:"POST",headers:Bl(e),body:JSON.stringify({orderId:t}),credentials:"include"}),a=await n.json();return n.ok?{success:!0,creditsAdded:a.creditsAdded,newBalance:a.newBalance}:{success:!1,error:a.error||`HTTP ${n.status}: ${n.statusText}`}}catch(n){return console.error("PayPal order capture failed:",n),{success:!1,error:n.message||"Failed to capture PayPal order"}}},DU=async(t,e,r,n)=>{const a=await dn(),s=await fetch(`${a}/quiz/generate`,{method:"POST",headers:Bl(n),body:JSON.stringify({content:t,enrichment:e,providers:r}),credentials:"include"});if(!s.ok){const i=await s.json().catch(()=>({error:"Unknown error"}));throw new Error(i.error||`HTTP ${s.status}: ${s.statusText}`)}return await s.json()},LU=async(t,e,r,n,a,s,i)=>{const l=await dn(),c=new AbortController;try{const d=await fetch(`${l}/quiz/generate/stream`,{method:"POST",headers:Bl(n),body:JSON.stringify({content:t,enrichment:e,providers:r}),credentials:"include",signal:c.signal});if(!d.ok){const x=await d.json().catch(()=>({error:"Unknown error"}));return i(x.error||`HTTP ${d.status}: ${d.statusText}`),()=>{}}if(!d.body)return i("No response body"),()=>{};const p=d.body.getReader(),g=new TextDecoder;let m="";return(async()=>{try{for(;;){const{done:x,value:w}=await p.read();if(x)break;m+=g.decode(w,{stream:!0});const T=m.split(`

`);m=T.pop()||"";for(const k of T){if(!k.trim())continue;const _=k.match(/event:\s*(\w+)\ndata:\s*(.+)/s);if(!_)continue;const[,P,F]=_;try{const D=JSON.parse(F);P==="question_generated"?a(D.question,D.index,D.total):P==="complete"?s(D.questionsGenerated,D.duration):P==="error"&&i(D.error||"Unknown error")}catch(D){console.error("Failed to parse SSE data:",D)}}}}catch(x){x.name!=="AbortError"&&i(x.message||"Stream error")}})(),()=>{c.abort(),p.cancel()}}catch(d){return i(d.message||"Connection failed"),()=>{}}},MU=async()=>{try{const t=await dn(),e=await fetch(`${t}/providers`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return console.error("Failed to fetch backend providers:",e.status,e.statusText),[];const r=await e.json();return console.log(` Fetched ${r.count} backend providers`),r.providers||[]}catch(t){return console.error("Error fetching backend providers:",t),[]}},OU=async(t,e)=>{const r=await dn();try{const n=await fetch(`${r}/fetch-images`,{method:"POST",headers:Bl(e),body:JSON.stringify({images:t}),credentials:"include"});if(!n.ok){const s=await n.json().catch(()=>({error:"Unknown error"}));throw new Error(s.error||`HTTP ${n.status}: ${n.statusText}`)}const a=await n.json();return console.log(` Batch fetched ${a.stats.succeeded}/${a.stats.total} images in ${a.stats.duration}ms`),a.images||[]}catch(n){throw console.error("Failed to fetch images:",n),n}},jU=async(t,e)=>{const r=await dn();try{const n=await fetch(`${r}/summarize`,{method:"POST",headers:Bl(e),body:JSON.stringify({text:t,maxWords:100,purpose:"voice"}),credentials:"include"});if(!n.ok){const s=await n.json().catch(()=>({error:"Unknown error"}));throw new Error(s.error||`HTTP ${n.status}: ${n.statusText}`)}return(await n.json()).summary||t}catch(n){return console.error("Failed to summarize text:",n),t}},CS=Object.freeze(Object.defineProperty({__proto__:null,buildApiHeaders:Bl,capturePayPalOrder:RU,createPayPalOrder:IU,fetchImagesBase64:OU,forceRemote:CU,generateImage:WP,generatePlan:jw,generateQuiz:DU,generateQuizStreaming:LU,getBackendProviders:MU,getCachedApiBase:dn,getCurrentApiBase:EU,getImageProviderHealth:PU,performSearch:NU,resetApiBase:VP,sendChatMessage:AU,sendChatMessageStreaming:Bw,summarizeForVoice:jU},Symbol.toStringTag,{value:"Module"}));class BU{config=null;status={inProgress:!1,lastSync:null,lastError:null,pendingChanges:0,conflictsResolved:0};syncQueue=[];syncInterval=null;apiUrl=null;eventCallbacks={onStart:[],onComplete:[],onError:[]};constructor(){this.initializeApiUrl(),this.initializeDeviceId(),this.loadQueueFromStorage()}async initializeApiUrl(){this.apiUrl=await dn()}async getApiUrl(){return this.apiUrl?this.apiUrl:(await this.initializeApiUrl(),this.apiUrl)}initializeDeviceId(){let e=localStorage.getItem("rag_device_id");e||(e=`device-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,localStorage.setItem("rag_device_id",e))}getDeviceId(){return localStorage.getItem("rag_device_id")||"unknown"}async initialize(e){this.config={...e,deviceId:this.getDeviceId()},localStorage.setItem("rag_sync_config",JSON.stringify(this.config)),console.log(" RAG Sync Service initialized:",this.config),e.autoSync&&this.startAutoSync()}getStatus(){return{...this.status}}async pushSnippets(e,r,n){if(!this.config)throw new Error("Sync service not initialized");try{console.log(` Pushing ${e.length} snippets to Sheets...`);const a=await this.getApiUrl(),s=await fetch(`${a}/rag/sync`,{method:"POST",headers:{"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{}},body:JSON.stringify({operation:"push-snippets",userEmail:r,deviceId:this.config.deviceId,data:e})});if(!s.ok){const l=await s.json();throw new Error(l.error||"Failed to push snippets")}const i=await s.json();console.log(` Pushed ${i.count||e.length} snippets`)}catch(a){throw console.error(" Error pushing snippets:",a),a}}async pullSnippets(e,r){if(!this.config)throw new Error("Sync service not initialized");try{console.log(" Pulling snippets from Sheets...");const n=await this.getApiUrl(),a=await fetch(`${n}/rag/sync`,{method:"POST",headers:{"Content-Type":"application/json",...r?{Authorization:`Bearer ${r}`}:{}},body:JSON.stringify({operation:"pull-snippets",userEmail:e,deviceId:this.config.deviceId})});if(!a.ok){const l=await a.json();throw new Error(l.error||"Failed to pull snippets")}const i=(await a.json()).snippets||[];return console.log(` Pulled ${i.length} snippets`),i}catch(n){throw console.error(" Error pulling snippets:",n),n}}async fullSync(e,r){if(!this.config)throw new Error("Sync service not initialized");this.status.inProgress=!0,this.notifyStart();const n={snippetsPushed:0,snippetsPulled:0,embeddingsPushed:0,embeddingsPulled:0,conflicts:0,errors:[]};try{console.log(" Starting full sync...");const a=await this.pullSnippets(e),{toUpload:s,toDownload:i,conflicts:l}=this.mergeSnippets(r,a);return n.conflicts=l.length,this.status.conflictsResolved+=l.length,s.length>0&&(await this.pushSnippets(s,e),n.snippetsPushed=s.length),n.snippetsPulled=i.length,this.status.lastSync=Date.now(),this.status.lastError=null,localStorage.setItem("rag_last_sync",this.status.lastSync.toString()),console.log(" Full sync complete:",n),this.notifyComplete(n),n}catch(a){throw console.error(" Full sync failed:",a),this.status.lastError=a.message,n.errors.push(a.message),this.notifyError(a),a}finally{this.status.inProgress=!1}}mergeSnippets(e,r){const n=new Map(e.map(c=>[c.id,c])),a=new Map(r.map(c=>[c.id,c])),s=[],i=[],l=[];for(const c of e){const d=a.get(c.id);if(!d)s.push(c);else{const p=c.updateDate||c.timestamp,g=d.updateDate||d.timestamp;p>g?s.push(c):g>p&&i.push(d)}}for(const c of r)n.has(c.id)||i.push(c);return console.log(` Merge result: ${s.length} to upload, ${i.length} to download, ${l.length} conflicts`),{toUpload:s,toDownload:i,conflicts:l}}queueSync(e){const r={...e,timestamp:Date.now()};this.syncQueue.push(r),this.status.pendingChanges=this.syncQueue.length,this.saveQueueToStorage(),console.log(` Queued ${e.type} operation (${this.syncQueue.length} pending)`),this.config?.autoSync&&!this.status.inProgress&&setTimeout(()=>{this.syncQueue.length>0&&!this.status.inProgress&&this.processSyncQueue().catch(console.error)},2e3)}async processSyncQueue(){if(!(!this.config||this.syncQueue.length===0)){console.log(` Processing ${this.syncQueue.length} queued operations...`),this.status.inProgress=!0;try{const e=this.syncQueue.filter(r=>r.type==="push-snippet");if(e.length>0){const r=e.map(a=>a.data),n=e[0].userEmail;await this.pushSnippets(r,n),this.syncQueue=this.syncQueue.filter(a=>a.type!=="push-snippet")}this.status.pendingChanges=this.syncQueue.length,this.saveQueueToStorage(),console.log(` Queue processed, ${this.syncQueue.length} remaining`)}catch(e){console.error(" Error processing queue:",e)}finally{this.status.inProgress=!1}}}startAutoSync(){if(!this.syncInterval){if(!this.config){console.warn("Cannot start auto-sync: service not initialized");return}console.log(` Starting auto-sync (interval: ${this.config.syncInterval}ms)`),this.syncInterval=setInterval(()=>{!this.status.inProgress&&this.syncQueue.length>0&&this.processSyncQueue().catch(console.error)},this.config.syncInterval)}}stopAutoSync(){this.syncInterval&&(clearInterval(this.syncInterval),this.syncInterval=null,console.log(" Auto-sync stopped"))}saveQueueToStorage(){try{localStorage.setItem("rag_sync_queue",JSON.stringify(this.syncQueue))}catch(e){console.error("Failed to save sync queue:",e)}}loadQueueFromStorage(){try{const e=localStorage.getItem("rag_sync_queue");e&&(this.syncQueue=JSON.parse(e),this.status.pendingChanges=this.syncQueue.length,console.log(` Loaded ${this.syncQueue.length} queued operations from storage`))}catch(e){console.error("Failed to load sync queue:",e)}}async pushEmbeddings(e,r){if(!this.config||!this.config.enabled)throw new Error("Sync service not initialized");try{const n=localStorage.getItem("rag_spreadsheet_id");if(!n)throw new Error("No spreadsheet ID found. User may not be logged in.");const a=localStorage.getItem("authToken")||localStorage.getItem("google_access_token");if(!a)throw new Error("Not authenticated");const s=100,i=Math.ceil(e.length/s);for(let l=0;l<i;l++){const c=e.slice(l*s,(l+1)*s);r&&r(Math.min((l+1)*s,e.length),e.length);const d=await this.getApiUrl(),p=await fetch(`${d}/rag/sync-embeddings`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify({operation:"push",spreadsheetId:n,chunks:c})});if(!p.ok)throw new Error(`Failed to push embeddings: ${p.status}`)}console.log(` Pushed ${e.length} chunks to Google Sheets`)}catch(n){throw console.error("Failed to push embeddings:",n),n}}async pullEmbeddings(e){if(!this.config||!this.config.enabled)throw new Error("Sync service not initialized");try{const r=localStorage.getItem("rag_spreadsheet_id");if(!r)throw new Error("No spreadsheet ID found. User may not be logged in.");const n=localStorage.getItem("authToken")||localStorage.getItem("google_access_token");if(!n)throw new Error("Not authenticated");const a=await this.getApiUrl(),s=await fetch(`${a}/rag/sync-embeddings`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`},body:JSON.stringify({operation:"pull",spreadsheetId:r,snippetIds:e})});if(!s.ok)throw new Error(`Failed to pull embeddings: ${s.status}`);const{chunks:i}=await s.json();return console.log(` Pulled ${i?.length||0} chunks from Google Sheets`),i||[]}catch(r){throw console.error("Failed to pull embeddings:",r),r}}onSyncStart(e){this.eventCallbacks.onStart.push(e)}onSyncComplete(e){this.eventCallbacks.onComplete.push(e)}onSyncError(e){this.eventCallbacks.onError.push(e)}notifyStart(){this.eventCallbacks.onStart.forEach(e=>e())}notifyComplete(e){this.eventCallbacks.onComplete.forEach(r=>r(e))}notifyError(e){this.eventCallbacks.onError.forEach(r=>r(void 0,e))}clear(){this.syncQueue=[],this.status={inProgress:!1,lastSync:null,lastError:null,pendingChanges:0,conflictsResolved:0},localStorage.removeItem("rag_sync_queue"),localStorage.removeItem("rag_last_sync"),console.log(" Sync service cleared")}}const Ua=new BU;let Fw=null;const io={maxRequests:50,windowMs:6e4,requests:[]};async function N0(){const t=Date.now();if(io.requests=io.requests.filter(e=>t-e<io.windowMs),io.requests.length>=io.maxRequests){const e=io.requests[0],r=io.windowMs-(t-e)+100;console.log(` Rate limit reached, waiting ${Math.round(r/1e3)}s...`),await new Promise(a=>setTimeout(a,r));const n=Date.now();io.requests=io.requests.filter(a=>n-a<io.windowMs)}io.requests.push(Date.now())}function zw(t){const e=window.google;if(!e?.accounts?.oauth2){console.warn(" Google Identity Services not loaded - include GIS script in index.html");return}if(Fw){console.log(" Google Identity already initialized");return}try{Fw=e.accounts.oauth2.initTokenClient({client_id:t,scope:"https://www.googleapis.com/auth/drive.file",callback:()=>{console.log(" Token response received")}}),console.log(" Google Identity Services initialized")}catch(r){console.error(" Failed to initialize Google Identity Services:",r)}}function zd(){return Fw!==null}async function tf(t){console.log(" googleSheetsClient.getAccessToken() called - redirecting to centralized googleAuth service");const{googleAuth:e}=await Zt(async()=>{const{googleAuth:n}=await Promise.resolve().then(()=>Ng);return{googleAuth:n}},void 0);if(!e.isAuthenticated())throw new Error("Please log in with Google Drive first (Settings  Cloud Sync)");const r=e.getAccessToken();if(!r)throw new Error("No access token available - please reconnect Google Drive");return console.log(" Using access token from centralized googleAuth service"),r}async function Ly(t,e,r){if(!t)throw new Error("Spreadsheet ID is required");if(!r||r.length===0)throw new Error("No values to append");await N0();const n=await tf(),a=`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/${encodeURIComponent(e)}:append?valueInputOption=RAW`,s={values:r};console.log(` Appending ${r.length} rows to sheet: ${e}`);const i=await fetch(a,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!i.ok){const c=await i.text();throw console.error(" Sheets API error:",{status:i.status,statusText:i.statusText,body:c}),new Error(`Sheets API error: ${i.status} ${i.statusText}. ${c}`)}const l=await i.json();return console.log(` Appended ${l.updates.updatedRows} rows to Google Sheets`),l}async function ES(t,e){const r=await tf(),n=`https://sheets.googleapis.com/v4/spreadsheets/${t}/values/${encodeURIComponent(e)}`,a=await fetch(n,{method:"GET",headers:{Authorization:`Bearer ${r}`}});if(!a.ok){const i=await a.text();throw new Error(`Sheets API error: ${a.status} ${a.statusText}. ${i}`)}return(await a.json()).values||[]}async function YP(t,e){const r=await tf(),n=`https://sheets.googleapis.com/v4/spreadsheets/${t}:batchUpdate`,a=await fetch(n,{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify({requests:e})});if(!a.ok){const s=await a.text();throw new Error(`Sheets API error: ${a.status} ${a.statusText}. ${s}`)}return a.json()}function QP(t){return t.map(e=>[e.id||"",e.snippet_id||"",e.snippet_name||"",e.chunk_text||"",JSON.stringify(e.embedding||[]),e.chunk_index??0,e.embedding_model||"",e.embedding_provider||"",e.embedding_dimensions||0,e.source_type||"text",e.created_at||new Date().toISOString()])}function KP(t){return t.map(e=>[e.id||"",e.content||"",e.title||"",e.sourceType||"manual",e.timestamp||Date.now(),e.updateDate||e.timestamp||Date.now(),JSON.stringify(e.tags||[]),e.projectId||"",e.selected?"true":"false"])}async function FU(t,e){if(e.length===0){console.log(" No snippets to sync");return}try{console.log(` Syncing ${e.length} snippets to Google Sheets (client-side)...`);const r=10,n=[];for(let a=0;a<e.length;a+=r)n.push(e.slice(a,a+r));console.log(` Split into ${n.length} batches of up to ${r} items`);for(let a=0;a<n.length;a++){const s=n[a],i=KP(s);await Ly(t,"snippets!A:I",i),console.log(` Synced batch ${a+1}/${n.length} (${s.length} snippets)`)}console.log(` Synced all ${e.length} snippets to Google Sheets`)}catch(r){throw console.error(" Failed to sync snippets:",r),r}}function XP(t){return t.map(e=>[e.id||"",e.quizTitle||"",JSON.stringify(e.snippetIds||[]),e.score||0,e.totalQuestions||0,e.percentage||0,e.timeTaken||0,e.completedAt||"",JSON.stringify(e.answers||[]),e.enrichment?"true":"false",e.completed?"true":"false",e.projectId||"",JSON.stringify(e.quizData||null)])}async function zU(t,e){if(e.length!==0)try{console.log(` Syncing ${e.length} quiz statistics to Google Sheets (client-side)...`);const r=XP(e);await Ly(t,"quizzes!A:M",r),console.log(` Synced ${e.length} quizzes to Google Sheets`)}catch(r){throw console.error(" Failed to sync quizzes:",r),r}}async function $U(t,e,r){return await N0(),(await ES(t,`${e}!A:A`)).findIndex(s=>s[0]===r)}async function JP(t,e,r){if(r.length===0)return console.log(" No IDs to delete"),0;try{console.log(`  Deleting ${r.length} rows from ${e}...`),await N0();const n=await tf(),a=`https://sheets.googleapis.com/v4/spreadsheets/${t}?fields=sheets(properties(sheetId,title))`,s=await fetch(a,{headers:{Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error(`Failed to get sheet metadata: ${s.statusText}`);const l=(await s.json()).sheets.find(g=>g.properties.title===e);if(!l)throw new Error(`Sheet "${e}" not found`);const c=l.properties.sheetId,d=[];for(const g of r){const m=await $U(t,e,g);m>=0?d.push(m):console.warn(` ID not found in sheet: ${g}`)}if(d.length===0)return console.log(" No matching rows found to delete"),0;d.sort((g,m)=>m-g);const p=d.map(g=>({deleteDimension:{range:{sheetId:c,dimension:"ROWS",startIndex:g,endIndex:g+1}}}));return await N0(),await YP(t,p),console.log(` Deleted ${d.length} rows from Google Sheets`),d.length}catch(n){throw console.error(" Failed to delete rows:",n),n}}async function UU(t,e){return JP(t,"snippets",e)}const $w=Object.freeze(Object.defineProperty({__proto__:null,appendRows:Ly,batchUpdate:YP,deleteRowsByIds:JP,deleteSnippetsFromSheets:UU,formatChunksForSheets:QP,formatQuizzesForSheets:XP,formatSnippetsForSheets:KP,getAccessToken:tf,getValues:ES,initGoogleIdentity:zw,isGoogleIdentityAvailable:zd,syncQuizzesToSheets:zU,syncSnippetsToSheets:FU},Symbol.toStringTag,{value:"Module"}));var t0={exports:{}},qU=t0.exports,e_;function HU(){return e_||(e_=1,(function(t,e){(function(r,n){t.exports=n()})(qU,function(){var r=function(v,C){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,j){R.__proto__=j}||function(R,j){for(var G in j)Object.prototype.hasOwnProperty.call(j,G)&&(R[G]=j[G])})(v,C)},n=function(){return(n=Object.assign||function(v){for(var C,R=1,j=arguments.length;R<j;R++)for(var G in C=arguments[R])Object.prototype.hasOwnProperty.call(C,G)&&(v[G]=C[G]);return v}).apply(this,arguments)};function a(v,C,R){for(var j,G=0,J=C.length;G<J;G++)!j&&G in C||((j=j||Array.prototype.slice.call(C,0,G))[G]=C[G]);return v.concat(j||Array.prototype.slice.call(C))}var s=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:KB,i=Object.keys,l=Array.isArray;function c(v,C){return typeof C!="object"||i(C).forEach(function(R){v[R]=C[R]}),v}typeof Promise>"u"||s.Promise||(s.Promise=Promise);var d=Object.getPrototypeOf,p={}.hasOwnProperty;function g(v,C){return p.call(v,C)}function m(v,C){typeof C=="function"&&(C=C(d(v))),(typeof Reflect>"u"?i:Reflect.ownKeys)(C).forEach(function(R){x(v,R,C[R])})}var y=Object.defineProperty;function x(v,C,R,j){y(v,C,c(R&&g(R,"get")&&typeof R.get=="function"?{get:R.get,set:R.set,configurable:!0}:{value:R,configurable:!0,writable:!0},j))}function w(v){return{from:function(C){return v.prototype=Object.create(C.prototype),x(v.prototype,"constructor",v),{extend:m.bind(null,v.prototype)}}}}var T=Object.getOwnPropertyDescriptor,k=[].slice;function _(v,C,R){return k.call(v,C,R)}function P(v,C){return C(v)}function F(v){if(!v)throw new Error("Assertion Failed")}function D(v){s.setImmediate?setImmediate(v):setTimeout(v,0)}function B(v,C){if(typeof C=="string"&&g(v,C))return v[C];if(!C)return v;if(typeof C!="string"){for(var R=[],j=0,G=C.length;j<G;++j){var J=B(v,C[j]);R.push(J)}return R}var le=C.indexOf(".");if(le!==-1){var ge=v[C.substr(0,le)];return ge==null?void 0:B(ge,C.substr(le+1))}}function M(v,C,R){if(v&&C!==void 0&&!("isFrozen"in Object&&Object.isFrozen(v)))if(typeof C!="string"&&"length"in C){F(typeof R!="string"&&"length"in R);for(var j=0,G=C.length;j<G;++j)M(v,C[j],R[j])}else{var J,le,ge=C.indexOf(".");ge!==-1?(J=C.substr(0,ge),(le=C.substr(ge+1))===""?R===void 0?l(v)&&!isNaN(parseInt(J))?v.splice(J,1):delete v[J]:v[J]=R:M(ge=!(ge=v[J])||!g(v,J)?v[J]={}:ge,le,R)):R===void 0?l(v)&&!isNaN(parseInt(C))?v.splice(C,1):delete v[C]:v[C]=R}}function $(v){var C,R={};for(C in v)g(v,C)&&(R[C]=v[C]);return R}var Z=[].concat;function z(v){return Z.apply([],v)}var qe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(z([8,16,32,64].map(function(v){return["Int","Uint","Float"].map(function(C){return C+v+"Array"})}))).filter(function(v){return s[v]}),ee=new Set(qe.map(function(v){return s[v]})),te=null;function X(v){return te=new WeakMap,v=(function C(R){if(!R||typeof R!="object")return R;var j=te.get(R);if(j)return j;if(l(R)){j=[],te.set(R,j);for(var G=0,J=R.length;G<J;++G)j.push(C(R[G]))}else if(ee.has(R.constructor))j=R;else{var le,ge=d(R);for(le in j=ge===Object.prototype?{}:Object.create(ge),te.set(R,j),R)g(R,le)&&(j[le]=C(R[le]))}return j})(v),te=null,v}var Q={}.toString;function W(v){return Q.call(v).slice(8,-1)}var H=typeof Symbol<"u"?Symbol.iterator:"@@iterator",re=typeof H=="symbol"?function(v){var C;return v!=null&&(C=v[H])&&C.apply(v)}:function(){return null};function ne(v,C){return C=v.indexOf(C),0<=C&&v.splice(C,1),0<=C}var ve={};function O(v){var C,R,j,G;if(arguments.length===1){if(l(v))return v.slice();if(this===ve&&typeof v=="string")return[v];if(G=re(v)){for(R=[];!(j=G.next()).done;)R.push(j.value);return R}if(v==null)return[v];if(typeof(C=v.length)!="number")return[v];for(R=new Array(C);C--;)R[C]=v[C];return R}for(C=arguments.length,R=new Array(C);C--;)R[C]=arguments[C];return R}var I=typeof Symbol<"u"?function(v){return v[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},fr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],dt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(fr),K={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function U(v,C){this.name=v,this.message=C}function ce(v,C){return v+". Errors: "+Object.keys(C).map(function(R){return C[R].toString()}).filter(function(R,j,G){return G.indexOf(R)===j}).join(`
`)}function ye(v,C,R,j){this.failures=C,this.failedKeys=j,this.successCount=R,this.message=ce(v,C)}function Ae(v,C){this.name="BulkError",this.failures=Object.keys(C).map(function(R){return C[R]}),this.failuresByPos=C,this.message=ce(v,this.failures)}w(U).from(Error).extend({toString:function(){return this.name+": "+this.message}}),w(ye).from(U),w(Ae).from(U);var fe=dt.reduce(function(v,C){return v[C]=C+"Error",v},{}),Ne=U,Te=dt.reduce(function(v,C){var R=C+"Error";function j(G,J){this.name=R,G?typeof G=="string"?(this.message="".concat(G).concat(J?`
 `+J:""),this.inner=J||null):typeof G=="object"&&(this.message="".concat(G.name," ").concat(G.message),this.inner=G):(this.message=K[C]||R,this.inner=null)}return w(j).from(Ne),v[C]=j,v},{});Te.Syntax=SyntaxError,Te.Type=TypeError,Te.Range=RangeError;var se=fr.reduce(function(v,C){return v[C+"Error"]=Te[C],v},{}),be=dt.reduce(function(v,C){return["Syntax","Type","Range"].indexOf(C)===-1&&(v[C+"Error"]=Te[C]),v},{});function xe(){}function me(v){return v}function de(v,C){return v==null||v===me?C:function(R){return C(v(R))}}function he(v,C){return function(){v.apply(this,arguments),C.apply(this,arguments)}}function Ie(v,C){return v===xe?C:function(){var R=v.apply(this,arguments);R!==void 0&&(arguments[0]=R);var j=this.onsuccess,G=this.onerror;this.onsuccess=null,this.onerror=null;var J=C.apply(this,arguments);return j&&(this.onsuccess=this.onsuccess?he(j,this.onsuccess):j),G&&(this.onerror=this.onerror?he(G,this.onerror):G),J!==void 0?J:R}}function ze(v,C){return v===xe?C:function(){v.apply(this,arguments);var R=this.onsuccess,j=this.onerror;this.onsuccess=this.onerror=null,C.apply(this,arguments),R&&(this.onsuccess=this.onsuccess?he(R,this.onsuccess):R),j&&(this.onerror=this.onerror?he(j,this.onerror):j)}}function nt(v,C){return v===xe?C:function(R){var j=v.apply(this,arguments);c(R,j);var G=this.onsuccess,J=this.onerror;return this.onsuccess=null,this.onerror=null,R=C.apply(this,arguments),G&&(this.onsuccess=this.onsuccess?he(G,this.onsuccess):G),J&&(this.onerror=this.onerror?he(J,this.onerror):J),j===void 0?R===void 0?void 0:R:c(j,R)}}function mt(v,C){return v===xe?C:function(){return C.apply(this,arguments)!==!1&&v.apply(this,arguments)}}function ht(v,C){return v===xe?C:function(){var R=v.apply(this,arguments);if(R&&typeof R.then=="function"){for(var j=this,G=arguments.length,J=new Array(G);G--;)J[G]=arguments[G];return R.then(function(){return C.apply(j,J)})}return C.apply(this,arguments)}}be.ModifyError=ye,be.DexieError=U,be.BulkError=Ae;var er=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ct(v){er=v}var Dt={},kt=100,qe=typeof Promise>"u"?[]:(function(){var v=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[v,d(v),v];var C=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[C,d(C),v]})(),fr=qe[0],dt=qe[1],qe=qe[2],dt=dt&&dt.then,st=fr&&fr.constructor,Gt=!!qe,Kt=function(v,C){pn.push([v,C]),Qe&&(queueMicrotask(xr),Qe=!1)},lr=!0,Qe=!0,Yt=[],ur=[],_t=me,sr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:xe,pgp:!1,env:{},finalize:xe},vt=sr,pn=[],Ar=0,Ja=[];function zt(v){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var C=this._PSD=vt;if(typeof v!="function"){if(v!==Dt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&qn(this,this._value))}this._state=null,this._value=null,++C.ref,(function R(j,G){try{G(function(J){if(j._state===null){if(J===j)throw new TypeError("A promise cannot be resolved with itself.");var le=j._lib&&Kr();J&&typeof J.then=="function"?R(j,function(ge,Ee){J instanceof zt?J._then(ge,Ee):J.then(ge,Ee)}):(j._state=!0,j._value=J,Se(j)),le&&Xr()}},qn.bind(null,j))}catch(J){qn(j,J)}})(this,v)}var Ca={get:function(){var v=vt,C=Za;function R(j,G){var J=this,le=!v.global&&(v!==vt||C!==Za),ge=le&&!ca(),Ee=new zt(function(Re,$e){ut(J,new Bs(De(j,v,le,ge),De(G,v,le,ge),Re,$e,v))});return this._consoleTask&&(Ee._consoleTask=this._consoleTask),Ee}return R.prototype=Dt,R},set:function(v){x(this,"then",v&&v.prototype===Dt?Ca:{get:function(){return v},set:Ca.set})}};function Bs(v,C,R,j,G){this.onFulfilled=typeof v=="function"?v:null,this.onRejected=typeof C=="function"?C:null,this.resolve=R,this.reject=j,this.psd=G}function qn(v,C){var R,j;ur.push(C),v._state===null&&(R=v._lib&&Kr(),C=_t(C),v._state=!1,v._value=C,j=v,Yt.some(function(G){return G._value===j._value})||Yt.push(j),Se(v),R&&Xr())}function Se(v){var C=v._listeners;v._listeners=[];for(var R=0,j=C.length;R<j;++R)ut(v,C[R]);var G=v._PSD;--G.ref||G.finalize(),Ar===0&&(++Ar,Kt(function(){--Ar==0&&tr()},[]))}function ut(v,C){if(v._state!==null){var R=v._state?C.onFulfilled:C.onRejected;if(R===null)return(v._state?C.resolve:C.reject)(v._value);++C.psd.ref,++Ar,Kt(Nt,[R,v,C])}else v._listeners.push(C)}function Nt(v,C,R){try{var j,G=C._value;!C._state&&ur.length&&(ur=[]),j=er&&C._consoleTask?C._consoleTask.run(function(){return v(G)}):v(G),C._state||ur.indexOf(G)!==-1||(function(J){for(var le=Yt.length;le;)if(Yt[--le]._value===J._value)return Yt.splice(le,1)})(C),R.resolve(j)}catch(J){R.reject(J)}finally{--Ar==0&&tr(),--R.psd.ref||R.psd.finalize()}}function xr(){rr(sr,function(){Kr()&&Xr()})}function Kr(){var v=lr;return Qe=lr=!1,v}function Xr(){var v,C,R;do for(;0<pn.length;)for(v=pn,pn=[],R=v.length,C=0;C<R;++C){var j=v[C];j[0].apply(null,j[1])}while(0<pn.length);Qe=lr=!0}function tr(){var v=Yt;Yt=[],v.forEach(function(j){j._PSD.onunhandled.call(null,j._value,j)});for(var C=Ja.slice(0),R=C.length;R;)C[--R]()}function Vt(v){return new zt(Dt,!1,v)}function Qt(v,C){var R=vt;return function(){var j=Kr(),G=vt;try{return Zn(R,!0),v.apply(this,arguments)}catch(J){C&&C(J)}finally{Zn(G,!1),j&&Xr()}}}m(zt.prototype,{then:Ca,_then:function(v,C){ut(this,new Bs(null,null,v,C,vt))},catch:function(v){if(arguments.length===1)return this.then(null,v);var C=v,R=arguments[1];return typeof C=="function"?this.then(null,function(j){return(j instanceof C?R:Vt)(j)}):this.then(null,function(j){return(j&&j.name===C?R:Vt)(j)})},finally:function(v){return this.then(function(C){return zt.resolve(v()).then(function(){return C})},function(C){return zt.resolve(v()).then(function(){return Vt(C)})})},timeout:function(v,C){var R=this;return v<1/0?new zt(function(j,G){var J=setTimeout(function(){return G(new Te.Timeout(C))},v);R.then(j,G).finally(clearTimeout.bind(null,J))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&x(zt.prototype,Symbol.toStringTag,"Dexie.Promise"),sr.env=Pi(),m(zt,{all:function(){var v=O.apply(null,arguments).map(_a);return new zt(function(C,R){v.length===0&&C([]);var j=v.length;v.forEach(function(G,J){return zt.resolve(G).then(function(le){v[J]=le,--j||C(v)},R)})})},resolve:function(v){return v instanceof zt?v:v&&typeof v.then=="function"?new zt(function(C,R){v.then(C,R)}):new zt(Dt,!0,v)},reject:Vt,race:function(){var v=O.apply(null,arguments).map(_a);return new zt(function(C,R){v.map(function(j){return zt.resolve(j).then(C,R)})})},PSD:{get:function(){return vt},set:function(v){return vt=v}},totalEchoes:{get:function(){return Za}},newPSD:an,usePSD:rr,scheduler:{get:function(){return Kt},set:function(v){Kt=v}},rejectionMapper:{get:function(){return _t},set:function(v){_t=v}},follow:function(v,C){return new zt(function(R,j){return an(function(G,J){var le=vt;le.unhandleds=[],le.onunhandled=J,le.finalize=he(function(){var ge,Ee=this;ge=function(){Ee.unhandleds.length===0?G():J(Ee.unhandleds[0])},Ja.push(function Re(){ge(),Ja.splice(Ja.indexOf(Re),1)}),++Ar,Kt(function(){--Ar==0&&tr()},[])},le.finalize),v()},C,R,j)})}}),st&&(st.allSettled&&x(zt,"allSettled",function(){var v=O.apply(null,arguments).map(_a);return new zt(function(C){v.length===0&&C([]);var R=v.length,j=new Array(R);v.forEach(function(G,J){return zt.resolve(G).then(function(le){return j[J]={status:"fulfilled",value:le}},function(le){return j[J]={status:"rejected",reason:le}}).then(function(){return--R||C(j)})})})}),st.any&&typeof AggregateError<"u"&&x(zt,"any",function(){var v=O.apply(null,arguments).map(_a);return new zt(function(C,R){v.length===0&&R(new AggregateError([]));var j=v.length,G=new Array(j);v.forEach(function(J,le){return zt.resolve(J).then(function(ge){return C(ge)},function(ge){G[le]=ge,--j||R(new AggregateError(G))})})})}),st.withResolvers&&(zt.withResolvers=st.withResolvers));var Or={awaits:0,echoes:0,id:0},Hr=0,Dn=[],Ba=0,Za=0,Ea=0;function an(v,C,R,j){var G=vt,J=Object.create(G);return J.parent=G,J.ref=0,J.global=!1,J.id=++Ea,sr.env,J.env=Gt?{Promise:zt,PromiseProp:{value:zt,configurable:!0,writable:!0},all:zt.all,race:zt.race,allSettled:zt.allSettled,any:zt.any,resolve:zt.resolve,reject:zt.reject}:{},C&&c(J,C),++G.ref,J.finalize=function(){--this.parent.ref||this.parent.finalize()},j=rr(J,v,R,j),J.ref===0&&J.finalize(),j}function tn(){return Or.id||(Or.id=++Hr),++Or.awaits,Or.echoes+=kt,Or.id}function ca(){return!!Or.awaits&&(--Or.awaits==0&&(Or.id=0),Or.echoes=Or.awaits*kt,!0)}function _a(v){return Or.echoes&&v&&v.constructor===st?(tn(),v.then(function(C){return ca(),C},function(C){return ca(),Mt(C)})):v}function Zi(){var v=Dn[Dn.length-1];Dn.pop(),Zn(v,!1)}function Zn(v,C){var R,j=vt;(C?!Or.echoes||Ba++&&v===vt:!Ba||--Ba&&v===vt)||queueMicrotask(C?(function(G){++Za,Or.echoes&&--Or.echoes!=0||(Or.echoes=Or.awaits=Or.id=0),Dn.push(vt),Zn(G,!0)}).bind(null,v):Zi),v!==vt&&(vt=v,j===sr&&(sr.env=Pi()),Gt&&(R=sr.env.Promise,C=v.env,(j.global||v.global)&&(Object.defineProperty(s,"Promise",C.PromiseProp),R.all=C.all,R.race=C.race,R.resolve=C.resolve,R.reject=C.reject,C.allSettled&&(R.allSettled=C.allSettled),C.any&&(R.any=C.any))))}function Pi(){var v=s.Promise;return Gt?{Promise:v,PromiseProp:Object.getOwnPropertyDescriptor(s,"Promise"),all:v.all,race:v.race,allSettled:v.allSettled,any:v.any,resolve:v.resolve,reject:v.reject}:{}}function rr(v,C,R,j,G){var J=vt;try{return Zn(v,!0),C(R,j,G)}finally{Zn(J,!1)}}function De(v,C,R,j){return typeof v!="function"?v:function(){var G=vt;R&&tn(),Zn(C,!0);try{return v.apply(this,arguments)}finally{Zn(G,!1),j&&queueMicrotask(ca)}}}function bt(v){Promise===st&&Or.echoes===0?Ba===0?v():enqueueNativeMicroTask(v):setTimeout(v,0)}(""+dt).indexOf("[native code]")===-1&&(tn=ca=xe);var Mt=zt.reject,zr="",rn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",jr="String expected.",ir=[],Kn="__dbnames",Hn="readonly",Tt="readwrite";function qt(v,C){return v?C?function(){return v.apply(this,arguments)&&C.apply(this,arguments)}:v:C}var Lr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Gr(v){return typeof v!="string"||/\./.test(v)?function(C){return C}:function(C){return C[v]===void 0&&v in C&&delete(C=X(C))[v],C}}function Gn(){throw Te.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function vr(v,C){try{var R=Fa(v),j=Fa(C);if(R!==j)return R==="Array"?1:j==="Array"?-1:R==="binary"?1:j==="binary"?-1:R==="string"?1:j==="string"?-1:R==="Date"?1:j!=="Date"?NaN:-1;switch(R){case"number":case"Date":case"string":return C<v?1:v<C?-1:0;case"binary":return(function(G,J){for(var le=G.length,ge=J.length,Ee=le<ge?le:ge,Re=0;Re<Ee;++Re)if(G[Re]!==J[Re])return G[Re]<J[Re]?-1:1;return le===ge?0:le<ge?-1:1})(ua(v),ua(C));case"Array":return(function(G,J){for(var le=G.length,ge=J.length,Ee=le<ge?le:ge,Re=0;Re<Ee;++Re){var $e=vr(G[Re],J[Re]);if($e!==0)return $e}return le===ge?0:le<ge?-1:1})(v,C)}}catch{}return NaN}function Fa(v){var C=typeof v;return C!="object"?C:ArrayBuffer.isView(v)?"binary":(v=W(v),v==="ArrayBuffer"?"binary":v)}function ua(v){return v instanceof Uint8Array?v:ArrayBuffer.isView(v)?new Uint8Array(v.buffer,v.byteOffset,v.byteLength):new Uint8Array(v)}function yn(v,C,R){var j=v.schema.yProps;return j?(C&&0<R.numFailures&&(C=C.filter(function(G,J){return!R.failures[J]})),Promise.all(j.map(function(G){return G=G.updatesTable,C?v.db.table(G).where("k").anyOf(C).delete():v.db.table(G).clear()})).then(function(){return R})):R}var xa=(ko.prototype.execute=function(v){var C=this["@@propmod"];if(C.add!==void 0){var R=C.add;if(l(R))return a(a([],l(v)?v:[],!0),R).sort();if(typeof R=="number")return(Number(v)||0)+R;if(typeof R=="bigint")try{return BigInt(v)+R}catch{return BigInt(0)+R}throw new TypeError("Invalid term ".concat(R))}if(C.remove!==void 0){var j=C.remove;if(l(j))return l(v)?v.filter(function(G){return!j.includes(G)}).sort():[];if(typeof j=="number")return Number(v)-j;if(typeof j=="bigint")try{return BigInt(v)-j}catch{return BigInt(0)-j}throw new TypeError("Invalid subtrahend ".concat(j))}return R=(R=C.replacePrefix)===null||R===void 0?void 0:R[0],R&&typeof v=="string"&&v.startsWith(R)?C.replacePrefix[1]+v.substring(R.length):v},ko);function ko(v){this["@@propmod"]=v}function ci(v,C){for(var R=i(C),j=R.length,G=!1,J=0;J<j;++J){var le=R[J],ge=C[le],Ee=B(v,le);ge instanceof xa?(M(v,le,ge.execute(Ee)),G=!0):Ee!==ge&&(M(v,le,ge),G=!0)}return G}var Ii=(_r.prototype._trans=function(v,C,R){var j=this._tx||vt.trans,G=this.name,J=er&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(v==="readonly"?"read":"write"," ").concat(this.name));function le(Re,$e,ke){if(!ke.schema[G])throw new Te.NotFound("Table "+G+" not part of transaction");return C(ke.idbtrans,ke)}var ge=Kr();try{var Ee=j&&j.db._novip===this.db._novip?j===vt.trans?j._promise(v,le,R):an(function(){return j._promise(v,le,R)},{trans:j,transless:vt.transless||vt}):(function Re($e,ke,Ue,Pe){if($e.idbdb&&($e._state.openComplete||vt.letThrough||$e._vip)){var je=$e._createTransaction(ke,Ue,$e._dbSchema);try{je.create(),$e._state.PR1398_maxLoop=3}catch(Be){return Be.name===fe.InvalidState&&$e.isOpen()&&0<--$e._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$e.close({disableAutoOpen:!1}),$e.open().then(function(){return Re($e,ke,Ue,Pe)})):Mt(Be)}return je._promise(ke,function(Be,Fe){return an(function(){return vt.trans=je,Pe(Be,Fe,je)})}).then(function(Be){if(ke==="readwrite")try{je.idbtrans.commit()}catch{}return ke==="readonly"?Be:je._completion.then(function(){return Be})})}if($e._state.openComplete)return Mt(new Te.DatabaseClosed($e._state.dbOpenError));if(!$e._state.isBeingOpened){if(!$e._state.autoOpen)return Mt(new Te.DatabaseClosed);$e.open().catch(xe)}return $e._state.dbReadyPromise.then(function(){return Re($e,ke,Ue,Pe)})})(this.db,v,[this.name],le);return J&&(Ee._consoleTask=J,Ee=Ee.catch(function(Re){return console.trace(Re),Mt(Re)})),Ee}finally{ge&&Xr()}},_r.prototype.get=function(v,C){var R=this;return v&&v.constructor===Object?this.where(v).first(C):v==null?Mt(new Te.Type("Invalid argument to Table.get()")):this._trans("readonly",function(j){return R.core.get({trans:j,key:v}).then(function(G){return R.hook.reading.fire(G)})}).then(C)},_r.prototype.where=function(v){if(typeof v=="string")return new this.db.WhereClause(this,v);if(l(v))return new this.db.WhereClause(this,"[".concat(v.join("+"),"]"));var C=i(v);if(C.length===1)return this.where(C[0]).equals(v[C[0]]);var R=this.schema.indexes.concat(this.schema.primKey).filter(function(ge){if(ge.compound&&C.every(function(Re){return 0<=ge.keyPath.indexOf(Re)})){for(var Ee=0;Ee<C.length;++Ee)if(C.indexOf(ge.keyPath[Ee])===-1)return!1;return!0}return!1}).sort(function(ge,Ee){return ge.keyPath.length-Ee.keyPath.length})[0];if(R&&this.db._maxKey!==zr){var J=R.keyPath.slice(0,C.length);return this.where(J).equals(J.map(function(Ee){return v[Ee]}))}!R&&er&&console.warn("The query ".concat(JSON.stringify(v)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(C.join("+"),"]"));var j=this.schema.idxByName;function G(ge,Ee){return vr(ge,Ee)===0}var le=C.reduce(function(ke,Ee){var Re=ke[0],$e=ke[1],ke=j[Ee],Ue=v[Ee];return[Re||ke,Re||!ke?qt($e,ke&&ke.multi?function(Pe){return Pe=B(Pe,Ee),l(Pe)&&Pe.some(function(je){return G(Ue,je)})}:function(Pe){return G(Ue,B(Pe,Ee))}):$e]},[null,null]),J=le[0],le=le[1];return J?this.where(J.name).equals(v[J.keyPath]).filter(le):R?this.filter(le):this.where(C).equals("")},_r.prototype.filter=function(v){return this.toCollection().and(v)},_r.prototype.count=function(v){return this.toCollection().count(v)},_r.prototype.offset=function(v){return this.toCollection().offset(v)},_r.prototype.limit=function(v){return this.toCollection().limit(v)},_r.prototype.each=function(v){return this.toCollection().each(v)},_r.prototype.toArray=function(v){return this.toCollection().toArray(v)},_r.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},_r.prototype.orderBy=function(v){return new this.db.Collection(new this.db.WhereClause(this,l(v)?"[".concat(v.join("+"),"]"):v))},_r.prototype.reverse=function(){return this.toCollection().reverse()},_r.prototype.mapToClass=function(v){var C,R=this.db,j=this.name;function G(){return C!==null&&C.apply(this,arguments)||this}(this.schema.mappedClass=v).prototype instanceof Gn&&((function(Ee,Re){if(typeof Re!="function"&&Re!==null)throw new TypeError("Class extends value "+String(Re)+" is not a constructor or null");function $e(){this.constructor=Ee}r(Ee,Re),Ee.prototype=Re===null?Object.create(Re):($e.prototype=Re.prototype,new $e)})(G,C=v),Object.defineProperty(G.prototype,"db",{get:function(){return R},enumerable:!1,configurable:!0}),G.prototype.table=function(){return j},v=G);for(var J=new Set,le=v.prototype;le;le=d(le))Object.getOwnPropertyNames(le).forEach(function(Ee){return J.add(Ee)});function ge(Ee){if(!Ee)return Ee;var Re,$e=Object.create(v.prototype);for(Re in Ee)if(!J.has(Re))try{$e[Re]=Ee[Re]}catch{}return $e}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=ge,this.hook("reading",ge),v},_r.prototype.defineClass=function(){return this.mapToClass(function(v){c(this,v)})},_r.prototype.add=function(v,C){var R=this,j=this.schema.primKey,G=j.auto,J=j.keyPath,le=v;return J&&G&&(le=Gr(J)(v)),this._trans("readwrite",function(ge){return R.core.mutate({trans:ge,type:"add",keys:C!=null?[C]:null,values:[le]})}).then(function(ge){return ge.numFailures?zt.reject(ge.failures[0]):ge.lastResult}).then(function(ge){if(J)try{M(v,J,ge)}catch{}return ge})},_r.prototype.upsert=function(v,C){var R=this,j=this.schema.primKey.keyPath;return this._trans("readwrite",function(G){return R.core.get({trans:G,key:v}).then(function(J){var le=J??{};return ci(le,C),j&&M(le,j,v),R.core.mutate({trans:G,type:"put",values:[le],keys:[v],upsert:!0,updates:{keys:[v],changeSpecs:[C]}}).then(function(ge){return ge.numFailures?zt.reject(ge.failures[0]):!!J})})})},_r.prototype.update=function(v,C){return typeof v!="object"||l(v)?this.where(":id").equals(v).modify(C):(v=B(v,this.schema.primKey.keyPath),v===void 0?Mt(new Te.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(v).modify(C))},_r.prototype.put=function(v,C){var R=this,j=this.schema.primKey,G=j.auto,J=j.keyPath,le=v;return J&&G&&(le=Gr(J)(v)),this._trans("readwrite",function(ge){return R.core.mutate({trans:ge,type:"put",values:[le],keys:C!=null?[C]:null})}).then(function(ge){return ge.numFailures?zt.reject(ge.failures[0]):ge.lastResult}).then(function(ge){if(J)try{M(v,J,ge)}catch{}return ge})},_r.prototype.delete=function(v){var C=this;return this._trans("readwrite",function(R){return C.core.mutate({trans:R,type:"delete",keys:[v]}).then(function(j){return yn(C,[v],j)}).then(function(j){return j.numFailures?zt.reject(j.failures[0]):void 0})})},_r.prototype.clear=function(){var v=this;return this._trans("readwrite",function(C){return v.core.mutate({trans:C,type:"deleteRange",range:Lr}).then(function(R){return yn(v,null,R)})}).then(function(C){return C.numFailures?zt.reject(C.failures[0]):void 0})},_r.prototype.bulkGet=function(v){var C=this;return this._trans("readonly",function(R){return C.core.getMany({keys:v,trans:R}).then(function(j){return j.map(function(G){return C.hook.reading.fire(G)})})})},_r.prototype.bulkAdd=function(v,C,R){var j=this,G=Array.isArray(C)?C:void 0,J=(R=R||(G?void 0:C))?R.allKeys:void 0;return this._trans("readwrite",function(le){var Re=j.schema.primKey,ge=Re.auto,Re=Re.keyPath;if(Re&&G)throw new Te.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(G&&G.length!==v.length)throw new Te.InvalidArgument("Arguments objects and keys must have the same length");var Ee=v.length,Re=Re&&ge?v.map(Gr(Re)):v;return j.core.mutate({trans:le,type:"add",keys:G,values:Re,wantResults:J}).then(function(je){var ke=je.numFailures,Ue=je.results,Pe=je.lastResult,je=je.failures;if(ke===0)return J?Ue:Pe;throw new Ae("".concat(j.name,".bulkAdd(): ").concat(ke," of ").concat(Ee," operations failed"),je)})})},_r.prototype.bulkPut=function(v,C,R){var j=this,G=Array.isArray(C)?C:void 0,J=(R=R||(G?void 0:C))?R.allKeys:void 0;return this._trans("readwrite",function(le){var Re=j.schema.primKey,ge=Re.auto,Re=Re.keyPath;if(Re&&G)throw new Te.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(G&&G.length!==v.length)throw new Te.InvalidArgument("Arguments objects and keys must have the same length");var Ee=v.length,Re=Re&&ge?v.map(Gr(Re)):v;return j.core.mutate({trans:le,type:"put",keys:G,values:Re,wantResults:J}).then(function(je){var ke=je.numFailures,Ue=je.results,Pe=je.lastResult,je=je.failures;if(ke===0)return J?Ue:Pe;throw new Ae("".concat(j.name,".bulkPut(): ").concat(ke," of ").concat(Ee," operations failed"),je)})})},_r.prototype.bulkUpdate=function(v){var C=this,R=this.core,j=v.map(function(le){return le.key}),G=v.map(function(le){return le.changes}),J=[];return this._trans("readwrite",function(le){return R.getMany({trans:le,keys:j,cache:"clone"}).then(function(ge){var Ee=[],Re=[];v.forEach(function(ke,Ue){var Pe=ke.key,je=ke.changes,Be=ge[Ue];if(Be){for(var Fe=0,Le=Object.keys(je);Fe<Le.length;Fe++){var V=Le[Fe],at=je[V];if(V===C.schema.primKey.keyPath){if(vr(at,Pe)!==0)throw new Te.Constraint("Cannot update primary key in bulkUpdate()")}else M(Be,V,at)}J.push(Ue),Ee.push(Pe),Re.push(Be)}});var $e=Ee.length;return R.mutate({trans:le,type:"put",keys:Ee,values:Re,updates:{keys:j,changeSpecs:G}}).then(function(ke){var Ue=ke.numFailures,Pe=ke.failures;if(Ue===0)return $e;for(var je=0,Be=Object.keys(Pe);je<Be.length;je++){var Fe,Le=Be[je],V=J[Number(Le)];V!=null&&(Fe=Pe[Le],delete Pe[Le],Pe[V]=Fe)}throw new Ae("".concat(C.name,".bulkUpdate(): ").concat(Ue," of ").concat($e," operations failed"),Pe)})})})},_r.prototype.bulkDelete=function(v){var C=this,R=v.length;return this._trans("readwrite",function(j){return C.core.mutate({trans:j,type:"delete",keys:v}).then(function(G){return yn(C,v,G)})}).then(function(le){var G=le.numFailures,J=le.lastResult,le=le.failures;if(G===0)return J;throw new Ae("".concat(C.name,".bulkDelete(): ").concat(G," of ").concat(R," operations failed"),le)})},_r);function _r(){}function Cs(v){function C(le,ge){if(ge){for(var Ee=arguments.length,Re=new Array(Ee-1);--Ee;)Re[Ee-1]=arguments[Ee];return R[le].subscribe.apply(null,Re),v}if(typeof le=="string")return R[le]}var R={};C.addEventType=J;for(var j=1,G=arguments.length;j<G;++j)J(arguments[j]);return C;function J(le,ge,Ee){if(typeof le!="object"){var Re;ge=ge||mt;var $e={subscribers:[],fire:Ee=Ee||xe,subscribe:function(ke){$e.subscribers.indexOf(ke)===-1&&($e.subscribers.push(ke),$e.fire=ge($e.fire,ke))},unsubscribe:function(ke){$e.subscribers=$e.subscribers.filter(function(Ue){return Ue!==ke}),$e.fire=$e.subscribers.reduce(ge,Ee)}};return R[le]=C[le]=$e}i(Re=le).forEach(function(ke){var Ue=Re[ke];if(l(Ue))J(ke,Re[ke][0],Re[ke][1]);else{if(Ue!=="asap")throw new Te.InvalidArgument("Invalid event config");var Pe=J(ke,me,function(){for(var je=arguments.length,Be=new Array(je);je--;)Be[je]=arguments[je];Pe.subscribers.forEach(function(Fe){D(function(){Fe.apply(null,Be)})})})}})}}function da(v,C){return w(C).from({prototype:v}),C}function Fs(v,C){return!(v.filter||v.algorithm||v.or)&&(C?v.justLimit:!v.replayFilter)}function ui(v,C){v.filter=qt(v.filter,C)}function cs(v,C,R){var j=v.replayFilter;v.replayFilter=j?function(){return qt(j(),C())}:C,v.justLimit=R&&!j}function An(v,C){if(v.isPrimKey)return C.primaryKey;var R=C.getIndexByKeyPath(v.index);if(!R)throw new Te.Schema("KeyPath "+v.index+" on object store "+C.name+" is not indexed");return R}function To(v,C,R){var j=An(v,C.schema);return C.openCursor({trans:R,values:!v.keysOnly,reverse:v.dir==="prev",unique:!!v.unique,query:{index:j,range:v.range}})}function zs(v,C,R,j){var G=v.replayFilter?qt(v.filter,v.replayFilter()):v.filter;if(v.or){var J={},le=function(ge,Ee,Re){var $e,ke;G&&!G(Ee,Re,function(Ue){return Ee.stop(Ue)},function(Ue){return Ee.fail(Ue)})||((ke=""+($e=Ee.primaryKey))=="[object ArrayBuffer]"&&(ke=""+new Uint8Array($e)),g(J,ke)||(J[ke]=!0,C(ge,Ee,Re)))};return Promise.all([v.or._iterate(le,R),kr(To(v,j,R),v.algorithm,le,!v.keysOnly&&v.valueMapper)])}return kr(To(v,j,R),qt(v.algorithm,G),C,!v.keysOnly&&v.valueMapper)}function kr(v,C,R,j){var G=Qt(j?function(J,le,ge){return R(j(J),le,ge)}:R);return v.then(function(J){if(J)return J.start(function(){var le=function(){return J.continue()};C&&!C(J,function(ge){return le=ge},function(ge){J.stop(ge),le=xe},function(ge){J.fail(ge),le=xe})||G(J.value,J,function(ge){return le=ge}),le()})})}var di=(wr.prototype._read=function(v,C){var R=this._ctx;return R.error?R.table._trans(null,Mt.bind(null,R.error)):R.table._trans("readonly",v).then(C)},wr.prototype._write=function(v){var C=this._ctx;return C.error?C.table._trans(null,Mt.bind(null,C.error)):C.table._trans("readwrite",v,"locked")},wr.prototype._addAlgorithm=function(v){var C=this._ctx;C.algorithm=qt(C.algorithm,v)},wr.prototype._iterate=function(v,C){return zs(this._ctx,v,C,this._ctx.table.core)},wr.prototype.clone=function(v){var C=Object.create(this.constructor.prototype),R=Object.create(this._ctx);return v&&c(R,v),C._ctx=R,C},wr.prototype.raw=function(){return this._ctx.valueMapper=null,this},wr.prototype.each=function(v){var C=this._ctx;return this._read(function(R){return zs(C,v,R,C.table.core)})},wr.prototype.count=function(v){var C=this;return this._read(function(R){var j=C._ctx,G=j.table.core;if(Fs(j,!0))return G.count({trans:R,query:{index:An(j,G.schema),range:j.range}}).then(function(le){return Math.min(le,j.limit)});var J=0;return zs(j,function(){return++J,!1},R,G).then(function(){return J})}).then(v)},wr.prototype.sortBy=function(v,C){var R=v.split(".").reverse(),j=R[0],G=R.length-1;function J(Ee,Re){return Re?J(Ee[R[Re]],Re-1):Ee[j]}var le=this._ctx.dir==="next"?1:-1;function ge(Ee,Re){return vr(J(Ee,G),J(Re,G))*le}return this.toArray(function(Ee){return Ee.sort(ge)}).then(C)},wr.prototype.toArray=function(v){var C=this;return this._read(function(R){var j=C._ctx;if(j.dir==="next"&&Fs(j,!0)&&0<j.limit){var G=j.valueMapper,J=An(j,j.table.core.schema);return j.table.core.query({trans:R,limit:j.limit,values:!0,query:{index:J,range:j.range}}).then(function(ge){return ge=ge.result,G?ge.map(G):ge})}var le=[];return zs(j,function(ge){return le.push(ge)},R,j.table.core).then(function(){return le})},v)},wr.prototype.offset=function(v){var C=this._ctx;return v<=0||(C.offset+=v,Fs(C)?cs(C,function(){var R=v;return function(j,G){return R===0||(R===1?--R:G(function(){j.advance(R),R=0}),!1)}}):cs(C,function(){var R=v;return function(){return--R<0}})),this},wr.prototype.limit=function(v){return this._ctx.limit=Math.min(this._ctx.limit,v),cs(this._ctx,function(){var C=v;return function(R,j,G){return--C<=0&&j(G),0<=C}},!0),this},wr.prototype.until=function(v,C){return ui(this._ctx,function(R,j,G){return!v(R.value)||(j(G),C)}),this},wr.prototype.first=function(v){return this.limit(1).toArray(function(C){return C[0]}).then(v)},wr.prototype.last=function(v){return this.reverse().first(v)},wr.prototype.filter=function(v){var C;return ui(this._ctx,function(R){return v(R.value)}),(C=this._ctx).isMatch=qt(C.isMatch,v),this},wr.prototype.and=function(v){return this.filter(v)},wr.prototype.or=function(v){return new this.db.WhereClause(this._ctx.table,v,this)},wr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},wr.prototype.desc=function(){return this.reverse()},wr.prototype.eachKey=function(v){var C=this._ctx;return C.keysOnly=!C.isMatch,this.each(function(R,j){v(j.key,j)})},wr.prototype.eachUniqueKey=function(v){return this._ctx.unique="unique",this.eachKey(v)},wr.prototype.eachPrimaryKey=function(v){var C=this._ctx;return C.keysOnly=!C.isMatch,this.each(function(R,j){v(j.primaryKey,j)})},wr.prototype.keys=function(v){var C=this._ctx;C.keysOnly=!C.isMatch;var R=[];return this.each(function(j,G){R.push(G.key)}).then(function(){return R}).then(v)},wr.prototype.primaryKeys=function(v){var C=this._ctx;if(C.dir==="next"&&Fs(C,!0)&&0<C.limit)return this._read(function(j){var G=An(C,C.table.core.schema);return C.table.core.query({trans:j,values:!1,limit:C.limit,query:{index:G,range:C.range}})}).then(function(j){return j.result}).then(v);C.keysOnly=!C.isMatch;var R=[];return this.each(function(j,G){R.push(G.primaryKey)}).then(function(){return R}).then(v)},wr.prototype.uniqueKeys=function(v){return this._ctx.unique="unique",this.keys(v)},wr.prototype.firstKey=function(v){return this.limit(1).keys(function(C){return C[0]}).then(v)},wr.prototype.lastKey=function(v){return this.reverse().firstKey(v)},wr.prototype.distinct=function(){var v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];if(!v||!v.multi)return this;var C={};return ui(this._ctx,function(G){var j=G.primaryKey.toString(),G=g(C,j);return C[j]=!0,!G}),this},wr.prototype.modify=function(v){var C=this,R=this._ctx;return this._write(function(j){var G=typeof v=="function"?v:function(Be){return ci(Be,v)},J=R.table.core,Re=J.schema.primaryKey,le=Re.outbound,ge=Re.extractKey,Ee=200,Re=C.db._options.modifyChunkSize;Re&&(Ee=typeof Re=="object"?Re[J.name]||Re["*"]||200:Re);function $e(Be,V){var Le=V.failures,V=V.numFailures;Ue+=Be-V;for(var at=0,ot=i(Le);at<ot.length;at++){var jt=ot[at];ke.push(Le[jt])}}var ke=[],Ue=0,Pe=[],je=v===xn;return C.clone().primaryKeys().then(function(Be){function Fe(V){var at=Math.min(Ee,Be.length-V),ot=Be.slice(V,V+at);return(je?Promise.resolve([]):J.getMany({trans:j,keys:ot,cache:"immutable"})).then(function(jt){var Ht=[],Lt=[],Ft=le?[]:null,Wt=je?ot:[];if(!je)for(var Et=0;Et<at;++Et){var nr=jt[Et],Xe={value:X(nr),primKey:Be[V+Et]};G.call(Xe,Xe.value,Xe)!==!1&&(Xe.value==null?Wt.push(Be[V+Et]):le||vr(ge(nr),ge(Xe.value))===0?(Lt.push(Xe.value),le&&Ft.push(Be[V+Et])):(Wt.push(Be[V+Et]),Ht.push(Xe.value)))}return Promise.resolve(0<Ht.length&&J.mutate({trans:j,type:"add",values:Ht}).then(function(_e){for(var Ve in _e.failures)Wt.splice(parseInt(Ve),1);$e(Ht.length,_e)})).then(function(){return(0<Lt.length||Le&&typeof v=="object")&&J.mutate({trans:j,type:"put",keys:Ft,values:Lt,criteria:Le,changeSpec:typeof v!="function"&&v,isAdditionalChunk:0<V}).then(function(_e){return $e(Lt.length,_e)})}).then(function(){return(0<Wt.length||Le&&je)&&J.mutate({trans:j,type:"delete",keys:Wt,criteria:Le,isAdditionalChunk:0<V}).then(function(_e){return yn(R.table,Wt,_e)}).then(function(_e){return $e(Wt.length,_e)})}).then(function(){return Be.length>V+at&&Fe(V+Ee)})})}var Le=Fs(R)&&R.limit===1/0&&(typeof v!="function"||je)&&{index:R.index,range:R.range};return Fe(0).then(function(){if(0<ke.length)throw new ye("Error modifying one or more objects",ke,Ue,Pe);return Be.length})})})},wr.prototype.delete=function(){var v=this._ctx,C=v.range;return!Fs(v)||v.table.schema.yProps||!v.isPrimKey&&C.type!==3?this.modify(xn):this._write(function(R){var j=v.table.core.schema.primaryKey,G=C;return v.table.core.count({trans:R,query:{index:j,range:G}}).then(function(J){return v.table.core.mutate({trans:R,type:"deleteRange",range:G}).then(function(Ee){var ge=Ee.failures,Ee=Ee.numFailures;if(Ee)throw new ye("Could not delete some values",Object.keys(ge).map(function(Re){return ge[Re]}),J-Ee);return J-Ee})})})},wr);function wr(){}var xn=function(v,C){return C.value=null};function $s(v,C){return v<C?-1:v===C?0:1}function Us(v,C){return C<v?-1:v===C?0:1}function ha(v,C,R){return v=v instanceof Vr?new v.Collection(v):v,v._ctx.error=new(R||TypeError)(C),v}function Nn(v){return new v.Collection(v,function(){return Pr("")}).limit(0)}function Bt(v,C,R,j){var G,J,le,ge,Ee,Re,$e,ke=R.length;if(!R.every(function(je){return typeof je=="string"}))return ha(v,jr);function Ue(je){G=je==="next"?function(Fe){return Fe.toUpperCase()}:function(Fe){return Fe.toLowerCase()},J=je==="next"?function(Fe){return Fe.toLowerCase()}:function(Fe){return Fe.toUpperCase()},le=je==="next"?$s:Us;var Be=R.map(function(Fe){return{lower:J(Fe),upper:G(Fe)}}).sort(function(Fe,Le){return le(Fe.lower,Le.lower)});ge=Be.map(function(Fe){return Fe.upper}),Ee=Be.map(function(Fe){return Fe.lower}),$e=(Re=je)==="next"?"":j}Ue("next"),v=new v.Collection(v,function(){return ar(ge[0],Ee[ke-1]+j)}),v._ondirectionchange=function(je){Ue(je)};var Pe=0;return v._addAlgorithm(function(je,Be,Fe){var Le=je.key;if(typeof Le!="string")return!1;var V=J(Le);if(C(V,Ee,Pe))return!0;for(var at=null,ot=Pe;ot<ke;++ot){var jt=(function(Ht,Lt,Ft,Wt,Et,nr){for(var Xe=Math.min(Ht.length,Wt.length),_e=-1,Ve=0;Ve<Xe;++Ve){var Xt=Lt[Ve];if(Xt!==Wt[Ve])return Et(Ht[Ve],Ft[Ve])<0?Ht.substr(0,Ve)+Ft[Ve]+Ft.substr(Ve+1):Et(Ht[Ve],Wt[Ve])<0?Ht.substr(0,Ve)+Wt[Ve]+Ft.substr(Ve+1):0<=_e?Ht.substr(0,_e)+Lt[_e]+Ft.substr(_e+1):null;Et(Ht[Ve],Xt)<0&&(_e=Ve)}return Xe<Wt.length&&nr==="next"?Ht+Ft.substr(Ht.length):Xe<Ht.length&&nr==="prev"?Ht.substr(0,Ft.length):_e<0?null:Ht.substr(0,_e)+Wt[_e]+Ft.substr(_e+1)})(Le,V,ge[ot],Ee[ot],le,Re);jt===null&&at===null?Pe=ot+1:(at===null||0<le(at,jt))&&(at=jt)}return Be(at!==null?function(){je.continue(at+$e)}:Fe),!1}),v}function ar(v,C,R,j){return{type:2,lower:v,upper:C,lowerOpen:R,upperOpen:j}}function Pr(v){return{type:1,lower:v,upper:v}}var Vr=(Object.defineProperty($r.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),$r.prototype.between=function(v,C,R,j){R=R!==!1,j=j===!0;try{return 0<this._cmp(v,C)||this._cmp(v,C)===0&&(R||j)&&(!R||!j)?Nn(this):new this.Collection(this,function(){return ar(v,C,!R,!j)})}catch{return ha(this,rn)}},$r.prototype.equals=function(v){return v==null?ha(this,rn):new this.Collection(this,function(){return Pr(v)})},$r.prototype.above=function(v){return v==null?ha(this,rn):new this.Collection(this,function(){return ar(v,void 0,!0)})},$r.prototype.aboveOrEqual=function(v){return v==null?ha(this,rn):new this.Collection(this,function(){return ar(v,void 0,!1)})},$r.prototype.below=function(v){return v==null?ha(this,rn):new this.Collection(this,function(){return ar(void 0,v,!1,!0)})},$r.prototype.belowOrEqual=function(v){return v==null?ha(this,rn):new this.Collection(this,function(){return ar(void 0,v)})},$r.prototype.startsWith=function(v){return typeof v!="string"?ha(this,jr):this.between(v,v+zr,!0,!0)},$r.prototype.startsWithIgnoreCase=function(v){return v===""?this.startsWith(v):Bt(this,function(C,R){return C.indexOf(R[0])===0},[v],zr)},$r.prototype.equalsIgnoreCase=function(v){return Bt(this,function(C,R){return C===R[0]},[v],"")},$r.prototype.anyOfIgnoreCase=function(){var v=O.apply(ve,arguments);return v.length===0?Nn(this):Bt(this,function(C,R){return R.indexOf(C)!==-1},v,"")},$r.prototype.startsWithAnyOfIgnoreCase=function(){var v=O.apply(ve,arguments);return v.length===0?Nn(this):Bt(this,function(C,R){return R.some(function(j){return C.indexOf(j)===0})},v,zr)},$r.prototype.anyOf=function(){var v=this,C=O.apply(ve,arguments),R=this._cmp;try{C.sort(R)}catch{return ha(this,rn)}if(C.length===0)return Nn(this);var j=new this.Collection(this,function(){return ar(C[0],C[C.length-1])});j._ondirectionchange=function(J){R=J==="next"?v._ascending:v._descending,C.sort(R)};var G=0;return j._addAlgorithm(function(J,le,ge){for(var Ee=J.key;0<R(Ee,C[G]);)if(++G===C.length)return le(ge),!1;return R(Ee,C[G])===0||(le(function(){J.continue(C[G])}),!1)}),j},$r.prototype.notEqual=function(v){return this.inAnyRange([[-1/0,v],[v,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},$r.prototype.noneOf=function(){var v=O.apply(ve,arguments);if(v.length===0)return new this.Collection(this);try{v.sort(this._ascending)}catch{return ha(this,rn)}var C=v.reduce(function(R,j){return R?R.concat([[R[R.length-1][1],j]]):[[-1/0,j]]},null);return C.push([v[v.length-1],this.db._maxKey]),this.inAnyRange(C,{includeLowers:!1,includeUppers:!1})},$r.prototype.inAnyRange=function(Le,C){var R=this,j=this._cmp,G=this._ascending,J=this._descending,le=this._min,ge=this._max;if(Le.length===0)return Nn(this);if(!Le.every(function(V){return V[0]!==void 0&&V[1]!==void 0&&G(V[0],V[1])<=0}))return ha(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Te.InvalidArgument);var Ee=!C||C.includeLowers!==!1,Re=C&&C.includeUppers===!0,$e,ke=G;function Ue(V,at){return ke(V[0],at[0])}try{($e=Le.reduce(function(V,at){for(var ot=0,jt=V.length;ot<jt;++ot){var Ht=V[ot];if(j(at[0],Ht[1])<0&&0<j(at[1],Ht[0])){Ht[0]=le(Ht[0],at[0]),Ht[1]=ge(Ht[1],at[1]);break}}return ot===jt&&V.push(at),V},[])).sort(Ue)}catch{return ha(this,rn)}var Pe=0,je=Re?function(V){return 0<G(V,$e[Pe][1])}:function(V){return 0<=G(V,$e[Pe][1])},Be=Ee?function(V){return 0<J(V,$e[Pe][0])}:function(V){return 0<=J(V,$e[Pe][0])},Fe=je,Le=new this.Collection(this,function(){return ar($e[0][0],$e[$e.length-1][1],!Ee,!Re)});return Le._ondirectionchange=function(V){ke=V==="next"?(Fe=je,G):(Fe=Be,J),$e.sort(Ue)},Le._addAlgorithm(function(V,at,ot){for(var jt,Ht=V.key;Fe(Ht);)if(++Pe===$e.length)return at(ot),!1;return!je(jt=Ht)&&!Be(jt)||(R._cmp(Ht,$e[Pe][1])===0||R._cmp(Ht,$e[Pe][0])===0||at(function(){ke===G?V.continue($e[Pe][0]):V.continue($e[Pe][1])}),!1)}),Le},$r.prototype.startsWithAnyOf=function(){var v=O.apply(ve,arguments);return v.every(function(C){return typeof C=="string"})?v.length===0?Nn(this):this.inAnyRange(v.map(function(C){return[C,C+zr]})):ha(this,"startsWithAnyOf() only works with strings")},$r);function $r(){}function jn(v){return Qt(function(C){return hi(C),v(C.target.error),!1})}function hi(v){v.stopPropagation&&v.stopPropagation(),v.preventDefault&&v.preventDefault()}var Es="storagemutated",_s="x-storagemutated-1",Aa=Cs(null,Es),$l=(za.prototype._lock=function(){return F(!vt.global),++this._reculock,this._reculock!==1||vt.global||(vt.lockOwnerFor=this),this},za.prototype._unlock=function(){if(F(!vt.global),--this._reculock==0)for(vt.global||(vt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var v=this._blockedFuncs.shift();try{rr(v[1],v[0])}catch{}}return this},za.prototype._locked=function(){return this._reculock&&vt.lockOwnerFor!==this},za.prototype.create=function(v){var C=this;if(!this.mode)return this;var R=this.db.idbdb,j=this.db._state.dbOpenError;if(F(!this.idbtrans),!v&&!R)switch(j&&j.name){case"DatabaseClosedError":throw new Te.DatabaseClosed(j);case"MissingAPIError":throw new Te.MissingAPI(j.message,j);default:throw new Te.OpenFailed(j)}if(!this.active)throw new Te.TransactionInactive;return F(this._completion._state===null),(v=this.idbtrans=v||(this.db.core||R).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Qt(function(G){hi(G),C._reject(v.error)}),v.onabort=Qt(function(G){hi(G),C.active&&C._reject(new Te.Abort(v.error)),C.active=!1,C.on("abort").fire(G)}),v.oncomplete=Qt(function(){C.active=!1,C._resolve(),"mutatedParts"in v&&Aa.storagemutated.fire(v.mutatedParts)}),this},za.prototype._promise=function(v,C,R){var j=this;if(v==="readwrite"&&this.mode!=="readwrite")return Mt(new Te.ReadOnly("Transaction is readonly"));if(!this.active)return Mt(new Te.TransactionInactive);if(this._locked())return new zt(function(J,le){j._blockedFuncs.push([function(){j._promise(v,C,R).then(J,le)},vt])});if(R)return an(function(){var J=new zt(function(le,ge){j._lock();var Ee=C(le,ge,j);Ee&&Ee.then&&Ee.then(le,ge)});return J.finally(function(){return j._unlock()}),J._lib=!0,J});var G=new zt(function(J,le){var ge=C(J,le,j);ge&&ge.then&&ge.then(J,le)});return G._lib=!0,G},za.prototype._root=function(){return this.parent?this.parent._root():this},za.prototype.waitFor=function(v){var C,R=this._root(),j=zt.resolve(v);R._waitingFor?R._waitingFor=R._waitingFor.then(function(){return j}):(R._waitingFor=j,R._waitingQueue=[],C=R.idbtrans.objectStore(R.storeNames[0]),(function J(){for(++R._spinCount;R._waitingQueue.length;)R._waitingQueue.shift()();R._waitingFor&&(C.get(-1/0).onsuccess=J)})());var G=R._waitingFor;return new zt(function(J,le){j.then(function(ge){return R._waitingQueue.push(Qt(J.bind(null,ge)))},function(ge){return R._waitingQueue.push(Qt(le.bind(null,ge)))}).finally(function(){R._waitingFor===G&&(R._waitingFor=null)})})},za.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Te.Abort))},za.prototype.table=function(v){var C=this._memoizedTables||(this._memoizedTables={});if(g(C,v))return C[v];var R=this.schema[v];if(!R)throw new Te.NotFound("Table "+v+" not part of transaction");return R=new this.db.Table(v,R,this),R.core=this.db.core.table(v),C[v]=R},za);function za(){}function qs(v,C,R,j,G,J,le,ge){return{name:v,keyPath:C,unique:R,multi:j,auto:G,compound:J,src:(R&&!le?"&":"")+(j?"*":"")+(G?"++":"")+pi(C),type:ge}}function pi(v){return typeof v=="string"?v:v?"["+[].join.call(v,"+")+"]":""}function gi(v,C,R){return{name:v,primKey:C,indexes:R,mappedClass:null,idxByName:(j=function(G){return[G.name,G]},R.reduce(function(G,J,le){return le=j(J,le),le&&(G[le[0]]=le[1]),G},{}))};var j}var eo=function(v){try{return v.only([[]]),eo=function(){return[[]]},[[]]}catch{return eo=function(){return zr},zr}};function Co(v){return v==null?function(){}:typeof v=="string"?(C=v).split(".").length===1?function(R){return R[C]}:function(R){return B(R,C)}:function(R){return B(R,v)};var C}function fi(v){return[].slice.call(v)}var Qu=0;function pa(v){return v==null?":id":typeof v=="string"?v:"[".concat(v.join("+"),"]")}function Hs(v,C,Ee){function j(Fe){if(Fe.type===3)return null;if(Fe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Pe=Fe.lower,je=Fe.upper,Be=Fe.lowerOpen,Fe=Fe.upperOpen;return Pe===void 0?je===void 0?null:C.upperBound(je,!!Fe):je===void 0?C.lowerBound(Pe,!!Be):C.bound(Pe,je,!!Be,!!Fe)}function G(Ue){var Pe,je=Ue.name;return{name:je,schema:Ue,mutate:function(Be){var Fe=Be.trans,Le=Be.type,V=Be.keys,at=Be.values,ot=Be.range;return new Promise(function(jt,Ht){jt=Qt(jt);var Lt=Fe.objectStore(je),Ft=Lt.keyPath==null,Wt=Le==="put"||Le==="add";if(!Wt&&Le!=="delete"&&Le!=="deleteRange")throw new Error("Invalid operation type: "+Le);var Et,nr=(V||at||{length:1}).length;if(V&&at&&V.length!==at.length)throw new Error("Given keys array must have same length as given values array.");if(nr===0)return jt({numFailures:0,failures:{},results:[],lastResult:void 0});function Xe(Wr){++Xt,hi(Wr)}var _e=[],Ve=[],Xt=0;if(Le==="deleteRange"){if(ot.type===4)return jt({numFailures:Xt,failures:Ve,results:[],lastResult:void 0});ot.type===3?_e.push(Et=Lt.clear()):_e.push(Et=Lt.delete(j(ot)))}else{var Ft=Wt?Ft?[at,V]:[at,null]:[V,null],At=Ft[0],St=Ft[1];if(Wt)for(var Tr=0;Tr<nr;++Tr)_e.push(Et=St&&St[Tr]!==void 0?Lt[Le](At[Tr],St[Tr]):Lt[Le](At[Tr])),Et.onerror=Xe;else for(Tr=0;Tr<nr;++Tr)_e.push(Et=Lt[Le](At[Tr])),Et.onerror=Xe}function ta(Wr){Wr=Wr.target.result,_e.forEach(function(Jr,kn){return Jr.error!=null&&(Ve[kn]=Jr.error)}),jt({numFailures:Xt,failures:Ve,results:Le==="delete"?V:_e.map(function(Jr){return Jr.result}),lastResult:Wr})}Et.onerror=function(Wr){Xe(Wr),ta(Wr)},Et.onsuccess=ta})},getMany:function(Be){var Fe=Be.trans,Le=Be.keys;return new Promise(function(V,at){V=Qt(V);for(var ot,jt=Fe.objectStore(je),Ht=Le.length,Lt=new Array(Ht),Ft=0,Wt=0,Et=function(_e){_e=_e.target,Lt[_e._pos]=_e.result,++Wt===Ft&&V(Lt)},nr=jn(at),Xe=0;Xe<Ht;++Xe)Le[Xe]!=null&&((ot=jt.get(Le[Xe]))._pos=Xe,ot.onsuccess=Et,ot.onerror=nr,++Ft);Ft===0&&V(Lt)})},get:function(Be){var Fe=Be.trans,Le=Be.key;return new Promise(function(V,at){V=Qt(V);var ot=Fe.objectStore(je).get(Le);ot.onsuccess=function(jt){return V(jt.target.result)},ot.onerror=jn(at)})},query:(Pe=Re,function(Be){return new Promise(function(Fe,Le){Fe=Qt(Fe);var V,at,ot,Ft=Be.trans,jt=Be.values,Ht=Be.limit,Et=Be.query,Lt=Ht===1/0?void 0:Ht,Wt=Et.index,Et=Et.range,Ft=Ft.objectStore(je),Wt=Wt.isPrimaryKey?Ft:Ft.index(Wt.name),Et=j(Et);if(Ht===0)return Fe({result:[]});Pe?((Lt=jt?Wt.getAll(Et,Lt):Wt.getAllKeys(Et,Lt)).onsuccess=function(nr){return Fe({result:nr.target.result})},Lt.onerror=jn(Le)):(V=0,at=!jt&&"openKeyCursor"in Wt?Wt.openKeyCursor(Et):Wt.openCursor(Et),ot=[],at.onsuccess=function(nr){var Xe=at.result;return Xe?(ot.push(jt?Xe.value:Xe.primaryKey),++V===Ht?Fe({result:ot}):void Xe.continue()):Fe({result:ot})},at.onerror=jn(Le))})}),openCursor:function(Be){var Fe=Be.trans,Le=Be.values,V=Be.query,at=Be.reverse,ot=Be.unique;return new Promise(function(jt,Ht){jt=Qt(jt);var Wt=V.index,Lt=V.range,Ft=Fe.objectStore(je),Ft=Wt.isPrimaryKey?Ft:Ft.index(Wt.name),Wt=at?ot?"prevunique":"prev":ot?"nextunique":"next",Et=!Le&&"openKeyCursor"in Ft?Ft.openKeyCursor(j(Lt),Wt):Ft.openCursor(j(Lt),Wt);Et.onerror=jn(Ht),Et.onsuccess=Qt(function(nr){var Xe,_e,Ve,Xt,At=Et.result;At?(At.___id=++Qu,At.done=!1,Xe=At.continue.bind(At),_e=(_e=At.continuePrimaryKey)&&_e.bind(At),Ve=At.advance.bind(At),Xt=function(){throw new Error("Cursor not stopped")},At.trans=Fe,At.stop=At.continue=At.continuePrimaryKey=At.advance=function(){throw new Error("Cursor not started")},At.fail=Qt(Ht),At.next=function(){var St=this,Tr=1;return this.start(function(){return Tr--?St.continue():St.stop()}).then(function(){return St})},At.start=function(St){function Tr(){if(Et.result)try{St()}catch(Wr){At.fail(Wr)}else At.done=!0,At.start=function(){throw new Error("Cursor behind last entry")},At.stop()}var ta=new Promise(function(Wr,Jr){Wr=Qt(Wr),Et.onerror=jn(Jr),At.fail=Jr,At.stop=function(kn){At.stop=At.continue=At.continuePrimaryKey=At.advance=Xt,Wr(kn)}});return Et.onsuccess=Qt(function(Wr){Et.onsuccess=Tr,Tr()}),At.continue=Xe,At.continuePrimaryKey=_e,At.advance=Ve,Tr(),ta},jt(At)):jt(null)},Ht)})},count:function(Be){var Fe=Be.query,Le=Be.trans,V=Fe.index,at=Fe.range;return new Promise(function(ot,jt){var Ht=Le.objectStore(je),Lt=V.isPrimaryKey?Ht:Ht.index(V.name),Ht=j(at),Lt=Ht?Lt.count(Ht):Lt.count();Lt.onsuccess=Qt(function(Ft){return ot(Ft.target.result)}),Lt.onerror=jn(jt)})}}}var J,le,ge,$e=(le=Ee,ge=fi((J=v).objectStoreNames),{schema:{name:J.name,tables:ge.map(function(Ue){return le.objectStore(Ue)}).map(function(Ue){var Pe=Ue.keyPath,Fe=Ue.autoIncrement,je=l(Pe),Be={},Fe={name:Ue.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Pe==null,compound:je,keyPath:Pe,autoIncrement:Fe,unique:!0,extractKey:Co(Pe)},indexes:fi(Ue.indexNames).map(function(Le){return Ue.index(Le)}).map(function(ot){var V=ot.name,at=ot.unique,jt=ot.multiEntry,ot=ot.keyPath,jt={name:V,compound:l(ot),keyPath:ot,unique:at,multiEntry:jt,extractKey:Co(ot)};return Be[pa(ot)]=jt}),getIndexByKeyPath:function(Le){return Be[pa(Le)]}};return Be[":id"]=Fe.primaryKey,Pe!=null&&(Be[pa(Pe)]=Fe.primaryKey),Fe})},hasGetAll:0<ge.length&&"getAll"in le.objectStore(ge[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),Ee=$e.schema,Re=$e.hasGetAll,$e=Ee.tables.map(G),ke={};return $e.forEach(function(Ue){return ke[Ue.name]=Ue}),{stack:"dbcore",transaction:v.transaction.bind(v),table:function(Ue){if(!ke[Ue])throw new Error("Table '".concat(Ue,"' not found"));return ke[Ue]},MIN_KEY:-1/0,MAX_KEY:eo(C),schema:Ee}}function Eo(v,C,R,j){var G=R.IDBKeyRange;return R.indexedDB,{dbcore:(j=Hs(C,G,j),v.dbcore.reduce(function(J,le){return le=le.create,n(n({},J),le(J))},j))}}function mi(v,j){var R=j.db,j=Eo(v._middlewares,R,v._deps,j);v.core=j.dbcore,v.tables.forEach(function(G){var J=G.name;v.core.schema.tables.some(function(le){return le.name===J})&&(G.core=v.core.table(J),v[J]instanceof v.Table&&(v[J].core=G.core))})}function Ya(v,C,R,j){R.forEach(function(G){var J=j[G];C.forEach(function(le){var ge=(function Ee(Re,$e){return T(Re,$e)||(Re=d(Re))&&Ee(Re,$e)})(le,G);(!ge||"value"in ge&&ge.value===void 0)&&(le===v.Transaction.prototype||le instanceof v.Transaction?x(le,G,{get:function(){return this.table(G)},set:function(Ee){y(this,G,{value:Ee,writable:!0,configurable:!0,enumerable:!0})}}):le[G]=new v.Table(G,J))})})}function es(v,C){C.forEach(function(R){for(var j in R)R[j]instanceof v.Table&&delete R[j]})}function Gs(v,C){return v._cfg.version-C._cfg.version}function nl(v,C,R,j){var G=v._dbSchema;R.objectStoreNames.contains("$meta")&&!G.$meta&&(G.$meta=gi("$meta",Ku("")[0],[]),v._storeNames.push("$meta"));var J=v._createTransaction("readwrite",v._storeNames,G);J.create(R),J._completion.catch(j);var le=J._reject.bind(J),ge=vt.transless||vt;an(function(){return vt.trans=J,vt.transless=ge,C!==0?(mi(v,R),Re=C,((Ee=J).storeNames.includes("$meta")?Ee.table("$meta").get("version").then(function($e){return $e??Re}):zt.resolve(Re)).then(function($e){return Ue=$e,Pe=J,je=R,Be=[],$e=(ke=v)._versions,Fe=ke._dbSchema=yi(0,ke.idbdb,je),($e=$e.filter(function(Le){return Le._cfg.version>=Ue})).length!==0?($e.forEach(function(Le){Be.push(function(){var V=Fe,at=Le._cfg.dbschema;Hl(ke,V,je),Hl(ke,at,je),Fe=ke._dbSchema=at;var ot=al(V,at);ot.add.forEach(function(Wt){ql(je,Wt[0],Wt[1].primKey,Wt[1].indexes)}),ot.change.forEach(function(Wt){if(Wt.recreate)throw new Te.Upgrade("Not yet support for changing primary key");var Et=je.objectStore(Wt.name);Wt.add.forEach(function(nr){return _o(Et,nr)}),Wt.change.forEach(function(nr){Et.deleteIndex(nr.name),_o(Et,nr)}),Wt.del.forEach(function(nr){return Et.deleteIndex(nr)})});var jt=Le._cfg.contentUpgrade;if(jt&&Le._cfg.version>Ue){mi(ke,je),Pe._memoizedTables={};var Ht=$(at);ot.del.forEach(function(Wt){Ht[Wt]=V[Wt]}),es(ke,[ke.Transaction.prototype]),Ya(ke,[ke.Transaction.prototype],i(Ht),Ht),Pe.schema=Ht;var Lt,Ft=I(jt);return Ft&&tn(),ot=zt.follow(function(){var Wt;(Lt=jt(Pe))&&Ft&&(Wt=ca.bind(null,null),Lt.then(Wt,Wt))}),Lt&&typeof Lt.then=="function"?zt.resolve(Lt):ot.then(function(){return Lt})}}),Be.push(function(V){var at,ot,jt=Le._cfg.dbschema;at=jt,ot=V,[].slice.call(ot.db.objectStoreNames).forEach(function(Ht){return at[Ht]==null&&ot.db.deleteObjectStore(Ht)}),es(ke,[ke.Transaction.prototype]),Ya(ke,[ke.Transaction.prototype],ke._storeNames,ke._dbSchema),Pe.schema=ke._dbSchema}),Be.push(function(V){ke.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(ke.idbdb.version/10)===Le._cfg.version?(ke.idbdb.deleteObjectStore("$meta"),delete ke._dbSchema.$meta,ke._storeNames=ke._storeNames.filter(function(at){return at!=="$meta"})):V.objectStore("$meta").put(Le._cfg.version,"version"))})}),(function Le(){return Be.length?zt.resolve(Be.shift()(Pe.idbtrans)).then(Le):zt.resolve()})().then(function(){to(Fe,je)})):zt.resolve();var ke,Ue,Pe,je,Be,Fe}).catch(le)):(i(G).forEach(function($e){ql(R,$e,G[$e].primKey,G[$e].indexes)}),mi(v,R),void zt.follow(function(){return v.on.populate.fire(J)}).catch(le));var Ee,Re})}function Ul(v,C){to(v._dbSchema,C),C.db.version%10!=0||C.objectStoreNames.contains("$meta")||C.db.createObjectStore("$meta").add(Math.ceil(C.db.version/10-1),"version");var R=yi(0,v.idbdb,C);Hl(v,v._dbSchema,C);for(var j=0,G=al(R,v._dbSchema).change;j<G.length;j++){var J=(function(le){if(le.change.length||le.recreate)return console.warn("Unable to patch indexes of table ".concat(le.name," because it has changes on the type of index or primary key.")),{value:void 0};var ge=C.objectStore(le.name);le.add.forEach(function(Ee){er&&console.debug("Dexie upgrade patch: Creating missing index ".concat(le.name,".").concat(Ee.src)),_o(ge,Ee)})})(G[j]);if(typeof J=="object")return J.value}}function al(v,C){var R,j={del:[],add:[],change:[]};for(R in v)C[R]||j.del.push(R);for(R in C){var G=v[R],J=C[R];if(G){var le={name:R,def:J,recreate:!1,del:[],add:[],change:[]};if(""+(G.primKey.keyPath||"")!=""+(J.primKey.keyPath||"")||G.primKey.auto!==J.primKey.auto)le.recreate=!0,j.change.push(le);else{var ge=G.idxByName,Ee=J.idxByName,Re=void 0;for(Re in ge)Ee[Re]||le.del.push(Re);for(Re in Ee){var $e=ge[Re],ke=Ee[Re];$e?$e.src!==ke.src&&le.change.push(ke):le.add.push(ke)}(0<le.del.length||0<le.add.length||0<le.change.length)&&j.change.push(le)}}else j.add.push([R,J])}return j}function ql(v,C,R,j){var G=v.db.createObjectStore(C,R.keyPath?{keyPath:R.keyPath,autoIncrement:R.auto}:{autoIncrement:R.auto});return j.forEach(function(J){return _o(G,J)}),G}function to(v,C){i(v).forEach(function(R){C.db.objectStoreNames.contains(R)||(er&&console.debug("Dexie: Creating missing table",R),ql(C,R,v[R].primKey,v[R].indexes))})}function _o(v,C){v.createIndex(C.name,C.keyPath,{unique:C.unique,multiEntry:C.multi})}function yi(v,C,R){var j={};return _(C.objectStoreNames,0).forEach(function(G){for(var J=R.objectStore(G),le=qs(pi(Re=J.keyPath),Re||"",!0,!1,!!J.autoIncrement,Re&&typeof Re!="string",!0),ge=[],Ee=0;Ee<J.indexNames.length;++Ee){var $e=J.index(J.indexNames[Ee]),Re=$e.keyPath,$e=qs($e.name,Re,!!$e.unique,!!$e.multiEntry,!1,Re&&typeof Re!="string",!1);ge.push($e)}j[G]=gi(G,le,ge)}),j}function Hl(v,C,R){for(var j=R.db.objectStoreNames,G=0;G<j.length;++G){var J=j[G],le=R.objectStore(J);v._hasGetAll="getAll"in le;for(var ge=0;ge<le.indexNames.length;++ge){var Ee=le.indexNames[ge],Re=le.index(Ee).keyPath,$e=typeof Re=="string"?Re:"["+_(Re).join("+")+"]";!C[J]||(Re=C[J].idxByName[$e])&&(Re.name=Ee,delete C[J].idxByName[$e],C[J].idxByName[Ee]=Re)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&s.WorkerGlobalScope&&s instanceof s.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(v._hasGetAll=!1)}function Ku(v){return v.split(",").map(function(C,R){var J=C.split(":"),j=(G=J[1])===null||G===void 0?void 0:G.trim(),G=(C=J[0].trim()).replace(/([&*]|\+\+)/g,""),J=/^\[/.test(G)?G.match(/^\[(.*)\]$/)[1].split("+"):G;return qs(G,J||null,/\&/.test(C),/\*/.test(C),/\+\+/.test(C),l(J),R===0,j)})}var ea=(Ao.prototype._createTableSchema=gi,Ao.prototype._parseIndexSyntax=Ku,Ao.prototype._parseStoresSpec=function(v,C){var R=this;i(v).forEach(function(j){if(v[j]!==null){var G=R._parseIndexSyntax(v[j]),J=G.shift();if(!J)throw new Te.Schema("Invalid schema for table "+j+": "+v[j]);if(J.unique=!0,J.multi)throw new Te.Schema("Primary key cannot be multiEntry*");G.forEach(function(le){if(le.auto)throw new Te.Schema("Only primary key can be marked as autoIncrement (++)");if(!le.keyPath)throw new Te.Schema("Index must have a name and cannot be an empty string")}),G=R._createTableSchema(j,J,G),C[j]=G}})},Ao.prototype.stores=function(R){var C=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,R):R;var R=C._versions,j={},G={};return R.forEach(function(J){c(j,J._cfg.storesSource),G=J._cfg.dbschema={},J._parseStoresSpec(j,G)}),C._dbSchema=G,es(C,[C._allTables,C,C.Transaction.prototype]),Ya(C,[C._allTables,C,C.Transaction.prototype,this._cfg.tables],i(G),G),C._storeNames=i(G),this},Ao.prototype.upgrade=function(v){return this._cfg.contentUpgrade=ht(this._cfg.contentUpgrade||xe,v),this},Ao);function Ao(){}function zc(v,C){var R=v._dbNamesDB;return R||(R=v._dbNamesDB=new yt(Kn,{addons:[],indexedDB:v,IDBKeyRange:C})).version(1).stores({dbnames:"name"}),R.table("dbnames")}function sl(v){return v&&typeof v.databases=="function"}function $c(v){return an(function(){return vt.letThrough=!0,v()})}function Gl(v){return!("from"in v)}var va=function(v,C){if(!this){var R=new va;return v&&"d"in v&&c(R,v),R}c(this,arguments.length?{d:1,from:v,to:1<arguments.length?C:v}:{d:0})};function Vs(v,C,R){var j=vr(C,R);if(!isNaN(j)){if(0<j)throw RangeError();if(Gl(v))return c(v,{from:C,to:R,d:1});var G=v.l,j=v.r;if(vr(R,v.from)<0)return G?Vs(G,C,R):v.l={from:C,to:R,d:1,l:null,r:null},Ju(v);if(0<vr(C,v.to))return j?Vs(j,C,R):v.r={from:C,to:R,d:1,l:null,r:null},Ju(v);vr(C,v.from)<0&&(v.from=C,v.l=null,v.d=j?j.d+1:1),0<vr(R,v.to)&&(v.to=R,v.r=null,v.d=v.l?v.l.d+1:1),R=!v.r,G&&!v.l&&us(v,G),j&&R&&us(v,j)}}function us(v,C){Gl(C)||(function R(j,Ee){var J=Ee.from,le=Ee.to,ge=Ee.l,Ee=Ee.r;Vs(j,J,le),ge&&R(j,ge),Ee&&R(j,Ee)})(v,C)}function Xu(v,C){var R=Vl(C),j=R.next();if(j.done)return!1;for(var G=j.value,J=Vl(v),le=J.next(G.from),ge=le.value;!j.done&&!le.done;){if(vr(ge.from,G.to)<=0&&0<=vr(ge.to,G.from))return!0;vr(G.from,ge.from)<0?G=(j=R.next(ge.from)).value:ge=(le=J.next(G.from)).value}return!1}function Vl(v){var C=Gl(v)?null:{s:0,n:v};return{next:function(R){for(var j=0<arguments.length;C;)switch(C.s){case 0:if(C.s=1,j)for(;C.n.l&&vr(R,C.n.from)<0;)C={up:C,n:C.n.l,s:1};else for(;C.n.l;)C={up:C,n:C.n.l,s:1};case 1:if(C.s=2,!j||vr(R,C.n.to)<=0)return{value:C.n,done:!1};case 2:if(C.n.r){C.s=3,C={up:C,n:C.n.r,s:0};continue}case 3:C=C.up}return{done:!0}}}}function Ju(v){var C,R,j=(((C=v.r)===null||C===void 0?void 0:C.d)||0)-(((R=v.l)===null||R===void 0?void 0:R.d)||0),G=1<j?"r":j<-1?"l":"";G&&(C=G=="r"?"l":"r",R=n({},v),j=v[G],v.from=j.from,v.to=j.to,v[G]=j[G],R[G]=j[C],(v[C]=R).d=Uc(R)),v.d=Uc(v)}function Uc(R){var C=R.r,R=R.l;return(C?R?Math.max(C.d,R.d):C.d:R?R.d:0)+1}function Wl(v,C){return i(C).forEach(function(R){v[R]?us(v[R],C[R]):v[R]=(function j(G){var J,le,ge={};for(J in G)g(G,J)&&(le=G[J],ge[J]=!le||typeof le!="object"||ee.has(le.constructor)?le:j(le));return ge})(C[R])}),v}function bi(v,C){return v.all||C.all||Object.keys(v).some(function(R){return C[R]&&Xu(C[R],v[R])})}m(va.prototype,((dt={add:function(v){return us(this,v),this},addKey:function(v){return Vs(this,v,v),this},addKeys:function(v){var C=this;return v.forEach(function(R){return Vs(C,R,R)}),this},hasKey:function(v){var C=Vl(this).next(v).value;return C&&vr(C.from,v)<=0&&0<=vr(C.to,v)}})[H]=function(){return Vl(this)},dt));var Ri={},il={},qc=!1;function ol(v){Wl(il,v),qc||(qc=!0,setTimeout(function(){qc=!1,Hc(il,!(il={}))},0))}function Hc(v,C){C===void 0&&(C=!1);var R=new Set;if(v.all)for(var j=0,G=Object.values(Ri);j<G.length;j++)Gc(le=G[j],v,R,C);else for(var J in v){var le,ge=/^idb\:\/\/(.*)\/(.*)\//.exec(J);ge&&(J=ge[1],ge=ge[2],(le=Ri["idb://".concat(J,"/").concat(ge)])&&Gc(le,v,R,C))}R.forEach(function(Ee){return Ee()})}function Gc(v,C,R,j){for(var G=[],J=0,le=Object.entries(v.queries.query);J<le.length;J++){for(var ge=le[J],Ee=ge[0],Re=[],$e=0,ke=ge[1];$e<ke.length;$e++){var Ue=ke[$e];bi(C,Ue.obsSet)?Ue.subscribers.forEach(function(Fe){return R.add(Fe)}):j&&Re.push(Ue)}j&&G.push([Ee,Re])}if(j)for(var Pe=0,je=G;Pe<je.length;Pe++){var Be=je[Pe],Ee=Be[0],Re=Be[1];v.queries.query[Ee]=Re}}function Fh(v){var C=v._state,R=v._deps.indexedDB;if(C.isBeingOpened||v.idbdb)return C.dbReadyPromise.then(function(){return C.dbOpenError?Mt(C.dbOpenError):v});C.isBeingOpened=!0,C.dbOpenError=null,C.openComplete=!1;var j=C.openCanceller,G=Math.round(10*v.verno),J=!1;function le(){if(C.openCanceller!==j)throw new Te.DatabaseClosed("db.open() was cancelled")}function ge(){return new zt(function(Ue,Pe){if(le(),!R)throw new Te.MissingAPI;var je=v.name,Be=C.autoSchema||!G?R.open(je):R.open(je,G);if(!Be)throw new Te.MissingAPI;Be.onerror=jn(Pe),Be.onblocked=Qt(v._fireOnBlocked),Be.onupgradeneeded=Qt(function(Fe){var Le;$e=Be.transaction,C.autoSchema&&!v._options.allowEmptyDB?(Be.onerror=hi,$e.abort(),Be.result.close(),(Le=R.deleteDatabase(je)).onsuccess=Le.onerror=Qt(function(){Pe(new Te.NoSuchDatabase("Database ".concat(je," doesnt exist")))})):($e.onerror=jn(Pe),Fe=Fe.oldVersion>Math.pow(2,62)?0:Fe.oldVersion,ke=Fe<1,v.idbdb=Be.result,J&&Ul(v,$e),nl(v,Fe/10,$e,Pe))},Pe),Be.onsuccess=Qt(function(){$e=null;var Fe,Le,V,at,ot,jt=v.idbdb=Be.result,Ht=_(jt.objectStoreNames);if(0<Ht.length)try{var Lt=jt.transaction((at=Ht).length===1?at[0]:at,"readonly");if(C.autoSchema)Le=jt,V=Lt,(Fe=v).verno=Le.version/10,V=Fe._dbSchema=yi(0,Le,V),Fe._storeNames=_(Le.objectStoreNames,0),Ya(Fe,[Fe._allTables],i(V),V);else if(Hl(v,v._dbSchema,Lt),((ot=al(yi(0,(ot=v).idbdb,Lt),ot._dbSchema)).add.length||ot.change.some(function(Ft){return Ft.add.length||Ft.change.length}))&&!J)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),jt.close(),G=jt.version+1,J=!0,Ue(ge());mi(v,Lt)}catch{}ir.push(v),jt.onversionchange=Qt(function(Ft){C.vcFired=!0,v.on("versionchange").fire(Ft)}),jt.onclose=Qt(function(){v.close({disableAutoOpen:!1})}),ke&&(ot=v._deps,Lt=je,jt=ot.indexedDB,ot=ot.IDBKeyRange,sl(jt)||Lt===Kn||zc(jt,ot).put({name:Lt}).catch(xe)),Ue()},Pe)}).catch(function(Ue){switch(Ue?.name){case"UnknownError":if(0<C.PR1398_maxLoop)return C.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),ge();break;case"VersionError":if(0<G)return G=0,ge()}return zt.reject(Ue)})}var Ee,Re=C.dbReadyResolve,$e=null,ke=!1;return zt.race([j,(typeof navigator>"u"?zt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Ue){function Pe(){return indexedDB.databases().finally(Ue)}Ee=setInterval(Pe,100),Pe()}).finally(function(){return clearInterval(Ee)}):Promise.resolve()).then(ge)]).then(function(){return le(),C.onReadyBeingFired=[],zt.resolve($c(function(){return v.on.ready.fire(v.vip)})).then(function Ue(){if(0<C.onReadyBeingFired.length){var Pe=C.onReadyBeingFired.reduce(ht,xe);return C.onReadyBeingFired=[],zt.resolve($c(function(){return Pe(v.vip)})).then(Ue)}})}).finally(function(){C.openCanceller===j&&(C.onReadyBeingFired=null,C.isBeingOpened=!1)}).catch(function(Ue){C.dbOpenError=Ue;try{$e&&$e.abort()}catch{}return j===C.openCanceller&&v._close(),Mt(Ue)}).finally(function(){C.openComplete=!0,Re()}).then(function(){var Ue;return ke&&(Ue={},v.tables.forEach(function(Pe){Pe.schema.indexes.forEach(function(je){je.name&&(Ue["idb://".concat(v.name,"/").concat(Pe.name,"/").concat(je.name)]=new va(-1/0,[[[]]]))}),Ue["idb://".concat(v.name,"/").concat(Pe.name,"/")]=Ue["idb://".concat(v.name,"/").concat(Pe.name,"/:dels")]=new va(-1/0,[[[]]])}),Aa(Es).fire(Ue),Hc(Ue,!0)),v})}function ds(v){function C(J){return v.next(J)}var R=G(C),j=G(function(J){return v.throw(J)});function G(J){return function(Ee){var ge=J(Ee),Ee=ge.value;return ge.done?Ee:Ee&&typeof Ee.then=="function"?Ee.then(R,j):l(Ee)?Promise.all(Ee).then(R,j):R(Ee)}}return G(C)()}function Di(v,C,R){for(var j=l(v)?v.slice():[v],G=0;G<R;++G)j.push(C);return j}var zh={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(v){return n(n({},v),{table:function(C){var R=v.table(C),j=R.schema,G={},J=[];function le(ke,Ue,Pe){var je=pa(ke),Be=G[je]=G[je]||[],Fe=ke==null?0:typeof ke=="string"?1:ke.length,Le=0<Ue,Le=n(n({},Pe),{name:Le?"".concat(je,"(virtual-from:").concat(Pe.name,")"):Pe.name,lowLevelIndex:Pe,isVirtual:Le,keyTail:Ue,keyLength:Fe,extractKey:Co(ke),unique:!Le&&Pe.unique});return Be.push(Le),Le.isPrimaryKey||J.push(Le),1<Fe&&le(Fe===2?ke[0]:ke.slice(0,Fe-1),Ue+1,Pe),Be.sort(function(V,at){return V.keyTail-at.keyTail}),Le}C=le(j.primaryKey.keyPath,0,j.primaryKey),G[":id"]=[C];for(var ge=0,Ee=j.indexes;ge<Ee.length;ge++){var Re=Ee[ge];le(Re.keyPath,0,Re)}function $e(ke){var Ue,Pe=ke.query.index;return Pe.isVirtual?n(n({},ke),{query:{index:Pe.lowLevelIndex,range:(Ue=ke.query.range,Pe=Pe.keyTail,{type:Ue.type===1?2:Ue.type,lower:Di(Ue.lower,Ue.lowerOpen?v.MAX_KEY:v.MIN_KEY,Pe),lowerOpen:!0,upper:Di(Ue.upper,Ue.upperOpen?v.MIN_KEY:v.MAX_KEY,Pe),upperOpen:!0})}}):ke}return n(n({},R),{schema:n(n({},j),{primaryKey:C,indexes:J,getIndexByKeyPath:function(ke){return(ke=G[pa(ke)])&&ke[0]}}),count:function(ke){return R.count($e(ke))},query:function(ke){return R.query($e(ke))},openCursor:function(ke){var Ue=ke.query.index,Pe=Ue.keyTail,je=Ue.isVirtual,Be=Ue.keyLength;return je?R.openCursor($e(ke)).then(function(Le){return Le&&Fe(Le)}):R.openCursor(ke);function Fe(Le){return Object.create(Le,{continue:{value:function(V){V!=null?Le.continue(Di(V,ke.reverse?v.MAX_KEY:v.MIN_KEY,Pe)):ke.unique?Le.continue(Le.key.slice(0,Be).concat(ke.reverse?v.MIN_KEY:v.MAX_KEY,Pe)):Le.continue()}},continuePrimaryKey:{value:function(V,at){Le.continuePrimaryKey(Di(V,v.MAX_KEY,Pe),at)}},primaryKey:{get:function(){return Le.primaryKey}},key:{get:function(){var V=Le.key;return Be===1?V[0]:V.slice(0,Be)}},value:{get:function(){return Le.value}}})}}})}})}};function Yl(v,C,R,j){return R=R||{},j=j||"",i(v).forEach(function(G){var J,le,ge;g(C,G)?(J=v[G],le=C[G],typeof J=="object"&&typeof le=="object"&&J&&le?(ge=W(J))!==W(le)?R[j+G]=C[G]:ge==="Object"?Yl(J,le,R,j+G+"."):J!==le&&(R[j+G]=C[G]):J!==le&&(R[j+G]=C[G])):R[j+G]=void 0}),i(C).forEach(function(G){g(v,G)||(R[j+G]=C[G])}),R}function Ql(v,C){return C.type==="delete"?C.keys:C.keys||C.values.map(v.extractKey)}var Zu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(v){return n(n({},v),{table:function(C){var R=v.table(C),j=R.schema.primaryKey;return n(n({},R),{mutate:function(G){var J=vt.trans,le=J.table(C).hook,ge=le.deleting,Ee=le.creating,Re=le.updating;switch(G.type){case"add":if(Ee.fire===xe)break;return J._promise("readwrite",function(){return $e(G)},!0);case"put":if(Ee.fire===xe&&Re.fire===xe)break;return J._promise("readwrite",function(){return $e(G)},!0);case"delete":if(ge.fire===xe)break;return J._promise("readwrite",function(){return $e(G)},!0);case"deleteRange":if(ge.fire===xe)break;return J._promise("readwrite",function(){return(function ke(Ue,Pe,je){return R.query({trans:Ue,values:!1,query:{index:j,range:Pe},limit:je}).then(function(Be){var Fe=Be.result;return $e({type:"delete",keys:Fe,trans:Ue}).then(function(Le){return 0<Le.numFailures?Promise.reject(Le.failures[0]):Fe.length<je?{failures:[],numFailures:0,lastResult:void 0}:ke(Ue,n(n({},Pe),{lower:Fe[Fe.length-1],lowerOpen:!0}),je)})})})(G.trans,G.range,1e4)},!0)}return R.mutate(G);function $e(ke){var Ue,Pe,je,Be=vt.trans,Fe=ke.keys||Ql(j,ke);if(!Fe)throw new Error("Keys missing");return(ke=ke.type==="add"||ke.type==="put"?n(n({},ke),{keys:Fe}):n({},ke)).type!=="delete"&&(ke.values=a([],ke.values)),ke.keys&&(ke.keys=a([],ke.keys)),Ue=R,je=Fe,((Pe=ke).type==="add"?Promise.resolve([]):Ue.getMany({trans:Pe.trans,keys:je,cache:"immutable"})).then(function(Le){var V=Fe.map(function(at,ot){var jt,Ht,Lt,Ft=Le[ot],Wt={onerror:null,onsuccess:null};return ke.type==="delete"?ge.fire.call(Wt,at,Ft,Be):ke.type==="add"||Ft===void 0?(jt=Ee.fire.call(Wt,at,ke.values[ot],Be),at==null&&jt!=null&&(ke.keys[ot]=at=jt,j.outbound||M(ke.values[ot],j.keyPath,at))):(jt=Yl(Ft,ke.values[ot]),(Ht=Re.fire.call(Wt,jt,at,Ft,Be))&&(Lt=ke.values[ot],Object.keys(Ht).forEach(function(Et){g(Lt,Et)?Lt[Et]=Ht[Et]:M(Lt,Et,Ht[Et])}))),Wt});return R.mutate(ke).then(function(at){for(var ot=at.failures,jt=at.results,Ht=at.numFailures,at=at.lastResult,Lt=0;Lt<Fe.length;++Lt){var Ft=(jt||Fe)[Lt],Wt=V[Lt];Ft==null?Wt.onerror&&Wt.onerror(ot[Lt]):Wt.onsuccess&&Wt.onsuccess(ke.type==="put"&&Le[Lt]?ke.values[Lt]:Ft)}return{failures:ot,results:jt,numFailures:Ht,lastResult:at}}).catch(function(at){return V.forEach(function(ot){return ot.onerror&&ot.onerror(at)}),Promise.reject(at)})})}}})}})}};function Vc(v,C,R){try{if(!C||C.keys.length<v.length)return null;for(var j=[],G=0,J=0;G<C.keys.length&&J<v.length;++G)vr(C.keys[G],v[J])===0&&(j.push(R?X(C.values[G]):C.values[G]),++J);return j.length===v.length?j:null}catch{return null}}var ed={stack:"dbcore",level:-1,create:function(v){return{table:function(C){var R=v.table(C);return n(n({},R),{getMany:function(j){if(!j.cache)return R.getMany(j);var G=Vc(j.keys,j.trans._cache,j.cache==="clone");return G?zt.resolve(G):R.getMany(j).then(function(J){return j.trans._cache={keys:j.keys,values:j.cache==="clone"?X(J):J},J})},mutate:function(j){return j.type!=="add"&&(j.trans._cache=null),R.mutate(j)}})}}}};function ro(v,C){return v.trans.mode==="readonly"&&!!v.subscr&&!v.trans.explicit&&v.trans.db._options.cache!=="disabled"&&!C.schema.primaryKey.outbound}function td(v,C){switch(v){case"query":return C.values&&!C.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var rd={stack:"dbcore",level:0,name:"Observability",create:function(v){var C=v.schema.name,R=new va(v.MIN_KEY,v.MAX_KEY);return n(n({},v),{transaction:function(j,G,J){if(vt.subscr&&G!=="readonly")throw new Te.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(vt.querier));return v.transaction(j,G,J)},table:function(j){var G=v.table(j),J=G.schema,le=J.primaryKey,ke=J.indexes,ge=le.extractKey,Ee=le.outbound,Re=le.autoIncrement&&ke.filter(function(Pe){return Pe.compound&&Pe.keyPath.includes(le.keyPath)}),$e=n(n({},G),{mutate:function(Pe){function je(Et){return Et="idb://".concat(C,"/").concat(j,"/").concat(Et),at[Et]||(at[Et]=new va)}var Be,Fe,Le,V=Pe.trans,at=Pe.mutatedParts||(Pe.mutatedParts={}),ot=je(""),jt=je(":dels"),Ht=Pe.type,Wt=Pe.type==="deleteRange"?[Pe.range]:Pe.type==="delete"?[Pe.keys]:Pe.values.length<50?[Ql(le,Pe).filter(function(Et){return Et}),Pe.values]:[],Lt=Wt[0],Ft=Wt[1],Wt=Pe.trans._cache;return l(Lt)?(ot.addKeys(Lt),(Wt=Ht==="delete"||Lt.length===Ft.length?Vc(Lt,Wt):null)||jt.addKeys(Lt),(Wt||Ft)&&(Be=je,Fe=Wt,Le=Ft,J.indexes.forEach(function(Et){var nr=Be(Et.name||"");function Xe(Ve){return Ve!=null?Et.extractKey(Ve):null}function _e(Ve){return Et.multiEntry&&l(Ve)?Ve.forEach(function(Xt){return nr.addKey(Xt)}):nr.addKey(Ve)}(Fe||Le).forEach(function(Ve,St){var At=Fe&&Xe(Fe[St]),St=Le&&Xe(Le[St]);vr(At,St)!==0&&(At!=null&&_e(At),St!=null&&_e(St))})}))):Lt?(Ft={from:(Ft=Lt.lower)!==null&&Ft!==void 0?Ft:v.MIN_KEY,to:(Ft=Lt.upper)!==null&&Ft!==void 0?Ft:v.MAX_KEY},jt.add(Ft),ot.add(Ft)):(ot.add(R),jt.add(R),J.indexes.forEach(function(Et){return je(Et.name).add(R)})),G.mutate(Pe).then(function(Et){return!Lt||Pe.type!=="add"&&Pe.type!=="put"||(ot.addKeys(Et.results),Re&&Re.forEach(function(nr){for(var Xe=Pe.values.map(function(At){return nr.extractKey(At)}),_e=nr.keyPath.findIndex(function(At){return At===le.keyPath}),Ve=0,Xt=Et.results.length;Ve<Xt;++Ve)Xe[Ve][_e]=Et.results[Ve];je(nr.name).addKeys(Xe)})),V.mutatedParts=Wl(V.mutatedParts||{},at),Et})}}),ke=function(je){var Be=je.query,je=Be.index,Be=Be.range;return[je,new va((je=Be.lower)!==null&&je!==void 0?je:v.MIN_KEY,(Be=Be.upper)!==null&&Be!==void 0?Be:v.MAX_KEY)]},Ue={get:function(Pe){return[le,new va(Pe.key)]},getMany:function(Pe){return[le,new va().addKeys(Pe.keys)]},count:ke,query:ke,openCursor:ke};return i(Ue).forEach(function(Pe){$e[Pe]=function(je){var Be=vt.subscr,Fe=!!Be,Le=ro(vt,G)&&td(Pe,je)?je.obsSet={}:Be;if(Fe){var V=function(Ft){return Ft="idb://".concat(C,"/").concat(j,"/").concat(Ft),Le[Ft]||(Le[Ft]=new va)},at=V(""),ot=V(":dels"),Be=Ue[Pe](je),Fe=Be[0],Be=Be[1];if((Pe==="query"&&Fe.isPrimaryKey&&!je.values?ot:V(Fe.name||"")).add(Be),!Fe.isPrimaryKey){if(Pe!=="count"){var jt=Pe==="query"&&Ee&&je.values&&G.query(n(n({},je),{values:!1}));return G[Pe].apply(this,arguments).then(function(Ft){if(Pe==="query"){if(Ee&&je.values)return jt.then(function(Xe){return Xe=Xe.result,at.addKeys(Xe),Ft});var Wt=je.values?Ft.result.map(ge):Ft.result;(je.values?at:ot).addKeys(Wt)}else if(Pe==="openCursor"){var Et=Ft,nr=je.values;return Et&&Object.create(Et,{key:{get:function(){return ot.addKey(Et.primaryKey),Et.key}},primaryKey:{get:function(){var Xe=Et.primaryKey;return ot.addKey(Xe),Xe}},value:{get:function(){return nr&&at.addKey(Et.primaryKey),Et.value}}})}return Ft})}ot.add(R)}}return G[Pe].apply(this,arguments)}}),$e}})}};function nd(v,C,R){if(R.numFailures===0)return C;if(C.type==="deleteRange")return null;var j=C.keys?C.keys.length:"values"in C&&C.values?C.values.length:1;return R.numFailures===j?null:(C=n({},C),l(C.keys)&&(C.keys=C.keys.filter(function(G,J){return!(J in R.failures)})),"values"in C&&l(C.values)&&(C.values=C.values.filter(function(G,J){return!(J in R.failures)})),C)}function Kl(v,C){return R=v,((j=C).lower===void 0||(j.lowerOpen?0<vr(R,j.lower):0<=vr(R,j.lower)))&&(v=v,(C=C).upper===void 0||(C.upperOpen?vr(v,C.upper)<0:vr(v,C.upper)<=0));var R,j}function Wc(v,C,Ue,j,G,J){if(!Ue||Ue.length===0)return v;var le=C.query.index,ge=le.multiEntry,Ee=C.query.range,Re=j.schema.primaryKey.extractKey,$e=le.extractKey,ke=(le.lowLevelIndex||le).extractKey,Ue=Ue.reduce(function(Pe,je){var Be=Pe,Fe=[];if(je.type==="add"||je.type==="put")for(var Le=new va,V=je.values.length-1;0<=V;--V){var at,ot=je.values[V],jt=Re(ot);Le.hasKey(jt)||(at=$e(ot),(ge&&l(at)?at.some(function(Et){return Kl(Et,Ee)}):Kl(at,Ee))&&(Le.addKey(jt),Fe.push(ot)))}switch(je.type){case"add":var Ht=new va().addKeys(C.values?Pe.map(function(nr){return Re(nr)}):Pe),Be=Pe.concat(C.values?Fe.filter(function(nr){return nr=Re(nr),!Ht.hasKey(nr)&&(Ht.addKey(nr),!0)}):Fe.map(function(nr){return Re(nr)}).filter(function(nr){return!Ht.hasKey(nr)&&(Ht.addKey(nr),!0)}));break;case"put":var Lt=new va().addKeys(je.values.map(function(nr){return Re(nr)}));Be=Pe.filter(function(nr){return!Lt.hasKey(C.values?Re(nr):nr)}).concat(C.values?Fe:Fe.map(function(nr){return Re(nr)}));break;case"delete":var Ft=new va().addKeys(je.keys);Be=Pe.filter(function(nr){return!Ft.hasKey(C.values?Re(nr):nr)});break;case"deleteRange":var Wt=je.range;Be=Pe.filter(function(nr){return!Kl(Re(nr),Wt)})}return Be},v);return Ue===v?v:(Ue.sort(function(Pe,je){return vr(ke(Pe),ke(je))||vr(Re(Pe),Re(je))}),C.limit&&C.limit<1/0&&(Ue.length>C.limit?Ue.length=C.limit:v.length===C.limit&&Ue.length<C.limit&&(G.dirty=!0)),J?Object.freeze(Ue):Ue)}function No(v,C){return vr(v.lower,C.lower)===0&&vr(v.upper,C.upper)===0&&!!v.lowerOpen==!!C.lowerOpen&&!!v.upperOpen==!!C.upperOpen}function ll(v,C){return(function(R,j,G,J){if(R===void 0)return j!==void 0?-1:0;if(j===void 0)return 1;if((j=vr(R,j))===0){if(G&&J)return 0;if(G)return 1;if(J)return-1}return j})(v.lower,C.lower,v.lowerOpen,C.lowerOpen)<=0&&0<=(function(R,j,G,J){if(R===void 0)return j!==void 0?1:0;if(j===void 0)return-1;if((j=vr(R,j))===0){if(G&&J)return 0;if(G)return-1;if(J)return 1}return j})(v.upper,C.upper,v.upperOpen,C.upperOpen)}function Y(v,C,R,j){v.subscribers.add(R),j.addEventListener("abort",function(){var G,J;v.subscribers.delete(R),v.subscribers.size===0&&(G=v,J=C,setTimeout(function(){G.subscribers.size===0&&ne(J,G)},3e3))})}var oe={stack:"dbcore",level:0,name:"Cache",create:function(v){var C=v.schema.name;return n(n({},v),{transaction:function(R,j,G){var J,le,ge=v.transaction(R,j,G);return j==="readwrite"&&(le=(J=new AbortController).signal,G=function(Ee){return function(){if(J.abort(),j==="readwrite"){for(var Re=new Set,$e=0,ke=R;$e<ke.length;$e++){var Ue=ke[$e],Pe=Ri["idb://".concat(C,"/").concat(Ue)];if(Pe){var je=v.table(Ue),Be=Pe.optimisticOps.filter(function(nr){return nr.trans===ge});if(ge._explicit&&Ee&&ge.mutatedParts)for(var Fe=0,Le=Object.values(Pe.queries.query);Fe<Le.length;Fe++)for(var V=0,at=(Ht=Le[Fe]).slice();V<at.length;V++)bi((Lt=at[V]).obsSet,ge.mutatedParts)&&(ne(Ht,Lt),Lt.subscribers.forEach(function(nr){return Re.add(nr)}));else if(0<Be.length){Pe.optimisticOps=Pe.optimisticOps.filter(function(nr){return nr.trans!==ge});for(var ot=0,jt=Object.values(Pe.queries.query);ot<jt.length;ot++)for(var Ht,Lt,Ft,Wt=0,Et=(Ht=jt[ot]).slice();Wt<Et.length;Wt++)(Lt=Et[Wt]).res!=null&&ge.mutatedParts&&(Ee&&!Lt.dirty?(Ft=Object.isFrozen(Lt.res),Ft=Wc(Lt.res,Lt.req,Be,je,Lt,Ft),Lt.dirty?(ne(Ht,Lt),Lt.subscribers.forEach(function(nr){return Re.add(nr)})):Ft!==Lt.res&&(Lt.res=Ft,Lt.promise=zt.resolve({result:Ft}))):(Lt.dirty&&ne(Ht,Lt),Lt.subscribers.forEach(function(nr){return Re.add(nr)})))}}}Re.forEach(function(nr){return nr()})}}},ge.addEventListener("abort",G(!1),{signal:le}),ge.addEventListener("error",G(!1),{signal:le}),ge.addEventListener("complete",G(!0),{signal:le})),ge},table:function(R){var j=v.table(R),G=j.schema.primaryKey;return n(n({},j),{mutate:function(J){var le=vt.trans;if(G.outbound||le.db._options.cache==="disabled"||le.explicit||le.idbtrans.mode!=="readwrite")return j.mutate(J);var ge=Ri["idb://".concat(C,"/").concat(R)];return ge?(le=j.mutate(J),J.type!=="add"&&J.type!=="put"||!(50<=J.values.length||Ql(G,J).some(function(Ee){return Ee==null}))?(ge.optimisticOps.push(J),J.mutatedParts&&ol(J.mutatedParts),le.then(function(Ee){0<Ee.numFailures&&(ne(ge.optimisticOps,J),(Ee=nd(0,J,Ee))&&ge.optimisticOps.push(Ee),J.mutatedParts&&ol(J.mutatedParts))}),le.catch(function(){ne(ge.optimisticOps,J),J.mutatedParts&&ol(J.mutatedParts)})):le.then(function(Ee){var Re=nd(0,n(n({},J),{values:J.values.map(function($e,ke){var Ue;return Ee.failures[ke]?$e:($e=(Ue=G.keyPath)!==null&&Ue!==void 0&&Ue.includes(".")?X($e):n({},$e),M($e,G.keyPath,Ee.results[ke]),$e)})}),Ee);ge.optimisticOps.push(Re),queueMicrotask(function(){return J.mutatedParts&&ol(J.mutatedParts)})}),le):j.mutate(J)},query:function(J){if(!ro(vt,j)||!td("query",J))return j.query(J);var le=((Re=vt.trans)===null||Re===void 0?void 0:Re.db._options.cache)==="immutable",ke=vt,ge=ke.requery,Ee=ke.signal,Re=(function(je,Be,Fe,Le){var V=Ri["idb://".concat(je,"/").concat(Be)];if(!V)return[];if(!(Be=V.queries[Fe]))return[null,!1,V,null];var at=Be[(Le.query?Le.query.index.name:null)||""];if(!at)return[null,!1,V,null];switch(Fe){case"query":var ot=at.find(function(jt){return jt.req.limit===Le.limit&&jt.req.values===Le.values&&No(jt.req.query.range,Le.query.range)});return ot?[ot,!0,V,at]:[at.find(function(jt){return("limit"in jt.req?jt.req.limit:1/0)>=Le.limit&&(!Le.values||jt.req.values)&&ll(jt.req.query.range,Le.query.range)}),!1,V,at];case"count":return ot=at.find(function(jt){return No(jt.req.query.range,Le.query.range)}),[ot,!!ot,V,at]}})(C,R,"query",J),$e=Re[0],ke=Re[1],Ue=Re[2],Pe=Re[3];return $e&&ke?$e.obsSet=J.obsSet:(ke=j.query(J).then(function(je){var Be=je.result;if($e&&($e.res=Be),le){for(var Fe=0,Le=Be.length;Fe<Le;++Fe)Object.freeze(Be[Fe]);Object.freeze(Be)}else je.result=X(Be);return je}).catch(function(je){return Pe&&$e&&ne(Pe,$e),Promise.reject(je)}),$e={obsSet:J.obsSet,promise:ke,subscribers:new Set,type:"query",req:J,dirty:!1},Pe?Pe.push($e):(Pe=[$e],(Ue=Ue||(Ri["idb://".concat(C,"/").concat(R)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[J.query.index.name||""]=Pe)),Y($e,Pe,ge,Ee),$e.promise.then(function(je){return{result:Wc(je.result,J,Ue?.optimisticOps,j,$e,le)}})}})}})}};function Ge(v,C){return new Proxy(v,{get:function(R,j,G){return j==="db"?C:Reflect.get(R,j,G)}})}var yt=(tt.prototype.version=function(v){if(isNaN(v)||v<.1)throw new Te.Type("Given version is not a positive number");if(v=Math.round(10*v)/10,this.idbdb||this._state.isBeingOpened)throw new Te.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,v);var C=this._versions,R=C.filter(function(j){return j._cfg.version===v})[0];return R||(R=new this.Version(v),C.push(R),C.sort(Gs),R.stores({}),this._state.autoSchema=!1,R)},tt.prototype._whenReady=function(v){var C=this;return this.idbdb&&(this._state.openComplete||vt.letThrough||this._vip)?v():new zt(function(R,j){if(C._state.openComplete)return j(new Te.DatabaseClosed(C._state.dbOpenError));if(!C._state.isBeingOpened){if(!C._state.autoOpen)return void j(new Te.DatabaseClosed);C.open().catch(xe)}C._state.dbReadyPromise.then(R,j)}).then(v)},tt.prototype.use=function(v){var C=v.stack,R=v.create,j=v.level,G=v.name;return G&&this.unuse({stack:C,name:G}),v=this._middlewares[C]||(this._middlewares[C]=[]),v.push({stack:C,create:R,level:j??10,name:G}),v.sort(function(J,le){return J.level-le.level}),this},tt.prototype.unuse=function(v){var C=v.stack,R=v.name,j=v.create;return C&&this._middlewares[C]&&(this._middlewares[C]=this._middlewares[C].filter(function(G){return j?G.create!==j:!!R&&G.name!==R})),this},tt.prototype.open=function(){var v=this;return rr(sr,function(){return Fh(v)})},tt.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var v=this._state,C=ir.indexOf(this);if(0<=C&&ir.splice(C,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}v.isBeingOpened||(v.dbReadyPromise=new zt(function(R){v.dbReadyResolve=R}),v.openCanceller=new zt(function(R,j){v.cancelOpen=j}))},tt.prototype.close=function(R){var C=(R===void 0?{disableAutoOpen:!0}:R).disableAutoOpen,R=this._state;C?(R.isBeingOpened&&R.cancelOpen(new Te.DatabaseClosed),this._close(),R.autoOpen=!1,R.dbOpenError=new Te.DatabaseClosed):(this._close(),R.autoOpen=this._options.autoOpen||R.isBeingOpened,R.openComplete=!1,R.dbOpenError=null)},tt.prototype.delete=function(v){var C=this;v===void 0&&(v={disableAutoOpen:!0});var R=0<arguments.length&&typeof arguments[0]!="object",j=this._state;return new zt(function(G,J){function le(){C.close(v);var ge=C._deps.indexedDB.deleteDatabase(C.name);ge.onsuccess=Qt(function(){var Ee,Re,$e;Ee=C._deps,Re=C.name,$e=Ee.indexedDB,Ee=Ee.IDBKeyRange,sl($e)||Re===Kn||zc($e,Ee).delete(Re).catch(xe),G()}),ge.onerror=jn(J),ge.onblocked=C._fireOnBlocked}if(R)throw new Te.InvalidArgument("Invalid closeOptions argument to db.delete()");j.isBeingOpened?j.dbReadyPromise.then(le):le()})},tt.prototype.backendDB=function(){return this.idbdb},tt.prototype.isOpen=function(){return this.idbdb!==null},tt.prototype.hasBeenClosed=function(){var v=this._state.dbOpenError;return v&&v.name==="DatabaseClosed"},tt.prototype.hasFailed=function(){return this._state.dbOpenError!==null},tt.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(tt.prototype,"tables",{get:function(){var v=this;return i(this._allTables).map(function(C){return v._allTables[C]})},enumerable:!1,configurable:!0}),tt.prototype.transaction=function(){var v=(function(C,R,j){var G=arguments.length;if(G<2)throw new Te.InvalidArgument("Too few arguments");for(var J=new Array(G-1);--G;)J[G-1]=arguments[G];return j=J.pop(),[C,z(J),j]}).apply(this,arguments);return this._transaction.apply(this,v)},tt.prototype._transaction=function(v,C,R){var j=this,G=vt.trans;G&&G.db===this&&v.indexOf("!")===-1||(G=null);var J,le,ge=v.indexOf("?")!==-1;v=v.replace("!","").replace("?","");try{if(le=C.map(function(Re){if(Re=Re instanceof j.Table?Re.name:Re,typeof Re!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return Re}),v=="r"||v===Hn)J=Hn;else{if(v!="rw"&&v!=Tt)throw new Te.InvalidArgument("Invalid transaction mode: "+v);J=Tt}if(G){if(G.mode===Hn&&J===Tt){if(!ge)throw new Te.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");G=null}G&&le.forEach(function(Re){if(G&&G.storeNames.indexOf(Re)===-1){if(!ge)throw new Te.SubTransaction("Table "+Re+" not included in parent transaction.");G=null}}),ge&&G&&!G.active&&(G=null)}}catch(Re){return G?G._promise(null,function($e,ke){ke(Re)}):Mt(Re)}var Ee=(function Re($e,ke,Ue,Pe,je){return zt.resolve().then(function(){var Be=vt.transless||vt,Fe=$e._createTransaction(ke,Ue,$e._dbSchema,Pe);if(Fe.explicit=!0,Be={trans:Fe,transless:Be},Pe)Fe.idbtrans=Pe.idbtrans;else try{Fe.create(),Fe.idbtrans._explicit=!0,$e._state.PR1398_maxLoop=3}catch(at){return at.name===fe.InvalidState&&$e.isOpen()&&0<--$e._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$e.close({disableAutoOpen:!1}),$e.open().then(function(){return Re($e,ke,Ue,null,je)})):Mt(at)}var Le,V=I(je);return V&&tn(),Be=zt.follow(function(){var at;(Le=je.call(Fe,Fe))&&(V?(at=ca.bind(null,null),Le.then(at,at)):typeof Le.next=="function"&&typeof Le.throw=="function"&&(Le=ds(Le)))},Be),(Le&&typeof Le.then=="function"?zt.resolve(Le).then(function(at){return Fe.active?at:Mt(new Te.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):Be.then(function(){return Le})).then(function(at){return Pe&&Fe._resolve(),Fe._completion.then(function(){return at})}).catch(function(at){return Fe._reject(at),Mt(at)})})}).bind(null,this,J,le,G,R);return G?G._promise(J,Ee,"lock"):vt.trans?rr(vt.transless,function(){return j._whenReady(Ee)}):this._whenReady(Ee)},tt.prototype.table=function(v){if(!g(this._allTables,v))throw new Te.InvalidTable("Table ".concat(v," does not exist"));return this._allTables[v]},tt);function tt(v,C){var R=this;this._middlewares={},this.verno=0;var j=tt.dependencies;this._options=C=n({addons:tt.addons,autoOpen:!0,indexedDB:j.indexedDB,IDBKeyRange:j.IDBKeyRange,cache:"cloned"},C),this._deps={indexedDB:C.indexedDB,IDBKeyRange:C.IDBKeyRange},j=C.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var G,J,le,ge,Ee,Re={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:xe,dbReadyPromise:null,cancelOpen:xe,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:C.autoOpen};Re.dbReadyPromise=new zt(function(ke){Re.dbReadyResolve=ke}),Re.openCanceller=new zt(function(ke,Ue){Re.cancelOpen=Ue}),this._state=Re,this.name=v,this.on=Cs(this,"populate","blocked","versionchange","close",{ready:[ht,xe]}),this.once=function(ke,Ue){var Pe=function(){for(var je=[],Be=0;Be<arguments.length;Be++)je[Be]=arguments[Be];R.on(ke).unsubscribe(Pe),Ue.apply(R,je)};return R.on(ke,Pe)},this.on.ready.subscribe=P(this.on.ready.subscribe,function(ke){return function(Ue,Pe){tt.vip(function(){var je,Be=R._state;Be.openComplete?(Be.dbOpenError||zt.resolve().then(Ue),Pe&&ke(Ue)):Be.onReadyBeingFired?(Be.onReadyBeingFired.push(Ue),Pe&&ke(Ue)):(ke(Ue),je=R,Pe||ke(function Fe(){je.on.ready.unsubscribe(Ue),je.on.ready.unsubscribe(Fe)}))})}}),this.Collection=(G=this,da(di.prototype,function(Le,Fe){this.db=G;var Pe=Lr,je=null;if(Fe)try{Pe=Fe()}catch(V){je=V}var Be=Le._ctx,Fe=Be.table,Le=Fe.hook.reading.fire;this._ctx={table:Fe,index:Be.index,isPrimKey:!Be.index||Fe.schema.primKey.keyPath&&Be.index===Fe.schema.primKey.name,range:Pe,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:je,or:Be.or,valueMapper:Le!==me?Le:null}})),this.Table=(J=this,da(Ii.prototype,function(ke,Ue,Pe){this.db=J,this._tx=Pe,this.name=ke,this.schema=Ue,this.hook=J._allTables[ke]?J._allTables[ke].hook:Cs(null,{creating:[Ie,xe],reading:[de,me],updating:[nt,xe],deleting:[ze,xe]})})),this.Transaction=(le=this,da($l.prototype,function(ke,Ue,Pe,je,Be){var Fe=this;ke!=="readonly"&&Ue.forEach(function(Le){Le=(Le=Pe[Le])===null||Le===void 0?void 0:Le.yProps,Le&&(Ue=Ue.concat(Le.map(function(V){return V.updatesTable})))}),this.db=le,this.mode=ke,this.storeNames=Ue,this.schema=Pe,this.chromeTransactionDurability=je,this.idbtrans=null,this.on=Cs(this,"complete","error","abort"),this.parent=Be||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new zt(function(Le,V){Fe._resolve=Le,Fe._reject=V}),this._completion.then(function(){Fe.active=!1,Fe.on.complete.fire()},function(Le){var V=Fe.active;return Fe.active=!1,Fe.on.error.fire(Le),Fe.parent?Fe.parent._reject(Le):V&&Fe.idbtrans&&Fe.idbtrans.abort(),Mt(Le)})})),this.Version=(ge=this,da(ea.prototype,function(ke){this.db=ge,this._cfg={version:ke,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(Ee=this,da(Vr.prototype,function(ke,Ue,Pe){if(this.db=Ee,this._ctx={table:ke,index:Ue===":id"?null:Ue,or:Pe},this._cmp=this._ascending=vr,this._descending=function(je,Be){return vr(Be,je)},this._max=function(je,Be){return 0<vr(je,Be)?je:Be},this._min=function(je,Be){return vr(je,Be)<0?je:Be},this._IDBKeyRange=Ee._deps.IDBKeyRange,!this._IDBKeyRange)throw new Te.MissingAPI})),this.on("versionchange",function(ke){0<ke.newVersion?console.warn("Another connection wants to upgrade database '".concat(R.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(R.name,"'. Closing db now to resume the delete request.")),R.close({disableAutoOpen:!1})}),this.on("blocked",function(ke){!ke.newVersion||ke.newVersion<ke.oldVersion?console.warn("Dexie.delete('".concat(R.name,"') was blocked")):console.warn("Upgrade '".concat(R.name,"' blocked by other connection holding version ").concat(ke.oldVersion/10))}),this._maxKey=eo(C.IDBKeyRange),this._createTransaction=function(ke,Ue,Pe,je){return new R.Transaction(ke,Ue,Pe,R._options.chromeTransactionDurability,je)},this._fireOnBlocked=function(ke){R.on("blocked").fire(ke),ir.filter(function(Ue){return Ue.name===R.name&&Ue!==R&&!Ue._state.vcFired}).map(function(Ue){return Ue.on("versionchange").fire(ke)})},this.use(ed),this.use(oe),this.use(rd),this.use(zh),this.use(Zu);var $e=new Proxy(this,{get:function(ke,Ue,Pe){if(Ue==="_vip")return!0;if(Ue==="table")return function(Be){return Ge(R.table(Be),$e)};var je=Reflect.get(ke,Ue,Pe);return je instanceof Ii?Ge(je,$e):Ue==="tables"?je.map(function(Be){return Ge(Be,$e)}):Ue==="_createTransaction"?function(){return Ge(je.apply(this,arguments),$e)}:je}});this.vip=$e,j.forEach(function(ke){return ke(R)})}var ie,dt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",We=(Ct.prototype.subscribe=function(v,C,R){return this._subscribe(v&&typeof v!="function"?v:{next:v,error:C,complete:R})},Ct.prototype[dt]=function(){return this},Ct);function Ct(v){this._subscribe=v}try{ie={indexedDB:s.indexedDB||s.mozIndexedDB||s.webkitIndexedDB||s.msIndexedDB,IDBKeyRange:s.IDBKeyRange||s.webkitIDBKeyRange}}catch{ie={indexedDB:null,IDBKeyRange:null}}function Oe(v){var C,R=!1,j=new We(function(G){var J=I(v),le,ge=!1,Ee={},Re={},$e={get closed(){return ge},unsubscribe:function(){ge||(ge=!0,le&&le.abort(),ke&&Aa.storagemutated.unsubscribe(Pe))}};G.start&&G.start($e);var ke=!1,Ue=function(){return bt(je)},Pe=function(Be){Wl(Ee,Be),bi(Re,Ee)&&Ue()},je=function(){var Be,Fe,Le;!ge&&ie.indexedDB&&(Ee={},Be={},le&&le.abort(),le=new AbortController,Le=(function(V){var at=Kr();try{J&&tn();var ot=an(v,V);return ot=J?ot.finally(ca):ot}finally{at&&Xr()}})(Fe={subscr:Be,signal:le.signal,requery:Ue,querier:v,trans:null}),Promise.resolve(Le).then(function(V){R=!0,C=V,ge||Fe.signal.aborted||(Ee={},(function(at){for(var ot in at)if(g(at,ot))return;return 1})(Re=Be)||ke||(Aa(Es,Pe),ke=!0),bt(function(){return!ge&&G.next&&G.next(V)}))},function(V){R=!1,["DatabaseClosedError","AbortError"].includes(V?.name)||ge||bt(function(){ge||G.error&&G.error(V)})}))};return setTimeout(Ue,0),$e});return j.hasValue=function(){return R},j.getValue=function(){return C},j}var gt=yt;function It(v){var C=Rt;try{Rt=!0,Aa.storagemutated.fire(v),Hc(v,!0)}finally{Rt=C}}m(gt,n(n({},be),{delete:function(v){return new gt(v,{addons:[]}).delete()},exists:function(v){return new gt(v,{addons:[]}).open().then(function(C){return C.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(v){try{return C=gt.dependencies,R=C.indexedDB,C=C.IDBKeyRange,(sl(R)?Promise.resolve(R.databases()).then(function(j){return j.map(function(G){return G.name}).filter(function(G){return G!==Kn})}):zc(R,C).toCollection().primaryKeys()).then(v)}catch{return Mt(new Te.MissingAPI)}var C,R},defineClass:function(){return function(v){c(this,v)}},ignoreTransaction:function(v){return vt.trans?rr(vt.transless,v):v()},vip:$c,async:function(v){return function(){try{var C=ds(v.apply(this,arguments));return C&&typeof C.then=="function"?C:zt.resolve(C)}catch(R){return Mt(R)}}},spawn:function(v,C,R){try{var j=ds(v.apply(R,C||[]));return j&&typeof j.then=="function"?j:zt.resolve(j)}catch(G){return Mt(G)}},currentTransaction:{get:function(){return vt.trans||null}},waitFor:function(v,C){return C=zt.resolve(typeof v=="function"?gt.ignoreTransaction(v):v).timeout(C||6e4),vt.trans?vt.trans.waitFor(C):C},Promise:zt,debug:{get:function(){return er},set:function(v){ct(v)}},derive:w,extend:c,props:m,override:P,Events:Cs,on:Aa,liveQuery:Oe,extendObservabilitySet:Wl,getByKeyPath:B,setByKeyPath:M,delByKeyPath:function(v,C){typeof C=="string"?M(v,C,void 0):"length"in C&&[].map.call(C,function(R){M(v,R,void 0)})},shallowClone:$,deepClone:X,getObjectDiff:Yl,cmp:vr,asap:D,minKey:-1/0,addons:[],connections:ir,errnames:fe,dependencies:ie,cache:Ri,semVer:"4.2.1",version:"4.2.1".split(".").map(function(v){return parseInt(v)}).reduce(function(v,C,R){return v+C/Math.pow(10,2*R)})})),gt.maxKey=eo(gt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Aa(Es,function(v){Rt||(v=new CustomEvent(_s,{detail:v}),Rt=!0,dispatchEvent(v),Rt=!1)}),addEventListener(_s,function(v){v=v.detail,Rt||It(v)}));var Ke,Rt=!1,br=function(){};return typeof BroadcastChannel<"u"&&((br=function(){(Ke=new BroadcastChannel(_s)).onmessage=function(v){return v.data&&It(v.data)}})(),typeof Ke.unref=="function"&&Ke.unref(),Aa(Es,function(v){Rt||Ke.postMessage(v)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(v){if(!yt.disableBfCache&&v.persisted){er&&console.debug("Dexie: handling persisted pagehide"),Ke?.close();for(var C=0,R=ir;C<R.length;C++)R[C].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(v){!yt.disableBfCache&&v.persisted&&(er&&console.debug("Dexie: handling persisted pageshow"),br(),It({all:new va(-1/0,[[]])}))})),zt.rejectionMapper=function(v,C){return!v||v instanceof U||v instanceof TypeError||v instanceof SyntaxError||!v.name||!se[v.name]?v:(C=new se[v.name](C||v.message,v),"stack"in v&&x(C,"stack",{get:function(){return this.inner.stack}}),C)},ct(er),n(yt,Object.freeze({__proto__:null,Dexie:yt,liveQuery:Oe,Entity:Gn,cmp:vr,PropModification:xa,replacePrefix:function(v,C){return new xa({replacePrefix:[v,C]})},add:function(v){return new xa({add:v})},remove:function(v){return new xa({remove:v})},default:yt,RangeSet:va,mergeRanges:us,rangesOverlap:Xu}),{default:yt}),yt})})(t0)),t0.exports}var GU=HU();const Uw=Dc(GU),t_=Symbol.for("Dexie"),P0=globalThis[t_]||(globalThis[t_]=Uw);if(Uw.semVer!==P0.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Uw.semVer} and ${P0.semVer}`);const{liveQuery:_xe,mergeRanges:Axe,rangesOverlap:Nxe,RangeSet:Pxe,cmp:Ixe,Entity:Rxe,PropModification:Dxe,replacePrefix:Lxe,add:Mxe,remove:Oxe,DexieYProvider:jxe}=P0;class VU extends P0{settings;snippets;ragData;quizzes;quizProgress;quizAnalytics;plans;playlists;projects;chatHistory;images;feedItems;uiState_recentTags;uiState_lastActiveChat;uiState_imageEditor;uiState_scrollPosition;constructor(){super("UnifiedDB"),this.version(1).stores({settings:"userId",snippets:"id, userId, createdAt, updatedAt, projectId, [userId+projectId], [userId+createdAt]",ragData:"id, userId, createdAt, updatedAt, [userId+createdAt]",quizzes:"id, userId, createdAt, updatedAt, projectId, [userId+projectId], [userId+createdAt]",quizProgress:"id, userId, quizId, updatedAt, [userId+quizId], [userId+updatedAt]",quizAnalytics:"id, userId, quizId, createdAt, [userId+quizId], [userId+createdAt]",plans:"id, userId, createdAt, updatedAt, projectId, status, [userId+projectId], [userId+status], [userId+createdAt]",playlists:"id, userId, createdAt, updatedAt, projectId, [userId+projectId], [userId+createdAt]",projects:"id, userId, createdAt, updatedAt, [userId+createdAt]",chatHistory:"id, userId, createdAt, projectId, conversationId, [userId+projectId], [userId+conversationId], [userId+createdAt]",images:"id, userId, createdAt, source, [userId+source], [userId+createdAt]",feedItems:"id, userId, createdAt, updatedAt, projectId, [userId+createdAt]",uiState_recentTags:"userId",uiState_lastActiveChat:"userId",uiState_imageEditor:"userId",uiState_scrollPosition:"userId"})}}const qw=new VU;function WU(t){return{userId:t,version:"2.0.0",language:"en",theme:"auto",providers:[],defaultProvider:void 0,voice:{hotword:"Jarvis",sensitivity:.5,speechTimeout:3.5,conversationTimeout:1e4,silenceThreshold:25,useLocalWhisper:!1,localWhisperUrl:"http://localhost:8000",whisperProvider:"groq"},proxy:{enabled:!1,username:"",password:"",useServerProxy:!1},rag:{enabled:!1,topK:5,scoreThreshold:.7,embeddingProvider:"openai",embeddingModel:"text-embedding-3-small",chunkSize:512,chunkOverlap:50},tts:{enabled:!1,provider:"browser",rate:1,pitch:1,volume:1},createdAt:Date.now(),updatedAt:Date.now()}}async function ZP(t){console.log("[Settings] Loading settings for user:",t);let e=await qw.settings.get(t);return e||(console.log("[Settings] No settings found, creating defaults"),e=WU(t),await qw.settings.put(e)),e}async function eI(t){if(!t.userId)throw new Error("Settings must include userId");t.updatedAt=Date.now(),await qw.settings.put(t),console.log("[Settings] Saved settings for user:",t.userId)}async function YU(t,e){const n={...await ZP(t),...e,userId:t,updatedAt:Date.now()};return await eI(n),n}function QU(t){return t.providers.filter(e=>e.enabled!==!1).sort((e,r)=>(e.priority||999)-(r.priority||999))}const r_=new Set;function KU(t){return r_.has(t)?Promise.resolve():new Promise((e,r)=>{const n=document.createElement("script");n.src=t,n.async=!0,n.onload=()=>{r_.add(t),e()},n.onerror=()=>{r(new Error(`Failed to load script: ${t}`))},document.head.appendChild(n)})}const XU="",JU="",ZU=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest","https://sheets.googleapis.com/$discovery/rest?version=v4"],eq=["https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/spreadsheets"].join(" ");let n_=!1,r0=!1,Wd=null;async function tq(){if(n_){console.log("Google API already initialized");return}return console.log("Initializing Google API..."),await KU("https://apis.google.com/js/api.js"),new Promise((t,e)=>{gapi.load("client:auth2",async()=>{try{await gapi.client.init({apiKey:JU,clientId:XU,discoveryDocs:ZU,scope:eq}),Wd=gapi.auth2.getAuthInstance(),Wd&&Wd.isSignedIn?r0=Wd.isSignedIn.get():r0=!1,n_=!0,console.log(" Google API initialized",{isSignedIn:r0}),t()}catch(r){console.error("Failed to initialize Google API:",r),e(r)}})})}function Hw(){return!Wd||!r0?null:Wd.currentUser.get().getAuthResponse().access_token}const a_="Research Agent";async function rq(t,e){const r=`name='${t}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,a=(await gapi.client.drive.files.list({q:r,fields:"files(id, name)",spaces:"drive"})).result.files;return a&&a.length>0?a[0].id:null}async function nq(t,e){const r={name:t,mimeType:"application/vnd.google-apps.folder"};return(await gapi.client.drive.files.create({resource:r,fields:"id"})).result.id}async function tI(){console.log("[GoogleDrive] Ensuring root folder...");let t=await rq(a_);return t||(console.log("[GoogleDrive] Creating root folder..."),t=await nq(a_)),console.log("[GoogleDrive] Root folder ID:",t),t}async function rI(t,e){const r=e?`name='${t}' and '${e}' in parents and trashed=false`:`name='${t}' and trashed=false`,a=(await gapi.client.drive.files.list({q:r,fields:"files(id, name)",spaces:"drive"})).result.files;return a&&a.length>0?a[0].id:null}async function aq(t,e,r){console.log(`[GoogleDrive] Uploading ${t}...`);const n=JSON.stringify(e,null,2),a=new Blob([n],{type:"application/json"}),s=await rI(t,r);if(s){console.log(`[GoogleDrive] Updating existing file: ${s}`);const i=Hw();if(!i)throw new Error("Not signed in to Google");const l=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${s}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:a});if(!l.ok)throw new Error(`Failed to update file: ${l.statusText}`);return s}else{console.log("[GoogleDrive] Creating new file");const i={name:t,mimeType:"application/json"};r&&(i.parents=[r]);const l=Hw();if(!l)throw new Error("Not signed in to Google");const c=new FormData;c.append("metadata",new Blob([JSON.stringify(i)],{type:"application/json"})),c.append("file",a);const d=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart&fields=id",{method:"POST",headers:{Authorization:`Bearer ${l}`},body:c});if(!d.ok)throw new Error(`Failed to create file: ${d.statusText}`);return(await d.json()).id}}async function sq(t,e){console.log(`[GoogleDrive] Downloading ${t}...`);const r=await rI(t,e);if(!r)return console.log(`[GoogleDrive] File not found: ${t}`),null;const n=Hw();if(!n)throw new Error("Not signed in to Google");const a=await fetch(`https://www.googleapis.com/drive/v3/files/${r}?alt=media`,{headers:{Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error(`Failed to download file: ${a.statusText}`);const s=await a.text();return JSON.parse(s)}async function iq(t){console.log("[GoogleDrive] Uploading settings...");const{userId:e,...r}=t,n=await tI();return await aq("settings.json",r,n)}async function oq(t){console.log("[GoogleDrive] Loading settings...");const e=await tI(),r=await sq("settings.json",e);return r?{...r,userId:t}:null}const nI=N.createContext(void 0);function lq({children:t}){const{user:e}=oi(),[r,n]=N.useState(null),[a,s]=N.useState(!0),[i,l]=N.useState(null),[c,d]=N.useState(null);N.useEffect(()=>{if(!e){n(null),s(!1);return}p()},[e]);const p=async()=>{if(e){s(!0),l(null);try{const P=await ZP(e.email);n(P)}catch(P){console.error("[SettingsContext] Failed to load settings:",P),l(P instanceof Error?P:new Error("Failed to load settings"))}finally{s(!1)}}},g=N.useCallback(async P=>{if(!e)throw new Error("User not authenticated");try{await YU(e.email,P),await p()}catch(F){throw console.error("[SettingsContext] Failed to update settings:",F),F}},[e]),m=N.useCallback(async()=>{await p()},[e]),y=N.useCallback(()=>r?QU(r):[],[r]),x=N.useCallback(async P=>{if(!e||!r)throw new Error("User not authenticated or settings not loaded");const F=r.providers.findIndex(B=>B.id===P.id),D=[...r.providers];F>=0?D[F]=P:D.push(P),await g({providers:D})},[e,r,g]),w=N.useCallback(async P=>{if(!e||!r)throw new Error("User not authenticated or settings not loaded");const D={providers:r.providers.filter(B=>B.id!==P)};r.defaultProvider===P&&(D.defaultProvider=void 0),await g(D)},[e,r,g]),T=N.useCallback(async()=>{if(!e||!r)throw new Error("User not authenticated or settings not loaded");try{await iq(r),d(new Date),console.log("[SettingsContext] Settings synced to Drive")}catch(P){throw console.error("[SettingsContext] Failed to sync to Drive:",P),P}},[e,r]),k=N.useCallback(async()=>{if(!e)throw new Error("User not authenticated");try{const P=await oq(e.email);P&&(await eI(P),n(P),d(new Date),console.log("[SettingsContext] Settings loaded from Drive"))}catch(P){throw console.error("[SettingsContext] Failed to load from Drive:",P),P}},[e]),_={settings:r,loading:a,error:i,updateSettings:g,reloadSettings:m,getEnabledProviders:y,saveProvider:x,removeProvider:w,syncToDrive:T,loadFromDrive:k,lastSyncTime:c};return u.jsx(nI.Provider,{value:_,children:t})}function vo(){const t=N.useContext(nI);if(!t)throw new Error("useSettings must be used within a SettingsProvider");return t}const cq="Snippets";async function uq(t){try{const e=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${encodeURIComponent("Research Agent Swag")}' and mimeType='application/vnd.google-apps.spreadsheet' and trashed=false&fields=files(id,name)`,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error(`Drive API error: ${e.statusText}`);const n=(await e.json()).files||[];if(n.length===0)return console.warn(' "Research Agent Swag" spreadsheet not found'),null;const a=n[0].id;return console.log(` Found "Research Agent Swag" spreadsheet: ${a}`),a}catch(e){throw console.error(" Error finding snippets spreadsheet:",e),e}}function dq(t){if(!t||t.length<5)return null;const[e,r,n,a,s,i,l]=t;if(!e||e==="id"||!s)return null;const c=i?i.split(",").map(m=>m.trim()).filter(Boolean):[],d=r?new Date(r).getTime():Date.now(),p=n?new Date(n).getTime():d,g=l==="chat"||l==="assistant"?"assistant":l==="user"?"user":"tool";return{id:`sheet-${e}`,content:s||"",title:a||void 0,timestamp:d,updateDate:p,sourceType:g,selected:!1,tags:c,hasEmbedding:!1}}async function hq(t,e){try{const r=await uq(e);if(!r)throw new Error("Snippets spreadsheet not found");const n=await ES(r,`${cq}!A:H`);if(!n||n.length<2)return console.warn(" No snippets found in spreadsheet"),null;for(let a=1;a<n.length;a++){const s=n[a];if(parseInt(s[0],10)===t){const l=dq(s);if(l)return console.log(` Fetched snippet #${t} from Google Sheets:`,l.title),l}}return console.warn(` Snippet #${t} not found in Google Sheets`),null}catch(r){throw console.error(` Error fetching snippet #${t}:`,r),r}}const aI=N.createContext(void 0),rf=()=>{const t=N.useContext(aI);if(!t)throw new Error("useSwag must be used within SwagProvider");return t},pq=({children:t})=>{const[e,r]=N.useState([]),[n,a]=N.useState(!1),[s,i]=N.useState(null),[l,c]=N.useState(null),{showError:d,showWarning:p,showSuccess:g,showPersistentToast:m,removeToast:y,updateToast:x}=jl(),{user:w,getToken:T}=oi(),{settings:k}=vo(),{getCurrentProjectId:_,currentProject:P}=ef(),F=N.useRef({snippets:[]}),D=N.useCallback(async()=>{if(F.current.snippets.length===0)return;const se=[...F.current.snippets];F.current.snippets=[];const be=localStorage.getItem("rag_spreadsheet_id"),xe=localStorage.getItem("rag_google_linked")==="true";if(be&&xe&&zd()&&w?.email)try{const{syncSnippetsToSheets:de}=await Zt(async()=>{const{syncSnippetsToSheets:he}=await Promise.resolve().then(()=>$w);return{syncSnippetsToSheets:he}},void 0);await de(be,se)}catch(de){console.error(" Failed to sync batch:",de),se.forEach(he=>{Ua.queueSync({type:"push-snippet",data:he,userEmail:w.email})})}},[w?.email]),B=N.useCallback(se=>{F.current.snippets.push(se),F.current.timeoutId&&clearTimeout(F.current.timeoutId),F.current.timeoutId=setTimeout(()=>{D()},2e3)},[D]),M=N.useMemo(()=>{const se=P?.id||null;return se?e.filter(be=>be.projectId===se):e.filter(be=>!be.projectId)},[e,P]);N.useEffect(()=>{(async()=>{try{const be=await Go.getItem("swag-snippets");if(be&&r(be),a(!0),Z())try{console.log(" Checking Google Drive for newer snippets and embeddings...");const xe=await ls.syncImages();xe.success&&xe.action==="downloaded"&&console.log(` Downloaded ${xe.itemCount} images from Google Drive`);const me=await ls.syncSnippets();if(me.success&&me.action==="downloaded"){console.log(` Downloaded ${me.itemCount} snippets from Google Drive`);const he=await Go.getItem("swag-snippets");he&&r(he)}const de=await ls.syncEmbeddings();de.success&&de.action==="downloaded"&&console.log(` Downloaded ${de.itemCount} embeddings from Google Drive`)}catch(xe){console.error("Failed to sync with Google Drive on load:",xe)}}catch(be){console.error("Failed to load snippets:",be),d("Failed to load snippets from storage"),a(!0)}})()},[d]),N.useEffect(()=>{const se=async()=>{console.log(" [SwagContext] Sync complete, reloading snippets from storage...");try{const be=await Go.getItem("swag-snippets");be&&(r(be),console.log(` Reloaded ${be.length} snippets after cloud sync`))}catch(be){console.error("Failed to reload snippets after cloud sync:",be)}};return window.addEventListener("sync-complete",se),()=>window.removeEventListener("sync-complete",se)},[]);const $=se=>se<1024?se+" B":se<1024*1024?(se/1024).toFixed(2)+" KB":(se/(1024*1024)).toFixed(2)+" MB";N.useEffect(()=>{if(!n)return;(async()=>{try{await Go.setItem("swag-snippets",e);const be=await Go.getStats();i({totalSize:be.totalSize,limit:be.limit,percentUsed:be.percentUsed}),be.percentUsed>80&&p(`Storage is ${be.percentUsed.toFixed(0)}% full. Consider deleting old snippets.`)}catch(be){if(be instanceof kc)if(be.code==="QUOTA_EXCEEDED"){const xe=be.estimatedSize&&be.limit?`Current size: ${$(be.estimatedSize)}, Limit: ${$(be.limit)}`:"";d(`Storage Quota Exceeded! ${be.message} ${xe}`)}else d(`Storage error: ${be.message}`);else console.error("Failed to save snippets:",be),d("Failed to save snippets to storage")}})()},[e,n,d,p]),N.useEffect(()=>{if(!n)return;if(e.length===0){console.log(" Skipping garbage collection - no snippets loaded yet");return}const se=setInterval(async()=>{try{console.log(` [GC Interval] Running with ${e.length} snippets`),e.forEach((de,he)=>{const Ie=de.content.includes("swag-image://"),ze=de.title||"Untitled";console.log(` [GC] Snippet ${he+1}: "${ze.substring(0,50)}" - hasImages: ${Ie}`)});const xe=e.map(de=>de.content),me=await po.garbageCollect(xe);me>0&&console.log(` Garbage collected ${me} orphaned images from IndexedDB`)}catch(xe){console.error("Failed to garbage collect images:",xe)}},300*1e3),be=setTimeout(async()=>{try{console.log(` [Initial GC] Running with ${e.length} snippets`),e.forEach((de,he)=>{const Ie=de.content.includes("swag-image://"),ze=de.title||"Untitled";console.log(` [GC] Snippet ${he+1}: "${ze.substring(0,50)}" - hasImages: ${Ie}`)});const xe=e.map(de=>de.content),me=await po.garbageCollect(xe);me>0&&console.log(` Initial garbage collection: removed ${me} orphaned images`)}catch(xe){console.error("Failed to run initial garbage collection:",xe)}},6e4);return()=>{clearInterval(se),clearTimeout(be)}},[e,n]),N.useEffect(()=>{if(!n||!Z())return;const se=setTimeout(async()=>{try{console.log(" Syncing snippets to Google Drive...");const be=await ls.syncSnippets();be.success&&be.action!=="no-change"&&console.log(` Snippets synced: ${be.action} (${be.itemCount} items)`)}catch(be){console.error("Failed to sync snippets to Google Drive:",be)}},1e4);return()=>clearTimeout(se)},[M,n]);const Z=()=>{try{const se=localStorage.getItem("google_drive_access_token");return!!se&&se.length>0}catch(se){console.error("Failed to check authentication:",se)}return!1},z=async()=>{try{const se=localStorage.getItem("rag_spreadsheet_id");if(se)return console.log("Using cached spreadsheet ID:",se),se;console.log(" Getting Google Drive API access token from googleAuth service...");const{googleAuth:be}=await Zt(async()=>{const{googleAuth:Ie}=await Promise.resolve().then(()=>Ng);return{googleAuth:Ie}},void 0);if(!be.isAuthenticated())throw console.error(" User not authenticated"),new Error("Please log in with Google Drive first (Settings  Cloud Sync)");const xe=be.getAccessToken();if(!xe)throw console.error(" No access token available"),new Error("No access token available - please reconnect Google Drive");if(console.log(" Using access token from googleAuth service"),!xe)throw console.error("No Drive API access token available"),new Error("No Drive API access token - unable to access Google Sheets");const me=await dn();console.log(" Calling getUserRagSpreadsheet at:",me);const de=await fetch(`${me}/rag/user-spreadsheet`,{method:"GET",headers:{Authorization:`Bearer ${xe}`}});if(!de.ok){const Ie=await de.text();console.error(" Backend error response:",{status:de.status,statusText:de.statusText,body:Ie});let ze=`Failed to get spreadsheet: ${de.status}`;try{const nt=JSON.parse(Ie);nt.error&&(ze=nt.error)}catch{}throw new Error(ze)}const he=await de.json();return localStorage.setItem("rag_spreadsheet_id",he.spreadsheetId),he.created?(console.log(" Created new RAG spreadsheet:",he.spreadsheetId),p('Created new "Research Agent Swag" spreadsheet in your Google Drive')):console.log(" Found existing RAG spreadsheet:",he.spreadsheetId),he.spreadsheetId}catch(se){return console.error("Failed to get user RAG spreadsheet:",se),null}};N.useEffect(()=>((async()=>{if(!(!w?.email||!Z()||!n))try{if(!await z()){console.warn("Could not get user RAG spreadsheet - sync disabled"),p("Cannot access Google Sheets. Please check your Google Drive connection in Settings > Cloud Sync.");return}await Ua.initialize({enabled:!0,autoSync:!0,syncInterval:6e4,batchSize:50,retryAttempts:3,deviceId:Ua.getDeviceId()}),Ua.onSyncStart(()=>{c(Ua.getStatus())}),Ua.onSyncComplete(de=>{c(Ua.getStatus()),de&&de.snippetsPulled>0&&console.log(`Synced ${de.snippetsPulled} snippets from cloud`)}),Ua.onSyncError((de,he)=>{console.error("Sync error:",he),c(Ua.getStatus()),he&&d(`Sync failed: ${he.message}`)}),console.log("Performing initial sync...");const xe=await T(),me=await Ua.pullSnippets(w.email,xe||void 0);me&&me.length>0&&(r(de=>{const he=new Set(de.map(nt=>nt.id)),Ie=me.filter(nt=>!he.has(nt.id)),ze=de.map(nt=>{const mt=me.find(ht=>ht.id===nt.id);return mt&&mt.updateDate>nt.updateDate?mt:nt});return[...Ie,...ze].sort((nt,mt)=>mt.updateDate-nt.updateDate)}),console.log(`Downloaded ${me.length} snippets from cloud`)),M.length>0&&await Ua.pushSnippets(M,w.email,xe||void 0),Ua.startAutoSync(),console.log(" RAG sync initialized and auto-sync started")}catch(be){console.error("Failed to initialize sync:",be),d("Cloud sync failed to initialize. Check your Google Drive connection in Settings > Cloud Sync.")}})(),()=>{Z()&&Ua.stopAutoSync()}),[w?.email,n,d]);const ee=()=>{try{const se=localStorage.getItem("rag_config");if(se){const be=JSON.parse(se);return be.enabled&&be.autoEmbed}}catch(se){console.error("Failed to check RAG config:",se)}return!1},te=async(se,be,xe)=>{if(ee())try{const me=await dn(),de=await fetch(`${me}/rag/ingest`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:be,sourceType:"snippet",title:xe||`Snippet ${se}`,snippetId:se})});if(!de.ok){console.warn(" Auto-embed failed (backend may not support this feature). Use browser-based embeddings instead.");return}const he=de.body?.getReader(),Ie=new TextDecoder;if(he)for(;;){const{done:ze,value:nt}=await he.read();if(ze)break;const ht=Ie.decode(nt).split(`
`);for(const er of ht)if(er.startsWith("data: ")){const ct=JSON.parse(er.substring(6));ct.error&&console.error("Auto-embed error:",ct.error),ct.message&&console.log("Auto-embed:",ct.message)}}r(ze=>ze.map(nt=>nt.id===se?{...nt,hasEmbedding:!0}:nt))}catch(me){console.warn(" Auto-embed failed:",me instanceof Error?me.message:me),console.log(" Tip: You can disable auto-embed in RAG settings or use browser-based embeddings")}},X=async(se,be,xe,me,de)=>{console.log(` addSnippet called with content length: ${se.length}`),console.log(" Content preview:",se.substring(0,200)),console.log(" Has swag-image:// refs?",se.includes("swag-image://")),console.log(" Has data: URIs?",se.includes("data:image"));let he=se;try{he=await po.processContentForSave(se),he!==se&&(console.log(" Extracted images to IndexedDB"),console.log(" Processed content preview:",he.substring(0,200)))}catch(ht){console.error("Failed to process images, using original content:",ht)}if(de){const ht=e.find(er=>er.sharedGoogleDocId===de);if(ht)return console.log(" Snippet already saved from this Google Doc, returning existing:",ht.id),ht}const Ie=e.find(ht=>ht.content.trim()===he.trim());if(Ie){const ht={updateDate:Date.now()};if(me&&me.length>0){const er=Ie.tags||[];ht.tags=[...new Set([...er,...me])]}return await Q(Ie.id,ht),Ie}const ze=Date.now(),nt=_(),mt={id:`snippet-${ze}-${Math.random().toString(36).substr(2,9)}`,content:he,title:xe,sourceType:be,timestamp:ze,updateDate:ze,selected:!1,tags:me&&me.length>0?me:void 0,projectId:nt||void 0,sharedGoogleDocId:de||void 0};if(console.log(" Saving snippet:",{id:mt.id,title:mt.title,contentLength:mt.content.length,hasSwagImageRefs:mt.content.includes("swag-image://"),contentPreview:mt.content.substring(0,200)}),r(ht=>[mt,...ht]),Z()&&w?.email){const ht=localStorage.getItem("rag_spreadsheet_id"),er=localStorage.getItem("rag_google_linked")==="true";ht&&er&&zd()?B(mt):Ua.queueSync({type:"push-snippet",data:mt,userEmail:w.email})}return await te(mt.id,se,xe),ls.triggerAutoSync(),mt},Q=async(se,be)=>{const xe=M.find(he=>he.id===se),me={...be};if(be.content)try{const he=await po.processContentForSave(be.content);he!==be.content&&(console.log(" Extracted images to IndexedDB during update"),me.content=he)}catch(he){console.error("Failed to process images during update:",he)}const de={...xe,...me,updateDate:Date.now()};if(r(he=>he.map(Ie=>Ie.id===se?de:Ie)),Z()&&w?.email){const he=localStorage.getItem("rag_spreadsheet_id"),Ie=localStorage.getItem("rag_google_linked")==="true";he&&Ie&&zd()?B(de):Ua.queueSync({type:"push-snippet",data:de,userEmail:w.email})}if(xe&&me.content&&me.content!==xe.content)if(be.content?/<img[^>]*>|!\[[^\]]*\]\([^)]+\)/.test(be.content):!1)console.log("  Skipping embedding for image snippet:",se);else{const Ie=be.title!==void 0?be.title:xe.title;await te(se,be.content||me.content,Ie)}ls.triggerAutoSync()},W=async se=>{if(r(be=>be.filter(xe=>!se.includes(xe.id))),Z()&&w?.email){const be=localStorage.getItem("rag_spreadsheet_id"),xe=localStorage.getItem("rag_google_linked")==="true";if(be&&xe&&zd())try{console.log(`  Deleting ${se.length} snippets from Google Sheets (client-side)...`);const{deleteSnippetsFromSheets:de}=await Zt(async()=>{const{deleteSnippetsFromSheets:Ie}=await Promise.resolve().then(()=>$w);return{deleteSnippetsFromSheets:Ie}},void 0),he=await de(be,se);console.log(` Deleted ${he} snippets from Google Sheets`)}catch(de){console.error(" Client-side snippet delete failed, falling back to backend:",de),se.forEach(he=>{Ua.queueSync({type:"delete-snippet",data:{id:he},userEmail:w.email})})}else se.forEach(de=>{Ua.queueSync({type:"delete-snippet",data:{id:de},userEmail:w.email})})}ls.triggerAutoSync()},H=se=>{if(se.length<2)return;const be=M.filter(Ie=>se.includes(Ie.id)).sort((Ie,ze)=>Ie.timestamp-ze.timestamp),xe=be.map(Ie=>Ie.content).join(`

---

`),me=be.filter(Ie=>Ie.title).map(Ie=>Ie.title).join(" + "),de=Date.now(),he={id:`snippet-${de}-${Math.random().toString(36).substr(2,9)}`,content:xe,title:me||void 0,sourceType:be[0].sourceType,timestamp:de,updateDate:de,selected:!1};r(Ie=>[he,...Ie.filter(ze=>!se.includes(ze.id))])},re=se=>{r(be=>be.map(xe=>xe.id===se?{...xe,selected:!xe.selected}:xe))},ne=()=>{r(se=>se.map(be=>({...be,selected:!0})))},ve=()=>{r(se=>se.map(be=>({...be,selected:!1})))},O=()=>M.filter(se=>se.selected),I=()=>{const se=new Set;return M.forEach(be=>{be.tags&&be.tags.forEach(xe=>{xe.startsWith("admin:")||se.add(xe)})}),Array.from(se).sort()},K=(se,be)=>{r(xe=>xe.map(me=>{if(se.includes(me.id)){const de=me.tags||[],he=[...new Set([...de,...be])];return{...me,tags:he,updateDate:Date.now()}}return me}))},U=(se,be)=>{r(xe=>xe.map(me=>{if(se.includes(me.id)&&me.tags){const de=me.tags.filter(he=>!be.includes(he));return{...me,tags:de.length>0?de:void 0,updateDate:Date.now()}}return me}))},ce=async se=>{try{return await Is.hasEmbedding(se)}catch(be){return console.error("Error checking embedding status:",be),!1}},ye=async se=>{try{const be=await Is.getEmbeddingDetails(se);return be.hasEmbedding?be:M.find(me=>me.id===se)?.hasEmbedding?{hasEmbedding:!0,chunkCount:1,chunks:[]}:{hasEmbedding:!1,chunkCount:0,chunks:[]}}catch(be){return console.error("Error getting embedding details:",be),{hasEmbedding:!1,chunkCount:0,chunks:[]}}},Ae=async()=>{try{const se=M.map(xe=>xe.id);if(se.length===0)return;const be=await Is.bulkCheckEmbeddings(se);r(xe=>xe.map(me=>({...me,hasEmbedding:be[me.id]||!1})))}catch(se){console.error("Failed to check embedding status:",se)}},fe=async(se,be,xe=!1)=>{const me=M.filter(Ie=>se.includes(Ie.id));if(me.length===0)return{embedded:0,skipped:0,failed:0};let de=me,he=0;if(!xe){const Ie=await Is.bulkCheckEmbeddings(se),ze=se.filter(nt=>Ie[nt]);if(ze.length>0){if(console.log(` Skipping ${ze.length} already indexed snippets:`,ze),de=me.filter(nt=>!Ie[nt.id]),he=ze.length,de.length===0)return console.log(" All selected snippets already have embeddings"),p(` All ${me.length} snippets already indexed`),{embedded:0,skipped:he,failed:0};p(` Skipping ${he} already indexed, generating ${de.length} new embeddings`)}}try{const Ie=k?.embeddingSource==="local";console.log(` Embedding source check: embeddingSource="${k?.embeddingSource}", useLocalEmbeddings=${Ie}, embeddingModel="${k?.embeddingModel}"`);let ze=[];if(Ie){console.log(" Using local browser-based embeddings");const{getLocalEmbeddingService:Dt}=await Zt(async()=>{const{getLocalEmbeddingService:Gt}=await import("./localEmbeddings-D9Rjvy7I.js");return{getLocalEmbeddingService:Gt}},[]),kt=Dt(),fr=k?.embeddingModel||"Xenova/all-MiniLM-L6-v2",qe=fr.replace("Xenova/","");console.log(` Loading model: ${fr}`);let st=null;st=m(` Loading local model ${qe}...`,"info"),await kt.loadModel(fr,Gt=>{if(console.log(` ${Gt.message} (${Gt.progress}%)`),st){const Kt=Math.round(Gt.progress);x(st,` Loading local model ${qe}... ${Kt}%`,Kt)}}),st&&(y(st),st=null),console.log(" Model loaded, generating embeddings...");for(let Gt=0;Gt<de.length;Gt++){const Kt=de[Gt];try{be&&be(Gt+1,de.length);const lr=[];Kt.title&&lr.push(`Title: ${Kt.title}`),Kt.tags&&Kt.tags.length>0&&lr.push(`Tags: ${Kt.tags.join(", ")}`);const Yt=(lr.length>0?lr.join(`
`)+`

`:"")+Kt.content,ur=await kt.generateEmbedding(Yt),_t={id:`${Kt.id}_0`,snippet_id:Kt.id,chunk_text:Kt.content,chunk_index:0,start_char:0,end_char:Kt.content.length,embedding:ur,created_at:Date.now(),updated_at:Date.now()};ze.push({id:Kt.id,status:"success",chunks:[_t]})}catch(lr){console.error(` Failed to embed snippet ${Kt.id}:`,lr),ze.push({id:Kt.id,status:"failed",error:lr instanceof Error?lr.message:"Unknown error",chunks:[]})}}}else{let Dt,kt=0;const fr=3;for(;kt<=fr;)try{const lr=await dn(),Qe=await T();if(!Qe)throw new Error(` Authentication Required

To generate embeddings, you need to sign in with Google.

 Steps:
1. Click the profile icon in the top right
2. Click "Sign in with Google"
3. Authorize the application
4. Try generating embeddings again

 Note: Embeddings enable vector search and semantic similarity in SWAG.`);const Yt=(k?.providers||[]).filter(_t=>_t.enabled!==!1&&_t.capabilities?.embedding!==!1).map(_t=>({type:_t.type,apiKey:_t.apiKey,apiEndpoint:_t.apiEndpoint,modelName:_t.modelName,allowedModels:_t.allowedModels,maxImageQuality:_t.maxImageQuality})),ur=k?.embeddingModel||void 0;if(Dt=await fetch(`${lr}/rag/embed-snippets`,{method:"POST",headers:{"Content-Type":"application/json",...Qe?{Authorization:`Bearer ${Qe}`}:{}},body:JSON.stringify({snippets:de.map(_t=>({id:_t.id,content:_t.content,title:_t.title,tags:_t.tags,timestamp:_t.timestamp})),providers:Yt,embeddingModel:ur,force:xe})}),Dt.status===429&&kt<fr){const _t=Math.pow(2,kt)*1e3;console.warn(` Rate limited, retrying in ${_t/1e3}s... (attempt ${kt+1}/${fr})`),p(` Rate limited, retrying in ${_t/1e3}s...`),await new Promise(sr=>setTimeout(sr,_t)),kt++;continue}break}catch(lr){if(kt<fr){const Qe=Math.pow(2,kt)*1e3;console.warn(` Fetch error, retrying in ${Qe/1e3}s...`,lr),await new Promise(Yt=>setTimeout(Yt,Qe)),kt++;continue}throw lr}if(!Dt||!Dt.ok){const lr=await Dt?.text()||"No response";let Qe;try{Qe=JSON.parse(lr)}catch{Qe={error:lr}}throw Qe.requiredAction==="CONFIGURE_EMBEDDING_PROVIDER"||Qe.error&&Qe.error.includes("No embedding provider")?new Error(` Embedding Provider Required

To use Swag embeddings and vector search, you need to configure a provider that supports embeddings.

 Steps:
1. Go to Settings (gear icon)
2. Click "Providers" tab
3. Add a provider: OpenAI, Together.AI, Cohere, or Voyage
4. Enable the " Embeddings" capability
5. Save and try again

 Note: Swag embeddings work independently of the RAG system. You just need one embedding-capable provider configured.`):new Error(`Failed to generate embeddings: ${Dt?.status} ${Dt?.statusText}. ${lr}`)}const qe=await Dt.json(),st=qe.results?.[0]?.chunks?.[0]?.embedding;console.log(" Backend response:",{success:qe.success,resultsCount:qe.results?.length,firstResult:qe.results?.[0],firstChunk:qe.results?.[0]?.chunks?.[0],firstChunkKeys:qe.results?.[0]?.chunks?.[0]?Object.keys(qe.results[0].chunks[0]):[],firstChunkEmbeddingLength:st?.length,firstChunkEmbeddingType:st?.constructor?.name,firstChunkEmbeddingFirst5:Array.isArray(st)?st.slice(0,5):"NOT_AN_ARRAY"});const{success:Gt,error:Kt}=qe;if(ze=qe.results,!Gt)throw new Error(Kt||"Failed to generate embeddings")}const nt=[];let mt=0,ht=0,er=0;for(let Dt=0;Dt<ze.length;Dt++){const kt=ze[Dt];if(kt.status==="success"&&kt.chunks.length>0){console.log(" Chunk structure check:",{chunkCount:kt.chunks.length,firstChunk:kt.chunks[0],hasId:kt.chunks[0]?.id!==void 0,hasSnippetId:kt.chunks[0]?.snippet_id!==void 0});try{await Is.saveChunks(kt.chunks,{snippet_id:kt.id,created_at:Date.now(),updated_at:Date.now()}),nt.push(kt.id),mt+=kt.chunks.length,ht++,console.log(` Saved ${kt.chunks.length} chunks for snippet ${kt.id}`)}catch(fr){er++,console.error(` Failed to save chunks for snippet ${kt.id}:`,fr)}be&&be(Dt+1,ze.length)}else kt.status==="failed"&&(er++,console.error(`Failed to embed snippet ${kt.id}:`,kt.error))}r(Dt=>Dt.map(kt=>nt.includes(kt.id)?{...kt,hasEmbedding:!0}:kt));const ct=ze.filter(Dt=>Dt.status==="success").flatMap(Dt=>Dt.chunks);if(console.log(" Google Sheets sync check:",{chunksToSync:ct.length,userEmail:w?.email,spreadsheetId:localStorage.getItem("rag_spreadsheet_id"),googleLinked:localStorage.getItem("rag_google_linked")}),ct.length>0&&w?.email)try{const Dt=localStorage.getItem("rag_spreadsheet_id");if(!Dt)console.warn(" No spreadsheet ID found. Skipping Google Sheets sync."),console.log(" To enable sync: Go to Settings > Cloud Sync and connect Google Drive"),p(" Embeddings saved locally. Connect Google Drive in Cloud Sync settings to enable automatic backup.");else{const fr=localStorage.getItem("rag_google_linked")==="true"&&zd();if(console.log(` Sync method: ${fr?"Client-side direct":"Backend"}`),fr){console.log(` Using direct Google Sheets sync for ${ct.length} chunks (client-side)...`);try{const qe=QP(ct);console.log(` Formatted ${qe.length} rows for Google Sheets`),await Ly(Dt,"RAG_Embeddings_v1!A:K",qe),console.log(" Synced to Google Sheets (client-side)"),p(` Synced ${ct.length} embeddings to Google Sheets`)}catch(qe){console.error(" Client-side sync failed, falling back to backend:",qe),p(" Direct sync failed, using backend fallback..."),setTimeout(async()=>{try{await Ua.pushEmbeddings(ct,(st,Gt)=>{console.log(` Backend sync: ${st}/${Gt} chunks`)}),console.log(" Synced to Google Sheets (backend fallback)"),p(` Synced ${ct.length} embeddings to Google Sheets (backend)`)}catch(st){console.error("Backend sync also failed:",st),p(" Embeddings saved locally but sync to Google Sheets failed")}},2e3)}}else console.log(` Using backend sync for ${ct.length} chunks (with 2s delay)...`),setTimeout(async()=>{try{console.log(" Starting backend Google Sheets sync..."),await Ua.pushEmbeddings(ct,(qe,st)=>{console.log(` Syncing: ${qe}/${st} chunks`)}),console.log(" Synced to Google Sheets (backend)"),p(` Synced ${ct.length} embeddings to Google Sheets`)}catch(qe){console.error("Failed to sync to Google Sheets:",qe),p(" Embeddings saved locally but sync to Google Sheets failed")}},2e3)}}catch(Dt){console.error("Failed to queue sync:",Dt)}return console.log(` Generated ${mt} embeddings for ${ht} snippets`),Z()&&(async()=>{try{console.log(" Syncing embeddings to Google Drive...");const Dt=await ls.syncEmbeddings();Dt.success&&Dt.action!=="no-change"&&console.log(` Embeddings synced: ${Dt.action} (${Dt.itemCount} chunks)`)}catch(Dt){console.error("Failed to sync embeddings to Google Drive:",Dt)}})(),{embedded:ht,skipped:he+(ze.length-ht-er),failed:er}}catch(Ie){throw console.error("Failed to generate embeddings:",Ie),Ie}},Ne=async()=>{if(!w?.email){p("Please sign in with Google to sync");return}if(!Z()){p("Cloud sync requires Google Drive connection. Go to Settings > Cloud Sync to connect.");return}try{console.log(" Manual sync triggered"),console.log(" Ensuring spreadsheet exists...");const se=await z();if(!se){d("Failed to create or access Google Sheets spreadsheet");return}console.log(" Spreadsheet ready:",se),console.log(" Pulling remote snippets...");try{const be=localStorage.getItem("google_drive_access_token");if(!be)console.warn("No Drive token available for pull");else{const xe=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${se}/values/RAG_Snippets_v1!A2:J10000`,{headers:{Authorization:`Bearer ${be}`}}).then(me=>me.json()).then(me=>me.values||[]);if(xe.length>0){console.log(` Received ${xe.length} rows from Sheets`);const me=new Map;xe.forEach(he=>{const Ie=he[0];me.has(Ie)||me.set(Ie,[]),me.get(Ie).push(he)});const de=[];me.forEach((he,Ie)=>{he.sort((mt,ht)=>parseInt(mt[8]||"1")-parseInt(ht[8]||"1"));const ze=he[0],nt=he.map(mt=>mt[2]||"").join("");de.push({id:Ie,title:ze[1]||"",content:nt,timestamp:parseInt(ze[5])||Date.now(),updateDate:parseInt(ze[6])||Date.now(),sourceType:ze[7]||"user",tags:ze[4]?JSON.parse(ze[4]):[]})}),console.log(` Reassembled ${de.length} snippets from ${xe.length} rows`),r(he=>{const Ie=new Set(he.map(mt=>mt.id)),ze=de.filter(mt=>!Ie.has(mt.id)),nt=he.map(mt=>{const ht=de.find(er=>er.id===mt.id);return ht&&ht.updateDate>mt.updateDate?ht:mt});return[...ze,...nt].sort((mt,ht)=>ht.updateDate-mt.updateDate)})}else console.log(" No remote snippets found")}}catch(be){console.error(" Pull failed:",be)}if(console.log(" Pushing local snippets..."),M.length>0){const be=localStorage.getItem("google_drive_access_token");if(!be){d("No Drive API access token available");return}const xe=49e3,me=[];M.forEach(ze=>{const nt=ze.content||"";if(nt.length<=xe)me.push([ze.id,ze.title||"",nt,"",JSON.stringify(ze.tags||[]),ze.timestamp.toString(),ze.updateDate.toString(),ze.sourceType,"1","1"]);else{const mt=Math.ceil(nt.length/xe);for(let ht=0;ht<mt;ht++){const er=ht*xe,ct=Math.min((ht+1)*xe,nt.length),Dt=nt.substring(er,ct);me.push([ze.id,ht===0&&ze.title||"",Dt,"",ht===0?JSON.stringify(ze.tags||[]):"[]",ze.timestamp.toString(),ze.updateDate.toString(),ze.sourceType,(ht+1).toString(),mt.toString()])}}}),console.log(` Prepared ${me.length} rows from ${M.length} snippets`),console.log(" Clearing existing data...");const de=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${se}/values/RAG_Snippets_v1!A2:J10000:clear`,{method:"POST",headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"}});if(!de.ok){const ze=await de.text();console.error("Clear error:",ze)}console.log(` Writing ${me.length} rows...`);const he=await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${se}/values/RAG_Snippets_v1!A2?valueInputOption=RAW`,{method:"PUT",headers:{Authorization:`Bearer ${be}`,"Content-Type":"application/json"},body:JSON.stringify({values:me})});if(!he.ok){const ze=await he.text();throw console.error(" Update error:",ze),new Error(`Failed to update sheet: ${he.status} ${ze}`)}const Ie=await he.json();console.log(` Pushed ${M.length} snippets (${me.length} rows) to Google Sheets`,Ie)}else console.log(" No local snippets to push");console.log(" Manual sync complete"),g(`Synced ${M.length} snippets with Google Sheets`)}catch(se){console.error(" Manual sync failed:",se),d(`Manual sync failed: ${se instanceof Error?se.message:"Unknown error"}`)}},Te=async se=>{try{console.log(` Syncing snippet #${se} from Google Sheets...`);const{googleAuth:be}=await Zt(async()=>{const{googleAuth:he}=await Promise.resolve().then(()=>Ng);return{googleAuth:he}},void 0);if(!be.isAuthenticated())throw new Error("Please log in with Google Drive first (Settings  Cloud Sync)");const xe=be.getAccessToken();if(!xe)throw new Error("No Drive access token available - please reconnect Google Drive");const me=await hq(se,xe);if(!me){console.warn(` Snippet #${se} not found in Google Sheets`);return}const de=M.find(he=>he.id===me.id||he.content.trim()===me.content.trim());if(de){console.log(` Snippet #${se} already exists in localStorage, updating timestamp`),await Q(de.id,{updateDate:Date.now()}),g(`Snippet "${me.title||"Untitled"}" synced from Google Sheets`);return}r(he=>[me,...he]),g(`Snippet "${me.title||"Untitled"}" synced from Google Sheets`),console.log(` Synced snippet #${se} from Google Sheets:`,me.title),await te(me.id,me.content,me.title)}catch(be){console.error(` Failed to sync snippet #${se}:`,be),d(`Failed to sync snippet: ${be instanceof Error?be.message:"Unknown error"}`)}};return u.jsx(aI.Provider,{value:{snippets:M,addSnippet:X,updateSnippet:Q,deleteSnippets:W,mergeSnippets:H,toggleSelection:re,selectAll:ne,selectNone:ve,getSelectedSnippets:O,getAllTags:I,addTagsToSnippets:K,removeTagsFromSnippets:U,storageStats:s,checkEmbeddingStatus:ce,getEmbeddingDetails:ye,bulkCheckEmbeddingStatus:Ae,generateEmbeddings:fe,syncStatus:l,triggerManualSync:Ne,getUserRagSpreadsheet:z,syncSnippetFromGoogleSheets:Te},children:t})};class gq{db=null;dbName="feed_data";dbVersion=2;async init(){if(!this.db)return new Promise((e,r)=>{const n=indexedDB.open(this.dbName,this.dbVersion);n.onerror=()=>{r(new Error("Failed to open IndexedDB"))},n.onsuccess=()=>{this.db=n.result,console.log(" Feed database initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result,i=a.oldVersion;if(!s.objectStoreNames.contains("items")){const l=s.createObjectStore("items",{keyPath:"id"});l.createIndex("createdAt","createdAt",{unique:!1}),l.createIndex("viewed","viewed",{unique:!1}),l.createIndex("stashed","stashed",{unique:!1}),l.createIndex("trashed","trashed",{unique:!1}),l.createIndex("topics","topics",{unique:!1,multiEntry:!0})}if(s.objectStoreNames.contains("preferences")||s.createObjectStore("preferences",{keyPath:"id"}),s.objectStoreNames.contains("quizzes")||s.createObjectStore("quizzes",{keyPath:"itemId"}).createIndex("generatedAt","generatedAt",{unique:!1}),i<2&&!s.objectStoreNames.contains("interactions")){const l=s.createObjectStore("interactions",{keyPath:"id"});l.createIndex("timestamp","timestamp",{unique:!1}),l.createIndex("feedItemId","feedItemId",{unique:!1}),l.createIndex("action","action",{unique:!1}),l.createIndex("topics","topics",{unique:!1,multiEntry:!0}),l.createIndex("quizGenerated","quizGenerated",{unique:!1})}i<2&&!s.objectStoreNames.contains("userPreferences")&&s.createObjectStore("userPreferences",{keyPath:"userId"}).createIndex("lastUpdated","lastUpdated",{unique:!1})}})}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}async saveItems(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const a=this.db.transaction(["items"],"readwrite"),s=a.objectStore("items");for(const i of e){const l={...i,id:i.id||this.generateUUID(),createdAt:i.createdAt||new Date().toISOString(),viewed:i.viewed!==void 0?i.viewed:!1,stashed:i.stashed!==void 0?i.stashed:!1,trashed:i.trashed!==void 0?i.trashed:!1};s.put(l)}a.oncomplete=()=>r(),a.onerror=()=>n(a.error)})}async getItems(e=10,r=0){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((n,a)=>{const s=this.db.transaction(["items"],"readonly"),l=s.objectStore("items").index("createdAt"),c=[];let d=0;const p=l.openCursor(null,"prev");p.onsuccess=g=>{const m=g.target.result;if(m){const y=m.value;y.trashed||(d<r?d++:c.length<e&&(console.log(` DB: Loading item "${y.title.substring(0,40)}..." - has image: ${!!y.image}`),c.push(y))),c.length<e&&m.continue()}},s.oncomplete=()=>n(c),s.onerror=()=>a(s.error)})}async getCount(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["items"],"readonly").objectStore("items").getAll();s.onsuccess=()=>{const l=s.result.filter(c=>!c.trashed).length;e(l)},s.onerror=()=>r(s.error)})}async getItemById(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["items"],"readonly").objectStore("items").get(e);i.onsuccess=()=>{r(i.result||null)},i.onerror=()=>n(i.error)})}async updateItem(e,r){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((n,a)=>{const i=this.db.transaction(["items"],"readwrite").objectStore("items"),l=i.get(e);l.onsuccess=()=>{const c=l.result;if(!c){a(new Error("Item not found"));return}const d={...c,...r},p=i.put(d);p.onsuccess=()=>n(),p.onerror=()=>a(p.error)},l.onerror=()=>a(l.error)})}async deleteItem(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["items"],"readwrite").objectStore("items").delete(e);i.onsuccess=()=>r(),i.onerror=()=>n(i.error)})}async clearAll(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["items"],"readwrite").objectStore("items").clear();s.onsuccess=()=>{console.log(" All feed items cleared"),e()},s.onerror=()=>r(s.error)})}async clearTrashed(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const n=this.db.transaction(["items"],"readwrite"),i=n.objectStore("items").index("trashed").openCursor(IDBKeyRange.only(!0));i.onsuccess=l=>{const c=l.target.result;c&&(c.delete(),c.continue())},n.oncomplete=()=>e(),n.onerror=()=>r(n.error)})}async getPreferences(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["preferences"],"readonly").objectStore("preferences").get("default");s.onsuccess=()=>{const i=s.result||{id:"default",searchTerms:[],likedTopics:[],dislikedTopics:[],lastGenerated:new Date().toISOString()};e(i)},s.onerror=()=>r(s.error)})}async updatePreferences(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const s=this.db.transaction(["preferences"],"readwrite").objectStore("preferences"),i=s.get("default");i.onsuccess=()=>{const c={...i.result||{id:"default",searchTerms:[],likedTopics:[],dislikedTopics:[],lastGenerated:new Date().toISOString()},...e},d=s.put(c);d.onsuccess=()=>r(),d.onerror=()=>n(d.error)},i.onerror=()=>n(i.error)})}async addLikedTopic(e){const r=await this.getPreferences(),n=new Set(r.likedTopics);n.add(e);const a=r.dislikedTopics.filter(s=>s!==e);await this.updatePreferences({likedTopics:Array.from(n),dislikedTopics:a})}async addDislikedTopic(e){const r=await this.getPreferences(),n=new Set(r.dislikedTopics);n.add(e);const a=r.likedTopics.filter(s=>s!==e);await this.updatePreferences({likedTopics:a,dislikedTopics:Array.from(n)})}async saveQuiz(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["quizzes"],"readwrite").objectStore("quizzes").put(e);i.onsuccess=()=>r(),i.onerror=()=>n(i.error)})}async getQuiz(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["quizzes"],"readonly").objectStore("quizzes").get(e);i.onsuccess=()=>{r(i.result||null)},i.onerror=()=>n(i.error)})}async getAllQuizzes(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["quizzes"],"readonly").objectStore("quizzes").getAll();s.onsuccess=()=>{e(s.result||[])},s.onerror=()=>r(s.error)})}async deleteQuiz(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["quizzes"],"readwrite").objectStore("quizzes").delete(e);i.onsuccess=()=>r(),i.onerror=()=>n(i.error)})}async saveInteraction(e){if(await this.init(),!this.db)throw new Error("Database not initialized");const r={...e,id:`interaction_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now()};return new Promise((n,a)=>{const l=this.db.transaction(["interactions"],"readwrite").objectStore("interactions").add(r);l.onsuccess=()=>n(),l.onerror=()=>a(l.error)})}async getInteractions(e=1e3){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const l=this.db.transaction(["interactions"],"readonly").objectStore("interactions").index("timestamp").getAll();l.onsuccess=()=>{const c=l.result;r(c.reverse().slice(0,e))},l.onerror=()=>n(l.error)})}async getInteractionsByAction(e,r=500){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((n,a)=>{const c=this.db.transaction(["interactions"],"readonly").objectStore("interactions").index("action").getAll(e);c.onsuccess=()=>{const d=c.result;n(d.reverse().slice(0,r))},c.onerror=()=>a(c.error)})}async getQuizInteractions(e=500){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const l=this.db.transaction(["interactions"],"readonly").objectStore("interactions").index("quizGenerated").getAll();l.onsuccess=()=>{const d=l.result.filter(p=>p.quizGenerated);r(d.reverse().slice(0,e))},l.onerror=()=>n(l.error)})}async getUserPreferences(e="default"){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["userPreferences"],"readonly").objectStore("userPreferences").get(e);i.onsuccess=()=>{r(i.result||null)},i.onerror=()=>n(i.error)})}async updateUserPreferences(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const i=this.db.transaction(["userPreferences"],"readwrite").objectStore("userPreferences").put(e);i.onsuccess=()=>r(),i.onerror=()=>n(i.error)})}async initializeUserPreferences(e="default"){const r={userId:e,learnedTopics:[],learnedKeywords:[],avoidTopics:[],lastUpdated:Date.now(),interactionCount:0,quizEngagementCount:0};return await this.updateUserPreferences(r),r}async clearInteractions(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["interactions"],"readwrite").objectStore("interactions").clear();s.onsuccess=()=>e(),s.onerror=()=>r(s.error)})}async clearUserPreferences(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction(["userPreferences"],"readwrite").objectStore("userPreferences").clear();s.onsuccess=()=>e(),s.onerror=()=>r(s.error)})}async removeAvoidTopic(e="default",r){const n=await this.getUserPreferences(e);n&&(n.avoidTopics=n.avoidTopics.filter(a=>a!==r),n.lastUpdated=Date.now(),await this.updateUserPreferences(n))}async clearAvoidTopics(e="default"){const r=await this.getUserPreferences(e);r&&(r.avoidTopics=[],r.lastUpdated=Date.now(),await this.updateUserPreferences(r))}async getTopicStatistics(e=6){if(await this.init(),!this.db)throw new Error("Database not initialized");const r=await this.getInteractions(1e4),n=Date.now(),a=e*30*24*60*60*1e3,s=n-a,i=r.filter(d=>d.timestamp>=s),l=new Map;for(const d of i){if(!d.topics||d.topics.length===0)continue;const p=new Date(d.timestamp),g=`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}`;for(const m of d.topics){l.has(m)||l.set(m,new Map);const y=l.get(m);y.set(g,(y.get(g)||0)+1)}}const c=new Map;for(const[d,p]of l.entries()){const g=Array.from(p.entries()).map(([m,y])=>({month:m,count:y})).sort((m,y)=>m.month.localeCompare(y.month));c.set(d,g)}return c}async getTopTopics(e=5){const r=await this.getTopicStatistics(6),n=new Map;for(const[a,s]of r.entries()){const i=s.reduce((l,{count:c})=>l+c,0);n.set(a,i)}return Array.from(n.entries()).map(([a,s])=>({topic:a,count:s})).sort((a,s)=>s.count-a.count).slice(0,e)}async removeDislikedTopic(e,r="default"){const n=await this.getUserPreferences(r);n&&(n.avoidTopics=n.avoidTopics.filter(a=>a!==e),n.lastUpdated=Date.now(),await this.updateUserPreferences(n),console.log(` Removed disliked topic: "${e}"`))}async getTopicHistory(e=6){const r=await this.getTopicStatistics(e),n=[],a=await this.getTopTopics(5),s=new Set(a.map(i=>i.topic));for(const[i,l]of r.entries())if(s.has(i))for(const{month:c,count:d}of l)n.push({topic:i,month:c,count:d});return n.sort((i,l)=>i.month.localeCompare(l.month))}async setMaturityLevel(e){await this.updatePreferences({maturityLevel:e,lastUpdated:Date.now()}),console.log(` Maturity level set to: ${e}`)}async getMaturityLevel(){return(await this.getPreferences()).maturityLevel||"adult"}}const vn=new gq;async function sI(t,e,r,n=5,a,s,i){const l=await dn(),c=a;console.log(` Feed maturity level: ${c}`);const d={swagContent:e,searchTerms:r.searchTerms,count:n,preferences:r,maturityLevel:c};console.log(" Making feed generation request to:",`${l}/feed/generate`),console.log(" Request body:",d);const p=await fetch(`${l}/feed/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify(d),signal:i});if(console.log(" Response status:",p.status,p.statusText),!p.ok){const w=await p.json();throw console.error(" Feed generation error:",w),new Error(w.error||`Failed to generate feed: ${p.statusText}`)}const g=p.body?.getReader();if(!g)throw new Error("No response body");const m=new TextDecoder,y=[];let x="";try{for(;;){const{done:w,value:T}=await g.read();if(w)break;x+=m.decode(T,{stream:!0});const k=x.split(`

`);x=k.pop()||"";for(const _ of k){if(!_.trim()||_.startsWith(":"))continue;const P=_.split(`
`);let F=null,D=null;for(const B of P)B.startsWith("event: ")?F=B.substring(7).trim():B.startsWith("data: ")&&(D=B.substring(6).trim());if(D)try{const B=JSON.parse(D),M={type:F||B.type||"status",...B};if(console.log(" SSE Event received:",M.type,M),s&&s(M),M.type==="item_generated"&&M.item)y.push(M.item);else if(M.type==="error")throw new Error(M.error||"Unknown error during generation")}catch(B){console.error("Failed to parse SSE event data:",D,B)}}}}finally{g.releaseLock()}return y}async function iI(t,e){const r=await dn(),n=`TITLE: ${e.title}

CONTENT:
${e.content}

TOPICS: ${e.topics.join(", ")}

${e.sources&&e.sources.length>0?`SOURCES:
${e.sources.map(l=>`- ${l}`).join(`
`)}`:""}`,a=await fetch(`${r}/quiz/generate`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({content:n,enrichment:!1,providers:{}})});if(!a.ok){const l=await a.text();throw new Error(`Failed to generate quiz: ${a.statusText} - ${l}`)}const s=await a.json();return{itemId:e.id,title:s.title||`Quiz: ${e.title}`,questions:s.questions.map((l,c)=>({id:l.id||`q${c+1}`,prompt:l.prompt||l.question,choices:l.choices.map(d=>({id:d.id,text:d.text})),correctChoiceId:l.answerId||l.correctChoiceId||l.correctAnswer,explanation:l.explanation||""})),sources:e.sources||[],generatedAt:new Date().toISOString()}}const fq=Object.freeze(Object.defineProperty({__proto__:null,generateFeedItems:sI,generateFeedQuiz:iI},Symbol.toStringTag,{value:"Module"}));class mq{syncing=!1;lastSyncTime=0;isSyncing(){return this.syncing}getLastSyncTime(){return this.lastSyncTime}async getApiEndpoint(){try{const e="http://localhost:3000";if((await fetch(`${e}/health`,{method:"HEAD"})).ok)return console.log(" Using local Lambda server for feed sync"),e}catch{}throw new Error("No API endpoint available")}async getAuthToken(){const e=localStorage.getItem("google_access_token");if(!e)throw new Error("Not authenticated - please sign in to sync feed items");return e}getProjectId(){return localStorage.getItem("currentProjectId")}async downloadFeedItems(){const e=await this.getApiEndpoint(),r=await this.getAuthToken(),n=this.getProjectId(),a={Authorization:`Bearer ${r}`,"Content-Type":"application/json"};n&&(a["X-Project-ID"]=n);const s=await fetch(`${e}/feed/items`,{method:"GET",headers:a});if(!s.ok){const l=await s.json().catch(()=>({error:"Unknown error"}));throw new Error(`Failed to download feed items: ${l.error||s.statusText}`)}return(await s.json()).items||[]}async uploadFeedItem(e){const r=await this.getApiEndpoint(),n=await this.getAuthToken(),a=this.getProjectId(),s={Authorization:`Bearer ${n}`,"Content-Type":"application/json"};a&&(s["X-Project-ID"]=a);const i=await fetch(`${r}/feed/items`,{method:"POST",headers:s,body:JSON.stringify(e)});if(!i.ok){const l=await i.json().catch(()=>({error:"Unknown error"}));throw new Error(`Failed to upload feed item: ${l.error||i.statusText}`)}return await i.json()}async voteFeedItem(e,r){const n=await this.getApiEndpoint(),a=await this.getAuthToken(),s=this.getProjectId(),i={Authorization:`Bearer ${a}`,"Content-Type":"application/json"};s&&(i["X-Project-ID"]=s);const l=await fetch(`${n}/feed/vote`,{method:"POST",headers:i,body:JSON.stringify({itemId:e,vote:r})});if(!l.ok){const c=await l.json().catch(()=>({error:"Unknown error"}));throw new Error(`Failed to vote on feed item: ${c.error||l.statusText}`)}return await l.json()}async deleteFeedItem(e){const r=await this.getApiEndpoint(),n=await this.getAuthToken(),a=this.getProjectId(),s={Authorization:`Bearer ${n}`,"Content-Type":"application/json"};a&&(s["X-Project-ID"]=a);const i=await fetch(`${r}/feed/items/${e}`,{method:"DELETE",headers:s});if(!i.ok){const l=await i.json().catch(()=>({error:"Unknown error"}));throw new Error(`Failed to delete feed item: ${l.error||i.statusText}`)}}async fullSync(){if(this.syncing)return{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:"Sync already in progress"};this.syncing=!0;try{console.log(" Starting feed items sync..."),await vn.init();const e=await vn.getItems(1e4,0);console.log(` Found ${e.length} local feed items`);const r=await this.downloadFeedItems();if(console.log(` Found ${r.length} remote feed items`),e.length===0&&r.length===0)return this.lastSyncTime=Date.now(),{success:!0,action:"no-change",timestamp:Date.now(),itemCount:0};const n=new Map;for(const d of r)n.set(d.id,d);const a=[],s=new Map;for(const d of e)s.set(d.id,d),n.has(d.id)||a.push(d);let i=0;for(const d of a)try{const p=await this.uploadFeedItem(d);n.set(p.id,p),i++,console.log(` Uploaded local feed item: ${d.title}`)}catch(p){console.error(` Failed to upload feed item ${d.id}:`,p)}const l=Array.from(n.values());await vn.saveItems(l),this.lastSyncTime=Date.now();let c="no-change";return i>0&&r.length>0?c="merged":i>0?c="uploaded":r.length>e.length&&(c="downloaded"),console.log(` Feed sync complete: ${l.length} items (${i} uploaded)`),{success:!0,action:c,timestamp:Date.now(),itemCount:l.length}}catch(e){return console.error(" Feed sync failed:",e),{success:!1,action:"error",timestamp:Date.now(),itemCount:0,error:e instanceof Error?e.message:"Unknown error"}}finally{this.syncing=!1}}async saveFeedItem(e){await vn.init(),await vn.saveItems([e]);try{const r=await this.uploadFeedItem(e);return console.log(` Saved feed item to backend: ${e.title}`),await vn.saveItems([r]),r}catch(r){throw console.error(" Failed to upload feed item to backend:",r),r}}async saveFeedItems(e){const r=[];for(const n of e)try{const a=await this.saveFeedItem(n);r.push(a)}catch(a){console.error(`Failed to save feed item ${n.id}:`,a)}return r}async updateVote(e,r){await vn.init();const a=(await vn.getItems(1e4,0)).find(i=>i.id===e);if(!a)throw new Error("Feed item not found");const s=a.userVote;s==="up"?a.upvoteCount=Math.max(0,(a.upvoteCount||0)-1):s==="down"&&(a.downvoteCount=Math.max(0,(a.downvoteCount||0)-1)),r==="up"?a.upvoteCount=(a.upvoteCount||0)+1:r==="down"&&(a.downvoteCount=(a.downvoteCount||0)+1),a.userVote=r,await vn.saveItems([a]);try{const i=await this.voteFeedItem(e,r);await vn.saveItems([i]),console.log(` Updated vote for feed item: ${e}`)}catch(i){throw console.error(" Failed to update vote on backend:",i),i}}async deleteItem(e){await vn.init(),await vn.deleteItem(e);try{await this.deleteFeedItem(e),console.log(` Deleted feed item: ${e}`)}catch(r){throw console.error(" Failed to delete feed item from backend:",r),r}}}const s_=new mq,oI=N.createContext(null);function Bxe(){const t=N.useContext(oI);if(!t)throw new Error("useFeed must be used within FeedProvider");return t}function yq({children:t}){const{getToken:e,user:r}=oi(),{snippets:n}=rf(),{getCurrentProjectId:a,currentProject:s}=ef(),{showSuccess:i,showWarning:l,showError:c}=jl(),[d,p]=N.useState([]),g=N.useMemo(()=>{const de=s?.id||null;return de?d.filter(he=>he.projectId===de):d.filter(he=>!he.projectId)},[d,s]),[m,y]=N.useState({searchTerms:[],likedTopics:[],dislikedTopics:[],lastGenerated:new Date().toISOString()}),[x,w]=N.useState(null),[T,k]=N.useState(!0),[_,P]=N.useState(!1),[F,D]=N.useState(null),[B,M]=N.useState(""),[$,Z]=N.useState(null),[z,ee]=N.useState([]),[te,X]=N.useState(null),[Q,W]=N.useState(null),[H,re]=N.useState(null),ne=N.useRef(n),ve=N.useRef(m),O=N.useRef(te),I=N.useRef(_);N.useEffect(()=>{ne.current=n},[n]),N.useEffect(()=>{ve.current=m},[m]),N.useEffect(()=>{I.current=_},[_]),N.useEffect(()=>{console.log(" lastSearchCriteria state changed:",te),O.current=te},[te]),N.useEffect(()=>{if(te&&r?.email)try{e0("feed_last_search",JSON.stringify(te)),console.log(" Saved lastSearchCriteria to localStorage:",te)}catch(de){console.error(" Failed to save lastSearchCriteria to localStorage:",de)}},[te,r?.email]),N.useEffect(()=>{try{const de=AP("feed_last_search");if(de){const he=JSON.parse(de);X(he),console.log(" Restored lastSearchCriteria from localStorage (early mount):",he)}}catch(de){console.error(" Failed to restore lastSearchCriteria from localStorage:",de)}},[]),N.useEffect(()=>{const de=async()=>{console.log(" Maturity level changed, reloading preferences...");try{const he=await vn.getPreferences();console.log(" Reloaded preferences, new maturity level:",he.maturityLevel),y(he)}catch(he){console.error(" Failed to reload preferences:",he)}};return window.addEventListener("feed-maturity-changed",de),()=>window.removeEventListener("feed-maturity-changed",de)},[]),N.useEffect(()=>{(async()=>{console.log(" FeedContext: Starting initial data load...");try{k(!0),Z(null),console.log(" Initializing feedDB..."),await vn.init(),console.log(" FeedDB initialized"),console.log(" Loading preferences...");const he=await vn.getPreferences();console.log(" Loaded preferences"),y(he),console.log(" Loading items from DB...");const Ie=await vn.getItems(10,0);console.log(" Loaded items from DB:",Ie.length),p(Ie);const ze=localStorage.getItem("google_access_token"),nt=localStorage.getItem("auto_sync_enabled")==="true";ze&&nt&&(console.log(" Syncing with Google Sheets in background..."),s_.fullSync().then(async mt=>{if(mt.success&&(console.log(" Background sync complete:",mt.action,mt.itemCount,"items"),mt.action==="downloaded"||mt.action==="merged")){const ht=await vn.getItems(100,0);p(ht),console.log(" Reloaded items after sync:",ht.length)}}).catch(mt=>{console.error(" Background sync failed:",mt)})),console.log(" Initial data load complete")}catch(he){console.error(" Failed to load feed data:",he),Z(he instanceof Error?he.message:"Failed to load feed")}finally{console.log(" Setting isLoading to false"),k(!1)}})()},[]);const K=N.useCallback(async de=>{console.log(" generateMore called",de?`with user interests: ${de}`:"");const he=await e();if(console.log(" Token retrieved:",he?`${he.substring(0,20)}...`:"NULL"),!he){console.log(" No token, aborting");const Ie="Your session has expired. Please sign in again to continue.";Z(Ie),c(Ie);return}if(I.current){console.log(" Already generating, skipping");return}try{console.log(" Starting feed generation...");const Ie=new AbortController;console.log(" Created new AbortController:",Ie),W(Ie),P(!0),Z(null),M("Preparing to generate feed..."),console.log(" SEARCH TERM PRIORITY CHECK:"),console.log("   1 userInterests parameter:",de),console.log("   2 lastSearchCriteria (for scroll):",O.current);let ze;if(de&&de.length>0)ze=de,console.log(" DECISION: Using user-provided interests from prompt/tag click:",ze),console.log(" About to save lastSearchCriteria:",de),X(de),console.log(" setLastSearchCriteria called with:",de);else if(O.current&&O.current.length>0)ze=O.current,console.log(" DECISION: Using last search criteria for infinite scroll:",ze);else{console.log(" DECISION: No search criteria provided - skipping generation"),console.log("    userInterests is:",JSON.stringify(de)),console.log("    lastSearchCriteria is:",JSON.stringify(O.current)),P(!1),M(""),console.log(" Generation cancelled - no search criteria");return}console.log(" FINAL search terms for generation:",ze);const nt=[],mt=ve.current.maturityLevel||"adult";console.log(" Using maturity level:",mt),console.log(" Calling generateFeedItems with search terms only:",ze);const ht=await sI(he,[],{searchTerms:ze,likedTopics:[],dislikedTopics:[],lastGenerated:""},3,mt,ct=>{if(console.log(" Feed event:",ct.type,ct),ct.type==="started")console.log(" Request ID:",ct.requestId),re(ct.requestId||null),ct.message&&M(ct.message);else if(ct.type==="context_prepared")console.log(" Context:",{swagItems:ct.swagCount,searchTerms:ct.searchTermsCount,likedTopics:ct.likedTopicsCount,dislikedTopics:ct.dislikedTopicsCount}),M(`Using ${ct.swagCount} saved items and ${ct.searchTermsCount} search terms`);else if(ct.type==="search_starting")console.log(" Starting search for:",ct.terms),ct.message&&M(ct.message);else if(ct.type==="search_term")console.log(" Searching:",ct.term);else if(ct.type==="search_term_complete")console.log(` Found ${ct.resultsCount} results for "${ct.term}"`),ct.results&&ct.results.length>0&&console.log("   Top results:",ct.results);else if(ct.type==="search_term_error")console.warn(" Search error:",ct.term,ct.error);else if(ct.type==="search_complete")console.log(" Search complete:",{totalResults:ct.resultsCount,terms:ct.terms}),ct.topResults&&ct.topResults.length>0&&(console.log("   Top 5 results:"),ct.topResults.forEach((Dt,kt)=>{console.log(`   ${kt+1}. ${Dt.title}`),console.log(`      ${Dt.url}`),Dt.snippet&&console.log(`      ${Dt.snippet}...`)})),M(`Found ${ct.resultsCount} results, generating content...`);else if(ct.type==="item_generated"&&ct.item){console.log(" New item generated:",ct.item.title);const Dt=a(),kt={...ct.item,projectId:Dt||void 0};nt.push(kt),vn.saveItems([kt]).then(()=>{console.log(" Saved item to DB:",kt.id,kt.title)}).catch(fr=>{console.error(" Failed to save item to DB:",kt.id,fr)}),M(`Generated ${nt.length} items...`),p(fr=>{if(fr.some(Kt=>Kt.id===kt.id))return console.log("  Item already exists in state:",kt.id),fr;const st=[...fr,kt],Gt=st.length>30?st.slice(-30):st;return console.log(" Items in state after adding:",Gt.length,"items (latest:",kt.title.substring(0,50),"...)"),Gt})}else ct.type==="item_updated"&&ct.item?(console.log(" Item updated:",ct.item?.title,"field:",ct.field),p(Dt=>Dt.map(kt=>{if(ct.item&&kt.id===ct.item.id){console.log(" Updating item with new data:",kt.id,ct.field);const fr={...kt,...ct.item};return vn.saveItems([fr]).catch(qe=>{console.error(" Failed to save updated item to DB:",qe)}),fr}return kt}))):ct.type==="status"&&ct.message?(console.log(" Status:",ct.message),ct.message.toLowerCase().includes("unavailable")||ct.message.toLowerCase().includes("trying alternative")||M(ct.message)):ct.type==="complete"&&ct.cost!==void 0?(console.log(" Total cost:",ct.cost),ct.cost!==void 0&&M(`Complete! Cost: $${ct.cost.toFixed(6)}`),re(null)):ct.type==="error"&&(console.error(" Generation error:",ct.error),Z(ct.error||"Generation failed"),M("Generation failed"),re(null))},Ie.signal);console.log(" Generated items:",ht.length),console.log(" Items via events:",nt.length),console.log(" Items preview:",ht.map(ct=>({id:ct.title}))),console.log(" Feed generation complete with embedded images from backend"),await vn.updatePreferences({lastGenerated:new Date().toISOString()}),(()=>{const ct=localStorage.getItem("google_access_token"),Dt=localStorage.getItem("auto_sync_enabled")==="true";return ct&&ct.length>0&&Dt})()&&(async()=>{try{console.log(" Syncing feed items to Google Sheets...");const ct=await s_.fullSync();if(ct.success){console.log(" Feed items synced to Google Sheets:",ct.action,ct.itemCount,"items");const Dt=await vn.getItems(100,0);p(Dt)}}catch(ct){console.error(" Failed to sync feed items:",ct)}})()}catch(Ie){if(console.error(" Failed to generate feed items:",Ie),Ie instanceof Error&&(console.error("Error message:",Ie.message),console.error("Error stack:",Ie.stack),Ie.name==="AbortError")){console.log(" Feed generation aborted by user"),Z(null);return}Z(Ie instanceof Error?Ie.message:"Failed to generate feed")}finally{P(!1),M(""),W(null)}},[e]),U=N.useCallback(async de=>{try{await vn.updateItem(de,{stashed:!0}),p(Ie=>Ie.map(ze=>ze.id===de?{...ze,stashed:!0}:ze));const he=g.find(Ie=>Ie.id===de);if(he){for(const ze of he.topics)await vn.addLikedTopic(ze);const Ie=await vn.getPreferences();y(Ie),i(` Saved "${he.title}" to Swag!`)}}catch(he){console.error("Failed to stash item:",he),Z(he instanceof Error?he.message:"Failed to stash item")}},[g]),ce=N.useCallback(async de=>{try{await vn.updateItem(de,{trashed:!0}),p(Ie=>Ie.filter(ze=>ze.id!==de));const he=g.find(Ie=>Ie.id===de);if(he){for(const ze of he.topics)await vn.addDislikedTopic(ze);const Ie=await vn.getPreferences();y(Ie)}}catch(he){console.error("Failed to trash item:",he),Z(he instanceof Error?he.message:"Failed to trash item")}},[g]),ye=N.useCallback(async de=>{try{await vn.updateItem(de,{viewed:!0}),p(he=>he.map(Ie=>Ie.id===de?{...Ie,viewed:!0}:Ie))}catch(he){console.error("Failed to mark item as viewed:",he)}},[]),Ae=N.useCallback(async de=>{const he=await e();if(he)try{k(!0),Z(null);let Ie=await vn.getQuiz(de);if(Ie)console.log(" Loading existing quiz from cache");else{l(" Generating quiz... this may take 30-60 seconds. Please wait."),D(de);const ze=g.find(ct=>ct.id===de);if(!ze)throw new Error("Item not found");Ie=await iI(he,ze),await vn.saveQuiz(Ie);const nt=a(),mt={id:`feed-quiz-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,quizTitle:Ie.title,snippetIds:[de],score:0,totalQuestions:Ie.questions.length,percentage:0,timeTaken:0,completedAt:new Date().toISOString(),answers:[],enrichment:!1,synced:!1,completed:!1,quizData:Ie,projectId:nt||void 0};await yu.saveQuizStatistic(mt);const ht=localStorage.getItem("rag_spreadsheet_id"),er=localStorage.getItem("rag_google_linked")==="true";if(ht&&er)try{const{syncQuizzesToSheets:ct,isGoogleIdentityAvailable:Dt}=await Zt(async()=>{const{syncQuizzesToSheets:kt,isGoogleIdentityAvailable:fr}=await Promise.resolve().then(()=>$w);return{syncQuizzesToSheets:kt,isGoogleIdentityAvailable:fr}},void 0);Dt()&&(console.log(" Syncing quiz to Google Sheets (client-side)..."),await ct(ht,[mt]))}catch(ct){console.error(" Failed to sync quiz to Sheets:",ct)}window.dispatchEvent(new Event("quiz-saved")),i(" Quiz ready!")}w(Ie)}catch(Ie){console.error("Failed to start quiz:",Ie);const ze=Ie instanceof Error?Ie.message:"Failed to load quiz";Z(ze),c(` ${ze}`)}finally{k(!1),D(null)}},[e,g,l,i,c,a]),fe=N.useCallback(()=>{w(null)},[]),Ne=N.useCallback(async de=>{try{await vn.updatePreferences({searchTerms:de});const he=await vn.getPreferences();y(he)}catch(he){console.error("Failed to update search terms:",he),Z(he instanceof Error?he.message:"Failed to update settings")}},[]),Te=N.useCallback(de=>{ee(de),console.log(` Tag filter updated: ${de.length} tags selected`)},[]),se=N.useCallback(async()=>{console.log(" Refresh triggered - clearing all items and generating fresh feed");try{k(!0),await vn.clearAll(),p([]),await K(),console.log(" Feed refreshed successfully")}catch(de){console.error("Failed to refresh feed:",de),Z(de instanceof Error?de.message:"Failed to refresh")}finally{k(!1)}},[K]),be=N.useCallback(async()=>{if(console.log(" stopGeneration called"),console.log(" currentRequestId:",H),console.log(" abortController exists:",!!Q),console.log(" isGenerating:",_),H){try{const de=e();if(de){const he=await Zt(()=>Promise.resolve().then(()=>CS),void 0).then(ze=>ze.getCachedApiBase());console.log(" Calling cancel endpoint for request:",H);const Ie=await fetch(`${he}/feed/cancel/${H}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${de}`}});if(Ie.ok){const ze=await Ie.json();console.log(" Cancel response:",ze)}else console.warn(" Cancel request failed:",Ie.status)}}catch(de){console.error(" Error calling cancel endpoint:",de)}re(null)}Q?(console.log(" Calling abort()..."),Q.abort(),W(null),P(!1),M(""),l("Feed generation stopped"),console.log(" Abort completed")):(console.warn(" No abort controller found - generation may not be active"),P(!1),M(""))},[H,Q,_,l,e]),xe=N.useCallback(async()=>{console.log(" Clearing all feed items");try{await vn.clearAll(),p([]),console.log(" All items cleared")}catch(de){console.error("Failed to clear items:",de),Z(de instanceof Error?de.message:"Failed to clear items")}},[]),me={items:g,preferences:m,currentQuiz:x,isLoading:T,isGenerating:_,generatingQuizForItem:F,generationStatus:B,error:$,selectedTags:z,lastSearchCriteria:te,generateMore:K,stopGeneration:be,stashItem:U,trashItem:ce,markViewed:ye,startQuiz:Ae,closeQuiz:fe,updateSearchTerms:Ne,updateSelectedTags:Te,refresh:se,clearAllItems:xe};return u.jsx(oI.Provider,{value:me,children:t})}function go(t,e){const[r,n]=N.useState(()=>{try{const s=Pw(),i=AP(t);return console.log(` useLocalStorage("${t}") initializing:`,{currentUser:s,hasStoredValue:!!i,willUseDefault:!i}),i?JSON.parse(i):e}catch(s){return console.error(`Error loading localStorage key "${t}":`,s),e}});return[r,s=>{try{n(i=>{const l=s instanceof Function?s(i):s,c=Pw();console.log(` useLocalStorage("${t}") saving:`,{currentUser:c,valuePreview:typeof l=="object"?Object.keys(l).slice(0,5):l});try{e0(t,JSON.stringify(l))}catch(d){if(d?.name==="QuotaExceededError"){console.warn(`localStorage quota exceeded for key "${t}". Attempting cleanup...`);try{const p=bq("chat_history_");if(p.length>5){const g=p.sort().slice(0,p.length-5);g.forEach(m=>window.localStorage.removeItem(m)),console.log(`Removed ${g.length} old chat history items`)}e0(t,JSON.stringify(l)),console.log("Successfully saved after cleanup")}catch(p){if(console.error("Failed to save even after cleanup:",p),t==="app_settings"){const g={version:l.version,providers:[],tavilyApiKey:""};e0(t,JSON.stringify(g)),console.warn("Saved minimal settings due to quota")}}}else throw d}return l})}catch(i){console.error(`Error saving localStorage key "${t}":`,i)}}]}function bq(t){try{return Object.keys(localStorage).filter(e=>e.startsWith(t))}catch(e){return console.error("Error getting localStorage keys:",e),[]}}const lI=N.createContext(void 0),_p={clientId:"548179877633-cfvhlc5roj9prus33jlarcm540i495qi.apps.googleusercontent.com",redirectUri:"https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws/oauth/callback",scope:"https://www.googleapis.com/auth/youtube.readonly",authUrl:"https://accounts.google.com/o/oauth2/v2/auth"},xq=({children:t})=>{const[e,r]=go("youtube_oauth_tokens",null),[n,a]=N.useState(!1),[s,i]=N.useState(null),l=N.useMemo(()=>e?Date.now()<e.expires_at-3e5:!1,[e]);N.useEffect(()=>{if(!e||!l)return;const y=e.expires_at-Date.now(),x=Math.max(0,y-6e5);if(x<=0){p();return}const w=setTimeout(()=>{p()},x);return()=>clearTimeout(w)},[e,l]);const c=N.useCallback(()=>{const y=localStorage.getItem("auth");if(!y)return null;try{return JSON.parse(y).token||null}catch{return null}},[]),d=N.useCallback(async()=>{a(!0),i(null);try{const y=crypto.randomUUID();sessionStorage.setItem("oauth_state",y);const x=new URLSearchParams({client_id:_p.clientId,redirect_uri:_p.redirectUri,response_type:"code",scope:_p.scope,access_type:"offline",prompt:"consent",state:y}),w=`${_p.authUrl}?${x}`,T=600,k=700,_=window.screenX+(window.outerWidth-T)/2,P=window.screenY+(window.outerHeight-k)/2,F=window.open(w,"oauth",`width=${T},height=${k},left=${_},top=${P}`);if(!F)throw new Error("Popup blocked. Please allow popups for this site.");const D=M=>{const $=new URL(_p.redirectUri).origin;if(M.origin!==$){console.warn("Ignoring message from unexpected origin:",M.origin);return}if(M.data.type==="oauth_success"){const Z=sessionStorage.getItem("oauth_state");if(M.data.data.state!==Z){i("Invalid state parameter - possible CSRF attack"),a(!1);return}const z={access_token:M.data.data.tokens.access_token,refresh_token:M.data.data.tokens.refresh_token,expires_at:M.data.data.tokens.expires_at,scope:M.data.data.tokens.scope,token_type:M.data.data.tokens.token_type};console.log("Successfully obtained YouTube OAuth tokens"),r(z),a(!1),sessionStorage.removeItem("oauth_state"),window.removeEventListener("message",D)}else M.data.type==="oauth_error"&&(console.error("OAuth error:",M.data.data.error),i(M.data.data.message||M.data.data.error||"Authorization failed"),a(!1),sessionStorage.removeItem("oauth_state"),window.removeEventListener("message",D))};window.addEventListener("message",D);const B=setInterval(()=>{F.closed&&(clearInterval(B),a(!1),window.removeEventListener("message",D),sessionStorage.getItem("oauth_state")&&(i("Authorization cancelled"),sessionStorage.removeItem("oauth_state")))},500)}catch(y){console.error("OAuth flow error:",y),i(y instanceof Error?y.message:"Failed to initiate OAuth flow"),a(!1)}},[r]),p=N.useCallback(async()=>{if(!e?.refresh_token){console.warn("No refresh token available");return}try{const y=c();if(!y){console.log("Cannot refresh YouTube tokens: JWT authentication not available");return}const x="https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws";console.log("Refreshing YouTube OAuth tokens...");const w=await fetch(`${x}/oauth/refresh`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({refresh_token:e.refresh_token})});if(!w.ok){const k=await w.json().catch(()=>({}));throw new Error(k.message||`Token refresh failed: ${w.status}`)}const T=await w.json();r({access_token:T.access_token,refresh_token:T.refresh_token,expires_at:T.expires_at,scope:T.scope,token_type:T.token_type}),console.log("Successfully refreshed YouTube OAuth tokens"),i(null)}catch(y){console.error("Token refresh error:",y);const x=y instanceof Error?y.message:"Token refresh failed";x.includes("invalid_grant")?(console.warn("Refresh token invalid, clearing tokens"),r(null),i("YouTube access expired. Please reconnect.")):i(x)}},[e,r,c]),g=N.useCallback(async()=>{if(!e)return null;if(Date.now()>=e.expires_at-3e5){console.log("Access token expired or expiring soon, refreshing..."),await p();const y=localStorage.getItem("youtube_oauth_tokens");if(y)try{return JSON.parse(y).access_token}catch{return null}return null}return e.access_token},[e,p]),m=N.useCallback(async()=>{if(e)try{const y=c();if(y){const x="https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws";console.log("Revoking YouTube OAuth tokens..."),await fetch(`${x}/oauth/revoke`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${y}`},body:JSON.stringify({token:e.access_token})})}}catch(y){console.error("Revoke error:",y)}finally{r(null),i(null),console.log("YouTube OAuth tokens cleared")}},[e,r,c]);return u.jsx(lI.Provider,{value:{isConnected:l,isLoading:n,tokens:e,error:s,initiateOAuthFlow:d,disconnect:m,refreshTokens:p,getAccessToken:g},children:t})},vq=()=>{const t=N.useContext(lI);if(!t)throw new Error("useYouTubeAuth must be used within a YouTubeAuthProvider");return t},cI=N.createContext(void 0);function wq({children:t}){const{accessToken:e,isAuthenticated:r}=oi(),[n,a]=N.useState(null),[s,i]=N.useState(!1),[l,c]=N.useState(null),[d,p]=N.useState(null),[g,m]=N.useState([]),[y,x]=N.useState([]),w=async()=>{if(!e||!r){a(null);return}i(!0),c(null);try{const _=await dn(),P={Authorization:`Bearer ${e}`,"Content-Type":"application/json"},F=await fetch(`${_}/billing`,{method:"GET",headers:P});if(!F.ok){const ee=await F.json().catch(()=>({}));throw new Error(ee.message||`HTTP ${F.status}`)}const D=await F.json();D.ttsCapabilities&&(p(D.ttsCapabilities),console.log(" Server TTS capabilities:",D.ttsCapabilities)),D.availableEmbeddings&&Array.isArray(D.availableEmbeddings)&&(m(D.availableEmbeddings),console.log(" Available embeddings loaded:",D.availableEmbeddings.length,"models")),D.providerCapabilities&&Array.isArray(D.providerCapabilities)&&(x(D.providerCapabilities),console.log(" Provider capabilities loaded:",D.providerCapabilities.length,"providers"));let B=0,M=0;if(D.transactions)for(const ee of D.transactions)ee.type==="credit_added"?B+=Math.abs(ee.cost):M+=ee.cost;const $=B-M,Z=$<-.01,z={userEmail:"",totalCost:parseFloat(M.toFixed(4)),creditBalance:parseFloat(Math.max(0,$).toFixed(2)),totalCredits:parseFloat(B.toFixed(2)),exceeded:Z,timestamp:new Date().toISOString()};a(z),console.log(" Usage calculated from billing data:",{...z,rawTotalCredits:B,rawTotalUsage:M,rawCreditBalance:$})}catch(_){const P=_ instanceof Error?_.message:"Failed to load usage";console.error(" Failed to fetch usage:",P),c(P),a(null)}finally{i(!1)}},T=_=>{if(!n)return;const P=n.totalCost+_,F=n.totalCredits-P,D=F<-.01;a({...n,totalCost:P,creditBalance:F,exceeded:D,timestamp:new Date().toISOString()}),console.log(` Added $${_.toFixed(4)} to usage - New balance: $${F.toFixed(4)}`)};N.useEffect(()=>{r&&e?w():a(null)},[r,e]);const k={usage:n,loading:s,error:l,refreshUsage:w,addCost:T,isLocked:n?.exceeded||!1,ttsCapabilities:d,availableEmbeddings:g,providerCapabilities:y};return u.jsx(cI.Provider,{value:k,children:t})}function My(){const t=N.useContext(cI);if(t===void 0)throw new Error("useUsage must be used within a UsageProvider");return t}const uI=N.createContext(void 0),_S=()=>{const t=N.useContext(uI);if(!t)throw new Error("useCast must be used within a CastProvider");return t},Sq=({children:t})=>{const{isAuthenticated:e}=oi(),[r,n]=N.useState(!1),[a,s]=N.useState(!1),[i,l]=N.useState(null),[c,d]=N.useState(null),[p,g]=N.useState(!1),[m,y]=N.useState(!1),x="DE7507EF",w=N.useCallback(()=>{if(!window.chrome?.cast){console.log("Cast API not available yet, will retry...");return}const z=new chrome.cast.SessionRequest(x),ee=new chrome.cast.ApiConfig(z,te=>{console.log("Cast session started:",te),d(te),s(!0),l(te.receiver.friendlyName)},te=>{console.log("Cast receiver availability:",te),n(te===chrome.cast.ReceiverAvailability.AVAILABLE)});chrome.cast.initialize(ee,()=>console.log("Cast initialized successfully"),te=>console.error("Cast initialization failed:",te))},[x]),T=N.useCallback(()=>{if(!chrome?.cast){console.error("Cast API not available");return}chrome.cast.requestSession(z=>{console.log("Cast session requested successfully:",z),d(z),s(!0),l(z.receiver.friendlyName),z.addUpdateListener(ee=>{console.log("Cast session update:",ee),ee||(s(!1),d(null),l(null))})},z=>{console.error("Error requesting cast session:",z)})},[]),k=N.useCallback(()=>{c&&c.stop(()=>{console.log("Cast session stopped"),s(!1),d(null),l(null)},z=>console.error("Error stopping session:",z))},[c]),_=N.useCallback(z=>{if(!c||!a){console.log("No active cast session");return}try{const ee="urn:x-cast:com.lambdallmproxy.chat",te={type:"MESSAGES_UPDATE",messages:z.map(X=>({role:X.role,content:X.content,name:X.name,tool_call_id:X.tool_call_id,isStreaming:X.isStreaming}))};c.sendMessage(ee,te,()=>console.log("Messages sent to receiver"),X=>console.error("Error sending messages:",X))}catch(ee){console.error("Error in sendMessages:",ee)}},[c,a]),P=N.useCallback(z=>{if(!(!c||!a))try{const ee="urn:x-cast:com.lambdallmproxy.chat",te={type:"SCROLL_UPDATE",position:z};c.sendMessage(ee,te,()=>console.log("Scroll position sent:",z),X=>console.error("Error sending scroll:",X))}catch(ee){console.error("Error in sendScrollPosition:",ee)}},[c,a]),F=N.useCallback((z,ee=0)=>{if(!c||!a){console.log("No active cast session for video");return}try{const te="urn:x-cast:com.lambdallmproxy.video",X={type:"VIDEO_COMMAND",command:"load",data:{videoId:z.videoId,url:z.url,title:z.title,channel:z.channel,thumbnail:z.thumbnail,duration:z.duration,position:ee},timestamp:Date.now()};c.sendMessage(te,X,()=>{console.log("Video cast command sent:",z.title),g(!0)},Q=>console.error("Error casting video:",Q))}catch(te){console.error("Error in castVideo:",te)}},[c,a]),D=N.useCallback((z,ee={})=>{if(!(!c||!a))try{const te="urn:x-cast:com.lambdallmproxy.video",X={type:"VIDEO_COMMAND",command:z,data:ee,timestamp:Date.now()};c.sendMessage(te,X,()=>console.log("Video command sent:",z),Q=>console.error("Error sending video command:",Q)),z==="stop"&&g(!1)}catch(te){console.error("Error in sendVideoCommand:",te)}},[c,a]),B=N.useCallback(z=>{if(!c||!a){console.log("No active cast session for snippet");return}try{const ee="urn:x-cast:com.lambdallmproxy.snippet",te={type:"SNIPPET_COMMAND",command:"load",data:{id:z.id,content:z.content,title:z.title||"Untitled Snippet",tags:z.tags||[],created:z.created,modified:z.modified},timestamp:Date.now()};c.sendMessage(ee,te,()=>{console.log("Snippet cast successfully:",z.title),y(!0)},X=>console.error("Error casting snippet:",X))}catch(ee){console.error("Error in castSnippet:",ee)}},[c,a]),M=N.useCallback(z=>{if(!(!c||!a||!m))try{const ee="urn:x-cast:com.lambdallmproxy.snippet",te={type:"SNIPPET_COMMAND",command:"scroll",data:{position:z},timestamp:Date.now()};c.sendMessage(ee,te,()=>console.log("Snippet scroll position sent:",z),X=>console.error("Error sending snippet scroll:",X))}catch(ee){console.error("Error in sendSnippetScrollPosition:",ee)}},[c,a,m]),$=N.useCallback(()=>{if(!(!c||!a||!m))try{const z="urn:x-cast:com.lambdallmproxy.snippet",ee={type:"SNIPPET_COMMAND",command:"stop",data:{},timestamp:Date.now()};c.sendMessage(z,ee,()=>{console.log("Snippet cast stopped"),y(!1)},te=>console.error("Error stopping snippet cast:",te))}catch(z){console.error("Error in stopSnippetCast:",z)}},[c,a,m]);N.useEffect(()=>{if(!e){console.log("Cast SDK: Waiting for authentication before loading");return}if(document.getElementById("cast-sdk")){window.chrome?.cast&&w();return}const z=document.createElement("script");return z.id="cast-sdk",z.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",z.async=!0,z.onload=()=>{console.log("Cast SDK loaded");const ee=setInterval(()=>{window.chrome?.cast&&(clearInterval(ee),w())},100);setTimeout(()=>clearInterval(ee),1e4)},document.head.appendChild(z),()=>{}},[w,e]);const Z={isAvailable:r,isConnected:a,deviceName:i,initializeCast:w,requestSession:T,endSession:k,sendMessages:_,sendScrollPosition:P,castVideo:F,sendVideoCommand:D,isCastingVideo:p,castSnippet:B,sendSnippetScrollPosition:M,stopSnippetCast:$,isCastingSnippet:m};return u.jsx(uI.Provider,{value:Z,children:t})},dI=N.createContext(void 0),kq=()=>{const t=N.useContext(dI);if(!t)throw new Error("useLocation must be used within a LocationProvider");return t},Tq=({children:t})=>{const[e,r]=N.useState(null),[n,a]=N.useState(!1),[s,i]=N.useState(null),[l,c]=N.useState("unknown");N.useEffect(()=>{"permissions"in navigator&&navigator.permissions.query({name:"geolocation"}).then(y=>{c(y.state),y.addEventListener("change",()=>{c(y.state)})}).catch(()=>{c("unknown")})},[]);const d=async(y,x)=>{try{const w=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${y}&lon=${x}&zoom=18&addressdetails=1`,{headers:{"User-Agent":"LLMProxyChat/1.0"}});if(!w.ok){console.warn("Reverse geocoding failed:",w.statusText);return}const T=await w.json();if(T.address)return{city:T.address.city||T.address.town||T.address.village,state:T.address.state,country:T.address.country,postalCode:T.address.postcode,formatted:T.display_name}}catch(w){console.warn("Error reverse geocoding:",w)}},p=N.useCallback(async()=>{if(!navigator.geolocation){i("Geolocation is not supported by your browser");return}a(!0),i(null);try{const y=await new Promise((P,F)=>{navigator.geolocation.getCurrentPosition(P,F,{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),{latitude:x,longitude:w,accuracy:T}=y.coords,k=await d(x,w),_={latitude:x,longitude:w,accuracy:T,address:k,timestamp:Date.now()};r(_),c("granted"),localStorage.setItem("user_location",JSON.stringify(_)),console.log("Location updated:",_)}catch(y){let x="Failed to get location";y.code===1?(x="Location permission denied",c("denied")):y.code===2?x="Location unavailable":y.code===3&&(x="Location request timed out"),i(x),console.error("Geolocation error:",y)}finally{a(!1)}},[]),g=N.useCallback(()=>{r(null),i(null),localStorage.removeItem("user_location")},[]);N.useEffect(()=>{const y=localStorage.getItem("user_location");if(y)try{const x=JSON.parse(y);Date.now()-(x.timestamp||0)<1440*60*1e3?r(x):localStorage.removeItem("user_location")}catch(x){console.error("Error loading stored location:",x),localStorage.removeItem("user_location")}},[]);const m={location:e,isLoading:n,error:s,permissionState:l,requestLocation:p,clearLocation:g};return u.jsx(dI.Provider,{value:m,children:t})},Cq={version:"1.0.0",isEnabled:!0,currentProvider:"auto",providerVoices:{},rate:1,volume:1,elevenlabsApiKey:""};function cg(t){let e=t;return e=e.replace(/!\[([^\]]*)\]\([^)]+\)/g,""),e=e.replace(/\[([^\]]*)\]\(swag-image:\/\/[^)]+\)/g,""),e=e.replace(/\[([^\]]+)\]\([^)]+\)/g,"$1"),e=e.replace(/\]\([^)]+\)/g,""),e=e.replace(/https?:\/\/[^\s]+/g,""),e=e.replace(/ftp:\/\/[^\s]+/g,""),e=e.replace(/\b[\w-]+\/[\w/-]+\//g,""),e=e.replace(/#{1,6}\s/g,""),e=e.replace(/\*\*\*(.*?)\*\*\*/g,"$1"),e=e.replace(/\*\*(.*?)\*\*/g,"$1"),e=e.replace(/\*(.*?)\*/g,"$1"),e=e.replace(/`{1,3}[^`]*`{1,3}/g,"code"),e=e.replace(/<[^>]+>/g,""),e=e.replace(/&/g," and "),e=e.replace(/@/g," at "),e=e.replace(/#/g," hashtag "),e=e.replace(/\$/g," dollar "),e=e.replace(/%/g," percent "),e=e.replace(/[^\w\s.,!?;:'"()[\]{}\-]/g," "),e=e.replace(/\s+/g," ").trim(),e=e.replace(/\. /g,". ... "),e=e.replace(/, /g,", .. "),e=e.replace(/: /g,": .. "),e=e.replace(/; /g,"; .. "),e}function Gw(t){if(typeof t=="string")return cg(t);if(Array.isArray(t)){const e=t.filter(r=>r.type==="text").map(r=>r.text||r.content||"");return cg(e.join(" "))}if(t&&typeof t=="object"){const e=t.text||t.content||"";return cg(String(e))}return""}function Eq(t){const e=t.toLowerCase();return e.includes("female")||e.includes("woman")||e.includes("alice")||e.includes("emma")||e.includes("nova")||e.includes("shimmer")||e.includes("samantha")||e.includes("victoria")||e.includes("alloy")?"female":e.includes("male")||e.includes("man")||e.includes("alex")||e.includes("daniel")||e.includes("onyx")||e.includes("echo")||e.includes("thomas")||e.includes("david")?"male":"neutral"}function i_(t,e=3){const r=t.replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/`(.+?)`/g,"$1").replace(/#+\s/g,"").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1"),n=r.split(new RegExp("(?<=[.!?])\\s+(?=[A-Z])")).filter(s=>s.trim().length>0);return n.length<=e?r.trim():n.slice(0,e).join(" ").trim()}class _q{name="Browser Speech";synth;utterance=null;isStoppedIntentionally=!1;currentOnEndCallback=null;pollingInterval=null;startTimeout=null;currentText="";lastWordBoundary=0;currentOptions={};boundarySupported=!1;boundaryTested=!1;pendingSpeak=null;constructor(){this.synth=window.speechSynthesis;const e=new SpeechSynthesisUtterance("test"),r="onboundary"in e;console.log(`BrowserSpeechProvider: onboundary property ${r?"exists":"does not exist"}`),console.log(`BrowserSpeechProvider: typeof onboundary = ${typeof e.onboundary}`),console.log("BrowserSpeechProvider: speechSynthesis object:",this.synth)}isBoundarySupported(){const e=this.boundarySupported===!0;return console.log(` BrowserSpeechProvider.isBoundarySupported() called -> ${e}`),console.log(`   - boundaryTested: ${this.boundaryTested}`),console.log(`   - boundarySupported: ${this.boundarySupported}`),e}setPlaybackRate(e){console.log(` BrowserSpeechProvider.setPlaybackRate(${e})`),console.log(`   - utterance exists: ${!!this.utterance}`),console.log(`   - speaking: ${this.synth.speaking}`),console.log(`   - boundary tested: ${this.boundaryTested}`),console.log(`   - boundary supported: ${this.boundarySupported}`),console.log(`   - last word boundary: ${this.lastWordBoundary}`),this.currentOptions.rate=e,this.utterance&&this.synth.speaking&&(this.boundarySupported&&this.currentText?(console.log(` BrowserSpeechProvider: Restarting from word boundary (char ${this.lastWordBoundary}) with rate ${e}`),this.restartFromLastWordBoundary({rate:e})):(this.utterance.rate=e,console.log(` BrowserSpeechProvider: Updated utterance.rate to ${e} (will apply on next chunk - boundary events not supported)`)))}setVolume(e){console.log(` BrowserSpeechProvider.setVolume(${e}) - boundary supported: ${this.boundarySupported}`),this.currentOptions.volume=e,this.utterance&&(this.boundarySupported&&this.synth.speaking&&this.currentText?(console.log(` BrowserSpeechProvider: Restarting from word boundary (char ${this.lastWordBoundary}) with volume ${e}`),this.restartFromLastWordBoundary({volume:e})):(this.utterance.volume=e,console.log(` BrowserSpeechProvider: Updated utterance.volume to ${e} (will apply on next chunk - boundary events not supported)`)))}restartFromLastWordBoundary(e){if(!this.currentText||!this.synth.speaking)return;const r=this.currentText.substring(this.lastWordBoundary);if(!r.trim())return;console.log(`BrowserSpeechProvider: Restarting from "${r.substring(0,50)}..." with options:`,e);const n=this.currentOnEndCallback;this.isStoppedIntentionally=!0,this.synth.cancel();const a={...this.currentOptions,...e};n&&(a.onEnd=n),setTimeout(()=>{this.isStoppedIntentionally=!1,this.speakInternal(r,a)},50)}async isAvailable(){return"speechSynthesis"in window&&"SpeechSynthesisUtterance"in window}filterVoicesByLanguage(e,r){if(!r||r==="en")return e.filter(i=>i.name.toLowerCase().startsWith("english")||i.lang.toLowerCase().startsWith("en"));const a={es:{prefixes:["spanish","espaol"],langCodes:["es"]},fr:{prefixes:["french","franais"],langCodes:["fr"]},de:{prefixes:["german","deutsch"],langCodes:["de"]},nl:{prefixes:["dutch","nederlands"],langCodes:["nl"]},pt:{prefixes:["portuguese","portugus"],langCodes:["pt"]},ru:{prefixes:["russian",""],langCodes:["ru"]},zh:{prefixes:["chinese","mandarin",""],langCodes:["zh","cmn"]},ja:{prefixes:["japanese",""],langCodes:["ja"]},ar:{prefixes:["arabic",""],langCodes:["ar"]}}[r];if(!a)return console.warn(`Unknown language code: ${r}, falling back to all voices`),e;const s=e.filter(i=>{const l=i.name.toLowerCase(),c=i.lang.toLowerCase(),d=a.prefixes.some(g=>l.startsWith(g)),p=a.langCodes.some(g=>c.startsWith(g));return d||p});return console.log(` Filtered voices for language '${r}': ${s.length} of ${e.length} voices`),s}async getVoices(e){const r=this.synth.getVoices();console.log(` BrowserSpeechProvider.getVoices() called with languageCode: ${e||"undefined"}`),console.log(`   Total voices from browser: ${r.length}`);const n=Array.from(new Map(r.map(c=>[c.voiceURI,c])).values());console.log(`   Unique voices after deduplication: ${n.length}`);const a=e?this.filterVoicesByLanguage(n,e):n,s=a.filter(c=>c.localService),i=a.filter(c=>!c.localService);return console.log(` BrowserSpeechProvider: Found ${s.length} local voices, ${i.length} remote voices (language: ${e||"all"})`),s.length>0&&console.log("   Sample local voices:",s.slice(0,5).map(c=>`${c.name} (${c.voiceURI})`)),i.length>0&&console.log("   Sample remote voices:",i.slice(0,5).map(c=>`${c.name} (${c.voiceURI})`)),[...i,...s].map(c=>({id:c.voiceURI,name:c.name,language:c.lang,gender:Eq(c.name),provider:"browser",isLocal:c.localService}))}async speak(e,r={}){if(console.log(" BrowserSpeechProvider.speak() called:",{textLength:e?.length||0,textPreview:e?.substring(0,50),hasOnStart:!!r.onStart,hasOnEnd:!!r.onEnd,hasOnError:!!r.onError,rate:r.rate,volume:r.volume,isSpeaking:this.synth.speaking,isPending:this.synth.pending,isStoppedIntentionally:this.isStoppedIntentionally}),!e||e.trim().length===0){console.error(" BrowserSpeechProvider: Cannot speak empty text");const n=new Error("Cannot speak empty text");throw r.onError?.(n),n}if(this.isStoppedIntentionally&&(this.synth.speaking||this.synth.pending))throw console.log(" BrowserSpeechProvider: Stop was called during active speech, rejecting"),new Error("Speech stopped intentionally");return console.log(" BrowserSpeechProvider: Clearing isStoppedIntentionally flag for new speak()"),this.isStoppedIntentionally=!1,(this.synth.speaking||this.synth.pending)&&(console.log(" BrowserSpeechProvider: Clearing existing speech state before new speak()"),this.synth.cancel(),await new Promise(n=>setTimeout(n,50))),this.synth.speaking||this.synth.pending?(console.log(" BrowserSpeechProvider: Still speaking after cancel, queueing next utterance"),this.pendingSpeak={text:e,options:r},new Promise((n,a)=>{const s=setInterval(()=>{if(this.isStoppedIntentionally){console.log(" BrowserSpeechProvider: Stop called while queued, aborting"),clearInterval(s),this.pendingSpeak=null,a(new Error("Speech stopped intentionally"));return}this.pendingSpeak===null&&(clearInterval(s),n())},50)})):(console.log(" BrowserSpeechProvider: Not currently speaking, starting immediately"),this.currentOnEndCallback=null,this.currentText=cg(e),this.lastWordBoundary=0,this.currentOptions=r,this.speakInternal(this.currentText,r))}speakInternal(e,r={}){const n=(a,s)=>new Promise((i,l)=>{if(!a||a.trim().length===0){const g=new Error("Cannot speak empty text after preprocessing");return r.onError?.(g),l(g)}const c=this.synth.getVoices();if(c.length===0){console.warn("No voices available yet, waiting for voiceschanged event...");const g=()=>{const m=this.synth.getVoices();m.length>0&&(console.log(`Voices loaded: ${m.length} available`),this.synth.removeEventListener("voiceschanged",g),n(a,s).then(i).catch(l))};this.synth.addEventListener("voiceschanged",g),setTimeout(()=>{if(this.synth.removeEventListener("voiceschanged",g),this.synth.getVoices().length===0){const y=new Error("No voices available for speech synthesis");r.onError?.(y),l(y)}},2e3);return}this.utterance=new SpeechSynthesisUtterance(a);const d=this.utterance;if(console.log(" BrowserSpeechProvider: Setting rate and volume",{"options.rate":r.rate,"options.volume":r.volume,"rate || 1.0":r.rate||1,"volume || 1.0":r.volume||1}),d.rate=r.rate||1,d.volume=r.volume||1,r.voice){const g=this.synth.getVoices();console.log(` BrowserSpeechProvider: Looking for voice with URI: "${r.voice}"`),console.log(`   Total available voices: ${g.length}`);const m=g.find(y=>y.voiceURI===r.voice);if(m)d.voice=m,console.log(` BrowserSpeechProvider: Matched voice: ${d.voice.name} (${d.voice.lang})`),console.log(`   Voice URI: ${d.voice.voiceURI}, Local: ${d.voice.localService}`);else{console.error(` BrowserSpeechProvider: Could not find voice with URI: "${r.voice}"`),console.log("   Available voice URIs:",g.map(x=>`${x.voiceURI} (${x.name})`)),console.log("   First 5 voices:",g.slice(0,5).map(x=>({uri:x.voiceURI,name:x.name,lang:x.lang})));const y=g.find(x=>x.lang.toLowerCase().startsWith("en-")||x.name.toLowerCase().includes("english")||x.name.toLowerCase().includes("us")||x.name.toLowerCase().includes("uk"));if(y)d.voice=y,console.warn(` BrowserSpeechProvider: Falling back to English voice: ${y.name} (${y.voiceURI}, lang: ${y.lang})`);else{d.voice=null;const x=this.synth.getVoices()[0];console.warn(` BrowserSpeechProvider: No English voice found, using default: ${x?.name||"unknown"} (${x?.voiceURI||"unknown"})`)}}}else{const g=c.find(m=>m.lang.toLowerCase().startsWith("en-")||m.name.toLowerCase().includes("english")||m.name.toLowerCase().includes("us")||m.name.toLowerCase().includes("uk"));if(g)d.voice=g,console.log(` BrowserSpeechProvider: No voice specified, using English voice: ${g.name} (${g.voiceURI}, lang: ${g.lang})`);else{d.voice=null;const m=this.synth.getVoices()[0];console.log(` BrowserSpeechProvider: No voice specified, using default: ${m?.name||"unknown"} (${m?.voiceURI||"unknown"})`)}}this.startTimeout=setTimeout(()=>{if(this.isStoppedIntentionally){console.log(" BrowserSpeechProvider: onstart timeout fired but stop was called, NOT retrying"),this.startTimeout=null;return}console.error(" BrowserSpeechProvider: onstart event never fired after 3000ms!"),console.error("   Browser likely blocked speech or synthesis queue is stuck"),console.error("   Clearing queue and rejecting..."),this.synth.cancel(),this.startTimeout=null;const g=new Error("Browser Speech synthesis failed to start (onstart timeout)");r.onError?.(g),l(g)},3e3),this.utterance.onstart=()=>{this.startTimeout&&(clearTimeout(this.startTimeout),this.startTimeout=null),console.log(" BrowserSpeechProvider: Speech started, waiting for boundary events..."),console.log(`   Voice: ${d.voice?.name||"default"}, Rate: ${d.rate}, Volume: ${d.volume}`),r.onStart?.(),this.boundaryTested||(console.log(" BrowserSpeechProvider: Starting 2000ms timeout to detect boundary support"),setTimeout(()=>{this.boundaryTested||(this.boundaryTested=!0,this.boundarySupported=!1,console.log(" BrowserSpeechProvider: Boundary events NOT SUPPORTED (timeout after 2000ms)"),console.log("   This voice/browser combination does not fire boundary events"),console.log("   Live settings changes will be disabled during playback"))},2e3))},this.currentOnEndCallback=r.onEnd||null,this.utterance.onend=()=>{if(console.log(" BrowserSpeechProvider: onend event fired",{isStoppedIntentionally:this.isStoppedIntentionally,hasOnEndCallback:!!r.onEnd}),this.stopPolling(),!this.isStoppedIntentionally&&r.onEnd?(console.log(" BrowserSpeechProvider: Calling onEnd callback"),r.onEnd()):this.isStoppedIntentionally&&console.log(" BrowserSpeechProvider: Skipping onEnd callback (intentional stop)"),this.currentOnEndCallback=null,this.utterance=null,this.pendingSpeak&&!this.isStoppedIntentionally){console.log(" BrowserSpeechProvider: Processing queued utterance");const g=this.pendingSpeak;this.pendingSpeak=null,this.speakInternal(cg(g.text),g.options).catch(m=>{console.error("Error speaking queued utterance:",m),g.options.onError?.(m)})}i()},this.utterance.onerror=g=>{if(console.error(" BrowserSpeechProvider: Speech error event:",{error:g.error,voice:d.voice?.name||"default",voiceURI:d.voice?.voiceURI||"none",isLocal:d.voice?.localService||!1}),g.error==="interrupted"||g.error==="canceled"){console.log("BrowserSpeechProvider: Speech interrupted/canceled (expected from stop)"),this.currentOnEndCallback=null,this.utterance=null,i();return}if(g.error==="synthesis-failed"&&s){const y=a.substring(0,200);return n(y,!1).then(i).catch(l)}const m=new Error(`Speech synthesis error: ${g.error}`);r.onError?.(m),this.currentOnEndCallback=null,this.utterance=null,l(m)};const p=g=>{if(console.log(" BrowserSpeechProvider: boundary event fired!",g),this.boundaryTested||(this.boundaryTested=!0,this.boundarySupported=!0,console.log(" BrowserSpeechProvider: Boundary events ARE SUPPORTED - live settings changes enabled"),console.log(`   First boundary event: name="${g.name}", charIndex=${g.charIndex}`)),g.name==="word"&&(this.lastWordBoundary=g.charIndex,console.log(` BrowserSpeechProvider: Word boundary at char ${g.charIndex}`)),r.onBoundary){const m=a.substring(g.charIndex,g.charIndex+(g.charLength||0));r.onBoundary(m,g.charIndex)}};this.utterance.addEventListener("boundary",p),this.utterance.onboundary=p,console.log(" BrowserSpeechProvider: Boundary handlers attached:",{hasOnBoundary:typeof this.utterance.onboundary=="function",hasEventListener:!0,utteranceText:a.substring(0,50)+"...",textLength:a.length});try{console.log(" BrowserSpeechProvider: Calling synth.speak() with:",{voice:d.voice?.name||"default",voiceURI:d.voice?.voiceURI||"none",isLocal:d.voice?.localService||!1,rate:d.rate,volume:d.volume,textLength:a.length}),console.log(`   Before speak: synth.speaking=${this.synth.speaking}, synth.pending=${this.synth.pending}`),this.synth.cancel(),this.synth.speak(this.utterance),this.startPolling(),console.log(" BrowserSpeechProvider: synth.speak() called successfully"),console.log(`   After speak: synth.speaking=${this.synth.speaking}, synth.pending=${this.synth.pending}`)}catch(g){console.error(" BrowserSpeechProvider: synth.speak() failed:",g);const m=new Error(`Failed to start speech: ${g}`);r.onError?.(m),this.utterance=null,l(m)}});return n(e,!0)}startPolling(){this.pollingInterval&&clearInterval(this.pollingInterval),this.pollingInterval=setInterval(()=>{if(this.utterance&&!this.synth.speaking&&!this.synth.pending&&(console.log("BrowserSpeechProvider: Polling detected speech stopped, triggering onEnd"),this.stopPolling(),this.currentOnEndCallback)){const e=this.currentOnEndCallback;this.currentOnEndCallback=null,this.utterance=null,e()}},500)}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}stop(){console.log(" BrowserSpeechProvider.stop() called"),console.log("   - hasUtterance:",!!this.utterance),console.log("   - synth.speaking:",this.synth.speaking),console.log("   - synth.pending:",this.synth.pending),console.log("   - hasCallback:",!!this.currentOnEndCallback),console.log("   - isStoppedIntentionally:",this.isStoppedIntentionally),console.log("   - hasPending:",!!this.pendingSpeak),console.log("   - hasStartTimeout:",!!this.startTimeout),this.stopPolling(),this.startTimeout&&(console.log(" BrowserSpeechProvider: Clearing start timeout"),clearTimeout(this.startTimeout),this.startTimeout=null),this.pendingSpeak&&(console.log(" BrowserSpeechProvider: Clearing pending utterance"),this.pendingSpeak=null),this.utterance||this.currentOnEndCallback||this.synth.speaking?(console.log(" BrowserSpeechProvider: Setting isStoppedIntentionally = true"),this.isStoppedIntentionally=!0,this.currentOnEndCallback=null,console.log(" BrowserSpeechProvider: Calling pause() + cancel() multiple times..."),this.synth.pause(),this.synth.cancel(),this.synth.pause(),this.synth.cancel(),this.synth.resume(),this.synth.cancel(),setTimeout(()=>{console.log(" BrowserSpeechProvider: Cancel #4 (0ms delay)"),this.synth.pause(),this.synth.cancel()},0),setTimeout(()=>{console.log(" BrowserSpeechProvider: Cancel #5 (10ms delay)"),this.synth.cancel()},10),setTimeout(()=>{console.log(" BrowserSpeechProvider: Cancel #6 (50ms delay)"),this.synth.pause(),this.synth.cancel()},50),setTimeout(()=>{console.log(" BrowserSpeechProvider: Cancel #7 (100ms delay)"),this.synth.cancel()},100),this.utterance=null,console.log(" BrowserSpeechProvider: Stop complete")):console.log(" BrowserSpeechProvider: Nothing to stop (no utterance, callback, or speaking)")}pause(){this.synth.speaking&&!this.synth.paused&&this.synth.pause()}resume(){this.synth.paused&&this.synth.resume()}cleanup(){this.stopPolling(),this.stop(),this.isStoppedIntentionally=!1,this.currentOnEndCallback=null}}const Aq=[{id:"21m00Tcm4TlvDq8ikWAM",name:"Rachel",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"EXAVITQu4vr4xnSDxMaL",name:"Bella",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"AZnzlk1XvdvUeBnXmlld",name:"Domi",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"MF3mGyEYCl7XYWbV9V6O",name:"Elli",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"ThT5KcBeYPX3keUQqHPh",name:"Dorothy",language:"en-GB",gender:"female",provider:"elevenlabs"},{id:"XrExE9yKIg1WjnnlVkGX",name:"Matilda",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"jBpfuIE2acCO8z3wKNLl",name:"Gigi",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"jsCqWAovK2LkecY7zXl4",name:"Freya",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"oWAxZDx7w5VEj9dCyTzz",name:"Grace",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"XB0fDUnXU5powFXDhCwa",name:"Charlotte",language:"en-SE",gender:"female",provider:"elevenlabs"},{id:"VR6AewLTigWG4xSOukaG",name:"Arnold",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"ErXwobaYiN019PkySvjV",name:"Antoni",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"yoZ06aMxZJJ28mfd3POQ",name:"Sam",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"TxGEqnHWrfWFTfGW9XjX",name:"Josh",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"pNInz6obpgDQGcFmaJgB",name:"Adam",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"CYw3kZ02Hs0563khs1Fj",name:"Dave",language:"en-GB",gender:"male",provider:"elevenlabs"},{id:"N2lVS1w4EtoT3dr4eOWO",name:"Callum",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"IKne3meq5aSn9XLyUdCD",name:"Charlie",language:"en-AU",gender:"male",provider:"elevenlabs"},{id:"nPczCjzI2devNBz1zQrb",name:"George",language:"en-GB",gender:"male",provider:"elevenlabs"},{id:"iP95p4xoKVk53GoZ742B",name:"Clyde",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"JBFqnCBsd6RMkjVDRZzb",name:"Daniel",language:"en-GB",gender:"male",provider:"elevenlabs"},{id:"onwK4e9ZLuTAKqWW03F9",name:"Liam",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"bVMeCyTHy58xNoL34h3p",name:"Jeremy",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"flq6f7yk4E4fJM5XTYuZ",name:"Michael",language:"en-US",gender:"neutral",provider:"elevenlabs"},{id:"SOYHLrjzK2X1ezoPC6cr",name:"Emily",language:"en-US",gender:"female",provider:"elevenlabs"},{id:"g5CIjZEefAph4nQFvHAz",name:"Ethan",language:"en-US",gender:"male",provider:"elevenlabs"},{id:"cgSgspJ2msm6clMCkdW9",name:"Jessica",language:"en-US",gender:"female",provider:"elevenlabs"}];class o_{name="elevenlabs";apiKey;audio=null;constructor(e){this.apiKey=e}setApiKey(e){this.apiKey=e}async isAvailable(){return!!this.apiKey}async getVoices(e){return Aq}isBoundarySupported(){return!1}async speak(e,r={}){if(!this.apiKey)throw new Error("ElevenLabs API key not configured");const n=await this.getVoices();let a=r.voice;if(!a||!n.find(s=>s.id===a)){if(n.length===0)throw new Error("No ElevenLabs voices available");a=n[0].id}try{const s=await this.speakViaProxy(e,a,r);return this.playAudio(s,r)}catch(s){const i=s instanceof Error?s.message:"Unknown error";throw new Error(`ElevenLabs TTS failed: ${i}`)}}async speakViaProxy(e,r,n){const a=await this.getApiBase();let s=1,i=null;for(;s>=0;)try{const l=Yn.getAccessToken();if(!l)throw new Error("Authentication required. Please sign in.");const c=await fetch(`${a}/tts`,{method:"POST",headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},body:JSON.stringify({provider:"elevenlabs",text:e,voice:r,rate:n.rate||1,apiKey:this.apiKey})});if(c.status===429){const d=await c.text();throw console.warn(" ElevenLabs TTS: Rate limit hit (429), falling back to Browser Speech"),new Error(`Rate limit exceeded: ${d}`)}if(c.status===401&&s>0){console.log(" ElevenLabs TTS: Got 401, retrying with refreshed token..."),s--,await new Promise(d=>setTimeout(d,100));continue}if(!c.ok){const d=await c.text();throw new Error(`TTS Proxy API error: ${c.status} - ${d}`)}return await c.blob()}catch(l){if(i=l,s>0){console.log(` ElevenLabs TTS: Request failed, retrying... (${s} retries left)`),s--,await new Promise(c=>setTimeout(c,100));continue}throw i}throw i||new Error("Unexpected error in retry loop")}async getApiBase(){const e=window.location.hostname;if(e==="localhost"||e==="127.0.0.1"){const r="http://localhost:3000";try{if((await fetch(r,{method:"OPTIONS",signal:AbortSignal.timeout(500)})).status!==void 0)return console.log(" Using local Lambda server for TTS"),r}catch{}}return"https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws"}async playAudio(e,r){const n=URL.createObjectURL(e);return this.audio=new Audio(n),this.audio.playbackRate=r.rate||1,this.audio.volume=r.volume??1,new Promise((a,s)=>{if(!this.audio){s(new Error("Audio element not available"));return}this.audio.onplay=()=>r.onStart?.(),this.audio.onended=()=>{r.onEnd?.(),URL.revokeObjectURL(n),this.audio=null,a()},this.audio.onerror=()=>{const i=new Error("Audio playback failed");r.onError?.(i),URL.revokeObjectURL(n),this.audio=null,s(i)},this.audio.play().catch(i=>{const l=new Error(`Failed to start audio playback: ${i.message}`);r.onError?.(l),URL.revokeObjectURL(n),this.audio=null,s(l)})})}stop(){this.audio&&(this.audio.onplay=null,this.audio.onended=null,this.audio.onerror=null,this.audio.pause(),this.audio.currentTime=0,this.audio.src&&this.audio.src.startsWith("blob:")&&URL.revokeObjectURL(this.audio.src),this.audio=null)}setPlaybackRate(e){this.audio&&(this.audio.playbackRate=e,console.log(` ElevenLabsProvider: Set playback rate to ${e}`))}setVolume(e){this.audio&&(this.audio.volume=e,console.log(` ElevenLabsProvider: Set volume to ${e}`))}pause(){this.audio&&!this.audio.paused&&this.audio.pause()}resume(){this.audio&&this.audio.paused&&this.audio.play().catch(console.error)}cleanup(){this.stop()}}class Oy{name;backendProvider;defaultVoices;audio=null;_playbackRateTimers=[];apiKey;constructor(e,r,n,a){this.name=e,this.backendProvider=r,this.defaultVoices=n,this.apiKey=a}async isAvailable(){return!0}async getVoices(e){return this.defaultVoices}isBoundarySupported(){return!1}getAudioElement(){return this.audio}setPlaybackRate(e){this.audio&&(this.audio.playbackRate=e)}setVolume(e){this.audio&&(this.audio.volume=e)}async pregenerate(e,r){const n=await dn(),a=r.voice||this.defaultVoices[0]?.id||"default";let s="",i=a;a.includes(":")&&([s,i]=a.split(":")),console.log(` ${this.name}: Pre-generating speech with ${this.backendProvider} (voice: ${i}${s?`, model: ${s}`:""})`);const l={provider:this.backendProvider,model:s||this.defaultVoices[0]?.provider||"default",voice:i||"default",text:e,rate:r.rate||1};this.apiKey&&(l.apiKey=this.apiKey);let c=1,d=null;for(;c>=0;)try{const p=Yn.getAccessToken()||"",g=await fetch(`${n}/tts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(l)});if(g.status===429){const m=await g.text();throw console.warn(" TTS Pre-gen: Rate limit hit (429), falling back to Browser Speech"),new Error(`Rate limit exceeded: ${m}`)}if(g.status===401&&c>0){console.log(" TTS Pre-gen: Got 401, clearing token cache and retrying..."),Yn.clearAccessToken(),c--,await new Promise(m=>setTimeout(m,100));continue}if(!g.ok){const m=await g.text();throw new Error(`${this.name} TTS pre-generation failed: ${m}`)}return await g.blob()}catch(p){if(d=p,c>0){console.log(` TTS Pre-gen: Request failed, retrying... (${c} retries left)`),c--,await new Promise(g=>setTimeout(g,100));continue}throw d}throw d||new Error("Pre-generation failed")}async speak(e,r){console.log(" DEBUG: Groq TTS received options object:",{hasOnStart:!!r.onStart,hasOnEnd:!!r.onEnd,hasOnError:!!r.onError,debugId:r._debugId||"NO DEBUG ID!",optionsObjId:Object.keys(r).join(",")});const n=await dn(),a=r.voice||this.defaultVoices[0]?.id||"default";let s="",i=a;a.includes(":")&&([s,i]=a.split(":")),console.log(` ${this.name}: Generating speech with ${this.backendProvider} (voice: ${i}${s?`, model: ${s}`:""})`);const l={provider:this.backendProvider,model:s||this.defaultVoices[0]?.provider||"default",voice:i||"default",text:e,rate:r.rate||1};this.apiKey&&(l.apiKey=this.apiKey);let c=1,d=null;for(;c>=0;)try{const p=Yn.getAccessToken()||"",g=await fetch(`${n}/tts`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${p}`},body:JSON.stringify(l)});if(g.status===429){const k=await g.text();throw console.warn(" TTS: Rate limit hit (429), falling back to Browser Speech"),new Error(`Rate limit exceeded: ${k}`)}if(g.status===401&&c>0){console.log(" TTS: Got 401, retrying with refreshed token..."),c--,await new Promise(k=>setTimeout(k,100));continue}if(!g.ok){const k=await g.text();throw new Error(`${this.name} TTS failed: ${k}`)}const m=await g.blob();this.audio&&(this.audio.pause(),this.audio=null),this.audio=new Audio(URL.createObjectURL(m)),this.audio.playbackRate=r.rate||1,this.audio.volume=r.volume??1,r.onStart&&r.onStart(),this.audio.onended=()=>{console.log(` ${this.name}: audio.onended fired - calling options.onEnd()`),console.log(`   - audio.currentTime: ${this.audio?.currentTime}`),console.log(`   - audio.duration: ${this.audio?.duration}`),console.log(`   - audio.paused: ${this.audio?.paused}`),console.log(`   - audio.ended: ${this.audio?.ended}`),console.log(`   - hasOnEndCallback: ${!!r.onEnd}`),r.onEnd?(console.log(` ${this.name}: Calling options.onEnd() now`),r.onEnd()):console.warn(` ${this.name}: No onEnd callback provided!`),this.audio=null,console.log(` ${this.name}: Cleaned up audio element`)},this.audio.onerror=k=>{console.error(`${this.name} playback error:`,k),r.onError&&r.onError(new Error("Audio playback failed")),this.audio=null},await this.audio.play();const y=()=>{try{this.audio&&(this.audio.playbackRate=r.rate||1)}catch(k){}};y();const x=()=>y();this.audio.addEventListener("playing",x),this._playbackRateTimers.push(window.setTimeout(y,60)),this._playbackRateTimers.push(window.setTimeout(y,250));try{console.log(`${this.name} playback started - audio.playbackRate=${this.audio?.playbackRate}, requested rate=${r.rate}`)}catch(k){console.warn(`${this.name} playback started - failed to read playbackRate`,k)}const w=()=>{try{this.audio?.removeEventListener("playing",x)}catch(k){}},T=this.audio.onended;this.audio.onended=()=>{w(),this._playbackRateTimers.forEach(k=>clearTimeout(k)),this._playbackRateTimers=[];try{T&&T.call(this.audio,new Event("ended"))}catch(k){}};return}catch(p){if(d=p,c>0){console.log(` TTS: Request failed, retrying... (${c} retries left)`),c--,await new Promise(g=>setTimeout(g,100));continue}throw d}if(d)throw d}async playBlob(e,r,n){this.audio&&(this.audio.pause(),this.audio=null);let a;const s=n??(()=>{try{const d=URL.createObjectURL(e);return a=d,d}catch{return""}})();this.audio=new Audio(s),this.audio.playbackRate=r.rate||1,this.audio.volume=r.volume??1,r.onStart&&r.onStart(),this.audio.onended=()=>{try{r.onEnd?.()}catch{}try{a&&URL.revokeObjectURL(a)}catch{}this.audio=null},this.audio.onerror=d=>{console.error(`${this.name} playback error:`,d);try{r.onError?.(new Error("Audio playback failed"))}catch{}try{a&&URL.revokeObjectURL(a)}catch{}this.audio=null},await this.audio.play();const i=()=>{try{this.audio&&(this.audio.playbackRate=r.rate||1)}catch{}};i();const l=()=>i();this.audio.addEventListener("playing",l),this._playbackRateTimers.push(window.setTimeout(i,60)),this._playbackRateTimers.push(window.setTimeout(i,250));try{console.log(`${this.name} playBlob started - audio.playbackRate=${this.audio?.playbackRate}, requested rate=${r.rate}`)}catch(d){console.warn(`${this.name} playBlob started - failed to read playbackRate`,d)}const c=this.audio.onended;this.audio.onended=()=>{try{this._playbackRateTimers.forEach(d=>clearTimeout(d))}catch{}this._playbackRateTimers=[];try{c&&c.call(this.audio,new Event("ended"))}catch{}}}stop(){if(this.audio){try{this._playbackRateTimers.forEach(e=>clearTimeout(e))}catch{}this._playbackRateTimers=[],this.audio.onended=null,this.audio.onerror=null,this.audio.pause(),this.audio.currentTime=0;try{this.audio.src&&this.audio.src.startsWith("blob:")&&URL.revokeObjectURL(this.audio.src)}catch{}this.audio=null}}cleanup(){this.stop()}}class Nq extends Oy{constructor(e){super("OpenAI TTS","openai",[{id:"tts-1:alloy",name:"Alloy",language:"en-US",gender:"neutral",provider:"openai-tts"},{id:"tts-1:echo",name:"Echo",language:"en-US",gender:"male",provider:"openai-tts"},{id:"tts-1:fable",name:"Fable",language:"en-GB",gender:"male",provider:"openai-tts"},{id:"tts-1:onyx",name:"Onyx",language:"en-US",gender:"male",provider:"openai-tts"},{id:"tts-1:nova",name:"Nova",language:"en-US",gender:"female",provider:"openai-tts"},{id:"tts-1:shimmer",name:"Shimmer",language:"en-US",gender:"female",provider:"openai-tts"},{id:"tts-1-hd:alloy",name:"Alloy HD",language:"en-US",gender:"neutral",provider:"openai-tts"},{id:"tts-1-hd:echo",name:"Echo HD",language:"en-US",gender:"male",provider:"openai-tts"},{id:"tts-1-hd:fable",name:"Fable HD",language:"en-GB",gender:"male",provider:"openai-tts"},{id:"tts-1-hd:onyx",name:"Onyx HD",language:"en-US",gender:"male",provider:"openai-tts"},{id:"tts-1-hd:nova",name:"Nova HD",language:"en-US",gender:"female",provider:"openai-tts"},{id:"tts-1-hd:shimmer",name:"Shimmer HD",language:"en-US",gender:"female",provider:"openai-tts"}],e)}}class Pq extends Oy{constructor(e){super("Groq TTS","groq",[{id:"Aaliyah-PlayAI",name:"Aaliyah (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Adelaide-PlayAI",name:"Adelaide (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Arista-PlayAI",name:"Arista (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Celeste-PlayAI",name:"Celeste (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Cheyenne-PlayAI",name:"Cheyenne (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Deedee-PlayAI",name:"Deedee (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Eleanor-PlayAI",name:"Eleanor (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Gail-PlayAI",name:"Gail (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Indigo-PlayAI",name:"Indigo (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Jennifer-PlayAI",name:"Jennifer (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Judy-PlayAI",name:"Judy (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Mamaw-PlayAI",name:"Mamaw (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Nia-PlayAI",name:"Nia (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Ruby-PlayAI",name:"Ruby (Female)",language:"en-US",gender:"female",provider:"groq-tts"},{id:"Angelo-PlayAI",name:"Angelo (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Atlas-PlayAI",name:"Atlas (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Basil-PlayAI",name:"Basil (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Briggs-PlayAI",name:"Briggs (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Calum-PlayAI",name:"Calum (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Chip-PlayAI",name:"Chip (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Cillian-PlayAI",name:"Cillian (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Fritz-PlayAI",name:"Fritz (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Mason-PlayAI",name:"Mason (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Mikail-PlayAI",name:"Mikail (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Mitch-PlayAI",name:"Mitch (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Quinn-PlayAI",name:"Quinn (Male)",language:"en-US",gender:"male",provider:"groq-tts"},{id:"Thunder-PlayAI",name:"Thunder (Male)",language:"en-US",gender:"male",provider:"groq-tts"}],e)}}class Iq extends Oy{constructor(e){super("Gemini TTS","gemini",[{id:"en-US-Neural2-A",name:"Neural2 Male A (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Neural2-C",name:"Neural2 Female C (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Neural2-D",name:"Neural2 Male D (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Neural2-E",name:"Neural2 Female E (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Neural2-F",name:"Neural2 Female F (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Neural2-G",name:"Neural2 Female G (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Neural2-H",name:"Neural2 Female H (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Neural2-I",name:"Neural2 Male I (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Neural2-J",name:"Neural2 Male J (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Wavenet-A",name:"Wavenet Male A (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Wavenet-B",name:"Wavenet Male B (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Wavenet-C",name:"Wavenet Female C (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Wavenet-D",name:"Wavenet Male D (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Wavenet-E",name:"Wavenet Female E (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Wavenet-F",name:"Wavenet Female F (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Standard-A",name:"Standard Male A (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Standard-B",name:"Standard Male B (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Standard-C",name:"Standard Female C (US)",language:"en-US",gender:"female",provider:"gemini-tts"},{id:"en-US-Standard-D",name:"Standard Male D (US)",language:"en-US",gender:"male",provider:"gemini-tts"},{id:"en-US-Standard-E",name:"Standard Female E (US)",language:"en-US",gender:"female",provider:"gemini-tts"}],e)}}class Rq extends Oy{constructor(e){super("OpenRouter TTS","openrouter",[{id:"minimax/speech-02-turbo:female-en",name:"Speech-02 Turbo Female (EN)",language:"en-US",gender:"female",provider:"openrouter-tts"},{id:"minimax/speech-02-turbo:male-en",name:"Speech-02 Turbo Male (EN)",language:"en-US",gender:"male",provider:"openrouter-tts"},{id:"minimax/speech-02-hd:female-en",name:"Speech-02 HD Female (EN)",language:"en-US",gender:"female",provider:"openrouter-tts"},{id:"minimax/speech-02-hd:male-en",name:"Speech-02 HD Male (EN)",language:"en-US",gender:"male",provider:"openrouter-tts"},{id:"resemble-ai/chatterbox:female",name:"Chatterbox Female",language:"en-US",gender:"female",provider:"openrouter-tts"},{id:"resemble-ai/chatterbox:male",name:"Chatterbox Male",language:"en-US",gender:"male",provider:"openrouter-tts"},{id:"jaaari/kokoro-82m:female",name:"Kokoro Female (Budget)",language:"en-US",gender:"female",provider:"openrouter-tts"},{id:"jaaari/kokoro-82m:male",name:"Kokoro Male (Budget)",language:"en-US",gender:"male",provider:"openrouter-tts"},{id:"x-lance/f5-tts:default",name:"F5-TTS (Voice Clone)",language:"en-US",gender:"neutral",provider:"openrouter-tts"}],e)}}const ps=new Map,l_=new WeakMap;function Ev(t){try{const e=t.match(/Please try again in\s*((?:(?:\d+)h)?(?:(?:\d+)m)?(?:(?:\d+)s)?)/i),r=e?e[1]:null;if(!r)return null;const n=r.match(/(\d+)h/),a=r.match(/(\d+)m/),s=r.match(/(\d+)s/),i=n?parseInt(n[1],10):0,l=a?parseInt(a[1],10):0,c=s?parseInt(s[1],10):0,d=i*3600+l*60+c;return d>0?d:null}catch{return null}}class iu{name;primaryProvider;fallbackProviders;activeProvider=null;constructor(e,r){this.name=e.name,this.primaryProvider=e,this.fallbackProviders=r}async isAvailable(){try{const e=ps.get(this.primaryProvider.name);if(e&&e.blacklistedUntil&&e.blacklistedUntil>Date.now()){const r=Math.ceil((e.blacklistedUntil-Date.now())/1e3);console.log(` FallbackTTSProvider.isAvailable(): Primary provider ${this.primaryProvider.name} blacklisted for ${r}s`)}else if(e&&e.blacklistedUntil&&e.blacklistedUntil<=Date.now()&&ps.set(this.primaryProvider.name,{count:0,blacklistedUntil:null}),await this.primaryProvider.isAvailable())return!0}catch(e){console.warn(" FallbackTTSProvider.isAvailable(): Error checking rate-limit state",e)}for(const e of this.fallbackProviders)if(await e.isAvailable())return!0;return!1}async getVoices(e){try{const r=ps.get(this.primaryProvider.name);if(r&&r.blacklistedUntil&&r.blacklistedUntil>Date.now())console.log(` FallbackTTSProvider.getVoices(): Primary provider ${this.primaryProvider.name} is blacklisted, returning fallback voices`);else if(r&&r.blacklistedUntil&&r.blacklistedUntil<=Date.now()&&ps.set(this.primaryProvider.name,{count:0,blacklistedUntil:null}),await this.primaryProvider.isAvailable())return this.primaryProvider.getVoices(e)}catch(r){console.warn(" FallbackTTSProvider.getVoices(): Error checking rate-limit state",r)}for(const r of this.fallbackProviders)if(await r.isAvailable())return r.getVoices(e);return[]}async speak(e,r){try{const n=ps.get(this.primaryProvider.name);if(n&&n.blacklistedUntil&&n.blacklistedUntil>Date.now()){const a=Math.ceil((n.blacklistedUntil-Date.now())/1e3);console.log(` FallbackTTSProvider: Primary provider ${this.primaryProvider.name} is temporarily blacklisted for ${a}s, skipping to fallbacks`)}else if(n&&n.blacklistedUntil&&n.blacklistedUntil<=Date.now()&&ps.set(this.primaryProvider.name,{count:0,blacklistedUntil:null}),await this.primaryProvider.isAvailable())try{if(console.log(` TTS: Using primary provider: ${this.primaryProvider.name}`),this.activeProvider=this.primaryProvider,r.rate&&"setPlaybackRate"in this.primaryProvider&&typeof this.primaryProvider.setPlaybackRate=="function"){console.log(` FallbackTTSProvider: Pre-applying rate ${r.rate} to ${this.primaryProvider.name}`);try{this.primaryProvider.setPlaybackRate(r.rate)}catch(a){console.warn(" Failed to pre-apply rate:",a)}}if(r.volume!==void 0&&"setVolume"in this.primaryProvider&&typeof this.primaryProvider.setVolume=="function"){console.log(` FallbackTTSProvider: Pre-applying volume ${r.volume} to ${this.primaryProvider.name}`);try{this.primaryProvider.setVolume(r.volume)}catch(a){console.warn(" Failed to pre-apply volume:",a)}}return ps.set(this.primaryProvider.name,{count:0,blacklistedUntil:null}),await this.primaryProvider.speak(e,r)}catch(a){const s=a instanceof Error?a.message:String(a);if(s.includes("interrupted")){console.log(" TTS: Primary provider was interrupted (user stopped), stopping completely"),this.activeProvider=null;return}if(/rate limit|rate_limit_exceeded|429|Rate limit exceeded/i.test(s)){let i=ps.get(this.primaryProvider.name);if(i||(i={count:0,blacklistedUntil:null},ps.set(this.primaryProvider.name,i)),i.count+=1,console.warn(` TTS: Primary provider ${this.primaryProvider.name} reported rate limit (occurrence ${i.count})`),i.count>=2){const l=Ev(s)||900;i.blacklistedUntil=Date.now()+l*1e3,console.log(` TTS: Blacklisting ${this.primaryProvider.name} for ${l}s due to repeated rate limits`),i.count=0}}console.warn(" TTS: Primary provider failed, trying fallback:",a),this.activeProvider=null}else console.log(` TTS: Primary provider ${this.primaryProvider.name} not available, trying fallbacks`)}catch(n){console.warn(" FallbackTTSProvider: Error while checking rate-limit state, proceeding to fallbacks",n)}for(const n of this.fallbackProviders)if(await n.isAvailable())try{if(console.log(` TTS: Falling back to: ${n.name}`),this.activeProvider=n,r.rate&&"setPlaybackRate"in n&&typeof n.setPlaybackRate=="function"){console.log(` FallbackTTSProvider: Pre-applying rate ${r.rate} to fallback ${n.name}`);try{n.setPlaybackRate(r.rate)}catch(s){console.warn(" Failed to pre-apply rate to fallback:",s)}}if(r.volume!==void 0&&"setVolume"in n&&typeof n.setVolume=="function"){console.log(` FallbackTTSProvider: Pre-applying volume ${r.volume} to fallback ${n.name}`);try{n.setVolume(r.volume)}catch(s){console.warn(" Failed to pre-apply volume to fallback:",s)}}const a={...r};if(n.name==="Browser Speech"){const s=r.providerVoices?.browser;if(s)console.log(` FallbackTTSProvider: Using configured browser voice: ${s}`),a.voice=s;else{console.log(" FallbackTTSProvider: No browser voice configured, checking available voices...");try{const i=await n.getVoices();if(i.length>0){const l=i.find(c=>{const d=c.name.toLowerCase();return d.includes("english")||d.includes("us ")||d.includes("uk ")||d.includes("en-")});l?(console.log(` FallbackTTSProvider: Using English browser voice: ${l.name}`),a.voice=l.id):(console.log(` FallbackTTSProvider: No English voice found, using first available: ${i[0].name}`),a.voice=i[0].id)}else console.log(" FallbackTTSProvider: No voices available, will use system default"),delete a.voice}catch(i){console.warn(" FallbackTTSProvider: Failed to get browser voices, using default:",i),delete a.voice}}}return await n.speak(e,a)}catch(a){if((a instanceof Error?a.message:String(a)).includes("interrupted")){console.log(` TTS: Fallback ${n.name} was interrupted (user stopped), stopping completely`),this.activeProvider=null;return}console.warn(` TTS: Fallback ${n.name} failed:`,a)}throw this.activeProvider=null,new Error("All TTS providers failed")}stop(){try{this.activeProvider?(console.log(` FallbackTTSProvider.stop(): Stopping active provider: ${this.activeProvider.name}`),this.activeProvider.stop()):this.primaryProvider&&(console.log(` FallbackTTSProvider.stop(): No active provider, stopping primary: ${this.primaryProvider.name}`),this.primaryProvider.stop())}catch(e){console.warn("FallbackTTSProvider.stop() - error while stopping provider:",e)}this.activeProvider=null}cleanup(){this.primaryProvider.cleanup&&this.primaryProvider.cleanup(),this.fallbackProviders.forEach(e=>e.cleanup?.()),this.activeProvider=null}setPlaybackRate(e){console.log(` FallbackTTSProvider.setPlaybackRate(${e})`),console.log(`   - activeProvider: ${this.activeProvider?.name||"null"}`),console.log(`   - primaryProvider: ${this.primaryProvider.name}`),this.activeProvider&&"setPlaybackRate"in this.activeProvider&&typeof this.activeProvider.setPlaybackRate=="function"?(console.log(` FallbackTTSProvider: Proxying setPlaybackRate(${e}) to ${this.activeProvider.name}`),this.activeProvider.setPlaybackRate(e)):!this.activeProvider&&"setPlaybackRate"in this.primaryProvider&&typeof this.primaryProvider.setPlaybackRate=="function"?(console.log(` FallbackTTSProvider: No active provider yet, applying to primary: ${this.primaryProvider.name}`),this.primaryProvider.setPlaybackRate(e)):console.warn(" FallbackTTSProvider: Cannot apply setPlaybackRate - no active provider or method not available")}setVolume(e){console.log(` FallbackTTSProvider.setVolume(${e})`),console.log(`   - activeProvider: ${this.activeProvider?.name||"null"}`),this.activeProvider&&"setVolume"in this.activeProvider&&typeof this.activeProvider.setVolume=="function"?(console.log(` FallbackTTSProvider: Proxying setVolume(${e}) to ${this.activeProvider.name}`),this.activeProvider.setVolume(e)):!this.activeProvider&&"setVolume"in this.primaryProvider&&typeof this.primaryProvider.setVolume=="function"?(console.log(` FallbackTTSProvider: No active provider yet, applying to primary: ${this.primaryProvider.name}`),this.primaryProvider.setVolume(e)):console.warn(" FallbackTTSProvider: Cannot apply setVolume - no active provider or method not available")}getActiveProviderName(){return this.activeProvider?.name||null}async pregenerate(e,r){console.log(` FallbackTTSProvider.pregenerate() - attempting pregeneration (primary: ${this.primaryProvider.name})`);const n=async a=>{if(!("pregenerate"in a)||typeof a.pregenerate!="function")throw new Error(`Pre-generation not supported by ${a.name}`);try{const s=await a.pregenerate(e,r);try{l_.set(s,a)}catch{}return s}catch(s){try{const i=s instanceof Error?s.message:String(s);if(/rate limit|rate_limit_exceeded|429|Rate limit exceeded/i.test(i)){let l=ps.get(a.name);if(l||(l={count:0,blacklistedUntil:null},ps.set(a.name,l)),l.count+=1,console.warn(` TTS: Provider ${a.name} reported rate limit during pregenerate (occurrence ${l.count})`),l.count>=2){const c=Ev(i)||900;l.blacklistedUntil=Date.now()+c*1e3,console.log(` TTS: Blacklisting ${a.name} for ${c}s due to repeated rate limits (pregenerate)`),l.count=0}}}catch{}throw s}};try{const a=ps.get(this.primaryProvider.name);if(a&&a.blacklistedUntil&&a.blacklistedUntil>Date.now()){const s=Math.ceil((a.blacklistedUntil-Date.now())/1e3);console.log(` FallbackTTSProvider.pregenerate(): Skipping primary ${this.primaryProvider.name} (blacklisted ${s}s)`)}else{a&&a.blacklistedUntil&&a.blacklistedUntil<=Date.now()&&ps.set(this.primaryProvider.name,{count:0,blacklistedUntil:null});try{if(!("pregenerate"in this.primaryProvider)||typeof this.primaryProvider.pregenerate!="function")console.log(` FallbackTTSProvider.pregenerate(): Primary provider ${this.primaryProvider.name} does not support pregenerate, skipping`);else if(await this.primaryProvider.isAvailable())return await n(this.primaryProvider)}catch(s){console.warn(" FallbackTTSProvider.pregenerate(): primary pregenerate attempt failed:",s);try{const i=s instanceof Error?s.message:String(s);if(/rate limit|rate_limit_exceeded|429|Rate limit exceeded/i.test(i)){let l=ps.get(this.primaryProvider.name);if(l||(l={count:0,blacklistedUntil:null},ps.set(this.primaryProvider.name,l)),l.count+=1,console.warn(` TTS: Primary provider ${this.primaryProvider.name} reported rate limit (occurrence ${l.count})`),l.count>=2){const c=Ev(i)||900;l.blacklistedUntil=Date.now()+c*1e3,console.log(` TTS: Blacklisting ${this.primaryProvider.name} for ${c}s due to repeated rate limits (pregenerate)`),l.count=0}}}catch{}}}}catch(a){console.warn(" FallbackTTSProvider.pregenerate(): Error while checking rate-limit state, proceeding to fallbacks",a)}for(const a of this.fallbackProviders)try{if(!("pregenerate"in a)||typeof a.pregenerate!="function"){console.log(` FallbackTTSProvider.pregenerate(): Skipping ${a.name} - pregenerate not supported`);continue}if(await a.isAvailable())try{return await n(a)}catch(s){console.warn(` FallbackTTSProvider.pregenerate(): fallback ${a.name} failed:`,s)}}catch(s){console.warn(` FallbackTTSProvider.pregenerate(): error checking fallback ${a.name}:`,s)}throw new Error(`Pre-generation not supported or failed for any providers in chain starting with ${this.primaryProvider.name}`)}async playBlob(e,r,n){const a=l_.get(e)||this.primaryProvider;if(console.log(` FallbackTTSProvider.playBlob() - playing blob with provider: ${a.name}`),"playBlob"in a&&typeof a.playBlob=="function"){try{r.rate&&"setPlaybackRate"in a&&typeof a.setPlaybackRate=="function"&&a.setPlaybackRate(r.rate),r.volume!==void 0&&"setVolume"in a&&typeof a.setVolume=="function"&&a.setVolume(r.volume)}catch(s){console.warn(` FallbackTTSProvider.playBlob(): Failed to apply rate/volume to ${a.name}:`,s)}this.activeProvider=a;try{return await a.playBlob(e,r,n)}catch(s){console.warn(` FallbackTTSProvider.playBlob(): provider ${a.name} failed to play blob:`,s)}}if("playBlob"in this.primaryProvider&&typeof this.primaryProvider.playBlob=="function"){try{r.rate&&"setPlaybackRate"in this.primaryProvider&&typeof this.primaryProvider.setPlaybackRate=="function"&&this.primaryProvider.setPlaybackRate(r.rate),r.volume!==void 0&&"setVolume"in this.primaryProvider&&typeof this.primaryProvider.setVolume=="function"&&this.primaryProvider.setVolume(r.volume)}catch(s){console.warn(` FallbackTTSProvider.playBlob(): Failed to apply rate/volume to primary ${this.primaryProvider.name}:`,s)}return this.activeProvider=this.primaryProvider,await this.primaryProvider.playBlob(e,r,n)}throw new Error(`Blob playback not supported by any provider in chain starting with ${this.primaryProvider.name}`)}isBoundarySupported(){const e=this.activeProvider||this.primaryProvider;return e&&"isBoundarySupported"in e&&typeof e.isBoundarySupported=="function"?e.isBoundarySupported():!1}}class Dq{providers=new Map;browserSpeech;constructor(){this.browserSpeech=new _q}async initializeProviders(e,r){this.providers.clear();const n=[];await this.browserSpeech.isAvailable()&&n.push(this.browserSpeech);const a=e?.find(_=>_.type==="openai"),s=a&&a.apiKey&&a.apiKey!=="[BACKEND]"?a.apiKey:void 0,i=new Nq(s);if(await i.isAvailable()){const _=new iu(i,n);try{_.supportsPregenerate=!!("pregenerate"in i&&typeof i.pregenerate=="function"||n.some(P=>"pregenerate"in P&&typeof P.pregenerate=="function"))}catch{_.supportsPregenerate=!1}this.providers.set("openai-tts",_)}const l=e?.find(_=>_.type==="groq"),c=l&&l.apiKey&&l.apiKey!=="[BACKEND]"?l.apiKey:void 0,d=new Pq(c);if(await d.isAvailable()){const _=new iu(d,n);try{_.supportsPregenerate=!!("pregenerate"in d&&typeof d.pregenerate=="function"||n.some(P=>"pregenerate"in P&&typeof P.pregenerate=="function"))}catch{_.supportsPregenerate=!1}this.providers.set("groq-tts",_)}const p=e?.find(_=>_.type==="gemini"),g=p&&p.apiKey&&p.apiKey!=="[BACKEND]"?p.apiKey:void 0,m=new Iq(g);if(await m.isAvailable()){const _=new iu(m,n);try{_.supportsPregenerate=!!("pregenerate"in m&&typeof m.pregenerate=="function"||n.some(P=>"pregenerate"in P&&typeof P.pregenerate=="function"))}catch{_.supportsPregenerate=!1}this.providers.set("gemini-tts",_)}const y=e?.find(_=>_.type==="openrouter"),x=y&&y.apiKey&&y.apiKey!=="[BACKEND]"?y.apiKey:void 0,w=new Rq(x);if(await w.isAvailable()){const _=new iu(w,n);try{_.supportsPregenerate=!!("pregenerate"in w&&typeof w.pregenerate=="function"||n.some(P=>"pregenerate"in P&&typeof P.pregenerate=="function"))}catch{_.supportsPregenerate=!1}this.providers.set("openrouter-tts",_)}const T=new o_(r||""),k=new iu(T,n);try{k.supportsPregenerate=!!("pregenerate"in T&&typeof T.pregenerate=="function"||n.some(_=>"pregenerate"in _&&typeof _.pregenerate=="function"))}catch{k.supportsPregenerate=!1}this.providers.set("elevenlabs",k),await this.browserSpeech.isAvailable()&&(this.browserSpeech.supportsPregenerate=!1,this.providers.set("browser",this.browserSpeech))}getProvider(e){return e==="auto"?this.getCheapestProvider():this.providers.get(e)}getCheapestProvider(){const r=[{type:"openrouter-tts",cost:3},{type:"gemini-tts",cost:4},{type:"openai-tts",cost:15},{type:"groq-tts",cost:50}].filter(n=>this.providers.has(n.type)).sort((n,a)=>n.cost-a.cost);if(r.length>0)for(const n of r){const a=this.providers.get(n.type);if(!a)continue;const s=ps.get(a.name||"");if(s&&s.blacklistedUntil&&s.blacklistedUntil>Date.now()){const i=Math.ceil((s.blacklistedUntil-Date.now())/1e3);console.log(` TTSProviderFactory.getCheapestProvider(): Skipping ${n.type} (${a.name}) - blacklisted for ${i}s`);continue}return a}if(this.providers.has("browser"))return this.providers.get("browser")}getAvailableProviders(){const e=["auto"];return["openai-tts","groq-tts","gemini-tts","openrouter-tts","browser"].forEach(n=>{this.providers.has(n)&&e.push(n)}),e.includes("elevenlabs")||e.push("elevenlabs"),e}getDefaultProvider(){return this.getCheapestProvider()||null}getDefaultProviderType(){return"auto"}supportsPregenerate(e){const r=this.providers.get(e);if(!r)return!1;if("pregenerate"in r&&typeof r.pregenerate=="function")return!0;try{const n=r.primaryProvider;if(n&&"pregenerate"in n&&typeof n.pregenerate=="function")return!0;const a=r.fallbackProviders;if(Array.isArray(a)){for(const s of a)if(s&&"pregenerate"in s&&typeof s.pregenerate=="function")return!0}}catch{}return!1}async updateElevenLabsApiKey(e){const r=[];if(await this.browserSpeech.isAvailable()&&r.push(this.browserSpeech),e){const n=this.providers.get("elevenlabs");if(n&&n instanceof iu)n.primaryProvider.setApiKey(e);else{const a=new o_(e);await a.isAvailable()&&this.providers.set("elevenlabs",new iu(a,r))}}else this.providers.delete("elevenlabs")}cleanup(){this.providers.forEach(e=>{try{e.cleanup&&e.cleanup()}catch(r){console.warn("Error cleaning up TTS provider:",r)}}),this.providers.clear()}}function c_(t){if(!t||t.trim().length===0)return[];const e=t.match(/[^.!?]+[.!?]+(?:\s+|$)|[^.!?]+$/g)||[t];return console.log(" chunkTextBySentences: Split text into",e.length,"sentences"),e.forEach((r,n)=>{console.log(`   Sentence ${n+1}: "${r.trim().substring(0,60)}..." (${r.trim().length} chars)`)}),e.map(r=>r.trim()).filter(r=>r.length>0)}function Lq(t){if(!t||t.length===0)return{playbackChunks:[],sentenceMap:[]};const e=[],r=[],n=250;let a="",s=[];for(let i=0;i<t.length;i++){const l=t[i];a.length>0&&a.length+l.length>n?(e.push(a.trim()),r.push([...s]),a=l,s=[i]):(a+=(a?" ":"")+l,s.push(i))}return a&&(e.push(a.trim()),r.push([...s])),{playbackChunks:e,sentenceMap:r}}const hI=N.createContext(void 0),Mq=({children:t})=>{let e=null,r=null;try{e=vo().settings}catch{console.warn("TTSProvider: SettingsContext not available yet, using defaults")}try{r=My().ttsCapabilities}catch{console.warn("TTSProvider: UsageContext not available yet, using defaults")}const[n,a]=go("tts_settings",Cq),s=()=>({isPlaying:!1,isLoadingAudio:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0}),[i]=N.useState(()=>new Dq),[l,c]=N.useState(null),d=N.useRef(!1),p=N.useRef("auto"),g=N.useRef(null),m=N.useRef(null),[y,x]=N.useState({isEnabled:!0,isPlaying:!1,isLoadingAudio:!1,currentText:null,currentProvider:n.currentProvider,activeProvider:null,providerVoices:n.providerVoices||{},rate:n.rate,volume:n.volume,providers:[],voices:[],elevenlabsApiKey:n.elevenlabsApiKey,boundarySupported:!1,usingNonLocalVoice:!1,chunks:[],currentChunkIndex:-1,totalChunks:0}),w=N.useRef(n.rate),T=N.useRef(n.volume),k=N.useRef(null),_=N.useRef(null),P=I=>{try{if(!I)return;for(const[,K]of I)try{K&&K.objectUrl&&URL.revokeObjectURL(K.objectUrl)}catch(U){}I.clear()}catch(K){console.warn(" TTSContext: Error revoking pregenerated object URLs",K)}};N.useEffect(()=>{n.isEnabled!==!0&&(console.log(" TTS: Migrating user settings - enabling TTS"),a(I=>({...I,isEnabled:!0})))},[n.isEnabled,a]),N.useEffect(()=>{x(I=>({...I,rate:n.rate,volume:n.volume}))},[n.rate,n.volume]),N.useEffect(()=>{typeof window<"u"&&window.speechSynthesis&&(console.log(" TTSContext: Cancelling any existing browser speech on mount"),window.speechSynthesis.cancel(),window.speechSynthesis.pause(),window.speechSynthesis.cancel(),setTimeout(()=>window.speechSynthesis.cancel(),0),setTimeout(()=>window.speechSynthesis.cancel(),10),setTimeout(()=>window.speechSynthesis.cancel(),100));const I=K=>{const U=K.target;console.log(" TTSContext: Audio element ended event detected",{src:U.src?.substring(0,50),currentTime:U.currentTime,duration:U.duration}),console.log(" TTSContext: Immediately setting isPlaying=false on audio ended"),x(ce=>ce.isPlaying?(console.log(" TTSContext: isPlaying was true, setting to false NOW"),{...ce,isPlaying:!1,currentText:null,activeProvider:null}):ce),setTimeout(()=>{const ce=document.querySelectorAll("audio");Array.from(ce).some(Ae=>!Ae.paused&&Ae.currentTime>0&&Ae.currentTime<Ae.duration)?(console.log(" TTSContext: Other audio still playing, reverting isPlaying=true"),x(Ae=>({...Ae,isPlaying:!0}))):(console.log(" TTSContext: Confirmed no audio playing after delay check"),x(Ae=>Ae.isPlaying?{...Ae,isPlaying:!1,currentText:null,activeProvider:null}:Ae))},50)};return document.addEventListener("ended",I,!0),()=>{document.removeEventListener("ended",I,!0)}},[]),N.useEffect(()=>((async()=>{try{y.isPlaying?console.log(" TTS: Skipping cleanup - currently playing speech"):(console.log(" TTS: Cleaning up providers (not currently playing)"),i.cleanup());const K=[...e?.providers||[]];r?.groq&&!K.some(fe=>fe.type==="groq")&&(console.log(" TTS: Adding Groq TTS from backend"),K.push({id:"backend-groq",type:"groq",apiKey:"[BACKEND]",apiEndpoint:"",enabled:!0})),r?.openai&&!K.some(fe=>fe.type==="openai")&&(console.log(" TTS: Adding OpenAI TTS from backend"),K.push({id:"backend-openai",type:"openai",apiKey:"[BACKEND]",apiEndpoint:"",enabled:!0})),r?.gemini&&!K.some(fe=>fe.type==="gemini")&&(console.log(" TTS: Adding Gemini TTS from backend"),K.push({id:"backend-gemini",type:"gemini",apiKey:"[BACKEND]",apiEndpoint:"",enabled:!0})),r?.together&&!K.some(fe=>fe.type==="together")&&(console.log(" TTS: Adding Together TTS from backend"),K.push({id:"backend-together",type:"together",apiKey:"[BACKEND]",apiEndpoint:"",enabled:!0})),await i.initializeProviders(K,n.elevenlabsApiKey);const U=i.getAvailableProviders();console.log(" TTS: Available providers:",U);let ce=n.currentProvider;U.includes(ce)||(ce=i.getDefaultProviderType()||"browser");const ye=i.getProvider(ce),Ae=ye?await ye.getVoices():[];x(fe=>({...fe,currentProvider:ce,providers:[],voices:Ae})),ce!==n.currentProvider&&a(fe=>({...fe,currentProvider:ce}))}catch(K){console.error("Failed to initialize TTS providers:",K)}})(),()=>{i.cleanup()}),[e,n.elevenlabsApiKey,r]),N.useEffect(()=>{(async()=>{const K=i.getProvider(n.currentProvider);if(K)try{const U=await K.getVoices();x(ce=>({...ce,voices:U}))}catch(U){console.error("Failed to load voices:",U),x(ce=>({...ce,voices:[]}))}})()},[n.currentProvider]);const F=N.useCallback(I=>{if(y.isPlaying&&y.currentText){const K=Gw(I);x(U=>({...U,currentText:K}))}},[y.isPlaying,y.currentText]),D=N.useCallback(async(I,K={})=>{if(!y.isEnabled)throw new Error("TTS is disabled");d.current&&(console.log("TTSContext.speak() - Stop was in progress, resetting flag and clearing state"),d.current=!1,x(me=>({...me,isPlaying:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0})),await new Promise(me=>setTimeout(me,50))),console.log("TTSContext.speak() - Starting new speech, isStoppingIntentionally = false"),d.current=!1;const U=Gw(I),ce=U.length>500,ye=c_(U);if(console.log(`TTS: Split into ${ye.length} sentences for UI highlighting`),ce){console.log(`TTS: Text is long (${U.length} chars), using chunked playback`);try{await B(U,K,ye);return}catch(me){console.error("TTSContext.speak(): Error during chunked playback:",me);try{x(de=>({...de,...s()})),g.current=null,m.current=null;try{P(k.current)}catch(de){}k.current=null,_.current=null}catch(de){console.warn("TTSContext.speak(): Failed to set stopped state after error",de)}throw l&&(clearTimeout(l),c(null)),me}}console.log(`TTS: Short text (${U.length} chars), single playback with ${ye.length} sentence highlights`),x(me=>({...me,isPlaying:!0,currentText:U,activeProvider:null,chunks:ye,currentChunkIndex:0,totalChunks:ye.length})),l&&(clearTimeout(l),c(null));const Ae=setTimeout(()=>{console.log("TTSContext: Fallback timeout triggered - forcing isPlaying to false"),x(me=>({...me,...s()})),c(null)},3e4);c(Ae);const Ne=(me=>{if(me==="auto"){const de=["browser","openrouter-tts","openai-tts","groq-tts","gemini-tts"];return y.elevenlabsApiKey&&de.splice(5,0,"elevenlabs"),de}return[me]})(y.currentProvider);console.log(` TTS: Fallback hierarchy for ${y.currentProvider}:`,Ne);const Te=y.providerVoices[y.currentProvider]||void 0;console.log(" DEBUG: Creating speakOptions object NOW");const se={...K,voice:Te,rate:y.rate,volume:y.volume,onStart:()=>{console.log(" DEBUG: TTSContext speakOptions.onStart wrapper EXECUTING NOW"),console.log(" TTSContext speak onStart callback - speech started, clearing fallback timeout"),console.log("   activeProviderRef.current:",g.current?.name),console.log("   Window.speechSynthesis.speaking:",window.speechSynthesis?.speaking),l&&(clearTimeout(l),c(null));let me=!1;setTimeout(()=>{const de=setInterval(()=>{const he=g.current?.name?.toLowerCase()||"";if((he.includes("browser")||he.includes("speech"))&&window.speechSynthesis){const ze=window.speechSynthesis.speaking;console.log(` Polling speechSynthesis.speaking: ${ze}`),!ze&&!me&&(console.log(" Polling detected speech finished - setting isPlaying=false IMMEDIATELY"),me=!0,clearInterval(de),x(nt=>{if(console.log(" Polling: prev.isPlaying was:",nt.isPlaying),nt.isPlaying){const mt={...nt,isPlaying:!1,currentText:null,activeProvider:null};return console.log(" Polling: Setting new state with isPlaying=false"),mt}return console.log(" Polling: isPlaying was already false, no change"),nt}),setTimeout(()=>{console.log(" Polling: Verifying state update after 50ms...")},50),console.log(" Polling: About to call options.onEnd?.()"),K.onEnd?.())}else clearInterval(de)},500);setTimeout(()=>clearInterval(de),6e4)},1e3),console.log(" TTSContext: Current rate and volume from state:",{"state.rate":y.rate,"state.volume":y.volume,"speakOptions.rate":se.rate,"speakOptions.volume":se.volume});for(const de of Ne){const he=i.getProvider(de);if(he&&"getActiveProviderName"in he&&typeof he.getActiveProviderName=="function"){const Ie=he.getActiveProviderName();if(Ie){console.log(` TTSContext onStart: FallbackTTSProvider is using: ${Ie}`),x(ze=>({...ze,activeProvider:Ie}));break}}}setTimeout(()=>{const de=g.current;if(de&&"isBoundarySupported"in de){const he=de.isBoundarySupported();console.log(` TTSContext onStart: Checking boundary support after 2100ms: ${he}`),x(Ie=>Ie.boundarySupported!==he?(console.log(` TTSContext: Updating boundarySupported to ${he}`),{...Ie,boundarySupported:he}):Ie)}},2100),K.onStart?.()},onEnd:()=>{if(console.log(" DEBUG: TTSContext speakOptions.onEnd wrapper IS EXECUTING NOW"),console.log(" TTSContext speak onEnd callback triggered"),console.log("   activeProviderRef.current:",g.current?.name),console.log("   Window.speechSynthesis.speaking:",window.speechSynthesis?.speaking),console.log("   isStoppingIntentionally.current:",d.current),console.log("TTSContext speak onEnd callback - checking if intentional stop:",d.current),d.current){console.log("TTSContext speak onEnd - INTENTIONAL STOP, skipping onEnd callback and ensuring clean state"),l&&(clearTimeout(l),c(null)),x(me=>(console.log("TTSContext - Forced clean state after intentional stop"),{...me,isPlaying:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0})),g.current=null;return}console.log("TTSContext speak onEnd callback - setting isPlaying to false"),l&&(clearTimeout(l),c(null)),x(me=>(console.log("TTSContext speak onEnd - prev state:",{isPlaying:me.isPlaying}),{...me,isPlaying:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0})),g.current=null,K.onEnd?.()},onError:me=>{x(de=>({...de,isPlaying:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0})),g.current=null,K.onError?.(me)},onBoundary:K.onBoundary};let be=null,xe=null;for(const me of Ne){if(d.current){console.log("TTS: Stop detected before trying provider, exiting fallback loop"),x(he=>({...he,...s()})),g.current=null;return}const de=i.getProvider(me);if(console.log(` TTS: Attempting to get provider ${me}:`,de?`Found (${de.name})`:"NOT FOUND"),!de){console.warn(` TTS: Provider ${me} not available, skipping`);continue}try{me!==y.currentProvider?console.warn(`TTS: ${y.currentProvider} failed, falling back to ${me}`):console.log(`TTS: Using primary provider ${me}`),g.current=de,p.current=me;try{"setPlaybackRate"in de&&typeof de.setPlaybackRate=="function"&&(console.log("TTSContext: Applying playback rate to provider before speak()",y.rate),de.setPlaybackRate(y.rate)),"setVolume"in de&&typeof de.setVolume=="function"&&(console.log("TTSContext: Applying volume to provider before speak()",y.volume),de.setVolume(y.volume))}catch(he){console.warn("TTSContext: Failed to apply rate/volume to provider before speak():",he)}console.log(" TTSContext: About to call provider.speak() with speakOptions:",{hasOnStart:!!se.onStart,hasOnEnd:!!se.onEnd,hasOnError:!!se.onError,rate:se.rate,volume:se.volume,speakOptionsObjId:se._debugId||"no-id"}),se._debugId=`speakOptions_${Date.now()}`,console.log(" DEBUG: Tagged speakOptions with ID:",se._debugId),await de.speak(U,se),xe=me,console.log(`TTS: Successfully used provider ${me}`);break}catch(he){if(console.warn(`TTS provider ${me} failed:`,he),d.current){console.log("TTS: Stop was intentional, skipping fallback providers"),x(Ie=>({...Ie,...s()})),g.current=null;return}be=he,g.current=null;continue}}if(!xe)throw x(me=>({...me,...s()})),be||new Error("All TTS providers failed")},[y,e,i]),B=N.useCallback(async(I,K={},U)=>{const ce=U||c_(I);console.log(`TTS: Split into ${ce.length} sentences for UI highlighting`);const{playbackChunks:ye,sentenceMap:Ae}=Lq(ce);console.log(`TTS: Grouped into ${ye.length} playback chunks for smooth speech`),m.current={isChunked:!0,chunks:ye,currentChunkIndex:0,totalChunks:ye.length};const fe=i.getProvider(y.currentProvider);if(!fe)throw new Error(`TTS provider ${y.currentProvider} not available`);g.current=fe,p.current=y.currentProvider,console.log("TTSContext.speakChunked() - Set activeProviderRef to:",fe.name);const Ne=y.currentProvider!=="browser";x(xe=>({...xe,isPlaying:!0,isLoadingAudio:Ne,currentText:I,chunks:ce,currentChunkIndex:0,totalChunks:ce.length}));try{"setPlaybackRate"in fe&&typeof fe.setPlaybackRate=="function"&&(console.log("TTSContext.speakChunked: Applying playback rate to provider",y.rate),fe.setPlaybackRate(y.rate)),"setVolume"in fe&&typeof fe.setVolume=="function"&&(console.log("TTSContext.speakChunked: Applying volume to provider",y.volume),fe.setVolume(y.volume))}catch(xe){console.warn("TTSContext.speakChunked: Failed to apply rate/volume to provider:",xe)}const se={voice:y.providerVoices[y.currentProvider]||void 0,rate:y.rate,volume:y.volume,onBoundary:K.onBoundary,providerVoices:y.providerVoices};if(i.supportsPregenerate(y.currentProvider)){const xe=new Map;k.current=xe,_.current=new Map;let me=0;const de=async he=>{if(he>=ce.length||xe.has(he))return;const Ie=ce[he];if(console.log(` TTS: Pre-generating sentence ${he+1}/${ce.length}`),"pregenerate"in fe&&typeof fe.pregenerate=="function"){const ze={...se,onStart:void 0,onEnd:void 0,onError:void 0,rate:w.current,volume:T.current},nt=await fe.pregenerate(Ie,ze);let mt;try{mt=URL.createObjectURL(nt)}catch{mt=void 0}xe.set(he,{blob:nt,objectUrl:mt});try{_.current?.set(he,w.current)}catch{}console.log(` TTS: Pre-generated sentence ${he+1}/${ce.length}`)}};try{ce.length>0&&await de(0)}catch(he){console.warn(" TTS: Pre-generation failed for first chunk, will play without buffering:",he)}for(let he=0;he<ce.length;he++){if(d.current||!m.current){console.log("TTS: Chunked playback stopped at loop start"),m.current=null;try{P(k.current)}catch{}k.current=null,_.current=null,x(nt=>({...nt,...s()}));return}const Ie=ce[he];console.log(`TTS: Playing sentence ${he+1}/${ce.length}: "${Ie.substring(0,50)}..."`),console.log(`    Buffer status: ${xe.size} blobs cached`),console.log(`    Current chunk buffered: ${xe.has(he)?"YES ":"NO "}`),m.current.currentChunkIndex=he,x(nt=>({...nt,currentChunkIndex:he}));const ze=he+1;if(ze<ce.length&&!xe.has(ze))try{de(ze).catch(nt=>{const mt=nt instanceof Error?nt.message:String(nt);/pre[- ]?generation not supported|not supported|failed for any providers/i.test(mt)?console.log(` TTS: Background pregeneration skipped for chunk ${ze+1} - ${mt}`):console.warn(` TTS: Background pre-generation failed for chunk ${ze+1}, will use direct speak(): ${mt}`)})}catch(nt){console.warn(` TTS: Failed to start pre-generation for chunk ${ze+1}:`,nt)}await new Promise((nt,mt)=>{if(d.current||!m.current){console.log("TTS: Stop detected before speak call, aborting"),nt();return}const ht={...se,rate:w.current,volume:T.current,onStart:he===0?()=>{if(x(Dt=>({...Dt,isLoadingAudio:!1})),"getActiveProviderName"in fe&&typeof fe.getActiveProviderName=="function"){const Dt=fe.getActiveProviderName();Dt&&(console.log(` TTSContext chunked onStart: FallbackTTSProvider is using: ${Dt}`),x(kt=>({...kt,activeProvider:Dt})))}K.onStart?.()}:void 0,onEnd:()=>{console.log(`TTS: Sentence ${he+1} finished`);const Dt=Date.now();if(me>0){const kt=Dt-me;console.log(` Gap since last chunk ended: ${kt}ms`)}me=Dt,nt()},onError:Dt=>{if(console.error(`TTS: Error in sentence ${he+1}:`,Dt),d.current){console.log("TTS: Chunk error during intentional stop, resolving instead of rejecting"),nt();return}mt(Dt)}},er=xe.get(he),ct=er?.blob;if(ct&&"playBlob"in fe&&typeof fe.playBlob=="function"){const Dt=_.current?.get(he);console.log(` TTS: Playing buffered sentence ${he+1}/${ce.length} (generated at rate=${Dt??"n/a"}, playback rate=${w.current})`),fe.playBlob(ct,ht,er?.objectUrl).catch(kt=>{if(d.current){console.log("TTS: Buffered playback error during intentional stop, resolving instead of rejecting"),nt();return}mt(kt)})}else console.log(` TTS: Playing sentence ${he+1}/${ce.length} (not buffered) (playback rate=${w.current})`),fe.speak(Ie,ht).catch(Dt=>{if(d.current){console.log("TTS: Chunk speak error during intentional stop, resolving instead of rejecting"),nt();return}mt(Dt)})});try{const nt=xe.get(he);if(nt?.objectUrl)try{URL.revokeObjectURL(nt.objectUrl)}catch(mt){}}catch{}if(xe.delete(he),_.current?.delete(he),d.current||!m.current){console.log("TTS: Stop detected after chunk completion, exiting loop"),m.current=null;try{P(k.current)}catch{}k.current=null,_.current=null,x(nt=>({...nt,...s()}));return}}}else for(let xe=0;xe<ye.length;xe++){if(d.current||!m.current){console.log("TTS: Chunked playback stopped at loop start (browser TTS)"),m.current=null;try{P(k.current)}catch{}k.current=null,_.current=null,x(ze=>({...ze,...s()}));return}const me=ye[xe],de=Ae[xe];console.log(`TTS: Playing chunk ${xe+1}/${ye.length} (${me.length} chars, sentences ${de[0]+1}-${de[de.length-1]+1})`),console.log(`   Text preview: "${me.substring(0,80)}..."`),console.log(`   isStoppingIntentionally: ${d.current}, hasState: ${!!m.current}`);const he=de[0],Ie=de[de.length-1];if(m.current.currentChunkIndex=xe,await new Promise((ze,nt)=>{if(d.current||!m.current){console.log("TTS: Stop detected before speak call (browser), aborting"),ze();return}const mt={...se,onStart:()=>{if(console.log(`TTS: Chunk ${xe+1} started speaking - highlighting sentence ${he+1}`),x(ht=>({...ht,currentChunkIndex:he})),xe===0){if(console.log("TTS: First chunk started - clearing fallback timeout"),l&&(clearTimeout(l),c(null)),x(ht=>({...ht,isLoadingAudio:!1})),"getActiveProviderName"in fe&&typeof fe.getActiveProviderName=="function"){const ht=fe.getActiveProviderName();ht&&(console.log(` TTSContext chunked browser onStart: FallbackTTSProvider is using: ${ht}`),x(er=>({...er,activeProvider:ht})))}K.onStart?.()}},onEnd:()=>{console.log(`TTS: Chunk ${xe+1} finished - moving to sentence ${Ie+1}`),console.log(`   About to resolve Promise for chunk ${xe+1}`),x(ht=>({...ht,currentChunkIndex:Ie})),ze()},onError:ht=>{if(console.error(`TTS: Error in chunk ${xe+1}:`,ht),console.log(`   isStoppingIntentionally: ${d.current}`),d.current){console.log("TTS: Chunk error during intentional stop, resolving instead of rejecting"),ze();return}nt(ht)}};fe.speak(me,mt).catch(ht=>{if(d.current){console.log("TTS: Chunk speak error during intentional stop, resolving instead of rejecting"),ze();return}nt(ht)})}),console.log(`TTS: Promise resolved for chunk ${xe+1}, checking stop conditions...`),d.current||!m.current){console.log("TTS: Stop detected after chunk completion (browser TTS), exiting loop"),m.current=null;try{P(k.current)}catch{}k.current=null,_.current=null,x(ze=>({...ze,...s()}));return}if(console.log(`TTS: Chunk ${xe+1} completed successfully, continuing...`),xe<ye.length-1&&(console.log(`TTS: Adding 50ms delay before chunk ${xe+2}...`),await new Promise(ze=>setTimeout(ze,50)),d.current||!m.current)){console.log("TTS: Stop detected after inter-chunk delay, exiting loop"),m.current=null;try{P(k.current)}catch{}k.current=null,_.current=null,x(ze=>({...ze,...s()}));return}}console.log("TTS: All chunks played successfully"),m.current=null,l&&(console.log("TTS: All chunks complete - clearing fallback timeout"),clearTimeout(l),c(null));try{P(k.current)}catch{}k.current=null,_.current=null,x(xe=>({...xe,...s()})),K.onEnd?.()},[y,i,l,c]),M=N.useCallback(()=>{console.log(" TTSContext.stop() called - INTENTIONAL STOP"),console.log("   - activeProviderRef.current:",g.current?.name||"NULL"),console.log("   - currentProviderRef.current:",p.current),console.log("   - state.isPlaying:",y.isPlaying),console.log("   - state.currentProvider:",y.currentProvider),d.current=!0,m.current&&(console.log("TTSContext.stop() - Clearing chunked playback state"),m.current=null),l&&(clearTimeout(l),c(null));const I=g.current?.name?.toLowerCase()||"",K=I.includes("browser")||I.includes("speech");typeof window<"u"&&window.speechSynthesis&&!K?(console.log("TTSContext.stop() - Stopping speechSynthesis AGGRESSIVELY (not browser provider)"),window.speechSynthesis.cancel(),window.speechSynthesis.pause(),window.speechSynthesis.cancel(),setTimeout(()=>window.speechSynthesis.cancel(),0),setTimeout(()=>window.speechSynthesis.cancel(),10),setTimeout(()=>window.speechSynthesis.cancel(),100)):K&&console.log("TTSContext.stop() - Skipping aggressive speechSynthesis cancel (using browser provider)");const U=document.querySelectorAll("audio");console.log("TTSContext.stop() - Found",U.length,"audio elements"),U.forEach(ye=>{ye.paused||(console.log("TTSContext.stop() - Force stopping audio element"),ye.pause(),ye.currentTime=0,ye.src&&ye.src.startsWith("blob:")&&(URL.revokeObjectURL(ye.src),ye.src=""))});const ce=g.current?.name;if(g.current){console.log("TTSContext.stop() - calling activeProviderRef.current.stop():",ce);try{g.current.stop()}catch(ye){console.error("TTSContext.stop() - Error calling activeProviderRef.stop():",ye)}}x(ye=>{console.log("TTSContext.stop() - stopping, prev state:",{isPlaying:ye.isPlaying,currentProvider:ye.currentProvider});const Ae=i.getProvider(ye.currentProvider),fe=Ae&&(Ae===g.current||Ae.name===ce);if(Ae&&!fe){console.log("TTSContext.stop() - also calling currentProvider.stop():",ye.currentProvider);try{Ae.stop()}catch(Te){console.error("TTSContext.stop() - Error calling provider.stop():",Te)}}else fe&&console.log("TTSContext.stop() - skipping duplicate stop call (same provider):",Ae?.name);const Ne={...ye,isPlaying:!1,currentText:null,activeProvider:null,chunks:[],currentChunkIndex:-1,totalChunks:0};return console.log("TTSContext.stop() - setting isPlaying=false, new state:",Ne),Ne}),setTimeout(()=>{x(ye=>ye.isPlaying?(console.warn(" TTSContext.stop() - isPlaying was still true after 100ms, forcing false"),{...ye,isPlaying:!1,currentText:null,activeProvider:null}):ye)},100),g.current=null,p.current="auto";try{P(k.current)}catch{}k.current=null,_.current=null},[i,l]),$=N.useCallback(()=>{x(I=>{const K=i.getProvider(I.currentProvider);return K&&K.pause&&K.pause(),I})},[i]),Z=N.useCallback(()=>{x(I=>{const K=i.getProvider(I.currentProvider);return K&&K.resume&&K.resume(),I})},[i]),z=N.useCallback(I=>{if(!m.current||!y.chunks.length){console.warn("seekToChunk: No chunked playback active");return}if(I<0||I>=y.totalChunks){console.warn(`seekToChunk: Invalid chunk index ${I} (total: ${y.totalChunks})`);return}console.log(` Seeking to chunk ${I+1}/${y.totalChunks}`);const K=y.currentText,U=y.chunks;M(),setTimeout(()=>{if(!K)return;const ce=i.getProvider(y.currentProvider);if(!ce){console.error("seekToChunk: No provider available");return}d.current=!1,m.current={isChunked:!0,chunks:U,currentChunkIndex:I,totalChunks:U.length},g.current=ce,p.current=y.currentProvider,x(fe=>({...fe,isPlaying:!0,currentText:K,chunks:U,currentChunkIndex:I,totalChunks:U.length}));try{"setPlaybackRate"in ce&&typeof ce.setPlaybackRate=="function"&&ce.setPlaybackRate(y.rate),"setVolume"in ce&&typeof ce.setVolume=="function"&&ce.setVolume(y.volume)}catch(fe){console.warn("seekToChunk: Failed to apply rate/volume:",fe)}const Ae={voice:y.providerVoices[y.currentProvider]||void 0,rate:y.rate,volume:y.volume};(async()=>{for(let fe=I;fe<U.length;fe++){if(d.current||!m.current){console.log("TTS: Seek playback stopped"),m.current=null,x(Te=>({...Te,...s()}));return}const Ne=U[fe];if(console.log(`TTS: Seek playing sentence ${fe+1}/${U.length}: "${Ne.substring(0,50)}..."`),m.current.currentChunkIndex=fe,x(Te=>({...Te,currentChunkIndex:fe})),await new Promise((Te,se)=>{if(d.current||!m.current){Te();return}const be={...Ae,onEnd:()=>{console.log(`TTS: Seek sentence ${fe+1} finished`),Te()},onError:xe=>{console.error(`TTS: Error in seek sentence ${fe+1}:`,xe),d.current?Te():se(xe)}};ce.speak(Ne,be).catch(xe=>{d.current?Te():se(xe)})}),d.current||!m.current){console.log("TTS: Seek playback stopped after chunk"),m.current=null,x(Te=>({...Te,...s()}));return}fe<U.length-1&&await new Promise(Te=>setTimeout(Te,50))}console.log("TTS: Seek playback completed all chunks"),m.current=null,x(fe=>({...fe,...s()}))})()},100)},[y.chunks,y.currentText,y.totalChunks,y.currentProvider,y.rate,y.volume,y.providerVoices,M,i]),ee=N.useCallback(async I=>{console.log(` [TTSContext] setProvider called with: ${I}`);const K=i.getProvider(I);if(console.log(" [TTSContext] Provider found:",K?" Yes":" No"),!K&&I!=="elevenlabs"){console.error(` [TTSContext] Provider "${I}" not found in factory`);return}if(M(),!K){console.log(` [TTSContext] ${I} not initialized, updating state for configuration`),x(ce=>({...ce,currentProvider:I,voices:[],boundarySupported:!1})),a(ce=>({...ce,currentProvider:I}));return}const U=K.isBoundarySupported?.()||!1;console.log(` [TTSContext] Provider ${I} boundary support:`,U);try{console.log(` [TTSContext] Loading voices for: ${I}`);const ce=await K.getVoices();if(console.log(` [TTSContext] Loaded ${ce.length} voices for: ${I}`),I==="browser"&&ce.length>0&&!y.providerVoices.browser){const ye=ce[0];console.log(` [TTSContext] Auto-selecting default browser voice: ${ye.name} (ID: ${ye.id})`),x(Ae=>({...Ae,currentProvider:I,voices:ce,boundarySupported:U,providerVoices:{...Ae.providerVoices,browser:ye.id},usingNonLocalVoice:ye.isLocal===!1})),a(Ae=>({...Ae,currentProvider:I,providerVoices:{...Ae.providerVoices,browser:ye.id}}))}else x(ye=>({...ye,currentProvider:I,voices:ce,boundarySupported:U})),a(ye=>({...ye,currentProvider:I}));console.log(` [TTSContext] State updated to provider: ${I}, boundary: ${U}`)}catch(ce){console.error(` [TTSContext] Failed to switch provider to ${I}:`,ce)}},[i,M,a]),te=N.useCallback(async(I,K)=>{const U=K||y.currentProvider;console.log(` setVoice called: voiceId="${I}", provider="${U}"`);let ce=!1;if(U==="browser"){const ye=i.getProvider("browser");if(ye){const Ae=await ye.getVoices(),fe=Ae.find(Ne=>Ne.id===I);ce=fe?.isLocal===!1,console.log(` Selected voice "${fe?.name}" (ID: ${I}): ${ce?"REMOTE":"LOCAL"}`),fe||(console.error(` Voice with ID "${I}" not found in provider voices!`),console.log("   Available voice IDs:",Ae.slice(0,10).map(Ne=>Ne.id)))}}x(ye=>({...ye,providerVoices:{...ye.providerVoices,[U]:I},usingNonLocalVoice:ce})),a(ye=>({...ye,providerVoices:{...ye.providerVoices,[U]:I}}))},[y.currentProvider,a,i]),X=N.useCallback(I=>{console.log(` TTSContext.setRate(${I})`),a(ce=>({...ce,rate:I}));const K=w.current;w.current=I;try{const ce=k.current;if(ce&&ce.size>0){const ye=Math.abs(I-K)/(K||1);ye>=.15&&(console.log(` TTSContext: Invalidating ${ce.size} pregenerated blobs due to rate change ${K} -> ${I} (rel ${ye.toFixed(2)})`),P(ce),_.current&&_.current.clear())}}catch(ce){console.warn(" TTSContext: Error while invalidating pregenerated blobs on rate change",ce)}const U=g.current;console.log("   - activeProviderRef.current:",U?.name||"null"),U?"setPlaybackRate"in U&&typeof U.setPlaybackRate=="function"?(console.log(` TTSContext: Calling provider.setPlaybackRate(${I})`),U.setPlaybackRate(I)):console.warn(` TTSContext: Provider ${U.name} does not support setPlaybackRate`):console.log(" TTSContext: Not applying rate - no active provider")},[a]),Q=N.useCallback(I=>{console.log(` TTSContext.setVolume(${I})`),a(ce=>({...ce,volume:I}));const K=g.current;console.log("   - activeProviderRef.current:",K?.name||"null"),K?"setVolume"in K&&typeof K.setVolume=="function"?(console.log(` TTSContext: Calling provider.setVolume(${I})`),K.setVolume(I)):console.warn(` TTSContext: Provider ${K.name} does not support setVolume`):console.log(" TTSContext: Not applying volume - no active provider");const U=T.current;T.current=I;try{const ce=k.current;ce&&ce.size>0&&Math.abs(I-U)>=.2&&(console.log(` TTSContext: Invalidating ${ce.size} pregenerated blobs due to volume change ${U} -> ${I}`),P(ce),_.current&&_.current.clear())}catch(ce){console.warn(" TTSContext: Error while invalidating pregenerated blobs on volume change",ce)}},[a]),W=N.useCallback(async I=>{x(U=>({...U,elevenlabsApiKey:I})),a(U=>({...U,elevenlabsApiKey:I})),await i.updateElevenLabsApiKey(I);const K=i.getAvailableProviders();console.log("Available TTS providers after ElevenLabs update:",K)},[a,i]),H=N.useCallback(()=>i.getAvailableProviders(),[i]),re=N.useCallback(async(I,K)=>{const U=i.getProvider(I);return U?await U.getVoices(K):[]},[i]),ne=N.useCallback(async I=>D(I),[D]),ve=N.useCallback(async I=>D(I),[D]),O={state:y,speak:D,stop:M,pause:$,resume:Z,seekToChunk:z,updateCurrentText:F,setProvider:ee,setVoice:te,setRate:X,setVolume:Q,setElevenLabsApiKey:W,getAvailableProviders:H,getVoicesForProvider:re,speakResponse:ne,speakSnippet:ve};return u.jsx(hI.Provider,{value:O,children:t})},nf=()=>{const t=N.useContext(hI);if(!t)throw new Error("useTTS must be used within a TTSProvider");return t},pI=N.createContext(void 0),Oq=()=>{const t=N.useContext(pI);if(!t)throw new Error("useFeatures must be used within a FeaturesProvider");return t},jq=({children:t})=>{const{getToken:e,isAuthenticated:r}=oi(),[n,a]=N.useState(null),[s,i]=N.useState(!0),[l,c]=N.useState(null),d=async()=>{try{i(!0),c(null);const g=await e();if(!g){a({chat:!1,imageGeneration:!1,imageEditing:!1,imageEditingBasic:!0,imageEditingAI:!1,transcription:!1,textToSpeech:!1,embeddings:!1,webSearch:!0}),i(!1);return}const m=await dn(),y=await fetch(`${m}/billing`,{method:"GET",headers:{Authorization:`Bearer ${g}`,"Content-Type":"application/json"},credentials:"include"});if(!y.ok)throw new Error(`HTTP ${y.status}: ${y.statusText}`);const x=await y.json();x.features?a({...x.features,imageEditingBasic:x.features.imageEditingBasic??!0,imageEditingAI:x.features.imageEditingAI??x.features.imageEditing??!1}):a({chat:!1,imageGeneration:!1,imageEditing:!1,imageEditingBasic:!0,imageEditingAI:!1,transcription:!1,textToSpeech:!1,embeddings:!1,webSearch:!0}),i(!1)}catch(g){console.error("Failed to load features:",g),c(g.message||"Failed to load features"),a({chat:!1,imageGeneration:!1,imageEditing:!1,imageEditingBasic:!0,imageEditingAI:!1,transcription:!1,textToSpeech:!1,embeddings:!1,webSearch:!0}),i(!1)}};N.useEffect(()=>{r?d():(a({chat:!1,imageGeneration:!1,imageEditing:!1,imageEditingBasic:!0,imageEditingAI:!1,transcription:!1,textToSpeech:!1,embeddings:!1,webSearch:!0}),i(!1))},[r]);const p=async()=>{await d()};return u.jsx(pI.Provider,{value:{features:n,loading:s,error:l,refreshFeatures:p},children:t})},Bq=()=>{const{t,i18n:e}=Lc(),r=Xi(),[n,a]=N.useState(!0),s=N.useRef(!1),i=c=>{e.changeLanguage(c)};N.useEffect(()=>{s.current||(s.current=!0,Yn.init().then(()=>{console.log(" Google Auth service initialized"),a(!1)}).catch(c=>{console.error(" Failed to initialize Google Auth:",c),a(!1)}))},[]);const l=async()=>{try{sessionStorage.getItem("request_drive_access")==="true"?(console.log(" Requesting Google Drive access during sign-in..."),await Yn.signInWithDriveAccess(),sessionStorage.removeItem("request_drive_access")):await Yn.signIn();const d=sessionStorage.getItem("auth_redirect");d?(sessionStorage.removeItem("auth_redirect"),window.location.hash=d.startsWith("#")?d.slice(1):d):r("/")}catch(c){console.error(" Sign-in failed:",c)}};return u.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-12 max-w-3xl w-full mx-4 relative overflow-y-auto max-h-[95vh]",children:[u.jsx("div",{className:"absolute top-4 right-4",children:u.jsxs("select",{value:e.language,onChange:c=>i(c.target.value),className:"px-3 py-1.5 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[u.jsxs("option",{value:"en",children:[" ",t("languages.en")]}),u.jsxs("option",{value:"es",children:[" ",t("languages.es")]}),u.jsxs("option",{value:"fr",children:[" ",t("languages.fr")]}),u.jsxs("option",{value:"de",children:[" ",t("languages.de")]}),u.jsxs("option",{value:"nl",children:[" ",t("languages.nl")]}),u.jsxs("option",{value:"pt",children:[" ",t("languages.pt")]}),u.jsxs("option",{value:"ru",children:[" ",t("languages.ru")]}),u.jsxs("option",{value:"zh",children:[" ",t("languages.zh")]}),u.jsxs("option",{value:"ja",children:[" ",t("languages.ja")]}),u.jsxs("option",{value:"ar",children:[" ",t("languages.ar")]})]})}),u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"inline-flex items-center justify-center mb-4",children:u.jsx("img",{src:"/agent.png",alt:t("auth.researchAgent"),className:"w-24 h-24 object-contain"})}),u.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:t("auth.researchAgent")}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:t("auth.tagline")}),u.jsx("div",{className:"flex justify-center mb-4",children:u.jsxs("button",{onClick:l,disabled:n,className:"flex items-center gap-3 px-6 py-3 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow hover:shadow-md transition-all text-gray-700 dark:text-gray-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),n?t("auth.initializing")||"Initializing...":t("auth.signInWithGoogle")||"Sign in with Google"]})}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t("auth.secureAuth")}),u.jsx("div",{className:"mt-3",children:u.jsx(SS,{to:"/privacy",className:"text-sm text-blue-600 dark:text-blue-400 hover:underline font-medium",children:" Privacy Policy"})})]}),u.jsxs("div",{className:"mb-8 text-left space-y-4 max-w-2xl mx-auto",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white text-center",children:t("auth.whyChooseTitle")}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm leading-relaxed",children:t("auth.whyChooseIntro")}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:t("auth.keyAdvantagesTitle")}),u.jsxs("div",{className:"space-y-2.5 text-sm",children:[u.jsxs("div",{children:[u.jsxs("strong",{className:"text-blue-600 dark:text-blue-400",children:[t("auth.webConnected"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.webConnectedDesc")]})]}),u.jsxs("div",{children:[u.jsxs("strong",{className:"text-purple-600 dark:text-purple-400",children:[t("auth.multiTool"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.multiToolDesc")]})]}),u.jsxs("div",{children:[u.jsxs("strong",{className:"text-green-600 dark:text-green-400",children:[t("auth.knowledgeBase"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.knowledgeBaseDesc")]})]}),u.jsxs("div",{children:[u.jsxs("strong",{className:"text-indigo-600 dark:text-indigo-400",children:[t("auth.advancedPlanning"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.advancedPlanningDesc")]})]}),u.jsxs("div",{children:[u.jsx("strong",{className:"text-cyan-600 dark:text-cyan-400",children:" Personalized Learning Feed:"}),u.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:" Discover fascinating facts, news, and educational content tailored to your interests. Test your knowledge with auto-generated quizzes and expand your learning with AI chat."})]}),u.jsxs("div",{children:[u.jsxs("strong",{className:"text-yellow-600 dark:text-yellow-400",children:[t("auth.costEffective"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.costEffectiveDesc")]})]}),u.jsxs("div",{children:[u.jsxs("strong",{className:"text-pink-600 dark:text-pink-400",children:[t("auth.transparency"),":"]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t("auth.transparencyDesc")]})]})]})]}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm italic border-t border-gray-200 dark:border-gray-700 pt-3",children:t("auth.perfectFor")})]})]})})},u_=()=>{const{user:t,logout:e}=oi(),{isAvailable:r,isConnected:n,deviceName:a,requestSession:s,endSession:i}=_S();Ur.useEffect(()=>{console.log("GoogleLoginButton - user state:",t),console.log("GoogleLoginButton - localStorage keys:",{user_email:localStorage.getItem("user_email"),user_name:localStorage.getItem("user_name"),user_picture:localStorage.getItem("user_picture")})},[t]);const l=()=>{n?i():s()};return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:e,className:"btn-secondary px-3 py-2 flex items-center gap-2",title:t?.email?`Sign out ${t.email}`:"Sign out","aria-label":"Logout",children:[t?.picture?u.jsx("img",{src:t.picture,alt:t.name||t.email||"User",className:"w-6 h-6 rounded-full",referrerPolicy:"no-referrer"}):u.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-300 dark:bg-gray-600 flex items-center justify-center",children:u.jsx("svg",{className:"w-4 h-4 text-gray-600 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})})}),u.jsx("span",{children:"Logout"})]}),r&&u.jsx("button",{onClick:l,className:`btn-secondary p-2 ${n?"bg-blue-500 text-white hover:bg-blue-600":""}`,title:n?`Casting to ${a}`:"Cast to TV","aria-label":n?`Casting to ${a}`:"Cast to TV",children:u.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M1,18 v3 h3 c0,-1.66 -1.34,-3 -3,-3 z M1,14 v2 c2.76,0 5,2.24 5,5 h2 c0,-3.87 -3.13,-7 -7,-7 z M1,10 v2 c4.97,0 9,4.03 9,9 h2 c0,-6.08 -4.93,-11 -11,-11 z M21,3 H3 C1.9,3 1,3.9 1,5 v3 h2 V5 h18 v14 h-7 v2 h7 c1.1,0 2,-0.9 2,-2 V5 c0,-1.1 -0.9,-2 -2,-2 z"})})})]})};function d_(t){if(!t||!isFinite(t))return"0:00";const e=Math.floor(t/60),r=Math.floor(t%60);return`${e}:${r.toString().padStart(2,"0")}`}const Fq=()=>{const{playlist:t,isPlaying:e,currentTrack:r,togglePlayPause:n,nextTrack:a,previousTrack:s}=Ch(),{isLoading:i,currentTime:l,duration:c}=UP(),d=Xi();if(t.length===0)return null;const p=()=>{console.log("[PlaylistButton] Play/Pause clicked - current isPlaying:",e),n()},g=()=>{s()},m=()=>{a()};return u.jsx(u.Fragment,{children:u.jsxs("div",{className:"flex items-center gap-0.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg overflow-hidden shadow-sm",children:[u.jsx("button",{onClick:g,className:"p-1.5 sm:p-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Previous track",children:u.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M6 6h2v12H6V6zm3.5 6l8.5 6V6l-8.5 6z"})})}),u.jsx("button",{onClick:p,className:`p-1.5 sm:p-2 transition-colors ${e?"bg-blue-500 hover:bg-blue-600 text-white":"bg-green-500 hover:bg-green-600 text-white"}`,title:e?"Pause":"Play",children:e?u.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M6 4h4v16H6V4zm8 0h4v16h-4V4z"})}):u.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 5v14l11-7z"})})}),u.jsx("button",{onClick:m,className:"p-1.5 sm:p-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Next track",children:u.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-700 dark:text-gray-300",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M16 18h2V6h-2v12zM6 18l8.5-6L6 6v12z"})})}),u.jsx("div",{className:"hidden sm:flex flex-col items-start px-2 py-1 min-w-0 max-w-[150px] md:max-w-[250px]",children:i&&e?u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsxs("svg",{className:"animate-spin h-3 w-3 text-gray-700 dark:text-gray-300",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Loading..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-xs text-gray-700 dark:text-gray-300 truncate w-full",children:r?.title?r.title.slice(0,10):"No track"}),c>0&&u.jsxs("span",{className:"text-[10px] text-gray-500 dark:text-gray-400 font-mono",children:[d_(l)," / ",d_(c)]})]})}),u.jsxs("button",{onClick:y=>{y.stopPropagation(),console.log("[PlaylistButton] Opening music page, playlist size:",t.length),d("/music")},className:"p-1.5 sm:p-2 bg-purple-500 hover:bg-purple-600 text-white transition-colors flex items-center gap-1",title:"View full music page",children:[u.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z"})}),u.jsx("span",{className:"hidden md:inline text-xs font-medium",children:t.length})]})]})})},zq=Fq,gI=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,h_=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,p_=/\.(m3u8)($|\?)/i,$q=/\.(mpd)($|\?)/i,Uq=/stream\.mux\.com\/(?!\w+\.m3u8)(\w+)/,qq=/(?:youtu\.be\/|youtube(?:-nocookie|education)?\.com\/(?:embed\/|v\/|watch\/|watch\?v=|watch\?.+&v=|shorts\/|live\/))((\w|-){11})|youtube\.com\/playlist\?list=|youtube\.com\/user\//,Hq=/vimeo\.com\/(?!progressive_redirect).+/,Gq=/(?:wistia\.(?:com|net)|wi\.st)\/(?:medias|embed)\/(?:iframe\/)?([^?]+)/,Vq=/open\.spotify\.com\/(\w+)\/(\w+)/i,Wq=/(?:www\.|go\.)?twitch\.tv\/([a-zA-Z0-9_]+|(videos?\/|\?video=)\d+)($|\?)/,Yq=/tiktok\.com\/(?:player\/v1\/|share\/video\/|@[^/]+\/video\/)([0-9]+)/,ug=(t,e)=>{if(Array.isArray(t)){for(const r of t)if(typeof r=="string"&&ug(r,e)||ug(r.src,e))return!0;return!1}return e(t)},Mo={html:t=>ug(t,e=>gI.test(e)||h_.test(e)),hls:t=>ug(t,e=>p_.test(e)),dash:t=>ug(t,e=>$q.test(e)),mux:t=>Uq.test(t),youtube:t=>qq.test(t),vimeo:t=>Hq.test(t)&&!h_.test(t)&&!p_.test(t),wistia:t=>Gq.test(t),spotify:t=>Vq.test(t),twitch:t=>Wq.test(t),tiktok:t=>Yq.test(t)},Qq=Ur.forwardRef((t,e)=>{const r=gI.test(`${t.src}`)?"audio":"video";return Ur.createElement(r,{...t,ref:e},t.children)});var Kq=Qq;const Xq=[{key:"hls",name:"hls.js",canPlay:Mo.hls,canEnablePIP:()=>!0,player:N.lazy(()=>Zt(()=>import("./react-BgwRgTgO.js"),__vite__mapDeps([0,1,2])))},{key:"dash",name:"dash.js",canPlay:Mo.dash,canEnablePIP:()=>!0,player:N.lazy(()=>Zt(()=>import("./react-6yh3z1qW.js"),__vite__mapDeps([3,1])))},{key:"mux",name:"Mux",canPlay:Mo.mux,canEnablePIP:()=>!0,player:N.lazy(()=>Zt(()=>import("./index-CzhhGkFT.js"),__vite__mapDeps([4,2,1])))},{key:"youtube",name:"YouTube",canPlay:Mo.youtube,player:N.lazy(()=>Zt(()=>import("./react-Cqd5_qjS.js"),[]))},{key:"vimeo",name:"Vimeo",canPlay:Mo.vimeo,player:N.lazy(()=>Zt(()=>import("./react-BC5YPHj0.js"),[]))},{key:"wistia",name:"Wistia",canPlay:Mo.wistia,canEnablePIP:()=>!0,player:N.lazy(()=>Zt(()=>import("./react-CGpMulJD.js"),[]))},{key:"spotify",name:"Spotify",canPlay:Mo.spotify,canEnablePIP:()=>!1,player:N.lazy(()=>Zt(()=>import("./react-DWgARoSG.js"),[]))},{key:"twitch",name:"Twitch",canPlay:Mo.twitch,canEnablePIP:()=>!1,player:N.lazy(()=>Zt(()=>import("./react-B0PzSlRT.js"),[]))},{key:"tiktok",name:"TikTok",canPlay:Mo.tiktok,canEnablePIP:()=>!1,player:N.lazy(()=>Zt(()=>import("./react-CNlEXA_P.js"),[]))},{key:"html",name:"html",canPlay:Mo.html,canEnablePIP:()=>!0,player:Kq}];var Vw=Xq;const Jq={width:"320px",height:"180px",volume:1,playbackRate:1,previewTabIndex:0,previewAriaLabel:"",oEmbedUrl:"https://noembed.com/embed?url={url}"},fI=Ur.forwardRef((t,e)=>{const{playing:r,pip:n}=t,a=t.activePlayer,s=N.useRef(null),i=N.useRef(!0);N.useEffect(()=>{var g,m;s.current&&(s.current.paused&&r===!0&&s.current.play(),!s.current.paused&&r===!1&&s.current.pause(),s.current.playbackRate=(g=t.playbackRate)!=null?g:1,s.current.volume=(m=t.volume)!=null?m:1)}),N.useEffect(()=>{var g,m,y,x,w;if(!(!s.current||!globalThis.document)){if(n&&!document.pictureInPictureElement)try{(m=(g=s.current).requestPictureInPicture)==null||m.call(g)}catch{}if(!n&&document.pictureInPictureElement)try{(x=(y=s.current).exitPictureInPicture)==null||x.call(y),(w=document.exitPictureInPicture)==null||w.call(document)}catch{}}},[n]);const l=g=>{var m,y;i.current=!0,(m=t.onReady)==null||m.call(t),(y=t.onLoadStart)==null||y.call(t,g)},c=g=>{var m,y;i.current&&(i.current=!1,(m=t.onStart)==null||m.call(t,g)),(y=t.onPlay)==null||y.call(t,g)};if(!a)return null;const d={},p=["onReady","onStart"];for(const g in t)g.startsWith("on")&&!p.includes(g)&&(d[g]=t[g]);return Ur.createElement(a,{...d,style:t.style,className:t.className,slot:t.slot,ref:N.useCallback(g=>{s.current=g,typeof e=="function"?e(g):e!==null&&(e.current=g)},[e]),src:t.src,crossOrigin:t.crossOrigin,preload:t.preload,controls:t.controls,muted:t.muted,autoPlay:t.autoPlay,loop:t.loop,playsInline:t.playsInline,config:t.config,onLoadStart:l,onPlay:c},t.children)});fI.displayName="Player";var Zq=fI;const eH=N.lazy(()=>Zt(()=>import("./Preview-DOqOpL7B.js"),[])),Ap=[],tH=(t,e)=>{const r=a=>{for(const s of[...Ap,...t])if(a&&s.canPlay(a))return s;return e||null},n=Ur.forwardRef((a,s)=>{const i={...Jq,...a},{src:l,slot:c,className:d,style:p,width:g,height:m,fallback:y,wrapper:x}=i,[w,T]=N.useState(!!i.light);N.useEffect(()=>{i.light?T(!0):T(!1)},[i.light]);const k=B=>{var M;T(!1),(M=i.onClickPreview)==null||M.call(i,B)},_=B=>{if(!B)return null;const{light:M,playIcon:$,previewTabIndex:Z,oEmbedUrl:z,previewAriaLabel:ee}=i;return Ur.createElement(eH,{src:B,light:M,playIcon:$,previewTabIndex:Z,previewAriaLabel:ee,oEmbedUrl:z,onClickPreview:k})},P=B=>{var M,$;const Z=r(B);if(!Z)return null;const{style:z,width:ee,height:te,wrapper:X}=i,Q=(M=i.config)==null?void 0:M[Z.key];return Ur.createElement(Zq,{...i,ref:s,activePlayer:($=Z.player)!=null?$:Z,slot:X?void 0:c,className:X?void 0:d,style:X?{display:"block",width:"100%",height:"100%"}:{display:"block",width:ee,height:te,...z},config:Q})},F=x??g_,D=y===!1?g_:N.Suspense;return Ur.createElement(F,{slot:c,className:d,style:{width:g,height:m,...p}},Ur.createElement(D,{fallback:y},w?_(l):P(l)))});return n.displayName="ReactPlayer",n.addCustomPlayer=a=>{Ap.push(a)},n.removeCustomPlayers=()=>{Ap.length=0},n.canPlay=a=>{if(a){for(const s of[...Ap,...t])if(s.canPlay(a))return!0}return!1},n.canEnablePIP=a=>{var s;if(a){for(const i of[...Ap,...t])if(i.canPlay(a)&&((s=i.canEnablePIP)!=null&&s.call(i)))return!0}return!1},n},g_=({children:t})=>t,rH=Vw[Vw.length-1];var nH=tH(Vw,rH);const aH=()=>{const t=N.useRef(null),{currentTrack:e,isPlaying:r,nextTrack:n,play:a,pause:s}=Ch(),{registerPlayer:i,unregisterPlayer:l,setIsLoading:c,setCurrentTime:d,setDuration:p}=UP(),{isCastingVideo:g}=_S();N.useEffect(()=>(t.current&&(console.log("[BackgroundPlayer] Registering player"),i(t.current)),()=>{console.log("[BackgroundPlayer] Unregistering player"),l()}),[i,l]),N.useEffect(()=>{console.log("[BackgroundPlayer] Track or playing state changed - isPlaying:",r,"currentTrack:",e?.title),e&&r?c(!0):r||c(!1)},[e,r,c]);const[m,y]=Ur.useState(!1),x=Ur.useRef(0),w=Ur.useRef(!1);if(Ur.useEffect(()=>{const P=()=>{const D=document.getElementById("dialog-player-container"),B=m,M=!!D;B!==M&&(console.log("[BackgroundPlayer] Dialog opening, last tracked position:",x.current,"isPlaying:",r),w.current=r),y(M)};P();const F=new MutationObserver(()=>{setTimeout(P,10)});return F.observe(document.body,{childList:!0,subtree:!0}),()=>F.disconnect()},[m,r]),!e)return null;const T=u.jsx(nH,{ref:P=>{t.current=P,P&&(console.log("[BackgroundPlayer] ReactPlayer ref set, registering player, dialogOpen:",m),i(P))},src:e.url,playing:r&&!g,controls:!0,width:"100%",height:"100%",style:{position:"absolute",top:0,left:0},className:"react-player-hide-controls",onReady:()=>{console.log("[BackgroundPlayer] ReactPlayer ready, URL:",e.url,"isPlaying:",r,"dialogOpen:",m,"savedPosition:",x.current);const P=t.current;P&&P.duration&&p(P.duration)},onTimeUpdate:P=>{const F=P.currentTarget.currentTime,D=P.currentTarget.duration;F>0&&(x.current=F,d(F),console.log("[BackgroundPlayer] Position:",F.toFixed(2))),D>0&&p(D)},onPlay:()=>{console.log("[BackgroundPlayer] Playback started - syncing play state"),r||a(),setTimeout(()=>c(!1),500)},onStart:()=>{if(console.log("[BackgroundPlayer] Media started, savedPosition:",x.current),x.current>1){const P=x.current;console.log("[BackgroundPlayer] Will seek to saved position:",P),setTimeout(()=>{const F=t.current;F&&typeof F.currentTime=="number"?(console.log("[BackgroundPlayer] Setting currentTime from",F.currentTime,"to",P),F.currentTime=P,x.current=0):console.log("[BackgroundPlayer]  Cannot seek - video element not ready")},300)}setTimeout(()=>c(!1),500)},onPause:()=>{console.log("[BackgroundPlayer]  PLAYBACK PAUSED - syncing pause state, isPlaying:",r),r&&s()},onEnded:n,onError:P=>{console.error("[BackgroundPlayer] Playback error:",P),c(!1)}},`player-${e.videoId}`);let k=document.getElementById("background-player-mount");k||(k=document.createElement("div"),k.id="background-player-mount",k.className="fixed bottom-0 left-0",k.style.cssText="width: 1px; height: 1px; overflow: hidden; pointer-events: none; z-index: -1; opacity: 0;",document.body.appendChild(k));const _=m?document.getElementById("dialog-player-container"):k;return _?w$.createPortal(u.jsx("div",{className:"w-full h-full relative bg-black",style:{aspectRatio:"16/9"},children:T}),_):null};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iH=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),f_=t=>{const e=iH(t);return e.charAt(0).toUpperCase()+e.slice(1)},mI=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),oH=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lH={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=N.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...l},c)=>N.createElement("svg",{ref:c,...lH,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:mI("lucide",a),...!s&&!oH(l)&&{"aria-hidden":"true"},...l},[...i.map(([d,p])=>N.createElement(d,p)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=(t,e)=>{const r=N.forwardRef(({className:n,...a},s)=>N.createElement(cH,{ref:s,iconNode:e,className:mI(`lucide-${sH(f_(t))}`,`lucide-${t}`,n),...a}));return r.displayName=f_(t),r};/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],I0=ja("brain",uH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],m_=ja("circle-check",dH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],y_=ja("circle-x",hH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]],gH=ja("cloud",pH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],mH=ja("external-link",fH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],b_=ja("file-text",yH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bH=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],yI=ja("folder-open",bH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xH=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],vH=ja("link",xH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],SH=ja("message-square",wH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kH=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],TH=ja("palette",kH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CH=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],EH=ja("plus",CH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _H=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],AH=ja("refresh-cw",_H);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],PH=ja("rotate-ccw",NH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IH=[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],bI=ja("rss",IH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RH=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],DH=ja("save",RH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LH=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],xI=ja("share-2",LH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MH=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],OH=ja("trash-2",MH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jH=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],BH=ja("trophy",jH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FH=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],zH=ja("wifi-off",FH);/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $H=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],n0=ja("x",$H),Ww="llm_proxy_search_cache",UH=7;function qH(){try{const t=localStorage.getItem(Ww);if(!t)return{};const e=JSON.parse(t),r=Date.now(),n=UH*24*60*60*1e3,a={};for(const[s,i]of Object.entries(e)){const l=i;r-l.timestamp<n&&(a[s]=l)}return Object.keys(a).length!==Object.keys(e).length&&localStorage.setItem(Ww,JSON.stringify(a)),a}catch(t){return console.error("Error reading search cache:",t),{}}}function HH(t,e){try{const r=qH(),n=t.toLowerCase().trim();r[n]={query:t.trim(),results:e,timestamp:Date.now()},localStorage.setItem(Ww,JSON.stringify(r))}catch(r){console.error("Error saving search to cache:",r)}}function GH(t,e){if(t!=="search_web")return null;try{const r=JSON.parse(e);return r.query&&Array.isArray(r.results)?(HH(r.query,r.results),{query:r.query,results:r.results}):null}catch(r){return console.error("Error extracting search result from tool call:",r),null}}var Em={exports:{}};/*!
* tabbable 6.3.0
* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE
*/var vI=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],R0=vI.join(","),wI=typeof Element>"u",Pu=wI?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,D0=!wI&&Element.prototype.getRootNode?function(t){var e;return t==null||(e=t.getRootNode)===null||e===void 0?void 0:e.call(t)}:function(t){return t?.ownerDocument},Ig=function(e,r){var n;r===void 0&&(r=!0);var a=e==null||(n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"inert"),s=a===""||a==="true",i=s||r&&e&&Ig(e.parentNode);return i},VH=function(e){var r,n=e==null||(r=e.getAttribute)===null||r===void 0?void 0:r.call(e,"contenteditable");return n===""||n==="true"},SI=function(e,r,n){if(Ig(e))return[];var a=Array.prototype.slice.apply(e.querySelectorAll(R0));return r&&Pu.call(e,R0)&&a.unshift(e),a=a.filter(n),a},L0=function(e,r,n){for(var a=[],s=Array.from(e);s.length;){var i=s.shift();if(!Ig(i,!1))if(i.tagName==="SLOT"){var l=i.assignedElements(),c=l.length?l:i.children,d=L0(c,!0,n);n.flatten?a.push.apply(a,d):a.push({scopeParent:i,candidates:d})}else{var p=Pu.call(i,R0);p&&n.filter(i)&&(r||!e.includes(i))&&a.push(i);var g=i.shadowRoot||typeof n.getShadowRoot=="function"&&n.getShadowRoot(i),m=!Ig(g,!1)&&(!n.shadowRootFilter||n.shadowRootFilter(i));if(g&&m){var y=L0(g===!0?i.children:g.children,!0,n);n.flatten?a.push.apply(a,y):a.push({scopeParent:i,candidates:y})}else s.unshift.apply(s,i.children)}}return a},kI=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Cc=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||VH(e))&&!kI(e)?0:e.tabIndex},WH=function(e,r){var n=Cc(e);return n<0&&r&&!kI(e)?0:n},YH=function(e,r){return e.tabIndex===r.tabIndex?e.documentOrder-r.documentOrder:e.tabIndex-r.tabIndex},TI=function(e){return e.tagName==="INPUT"},QH=function(e){return TI(e)&&e.type==="hidden"},KH=function(e){var r=e.tagName==="DETAILS"&&Array.prototype.slice.apply(e.children).some(function(n){return n.tagName==="SUMMARY"});return r},XH=function(e,r){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===r)return e[n]},JH=function(e){if(!e.name)return!0;var r=e.form||D0(e),n=function(l){return r.querySelectorAll('input[type="radio"][name="'+l+'"]')},a;if(typeof window<"u"&&typeof window.CSS<"u"&&typeof window.CSS.escape=="function")a=n(window.CSS.escape(e.name));else try{a=n(e.name)}catch(i){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",i.message),!1}var s=XH(a,e.form);return!s||s===e},ZH=function(e){return TI(e)&&e.type==="radio"},eG=function(e){return ZH(e)&&!JH(e)},tG=function(e){var r,n=e&&D0(e),a=(r=n)===null||r===void 0?void 0:r.host,s=!1;if(n&&n!==e){var i,l,c;for(s=!!((i=a)!==null&&i!==void 0&&(l=i.ownerDocument)!==null&&l!==void 0&&l.contains(a)||e!=null&&(c=e.ownerDocument)!==null&&c!==void 0&&c.contains(e));!s&&a;){var d,p,g;n=D0(a),a=(d=n)===null||d===void 0?void 0:d.host,s=!!((p=a)!==null&&p!==void 0&&(g=p.ownerDocument)!==null&&g!==void 0&&g.contains(a))}}return s},x_=function(e){var r=e.getBoundingClientRect(),n=r.width,a=r.height;return n===0&&a===0},rG=function(e,r){var n=r.displayCheck,a=r.getShadowRoot;if(n==="full-native"&&"checkVisibility"in e){var s=e.checkVisibility({checkOpacity:!1,opacityProperty:!1,contentVisibilityAuto:!0,visibilityProperty:!0,checkVisibilityCSS:!0});return!s}if(getComputedStyle(e).visibility==="hidden")return!0;var i=Pu.call(e,"details>summary:first-of-type"),l=i?e.parentElement:e;if(Pu.call(l,"details:not([open]) *"))return!0;if(!n||n==="full"||n==="full-native"||n==="legacy-full"){if(typeof a=="function"){for(var c=e;e;){var d=e.parentElement,p=D0(e);if(d&&!d.shadowRoot&&a(d)===!0)return x_(e);e.assignedSlot?e=e.assignedSlot:!d&&p!==e.ownerDocument?e=p.host:e=d}e=c}if(tG(e))return!e.getClientRects().length;if(n!=="legacy-full")return!0}else if(n==="non-zero-area")return x_(e);return!1},nG=function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var r=e.parentElement;r;){if(r.tagName==="FIELDSET"&&r.disabled){for(var n=0;n<r.children.length;n++){var a=r.children.item(n);if(a.tagName==="LEGEND")return Pu.call(r,"fieldset[disabled] *")?!0:!a.contains(e)}return!0}r=r.parentElement}return!1},M0=function(e,r){return!(r.disabled||Ig(r)||QH(r)||rG(r,e)||KH(r)||nG(r))},Yw=function(e,r){return!(eG(r)||Cc(r)<0||!M0(e,r))},aG=function(e){var r=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(r)||r>=0)},CI=function(e){var r=[],n=[];return e.forEach(function(a,s){var i=!!a.scopeParent,l=i?a.scopeParent:a,c=WH(l,i),d=i?CI(a.candidates):l;c===0?i?r.push.apply(r,d):r.push(l):n.push({documentOrder:s,tabIndex:c,item:a,isScope:i,content:d})}),n.sort(YH).reduce(function(a,s){return s.isScope?a.push.apply(a,s.content):a.push(s.content),a},[]).concat(r)},EI=function(e,r){r=r||{};var n;return r.getShadowRoot?n=L0([e],r.includeContainer,{filter:Yw.bind(null,r),flatten:!1,getShadowRoot:r.getShadowRoot,shadowRootFilter:aG}):n=SI(e,r.includeContainer,Yw.bind(null,r)),CI(n)},_I=function(e,r){r=r||{};var n;return r.getShadowRoot?n=L0([e],r.includeContainer,{filter:M0.bind(null,r),flatten:!0,getShadowRoot:r.getShadowRoot}):n=SI(e,r.includeContainer,M0.bind(null,r)),n},pu=function(e,r){if(r=r||{},!e)throw new Error("No node provided");return Pu.call(e,R0)===!1?!1:Yw(r,e)},sG=vI.concat("iframe").join(","),a0=function(e,r){if(r=r||{},!e)throw new Error("No node provided");return Pu.call(e,sG)===!1?!1:M0(r,e)};const iG=Object.freeze(Object.defineProperty({__proto__:null,focusable:_I,getTabIndex:Cc,isFocusable:a0,isTabbable:pu,tabbable:EI},Symbol.toStringTag,{value:"Module"}));/*!
* focus-trap 7.6.6
* @license MIT, https://github.com/focus-trap/focus-trap/blob/master/LICENSE
*/function Qw(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function oG(t){if(Array.isArray(t))return Qw(t)}function lG(t,e,r){return(e=pG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cG(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function uG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v_(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),r.push.apply(r,n)}return r}function w_(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?v_(Object(r),!0).forEach(function(n){lG(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):v_(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function dG(t){return oG(t)||cG(t)||gG(t)||uG()}function hG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pG(t){var e=hG(t,"string");return typeof e=="symbol"?e:e+""}function gG(t,e){if(t){if(typeof t=="string")return Qw(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qw(t,e):void 0}}var S_={activateTrap:function(e,r){if(e.length>0){var n=e[e.length-1];n!==r&&n._setPausedState(!0)}var a=e.indexOf(r);a===-1||e.splice(a,1),e.push(r)},deactivateTrap:function(e,r){var n=e.indexOf(r);n!==-1&&e.splice(n,1),e.length>0&&!e[e.length-1]._isManuallyPaused()&&e[e.length-1]._setPausedState(!1)}},fG=function(e){return e.tagName&&e.tagName.toLowerCase()==="input"&&typeof e.select=="function"},mG=function(e){return e?.key==="Escape"||e?.key==="Esc"||e?.keyCode===27},dg=function(e){return e?.key==="Tab"||e?.keyCode===9},yG=function(e){return dg(e)&&!e.shiftKey},bG=function(e){return dg(e)&&e.shiftKey},k_=function(e){return setTimeout(e,0)},Np=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return typeof e=="function"?e.apply(void 0,n):e},_m=function(e){return e.target.shadowRoot&&typeof e.composedPath=="function"?e.composedPath()[0]:e.target},xG=[],vG=function(e,r){var n=r?.document||document,a=r?.trapStack||xG,s=w_({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:yG,isKeyBackward:bG},r),i={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,manuallyPaused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},l,c=function(X,Q,W){return X&&X[Q]!==void 0?X[Q]:s[W||Q]},d=function(X,Q){var W=typeof Q?.composedPath=="function"?Q.composedPath():void 0;return i.containerGroups.findIndex(function(H){var re=H.container,ne=H.tabbableNodes;return re.contains(X)||W?.includes(re)||ne.find(function(ve){return ve===X})})},p=function(X){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},W=Q.hasFallback,H=W===void 0?!1:W,re=Q.params,ne=re===void 0?[]:re,ve=s[X];if(typeof ve=="function"&&(ve=ve.apply(void 0,dG(ne))),ve===!0&&(ve=void 0),!ve){if(ve===void 0||ve===!1)return ve;throw new Error("`".concat(X,"` was specified but was not a node, or did not return a node"))}var O=ve;if(typeof ve=="string"){try{O=n.querySelector(ve)}catch(I){throw new Error("`".concat(X,'` appears to be an invalid selector; error="').concat(I.message,'"'))}if(!O&&!H)throw new Error("`".concat(X,"` as selector refers to no known node"))}return O},g=function(){var X=p("initialFocus",{hasFallback:!0});if(X===!1)return!1;if(X===void 0||X&&!a0(X,s.tabbableOptions))if(d(n.activeElement)>=0)X=n.activeElement;else{var Q=i.tabbableGroups[0],W=Q&&Q.firstTabbableNode;X=W||p("fallbackFocus")}else X===null&&(X=p("fallbackFocus"));if(!X)throw new Error("Your focus-trap needs to have at least one focusable element");return X},m=function(){if(i.containerGroups=i.containers.map(function(X){var Q=EI(X,s.tabbableOptions),W=_I(X,s.tabbableOptions),H=Q.length>0?Q[0]:void 0,re=Q.length>0?Q[Q.length-1]:void 0,ne=W.find(function(I){return pu(I)}),ve=W.slice().reverse().find(function(I){return pu(I)}),O=!!Q.find(function(I){return Cc(I)>0});return{container:X,tabbableNodes:Q,focusableNodes:W,posTabIndexesFound:O,firstTabbableNode:H,lastTabbableNode:re,firstDomTabbableNode:ne,lastDomTabbableNode:ve,nextTabbableNode:function(K){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ce=Q.indexOf(K);return ce<0?U?W.slice(W.indexOf(K)+1).find(function(ye){return pu(ye)}):W.slice(0,W.indexOf(K)).reverse().find(function(ye){return pu(ye)}):Q[ce+(U?1:-1)]}}}),i.tabbableGroups=i.containerGroups.filter(function(X){return X.tabbableNodes.length>0}),i.tabbableGroups.length<=0&&!p("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(i.containerGroups.find(function(X){return X.posTabIndexesFound})&&i.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},y=function(X){var Q=X.activeElement;if(Q)return Q.shadowRoot&&Q.shadowRoot.activeElement!==null?y(Q.shadowRoot):Q},x=function(X){if(X!==!1&&X!==y(document)){if(!X||!X.focus){x(g());return}X.focus({preventScroll:!!s.preventScroll}),i.mostRecentlyFocusedNode=X,fG(X)&&X.select()}},w=function(X){var Q=p("setReturnFocus",{params:[X]});return Q||(Q===!1?!1:X)},T=function(X){var Q=X.target,W=X.event,H=X.isBackward,re=H===void 0?!1:H;Q=Q||_m(W),m();var ne=null;if(i.tabbableGroups.length>0){var ve=d(Q,W),O=ve>=0?i.containerGroups[ve]:void 0;if(ve<0)re?ne=i.tabbableGroups[i.tabbableGroups.length-1].lastTabbableNode:ne=i.tabbableGroups[0].firstTabbableNode;else if(re){var I=i.tabbableGroups.findIndex(function(fe){var Ne=fe.firstTabbableNode;return Q===Ne});if(I<0&&(O.container===Q||a0(Q,s.tabbableOptions)&&!pu(Q,s.tabbableOptions)&&!O.nextTabbableNode(Q,!1))&&(I=ve),I>=0){var K=I===0?i.tabbableGroups.length-1:I-1,U=i.tabbableGroups[K];ne=Cc(Q)>=0?U.lastTabbableNode:U.lastDomTabbableNode}else dg(W)||(ne=O.nextTabbableNode(Q,!1))}else{var ce=i.tabbableGroups.findIndex(function(fe){var Ne=fe.lastTabbableNode;return Q===Ne});if(ce<0&&(O.container===Q||a0(Q,s.tabbableOptions)&&!pu(Q,s.tabbableOptions)&&!O.nextTabbableNode(Q))&&(ce=ve),ce>=0){var ye=ce===i.tabbableGroups.length-1?0:ce+1,Ae=i.tabbableGroups[ye];ne=Cc(Q)>=0?Ae.firstTabbableNode:Ae.firstDomTabbableNode}else dg(W)||(ne=O.nextTabbableNode(Q))}}else ne=p("fallbackFocus");return ne},k=function(X){var Q=_m(X);if(!(d(Q,X)>=0)){if(Np(s.clickOutsideDeactivates,X)){l.deactivate({returnFocus:s.returnFocusOnDeactivate});return}Np(s.allowOutsideClick,X)||X.preventDefault()}},_=function(X){var Q=_m(X),W=d(Q,X)>=0;if(W||Q instanceof Document)W&&(i.mostRecentlyFocusedNode=Q);else{X.stopImmediatePropagation();var H,re=!0;if(i.mostRecentlyFocusedNode)if(Cc(i.mostRecentlyFocusedNode)>0){var ne=d(i.mostRecentlyFocusedNode),ve=i.containerGroups[ne].tabbableNodes;if(ve.length>0){var O=ve.findIndex(function(I){return I===i.mostRecentlyFocusedNode});O>=0&&(s.isKeyForward(i.recentNavEvent)?O+1<ve.length&&(H=ve[O+1],re=!1):O-1>=0&&(H=ve[O-1],re=!1))}}else i.containerGroups.some(function(I){return I.tabbableNodes.some(function(K){return Cc(K)>0})})||(re=!1);else re=!1;re&&(H=T({target:i.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(i.recentNavEvent)})),x(H||i.mostRecentlyFocusedNode||g())}i.recentNavEvent=void 0},P=function(X){var Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;i.recentNavEvent=X;var W=T({event:X,isBackward:Q});W&&(dg(X)&&X.preventDefault(),x(W))},F=function(X){(s.isKeyForward(X)||s.isKeyBackward(X))&&P(X,s.isKeyBackward(X))},D=function(X){mG(X)&&Np(s.escapeDeactivates,X)!==!1&&(X.preventDefault(),l.deactivate())},B=function(X){var Q=_m(X);d(Q,X)>=0||Np(s.clickOutsideDeactivates,X)||Np(s.allowOutsideClick,X)||(X.preventDefault(),X.stopImmediatePropagation())},M=function(){if(i.active)return S_.activateTrap(a,l),i.delayInitialFocusTimer=s.delayInitialFocus?k_(function(){x(g())}):x(g()),n.addEventListener("focusin",_,!0),n.addEventListener("mousedown",k,{capture:!0,passive:!1}),n.addEventListener("touchstart",k,{capture:!0,passive:!1}),n.addEventListener("click",B,{capture:!0,passive:!1}),n.addEventListener("keydown",F,{capture:!0,passive:!1}),n.addEventListener("keydown",D),l},$=function(){if(i.active)return n.removeEventListener("focusin",_,!0),n.removeEventListener("mousedown",k,!0),n.removeEventListener("touchstart",k,!0),n.removeEventListener("click",B,!0),n.removeEventListener("keydown",F,!0),n.removeEventListener("keydown",D),l},Z=function(X){var Q=X.some(function(W){var H=Array.from(W.removedNodes);return H.some(function(re){return re===i.mostRecentlyFocusedNode})});Q&&x(g())},z=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(Z):void 0,ee=function(){z&&(z.disconnect(),i.active&&!i.paused&&i.containers.map(function(X){z.observe(X,{subtree:!0,childList:!0})}))};return l={get active(){return i.active},get paused(){return i.paused},activate:function(X){if(i.active)return this;var Q=c(X,"onActivate"),W=c(X,"onPostActivate"),H=c(X,"checkCanFocusTrap");H||m(),i.active=!0,i.paused=!1,i.nodeFocusedBeforeActivation=y(n),Q?.();var re=function(){H&&m(),M(),ee(),W?.()};return H?(H(i.containers.concat()).then(re,re),this):(re(),this)},deactivate:function(X){if(!i.active)return this;var Q=w_({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},X);clearTimeout(i.delayInitialFocusTimer),i.delayInitialFocusTimer=void 0,$(),i.active=!1,i.paused=!1,ee(),S_.deactivateTrap(a,l);var W=c(Q,"onDeactivate"),H=c(Q,"onPostDeactivate"),re=c(Q,"checkCanReturnFocus"),ne=c(Q,"returnFocus","returnFocusOnDeactivate");W?.();var ve=function(){k_(function(){ne&&x(w(i.nodeFocusedBeforeActivation)),H?.()})};return ne&&re?(re(w(i.nodeFocusedBeforeActivation)).then(ve,ve),this):(ve(),this)},pause:function(X){return i.active?(i.manuallyPaused=!0,this._setPausedState(!0,X)):this},unpause:function(X){return i.active?(i.manuallyPaused=!1,a[a.length-1]!==this?this:this._setPausedState(!1,X)):this},updateContainerElements:function(X){var Q=[].concat(X).filter(Boolean);return i.containers=Q.map(function(W){return typeof W=="string"?n.querySelector(W):W}),i.active&&m(),ee(),this}},Object.defineProperties(l,{_isManuallyPaused:{value:function(){return i.manuallyPaused}},_setPausedState:{value:function(X,Q){if(i.paused===X)return this;if(i.paused=X,X){var W=c(Q,"onPause"),H=c(Q,"onPostPause");W?.(),$(),ee(),H?.()}else{var re=c(Q,"onUnpause"),ne=c(Q,"onPostUnpause");re?.(),m(),M(),ee(),ne?.()}return this}}}),l.updateContainerElements(e),l};const wG=Object.freeze(Object.defineProperty({__proto__:null,createFocusTrap:vG},Symbol.toStringTag,{value:"Module"})),SG=eP(wG),kG=eP(iG);var T_;function TG(){if(T_)return Em.exports;T_=1;function t(M){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},t(M)}var e,r;function n(M,$){if(!(M instanceof $))throw new TypeError("Cannot call a class as a function")}function a(M,$){for(var Z=0;Z<$.length;Z++){var z=$[Z];z.enumerable=z.enumerable||!1,z.configurable=!0,"value"in z&&(z.writable=!0),Object.defineProperty(M,x(z.key),z)}}function s(M,$,Z){return $&&a(M.prototype,$),Object.defineProperty(M,"prototype",{writable:!1}),M}function i(M,$,Z){return $=p($),l(M,d()?Reflect.construct($,Z||[],p(M).constructor):$.apply(M,Z))}function l(M,$){if($&&(t($)=="object"||typeof $=="function"))return $;if($!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return c(M)}function c(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}function d(){try{var M=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(d=function(){return!!M})()}function p(M){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function($){return $.__proto__||Object.getPrototypeOf($)},p(M)}function g(M,$){if(typeof $!="function"&&$!==null)throw new TypeError("Super expression must either be null or a function");M.prototype=Object.create($&&$.prototype,{constructor:{value:M,writable:!0,configurable:!0}}),Object.defineProperty(M,"prototype",{writable:!1}),$&&m(M,$)}function m(M,$){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,z){return Z.__proto__=z,Z},m(M,$)}function y(M,$,Z){return($=x($))in M?Object.defineProperty(M,$,{value:Z,enumerable:!0,configurable:!0,writable:!0}):M[$]=Z,M}function x(M){var $=w(M,"string");return t($)=="symbol"?$:$+""}function w(M,$){if(t(M)!="object"||!M)return M;var Z=M[Symbol.toPrimitive];if(Z!==void 0){var z=Z.call(M,$);if(t(z)!="object")return z;throw new TypeError("@@toPrimitive must return a primitive value.")}return($==="string"?String:Number)(M)}var T=Kg(),k=SG,_=k.createFocusTrap,P=kG,F=P.isFocusable,D=parseInt((e=(r=/^(\d+)\./.exec(T.version))===null||r===void 0?void 0:r[1])!==null&&e!==void 0?e:0,10),B=(function(M){function $(Z){var z;n(this,$),z=i(this,$,[Z]),y(z,"getNodeForOption",function(X){var Q,W=(Q=this.internalOptions[X])!==null&&Q!==void 0?Q:this.originalOptions[X];if(typeof W=="function"){for(var H=arguments.length,re=new Array(H>1?H-1:0),ne=1;ne<H;ne++)re[ne-1]=arguments[ne];W=W.apply(void 0,re)}if(W===!0&&(W=void 0),!W){if(W===void 0||W===!1)return W;throw new Error("`".concat(X,"` was specified but was not a node, or did not return a node"))}var ve=W;if(typeof W=="string"){var O;if(ve=(O=this.getDocument())===null||O===void 0?void 0:O.querySelector(W),!ve)throw new Error("`".concat(X,"` as selector refers to no known node"))}return ve}),z.handleDeactivate=z.handleDeactivate.bind(z),z.handlePostDeactivate=z.handlePostDeactivate.bind(z),z.handleClickOutsideDeactivates=z.handleClickOutsideDeactivates.bind(z),z.internalOptions={returnFocusOnDeactivate:!1,checkCanReturnFocus:null,onDeactivate:z.handleDeactivate,onPostDeactivate:z.handlePostDeactivate,clickOutsideDeactivates:z.handleClickOutsideDeactivates},z.originalOptions={returnFocusOnDeactivate:!0,onDeactivate:null,onPostDeactivate:null,checkCanReturnFocus:null,clickOutsideDeactivates:!1};var ee=Z.focusTrapOptions;for(var te in ee)if(Object.prototype.hasOwnProperty.call(ee,te)){if(te==="returnFocusOnDeactivate"||te==="onDeactivate"||te==="onPostDeactivate"||te==="checkCanReturnFocus"||te==="clickOutsideDeactivates"){z.originalOptions[te]=ee[te];continue}z.internalOptions[te]=ee[te]}return z.outsideClick=null,z.focusTrapElements=Z.containerElements||[],z.updatePreviousElement(),z}return g($,M),s($,[{key:"getDocument",value:function(){return this.props.focusTrapOptions.document||(typeof document<"u"?document:void 0)}},{key:"getReturnFocusNode",value:function(){var z=this.getNodeForOption("setReturnFocus",this.previouslyFocusedElement);return z||(z===!1?!1:this.previouslyFocusedElement)}},{key:"updatePreviousElement",value:function(){var z=this.getDocument();z&&(this.previouslyFocusedElement=z.activeElement)}},{key:"deactivateTrap",value:function(){!this.focusTrap||!this.focusTrap.active||this.focusTrap.deactivate({returnFocus:!1,checkCanReturnFocus:null,onDeactivate:this.originalOptions.onDeactivate})}},{key:"handleClickOutsideDeactivates",value:function(z){var ee=typeof this.originalOptions.clickOutsideDeactivates=="function"?this.originalOptions.clickOutsideDeactivates.call(null,z):this.originalOptions.clickOutsideDeactivates;return ee&&(this.outsideClick={target:z.target,allowDeactivation:ee}),ee}},{key:"handleDeactivate",value:function(){this.originalOptions.onDeactivate&&this.originalOptions.onDeactivate.call(null),this.deactivateTrap()}},{key:"handlePostDeactivate",value:function(){var z=this,ee=function(){var X=z.getReturnFocusNode(),Q=!!(z.originalOptions.returnFocusOnDeactivate&&X!==null&&X!==void 0&&X.focus&&(!z.outsideClick||z.outsideClick.allowDeactivation&&!F(z.outsideClick.target,z.internalOptions.tabbableOptions))),W=z.internalOptions.preventScroll,H=W===void 0?!1:W;Q&&X.focus({preventScroll:H}),z.originalOptions.onPostDeactivate&&z.originalOptions.onPostDeactivate.call(null),z.outsideClick=null};this.originalOptions.checkCanReturnFocus?this.originalOptions.checkCanReturnFocus.call(null,this.getReturnFocusNode()).then(ee,ee):ee()}},{key:"setupFocusTrap",value:function(){if(this.focusTrap)this.props.active&&!this.focusTrap.active&&(this.focusTrap.activate(),this.props.paused&&this.focusTrap.pause());else{var z=this.focusTrapElements.some(Boolean);z&&(this.focusTrap=this.props._createFocusTrap(this.focusTrapElements,this.internalOptions),this.props.active&&this.focusTrap.activate(),this.props.paused&&this.focusTrap.pause())}}},{key:"componentDidMount",value:function(){this.props.active&&this.setupFocusTrap()}},{key:"componentDidUpdate",value:function(z){if(this.focusTrap){z.containerElements!==this.props.containerElements&&this.focusTrap.updateContainerElements(this.props.containerElements);var ee=!z.active&&this.props.active,te=z.active&&!this.props.active,X=!z.paused&&this.props.paused,Q=z.paused&&!this.props.paused;if(ee&&(this.updatePreviousElement(),this.focusTrap.activate()),te){this.deactivateTrap();return}X&&this.focusTrap.pause(),Q&&this.focusTrap.unpause()}else z.containerElements!==this.props.containerElements&&(this.focusTrapElements=this.props.containerElements),this.props.active&&(this.updatePreviousElement(),this.setupFocusTrap())}},{key:"componentWillUnmount",value:function(){this.deactivateTrap()}},{key:"render",value:function(){var z=this,ee=this.props.children?T.Children.only(this.props.children):void 0;if(ee){if(ee.type&&ee.type===T.Fragment)throw new Error("A focus-trap cannot use a Fragment as its child container. Try replacing it with a <div> element.");var te=function(W){var H=z.props.containerElements;ee&&(D>=19?typeof ee.props.ref=="function"?ee.props.ref(W):ee.props.ref&&(ee.props.ref.current=W):typeof ee.ref=="function"?ee.ref(W):ee.ref&&(ee.ref.current=W)),z.focusTrapElements=H||[W]},X=T.cloneElement(ee,{ref:te});return X}return null}}])})(T.Component);return B.defaultProps={active:!0,paused:!1,focusTrapOptions:{},_createFocusTrap:_},Em.exports=B,Em.exports.FocusTrap=B,Em.exports}var Kw=TG();function jy(t,e,r=!0){const n=N.useRef(null),a=N.useCallback(i=>{i.key==="Escape"&&e()},[e]),s=N.useCallback(i=>{r&&n.current&&i.target===n.current&&e()},[e,r]);return N.useEffect(()=>{if(t)return document.addEventListener("keydown",a),document.addEventListener("mousedown",s),()=>{document.removeEventListener("keydown",a),document.removeEventListener("mousedown",s)}},[t,a,s]),n}function AI(t,e=!0){if(t===null)return"N/A";const r=e?"$":"";return t<1e-4?`${r}${t.toFixed(6)}`:t<.01?`${r}${t.toFixed(4)}`:`${r}${t.toFixed(4)}`}const uh=({data:t,name:e,level:r=0,defaultExpanded:n=!0})=>{const[a,s]=N.useState(n),i=r*16;if(t==null)return u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsx("span",{className:"text-gray-500 dark:text-gray-500 italic",children:"null"})]});const l=typeof t;if(l==="string"||l==="number"||l==="boolean")return u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsx("span",{className:l==="string"?"text-green-600 dark:text-green-400":l==="number"?"text-blue-600 dark:text-blue-400":"text-purple-600 dark:text-purple-400",children:l==="string"?`"${t}"`:String(t)})]});if(Array.isArray(t))return t.length===0?u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsx("span",{className:"text-gray-500 dark:text-gray-500",children:"[]"})]}):u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[u.jsxs("button",{onClick:()=>s(!a),className:"text-left hover:bg-gray-100 dark:hover:bg-gray-800 px-1 rounded transition-colors",children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-500 mr-1",children:a?"":""}),e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:["[",t.length," ",t.length===1?"item":"items","]"]})]}),a&&u.jsx("div",{className:"ml-2",children:t.map((c,d)=>u.jsx(uh,{data:c,name:String(d),level:r+1,defaultExpanded:r<1},d))})]});if(l==="object"){const c=Object.keys(t);return c.length===0?u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsx("span",{className:"text-gray-500 dark:text-gray-500",children:"{}"})]}):u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[u.jsxs("button",{onClick:()=>s(!a),className:"text-left hover:bg-gray-100 dark:hover:bg-gray-800 px-1 rounded transition-colors",children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-500 mr-1",children:a?"":""}),e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsxs("span",{className:"text-gray-500 dark:text-gray-500",children:["{",c.length," ",c.length===1?"key":"keys","}"]})]}),a&&u.jsx("div",{className:"ml-2",children:c.map(d=>u.jsx(uh,{data:t[d],name:d,level:r+1,defaultExpanded:r<1},d))})]})}return u.jsxs("div",{style:{marginLeft:`${i}px`},className:"font-mono text-sm",children:[e&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[e,": "]}),u.jsx("span",{className:"text-gray-500 dark:text-gray-500",children:String(t)})]})},_v=({content:t})=>{try{const e=JSON.parse(t);return u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded border border-gray-200 dark:border-gray-700 overflow-x-auto",children:u.jsx(uh,{data:e,defaultExpanded:!0})})}catch{return u.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded border border-gray-200 dark:border-gray-700 overflow-x-auto text-sm",children:t})}},Am=({data:t,title:e})=>{const[r,n]=N.useState(!1),[a,s]=N.useState(!1),i=p=>{if(typeof p=="string")try{const g=JSON.parse(p);return i(g)}catch{return p}else{if(Array.isArray(p))return p.map(g=>i(g));if(p!==null&&typeof p=="object"){const g={};for(const m in p)g[m]=i(p[m]);return g}}return p},l=i(t),c=()=>{navigator.clipboard.writeText(JSON.stringify(l,null,2)),n(!0),setTimeout(()=>n(!1),2e3)},d=()=>{s(!0)};return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"mt-3",children:u.jsxs("button",{onClick:d,className:"flex items-center justify-between w-full px-4 py-2 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",children:[u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:e}),u.jsx("span",{className:"text-purple-600 dark:text-purple-400 text-sm font-medium",children:" Click to View"})]})}),a&&u.jsx("div",{className:"fixed inset-0 bg-black/90 z-[100] flex items-center justify-center p-4",onClick:()=>s(!1),children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-xl w-full h-full max-w-7xl max-h-[90vh] flex flex-col shadow-2xl",onClick:p=>p.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:e}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded transition-colors",children:r?" Copied!":" Copy All"}),u.jsx("button",{onClick:()=>s(!1),className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white text-sm rounded transition-colors",children:" Close"})]})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-50 dark:bg-gray-950",children:u.jsx(uh,{data:l,defaultExpanded:!0})})]})})]})};function CG(t){switch(t.type){case"guardrail_input":return{label:"Guardrail Input",color:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-300 dark:border-yellow-700",text:"text-yellow-700 dark:text-yellow-300",icon:""};case"guardrail_output":return{label:"Guardrail Output",color:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-300 dark:border-yellow-700",text:"text-yellow-700 dark:text-yellow-300",icon:""};case"image_generation":return{label:"Image Generation",color:"bg-pink-50 dark:bg-pink-900/20",border:"border-pink-300 dark:border-pink-700",text:"text-pink-700 dark:text-pink-300",icon:""};case"transcription":return{label:"Whisper Transcription",color:"bg-purple-50 dark:bg-purple-900/20",border:"border-purple-300 dark:border-purple-700",text:"text-purple-700 dark:text-purple-300",icon:""};case"embedding":return{label:"Embedding",color:"bg-indigo-50 dark:bg-indigo-900/20",border:"border-indigo-300 dark:border-indigo-700",text:"text-indigo-700 dark:text-indigo-300",icon:""};case"planning":return{label:"Planning",color:"bg-blue-50 dark:bg-blue-900/20",border:"border-blue-300 dark:border-blue-700",text:"text-blue-700 dark:text-blue-300",icon:""};case"assessment":return{label:"Self-Assessment",color:"bg-teal-50 dark:bg-teal-900/20",border:"border-teal-300 dark:border-teal-700",text:"text-teal-700 dark:text-teal-300",icon:""};default:return{label:"Chat",color:"bg-gray-50 dark:bg-gray-900/20",border:"border-gray-300 dark:border-gray-700",text:"text-gray-700 dark:text-gray-300",icon:""}}}const EG=({call:t,index:e})=>{const r=CG(t),n=t.response?.usage?.prompt_tokens||0,a=t.response?.usage?.completion_tokens||0,s=t.response?.usage?.total_tokens||n+a,i=t.cost??0;return u.jsxs("div",{className:`border-2 ${r.border} ${r.color} rounded-xl p-5 shadow-sm hover:shadow-md transition-shadow`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl",children:r.icon}),u.jsxs("div",{children:[u.jsx("h3",{className:`font-bold text-lg ${r.text}`,children:r.label}),u.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.provider,"  ",t.model]})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:`text-2xl font-bold ${i>0?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:AI(i)}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["#",e+1]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Prompt Tokens"}),u.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:n.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Completion Tokens"}),u.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:a.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total Tokens"}),u.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Duration"}),u.jsx("div",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:t.durationMs?`${(t.durationMs/1e3).toFixed(2)}s`:"N/A"})]})]}),u.jsxs("div",{className:"flex items-center justify-between mb-4 text-sm",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[t.success!==void 0&&u.jsx("span",{className:`px-2 py-1 rounded-full ${t.success?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300":"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}`,children:t.success?" Success":" Failed"}),t.httpStatus&&u.jsxs("span",{className:"px-2 py-1 rounded-full bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300",children:["HTTP ",t.httpStatus]})]}),u.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:new Date(t.timestamp).toLocaleString()})]}),u.jsxs("div",{className:"space-y-2",children:[t.request&&u.jsx(Am,{data:t.request,title:" Request Body"}),t.response&&u.jsx(Am,{data:t.response,title:" Response Body"}),t.httpHeaders&&u.jsx(Am,{data:t.httpHeaders,title:" HTTP Headers"}),t.metadata&&u.jsx(Am,{data:t.metadata,title:" Metadata"})]})]})};function AS({apiCalls:t,onClose:e}){const r=jy(!0,e),[n,a]=N.useState(!1),{showSuccess:s}=jl(),i=t.reduce((m,y)=>m+(y.response?.usage?.prompt_tokens||0),0),l=t.reduce((m,y)=>m+(y.response?.usage?.completion_tokens||0),0),c=i+l,d=t.reduce((m,y)=>m+(y.cost||0),0),p=t.reduce((m,y)=>m+(y.durationMs||0),0),g=()=>{const m=t.map((y,x)=>({callNumber:x+1,type:y.type||"chat",provider:y.provider,model:y.model,timestamp:y.timestamp,request:y.request,response:y.response,httpHeaders:y.httpHeaders,httpStatus:y.httpStatus,cost:y.cost,durationMs:y.durationMs,metadata:y.metadata}));navigator.clipboard.writeText(JSON.stringify(m,null,2)),a(!0),setTimeout(()=>a(!1),2e3),s(` Copied ${t.length} LLM API call${t.length!==1?"s":""} to clipboard`)};return u.jsx("div",{ref:r,className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:" LLM API Transparency"}),u.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:[t.length," API call",t.length!==1?"s":""]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors flex items-center gap-2 shadow-sm hover:shadow-md",children:n?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Copied All!"})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Copy All JSON"})]})}),u.jsx("button",{onClick:e,className:"w-12 h-12 flex items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200","aria-label":"Close",children:u.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:t.length===0?u.jsx("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"No API calls found."}):t.map((m,y)=>u.jsx(EG,{call:m,index:y},y))}),u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6 bg-gray-50 dark:bg-gray-800/50",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 mb-4",children:" Grand Totals"}),u.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Prompt Tokens"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:i.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Completion Tokens"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:l.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Tokens"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:c.toLocaleString()})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-700",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Duration"}),u.jsxs("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[(p/1e3).toFixed(2),"s"]})]}),u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border-2 border-green-200 dark:border-green-700 bg-gradient-to-br from-green-50 to-white dark:from-green-900/20 dark:to-gray-800",children:[u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Total Cost"}),u.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-400",children:AI(d)})]})]})]})]})})}const _G={groq:/^gsk_[a-zA-Z0-9]{32,}$/,openai:/^sk-[a-zA-Z0-9_-]{20,}$/,gemini:/^AIza[a-zA-Z0-9_-]{35}$/,together:/^[a-zA-Z0-9_-]{32,}$/,atlascloud:/^apikey-[a-f0-9]{32}$/,"openai-compatible":/.+/,replicate:/^r8_[a-zA-Z0-9]{40}$/,speaches:/.+/,anthropic:/^sk-ant-[a-zA-Z0-9_-]{20,}$/,google:/^AIza[a-zA-Z0-9_-]{35}$/,cohere:/^[a-zA-Z0-9_-]{40,}$/,deepseek:/^sk-[a-zA-Z0-9_-]{20,}$/};function AG(t,e){return!t||t.trim()===""?{valid:!1,error:"API key is required"}:_G[e].test(t)?{valid:!0}:{valid:!1,error:{groq:'Groq API key must start with "gsk_" followed by at least 32 characters',openai:'OpenAI API key must start with "sk-" followed by at least 20 characters',gemini:'Gemini API key must start with "AIza" followed by 35 characters',together:"Together AI API key must be at least 32 characters",atlascloud:'Atlas Cloud API key must start with "apikey-" followed by 32 hex characters',"openai-compatible":"API key cannot be empty",replicate:'Replicate API key must start with "r8_" followed by 40 characters',speaches:"API key cannot be empty",anthropic:'Anthropic API key must start with "sk-ant-" followed by at least 20 characters',google:'Google API key must start with "AIza" followed by 35 characters',cohere:"Cohere API key must be at least 40 characters",deepseek:'DeepSeek API key must start with "sk-" followed by at least 20 characters'}[e]}}function NG(t){if(!t||t.trim()==="")return{valid:!1,error:"Endpoint URL is required"};try{return new URL(t).protocol!=="https:"?{valid:!1,error:"Endpoint must use HTTPS protocol"}:{valid:!0}}catch{return{valid:!1,error:"Invalid URL format"}}}function PG(t){return!t||t.trim()===""?{valid:!1,error:"Model name is required for OpenAI-compatible providers"}:{valid:!0}}function IG(t){return t!==void 0&&(isNaN(t)||t<0)?{valid:!1,error:"Rate limit must be a positive number or empty"}:{valid:!0}}function C_(t){const e={};if(t.type||(e.type="Provider type is required"),t.type){const r=AG(t.apiKey||"",t.type);r.valid||(e.apiKey=r.error)}if(t.type==="openai-compatible"){const r=NG(t.apiEndpoint||"");r.valid||(e.apiEndpoint=r.error);const n=PG(t.modelName);n.valid||(e.modelName=n.error);const a=IG(t.rateLimitTPM);a.valid||(e.rateLimitTPM=a.error)}return{valid:Object.keys(e).length===0,errors:e}}function Fxe(t){if(!t||t.length<12)return"";const e=t.slice(0,4),r=t.slice(-4),n=Math.max(8,t.length-8);return`${e}${"".repeat(n)}${r}`}function E_(t,e){return t.type===e.type&&t.apiKey===e.apiKey}function RG(){const{settings:t,updateSettings:e}=vo(),r=N.useCallback(i=>{if(!t)return{success:!1,error:"Settings not loaded"};const l=C_(i);if(!l.valid)return{success:!1,error:Object.values(l.errors)[0]};const c={...i,id:crypto.randomUUID(),enabled:!0};return t.providers.find(p=>E_(p,c))?{success:!1,error:"A provider with this type and API key already exists"}:(e({providers:[...t.providers,c]}),{success:!0})},[t,e]),n=N.useCallback((i,l)=>{if(!t)return{success:!1,error:"Settings not loaded"};const c=t.providers.find(g=>g.id===i);if(!c)return{success:!1,error:"Provider not found"};const d={...c,...l};if(!("enabled"in l&&Object.keys(l).length===1)){const g=C_(d);if(!g.valid)return{success:!1,error:Object.values(g.errors)[0]};if(t.providers.find(y=>y.id!==i&&E_(y,d)))return{success:!1,error:"A provider with this type and API key already exists"}}const p=t.providers.map(g=>g.id===i?d:g);return e({providers:p}),{success:!0}},[t,e]),a=N.useCallback(i=>{t&&e({providers:t.providers.filter(l=>l.id!==i)})},[t,e]),s=N.useCallback(i=>t?.providers.find(l=>l.id===i),[t]);return{providers:t?.providers||[],addProvider:r,updateProvider:n,deleteProvider:a,getProvider:s}}const NI=({isOpen:t,onClose:e,onTranscriptionComplete:r,accessToken:n,apiEndpoint:a})=>{const s=jy(t,e,!1),{providers:i}=RG(),{settings:l}=vo(),[c,d]=N.useState(!1),[p,g]=N.useState(0),[m,y]=N.useState(""),[x,w]=N.useState(null),[T,k]=N.useState(!1),_=N.useRef(null),P=N.useRef(null),F=N.useRef(null),D=N.useRef([]),B=N.useRef(null),M=N.useRef(null),$=N.useRef(null),Z=N.useCallback(()=>{B.current&&cancelAnimationFrame(B.current),M.current&&clearTimeout(M.current),_.current&&_.current.state!=="inactive"&&_.current.stop(),$.current&&$.current.getTracks().forEach(W=>W.stop()),P.current&&P.current.state!=="closed"&&P.current.close().catch(W=>{console.warn("Failed to close AudioContext:",W)}),d(!1),g(0)},[]),z=async()=>{try{if(w(null),D.current=[],!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Your browser does not support audio recording");if((await navigator.mediaDevices.enumerateDevices()).filter(K=>K.kind==="audioinput").length===0)throw new Error("No microphone found. Please connect a microphone and try again.");const re=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});$.current=re;const ne=new(window.AudioContext||window.webkitAudioContext);P.current=ne;const ve=ne.createMediaStreamSource(re),O=ne.createAnalyser();O.fftSize=256,F.current=O,ve.connect(O);const I=new MediaRecorder(re);_.current=I,I.ondataavailable=K=>{K.data.size>0&&D.current.push(K.data)},I.onstop=async()=>{const K=new Blob(D.current,{type:"audio/webm"});await Q(K)},I.start(),d(!0),ee(),te()}catch(W){console.error("Error starting recording:",W);let H="Failed to access microphone. ";W.name==="NotFoundError"||W.message.includes("No microphone")?H="No microphone found. Please connect a microphone and try again.":W.name==="NotAllowedError"||W.name==="PermissionDeniedError"?H="Microphone permission denied. Please allow microphone access in your browser settings.":W.name==="NotSupportedError"?H="Your browser does not support audio recording. Please use Chrome, Firefox, or Edge.":W.message?H=W.message:H+="Please check permissions and try again.",w(H)}},ee=()=>{if(!F.current||!c)return;const W=new Uint8Array(F.current.frequencyBinCount);F.current.getByteFrequencyData(W);const H=W.reduce((ne,ve)=>ne+ve)/W.length,re=Math.min(H/128,1);g(re),B.current=requestAnimationFrame(ee)},te=()=>{if(!F.current)return;const W=new Uint8Array(F.current.frequencyBinCount);F.current.getByteFrequencyData(W);const H=W.reduce((ve,O)=>ve+O)/W.length,re=10,ne=2e3;H<re?M.current||(M.current=setTimeout(()=>{console.log("Silence detected, stopping recording..."),X()},ne)):M.current&&(clearTimeout(M.current),M.current=null),c&&setTimeout(te,100)},X=()=>{Z()},Q=async W=>{if(!n){w("Not authenticated. Please sign in.");return}k(!0);const H=`web-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;console.log(" Generated request ID for voice transcription:",H);const re=i.find(fe=>fe.type==="speaches"&&fe.enabled!==!1),ne=i.find(fe=>fe.type==="groq"&&fe.enabled!==!1),ve=i.find(fe=>fe.type==="openai"&&fe.enabled!==!1),O=re?.apiKey||ne?.apiKey||ve?.apiKey||null,I=re?"speaches":ne?"groq":ve?"openai":null;re?console.log(" Transcription provider:  Speaches (LOCAL, FREE)"):console.log(" Transcription provider:",I,"hasKey:",!!O);const K=!!l?.voice?.useLocalWhisper,U=l?.voice?.localWhisperUrl||"http://localhost:8000";console.log(` VoiceInputDialog: useLocalWhisper=${K}, url=${U}`);const ce=new FormData;ce.append("audio",W,"recording.webm"),O&&I&&(ce.append("apiKey",O),ce.append("provider",I)),K&&(ce.append("useLocalWhisper","true"),ce.append("localWhisperUrl",U),console.log(` VoiceInputDialog: Using local Whisper at ${U}`));const ye=3;let Ae=null;try{const Ne=`${(await dn()).replace("/openai/v1","")}/transcribe`;console.log("Transcribing audio (resolved):",{url:Ne,blobSize:W.size,blobType:W.type,hasToken:!!n,requestId:H,provider:I,hasApiKey:!!O});for(let Te=1;Te<=ye;Te++)try{const se=new AbortController,be=setTimeout(()=>se.abort(),2e4),xe=await fetch(Ne,{method:"POST",headers:{Authorization:`Bearer ${n}`,"X-Request-Id":H},body:ce,signal:se.signal});clearTimeout(be);const me=await xe.json().catch(()=>({}));if(!xe.ok){const Ie=me?.error||xe.statusText||`HTTP ${xe.status}`;throw console.error(`Transcription failed (attempt ${Te}):`,Ie,me),new Error(Ie)}const de=me.text||me.transcription||"",he=me.llmApiCall||null;y(de),setTimeout(()=>{r(de,H,he),e()},500);return}catch(se){Ae=se;const be=se instanceof TypeError&&se.message.includes("Failed to fetch"),xe=se.name==="AbortError";if(console.warn(`Transcription attempt ${Te} failed:`,se?.message||se),Te<ye&&(be||xe)){const me=500*Math.pow(2,Te-1);console.log(`Retrying transcription in ${me}ms...`),await new Promise(de=>setTimeout(de,me));continue}throw se}throw Ae||new Error("Transcription failed")}catch(fe){console.error("Transcription error (final):",fe);let Ne="Transcription failed";fe instanceof TypeError&&fe.message.includes("Failed to fetch")?Ne="Network error: Could not reach transcription service. Check your internet connection and that the backend is running (run `make dev`).":fe.name==="AbortError"?Ne="Transcription request timed out. Please try again.":fe instanceof Error&&(Ne=fe.message),w(Ne);return}finally{k(!1)}};return N.useEffect(()=>(t||Z(),Z),[t,Z]),N.useEffect(()=>{t&&(y(""),w(null),!c&&!T&&z())},[t]),t?u.jsx("div",{ref:s,className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-md p-8",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:T?" Processing...":c?" Listening...":" Voice Input"}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:T?"Transcribing your audio...":c?"Speak now. Will auto-stop after 2 seconds of silence.":"Click start to begin recording"})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"relative h-32 bg-gray-100 dark:bg-gray-800 rounded-lg overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 flex items-end justify-center gap-1 p-4",children:[...Array(20)].map((W,H)=>{const re=Math.max(.1,p*(1-Math.abs(H-10)/10)*(.8+Math.random()*.4));return u.jsx("div",{className:`flex-1 rounded-t transition-all duration-100 ${c?p>.3?"bg-gradient-to-t from-green-500 to-green-300":"bg-gradient-to-t from-blue-500 to-blue-300":"bg-gray-400"}`,style:{height:`${re*100}%`,opacity:c?1:.3}},H)})}),c&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center ${p>.3?"bg-green-500/20 animate-pulse":"bg-blue-500/20"}`,children:u.jsxs("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"}),u.jsx("path",{d:"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})]})})})]})}),m&&u.jsx("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:u.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:[u.jsx("strong",{children:"Transcription:"})," ",m]})}),x&&u.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:u.jsxs("p",{className:"text-sm text-red-700 dark:text-red-300",children:[u.jsx("strong",{children:"Error:"})," ",x]})}),u.jsxs("div",{className:"flex gap-3",children:[c&&!T&&u.jsxs("button",{onClick:X,className:"flex-1 py-3 px-4 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("rect",{x:"6",y:"6",width:"12",height:"12",rx:"2"})}),"Stop"]}),u.jsx("button",{onClick:e,disabled:T,className:"flex-1 py-3 px-4 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-gray-100 rounded-lg font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:T?"Processing...":"Cancel"})]}),u.jsxs("div",{className:"mt-6 text-center text-xs text-gray-500 dark:text-gray-400",children:["Press ",u.jsx("kbd",{className:"px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded",children:"Esc"})," to cancel"]})]})}):null};function PI({isOpen:t,onClose:e,messageData:r,planData:n,showSuccess:a,showError:s}){const[i,l]=N.useState(""),[c,d]=N.useState(!1),[p,g]=N.useState(null),{getToken:m}=oi(),y=2e3,x=y-i.length,w=async()=>{if(!i.trim()){g("Please provide an explanation");return}d(!0),g(null);try{const T=await m();if(!T)throw new Error("Not authenticated. Please log in.");const k=await ms(),_=await dn();console.log(" Token check:",{hasIdToken:!!T,hasGoogleToken:!!k,googleTokenPrefix:k.substring(0,20)});const P={explanation:i.trim(),timestamp:new Date().toISOString()};r&&(P.messageData={messageId:r.messageId,messageContent:r.messageContent,llmApiCalls:r.llmApiCalls,evaluations:r.evaluations||[],conversationThread:r.conversationThread}),n&&(P.planData=n,P.feedbackType="negative");const F=await fetch(`${_}/report-error`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${T}`,"X-Google-Access-Token":k},body:JSON.stringify(P)});if(!F.ok){const D=await F.json().catch(()=>({error:"Unknown error"}));throw new Error(D.error||`HTTP ${F.status}`)}l(""),e(),a(" Report submitted successfully! Thank you for your feedback.")}catch(T){console.error("Failed to submit error report:",T);const k=T instanceof Error?T.message:"Failed to submit report. Please try again.";g(k),s(`Failed to submit report: ${k}`)}finally{d(!1)}};return t?u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-900 flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 z-10",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("span",{className:"text-2xl",children:""}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Report Response Issue"})]}),u.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 text-2xl leading-none","aria-label":"Close",children:""})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-200 dark:border-blue-800 text-sm",children:u.jsxs("p",{className:"text-blue-900 dark:text-blue-100",children:[" ",u.jsx("strong",{children:"Privacy Notice:"})," Your report will include this conversation's full context and will be reviewed by the development team to improve the system. Please do not include sensitive personal information in your explanation."]})}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:"Help us improve! Describe what went wrong with this response:"}),u.jsx("textarea",{value:i,onChange:T=>l(T.target.value.slice(0,y)),placeholder:`Examples:
 Response was factually incorrect about...
 Did not answer my actual question
 Hallucinated information
 Ignored previous context
 Missing important details`,className:"w-full h-48 px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-gray-100 placeholder-gray-400 dark:placeholder-gray-500 resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0}),u.jsx("div",{className:"flex justify-between items-center text-sm",children:u.jsxs("span",{className:`${x<100?"text-orange-600 dark:text-orange-400 font-medium":"text-gray-500 dark:text-gray-400"}`,children:[x," characters remaining"]})}),p&&u.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800",children:u.jsxs("p",{className:"text-red-900 dark:text-red-100 text-sm",children:[" ",p]})})]}),u.jsxs("div",{className:"sticky bottom-0 bg-white dark:bg-gray-900 flex items-center justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{onClick:e,disabled:c,className:"px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),u.jsx("button",{onClick:w,disabled:c||!i.trim(),className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:c?u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"animate-spin",children:""}),u.jsx("span",{children:"Sending..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Send Report"})]})})]})]})}):null}const DG=({isOpen:t,onClose:e,onTransferToChat:r})=>{const{t:n}=Lc(),a=jy(t,e),{getToken:s,isAuthenticated:i,accessToken:l,user:c}=oi(),{settings:d}=vo(),{showError:p,showSuccess:g}=jl(),[m,y]=go("planning_query",""),[x,w]=go("planning_result",null),[T,k]=N.useState(!1),[_,P]=N.useState(""),[F,D]=N.useState(!1),[B,M]=N.useState([]),[$,Z]=N.useState(""),[z,ee]=N.useState(null),[te,X]=N.useState(null),[Q,W]=N.useState(!1),[H,re]=N.useState(!1),[ne,ve]=N.useState("query"),[O,I]=N.useState(0),K=N.useRef(null),U=N.useRef(null),ce=N.useRef(null),[ye,Ae]=go("planning_dialog_generated_system_prompt",""),[fe,Ne]=go("planning_dialog_generated_user_query",""),[Te,se]=N.useState(""),[be,xe]=N.useState(""),[me,de]=N.useState(""),he=Qe=>{Qe&&(Qe.style.height="auto",Qe.style.height=Qe.scrollHeight+"px")};N.useEffect(()=>{he(K.current)},[m]),N.useEffect(()=>{he(U.current)},[ye]),N.useEffect(()=>{he(ce.current)},[fe]),N.useEffect(()=>{dn().then(Qe=>{Z(Qe),console.log(" API endpoint for planning voice input:",Qe)})},[]),N.useEffect(()=>{F&&(Pg().then(Qe=>{M(Qe)}),Ie())},[F]);const Ie=async()=>{const Qe=await iU();ee(Qe)};N.useEffect(()=>{x&&x.queryType==="guidance"?(m&&se(m),ye&&xe(ye),fe&&de(fe),Ae(""),Ne("")):x&&x.queryType!=="guidance"&&Te&&(be&&Ae(be),me&&Ne(me),se(""),xe(""),de(""))},[x]);const ze=async()=>{if(!i){console.error("User not authenticated"),p(n("planning.signInRequired")),w({error:n("planning.authRequired")});return}if(!m.trim()){p(n("planning.enterResearchQuestion"));return}if(!T){k(!0),w(null),P(n("planning.initializing"));try{const Qe=await s();if(!Qe){console.error("No valid token available"),p(n("planning.authExpired")),w({error:n("planning.authExpired")}),k(!1);return}console.log(" Planning with token:",{tokenLength:Qe.length,tokenPrefix:Qe.substring(0,20)+"...",isAuthenticated:i,hasProviders:d?.providers.length||0});const Yt=d?.providers.filter(ur=>ur.enabled!==!1)||[];console.log(` Enabled providers: ${Yt.length} (server may have additional credentials)`),await jw(m,Qe,Yt,void 0,(ur,_t)=>{switch(console.log("Planning SSE event:",ur,_t),ur){case"status":console.log("Status:",_t.message),P(_t.message||"Processing...");break;case"result":w(_t),_t.enhancedSystemPrompt&&Ae(_t.enhancedSystemPrompt),_t.enhancedUserPrompt&&Ne(_t.enhancedUserPrompt);break;case"llm_response":X(sr=>({...sr,..._t})),console.log("Captured LLM transparency info:",_t);break;case"error":{const sr=_t.error||"Unknown error",vt=_t.provider&&_t.model?` (Provider: ${_t.provider}, Model: ${_t.model})`:"",pn=`${sr}${vt}`;let Ar="";sr.includes("Invalid API Key")||sr.includes("401")?Ar=`

 Tip: Check your API key in Settings. Make sure it's valid and hasn't expired.`:(_t.isRateLimit||sr.includes("rate limit"))&&(Ar=`

 Tip: You've hit the rate limit. Try again in a few moments or use a different provider.`),w({error:pn+Ar}),p(`Planning error: ${pn}${Ar}`);break}case"llm_error":{console.error("LLM Error:",_t);const sr=_t.error||"LLM request failed",vt=_t.provider&&_t.modelName?` (${_t.provider}:${_t.modelName})`:"";p(`LLM Error${vt}: ${sr}`);break}}},()=>{console.log("Planning stream complete"),k(!1),P("")},ur=>{console.error("Planning stream error:",ur),w({error:ur.message}),p(`Planning failed: ${ur.message}`),k(!1),P("")},{language:d?.language||"en"})}catch(Qe){console.error("Planning error:",Qe);const Yt=Qe instanceof Error?Qe.message:"Unknown error";w({error:Yt}),p(`Planning error: ${Yt}`),k(!1),P("")}}},nt=()=>{if(!fe||!r)return;const Qe={prompt:fe,persona:ye||"",planningQuery:m,generatedSystemPrompt:ye,generatedUserQuery:fe};console.log(" PlanningDialog - Creating transfer data:",Qe);const Yt=JSON.stringify(Qe);console.log(" PlanningDialog - JSON string length:",Yt.length),r(Yt),e()},mt=()=>{const Qe={query:m,result:x,generatedSystemPrompt:ye,generatedUserPrompt:fe,llmInfo:te,timestamp:new Date().toISOString()},Yt=`=== Planning Debug Info for Copilot ===
Generated at: ${Qe.timestamp}

--- User Query ---
${Qe.query||"(none)"}

--- Planning Result (Full Response) ---
${JSON.stringify(Qe.result,null,2)}

--- Generated System Prompt ---
${Qe.generatedSystemPrompt||"(none)"}

--- Generated User Query ---
${Qe.generatedUserPrompt||"(none)"}

--- LLM Request/Response Details ---
${JSON.stringify(Qe.llmInfo,null,2)}

=== End Debug Info ===`;navigator.clipboard.writeText(Yt).then(()=>{g(n("planning.debugCopied"))},()=>{p(n("planning.debugCopyFailed"))})},ht=Qe=>{y(Qe.query),w(Qe.plan),Qe.plan&&!Qe.plan.error&&(Qe.plan.enhancedSystemPrompt&&Ae(Qe.plan.enhancedSystemPrompt),Qe.plan.enhancedUserPrompt&&Ne(Qe.plan.enhancedUserPrompt)),Qe.systemPrompt&&Ae(Qe.systemPrompt),Qe.userPrompt&&Ne(Qe.userPrompt),D(!1)},er=async Qe=>{await aU(Qe);const Yt=await Pg();M(Yt)},ct=async()=>{if(!x||x.error){p(n("planning.cannotSavePlan"));return}try{await FP(m,x,x.enhancedSystemPrompt||ye||"",x.enhancedUserPrompt||fe||""),g(n("planning.planSavedSuccess")),console.log("Plan manually saved to cache with system and user prompts")}catch(Qe){p(Qe instanceof Error?Qe.message:n("planning.planSaveFailed"))}},Dt=()=>{y(""),w(null),Ae(""),Ne(""),localStorage.removeItem("planning_dialog_generated_system_prompt"),localStorage.removeItem("planning_dialog_generated_user_query"),localStorage.removeItem("planning_query"),localStorage.removeItem("planning_result"),console.log("Planning dialog cleared completely")},kt=async()=>{try{const Qe=await s();if(!Qe){p("Please sign in to submit feedback");return}const Yt=await ms(),ur=await dn();if(!(await fetch(`${ur}/report-error`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Qe}`,"X-Google-Access-Token":Yt},body:JSON.stringify({userEmail:c?.email,feedbackType:"positive",explanation:"",planData:{query:m,generatedSystemPrompt:ye,generatedUserQuery:fe,llmInfo:te},timestamp:new Date().toISOString()})})).ok)throw new Error("Failed to submit feedback");g(" Thank you for the feedback!")}catch(Qe){console.error("Error submitting positive plan feedback:",Qe),p("Failed to submit feedback")}},[fr,qe]=N.useState(!1),st=()=>{qe(!0)},Gt=Qe=>{console.log(" Voice transcription received for planning:",Qe);let Yt="",ur,_t=null;switch(ne){case"systemPrompt":Yt=ye,ur=Ae,_t=U.current;break;case"userQuery":Yt=fe,ur=Ne,_t=ce.current;break;case"query":default:Yt=m,ur=y,_t=K.current;break}const sr=Yt.substring(0,O),vt=Yt.substring(O),pn=sr+Qe+vt;ur(pn),_t&&setTimeout(()=>{const Ar=O+Qe.length;_t.selectionStart=Ar,_t.selectionEnd=Ar,_t.focus(),I(Ar)},0)},Kt=Qe=>{ve(Qe)},lr=Qe=>{Qe&&I(Qe.selectionStart)};return t?u.jsxs(u.Fragment,{children:[u.jsx(Kw.FocusTrap,{active:t,children:u.jsx("div",{ref:a,className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 md:px-6 py-4",children:[u.jsxs("div",{className:"flex justify-between items-start gap-2",children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 flex-shrink-0",children:n("planning.title")}),u.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 flex-shrink-0","aria-label":n("common.close"),children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[u.jsxs("button",{onClick:ct,disabled:!x||x.error,className:"btn-primary text-sm flex items-center gap-1.5",title:n("planning.savePlanTooltip"),children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),n("planning.savePlan")]}),u.jsxs("button",{onClick:()=>D(!0),className:"btn-secondary text-sm flex items-center gap-1.5",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),n("planning.loadSaved")]})]})]}),u.jsxs("div",{className:"p-6 space-y-4",children:[T&&_&&u.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsxs("svg",{className:"animate-spin h-5 w-5 text-blue-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),u.jsx("div",{className:"ml-3",children:u.jsx("p",{className:"text-sm text-blue-700",children:_})})]})}),!(x&&x.queryType==="guidance")&&u.jsxs("div",{className:"card p-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:n("planning.query")}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:ze,disabled:T||!m.trim(),title:i?m.trim()?n(T?"planning.planning":"planning.generatePlan"):n("planning.enterResearchQuestion"):n("planning.signInRequired"),className:`${i?"bg-green-600 hover:bg-green-700":"bg-yellow-500 hover:bg-yellow-600"} disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5`,children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})}),n(T?"planning.generating":i?"planning.generatePlan":"planning.signInToGenerate")]}),u.jsxs("button",{onClick:Dt,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",title:n("planning.clearAllTooltip"),children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),n("planning.clearAll")]})]})]}),i?u.jsxs("div",{className:"relative",children:[u.jsx("textarea",{ref:K,value:m,onChange:Qe=>y(Qe.target.value),onFocus:()=>Kt("query"),onClick:()=>lr(K.current),onKeyUp:()=>lr(K.current),placeholder:n("planning.enterQuery"),className:"input-field resize-none overflow-hidden pr-12",style:{minHeight:"120px"}}),u.jsx("button",{onClick:()=>re(!0),disabled:!i,className:"absolute top-2 right-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white p-2 rounded-lg transition-colors shadow-lg",title:i?"Voice input - transcribe speech":n("auth.signInRequired"),children:u.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"}),u.jsx("path",{d:"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})]})})]}):u.jsx("div",{className:"text-center text-red-500 py-4",children:n("planning.signInToUsePlanning")})]}),ye&&!(x&&x.queryType==="guidance")&&u.jsxs("div",{className:"card p-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:n("planning.generatedPrompts")}),u.jsxs("div",{className:"flex items-center gap-2",children:[te&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:kt,className:"text-xs px-2 py-1 rounded bg-green-50 dark:bg-green-900/30 hover:bg-green-100 dark:hover:bg-green-900/50 flex items-center gap-1 transition-colors",title:"Good plan",children:""}),u.jsx("button",{onClick:st,className:"text-xs px-2 py-1 rounded bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50 flex items-center gap-1 transition-colors",title:"Bad plan - report issue",children:""})]}),te&&u.jsxs("button",{onClick:()=>W(!0),className:"btn-secondary text-xs px-3 py-1.5 flex items-center gap-1",title:n("planning.llmInfoTooltip"),children:[" $",(te.cost||0).toFixed(4),"  ",te.calls||1," ",te.calls>1?n("planning.llmCallsPlural"):n("planning.llmCalls")," "]}),u.jsxs("button",{onClick:mt,disabled:!m&&!x,className:"bg-purple-600 hover:bg-purple-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors flex items-center gap-1.5",title:n("planning.debugTooltip"),children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),n("planning.debug")]}),r&&u.jsxs("button",{onClick:nt,disabled:!fe||!fe.trim(),className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors flex items-center gap-1.5",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),n("planning.transferToChat")]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold mb-2 text-gray-900 dark:text-gray-100",children:n("planning.systemPromptEditable")}),u.jsx("textarea",{ref:U,value:ye,onChange:Qe=>Ae(Qe.target.value),onFocus:()=>Kt("systemPrompt"),onClick:()=>lr(U.current),onKeyUp:()=>lr(U.current),className:"input-field resize-none overflow-hidden w-full",style:{minHeight:"96px"}}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:n("planning.systemPromptHelp")})]}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold mb-2 text-gray-900 dark:text-gray-100",children:n("planning.userQueryEditable")}),u.jsx("textarea",{ref:ce,value:fe,onChange:Qe=>Ne(Qe.target.value),onFocus:()=>Kt("userQuery"),onClick:()=>lr(ce.current),onKeyUp:()=>lr(ce.current),className:"input-field resize-none overflow-hidden w-full",style:{minHeight:"96px"}}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:n("planning.userQueryHelp")})]})]})]}),x&&!x.error&&u.jsx("div",{className:"card p-4",children:u.jsxs("div",{className:"space-y-4",children:[x.queryType==="SIMPLE"&&u.jsxs("div",{className:"card p-4 bg-blue-50 dark:bg-blue-900/20",children:[u.jsx("h3",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-2",children:n("planning.simpleQueryDetected")}),u.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:x.simpleInstruction}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:n("planning.simpleQueryHelp")})]}),x.queryType==="OVERVIEW"&&u.jsxs("div",{className:"card p-4 space-y-4",children:[u.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:n("planning.comprehensiveResearchPlan")}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg",children:[u.jsx("h4",{className:"text-sm font-medium mb-2 text-gray-800 dark:text-gray-200",children:n("planning.analysisSummary")}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:n("planning.queryType")}),u.jsx("span",{className:"ml-2 px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded",children:x.queryType})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:n("planning.complexity")}),u.jsx("span",{className:"ml-2 px-2 py-1 bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200 rounded",children:x.complexityAssessment})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:n("planning.researchApproach")}),u.jsx("span",{className:"ml-2 px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded",children:x.researchApproach})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:n("planning.estimatedSources")}),u.jsx("span",{className:"ml-2 px-2 py-1 bg-indigo-100 dark:bg-indigo-900 text-indigo-800 dark:text-indigo-200 rounded",children:x.estimatedSources||"N/A"})]})]}),x.reasoning&&u.jsxs("div",{className:"mt-2",children:[u.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-400",children:n("planning.reasoning")}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mt-1",children:x.reasoning})]})]}),x.persona&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[u.jsx("h4",{className:"text-sm font-medium mb-2 text-blue-800 dark:text-blue-200",children:n("planning.expertPersona")}),u.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:x.persona})]}),x.searchStrategies?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.searchQueries")}),u.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:u.jsx("ul",{className:"space-y-1",children:x.searchStrategies.map((Qe,Yt)=>u.jsxs("li",{className:"text-sm text-green-700 dark:text-green-300 flex items-start",children:[u.jsx("span",{className:"text-green-500 mr-2",children:""}),u.jsxs("span",{children:['"',Qe,'"']})]},Yt))})})]}),x.researchQuestions?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.researchQuestions")}),u.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg",children:u.jsx("ul",{className:"list-decimal list-inside space-y-1 text-sm",children:x.researchQuestions.map((Qe,Yt)=>u.jsx("li",{className:"text-purple-700 dark:text-purple-300",children:Qe},Yt))})})]}),x.suggestedSources?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.suggestedSources")}),u.jsx("div",{className:"bg-teal-50 dark:bg-teal-900/20 p-3 rounded-lg",children:u.jsx("div",{className:"space-y-2",children:x.suggestedSources.map((Qe,Yt)=>u.jsxs("div",{className:"text-sm",children:[u.jsxs("div",{className:"font-medium text-teal-800 dark:text-teal-200 capitalize",children:[Qe.type," ",n("planning.sources")]}),u.jsx("div",{className:"text-teal-700 dark:text-teal-300 ml-2",children:Qe.examples?Qe.examples.join(", "):n("planning.variousRelevantSources")})]},Yt))})})]}),x.methodology&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.researchMethodology")}),u.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg",children:u.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:x.methodology})})]}),x.enhancedSystemPrompt&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:" Enhanced System Prompt:"}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg border",children:u.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono",children:x.enhancedSystemPrompt})})]}),x.enhancedUserPrompt&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:" Enhanced User Prompt:"}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 p-3 rounded-lg border",children:u.jsx("p",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap font-mono",children:x.enhancedUserPrompt})})]}),u.jsxs("details",{className:"bg-gray-50 dark:bg-gray-900/50 p-3 rounded-lg border",children:[u.jsx("summary",{className:"text-sm font-medium cursor-pointer text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:" Debug: Raw LLM Response Fields"}),u.jsx("div",{className:"mt-3 space-y-2 text-xs",children:Object.entries(x).map(([Qe,Yt])=>Qe.startsWith("_")||typeof Yt=="object"?null:u.jsxs("div",{className:"flex",children:[u.jsxs("span",{className:"font-mono text-gray-500 dark:text-gray-400 w-32 flex-shrink-0",children:[Qe,":"]}),u.jsx("span",{className:"text-gray-700 dark:text-gray-300 break-all",children:typeof Yt=="string"?Yt:JSON.stringify(Yt)})]},Qe))})]})]}),x.queryType==="LONG_FORM"&&u.jsxs("div",{className:"card p-4 space-y-4",children:[u.jsx("h3",{className:"font-semibold text-purple-900 dark:text-purple-100",children:n("planning.longFormDocumentPlan")}),u.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded text-sm",children:[u.jsx("strong",{children:"Note:"})," ",n("planning.longFormNote")]}),x.documentSections?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.documentStructure")}),x.documentSections.map((Qe,Yt)=>u.jsxs("div",{className:"ml-4 mb-3 p-2 bg-gray-50 dark:bg-gray-900 rounded",children:[u.jsxs("div",{className:"font-medium text-purple-600 dark:text-purple-400",children:[Yt+1,". ",Qe.title]}),u.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:[n("planning.keywords"),": ",Qe.keywords.join(", ")]}),Qe.questions?.length>0&&u.jsx("ul",{className:"text-xs mt-1 ml-4 list-disc list-inside",children:Qe.questions.map((ur,_t)=>u.jsx("li",{children:ur},_t))})]},Yt))]}),x.snippetWorkflow&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.workflow")}),u.jsx("div",{className:"text-xs bg-gray-50 dark:bg-gray-900 p-2 rounded whitespace-pre-wrap",children:x.snippetWorkflow})]})]}),x.queryType==="NEEDS_CLARIFICATION"&&u.jsxs("div",{className:"card p-4 space-y-4 bg-orange-50 dark:bg-orange-900/20",children:[u.jsx("h3",{className:"font-semibold text-orange-900 dark:text-orange-100",children:n("planning.needMoreInfo")}),u.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:x.reasoning}),x.clarificationQuestions?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.pleaseClarify")}),u.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm ml-4",children:x.clarificationQuestions.map((Qe,Yt)=>u.jsx("li",{className:"text-gray-700 dark:text-gray-300",children:Qe},Yt))})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:n("planning.updateQueryDetails")}),u.jsx("textarea",{value:m,onChange:Qe=>y(Qe.target.value),className:"input-field",rows:4,placeholder:n("planning.provideMoreDetails")}),u.jsx("button",{onClick:ze,className:"btn-primary mt-2 w-full",children:n("planning.regeneratePlanWithClarifications")})]})]}),x.queryType==="guidance"&&u.jsxs("div",{className:"card p-4 space-y-4 bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20",children:[u.jsxs("h3",{className:"font-semibold text-purple-900 dark:text-purple-100 flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl",children:""})," ",n("planning.moreInfoRequired")]}),x.planType&&u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsx("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:n("planning.planType")}),u.jsx("span",{className:"px-3 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 rounded-full text-sm font-medium",children:x.planType.replace(/-/g," ").toUpperCase()})]}),x.detectedPatterns?.length>0&&u.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-purple-200 dark:border-purple-700",children:[u.jsx("h4",{className:"text-sm font-medium mb-2 text-purple-800 dark:text-purple-200",children:n("planning.detectedComplexityPatterns")}),u.jsx("div",{className:"flex flex-wrap gap-2",children:x.detectedPatterns.map((Qe,Yt)=>u.jsx("span",{className:"px-2 py-1 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-xs",children:Qe},Yt))})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[x.estimatedIterations&&u.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-blue-200 dark:border-blue-700",children:[u.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:n("planning.estimatedIterations")}),u.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:x.estimatedIterations})]}),x.toolsRequired?.length>0&&u.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-lg border border-blue-200 dark:border-blue-700",children:[u.jsx("div",{className:"font-medium text-blue-700 dark:text-blue-300",children:n("planning.toolsRequired")}),u.jsx("div",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:x.toolsRequired.length})]})]}),x.suggestedWorkflow&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[u.jsx("h4",{className:"text-sm font-medium mb-2 text-blue-800 dark:text-blue-200",children:n("planning.suggestedWorkflow")}),u.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:x.suggestedWorkflow})]}),x.toolsRequired?.length>0&&u.jsxs("div",{children:[u.jsx("h4",{className:"text-sm font-medium mb-2",children:n("planning.requiredTools")}),u.jsx("div",{className:"flex flex-wrap gap-2",children:x.toolsRequired.map((Qe,Yt)=>u.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-blue-100 to-purple-100 dark:from-blue-900/30 dark:to-purple-900/30 text-blue-800 dark:text-blue-200 rounded-lg text-sm font-mono",children:Qe},Yt))})]}),u.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 p-4 rounded-lg border-2 border-yellow-300 dark:border-yellow-700",children:[u.jsxs("h4",{className:"text-sm font-medium mb-3 text-yellow-900 dark:text-yellow-100 flex items-center gap-2",children:[u.jsx("span",{className:"text-lg",children:""})," ",n("planning.guidanceQuestions")]}),x.guidanceQuestions?.length>0&&u.jsx("ol",{className:"list-decimal list-inside space-y-2 text-sm mb-4",children:x.guidanceQuestions.map((Qe,Yt)=>u.jsx("li",{className:"text-yellow-800 dark:text-yellow-200 font-medium",children:Qe},Yt))}),u.jsxs("div",{className:"mt-4 space-y-2",children:[u.jsx("label",{className:"block text-sm font-semibold text-yellow-900 dark:text-yellow-100",children:n("planning.updatePromptWithAnswers")}),u.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mb-2",children:n("planning.guidanceTip")}),u.jsx("textarea",{value:m,onChange:Qe=>y(Qe.target.value),className:"input-field",rows:6,placeholder:n("planning.guidanceExamplePlaceholder")}),u.jsxs("div",{className:"flex gap-2 mt-2",children:[u.jsx("button",{onClick:ze,className:"btn-primary flex-1",children:n("planning.generateDetailedExecutionPlan")}),u.jsx("button",{onClick:async()=>{if(!i){p(n("planning.signInRequired"));return}if(!T){k(!0),P(n("planning.forcingPlan"));try{const Qe=await s();if(!Qe){p(n("planning.authExpired")),k(!1);return}const Yt=d?.providers.filter(_t=>_t.enabled!==!1)||[],ur=x.guidanceQuestions?.map((_t,sr)=>`Q${sr+1}: ${_t}
A${sr+1}: ${n("planning.clarificationAnswer")}`).join(`

`)||"";await jw(m,Qe,Yt,void 0,(_t,sr)=>{switch(console.log("Force Plan SSE event:",_t,sr),_t){case"status":P(sr.message||n("planning.processing"));break;case"result":w(sr),sr.enhancedSystemPrompt&&Ae(sr.enhancedSystemPrompt),sr.enhancedUserPrompt&&Ne(sr.enhancedUserPrompt);break;case"llm_response":X(vt=>({...vt,...sr}));break;case"error":{const vt=sr.error||"Unknown error";w({error:vt}),p(`${n("planning.forcePlanError")}: ${vt}`);break}}},()=>{console.log("Force plan complete"),k(!1),P("")},_t=>{console.error("Force plan error:",_t),w({error:_t.message}),p(`${n("planning.forcePlanFailed")}: ${_t.message}`),k(!1),P("")},{clarificationAnswers:ur,previousContext:x,forcePlan:!0,language:d?.language||"en"})}catch(Qe){console.error("Force plan error:",Qe);const Yt=Qe instanceof Error?Qe.message:"Unknown error";w({error:Yt}),p(`${n("planning.forcePlanError")}: ${Yt}`),k(!1),P("")}}},disabled:T,className:"btn-secondary flex-1",title:n("planning.forcePlanTooltip"),children:n("planning.forcePlan")}),u.jsx("button",{onClick:()=>{w(null),P(""),be&&Ae(be),me&&Ne(me),se(""),xe(""),de("")},className:"btn-secondary",title:n("planning.resetTooltip"),children:n("planning.reset")})]})]})]}),u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-300 dark:border-blue-700",children:u.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[u.jsx("strong",{children:n("planning.aboutGuidanceMode")})," ",n("planning.guidanceModeHelp")]})})]})]})})]})]})})}),F&&u.jsx(Kw.FocusTrap,{active:F,children:u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black bg-opacity-50 p-4",children:u.jsxs("div",{className:"card p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h3",{className:"text-lg font-bold",children:n("planning.loadSavedPlan")}),z&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n("planning.storage"),": ",(z.usage/(1024*1024)).toFixed(2)," MB / ",(z.quota/(1024*1024)).toFixed(0)," MB (",z.percentage.toFixed(1),"%)"]})]}),z&&z.percentage>80&&u.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:[u.jsxs("div",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-semibold mb-2",children:[" ",n("planning.storageWarning",{percentage:z.percentage.toFixed(1)})]}),u.jsx("div",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:n("planning.storageWarningHelp")})]}),B.length===0?u.jsx("p",{className:"text-gray-500",children:n("planning.noSavedPlans")}):u.jsx("div",{className:"space-y-3",children:B.map(Qe=>{const Yt=new Date(Qe.timestamp).toLocaleString();return u.jsx("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-3",children:u.jsxs("div",{className:"flex justify-between items-start gap-2 mb-2",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100 mb-1 truncate",title:Qe.query,children:Qe.query.length>100?Qe.query.substring(0,100)+"...":Qe.query}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[n("planning.saved"),": ",Yt]})]}),u.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[u.jsx("button",{onClick:()=>ht(Qe),className:"btn-primary text-xs",children:n("planning.load")}),u.jsx("button",{onClick:()=>er(Qe.id),className:"btn-secondary text-red-500 text-xs",children:n("common.delete")})]})]})},Qe.id)})}),u.jsx("button",{onClick:()=>D(!1),className:"btn-primary w-full mt-4",children:n("common.close")})]})})}),Q&&te&&u.jsx(AS,{apiCalls:[te],onClose:()=>W(!1)}),u.jsx(NI,{isOpen:H,onClose:()=>re(!1),onTranscriptionComplete:Gt,accessToken:l,apiEndpoint:$}),fr&&u.jsx(PI,{isOpen:fr,onClose:()=>qe(!1),planData:{query:m,generatedSystemPrompt:ye,generatedUserQuery:fe,llmInfo:te},showSuccess:g,showError:p}),u.jsx("div",{className:"flex justify-end mt-6",children:u.jsx("button",{className:"btn-secondary text-xs",onClick:mt,title:"Copy conversation, LLM, and tool debug info for Copilot support",children:" Copy Debug Info"})})]}):null};function __(t){const e=[],r=String(t||"");let n=r.indexOf(","),a=0,s=!1;for(;!s;){n===-1&&(n=r.length,s=!0);const i=r.slice(a,n).trim();(i||!s)&&e.push(i),a=n+1,n=r.indexOf(",",a)}return e}function II(t,e){const r={};return(t[t.length-1]===""?[...t,""]:t).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const LG=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,MG=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,OG={};function A_(t,e){return(OG.jsx?MG:LG).test(t)}const jG=/[ \t\n\f\r]/g;function BG(t){return typeof t=="object"?t.type==="text"?N_(t.value):!1:N_(t)}function N_(t){return t.replace(jG,"")===""}let af=class{constructor(e,r,n){this.normal=r,this.property=e,n&&(this.space=n)}};af.prototype.normal={};af.prototype.property={};af.prototype.space=void 0;function RI(t,e){const r={},n={};for(const a of t)Object.assign(r,a.property),Object.assign(n,a.normal);return new af(r,n,e)}function Rg(t){return t.toLowerCase()}let li=class{constructor(e,r){this.attribute=r,this.property=e}};li.prototype.attribute="";li.prototype.booleanish=!1;li.prototype.boolean=!1;li.prototype.commaOrSpaceSeparated=!1;li.prototype.commaSeparated=!1;li.prototype.defined=!1;li.prototype.mustUseProperty=!1;li.prototype.number=!1;li.prototype.overloadedBoolean=!1;li.prototype.property="";li.prototype.spaceSeparated=!1;li.prototype.space=void 0;let FG=0;const en=zu(),La=zu(),Xw=zu(),$t=zu(),Xn=zu(),Xd=zu(),Ci=zu();function zu(){return 2**++FG}const Jw=Object.freeze(Object.defineProperty({__proto__:null,boolean:en,booleanish:La,commaOrSpaceSeparated:Ci,commaSeparated:Xd,number:$t,overloadedBoolean:Xw,spaceSeparated:Xn},Symbol.toStringTag,{value:"Module"})),Av=Object.keys(Jw);let NS=class extends li{constructor(e,r,n,a){let s=-1;if(super(e,r),P_(this,"space",a),typeof n=="number")for(;++s<Av.length;){const i=Av[s];P_(this,Av[s],(n&Jw[i])===Jw[i])}}};NS.prototype.defined=!0;function P_(t,e,r){r&&(t[e]=r)}function Eh(t){const e={},r={};for(const[n,a]of Object.entries(t.properties)){const s=new NS(n,t.transform(t.attributes||{},n),a,t.space);t.mustUseProperty&&t.mustUseProperty.includes(n)&&(s.mustUseProperty=!0),e[n]=s,r[Rg(n)]=n,r[Rg(s.attribute)]=n}return new af(e,r,t.space)}const DI=Eh({properties:{ariaActiveDescendant:null,ariaAtomic:La,ariaAutoComplete:null,ariaBusy:La,ariaChecked:La,ariaColCount:$t,ariaColIndex:$t,ariaColSpan:$t,ariaControls:Xn,ariaCurrent:null,ariaDescribedBy:Xn,ariaDetails:null,ariaDisabled:La,ariaDropEffect:Xn,ariaErrorMessage:null,ariaExpanded:La,ariaFlowTo:Xn,ariaGrabbed:La,ariaHasPopup:null,ariaHidden:La,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Xn,ariaLevel:$t,ariaLive:null,ariaModal:La,ariaMultiLine:La,ariaMultiSelectable:La,ariaOrientation:null,ariaOwns:Xn,ariaPlaceholder:null,ariaPosInSet:$t,ariaPressed:La,ariaReadOnly:La,ariaRelevant:null,ariaRequired:La,ariaRoleDescription:Xn,ariaRowCount:$t,ariaRowIndex:$t,ariaRowSpan:$t,ariaSelected:La,ariaSetSize:$t,ariaSort:null,ariaValueMax:$t,ariaValueMin:$t,ariaValueNow:$t,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function LI(t,e){return e in t?t[e]:e}function MI(t,e){return LI(t,e.toLowerCase())}const zG=Eh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Xd,acceptCharset:Xn,accessKey:Xn,action:null,allow:null,allowFullScreen:en,allowPaymentRequest:en,allowUserMedia:en,alt:null,as:null,async:en,autoCapitalize:null,autoComplete:Xn,autoFocus:en,autoPlay:en,blocking:Xn,capture:null,charSet:null,checked:en,cite:null,className:Xn,cols:$t,colSpan:null,content:null,contentEditable:La,controls:en,controlsList:Xn,coords:$t|Xd,crossOrigin:null,data:null,dateTime:null,decoding:null,default:en,defer:en,dir:null,dirName:null,disabled:en,download:Xw,draggable:La,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:en,formTarget:null,headers:Xn,height:$t,hidden:Xw,high:$t,href:null,hrefLang:null,htmlFor:Xn,httpEquiv:Xn,id:null,imageSizes:null,imageSrcSet:null,inert:en,inputMode:null,integrity:null,is:null,isMap:en,itemId:null,itemProp:Xn,itemRef:Xn,itemScope:en,itemType:Xn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:en,low:$t,manifest:null,max:null,maxLength:$t,media:null,method:null,min:null,minLength:$t,multiple:en,muted:en,name:null,nonce:null,noModule:en,noValidate:en,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:en,optimum:$t,pattern:null,ping:Xn,placeholder:null,playsInline:en,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:en,referrerPolicy:null,rel:Xn,required:en,reversed:en,rows:$t,rowSpan:$t,sandbox:Xn,scope:null,scoped:en,seamless:en,selected:en,shadowRootClonable:en,shadowRootDelegatesFocus:en,shadowRootMode:null,shape:null,size:$t,sizes:null,slot:null,span:$t,spellCheck:La,src:null,srcDoc:null,srcLang:null,srcSet:null,start:$t,step:null,style:null,tabIndex:$t,target:null,title:null,translate:null,type:null,typeMustMatch:en,useMap:null,value:La,width:$t,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Xn,axis:null,background:null,bgColor:null,border:$t,borderColor:null,bottomMargin:$t,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:en,declare:en,event:null,face:null,frame:null,frameBorder:null,hSpace:$t,leftMargin:$t,link:null,longDesc:null,lowSrc:null,marginHeight:$t,marginWidth:$t,noResize:en,noHref:en,noShade:en,noWrap:en,object:null,profile:null,prompt:null,rev:null,rightMargin:$t,rules:null,scheme:null,scrolling:La,standby:null,summary:null,text:null,topMargin:$t,valueType:null,version:null,vAlign:null,vLink:null,vSpace:$t,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:en,disableRemotePlayback:en,prefix:null,property:null,results:$t,security:null,unselectable:null},space:"html",transform:MI}),$G=Eh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ci,accentHeight:$t,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:$t,amplitude:$t,arabicForm:null,ascent:$t,attributeName:null,attributeType:null,azimuth:$t,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:$t,by:null,calcMode:null,capHeight:$t,className:Xn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:$t,diffuseConstant:$t,direction:null,display:null,dur:null,divisor:$t,dominantBaseline:null,download:en,dx:null,dy:null,edgeMode:null,editable:null,elevation:$t,enableBackground:null,end:null,event:null,exponent:$t,externalResourcesRequired:null,fill:null,fillOpacity:$t,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Xd,g2:Xd,glyphName:Xd,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:$t,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:$t,horizOriginX:$t,horizOriginY:$t,id:null,ideographic:$t,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:$t,k:$t,k1:$t,k2:$t,k3:$t,k4:$t,kernelMatrix:Ci,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:$t,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:$t,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:$t,overlineThickness:$t,paintOrder:null,panose1:null,path:null,pathLength:$t,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Xn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:$t,pointsAtY:$t,pointsAtZ:$t,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ci,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ci,rev:Ci,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ci,requiredFeatures:Ci,requiredFonts:Ci,requiredFormats:Ci,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:$t,specularExponent:$t,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:$t,strikethroughThickness:$t,string:null,stroke:null,strokeDashArray:Ci,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:$t,strokeOpacity:$t,strokeWidth:null,style:null,surfaceScale:$t,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ci,tabIndex:$t,tableValues:null,target:null,targetX:$t,targetY:$t,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ci,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:$t,underlineThickness:$t,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:$t,values:null,vAlphabetic:$t,vMathematical:$t,vectorEffect:null,vHanging:$t,vIdeographic:$t,version:null,vertAdvY:$t,vertOriginX:$t,vertOriginY:$t,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:$t,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:LI}),OI=Eh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),jI=Eh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:MI}),BI=Eh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),UG={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},qG=/[A-Z]/g,I_=/-[a-z]/g,HG=/^data[-\w.:]+$/i;function PS(t,e){const r=Rg(e);let n=e,a=li;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&HG.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(I_,VG);n="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!I_.test(s)){let i=s.replace(qG,GG);i.charAt(0)!=="-"&&(i="-"+i),e="data"+i}}a=NS}return new a(n,e)}function GG(t){return"-"+t.toLowerCase()}function VG(t){return t.charAt(1).toUpperCase()}const By=RI([DI,zG,OI,jI,BI],"html"),_h=RI([DI,$G,OI,jI,BI],"svg");function R_(t){const e=String(t||"").trim();return e?e.split(/[ \t\n\r\f]+/g):[]}function FI(t){return t.join(" ").trim()}var Ld={},Nv,D_;function WG(){if(D_)return Nv;D_=1;var t=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,e=/\n/g,r=/^\s*/,n=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,a=/^:\s*/,s=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,i=/^[;\s]*/,l=/^\s+|\s+$/g,c=`
`,d="/",p="*",g="",m="comment",y="declaration";Nv=function(w,T){if(typeof w!="string")throw new TypeError("First argument must be a string");if(!w)return[];T=T||{};var k=1,_=1;function P(X){var Q=X.match(e);Q&&(k+=Q.length);var W=X.lastIndexOf(c);_=~W?X.length-W:_+X.length}function F(){var X={line:k,column:_};return function(Q){return Q.position=new D(X),$(),Q}}function D(X){this.start=X,this.end={line:k,column:_},this.source=T.source}D.prototype.content=w;function B(X){var Q=new Error(T.source+":"+k+":"+_+": "+X);if(Q.reason=X,Q.filename=T.source,Q.line=k,Q.column=_,Q.source=w,!T.silent)throw Q}function M(X){var Q=X.exec(w);if(Q){var W=Q[0];return P(W),w=w.slice(W.length),Q}}function $(){M(r)}function Z(X){var Q;for(X=X||[];Q=z();)Q!==!1&&X.push(Q);return X}function z(){var X=F();if(!(d!=w.charAt(0)||p!=w.charAt(1))){for(var Q=2;g!=w.charAt(Q)&&(p!=w.charAt(Q)||d!=w.charAt(Q+1));)++Q;if(Q+=2,g===w.charAt(Q-1))return B("End of comment missing");var W=w.slice(2,Q-2);return _+=2,P(W),w=w.slice(Q),_+=2,X({type:m,comment:W})}}function ee(){var X=F(),Q=M(n);if(Q){if(z(),!M(a))return B("property missing ':'");var W=M(s),H=X({type:y,property:x(Q[0].replace(t,g)),value:W?x(W[0].replace(t,g)):g});return M(i),H}}function te(){var X=[];Z(X);for(var Q;Q=ee();)Q!==!1&&(X.push(Q),Z(X));return X}return $(),te()};function x(w){return w?w.replace(l,g):g}return Nv}var L_;function YG(){if(L_)return Ld;L_=1;var t=Ld&&Ld.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ld,"__esModule",{value:!0}),Ld.default=r;const e=t(WG());function r(n,a){let s=null;if(!n||typeof n!="string")return s;const i=(0,e.default)(n),l=typeof a=="function";return i.forEach(c=>{if(c.type!=="declaration")return;const{property:d,value:p}=c;l?a(d,p,c):p&&(s=s||{},s[d]=p)}),s}return Ld}var Pp={},M_;function QG(){if(M_)return Pp;M_=1,Object.defineProperty(Pp,"__esModule",{value:!0}),Pp.camelCase=void 0;var t=/^--[a-zA-Z0-9_-]+$/,e=/-([a-z])/g,r=/^[^-]+$/,n=/^-(webkit|moz|ms|o|khtml)-/,a=/^-(ms)-/,s=function(d){return!d||r.test(d)||t.test(d)},i=function(d,p){return p.toUpperCase()},l=function(d,p){return"".concat(p,"-")},c=function(d,p){return p===void 0&&(p={}),s(d)?d:(d=d.toLowerCase(),p.reactCompat?d=d.replace(a,l):d=d.replace(n,l),d.replace(e,i))};return Pp.camelCase=c,Pp}var Ip,O_;function KG(){if(O_)return Ip;O_=1;var t=Ip&&Ip.__importDefault||function(a){return a&&a.__esModule?a:{default:a}},e=t(YG()),r=QG();function n(a,s){var i={};return!a||typeof a!="string"||(0,e.default)(a,function(l,c){l&&c&&(i[(0,r.camelCase)(l,s)]=c)}),i}return n.default=n,Ip=n,Ip}var XG=KG();const JG=Dc(XG),Fy=zI("end"),Zo=zI("start");function zI(t){return e;function e(r){const n=r&&r.position&&r.position[t]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function ZG(t){const e=Zo(t),r=Fy(t);if(e&&r)return{start:e,end:r}}function hg(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?j_(t.position):"start"in t||"end"in t?j_(t):"line"in t||"column"in t?Zw(t):""}function Zw(t){return B_(t&&t.line)+":"+B_(t&&t.column)}function j_(t){return Zw(t&&t.start)+"-"+Zw(t&&t.end)}function B_(t){return t&&typeof t=="number"?t:1}class Ss extends Error{constructor(e,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let a="",s={},i=!1;if(r&&("line"in r&&"column"in r?s={place:r}:"start"in r&&"end"in r?s={place:r}:"type"in r?s={ancestors:[r],place:r.position}:s={...r}),typeof e=="string"?a=e:!s.cause&&e&&(i=!0,a=e.message,s.cause=e),!s.ruleId&&!s.source&&typeof n=="string"){const c=n.indexOf(":");c===-1?s.ruleId=n:(s.source=n.slice(0,c),s.ruleId=n.slice(c+1))}if(!s.place&&s.ancestors&&s.ancestors){const c=s.ancestors[s.ancestors.length-1];c&&(s.place=c.position)}const l=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=l?l.line:void 0,this.name=hg(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=i&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Ss.prototype.file="";Ss.prototype.name="";Ss.prototype.reason="";Ss.prototype.message="";Ss.prototype.stack="";Ss.prototype.column=void 0;Ss.prototype.line=void 0;Ss.prototype.ancestors=void 0;Ss.prototype.cause=void 0;Ss.prototype.fatal=void 0;Ss.prototype.place=void 0;Ss.prototype.ruleId=void 0;Ss.prototype.source=void 0;const IS={}.hasOwnProperty,eV=new Map,tV=/[A-Z]/g,rV=new Set(["table","tbody","thead","tfoot","tr"]),nV=new Set(["td","th"]),$I="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function aV(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=e.filePath||void 0;let n;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=hV(r,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=dV(r,e.jsx,e.jsxs)}const a={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:n,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?_h:By,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},s=UI(a,t,void 0);return s&&typeof s!="string"?s:a.create(t,a.Fragment,{children:s||void 0},void 0)}function UI(t,e,r){if(e.type==="element")return sV(t,e,r);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return iV(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return lV(t,e,r);if(e.type==="mdxjsEsm")return oV(t,e);if(e.type==="root")return cV(t,e,r);if(e.type==="text")return uV(t,e)}function sV(t,e,r){const n=t.schema;let a=n;e.tagName.toLowerCase()==="svg"&&n.space==="html"&&(a=_h,t.schema=a),t.ancestors.push(e);const s=HI(t,e.tagName,!1),i=pV(t,e);let l=DS(t,e);return rV.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!BG(c):!0})),qI(t,i,s,e),RS(i,l),t.ancestors.pop(),t.schema=n,t.create(e,s,i,r)}function iV(t,e){if(e.data&&e.data.estree&&t.evaluater){const n=e.data.estree.body[0];return n.type,t.evaluater.evaluateExpression(n.expression)}Dg(t,e.position)}function oV(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);Dg(t,e.position)}function lV(t,e,r){const n=t.schema;let a=n;e.name==="svg"&&n.space==="html"&&(a=_h,t.schema=a),t.ancestors.push(e);const s=e.name===null?t.Fragment:HI(t,e.name,!0),i=gV(t,e),l=DS(t,e);return qI(t,i,s,e),RS(i,l),t.ancestors.pop(),t.schema=n,t.create(e,s,i,r)}function cV(t,e,r){const n={};return RS(n,DS(t,e)),t.create(e,t.Fragment,n,r)}function uV(t,e){return e.value}function qI(t,e,r,n){typeof r!="string"&&r!==t.Fragment&&t.passNode&&(e.node=n)}function RS(t,e){if(e.length>0){const r=e.length>1?e:e[0];r&&(t.children=r)}}function dV(t,e,r){return n;function n(a,s,i,l){const d=Array.isArray(i.children)?r:e;return l?d(s,i,l):d(s,i)}}function hV(t,e){return r;function r(n,a,s,i){const l=Array.isArray(s.children),c=Zo(n);return e(a,s,i,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function pV(t,e){const r={};let n,a;for(a in e.properties)if(a!=="children"&&IS.call(e.properties,a)){const s=fV(t,a,e.properties[a]);if(s){const[i,l]=s;t.tableCellAlignToStyle&&i==="align"&&typeof l=="string"&&nV.has(e.tagName)?n=l:r[i]=l}}if(n){const s=r.style||(r.style={});s[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function gV(t,e){const r={};for(const n of e.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&t.evaluater){const s=n.data.estree.body[0];s.type;const i=s.expression;i.type;const l=i.properties[0];l.type,Object.assign(r,t.evaluater.evaluateExpression(l.argument))}else Dg(t,e.position);else{const a=n.name;let s;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&t.evaluater){const l=n.value.data.estree.body[0];l.type,s=t.evaluater.evaluateExpression(l.expression)}else Dg(t,e.position);else s=n.value===null?!0:n.value;r[a]=s}return r}function DS(t,e){const r=[];let n=-1;const a=t.passKeys?new Map:eV;for(;++n<e.children.length;){const s=e.children[n];let i;if(t.passKeys){const c=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(c){const d=a.get(c)||0;i=c+"-"+d,a.set(c,d+1)}}const l=UI(t,s,i);l!==void 0&&r.push(l)}return r}function fV(t,e,r){const n=PS(t.schema,e);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?II(r):FI(r)),n.property==="style"){let a=typeof r=="object"?r:mV(t,String(r));return t.stylePropertyNameCase==="css"&&(a=yV(a)),["style",a]}return[t.elementAttributeNameCase==="react"&&n.space?UG[n.property]||n.property:n.attribute,r]}}function mV(t,e){try{return JG(e,{reactCompat:!0})}catch(r){if(t.ignoreInvalidStyle)return{};const n=r,a=new Ss("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:n,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=t.filePath||void 0,a.url=$I+"#cannot-parse-style-attribute",a}}function HI(t,e,r){let n;if(!r)n={type:"Literal",value:e};else if(e.includes(".")){const a=e.split(".");let s=-1,i;for(;++s<a.length;){const l=A_(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};i=i?{type:"MemberExpression",object:i,property:l,computed:!!(s&&l.type==="Literal"),optional:!1}:l}n=i}else n=A_(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(n.type==="Literal"){const a=n.value;return IS.call(t.components,a)?t.components[a]:a}if(t.evaluater)return t.evaluater.evaluateExpression(n);Dg(t)}function Dg(t,e){const r=new Ss("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=t.filePath||void 0,r.url=$I+"#cannot-handle-mdx-estrees-without-createevaluater",r}function yV(t){const e={};let r;for(r in t)IS.call(t,r)&&(e[bV(r)]=t[r]);return e}function bV(t){let e=t.replace(tV,xV);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function xV(t){return"-"+t.toLowerCase()}const Pv={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},vV={};function LS(t,e){const r=vV,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,a=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return GI(t,n,a)}function GI(t,e,r){if(wV(t)){if("value"in t)return t.type==="html"&&!r?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return F_(t.children,e,r)}return Array.isArray(t)?F_(t,e,r):""}function F_(t,e,r){const n=[];let a=-1;for(;++a<t.length;)n[a]=GI(t[a],e,r);return n.join("")}function wV(t){return!!(t&&typeof t=="object")}const z_=document.createElement("i");function MS(t){const e="&"+t+";";z_.innerHTML=e;const r=z_.textContent;return r.charCodeAt(r.length-1)===59&&t!=="semi"||r===e?!1:r}function Ai(t,e,r,n){const a=t.length;let s=0,i;if(e<0?e=-e>a?0:a+e:e=e>a?a:e,r=r>0?r:0,n.length<1e4)i=Array.from(n),i.unshift(e,r),t.splice(...i);else for(r&&t.splice(e,r);s<n.length;)i=n.slice(s,s+1e4),i.unshift(e,0),t.splice(...i),s+=1e4,e+=1e4}function Vi(t,e){return t.length>0?(Ai(t,t.length,0,e),t):e}const $_={}.hasOwnProperty;function VI(t){const e={};let r=-1;for(;++r<t.length;)SV(e,t[r]);return e}function SV(t,e){let r;for(r in e){const a=($_.call(t,r)?t[r]:void 0)||(t[r]={}),s=e[r];let i;if(s)for(i in s){$_.call(a,i)||(a[i]=[]);const l=s[i];kV(a[i],Array.isArray(l)?l:l?[l]:[])}}}function kV(t,e){let r=-1;const n=[];for(;++r<e.length;)(e[r].add==="after"?t:n).push(e[r]);Ai(t,0,0,n)}function WI(t,e){const r=Number.parseInt(t,e);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"":String.fromCodePoint(r)}function fo(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Rs=Mc(/[A-Za-z]/),ys=Mc(/[\dA-Za-z]/),TV=Mc(/[#-'*+\--9=?A-Z^-~]/);function O0(t){return t!==null&&(t<32||t===127)}const e1=Mc(/\d/),CV=Mc(/[\dA-Fa-f]/),EV=Mc(/[!-/:-@[-`{-~]/);function Ir(t){return t!==null&&t<-2}function Qn(t){return t!==null&&(t<0||t===32)}function un(t){return t===-2||t===-1||t===32}const zy=Mc(new RegExp("\\p{P}|\\p{S}","u")),Iu=Mc(/\s/);function Mc(t){return e;function e(r){return r!==null&&r>-1&&t.test(String.fromCharCode(r))}}function Ah(t){const e=[];let r=-1,n=0,a=0;for(;++r<t.length;){const s=t.charCodeAt(r);let i="";if(s===37&&ys(t.charCodeAt(r+1))&&ys(t.charCodeAt(r+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(i=String.fromCharCode(s));else if(s>55295&&s<57344){const l=t.charCodeAt(r+1);s<56320&&l>56319&&l<57344?(i=String.fromCharCode(s,l),a=1):i=""}else i=String.fromCharCode(s);i&&(e.push(t.slice(n,r),encodeURIComponent(i)),n=r+a+1,i=""),a&&(r+=a,a=0)}return e.join("")+t.slice(n)}function Sn(t,e,r,n){const a=n?n-1:Number.POSITIVE_INFINITY;let s=0;return i;function i(c){return un(c)?(t.enter(r),l(c)):e(c)}function l(c){return un(c)&&s++<a?(t.consume(c),l):(t.exit(r),e(c))}}const _V={tokenize:AV};function AV(t){const e=t.attempt(this.parser.constructs.contentInitial,n,a);let r;return e;function n(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Sn(t,e,"linePrefix")}function a(l){return t.enter("paragraph"),s(l)}function s(l){const c=t.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=c),r=c,i(l)}function i(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Ir(l)?(t.consume(l),t.exit("chunkText"),s):(t.consume(l),i)}}const NV={tokenize:PV},U_={tokenize:IV};function PV(t){const e=this,r=[];let n=0,a,s,i;return l;function l(P){if(n<r.length){const F=r[n];return e.containerState=F[1],t.attempt(F[0].continuation,c,d)(P)}return d(P)}function c(P){if(n++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,a&&_();const F=e.events.length;let D=F,B;for(;D--;)if(e.events[D][0]==="exit"&&e.events[D][1].type==="chunkFlow"){B=e.events[D][1].end;break}k(n);let M=F;for(;M<e.events.length;)e.events[M][1].end={...B},M++;return Ai(e.events,D+1,0,e.events.slice(F)),e.events.length=M,d(P)}return l(P)}function d(P){if(n===r.length){if(!a)return m(P);if(a.currentConstruct&&a.currentConstruct.concrete)return x(P);e.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(U_,p,g)(P)}function p(P){return a&&_(),k(n),m(P)}function g(P){return e.parser.lazy[e.now().line]=n!==r.length,i=e.now().offset,x(P)}function m(P){return e.containerState={},t.attempt(U_,y,x)(P)}function y(P){return n++,r.push([e.currentConstruct,e.containerState]),m(P)}function x(P){if(P===null){a&&_(),k(0),t.consume(P);return}return a=a||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),w(P)}function w(P){if(P===null){T(t.exit("chunkFlow"),!0),k(0),t.consume(P);return}return Ir(P)?(t.consume(P),T(t.exit("chunkFlow")),n=0,e.interrupt=void 0,l):(t.consume(P),w)}function T(P,F){const D=e.sliceStream(P);if(F&&D.push(null),P.previous=s,s&&(s.next=P),s=P,a.defineSkip(P.start),a.write(D),e.parser.lazy[P.start.line]){let B=a.events.length;for(;B--;)if(a.events[B][1].start.offset<i&&(!a.events[B][1].end||a.events[B][1].end.offset>i))return;const M=e.events.length;let $=M,Z,z;for(;$--;)if(e.events[$][0]==="exit"&&e.events[$][1].type==="chunkFlow"){if(Z){z=e.events[$][1].end;break}Z=!0}for(k(n),B=M;B<e.events.length;)e.events[B][1].end={...z},B++;Ai(e.events,$+1,0,e.events.slice(M)),e.events.length=B}}function k(P){let F=r.length;for(;F-- >P;){const D=r[F];e.containerState=D[1],D[0].exit.call(e,t)}r.length=P}function _(){a.write([null]),s=void 0,a=void 0,e.containerState._closeFlow=void 0}}function IV(t,e,r){return Sn(t,t.attempt(this.parser.constructs.document,e,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function dh(t){if(t===null||Qn(t)||Iu(t))return 1;if(zy(t))return 2}function $y(t,e,r){const n=[];let a=-1;for(;++a<t.length;){const s=t[a].resolveAll;s&&!n.includes(s)&&(e=s(e,r),n.push(s))}return e}const t1={name:"attention",resolveAll:RV,tokenize:DV};function RV(t,e){let r=-1,n,a,s,i,l,c,d,p;for(;++r<t.length;)if(t[r][0]==="enter"&&t[r][1].type==="attentionSequence"&&t[r][1]._close){for(n=r;n--;)if(t[n][0]==="exit"&&t[n][1].type==="attentionSequence"&&t[n][1]._open&&e.sliceSerialize(t[n][1]).charCodeAt(0)===e.sliceSerialize(t[r][1]).charCodeAt(0)){if((t[n][1]._close||t[r][1]._open)&&(t[r][1].end.offset-t[r][1].start.offset)%3&&!((t[n][1].end.offset-t[n][1].start.offset+t[r][1].end.offset-t[r][1].start.offset)%3))continue;c=t[n][1].end.offset-t[n][1].start.offset>1&&t[r][1].end.offset-t[r][1].start.offset>1?2:1;const g={...t[n][1].end},m={...t[r][1].start};q_(g,-c),q_(m,c),i={type:c>1?"strongSequence":"emphasisSequence",start:g,end:{...t[n][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[r][1].start},end:m},s={type:c>1?"strongText":"emphasisText",start:{...t[n][1].end},end:{...t[r][1].start}},a={type:c>1?"strong":"emphasis",start:{...i.start},end:{...l.end}},t[n][1].end={...i.start},t[r][1].start={...l.end},d=[],t[n][1].end.offset-t[n][1].start.offset&&(d=Vi(d,[["enter",t[n][1],e],["exit",t[n][1],e]])),d=Vi(d,[["enter",a,e],["enter",i,e],["exit",i,e],["enter",s,e]]),d=Vi(d,$y(e.parser.constructs.insideSpan.null,t.slice(n+1,r),e)),d=Vi(d,[["exit",s,e],["enter",l,e],["exit",l,e],["exit",a,e]]),t[r][1].end.offset-t[r][1].start.offset?(p=2,d=Vi(d,[["enter",t[r][1],e],["exit",t[r][1],e]])):p=0,Ai(t,n-1,r-n+3,d),r=n+d.length-p-2;break}}for(r=-1;++r<t.length;)t[r][1].type==="attentionSequence"&&(t[r][1].type="data");return t}function DV(t,e){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,a=dh(n);let s;return i;function i(c){return s=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===s)return t.consume(c),l;const d=t.exit("attentionSequence"),p=dh(c),g=!p||p===2&&a||r.includes(c),m=!a||a===2&&p||r.includes(n);return d._open=!!(s===42?g:g&&(a||!m)),d._close=!!(s===42?m:m&&(p||!g)),e(c)}}function q_(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const LV={name:"autolink",tokenize:MV};function MV(t,e,r){let n=0;return a;function a(y){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(y),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),s}function s(y){return Rs(y)?(t.consume(y),i):y===64?r(y):d(y)}function i(y){return y===43||y===45||y===46||ys(y)?(n=1,l(y)):d(y)}function l(y){return y===58?(t.consume(y),n=0,c):(y===43||y===45||y===46||ys(y))&&n++<32?(t.consume(y),l):(n=0,d(y))}function c(y){return y===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(y),t.exit("autolinkMarker"),t.exit("autolink"),e):y===null||y===32||y===60||O0(y)?r(y):(t.consume(y),c)}function d(y){return y===64?(t.consume(y),p):TV(y)?(t.consume(y),d):r(y)}function p(y){return ys(y)?g(y):r(y)}function g(y){return y===46?(t.consume(y),n=0,p):y===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(y),t.exit("autolinkMarker"),t.exit("autolink"),e):m(y)}function m(y){if((y===45||ys(y))&&n++<63){const x=y===45?m:g;return t.consume(y),x}return r(y)}}const sf={partial:!0,tokenize:OV};function OV(t,e,r){return n;function n(s){return un(s)?Sn(t,a,"linePrefix")(s):a(s)}function a(s){return s===null||Ir(s)?e(s):r(s)}}const YI={continuation:{tokenize:BV},exit:FV,name:"blockQuote",tokenize:jV};function jV(t,e,r){const n=this;return a;function a(i){if(i===62){const l=n.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(i),t.exit("blockQuoteMarker"),s}return r(i)}function s(i){return un(i)?(t.enter("blockQuotePrefixWhitespace"),t.consume(i),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(i))}}function BV(t,e,r){const n=this;return a;function a(i){return un(i)?Sn(t,s,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(i):s(i)}function s(i){return t.attempt(YI,e,r)(i)}}function FV(t){t.exit("blockQuote")}const QI={name:"characterEscape",tokenize:zV};function zV(t,e,r){return n;function n(s){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(s),t.exit("escapeMarker"),a}function a(s){return EV(s)?(t.enter("characterEscapeValue"),t.consume(s),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):r(s)}}const KI={name:"characterReference",tokenize:$V};function $V(t,e,r){const n=this;let a=0,s,i;return l;function l(g){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),c}function c(g){return g===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(g),t.exit("characterReferenceMarkerNumeric"),d):(t.enter("characterReferenceValue"),s=31,i=ys,p(g))}function d(g){return g===88||g===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(g),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),s=6,i=CV,p):(t.enter("characterReferenceValue"),s=7,i=e1,p(g))}function p(g){if(g===59&&a){const m=t.exit("characterReferenceValue");return i===ys&&!MS(n.sliceSerialize(m))?r(g):(t.enter("characterReferenceMarker"),t.consume(g),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return i(g)&&a++<s?(t.consume(g),p):r(g)}}const H_={partial:!0,tokenize:qV},G_={concrete:!0,name:"codeFenced",tokenize:UV};function UV(t,e,r){const n=this,a={partial:!0,tokenize:D};let s=0,i=0,l;return c;function c(B){return d(B)}function d(B){const M=n.events[n.events.length-1];return s=M&&M[1].type==="linePrefix"?M[2].sliceSerialize(M[1],!0).length:0,l=B,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),p(B)}function p(B){return B===l?(i++,t.consume(B),p):i<3?r(B):(t.exit("codeFencedFenceSequence"),un(B)?Sn(t,g,"whitespace")(B):g(B))}function g(B){return B===null||Ir(B)?(t.exit("codeFencedFence"),n.interrupt?e(B):t.check(H_,w,F)(B)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),m(B))}function m(B){return B===null||Ir(B)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),g(B)):un(B)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Sn(t,y,"whitespace")(B)):B===96&&B===l?r(B):(t.consume(B),m)}function y(B){return B===null||Ir(B)?g(B):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),x(B))}function x(B){return B===null||Ir(B)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),g(B)):B===96&&B===l?r(B):(t.consume(B),x)}function w(B){return t.attempt(a,F,T)(B)}function T(B){return t.enter("lineEnding"),t.consume(B),t.exit("lineEnding"),k}function k(B){return s>0&&un(B)?Sn(t,_,"linePrefix",s+1)(B):_(B)}function _(B){return B===null||Ir(B)?t.check(H_,w,F)(B):(t.enter("codeFlowValue"),P(B))}function P(B){return B===null||Ir(B)?(t.exit("codeFlowValue"),_(B)):(t.consume(B),P)}function F(B){return t.exit("codeFenced"),e(B)}function D(B,M,$){let Z=0;return z;function z(W){return B.enter("lineEnding"),B.consume(W),B.exit("lineEnding"),ee}function ee(W){return B.enter("codeFencedFence"),un(W)?Sn(B,te,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(W):te(W)}function te(W){return W===l?(B.enter("codeFencedFenceSequence"),X(W)):$(W)}function X(W){return W===l?(Z++,B.consume(W),X):Z>=i?(B.exit("codeFencedFenceSequence"),un(W)?Sn(B,Q,"whitespace")(W):Q(W)):$(W)}function Q(W){return W===null||Ir(W)?(B.exit("codeFencedFence"),M(W)):$(W)}}}function qV(t,e,r){const n=this;return a;function a(i){return i===null?r(i):(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),s)}function s(i){return n.parser.lazy[n.now().line]?r(i):e(i)}}const Iv={name:"codeIndented",tokenize:GV},HV={partial:!0,tokenize:VV};function GV(t,e,r){const n=this;return a;function a(d){return t.enter("codeIndented"),Sn(t,s,"linePrefix",5)(d)}function s(d){const p=n.events[n.events.length-1];return p&&p[1].type==="linePrefix"&&p[2].sliceSerialize(p[1],!0).length>=4?i(d):r(d)}function i(d){return d===null?c(d):Ir(d)?t.attempt(HV,i,c)(d):(t.enter("codeFlowValue"),l(d))}function l(d){return d===null||Ir(d)?(t.exit("codeFlowValue"),i(d)):(t.consume(d),l)}function c(d){return t.exit("codeIndented"),e(d)}}function VV(t,e,r){const n=this;return a;function a(i){return n.parser.lazy[n.now().line]?r(i):Ir(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),a):Sn(t,s,"linePrefix",5)(i)}function s(i){const l=n.events[n.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(i):Ir(i)?a(i):r(i)}}const WV={name:"codeText",previous:QV,resolve:YV,tokenize:KV};function YV(t){let e=t.length-4,r=3,n,a;if((t[r][1].type==="lineEnding"||t[r][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(n=r;++n<e;)if(t[n][1].type==="codeTextData"){t[r][1].type="codeTextPadding",t[e][1].type="codeTextPadding",r+=2,e-=2;break}}for(n=r-1,e++;++n<=e;)a===void 0?n!==e&&t[n][1].type!=="lineEnding"&&(a=n):(n===e||t[n][1].type==="lineEnding")&&(t[a][1].type="codeTextData",n!==a+2&&(t[a][1].end=t[n-1][1].end,t.splice(a+2,n-a-2),e-=n-a-2,n=a+2),a=void 0);return t}function QV(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function KV(t,e,r){let n=0,a,s;return i;function i(g){return t.enter("codeText"),t.enter("codeTextSequence"),l(g)}function l(g){return g===96?(t.consume(g),n++,l):(t.exit("codeTextSequence"),c(g))}function c(g){return g===null?r(g):g===32?(t.enter("space"),t.consume(g),t.exit("space"),c):g===96?(s=t.enter("codeTextSequence"),a=0,p(g)):Ir(g)?(t.enter("lineEnding"),t.consume(g),t.exit("lineEnding"),c):(t.enter("codeTextData"),d(g))}function d(g){return g===null||g===32||g===96||Ir(g)?(t.exit("codeTextData"),c(g)):(t.consume(g),d)}function p(g){return g===96?(t.consume(g),a++,p):a===n?(t.exit("codeTextSequence"),t.exit("codeText"),e(g)):(s.type="codeTextData",d(g))}}class XV{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,r,n){const a=r||0;this.setCursor(Math.trunc(e));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return n&&Rp(this.left,n),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Rp(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Rp(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const r=this.left.splice(e,Number.POSITIVE_INFINITY);Rp(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Rp(this.left,r.reverse())}}}function Rp(t,e){let r=0;if(e.length<1e4)t.push(...e);else for(;r<e.length;)t.push(...e.slice(r,r+1e4)),r+=1e4}function XI(t){const e={};let r=-1,n,a,s,i,l,c,d;const p=new XV(t);for(;++r<p.length;){for(;r in e;)r=e[r];if(n=p.get(r),r&&n[1].type==="chunkFlow"&&p.get(r-1)[1].type==="listItemPrefix"&&(c=n[1]._tokenizer.events,s=0,s<c.length&&c[s][1].type==="lineEndingBlank"&&(s+=2),s<c.length&&c[s][1].type==="content"))for(;++s<c.length&&c[s][1].type!=="content";)c[s][1].type==="chunkText"&&(c[s][1]._isInFirstContentOfListItem=!0,s++);if(n[0]==="enter")n[1].contentType&&(Object.assign(e,JV(p,r)),r=e[r],d=!0);else if(n[1]._container){for(s=r,a=void 0;s--;)if(i=p.get(s),i[1].type==="lineEnding"||i[1].type==="lineEndingBlank")i[0]==="enter"&&(a&&(p.get(a)[1].type="lineEndingBlank"),i[1].type="lineEnding",a=s);else if(!(i[1].type==="linePrefix"||i[1].type==="listItemIndent"))break;a&&(n[1].end={...p.get(a)[1].start},l=p.slice(a,r),l.unshift(n),p.splice(a,r-a+1,l))}}return Ai(t,0,Number.POSITIVE_INFINITY,p.slice(0)),!d}function JV(t,e){const r=t.get(e)[1],n=t.get(e)[2];let a=e-1;const s=[];let i=r._tokenizer;i||(i=n.parser[r.contentType](r.start),r._contentTypeTextTrailing&&(i._contentTypeTextTrailing=!0));const l=i.events,c=[],d={};let p,g,m=-1,y=r,x=0,w=0;const T=[w];for(;y;){for(;t.get(++a)[1]!==y;);s.push(a),y._tokenizer||(p=n.sliceStream(y),y.next||p.push(null),g&&i.defineSkip(y.start),y._isInFirstContentOfListItem&&(i._gfmTasklistFirstContentOfListItem=!0),i.write(p),y._isInFirstContentOfListItem&&(i._gfmTasklistFirstContentOfListItem=void 0)),g=y,y=y.next}for(y=r;++m<l.length;)l[m][0]==="exit"&&l[m-1][0]==="enter"&&l[m][1].type===l[m-1][1].type&&l[m][1].start.line!==l[m][1].end.line&&(w=m+1,T.push(w),y._tokenizer=void 0,y.previous=void 0,y=y.next);for(i.events=[],y?(y._tokenizer=void 0,y.previous=void 0):T.pop(),m=T.length;m--;){const k=l.slice(T[m],T[m+1]),_=s.pop();c.push([_,_+k.length-1]),t.splice(_,2,k)}for(c.reverse(),m=-1;++m<c.length;)d[x+c[m][0]]=x+c[m][1],x+=c[m][1]-c[m][0]-1;return d}const ZV={resolve:tW,tokenize:rW},eW={partial:!0,tokenize:nW};function tW(t){return XI(t),t}function rW(t,e){let r;return n;function n(l){return t.enter("content"),r=t.enter("chunkContent",{contentType:"content"}),a(l)}function a(l){return l===null?s(l):Ir(l)?t.check(eW,i,s)(l):(t.consume(l),a)}function s(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function i(l){return t.consume(l),t.exit("chunkContent"),r.next=t.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,a}}function nW(t,e,r){const n=this;return a;function a(i){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),Sn(t,s,"linePrefix")}function s(i){if(i===null||Ir(i))return r(i);const l=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(i):t.interrupt(n.parser.constructs.flow,r,e)(i)}}function JI(t,e,r,n,a,s,i,l,c){const d=c||Number.POSITIVE_INFINITY;let p=0;return g;function g(k){return k===60?(t.enter(n),t.enter(a),t.enter(s),t.consume(k),t.exit(s),m):k===null||k===32||k===41||O0(k)?r(k):(t.enter(n),t.enter(i),t.enter(l),t.enter("chunkString",{contentType:"string"}),w(k))}function m(k){return k===62?(t.enter(s),t.consume(k),t.exit(s),t.exit(a),t.exit(n),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),y(k))}function y(k){return k===62?(t.exit("chunkString"),t.exit(l),m(k)):k===null||k===60||Ir(k)?r(k):(t.consume(k),k===92?x:y)}function x(k){return k===60||k===62||k===92?(t.consume(k),y):y(k)}function w(k){return!p&&(k===null||k===41||Qn(k))?(t.exit("chunkString"),t.exit(l),t.exit(i),t.exit(n),e(k)):p<d&&k===40?(t.consume(k),p++,w):k===41?(t.consume(k),p--,w):k===null||k===32||k===40||O0(k)?r(k):(t.consume(k),k===92?T:w)}function T(k){return k===40||k===41||k===92?(t.consume(k),w):w(k)}}function ZI(t,e,r,n,a,s){const i=this;let l=0,c;return d;function d(y){return t.enter(n),t.enter(a),t.consume(y),t.exit(a),t.enter(s),p}function p(y){return l>999||y===null||y===91||y===93&&!c||y===94&&!l&&"_hiddenFootnoteSupport"in i.parser.constructs?r(y):y===93?(t.exit(s),t.enter(a),t.consume(y),t.exit(a),t.exit(n),e):Ir(y)?(t.enter("lineEnding"),t.consume(y),t.exit("lineEnding"),p):(t.enter("chunkString",{contentType:"string"}),g(y))}function g(y){return y===null||y===91||y===93||Ir(y)||l++>999?(t.exit("chunkString"),p(y)):(t.consume(y),c||(c=!un(y)),y===92?m:g)}function m(y){return y===91||y===92||y===93?(t.consume(y),l++,g):g(y)}}function eR(t,e,r,n,a,s){let i;return l;function l(m){return m===34||m===39||m===40?(t.enter(n),t.enter(a),t.consume(m),t.exit(a),i=m===40?41:m,c):r(m)}function c(m){return m===i?(t.enter(a),t.consume(m),t.exit(a),t.exit(n),e):(t.enter(s),d(m))}function d(m){return m===i?(t.exit(s),c(i)):m===null?r(m):Ir(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),Sn(t,d,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),p(m))}function p(m){return m===i||m===null||Ir(m)?(t.exit("chunkString"),d(m)):(t.consume(m),m===92?g:p)}function g(m){return m===i||m===92?(t.consume(m),p):p(m)}}function pg(t,e){let r;return n;function n(a){return Ir(a)?(t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),r=!0,n):un(a)?Sn(t,n,r?"linePrefix":"lineSuffix")(a):e(a)}}const aW={name:"definition",tokenize:iW},sW={partial:!0,tokenize:oW};function iW(t,e,r){const n=this;let a;return s;function s(y){return t.enter("definition"),i(y)}function i(y){return ZI.call(n,t,l,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(y)}function l(y){return a=fo(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),y===58?(t.enter("definitionMarker"),t.consume(y),t.exit("definitionMarker"),c):r(y)}function c(y){return Qn(y)?pg(t,d)(y):d(y)}function d(y){return JI(t,p,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(y)}function p(y){return t.attempt(sW,g,g)(y)}function g(y){return un(y)?Sn(t,m,"whitespace")(y):m(y)}function m(y){return y===null||Ir(y)?(t.exit("definition"),n.parser.defined.push(a),e(y)):r(y)}}function oW(t,e,r){return n;function n(l){return Qn(l)?pg(t,a)(l):r(l)}function a(l){return eR(t,s,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function s(l){return un(l)?Sn(t,i,"whitespace")(l):i(l)}function i(l){return l===null||Ir(l)?e(l):r(l)}}const lW={name:"hardBreakEscape",tokenize:cW};function cW(t,e,r){return n;function n(s){return t.enter("hardBreakEscape"),t.consume(s),a}function a(s){return Ir(s)?(t.exit("hardBreakEscape"),e(s)):r(s)}}const uW={name:"headingAtx",resolve:dW,tokenize:hW};function dW(t,e){let r=t.length-2,n=3,a,s;return t[n][1].type==="whitespace"&&(n+=2),r-2>n&&t[r][1].type==="whitespace"&&(r-=2),t[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&t[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(a={type:"atxHeadingText",start:t[n][1].start,end:t[r][1].end},s={type:"chunkText",start:t[n][1].start,end:t[r][1].end,contentType:"text"},Ai(t,n,r-n+1,[["enter",a,e],["enter",s,e],["exit",s,e],["exit",a,e]])),t}function hW(t,e,r){let n=0;return a;function a(p){return t.enter("atxHeading"),s(p)}function s(p){return t.enter("atxHeadingSequence"),i(p)}function i(p){return p===35&&n++<6?(t.consume(p),i):p===null||Qn(p)?(t.exit("atxHeadingSequence"),l(p)):r(p)}function l(p){return p===35?(t.enter("atxHeadingSequence"),c(p)):p===null||Ir(p)?(t.exit("atxHeading"),e(p)):un(p)?Sn(t,l,"whitespace")(p):(t.enter("atxHeadingText"),d(p))}function c(p){return p===35?(t.consume(p),c):(t.exit("atxHeadingSequence"),l(p))}function d(p){return p===null||p===35||Qn(p)?(t.exit("atxHeadingText"),l(p)):(t.consume(p),d)}}const pW=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],V_=["pre","script","style","textarea"],gW={concrete:!0,name:"htmlFlow",resolveTo:yW,tokenize:bW},fW={partial:!0,tokenize:vW},mW={partial:!0,tokenize:xW};function yW(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function bW(t,e,r){const n=this;let a,s,i,l,c;return d;function d(U){return p(U)}function p(U){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(U),g}function g(U){return U===33?(t.consume(U),m):U===47?(t.consume(U),s=!0,w):U===63?(t.consume(U),a=3,n.interrupt?e:O):Rs(U)?(t.consume(U),i=String.fromCharCode(U),T):r(U)}function m(U){return U===45?(t.consume(U),a=2,y):U===91?(t.consume(U),a=5,l=0,x):Rs(U)?(t.consume(U),a=4,n.interrupt?e:O):r(U)}function y(U){return U===45?(t.consume(U),n.interrupt?e:O):r(U)}function x(U){const ce="CDATA[";return U===ce.charCodeAt(l++)?(t.consume(U),l===ce.length?n.interrupt?e:te:x):r(U)}function w(U){return Rs(U)?(t.consume(U),i=String.fromCharCode(U),T):r(U)}function T(U){if(U===null||U===47||U===62||Qn(U)){const ce=U===47,ye=i.toLowerCase();return!ce&&!s&&V_.includes(ye)?(a=1,n.interrupt?e(U):te(U)):pW.includes(i.toLowerCase())?(a=6,ce?(t.consume(U),k):n.interrupt?e(U):te(U)):(a=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(U):s?_(U):P(U))}return U===45||ys(U)?(t.consume(U),i+=String.fromCharCode(U),T):r(U)}function k(U){return U===62?(t.consume(U),n.interrupt?e:te):r(U)}function _(U){return un(U)?(t.consume(U),_):z(U)}function P(U){return U===47?(t.consume(U),z):U===58||U===95||Rs(U)?(t.consume(U),F):un(U)?(t.consume(U),P):z(U)}function F(U){return U===45||U===46||U===58||U===95||ys(U)?(t.consume(U),F):D(U)}function D(U){return U===61?(t.consume(U),B):un(U)?(t.consume(U),D):P(U)}function B(U){return U===null||U===60||U===61||U===62||U===96?r(U):U===34||U===39?(t.consume(U),c=U,M):un(U)?(t.consume(U),B):$(U)}function M(U){return U===c?(t.consume(U),c=null,Z):U===null||Ir(U)?r(U):(t.consume(U),M)}function $(U){return U===null||U===34||U===39||U===47||U===60||U===61||U===62||U===96||Qn(U)?D(U):(t.consume(U),$)}function Z(U){return U===47||U===62||un(U)?P(U):r(U)}function z(U){return U===62?(t.consume(U),ee):r(U)}function ee(U){return U===null||Ir(U)?te(U):un(U)?(t.consume(U),ee):r(U)}function te(U){return U===45&&a===2?(t.consume(U),H):U===60&&a===1?(t.consume(U),re):U===62&&a===4?(t.consume(U),I):U===63&&a===3?(t.consume(U),O):U===93&&a===5?(t.consume(U),ve):Ir(U)&&(a===6||a===7)?(t.exit("htmlFlowData"),t.check(fW,K,X)(U)):U===null||Ir(U)?(t.exit("htmlFlowData"),X(U)):(t.consume(U),te)}function X(U){return t.check(mW,Q,K)(U)}function Q(U){return t.enter("lineEnding"),t.consume(U),t.exit("lineEnding"),W}function W(U){return U===null||Ir(U)?X(U):(t.enter("htmlFlowData"),te(U))}function H(U){return U===45?(t.consume(U),O):te(U)}function re(U){return U===47?(t.consume(U),i="",ne):te(U)}function ne(U){if(U===62){const ce=i.toLowerCase();return V_.includes(ce)?(t.consume(U),I):te(U)}return Rs(U)&&i.length<8?(t.consume(U),i+=String.fromCharCode(U),ne):te(U)}function ve(U){return U===93?(t.consume(U),O):te(U)}function O(U){return U===62?(t.consume(U),I):U===45&&a===2?(t.consume(U),O):te(U)}function I(U){return U===null||Ir(U)?(t.exit("htmlFlowData"),K(U)):(t.consume(U),I)}function K(U){return t.exit("htmlFlow"),e(U)}}function xW(t,e,r){const n=this;return a;function a(i){return Ir(i)?(t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),s):r(i)}function s(i){return n.parser.lazy[n.now().line]?r(i):e(i)}}function vW(t,e,r){return n;function n(a){return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),t.attempt(sf,e,r)}}const wW={name:"htmlText",tokenize:SW};function SW(t,e,r){const n=this;let a,s,i;return l;function l(O){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(O),c}function c(O){return O===33?(t.consume(O),d):O===47?(t.consume(O),D):O===63?(t.consume(O),P):Rs(O)?(t.consume(O),$):r(O)}function d(O){return O===45?(t.consume(O),p):O===91?(t.consume(O),s=0,x):Rs(O)?(t.consume(O),_):r(O)}function p(O){return O===45?(t.consume(O),y):r(O)}function g(O){return O===null?r(O):O===45?(t.consume(O),m):Ir(O)?(i=g,re(O)):(t.consume(O),g)}function m(O){return O===45?(t.consume(O),y):g(O)}function y(O){return O===62?H(O):O===45?m(O):g(O)}function x(O){const I="CDATA[";return O===I.charCodeAt(s++)?(t.consume(O),s===I.length?w:x):r(O)}function w(O){return O===null?r(O):O===93?(t.consume(O),T):Ir(O)?(i=w,re(O)):(t.consume(O),w)}function T(O){return O===93?(t.consume(O),k):w(O)}function k(O){return O===62?H(O):O===93?(t.consume(O),k):w(O)}function _(O){return O===null||O===62?H(O):Ir(O)?(i=_,re(O)):(t.consume(O),_)}function P(O){return O===null?r(O):O===63?(t.consume(O),F):Ir(O)?(i=P,re(O)):(t.consume(O),P)}function F(O){return O===62?H(O):P(O)}function D(O){return Rs(O)?(t.consume(O),B):r(O)}function B(O){return O===45||ys(O)?(t.consume(O),B):M(O)}function M(O){return Ir(O)?(i=M,re(O)):un(O)?(t.consume(O),M):H(O)}function $(O){return O===45||ys(O)?(t.consume(O),$):O===47||O===62||Qn(O)?Z(O):r(O)}function Z(O){return O===47?(t.consume(O),H):O===58||O===95||Rs(O)?(t.consume(O),z):Ir(O)?(i=Z,re(O)):un(O)?(t.consume(O),Z):H(O)}function z(O){return O===45||O===46||O===58||O===95||ys(O)?(t.consume(O),z):ee(O)}function ee(O){return O===61?(t.consume(O),te):Ir(O)?(i=ee,re(O)):un(O)?(t.consume(O),ee):Z(O)}function te(O){return O===null||O===60||O===61||O===62||O===96?r(O):O===34||O===39?(t.consume(O),a=O,X):Ir(O)?(i=te,re(O)):un(O)?(t.consume(O),te):(t.consume(O),Q)}function X(O){return O===a?(t.consume(O),a=void 0,W):O===null?r(O):Ir(O)?(i=X,re(O)):(t.consume(O),X)}function Q(O){return O===null||O===34||O===39||O===60||O===61||O===96?r(O):O===47||O===62||Qn(O)?Z(O):(t.consume(O),Q)}function W(O){return O===47||O===62||Qn(O)?Z(O):r(O)}function H(O){return O===62?(t.consume(O),t.exit("htmlTextData"),t.exit("htmlText"),e):r(O)}function re(O){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(O),t.exit("lineEnding"),ne}function ne(O){return un(O)?Sn(t,ve,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):ve(O)}function ve(O){return t.enter("htmlTextData"),i(O)}}const OS={name:"labelEnd",resolveAll:EW,resolveTo:_W,tokenize:AW},kW={tokenize:NW},TW={tokenize:PW},CW={tokenize:IW};function EW(t){let e=-1;const r=[];for(;++e<t.length;){const n=t[e][1];if(r.push(t[e]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const a=n.type==="labelImage"?4:2;n.type="data",e+=a}}return t.length!==r.length&&Ai(t,0,t.length,r),t}function _W(t,e){let r=t.length,n=0,a,s,i,l;for(;r--;)if(a=t[r][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;t[r][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(i){if(t[r][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=r,a.type!=="labelLink")){n=2;break}}else a.type==="labelEnd"&&(i=r);const c={type:t[s][1].type==="labelLink"?"link":"image",start:{...t[s][1].start},end:{...t[t.length-1][1].end}},d={type:"label",start:{...t[s][1].start},end:{...t[i][1].end}},p={type:"labelText",start:{...t[s+n+2][1].end},end:{...t[i-2][1].start}};return l=[["enter",c,e],["enter",d,e]],l=Vi(l,t.slice(s+1,s+n+3)),l=Vi(l,[["enter",p,e]]),l=Vi(l,$y(e.parser.constructs.insideSpan.null,t.slice(s+n+4,i-3),e)),l=Vi(l,[["exit",p,e],t[i-2],t[i-1],["exit",d,e]]),l=Vi(l,t.slice(i+1)),l=Vi(l,[["exit",c,e]]),Ai(t,s,t.length,l),t}function AW(t,e,r){const n=this;let a=n.events.length,s,i;for(;a--;)if((n.events[a][1].type==="labelImage"||n.events[a][1].type==="labelLink")&&!n.events[a][1]._balanced){s=n.events[a][1];break}return l;function l(m){return s?s._inactive?g(m):(i=n.parser.defined.includes(fo(n.sliceSerialize({start:s.end,end:n.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(m),t.exit("labelMarker"),t.exit("labelEnd"),c):r(m)}function c(m){return m===40?t.attempt(kW,p,i?p:g)(m):m===91?t.attempt(TW,p,i?d:g)(m):i?p(m):g(m)}function d(m){return t.attempt(CW,p,g)(m)}function p(m){return e(m)}function g(m){return s._balanced=!0,r(m)}}function NW(t,e,r){return n;function n(g){return t.enter("resource"),t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),a}function a(g){return Qn(g)?pg(t,s)(g):s(g)}function s(g){return g===41?p(g):JI(t,i,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(g)}function i(g){return Qn(g)?pg(t,c)(g):p(g)}function l(g){return r(g)}function c(g){return g===34||g===39||g===40?eR(t,d,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(g):p(g)}function d(g){return Qn(g)?pg(t,p)(g):p(g)}function p(g){return g===41?(t.enter("resourceMarker"),t.consume(g),t.exit("resourceMarker"),t.exit("resource"),e):r(g)}}function PW(t,e,r){const n=this;return a;function a(l){return ZI.call(n,t,s,i,"reference","referenceMarker","referenceString")(l)}function s(l){return n.parser.defined.includes(fo(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?e(l):r(l)}function i(l){return r(l)}}function IW(t,e,r){return n;function n(s){return t.enter("reference"),t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),a}function a(s){return s===93?(t.enter("referenceMarker"),t.consume(s),t.exit("referenceMarker"),t.exit("reference"),e):r(s)}}const RW={name:"labelStartImage",resolveAll:OS.resolveAll,tokenize:DW};function DW(t,e,r){const n=this;return a;function a(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),s}function s(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),i):r(l)}function i(l){return l===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(l):e(l)}}const LW={name:"labelStartLink",resolveAll:OS.resolveAll,tokenize:MW};function MW(t,e,r){const n=this;return a;function a(i){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(i),t.exit("labelMarker"),t.exit("labelLink"),s}function s(i){return i===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(i):e(i)}}const Rv={name:"lineEnding",tokenize:OW};function OW(t,e){return r;function r(n){return t.enter("lineEnding"),t.consume(n),t.exit("lineEnding"),Sn(t,e,"linePrefix")}}const s0={name:"thematicBreak",tokenize:jW};function jW(t,e,r){let n=0,a;return s;function s(d){return t.enter("thematicBreak"),i(d)}function i(d){return a=d,l(d)}function l(d){return d===a?(t.enter("thematicBreakSequence"),c(d)):n>=3&&(d===null||Ir(d))?(t.exit("thematicBreak"),e(d)):r(d)}function c(d){return d===a?(t.consume(d),n++,c):(t.exit("thematicBreakSequence"),un(d)?Sn(t,l,"whitespace")(d):l(d))}}const ri={continuation:{tokenize:$W},exit:qW,name:"list",tokenize:zW},BW={partial:!0,tokenize:HW},FW={partial:!0,tokenize:UW};function zW(t,e,r){const n=this,a=n.events[n.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,i=0;return l;function l(y){const x=n.containerState.type||(y===42||y===43||y===45?"listUnordered":"listOrdered");if(x==="listUnordered"?!n.containerState.marker||y===n.containerState.marker:e1(y)){if(n.containerState.type||(n.containerState.type=x,t.enter(x,{_container:!0})),x==="listUnordered")return t.enter("listItemPrefix"),y===42||y===45?t.check(s0,r,d)(y):d(y);if(!n.interrupt||y===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(y)}return r(y)}function c(y){return e1(y)&&++i<10?(t.consume(y),c):(!n.interrupt||i<2)&&(n.containerState.marker?y===n.containerState.marker:y===41||y===46)?(t.exit("listItemValue"),d(y)):r(y)}function d(y){return t.enter("listItemMarker"),t.consume(y),t.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||y,t.check(sf,n.interrupt?r:p,t.attempt(BW,m,g))}function p(y){return n.containerState.initialBlankLine=!0,s++,m(y)}function g(y){return un(y)?(t.enter("listItemPrefixWhitespace"),t.consume(y),t.exit("listItemPrefixWhitespace"),m):r(y)}function m(y){return n.containerState.size=s+n.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(y)}}function $W(t,e,r){const n=this;return n.containerState._closeFlow=void 0,t.check(sf,a,s);function a(l){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,Sn(t,e,"listItemIndent",n.containerState.size+1)(l)}function s(l){return n.containerState.furtherBlankLines||!un(l)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,i(l)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,t.attempt(FW,e,i)(l))}function i(l){return n.containerState._closeFlow=!0,n.interrupt=void 0,Sn(t,t.attempt(ri,e,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function UW(t,e,r){const n=this;return Sn(t,a,"listItemIndent",n.containerState.size+1);function a(s){const i=n.events[n.events.length-1];return i&&i[1].type==="listItemIndent"&&i[2].sliceSerialize(i[1],!0).length===n.containerState.size?e(s):r(s)}}function qW(t){t.exit(this.containerState.type)}function HW(t,e,r){const n=this;return Sn(t,a,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const i=n.events[n.events.length-1];return!un(s)&&i&&i[1].type==="listItemPrefixWhitespace"?e(s):r(s)}}const W_={name:"setextUnderline",resolveTo:GW,tokenize:VW};function GW(t,e){let r=t.length,n,a,s;for(;r--;)if(t[r][0]==="enter"){if(t[r][1].type==="content"){n=r;break}t[r][1].type==="paragraph"&&(a=r)}else t[r][1].type==="content"&&t.splice(r,1),!s&&t[r][1].type==="definition"&&(s=r);const i={type:"setextHeading",start:{...t[n][1].start},end:{...t[t.length-1][1].end}};return t[a][1].type="setextHeadingText",s?(t.splice(a,0,["enter",i,e]),t.splice(s+1,0,["exit",t[n][1],e]),t[n][1].end={...t[s][1].end}):t[n][1]=i,t.push(["exit",i,e]),t}function VW(t,e,r){const n=this;let a;return s;function s(d){let p=n.events.length,g;for(;p--;)if(n.events[p][1].type!=="lineEnding"&&n.events[p][1].type!=="linePrefix"&&n.events[p][1].type!=="content"){g=n.events[p][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||g)?(t.enter("setextHeadingLine"),a=d,i(d)):r(d)}function i(d){return t.enter("setextHeadingLineSequence"),l(d)}function l(d){return d===a?(t.consume(d),l):(t.exit("setextHeadingLineSequence"),un(d)?Sn(t,c,"lineSuffix")(d):c(d))}function c(d){return d===null||Ir(d)?(t.exit("setextHeadingLine"),e(d)):r(d)}}const WW={tokenize:YW};function YW(t){const e=this,r=t.attempt(sf,n,t.attempt(this.parser.constructs.flowInitial,a,Sn(t,t.attempt(this.parser.constructs.flow,a,t.attempt(ZV,a)),"linePrefix")));return r;function n(s){if(s===null){t.consume(s);return}return t.enter("lineEndingBlank"),t.consume(s),t.exit("lineEndingBlank"),e.currentConstruct=void 0,r}function a(s){if(s===null){t.consume(s);return}return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),e.currentConstruct=void 0,r}}const QW={resolveAll:rR()},KW=tR("string"),XW=tR("text");function tR(t){return{resolveAll:rR(t==="text"?JW:void 0),tokenize:e};function e(r){const n=this,a=this.parser.constructs[t],s=r.attempt(a,i,l);return i;function i(p){return d(p)?s(p):l(p)}function l(p){if(p===null){r.consume(p);return}return r.enter("data"),r.consume(p),c}function c(p){return d(p)?(r.exit("data"),s(p)):(r.consume(p),c)}function d(p){if(p===null)return!0;const g=a[p];let m=-1;if(g)for(;++m<g.length;){const y=g[m];if(!y.previous||y.previous.call(n,n.previous))return!0}return!1}}}function rR(t){return e;function e(r,n){let a=-1,s;for(;++a<=r.length;)s===void 0?r[a]&&r[a][1].type==="data"&&(s=a,a++):(!r[a]||r[a][1].type!=="data")&&(a!==s+2&&(r[s][1].end=r[a-1][1].end,r.splice(s+2,a-s-2),a=s+2),s=void 0);return t?t(r,n):r}}function JW(t,e){let r=0;for(;++r<=t.length;)if((r===t.length||t[r][1].type==="lineEnding")&&t[r-1][1].type==="data"){const n=t[r-1][1],a=e.sliceStream(n);let s=a.length,i=-1,l=0,c;for(;s--;){const d=a[s];if(typeof d=="string"){for(i=d.length;d.charCodeAt(i-1)===32;)l++,i--;if(i)break;i=-1}else if(d===-2)c=!0,l++;else if(d!==-1){s++;break}}if(e._contentTypeTextTrailing&&r===t.length&&(l=0),l){const d={type:r===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?i:n.start._bufferIndex+i,_index:n.start._index+s,line:n.end.line,column:n.end.column-l,offset:n.end.offset-l},end:{...n.end}};n.end={...d.start},n.start.offset===n.end.offset?Object.assign(n,d):(t.splice(r,0,["enter",d,e],["exit",d,e]),r+=2)}r++}return t}const ZW={42:ri,43:ri,45:ri,48:ri,49:ri,50:ri,51:ri,52:ri,53:ri,54:ri,55:ri,56:ri,57:ri,62:YI},eY={91:aW},tY={[-2]:Iv,[-1]:Iv,32:Iv},rY={35:uW,42:s0,45:[W_,s0],60:gW,61:W_,95:s0,96:G_,126:G_},nY={38:KI,92:QI},aY={[-5]:Rv,[-4]:Rv,[-3]:Rv,33:RW,38:KI,42:t1,60:[LV,wW],91:LW,92:[lW,QI],93:OS,95:t1,96:WV},sY={null:[t1,QW]},iY={null:[42,95]},oY={null:[]},lY=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:iY,contentInitial:eY,disable:oY,document:ZW,flow:rY,flowInitial:tY,insideSpan:sY,string:nY,text:aY},Symbol.toStringTag,{value:"Module"}));function cY(t,e,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const a={},s=[];let i=[],l=[];const c={attempt:M(D),check:M(B),consume:_,enter:P,exit:F,interrupt:M(B,{interrupt:!0})},d={code:null,containerState:{},defineSkip:w,events:[],now:x,parser:t,previous:null,sliceSerialize:m,sliceStream:y,write:g};let p=e.tokenize.call(d,c);return e.resolveAll&&s.push(e),d;function g(ee){return i=Vi(i,ee),T(),i[i.length-1]!==null?[]:($(e,0),d.events=$y(s,d.events,d),d.events)}function m(ee,te){return dY(y(ee),te)}function y(ee){return uY(i,ee)}function x(){const{_bufferIndex:ee,_index:te,line:X,column:Q,offset:W}=n;return{_bufferIndex:ee,_index:te,line:X,column:Q,offset:W}}function w(ee){a[ee.line]=ee.column,z()}function T(){let ee;for(;n._index<i.length;){const te=i[n._index];if(typeof te=="string")for(ee=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===ee&&n._bufferIndex<te.length;)k(te.charCodeAt(n._bufferIndex));else k(te)}}function k(ee){p=p(ee)}function _(ee){Ir(ee)?(n.line++,n.column=1,n.offset+=ee===-3?2:1,z()):ee!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===i[n._index].length&&(n._bufferIndex=-1,n._index++)),d.previous=ee}function P(ee,te){const X=te||{};return X.type=ee,X.start=x(),d.events.push(["enter",X,d]),l.push(X),X}function F(ee){const te=l.pop();return te.end=x(),d.events.push(["exit",te,d]),te}function D(ee,te){$(ee,te.from)}function B(ee,te){te.restore()}function M(ee,te){return X;function X(Q,W,H){let re,ne,ve,O;return Array.isArray(Q)?K(Q):"tokenize"in Q?K([Q]):I(Q);function I(Ae){return fe;function fe(Ne){const Te=Ne!==null&&Ae[Ne],se=Ne!==null&&Ae.null,be=[...Array.isArray(Te)?Te:Te?[Te]:[],...Array.isArray(se)?se:se?[se]:[]];return K(be)(Ne)}}function K(Ae){return re=Ae,ne=0,Ae.length===0?H:U(Ae[ne])}function U(Ae){return fe;function fe(Ne){return O=Z(),ve=Ae,Ae.partial||(d.currentConstruct=Ae),Ae.name&&d.parser.constructs.disable.null.includes(Ae.name)?ye():Ae.tokenize.call(te?Object.assign(Object.create(d),te):d,c,ce,ye)(Ne)}}function ce(Ae){return ee(ve,O),W}function ye(Ae){return O.restore(),++ne<re.length?U(re[ne]):H}}}function $(ee,te){ee.resolveAll&&!s.includes(ee)&&s.push(ee),ee.resolve&&Ai(d.events,te,d.events.length-te,ee.resolve(d.events.slice(te),d)),ee.resolveTo&&(d.events=ee.resolveTo(d.events,d))}function Z(){const ee=x(),te=d.previous,X=d.currentConstruct,Q=d.events.length,W=Array.from(l);return{from:Q,restore:H};function H(){n=ee,d.previous=te,d.currentConstruct=X,d.events.length=Q,l=W,z()}}function z(){n.line in a&&n.column<2&&(n.column=a[n.line],n.offset+=a[n.line]-1)}}function uY(t,e){const r=e.start._index,n=e.start._bufferIndex,a=e.end._index,s=e.end._bufferIndex;let i;if(r===a)i=[t[r].slice(n,s)];else{if(i=t.slice(r,a),n>-1){const l=i[0];typeof l=="string"?i[0]=l.slice(n):i.shift()}s>0&&i.push(t[a].slice(0,s))}return i}function dY(t,e){let r=-1;const n=[];let a;for(;++r<t.length;){const s=t[r];let i;if(typeof s=="string")i=s;else switch(s){case-5:{i="\r";break}case-4:{i=`
`;break}case-3:{i=`\r
`;break}case-2:{i=e?" ":"	";break}case-1:{if(!e&&a)continue;i=" ";break}default:i=String.fromCharCode(s)}a=s===-2,n.push(i)}return n.join("")}function hY(t){const n={constructs:VI([lY,...(t||{}).extensions||[]]),content:a(_V),defined:[],document:a(NV),flow:a(WW),lazy:{},string:a(KW),text:a(XW)};return n;function a(s){return i;function i(l){return cY(n,s,l)}}}function pY(t){for(;!XI(t););return t}const Y_=/[\0\t\n\r]/g;function gY(){let t=1,e="",r=!0,n;return a;function a(s,i,l){const c=[];let d,p,g,m,y;for(s=e+(typeof s=="string"?s.toString():new TextDecoder(i||void 0).decode(s)),g=0,e="",r&&(s.charCodeAt(0)===65279&&g++,r=void 0);g<s.length;){if(Y_.lastIndex=g,d=Y_.exec(s),m=d&&d.index!==void 0?d.index:s.length,y=s.charCodeAt(m),!d){e=s.slice(g);break}if(y===10&&g===m&&n)c.push(-3),n=void 0;else switch(n&&(c.push(-5),n=void 0),g<m&&(c.push(s.slice(g,m)),t+=m-g),y){case 0:{c.push(65533),t++;break}case 9:{for(p=Math.ceil(t/4)*4,c.push(-2);t++<p;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:n=!0,t=1}g=m+1}return l&&(n&&c.push(-5),e&&c.push(e),c.push(null)),c}}const fY=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function mY(t){return t.replace(fY,yY)}function yY(t,e,r){if(e)return e;if(r.charCodeAt(0)===35){const a=r.charCodeAt(1),s=a===120||a===88;return WI(r.slice(s?2:1),s?16:10)}return MS(r)||t}const nR={}.hasOwnProperty;function bY(t,e,r){return typeof e!="string"&&(r=e,e=void 0),xY(r)(pY(hY(r).document().write(gY()(t,e,!0))))}function xY(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(mt),autolinkProtocol:Z,autolinkEmail:Z,atxHeading:s(he),blockQuote:s(se),characterEscape:Z,characterReference:Z,codeFenced:s(be),codeFencedFenceInfo:i,codeFencedFenceMeta:i,codeIndented:s(be,i),codeText:s(xe,i),codeTextData:Z,data:Z,codeFlowValue:Z,definition:s(me),definitionDestinationString:i,definitionLabelString:i,definitionTitleString:i,emphasis:s(de),hardBreakEscape:s(Ie),hardBreakTrailing:s(Ie),htmlFlow:s(ze,i),htmlFlowData:Z,htmlText:s(ze,i),htmlTextData:Z,image:s(nt),label:i,link:s(mt),listItem:s(er),listItemValue:m,listOrdered:s(ht,g),listUnordered:s(ht),paragraph:s(ct),reference:U,referenceString:i,resourceDestinationString:i,resourceTitleString:i,setextHeading:s(he),strong:s(Dt),thematicBreak:s(fr)},exit:{atxHeading:c(),atxHeadingSequence:D,autolink:c(),autolinkEmail:Te,autolinkProtocol:Ne,blockQuote:c(),characterEscapeValue:z,characterReferenceMarkerHexadecimal:ye,characterReferenceMarkerNumeric:ye,characterReferenceValue:Ae,characterReference:fe,codeFenced:c(T),codeFencedFence:w,codeFencedFenceInfo:y,codeFencedFenceMeta:x,codeFlowValue:z,codeIndented:c(k),codeText:c(W),codeTextData:z,data:z,definition:c(),definitionDestinationString:F,definitionLabelString:_,definitionTitleString:P,emphasis:c(),hardBreakEscape:c(te),hardBreakTrailing:c(te),htmlFlow:c(X),htmlFlowData:z,htmlText:c(Q),htmlTextData:z,image:c(re),label:ve,labelText:ne,lineEnding:ee,link:c(H),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ce,resourceDestinationString:O,resourceTitleString:I,resource:K,setextHeading:c($),setextHeadingLineSequence:M,setextHeadingText:B,strong:c(),thematicBreak:c()}};aR(e,(t||{}).mdastExtensions||[]);const r={};return n;function n(qe){let st={type:"root",children:[]};const Gt={stack:[st],tokenStack:[],config:e,enter:l,exit:d,buffer:i,resume:p,data:r},Kt=[];let lr=-1;for(;++lr<qe.length;)if(qe[lr][1].type==="listOrdered"||qe[lr][1].type==="listUnordered")if(qe[lr][0]==="enter")Kt.push(lr);else{const Qe=Kt.pop();lr=a(qe,Qe,lr)}for(lr=-1;++lr<qe.length;){const Qe=e[qe[lr][0]];nR.call(Qe,qe[lr][1].type)&&Qe[qe[lr][1].type].call(Object.assign({sliceSerialize:qe[lr][2].sliceSerialize},Gt),qe[lr][1])}if(Gt.tokenStack.length>0){const Qe=Gt.tokenStack[Gt.tokenStack.length-1];(Qe[1]||Q_).call(Gt,void 0,Qe[0])}for(st.position={start:xc(qe.length>0?qe[0][1].start:{line:1,column:1,offset:0}),end:xc(qe.length>0?qe[qe.length-2][1].end:{line:1,column:1,offset:0})},lr=-1;++lr<e.transforms.length;)st=e.transforms[lr](st)||st;return st}function a(qe,st,Gt){let Kt=st-1,lr=-1,Qe=!1,Yt,ur,_t,sr;for(;++Kt<=Gt;){const vt=qe[Kt];switch(vt[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{vt[0]==="enter"?lr++:lr--,sr=void 0;break}case"lineEndingBlank":{vt[0]==="enter"&&(Yt&&!sr&&!lr&&!_t&&(_t=Kt),sr=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:sr=void 0}if(!lr&&vt[0]==="enter"&&vt[1].type==="listItemPrefix"||lr===-1&&vt[0]==="exit"&&(vt[1].type==="listUnordered"||vt[1].type==="listOrdered")){if(Yt){let pn=Kt;for(ur=void 0;pn--;){const Ar=qe[pn];if(Ar[1].type==="lineEnding"||Ar[1].type==="lineEndingBlank"){if(Ar[0]==="exit")continue;ur&&(qe[ur][1].type="lineEndingBlank",Qe=!0),Ar[1].type="lineEnding",ur=pn}else if(!(Ar[1].type==="linePrefix"||Ar[1].type==="blockQuotePrefix"||Ar[1].type==="blockQuotePrefixWhitespace"||Ar[1].type==="blockQuoteMarker"||Ar[1].type==="listItemIndent"))break}_t&&(!ur||_t<ur)&&(Yt._spread=!0),Yt.end=Object.assign({},ur?qe[ur][1].start:vt[1].end),qe.splice(ur||Kt,0,["exit",Yt,vt[2]]),Kt++,Gt++}if(vt[1].type==="listItemPrefix"){const pn={type:"listItem",_spread:!1,start:Object.assign({},vt[1].start),end:void 0};Yt=pn,qe.splice(Kt,0,["enter",pn,vt[2]]),Kt++,Gt++,_t=void 0,sr=!0}}}return qe[st][1]._spread=Qe,Gt}function s(qe,st){return Gt;function Gt(Kt){l.call(this,qe(Kt),Kt),st&&st.call(this,Kt)}}function i(){this.stack.push({type:"fragment",children:[]})}function l(qe,st,Gt){this.stack[this.stack.length-1].children.push(qe),this.stack.push(qe),this.tokenStack.push([st,Gt||void 0]),qe.position={start:xc(st.start),end:void 0}}function c(qe){return st;function st(Gt){qe&&qe.call(this,Gt),d.call(this,Gt)}}function d(qe,st){const Gt=this.stack.pop(),Kt=this.tokenStack.pop();if(Kt)Kt[0].type!==qe.type&&(st?st.call(this,qe,Kt[0]):(Kt[1]||Q_).call(this,qe,Kt[0]));else throw new Error("Cannot close `"+qe.type+"` ("+hg({start:qe.start,end:qe.end})+"): its not open");Gt.position.end=xc(qe.end)}function p(){return LS(this.stack.pop())}function g(){this.data.expectingFirstListItemValue=!0}function m(qe){if(this.data.expectingFirstListItemValue){const st=this.stack[this.stack.length-2];st.start=Number.parseInt(this.sliceSerialize(qe),10),this.data.expectingFirstListItemValue=void 0}}function y(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.lang=qe}function x(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.meta=qe}function w(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.value=qe.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function k(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.value=qe.replace(/(\r?\n|\r)$/g,"")}function _(qe){const st=this.resume(),Gt=this.stack[this.stack.length-1];Gt.label=st,Gt.identifier=fo(this.sliceSerialize(qe)).toLowerCase()}function P(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.title=qe}function F(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.url=qe}function D(qe){const st=this.stack[this.stack.length-1];if(!st.depth){const Gt=this.sliceSerialize(qe).length;st.depth=Gt}}function B(){this.data.setextHeadingSlurpLineEnding=!0}function M(qe){const st=this.stack[this.stack.length-1];st.depth=this.sliceSerialize(qe).codePointAt(0)===61?1:2}function $(){this.data.setextHeadingSlurpLineEnding=void 0}function Z(qe){const Gt=this.stack[this.stack.length-1].children;let Kt=Gt[Gt.length-1];(!Kt||Kt.type!=="text")&&(Kt=kt(),Kt.position={start:xc(qe.start),end:void 0},Gt.push(Kt)),this.stack.push(Kt)}function z(qe){const st=this.stack.pop();st.value+=this.sliceSerialize(qe),st.position.end=xc(qe.end)}function ee(qe){const st=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Gt=st.children[st.children.length-1];Gt.position.end=xc(qe.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(st.type)&&(Z.call(this,qe),z.call(this,qe))}function te(){this.data.atHardBreak=!0}function X(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.value=qe}function Q(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.value=qe}function W(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.value=qe}function H(){const qe=this.stack[this.stack.length-1];if(this.data.inReference){const st=this.data.referenceType||"shortcut";qe.type+="Reference",qe.referenceType=st,delete qe.url,delete qe.title}else delete qe.identifier,delete qe.label;this.data.referenceType=void 0}function re(){const qe=this.stack[this.stack.length-1];if(this.data.inReference){const st=this.data.referenceType||"shortcut";qe.type+="Reference",qe.referenceType=st,delete qe.url,delete qe.title}else delete qe.identifier,delete qe.label;this.data.referenceType=void 0}function ne(qe){const st=this.sliceSerialize(qe),Gt=this.stack[this.stack.length-2];Gt.label=mY(st),Gt.identifier=fo(st).toLowerCase()}function ve(){const qe=this.stack[this.stack.length-1],st=this.resume(),Gt=this.stack[this.stack.length-1];if(this.data.inReference=!0,Gt.type==="link"){const Kt=qe.children;Gt.children=Kt}else Gt.alt=st}function O(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.url=qe}function I(){const qe=this.resume(),st=this.stack[this.stack.length-1];st.title=qe}function K(){this.data.inReference=void 0}function U(){this.data.referenceType="collapsed"}function ce(qe){const st=this.resume(),Gt=this.stack[this.stack.length-1];Gt.label=st,Gt.identifier=fo(this.sliceSerialize(qe)).toLowerCase(),this.data.referenceType="full"}function ye(qe){this.data.characterReferenceType=qe.type}function Ae(qe){const st=this.sliceSerialize(qe),Gt=this.data.characterReferenceType;let Kt;Gt?(Kt=WI(st,Gt==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Kt=MS(st);const lr=this.stack[this.stack.length-1];lr.value+=Kt}function fe(qe){const st=this.stack.pop();st.position.end=xc(qe.end)}function Ne(qe){z.call(this,qe);const st=this.stack[this.stack.length-1];st.url=this.sliceSerialize(qe)}function Te(qe){z.call(this,qe);const st=this.stack[this.stack.length-1];st.url="mailto:"+this.sliceSerialize(qe)}function se(){return{type:"blockquote",children:[]}}function be(){return{type:"code",lang:null,meta:null,value:""}}function xe(){return{type:"inlineCode",value:""}}function me(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function de(){return{type:"emphasis",children:[]}}function he(){return{type:"heading",depth:0,children:[]}}function Ie(){return{type:"break"}}function ze(){return{type:"html",value:""}}function nt(){return{type:"image",title:null,url:"",alt:null}}function mt(){return{type:"link",title:null,url:"",children:[]}}function ht(qe){return{type:"list",ordered:qe.type==="listOrdered",start:null,spread:qe._spread,children:[]}}function er(qe){return{type:"listItem",spread:qe._spread,checked:null,children:[]}}function ct(){return{type:"paragraph",children:[]}}function Dt(){return{type:"strong",children:[]}}function kt(){return{type:"text",value:""}}function fr(){return{type:"thematicBreak"}}}function xc(t){return{line:t.line,column:t.column,offset:t.offset}}function aR(t,e){let r=-1;for(;++r<e.length;){const n=e[r];Array.isArray(n)?aR(t,n):vY(t,n)}}function vY(t,e){let r;for(r in e)if(nR.call(e,r))switch(r){case"canContainEols":{const n=e[r];n&&t[r].push(...n);break}case"transforms":{const n=e[r];n&&t[r].push(...n);break}case"enter":case"exit":{const n=e[r];n&&Object.assign(t[r],n);break}}}function Q_(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+hg({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+hg({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+hg({start:e.start,end:e.end})+") is still open")}function wY(t){const e=this;e.parser=r;function r(n){return bY(n,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function SY(t,e){const r={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,r),t.applyData(e,r)}function kY(t,e){const r={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,r),[t.applyData(e,r),{type:"text",value:`
`}]}function TY(t,e){const r=e.value?e.value+`
`:"",n={};e.lang&&(n.className=["language-"+e.lang]);let a={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return e.meta&&(a.data={meta:e.meta}),t.patch(e,a),a=t.applyData(e,a),a={type:"element",tagName:"pre",properties:{},children:[a]},t.patch(e,a),a}function CY(t,e){const r={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function EY(t,e){const r={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function _Y(t,e){const r=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=String(e.identifier).toUpperCase(),a=Ah(n.toLowerCase()),s=t.footnoteOrder.indexOf(n);let i,l=t.footnoteCounts.get(n);l===void 0?(l=0,t.footnoteOrder.push(n),i=t.footnoteOrder.length):i=s+1,l+=1,t.footnoteCounts.set(n,l);const c={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+a,id:r+"fnref-"+a+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(i)}]};t.patch(e,c);const d={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,d),t.applyData(e,d)}function AY(t,e){const r={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function NY(t,e){if(t.options.allowDangerousHtml){const r={type:"raw",value:e.value};return t.patch(e,r),t.applyData(e,r)}}function sR(t,e){const r=e.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+n}];const a=t.all(e),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const i=a[a.length-1];return i&&i.type==="text"?i.value+=n:a.push({type:"text",value:n}),a}function PY(t,e){const r=String(e.identifier).toUpperCase(),n=t.definitionById.get(r);if(!n)return sR(t,e);const a={src:Ah(n.url||""),alt:e.alt};n.title!==null&&n.title!==void 0&&(a.title=n.title);const s={type:"element",tagName:"img",properties:a,children:[]};return t.patch(e,s),t.applyData(e,s)}function IY(t,e){const r={src:Ah(e.url)};e.alt!==null&&e.alt!==void 0&&(r.alt=e.alt),e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"img",properties:r,children:[]};return t.patch(e,n),t.applyData(e,n)}function RY(t,e){const r={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return t.patch(e,n),t.applyData(e,n)}function DY(t,e){const r=String(e.identifier).toUpperCase(),n=t.definitionById.get(r);if(!n)return sR(t,e);const a={href:Ah(n.url||"")};n.title!==null&&n.title!==void 0&&(a.title=n.title);const s={type:"element",tagName:"a",properties:a,children:t.all(e)};return t.patch(e,s),t.applyData(e,s)}function LY(t,e){const r={href:Ah(e.url)};e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"a",properties:r,children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function MY(t,e,r){const n=t.all(e),a=r?OY(r):iR(e),s={},i=[];if(typeof e.checked=="boolean"){const p=n[0];let g;p&&p.type==="element"&&p.tagName==="p"?g=p:(g={type:"element",tagName:"p",properties:{},children:[]},n.unshift(g)),g.children.length>0&&g.children.unshift({type:"text",value:" "}),g.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let l=-1;for(;++l<n.length;){const p=n[l];(a||l!==0||p.type!=="element"||p.tagName!=="p")&&i.push({type:"text",value:`
`}),p.type==="element"&&p.tagName==="p"&&!a?i.push(...p.children):i.push(p)}const c=n[n.length-1];c&&(a||c.type!=="element"||c.tagName!=="p")&&i.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:i};return t.patch(e,d),t.applyData(e,d)}function OY(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const r=t.children;let n=-1;for(;!e&&++n<r.length;)e=iR(r[n])}return e}function iR(t){const e=t.spread;return e??t.children.length>1}function jY(t,e){const r={},n=t.all(e);let a=-1;for(typeof e.start=="number"&&e.start!==1&&(r.start=e.start);++a<n.length;){const i=n[a];if(i.type==="element"&&i.tagName==="li"&&i.properties&&Array.isArray(i.properties.className)&&i.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const s={type:"element",tagName:e.ordered?"ol":"ul",properties:r,children:t.wrap(n,!0)};return t.patch(e,s),t.applyData(e,s)}function BY(t,e){const r={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function FY(t,e){const r={type:"root",children:t.wrap(t.all(e))};return t.patch(e,r),t.applyData(e,r)}function zY(t,e){const r={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function $Y(t,e){const r=t.all(e),n=r.shift(),a=[];if(n){const i={type:"element",tagName:"thead",properties:{},children:t.wrap([n],!0)};t.patch(e.children[0],i),a.push(i)}if(r.length>0){const i={type:"element",tagName:"tbody",properties:{},children:t.wrap(r,!0)},l=Zo(e.children[1]),c=Fy(e.children[e.children.length-1]);l&&c&&(i.position={start:l,end:c}),a.push(i)}const s={type:"element",tagName:"table",properties:{},children:t.wrap(a,!0)};return t.patch(e,s),t.applyData(e,s)}function UY(t,e,r){const n=r?r.children:void 0,s=(n?n.indexOf(e):1)===0?"th":"td",i=r&&r.type==="table"?r.align:void 0,l=i?i.length:e.children.length;let c=-1;const d=[];for(;++c<l;){const g=e.children[c],m={},y=i?i[c]:void 0;y&&(m.align=y);let x={type:"element",tagName:s,properties:m,children:[]};g&&(x.children=t.all(g),t.patch(g,x),x=t.applyData(g,x)),d.push(x)}const p={type:"element",tagName:"tr",properties:{},children:t.wrap(d,!0)};return t.patch(e,p),t.applyData(e,p)}function qY(t,e){const r={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}const K_=9,X_=32;function HY(t){const e=String(t),r=/\r?\n|\r/g;let n=r.exec(e),a=0;const s=[];for(;n;)s.push(J_(e.slice(a,n.index),a>0,!0),n[0]),a=n.index+n[0].length,n=r.exec(e);return s.push(J_(e.slice(a),a>0,!1)),s.join("")}function J_(t,e,r){let n=0,a=t.length;if(e){let s=t.codePointAt(n);for(;s===K_||s===X_;)n++,s=t.codePointAt(n)}if(r){let s=t.codePointAt(a-1);for(;s===K_||s===X_;)a--,s=t.codePointAt(a-1)}return a>n?t.slice(n,a):""}function GY(t,e){const r={type:"text",value:HY(String(e.value))};return t.patch(e,r),t.applyData(e,r)}function VY(t,e){const r={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,r),t.applyData(e,r)}const WY={blockquote:SY,break:kY,code:TY,delete:CY,emphasis:EY,footnoteReference:_Y,heading:AY,html:NY,imageReference:PY,image:IY,inlineCode:RY,linkReference:DY,link:LY,listItem:MY,list:jY,paragraph:BY,root:FY,strong:zY,table:$Y,tableCell:qY,tableRow:UY,text:GY,thematicBreak:VY,toml:Nm,yaml:Nm,definition:Nm,footnoteDefinition:Nm};function Nm(){}const oR=-1,Uy=0,gg=1,j0=2,jS=3,BS=4,FS=5,zS=6,lR=7,cR=8,Z_=typeof self=="object"?self:globalThis,YY=(t,e)=>{const r=(a,s)=>(t.set(s,a),a),n=a=>{if(t.has(a))return t.get(a);const[s,i]=e[a];switch(s){case Uy:case oR:return r(i,a);case gg:{const l=r([],a);for(const c of i)l.push(n(c));return l}case j0:{const l=r({},a);for(const[c,d]of i)l[n(c)]=n(d);return l}case jS:return r(new Date(i),a);case BS:{const{source:l,flags:c}=i;return r(new RegExp(l,c),a)}case FS:{const l=r(new Map,a);for(const[c,d]of i)l.set(n(c),n(d));return l}case zS:{const l=r(new Set,a);for(const c of i)l.add(n(c));return l}case lR:{const{name:l,message:c}=i;return r(new Z_[l](c),a)}case cR:return r(BigInt(i),a);case"BigInt":return r(Object(BigInt(i)),a);case"ArrayBuffer":return r(new Uint8Array(i).buffer,i);case"DataView":{const{buffer:l}=new Uint8Array(i);return r(new DataView(l),i)}}return r(new Z_[s](i),a)};return n},eA=t=>YY(new Map,t)(0),Md="",{toString:QY}={},{keys:KY}=Object,Dp=t=>{const e=typeof t;if(e!=="object"||!t)return[Uy,e];const r=QY.call(t).slice(8,-1);switch(r){case"Array":return[gg,Md];case"Object":return[j0,Md];case"Date":return[jS,Md];case"RegExp":return[BS,Md];case"Map":return[FS,Md];case"Set":return[zS,Md];case"DataView":return[gg,r]}return r.includes("Array")?[gg,r]:r.includes("Error")?[lR,r]:[j0,r]},Pm=([t,e])=>t===Uy&&(e==="function"||e==="symbol"),XY=(t,e,r,n)=>{const a=(i,l)=>{const c=n.push(i)-1;return r.set(l,c),c},s=i=>{if(r.has(i))return r.get(i);let[l,c]=Dp(i);switch(l){case Uy:{let p=i;switch(c){case"bigint":l=cR,p=i.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);p=null;break;case"undefined":return a([oR],i)}return a([l,p],i)}case gg:{if(c){let m=i;return c==="DataView"?m=new Uint8Array(i.buffer):c==="ArrayBuffer"&&(m=new Uint8Array(i)),a([c,[...m]],i)}const p=[],g=a([l,p],i);for(const m of i)p.push(s(m));return g}case j0:{if(c)switch(c){case"BigInt":return a([c,i.toString()],i);case"Boolean":case"Number":case"String":return a([c,i.valueOf()],i)}if(e&&"toJSON"in i)return s(i.toJSON());const p=[],g=a([l,p],i);for(const m of KY(i))(t||!Pm(Dp(i[m])))&&p.push([s(m),s(i[m])]);return g}case jS:return a([l,i.toISOString()],i);case BS:{const{source:p,flags:g}=i;return a([l,{source:p,flags:g}],i)}case FS:{const p=[],g=a([l,p],i);for(const[m,y]of i)(t||!(Pm(Dp(m))||Pm(Dp(y))))&&p.push([s(m),s(y)]);return g}case zS:{const p=[],g=a([l,p],i);for(const m of i)(t||!Pm(Dp(m)))&&p.push(s(m));return g}}const{message:d}=i;return a([l,{name:c,message:d}],i)};return s},tA=(t,{json:e,lossy:r}={})=>{const n=[];return XY(!(e||r),!!e,new Map,n)(t),n},hh=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?eA(tA(t,e)):structuredClone(t):(t,e)=>eA(tA(t,e));function JY(t,e){const r=[{type:"text",value:""}];return e>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),r}function ZY(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function eQ(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=t.options.footnoteBackContent||JY,n=t.options.footnoteBackLabel||ZY,a=t.options.footnoteLabel||"Footnotes",s=t.options.footnoteLabelTagName||"h2",i=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const d=t.footnoteById.get(t.footnoteOrder[c]);if(!d)continue;const p=t.all(d),g=String(d.identifier).toUpperCase(),m=Ah(g.toLowerCase());let y=0;const x=[],w=t.footnoteCounts.get(g);for(;w!==void 0&&++y<=w;){x.length>0&&x.push({type:"text",value:" "});let _=typeof r=="string"?r:r(c,y);typeof _=="string"&&(_={type:"text",value:_}),x.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+m+(y>1?"-"+y:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(c,y),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const T=p[p.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const _=T.children[T.children.length-1];_&&_.type==="text"?_.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...x)}else p.push(...x);const k={type:"element",tagName:"li",properties:{id:e+"fn-"+m},children:t.wrap(p,!0)};t.patch(d,k),l.push(k)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{...hh(i),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const of=(function(t){if(t==null)return aQ;if(typeof t=="function")return qy(t);if(typeof t=="object")return Array.isArray(t)?tQ(t):rQ(t);if(typeof t=="string")return nQ(t);throw new Error("Expected function, string, or object as test")});function tQ(t){const e=[];let r=-1;for(;++r<t.length;)e[r]=of(t[r]);return qy(n);function n(...a){let s=-1;for(;++s<e.length;)if(e[s].apply(this,a))return!0;return!1}}function rQ(t){const e=t;return qy(r);function r(n){const a=n;let s;for(s in t)if(a[s]!==e[s])return!1;return!0}}function nQ(t){return qy(e);function e(r){return r&&r.type===t}}function qy(t){return e;function e(r,n,a){return!!(sQ(r)&&t.call(this,r,typeof n=="number"?n:void 0,a||void 0))}}function aQ(){return!0}function sQ(t){return t!==null&&typeof t=="object"&&"type"in t}const uR=[],iQ=!0,r1=!1,oQ="skip";function dR(t,e,r,n){let a;typeof e=="function"&&typeof r!="function"?(n=r,r=e):a=e;const s=of(a),i=n?-1:1;l(t,void 0,[])();function l(c,d,p){const g=c&&typeof c=="object"?c:{};if(typeof g.type=="string"){const y=typeof g.tagName=="string"?g.tagName:typeof g.name=="string"?g.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(c.type+(y?"<"+y+">":""))+")"})}return m;function m(){let y=uR,x,w,T;if((!e||s(c,d,p[p.length-1]||void 0))&&(y=lQ(r(c,p)),y[0]===r1))return y;if("children"in c&&c.children){const k=c;if(k.children&&y[0]!==oQ)for(w=(n?k.children.length:-1)+i,T=p.concat(k);w>-1&&w<k.children.length;){const _=k.children[w];if(x=l(_,w,T)(),x[0]===r1)return x;w=typeof x[1]=="number"?x[1]:w+i}}return y}}}function lQ(t){return Array.isArray(t)?t:typeof t=="number"?[iQ,t]:t==null?uR:[t]}function lf(t,e,r,n){let a,s,i;typeof e=="function"&&typeof r!="function"?(s=void 0,i=e,a=r):(s=e,i=r,a=n),dR(t,s,l,a);function l(c,d){const p=d[d.length-1],g=p?p.children.indexOf(c):void 0;return i(c,g,p)}}const n1={}.hasOwnProperty,cQ={};function uQ(t,e){const r=e||cQ,n=new Map,a=new Map,s=new Map,i={...WY,...r.handlers},l={all:d,applyData:hQ,definitionById:n,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:i,one:c,options:r,patch:dQ,wrap:gQ};return lf(t,function(p){if(p.type==="definition"||p.type==="footnoteDefinition"){const g=p.type==="definition"?n:a,m=String(p.identifier).toUpperCase();g.has(m)||g.set(m,p)}}),l;function c(p,g){const m=p.type,y=l.handlers[m];if(n1.call(l.handlers,m)&&y)return y(l,p,g);if(l.options.passThrough&&l.options.passThrough.includes(m)){if("children"in p){const{children:w,...T}=p,k=hh(T);return k.children=l.all(p),k}return hh(p)}return(l.options.unknownHandler||pQ)(l,p,g)}function d(p){const g=[];if("children"in p){const m=p.children;let y=-1;for(;++y<m.length;){const x=l.one(m[y],p);if(x){if(y&&m[y-1].type==="break"&&(!Array.isArray(x)&&x.type==="text"&&(x.value=rA(x.value)),!Array.isArray(x)&&x.type==="element")){const w=x.children[0];w&&w.type==="text"&&(w.value=rA(w.value))}Array.isArray(x)?g.push(...x):g.push(x)}}}return g}}function dQ(t,e){t.position&&(e.position=ZG(t))}function hQ(t,e){let r=e;if(t&&t.data){const n=t.data.hName,a=t.data.hChildren,s=t.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const i="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:i}}r.type==="element"&&s&&Object.assign(r.properties,hh(s)),"children"in r&&r.children&&a!==null&&a!==void 0&&(r.children=a)}return r}function pQ(t,e){const r=e.data||{},n="value"in e&&!(n1.call(r,"hProperties")||n1.call(r,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function gQ(t,e){const r=[];let n=-1;for(e&&r.push({type:"text",value:`
`});++n<t.length;)n&&r.push({type:"text",value:`
`}),r.push(t[n]);return e&&t.length>0&&r.push({type:"text",value:`
`}),r}function rA(t){let e=0,r=t.charCodeAt(e);for(;r===9||r===32;)e++,r=t.charCodeAt(e);return t.slice(e)}function nA(t,e){const r=uQ(t,e),n=r.one(t,void 0),a=eQ(r),s=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}function fQ(t,e){return t&&"run"in t?async function(r,n){const a=nA(r,{file:n,...e});await t.run(a,n)}:function(r,n){return nA(r,{file:n,...t||e})}}function aA(t){if(t)throw t}var Dv,sA;function mQ(){if(sA)return Dv;sA=1;var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,a=function(d){return typeof Array.isArray=="function"?Array.isArray(d):e.call(d)==="[object Array]"},s=function(d){if(!d||e.call(d)!=="[object Object]")return!1;var p=t.call(d,"constructor"),g=d.constructor&&d.constructor.prototype&&t.call(d.constructor.prototype,"isPrototypeOf");if(d.constructor&&!p&&!g)return!1;var m;for(m in d);return typeof m>"u"||t.call(d,m)},i=function(d,p){r&&p.name==="__proto__"?r(d,p.name,{enumerable:!0,configurable:!0,value:p.newValue,writable:!0}):d[p.name]=p.newValue},l=function(d,p){if(p==="__proto__")if(t.call(d,p)){if(n)return n(d,p).value}else return;return d[p]};return Dv=function c(){var d,p,g,m,y,x,w=arguments[0],T=1,k=arguments.length,_=!1;for(typeof w=="boolean"&&(_=w,w=arguments[1]||{},T=2),(w==null||typeof w!="object"&&typeof w!="function")&&(w={});T<k;++T)if(d=arguments[T],d!=null)for(p in d)g=l(w,p),m=l(d,p),w!==m&&(_&&m&&(s(m)||(y=a(m)))?(y?(y=!1,x=g&&a(g)?g:[]):x=g&&s(g)?g:{},i(w,{name:p,newValue:c(_,x,m)})):typeof m<"u"&&i(w,{name:p,newValue:m}));return w},Dv}var yQ=mQ();const Lv=Dc(yQ);function a1(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function bQ(){const t=[],e={run:r,use:n};return e;function r(...a){let s=-1;const i=a.pop();if(typeof i!="function")throw new TypeError("Expected function as last argument, not "+i);l(null,...a);function l(c,...d){const p=t[++s];let g=-1;if(c){i(c);return}for(;++g<a.length;)(d[g]===null||d[g]===void 0)&&(d[g]=a[g]);a=d,p?xQ(p,l)(...d):i(null,...d)}}function n(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return t.push(a),e}}function xQ(t,e){let r;return n;function n(...i){const l=t.length>i.length;let c;l&&i.push(a);try{c=t.apply(this,i)}catch(d){const p=d;if(l&&r)throw p;return a(p)}l||(c&&c.then&&typeof c.then=="function"?c.then(s,a):c instanceof Error?a(c):s(c))}function a(i,...l){r||(r=!0,e(i,...l))}function s(i){a(null,i)}}const Uo={basename:vQ,dirname:wQ,extname:SQ,join:kQ,sep:"/"};function vQ(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');cf(t);let r=0,n=-1,a=t.length,s;if(e===void 0||e.length===0||e.length>t.length){for(;a--;)if(t.codePointAt(a)===47){if(s){r=a+1;break}}else n<0&&(s=!0,n=a+1);return n<0?"":t.slice(r,n)}if(e===t)return"";let i=-1,l=e.length-1;for(;a--;)if(t.codePointAt(a)===47){if(s){r=a+1;break}}else i<0&&(s=!0,i=a+1),l>-1&&(t.codePointAt(a)===e.codePointAt(l--)?l<0&&(n=a):(l=-1,n=i));return r===n?n=i:n<0&&(n=t.length),t.slice(r,n)}function wQ(t){if(cf(t),t.length===0)return".";let e=-1,r=t.length,n;for(;--r;)if(t.codePointAt(r)===47){if(n){e=r;break}}else n||(n=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function SQ(t){cf(t);let e=t.length,r=-1,n=0,a=-1,s=0,i;for(;e--;){const l=t.codePointAt(e);if(l===47){if(i){n=e+1;break}continue}r<0&&(i=!0,r=e+1),l===46?a<0?a=e:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||r<0||s===0||s===1&&a===r-1&&a===n+1?"":t.slice(a,r)}function kQ(...t){let e=-1,r;for(;++e<t.length;)cf(t[e]),t[e]&&(r=r===void 0?t[e]:r+"/"+t[e]);return r===void 0?".":TQ(r)}function TQ(t){cf(t);const e=t.codePointAt(0)===47;let r=CQ(t,!e);return r.length===0&&!e&&(r="."),r.length>0&&t.codePointAt(t.length-1)===47&&(r+="/"),e?"/"+r:r}function CQ(t,e){let r="",n=0,a=-1,s=0,i=-1,l,c;for(;++i<=t.length;){if(i<t.length)l=t.codePointAt(i);else{if(l===47)break;l=47}if(l===47){if(!(a===i-1||s===1))if(a!==i-1&&s===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(c=r.lastIndexOf("/"),c!==r.length-1){c<0?(r="",n=0):(r=r.slice(0,c),n=r.length-1-r.lastIndexOf("/")),a=i,s=0;continue}}else if(r.length>0){r="",n=0,a=i,s=0;continue}}e&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+t.slice(a+1,i):r=t.slice(a+1,i),n=i-a-1;a=i,s=0}else l===46&&s>-1?s++:s=-1}return r}function cf(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const EQ={cwd:_Q};function _Q(){return"/"}function s1(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function AQ(t){if(typeof t=="string")t=new URL(t);else if(!s1(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return NQ(t)}function NQ(t){if(t.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const e=t.pathname;let r=-1;for(;++r<e.length;)if(e.codePointAt(r)===37&&e.codePointAt(r+1)===50){const n=e.codePointAt(r+2);if(n===70||n===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(e)}const Mv=["history","path","basename","stem","extname","dirname"];class hR{constructor(e){let r;e?s1(e)?r={path:e}:typeof e=="string"||PQ(e)?r={value:e}:r=e:r={},this.cwd="cwd"in r?"":EQ.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Mv.length;){const s=Mv[n];s in r&&r[s]!==void 0&&r[s]!==null&&(this[s]=s==="history"?[...r[s]]:r[s])}let a;for(a in r)Mv.includes(a)||(this[a]=r[a])}get basename(){return typeof this.path=="string"?Uo.basename(this.path):void 0}set basename(e){jv(e,"basename"),Ov(e,"basename"),this.path=Uo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Uo.dirname(this.path):void 0}set dirname(e){iA(this.basename,"dirname"),this.path=Uo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Uo.extname(this.path):void 0}set extname(e){if(Ov(e,"extname"),iA(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Uo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){s1(e)&&(e=AQ(e)),jv(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Uo.basename(this.path,this.extname):void 0}set stem(e){jv(e,"stem"),Ov(e,"stem"),this.path=Uo.join(this.dirname||"",e+(this.extname||""))}fail(e,r,n){const a=this.message(e,r,n);throw a.fatal=!0,a}info(e,r,n){const a=this.message(e,r,n);return a.fatal=void 0,a}message(e,r,n){const a=new Ss(e,r,n);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Ov(t,e){if(t&&t.includes(Uo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Uo.sep+"`")}function jv(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function iA(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function PQ(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const IQ=(function(t){const n=this.constructor.prototype,a=n[t],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,n),s}),RQ={}.hasOwnProperty;class $S extends IQ{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=bQ()}copy(){const e=new $S;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];e.use(...n)}return e.data(Lv(!0,{},this.namespace)),e}data(e,r){return typeof e=="string"?arguments.length===2?(zv("data",this.frozen),this.namespace[e]=r,this):RQ.call(this.namespace,e)&&this.namespace[e]||void 0:e?(zv("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const a=r.call(e,...n);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const r=Im(e),n=this.parser||this.Parser;return Bv("parse",n),n(String(r),r)}process(e,r){const n=this;return this.freeze(),Bv("process",this.parser||this.Parser),Fv("process",this.compiler||this.Compiler),r?a(void 0,r):new Promise(a);function a(s,i){const l=Im(e),c=n.parse(l);n.run(c,l,function(p,g,m){if(p||!g||!m)return d(p);const y=g,x=n.stringify(y,m);MQ(x)?m.value=x:m.result=x,d(p,m)});function d(p,g){p||!g?i(p):s?s(g):r(void 0,g)}}}processSync(e){let r=!1,n;return this.freeze(),Bv("processSync",this.parser||this.Parser),Fv("processSync",this.compiler||this.Compiler),this.process(e,a),lA("processSync","process",r),n;function a(s,i){r=!0,aA(s),n=i}}run(e,r,n){oA(e),this.freeze();const a=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?s(void 0,n):new Promise(s);function s(i,l){const c=Im(r);a.run(e,c,d);function d(p,g,m){const y=g||e;p?l(p):i?i(y):n(void 0,y,m)}}}runSync(e,r){let n=!1,a;return this.run(e,r,s),lA("runSync","run",n),a;function s(i,l){aA(i),a=l,n=!0}}stringify(e,r){this.freeze();const n=Im(r),a=this.compiler||this.Compiler;return Fv("stringify",a),oA(e),a(e,n)}use(e,...r){const n=this.attachers,a=this.namespace;if(zv("use",this.frozen),e!=null)if(typeof e=="function")c(e,r);else if(typeof e=="object")Array.isArray(e)?l(e):i(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function s(d){if(typeof d=="function")c(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[p,...g]=d;c(p,g)}else i(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function i(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(d.plugins),d.settings&&(a.settings=Lv(!0,a.settings,d.settings))}function l(d){let p=-1;if(d!=null)if(Array.isArray(d))for(;++p<d.length;){const g=d[p];s(g)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function c(d,p){let g=-1,m=-1;for(;++g<n.length;)if(n[g][0]===d){m=g;break}if(m===-1)n.push([d,...p]);else if(p.length>0){let[y,...x]=p;const w=n[m][1];a1(w)&&a1(y)&&(y=Lv(!0,w,y)),n[m]=[d,y,...x]}}}}const DQ=new $S().freeze();function Bv(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function Fv(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function zv(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function oA(t){if(!a1(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function lA(t,e,r){if(!r)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Im(t){return LQ(t)?t:new hR(t)}function LQ(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function MQ(t){return typeof t=="string"||OQ(t)}function OQ(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const jQ="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",cA=[],uA={allowDangerousHtml:!0},BQ=/^(https?|ircs?|mailto|xmpp)$/i,FQ=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function B0(t){const e=zQ(t),r=$Q(t);return UQ(e.runSync(e.parse(r),r),t)}function zQ(t){const e=t.rehypePlugins||cA,r=t.remarkPlugins||cA,n=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...uA}:uA;return DQ().use(wY).use(r).use(fQ,n).use(e)}function $Q(t){const e=t.children||"",r=new hR;return typeof e=="string"&&(r.value=e),r}function UQ(t,e){const r=e.allowedElements,n=e.allowElement,a=e.components,s=e.disallowedElements,i=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||qQ;for(const p of FQ)Object.hasOwn(e,p.from)&&(""+p.from+(p.to?"use `"+p.to+"` instead":"remove it")+jQ+p.id,void 0);return lf(t,d),aV(t,{Fragment:u.Fragment,components:a,ignoreInvalidStyle:!0,jsx:u.jsx,jsxs:u.jsxs,passKeys:!0,passNode:!0});function d(p,g,m){if(p.type==="raw"&&m&&typeof g=="number")return i?m.children.splice(g,1):m.children[g]={type:"text",value:p.value},g;if(p.type==="element"){let y;for(y in Pv)if(Object.hasOwn(Pv,y)&&Object.hasOwn(p.properties,y)){const x=p.properties[y],w=Pv[y];(w===null||w.includes(p.tagName))&&(p.properties[y]=c(String(x||""),y,p))}}if(p.type==="element"){let y=r?!r.includes(p.tagName):s?s.includes(p.tagName):!1;if(!y&&n&&typeof g=="number"&&(y=!n(p,g,m)),y&&m&&typeof g=="number")return l&&p.children?m.children.splice(g,1,...p.children):m.children.splice(g,1),g}}}function qQ(t){const e=t.indexOf(":"),r=t.indexOf("?"),n=t.indexOf("#"),a=t.indexOf("/");return e===-1||a!==-1&&e>a||r!==-1&&e>r||n!==-1&&e>n||BQ.test(t.slice(0,e))?t:""}function dA(t,e){const r=String(t);if(typeof e!="string")throw new TypeError("Expected character");let n=0,a=r.indexOf(e);for(;a!==-1;)n++,a=r.indexOf(e,a+e.length);return n}function HQ(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function GQ(t,e,r){const a=of((r||{}).ignore||[]),s=VQ(e);let i=-1;for(;++i<s.length;)dR(t,"text",l);function l(d,p){let g=-1,m;for(;++g<p.length;){const y=p[g],x=m?m.children:void 0;if(a(y,x?x.indexOf(y):void 0,m))return;m=y}if(m)return c(d,p)}function c(d,p){const g=p[p.length-1],m=s[i][0],y=s[i][1];let x=0;const T=g.children.indexOf(d);let k=!1,_=[];m.lastIndex=0;let P=m.exec(d.value);for(;P;){const F=P.index,D={index:P.index,input:P.input,stack:[...p,d]};let B=y(...P,D);if(typeof B=="string"&&(B=B.length>0?{type:"text",value:B}:void 0),B===!1?m.lastIndex=F+1:(x!==F&&_.push({type:"text",value:d.value.slice(x,F)}),Array.isArray(B)?_.push(...B):B&&_.push(B),x=F+P[0].length,k=!0),!m.global)break;P=m.exec(d.value)}return k?(x<d.value.length&&_.push({type:"text",value:d.value.slice(x)}),g.children.splice(T,1,..._)):_=[d],T+_.length}}function VQ(t){const e=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!t[0]||Array.isArray(t[0])?t:[t];let n=-1;for(;++n<r.length;){const a=r[n];e.push([WQ(a[0]),YQ(a[1])])}return e}function WQ(t){return typeof t=="string"?new RegExp(HQ(t),"g"):t}function YQ(t){return typeof t=="function"?t:function(){return t}}const $v="phrasing",Uv=["autolink","link","image","label"];function QQ(){return{transforms:[rK],enter:{literalAutolink:XQ,literalAutolinkEmail:qv,literalAutolinkHttp:qv,literalAutolinkWww:qv},exit:{literalAutolink:tK,literalAutolinkEmail:eK,literalAutolinkHttp:JQ,literalAutolinkWww:ZQ}}}function KQ(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:$v,notInConstruct:Uv},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:$v,notInConstruct:Uv},{character:":",before:"[ps]",after:"\\/",inConstruct:$v,notInConstruct:Uv}]}}function XQ(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function qv(t){this.config.enter.autolinkProtocol.call(this,t)}function JQ(t){this.config.exit.autolinkProtocol.call(this,t)}function ZQ(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(t)}function eK(t){this.config.exit.autolinkEmail.call(this,t)}function tK(t){this.exit(t)}function rK(t){GQ(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,nK],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),aK]],{ignore:["link","linkReference"]})}function nK(t,e,r,n,a){let s="";if(!pR(a)||(/^w/i.test(e)&&(r=e+r,e="",s="http://"),!sK(r)))return!1;const i=iK(r+n);if(!i[0])return!1;const l={type:"link",title:null,url:s+e+i[0],children:[{type:"text",value:e+i[0]}]};return i[1]?[l,{type:"text",value:i[1]}]:l}function aK(t,e,r,n){return!pR(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+r,children:[{type:"text",value:e+"@"+r}]}}function sK(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function iK(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let r=e[0],n=r.indexOf(")");const a=dA(t,"(");let s=dA(t,")");for(;n!==-1&&a>s;)t+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),s++;return[t,r]}function pR(t,e){const r=t.input.charCodeAt(t.index-1);return(t.index===0||Iu(r)||zy(r))&&(!e||r!==47)}gR.peek=fK;function oK(){this.buffer()}function lK(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function cK(){this.buffer()}function uK(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function dK(t){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=fo(this.sliceSerialize(t)).toLowerCase(),r.label=e}function hK(t){this.exit(t)}function pK(t){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.identifier=fo(this.sliceSerialize(t)).toLowerCase(),r.label=e}function gK(t){this.exit(t)}function fK(){return"["}function gR(t,e,r,n){const a=r.createTracker(n);let s=a.move("[^");const i=r.enter("footnoteReference"),l=r.enter("reference");return s+=a.move(r.safe(r.associationId(t),{after:"]",before:s})),l(),i(),s+=a.move("]"),s}function mK(){return{enter:{gfmFootnoteCallString:oK,gfmFootnoteCall:lK,gfmFootnoteDefinitionLabelString:cK,gfmFootnoteDefinition:uK},exit:{gfmFootnoteCallString:dK,gfmFootnoteCall:hK,gfmFootnoteDefinitionLabelString:pK,gfmFootnoteDefinition:gK}}}function yK(t){let e=!1;return t&&t.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:r,footnoteReference:gR},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function r(n,a,s,i){const l=s.createTracker(i);let c=l.move("[^");const d=s.enter("footnoteDefinition"),p=s.enter("label");return c+=l.move(s.safe(s.associationId(n),{before:c,after:"]"})),p(),c+=l.move("]:"),n.children&&n.children.length>0&&(l.shift(4),c+=l.move((e?`
`:" ")+s.indentLines(s.containerFlow(n,l.current()),e?fR:bK))),d(),c}}function bK(t,e,r){return e===0?t:fR(t,e,r)}function fR(t,e,r){return(r?"":"    ")+t}const xK=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];mR.peek=TK;function vK(){return{canContainEols:["delete"],enter:{strikethrough:SK},exit:{strikethrough:kK}}}function wK(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:xK}],handlers:{delete:mR}}}function SK(t){this.enter({type:"delete",children:[]},t)}function kK(t){this.exit(t)}function mR(t,e,r,n){const a=r.createTracker(n),s=r.enter("strikethrough");let i=a.move("~~");return i+=r.containerPhrasing(t,{...a.current(),before:i,after:"~"}),i+=a.move("~~"),s(),i}function TK(){return"~"}function CK(t){return t.length}function EK(t,e){const r=e||{},n=(r.align||[]).concat(),a=r.stringLength||CK,s=[],i=[],l=[],c=[];let d=0,p=-1;for(;++p<t.length;){const w=[],T=[];let k=-1;for(t[p].length>d&&(d=t[p].length);++k<t[p].length;){const _=_K(t[p][k]);if(r.alignDelimiters!==!1){const P=a(_);T[k]=P,(c[k]===void 0||P>c[k])&&(c[k]=P)}w.push(_)}i[p]=w,l[p]=T}let g=-1;if(typeof n=="object"&&"length"in n)for(;++g<d;)s[g]=hA(n[g]);else{const w=hA(n);for(;++g<d;)s[g]=w}g=-1;const m=[],y=[];for(;++g<d;){const w=s[g];let T="",k="";w===99?(T=":",k=":"):w===108?T=":":w===114&&(k=":");let _=r.alignDelimiters===!1?1:Math.max(1,c[g]-T.length-k.length);const P=T+"-".repeat(_)+k;r.alignDelimiters!==!1&&(_=T.length+_+k.length,_>c[g]&&(c[g]=_),y[g]=_),m[g]=P}i.splice(1,0,m),l.splice(1,0,y),p=-1;const x=[];for(;++p<i.length;){const w=i[p],T=l[p];g=-1;const k=[];for(;++g<d;){const _=w[g]||"";let P="",F="";if(r.alignDelimiters!==!1){const D=c[g]-(T[g]||0),B=s[g];B===114?P=" ".repeat(D):B===99?D%2?(P=" ".repeat(D/2+.5),F=" ".repeat(D/2-.5)):(P=" ".repeat(D/2),F=P):F=" ".repeat(D)}r.delimiterStart!==!1&&!g&&k.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&_==="")&&(r.delimiterStart!==!1||g)&&k.push(" "),r.alignDelimiters!==!1&&k.push(P),k.push(_),r.alignDelimiters!==!1&&k.push(F),r.padding!==!1&&k.push(" "),(r.delimiterEnd!==!1||g!==d-1)&&k.push("|")}x.push(r.delimiterEnd===!1?k.join("").replace(/ +$/,""):k.join(""))}return x.join(`
`)}function _K(t){return t==null?"":String(t)}function hA(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}const pA={}.hasOwnProperty;function yR(t,e){const r=e||{};function n(a,...s){let i=n.invalid;const l=n.handlers;if(a&&pA.call(a,t)){const c=String(a[t]);i=pA.call(l,c)?l[c]:n.unknown}if(i)return i.call(this,a,...s)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}function AK(t,e,r,n){const a=r.enter("blockquote"),s=r.createTracker(n);s.move("> "),s.shift(2);const i=r.indentLines(r.containerFlow(t,s.current()),NK);return a(),i}function NK(t,e,r){return">"+(r?"":" ")+t}function PK(t,e){return gA(t,e.inConstruct,!0)&&!gA(t,e.notInConstruct,!1)}function gA(t,e,r){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return r;let n=-1;for(;++n<e.length;)if(t.includes(e[n]))return!0;return!1}function fA(t,e,r,n){let a=-1;for(;++a<r.unsafe.length;)if(r.unsafe[a].character===`
`&&PK(r.stack,r.unsafe[a]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function IK(t,e){const r=String(t);let n=r.indexOf(e),a=n,s=0,i=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===a?++s>i&&(i=s):s=1,a=n+e.length,n=r.indexOf(e,a);return i}function RK(t,e){return!!(e.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function DK(t){const e=t.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function LK(t,e,r,n){const a=DK(r),s=t.value||"",i=a==="`"?"GraveAccent":"Tilde";if(RK(t,r)){const g=r.enter("codeIndented"),m=r.indentLines(s,MK);return g(),m}const l=r.createTracker(n),c=a.repeat(Math.max(IK(s,a)+1,3)),d=r.enter("codeFenced");let p=l.move(c);if(t.lang){const g=r.enter(`codeFencedLang${i}`);p+=l.move(r.safe(t.lang,{before:p,after:" ",encode:["`"],...l.current()})),g()}if(t.lang&&t.meta){const g=r.enter(`codeFencedMeta${i}`);p+=l.move(" "),p+=l.move(r.safe(t.meta,{before:p,after:`
`,encode:["`"],...l.current()})),g()}return p+=l.move(`
`),s&&(p+=l.move(s+`
`)),p+=l.move(c),d(),p}function MK(t,e,r){return(r?"":"    ")+t}function US(t){const e=t.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function OK(t,e,r,n){const a=US(r),s=a==='"'?"Quote":"Apostrophe",i=r.enter("definition");let l=r.enter("label");const c=r.createTracker(n);let d=c.move("[");return d+=c.move(r.safe(r.associationId(t),{before:d,after:"]",...c.current()})),d+=c.move("]: "),l(),!t.url||/[\0- \u007F]/.test(t.url)?(l=r.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(r.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=r.enter("destinationRaw"),d+=c.move(r.safe(t.url,{before:d,after:t.title?" ":`
`,...c.current()}))),l(),t.title&&(l=r.enter(`title${s}`),d+=c.move(" "+a),d+=c.move(r.safe(t.title,{before:d,after:a,...c.current()})),d+=c.move(a),l()),i(),d}function jK(t){const e=t.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function Lg(t){return"&#x"+t.toString(16).toUpperCase()+";"}function F0(t,e,r){const n=dh(t),a=dh(e);return n===void 0?a===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:a===void 0?{inside:!1,outside:!1}:a===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}bR.peek=BK;function bR(t,e,r,n){const a=jK(r),s=r.enter("emphasis"),i=r.createTracker(n),l=i.move(a);let c=i.move(r.containerPhrasing(t,{after:a,before:l,...i.current()}));const d=c.charCodeAt(0),p=F0(n.before.charCodeAt(n.before.length-1),d,a);p.inside&&(c=Lg(d)+c.slice(1));const g=c.charCodeAt(c.length-1),m=F0(n.after.charCodeAt(0),g,a);m.inside&&(c=c.slice(0,-1)+Lg(g));const y=i.move(a);return s(),r.attentionEncodeSurroundingInfo={after:m.outside,before:p.outside},l+c+y}function BK(t,e,r){return r.options.emphasis||"*"}function FK(t,e){let r=!1;return lf(t,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,r1}),!!((!t.depth||t.depth<3)&&LS(t)&&(e.options.setext||r))}function zK(t,e,r,n){const a=Math.max(Math.min(6,t.depth||1),1),s=r.createTracker(n);if(FK(t,r)){const p=r.enter("headingSetext"),g=r.enter("phrasing"),m=r.containerPhrasing(t,{...s.current(),before:`
`,after:`
`});return g(),p(),m+`
`+(a===1?"=":"-").repeat(m.length-(Math.max(m.lastIndexOf("\r"),m.lastIndexOf(`
`))+1))}const i="#".repeat(a),l=r.enter("headingAtx"),c=r.enter("phrasing");s.move(i+" ");let d=r.containerPhrasing(t,{before:"# ",after:`
`,...s.current()});return/^[\t ]/.test(d)&&(d=Lg(d.charCodeAt(0))+d.slice(1)),d=d?i+" "+d:i,r.options.closeAtx&&(d+=" "+i),c(),l(),d}xR.peek=$K;function xR(t){return t.value||""}function $K(){return"<"}vR.peek=UK;function vR(t,e,r,n){const a=US(r),s=a==='"'?"Quote":"Apostrophe",i=r.enter("image");let l=r.enter("label");const c=r.createTracker(n);let d=c.move("![");return d+=c.move(r.safe(t.alt,{before:d,after:"]",...c.current()})),d+=c.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=r.enter("destinationLiteral"),d+=c.move("<"),d+=c.move(r.safe(t.url,{before:d,after:">",...c.current()})),d+=c.move(">")):(l=r.enter("destinationRaw"),d+=c.move(r.safe(t.url,{before:d,after:t.title?" ":")",...c.current()}))),l(),t.title&&(l=r.enter(`title${s}`),d+=c.move(" "+a),d+=c.move(r.safe(t.title,{before:d,after:a,...c.current()})),d+=c.move(a),l()),d+=c.move(")"),i(),d}function UK(){return"!"}wR.peek=qK;function wR(t,e,r,n){const a=t.referenceType,s=r.enter("imageReference");let i=r.enter("label");const l=r.createTracker(n);let c=l.move("![");const d=r.safe(t.alt,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),i();const p=r.stack;r.stack=[],i=r.enter("reference");const g=r.safe(r.associationId(t),{before:c,after:"]",...l.current()});return i(),r.stack=p,s(),a==="full"||!d||d!==g?c+=l.move(g+"]"):a==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function qK(){return"!"}SR.peek=HK;function SR(t,e,r){let n=t.value||"",a="`",s=-1;for(;new RegExp("(^|[^`])"+a+"([^`]|$)").test(n);)a+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++s<r.unsafe.length;){const i=r.unsafe[s],l=r.compilePattern(i);let c;if(i.atBreak)for(;c=l.exec(n);){let d=c.index;n.charCodeAt(d)===10&&n.charCodeAt(d-1)===13&&d--,n=n.slice(0,d)+" "+n.slice(c.index+1)}}return a+n+a}function HK(){return"`"}function kR(t,e){const r=LS(t);return!!(!e.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(r===t.url||"mailto:"+r===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}TR.peek=GK;function TR(t,e,r,n){const a=US(r),s=a==='"'?"Quote":"Apostrophe",i=r.createTracker(n);let l,c;if(kR(t,r)){const p=r.stack;r.stack=[],l=r.enter("autolink");let g=i.move("<");return g+=i.move(r.containerPhrasing(t,{before:g,after:">",...i.current()})),g+=i.move(">"),l(),r.stack=p,g}l=r.enter("link"),c=r.enter("label");let d=i.move("[");return d+=i.move(r.containerPhrasing(t,{before:d,after:"](",...i.current()})),d+=i.move("]("),c(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(c=r.enter("destinationLiteral"),d+=i.move("<"),d+=i.move(r.safe(t.url,{before:d,after:">",...i.current()})),d+=i.move(">")):(c=r.enter("destinationRaw"),d+=i.move(r.safe(t.url,{before:d,after:t.title?" ":")",...i.current()}))),c(),t.title&&(c=r.enter(`title${s}`),d+=i.move(" "+a),d+=i.move(r.safe(t.title,{before:d,after:a,...i.current()})),d+=i.move(a),c()),d+=i.move(")"),l(),d}function GK(t,e,r){return kR(t,r)?"<":"["}CR.peek=VK;function CR(t,e,r,n){const a=t.referenceType,s=r.enter("linkReference");let i=r.enter("label");const l=r.createTracker(n);let c=l.move("[");const d=r.containerPhrasing(t,{before:c,after:"]",...l.current()});c+=l.move(d+"]["),i();const p=r.stack;r.stack=[],i=r.enter("reference");const g=r.safe(r.associationId(t),{before:c,after:"]",...l.current()});return i(),r.stack=p,s(),a==="full"||!d||d!==g?c+=l.move(g+"]"):a==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function VK(){return"["}function qS(t){const e=t.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function WK(t){const e=qS(t),r=t.options.bulletOther;if(!r)return e==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+r+"`) to be different");return r}function YK(t){const e=t.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function ER(t){const e=t.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function QK(t,e,r,n){const a=r.enter("list"),s=r.bulletCurrent;let i=t.ordered?YK(r):qS(r);const l=t.ordered?i==="."?")":".":WK(r);let c=e&&r.bulletLastUsed?i===r.bulletLastUsed:!1;if(!t.ordered){const p=t.children?t.children[0]:void 0;if((i==="*"||i==="-")&&p&&(!p.children||!p.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(c=!0),ER(r)===i&&p){let g=-1;for(;++g<t.children.length;){const m=t.children[g];if(m&&m.type==="listItem"&&m.children&&m.children[0]&&m.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(i=l),r.bulletCurrent=i;const d=r.containerFlow(t,n);return r.bulletLastUsed=i,r.bulletCurrent=s,a(),d}function KK(t){const e=t.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function XK(t,e,r,n){const a=KK(r);let s=r.bulletCurrent||qS(r);e&&e.type==="list"&&e.ordered&&(s=(typeof e.start=="number"&&e.start>-1?e.start:1)+(r.options.incrementListMarker===!1?0:e.children.indexOf(t))+s);let i=s.length+1;(a==="tab"||a==="mixed"&&(e&&e.type==="list"&&e.spread||t.spread))&&(i=Math.ceil(i/4)*4);const l=r.createTracker(n);l.move(s+" ".repeat(i-s.length)),l.shift(i);const c=r.enter("listItem"),d=r.indentLines(r.containerFlow(t,l.current()),p);return c(),d;function p(g,m,y){return m?(y?"":" ".repeat(i))+g:(y?s:s+" ".repeat(i-s.length))+g}}function JK(t,e,r,n){const a=r.enter("paragraph"),s=r.enter("phrasing"),i=r.containerPhrasing(t,n);return s(),a(),i}const ZK=of(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function eX(t,e,r,n){return(t.children.some(function(i){return ZK(i)})?r.containerPhrasing:r.containerFlow).call(r,t,n)}function tX(t){const e=t.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}_R.peek=rX;function _R(t,e,r,n){const a=tX(r),s=r.enter("strong"),i=r.createTracker(n),l=i.move(a+a);let c=i.move(r.containerPhrasing(t,{after:a,before:l,...i.current()}));const d=c.charCodeAt(0),p=F0(n.before.charCodeAt(n.before.length-1),d,a);p.inside&&(c=Lg(d)+c.slice(1));const g=c.charCodeAt(c.length-1),m=F0(n.after.charCodeAt(0),g,a);m.inside&&(c=c.slice(0,-1)+Lg(g));const y=i.move(a+a);return s(),r.attentionEncodeSurroundingInfo={after:m.outside,before:p.outside},l+c+y}function rX(t,e,r){return r.options.strong||"*"}function nX(t,e,r,n){return r.safe(t.value,n)}function aX(t){const e=t.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function sX(t,e,r){const n=(ER(r)+(r.options.ruleSpaces?" ":"")).repeat(aX(r));return r.options.ruleSpaces?n.slice(0,-1):n}const AR={blockquote:AK,break:fA,code:LK,definition:OK,emphasis:bR,hardBreak:fA,heading:zK,html:xR,image:vR,imageReference:wR,inlineCode:SR,link:TR,linkReference:CR,list:QK,listItem:XK,paragraph:JK,root:eX,strong:_R,text:nX,thematicBreak:sX};function iX(){return{enter:{table:oX,tableData:mA,tableHeader:mA,tableRow:cX},exit:{codeText:uX,table:lX,tableData:Hv,tableHeader:Hv,tableRow:Hv}}}function oX(t){const e=t._align;this.enter({type:"table",align:e.map(function(r){return r==="none"?null:r}),children:[]},t),this.data.inTable=!0}function lX(t){this.exit(t),this.data.inTable=void 0}function cX(t){this.enter({type:"tableRow",children:[]},t)}function Hv(t){this.exit(t)}function mA(t){this.enter({type:"tableCell",children:[]},t)}function uX(t){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,dX));const r=this.stack[this.stack.length-1];r.type,r.value=e,this.exit(t)}function dX(t,e){return e==="|"?e:t}function hX(t){const e=t||{},r=e.tableCellPadding,n=e.tablePipeAlign,a=e.stringLength,s=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:m,table:i,tableCell:c,tableRow:l}};function i(y,x,w,T){return d(p(y,w,T),y.align)}function l(y,x,w,T){const k=g(y,w,T),_=d([k]);return _.slice(0,_.indexOf(`
`))}function c(y,x,w,T){const k=w.enter("tableCell"),_=w.enter("phrasing"),P=w.containerPhrasing(y,{...T,before:s,after:s});return _(),k(),P}function d(y,x){return EK(y,{align:x,alignDelimiters:n,padding:r,stringLength:a})}function p(y,x,w){const T=y.children;let k=-1;const _=[],P=x.enter("table");for(;++k<T.length;)_[k]=g(T[k],x,w);return P(),_}function g(y,x,w){const T=y.children;let k=-1;const _=[],P=x.enter("tableRow");for(;++k<T.length;)_[k]=c(T[k],y,x,w);return P(),_}function m(y,x,w){let T=AR.inlineCode(y,x,w);return w.stack.includes("tableCell")&&(T=T.replace(/\|/g,"\\$&")),T}}function pX(){return{exit:{taskListCheckValueChecked:yA,taskListCheckValueUnchecked:yA,paragraph:fX}}}function gX(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:mX}}}function yA(t){const e=this.stack[this.stack.length-2];e.type,e.checked=t.type==="taskListCheckValueChecked"}function fX(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const a=e.children;let s=-1,i;for(;++s<a.length;){const l=a[s];if(l.type==="paragraph"){i=l;break}}i===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(t)}function mX(t,e,r,n){const a=t.children[0],s=typeof t.checked=="boolean"&&a&&a.type==="paragraph",i="["+(t.checked?"x":" ")+"] ",l=r.createTracker(n);s&&l.move(i);let c=AR.listItem(t,e,r,{...n,...l.current()});return s&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,d)),c;function d(p){return p+i}}function yX(){return[QQ(),mK(),vK(),iX(),pX()]}function bX(t){return{extensions:[KQ(),yK(t),wK(),hX(t),gX()]}}const xX={tokenize:CX,partial:!0},NR={tokenize:EX,partial:!0},PR={tokenize:_X,partial:!0},IR={tokenize:AX,partial:!0},vX={tokenize:NX,partial:!0},RR={name:"wwwAutolink",tokenize:kX,previous:LR},DR={name:"protocolAutolink",tokenize:TX,previous:MR},Fl={name:"emailAutolink",tokenize:SX,previous:OR},el={};function wX(){return{text:el}}let ou=48;for(;ou<123;)el[ou]=Fl,ou++,ou===58?ou=65:ou===91&&(ou=97);el[43]=Fl;el[45]=Fl;el[46]=Fl;el[95]=Fl;el[72]=[Fl,DR];el[104]=[Fl,DR];el[87]=[Fl,RR];el[119]=[Fl,RR];function SX(t,e,r){const n=this;let a,s;return i;function i(g){return!i1(g)||!OR.call(n,n.previous)||HS(n.events)?r(g):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),l(g))}function l(g){return i1(g)?(t.consume(g),l):g===64?(t.consume(g),c):r(g)}function c(g){return g===46?t.check(vX,p,d)(g):g===45||g===95||ys(g)?(s=!0,t.consume(g),c):p(g)}function d(g){return t.consume(g),a=!0,c}function p(g){return s&&a&&Rs(n.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(g)):r(g)}}function kX(t,e,r){const n=this;return a;function a(i){return i!==87&&i!==119||!LR.call(n,n.previous)||HS(n.events)?r(i):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(xX,t.attempt(NR,t.attempt(PR,s),r),r)(i))}function s(i){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(i)}}function TX(t,e,r){const n=this;let a="",s=!1;return i;function i(g){return(g===72||g===104)&&MR.call(n,n.previous)&&!HS(n.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),a+=String.fromCodePoint(g),t.consume(g),l):r(g)}function l(g){if(Rs(g)&&a.length<5)return a+=String.fromCodePoint(g),t.consume(g),l;if(g===58){const m=a.toLowerCase();if(m==="http"||m==="https")return t.consume(g),c}return r(g)}function c(g){return g===47?(t.consume(g),s?d:(s=!0,c)):r(g)}function d(g){return g===null||O0(g)||Qn(g)||Iu(g)||zy(g)?r(g):t.attempt(NR,t.attempt(PR,p),r)(g)}function p(g){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(g)}}function CX(t,e,r){let n=0;return a;function a(i){return(i===87||i===119)&&n<3?(n++,t.consume(i),a):i===46&&n===3?(t.consume(i),s):r(i)}function s(i){return i===null?r(i):e(i)}}function EX(t,e,r){let n,a,s;return i;function i(d){return d===46||d===95?t.check(IR,c,l)(d):d===null||Qn(d)||Iu(d)||d!==45&&zy(d)?c(d):(s=!0,t.consume(d),i)}function l(d){return d===95?n=!0:(a=n,n=void 0),t.consume(d),i}function c(d){return a||n||!s?r(d):e(d)}}function _X(t,e){let r=0,n=0;return a;function a(i){return i===40?(r++,t.consume(i),a):i===41&&n<r?s(i):i===33||i===34||i===38||i===39||i===41||i===42||i===44||i===46||i===58||i===59||i===60||i===63||i===93||i===95||i===126?t.check(IR,e,s)(i):i===null||Qn(i)||Iu(i)?e(i):(t.consume(i),a)}function s(i){return i===41&&n++,t.consume(i),a}}function AX(t,e,r){return n;function n(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(t.consume(l),n):l===38?(t.consume(l),s):l===93?(t.consume(l),a):l===60||l===null||Qn(l)||Iu(l)?e(l):r(l)}function a(l){return l===null||l===40||l===91||Qn(l)||Iu(l)?e(l):n(l)}function s(l){return Rs(l)?i(l):r(l)}function i(l){return l===59?(t.consume(l),n):Rs(l)?(t.consume(l),i):r(l)}}function NX(t,e,r){return n;function n(s){return t.consume(s),a}function a(s){return ys(s)?r(s):e(s)}}function LR(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||Qn(t)}function MR(t){return!Rs(t)}function OR(t){return!(t===47||i1(t))}function i1(t){return t===43||t===45||t===46||t===95||ys(t)}function HS(t){let e=t.length,r=!1;for(;e--;){const n=t[e][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return t.length>0&&!r&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}const PX={tokenize:BX,partial:!0};function IX(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:MX,continuation:{tokenize:OX},exit:jX}},text:{91:{name:"gfmFootnoteCall",tokenize:LX},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:RX,resolveTo:DX}}}}function RX(t,e,r){const n=this;let a=n.events.length;const s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i;for(;a--;){const c=n.events[a][1];if(c.type==="labelImage"){i=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!i||!i._balanced)return r(c);const d=fo(n.sliceSerialize({start:i.end,end:n.now()}));return d.codePointAt(0)!==94||!s.includes(d.slice(1))?r(c):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(c),t.exit("gfmFootnoteCallLabelMarker"),e(c))}}function DX(t,e){let r=t.length;for(;r--;)if(t[r][1].type==="labelImage"&&t[r][0]==="enter"){t[r][1];break}t[r+1][1].type="data",t[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},t[r+3][1].start),end:Object.assign({},t[t.length-1][1].end)},a={type:"gfmFootnoteCallMarker",start:Object.assign({},t[r+3][1].end),end:Object.assign({},t[r+3][1].end)};a.end.column++,a.end.offset++,a.end._bufferIndex++;const s={type:"gfmFootnoteCallString",start:Object.assign({},a.end),end:Object.assign({},t[t.length-1][1].start)},i={type:"chunkString",contentType:"string",start:Object.assign({},s.start),end:Object.assign({},s.end)},l=[t[r+1],t[r+2],["enter",n,e],t[r+3],t[r+4],["enter",a,e],["exit",a,e],["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e],t[t.length-2],t[t.length-1],["exit",n,e]];return t.splice(r,t.length-r+1,...l),t}function LX(t,e,r){const n=this,a=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let s=0,i;return l;function l(g){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(g),t.exit("gfmFootnoteCallLabelMarker"),c}function c(g){return g!==94?r(g):(t.enter("gfmFootnoteCallMarker"),t.consume(g),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",d)}function d(g){if(s>999||g===93&&!i||g===null||g===91||Qn(g))return r(g);if(g===93){t.exit("chunkString");const m=t.exit("gfmFootnoteCallString");return a.includes(fo(n.sliceSerialize(m)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(g),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e):r(g)}return Qn(g)||(i=!0),s++,t.consume(g),g===92?p:d}function p(g){return g===91||g===92||g===93?(t.consume(g),s++,d):d(g)}}function MX(t,e,r){const n=this,a=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let s,i=0,l;return c;function c(x){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(x),t.exit("gfmFootnoteDefinitionLabelMarker"),d}function d(x){return x===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(x),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",p):r(x)}function p(x){if(i>999||x===93&&!l||x===null||x===91||Qn(x))return r(x);if(x===93){t.exit("chunkString");const w=t.exit("gfmFootnoteDefinitionLabelString");return s=fo(n.sliceSerialize(w)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(x),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),m}return Qn(x)||(l=!0),i++,t.consume(x),x===92?g:p}function g(x){return x===91||x===92||x===93?(t.consume(x),i++,p):p(x)}function m(x){return x===58?(t.enter("definitionMarker"),t.consume(x),t.exit("definitionMarker"),a.includes(s)||a.push(s),Sn(t,y,"gfmFootnoteDefinitionWhitespace")):r(x)}function y(x){return e(x)}}function OX(t,e,r){return t.check(sf,e,t.attempt(PX,e,r))}function jX(t){t.exit("gfmFootnoteDefinition")}function BX(t,e,r){const n=this;return Sn(t,a,"gfmFootnoteDefinitionIndent",5);function a(s){const i=n.events[n.events.length-1];return i&&i[1].type==="gfmFootnoteDefinitionIndent"&&i[2].sliceSerialize(i[1],!0).length===4?e(s):r(s)}}function FX(t){let r=(t||{}).singleTilde;const n={name:"strikethrough",tokenize:s,resolveAll:a};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function a(i,l){let c=-1;for(;++c<i.length;)if(i[c][0]==="enter"&&i[c][1].type==="strikethroughSequenceTemporary"&&i[c][1]._close){let d=c;for(;d--;)if(i[d][0]==="exit"&&i[d][1].type==="strikethroughSequenceTemporary"&&i[d][1]._open&&i[c][1].end.offset-i[c][1].start.offset===i[d][1].end.offset-i[d][1].start.offset){i[c][1].type="strikethroughSequence",i[d][1].type="strikethroughSequence";const p={type:"strikethrough",start:Object.assign({},i[d][1].start),end:Object.assign({},i[c][1].end)},g={type:"strikethroughText",start:Object.assign({},i[d][1].end),end:Object.assign({},i[c][1].start)},m=[["enter",p,l],["enter",i[d][1],l],["exit",i[d][1],l],["enter",g,l]],y=l.parser.constructs.insideSpan.null;y&&Ai(m,m.length,0,$y(y,i.slice(d+1,c),l)),Ai(m,m.length,0,[["exit",g,l],["enter",i[c][1],l],["exit",i[c][1],l],["exit",p,l]]),Ai(i,d-1,c-d+3,m),c=d+m.length-2;break}}for(c=-1;++c<i.length;)i[c][1].type==="strikethroughSequenceTemporary"&&(i[c][1].type="data");return i}function s(i,l,c){const d=this.previous,p=this.events;let g=0;return m;function m(x){return d===126&&p[p.length-1][1].type!=="characterEscape"?c(x):(i.enter("strikethroughSequenceTemporary"),y(x))}function y(x){const w=dh(d);if(x===126)return g>1?c(x):(i.consume(x),g++,y);if(g<2&&!r)return c(x);const T=i.exit("strikethroughSequenceTemporary"),k=dh(x);return T._open=!k||k===2&&!!w,T._close=!w||w===2&&!!k,l(x)}}}class zX{constructor(){this.map=[]}add(e,r,n){$X(this,e,r,n)}consume(e){if(this.map.sort(function(s,i){return s[0]-i[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(e.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),e.length=this.map[r][0];n.push(e.slice()),e.length=0;let a=n.pop();for(;a;){for(const s of a)e.push(s);a=n.pop()}this.map.length=0}}function $X(t,e,r,n){let a=0;if(!(r===0&&n.length===0)){for(;a<t.map.length;){if(t.map[a][0]===e){t.map[a][1]+=r,t.map[a][2].push(...n);return}a+=1}t.map.push([e,r,n])}}function UX(t,e){let r=!1;const n=[];for(;e<t.length;){const a=t[e];if(r){if(a[0]==="enter")a[1].type==="tableContent"&&n.push(t[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(a[1].type==="tableContent"){if(t[e-1][1].type==="tableDelimiterMarker"){const s=n.length-1;n[s]=n[s]==="left"?"center":"right"}}else if(a[1].type==="tableDelimiterRow")break}else a[0]==="enter"&&a[1].type==="tableDelimiterRow"&&(r=!0);e+=1}return n}function qX(){return{flow:{null:{name:"table",tokenize:HX,resolveAll:GX}}}}function HX(t,e,r){const n=this;let a=0,s=0,i;return l;function l(z){let ee=n.events.length-1;for(;ee>-1;){const Q=n.events[ee][1].type;if(Q==="lineEnding"||Q==="linePrefix")ee--;else break}const te=ee>-1?n.events[ee][1].type:null,X=te==="tableHead"||te==="tableRow"?B:c;return X===B&&n.parser.lazy[n.now().line]?r(z):X(z)}function c(z){return t.enter("tableHead"),t.enter("tableRow"),d(z)}function d(z){return z===124||(i=!0,s+=1),p(z)}function p(z){return z===null?r(z):Ir(z)?s>1?(s=0,n.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(z),t.exit("lineEnding"),y):r(z):un(z)?Sn(t,p,"whitespace")(z):(s+=1,i&&(i=!1,a+=1),z===124?(t.enter("tableCellDivider"),t.consume(z),t.exit("tableCellDivider"),i=!0,p):(t.enter("data"),g(z)))}function g(z){return z===null||z===124||Qn(z)?(t.exit("data"),p(z)):(t.consume(z),z===92?m:g)}function m(z){return z===92||z===124?(t.consume(z),g):g(z)}function y(z){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(z):(t.enter("tableDelimiterRow"),i=!1,un(z)?Sn(t,x,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(z):x(z))}function x(z){return z===45||z===58?T(z):z===124?(i=!0,t.enter("tableCellDivider"),t.consume(z),t.exit("tableCellDivider"),w):D(z)}function w(z){return un(z)?Sn(t,T,"whitespace")(z):T(z)}function T(z){return z===58?(s+=1,i=!0,t.enter("tableDelimiterMarker"),t.consume(z),t.exit("tableDelimiterMarker"),k):z===45?(s+=1,k(z)):z===null||Ir(z)?F(z):D(z)}function k(z){return z===45?(t.enter("tableDelimiterFiller"),_(z)):D(z)}function _(z){return z===45?(t.consume(z),_):z===58?(i=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(z),t.exit("tableDelimiterMarker"),P):(t.exit("tableDelimiterFiller"),P(z))}function P(z){return un(z)?Sn(t,F,"whitespace")(z):F(z)}function F(z){return z===124?x(z):z===null||Ir(z)?!i||a!==s?D(z):(t.exit("tableDelimiterRow"),t.exit("tableHead"),e(z)):D(z)}function D(z){return r(z)}function B(z){return t.enter("tableRow"),M(z)}function M(z){return z===124?(t.enter("tableCellDivider"),t.consume(z),t.exit("tableCellDivider"),M):z===null||Ir(z)?(t.exit("tableRow"),e(z)):un(z)?Sn(t,M,"whitespace")(z):(t.enter("data"),$(z))}function $(z){return z===null||z===124||Qn(z)?(t.exit("data"),M(z)):(t.consume(z),z===92?Z:$)}function Z(z){return z===92||z===124?(t.consume(z),$):$(z)}}function GX(t,e){let r=-1,n=!0,a=0,s=[0,0,0,0],i=[0,0,0,0],l=!1,c=0,d,p,g;const m=new zX;for(;++r<t.length;){const y=t[r],x=y[1];y[0]==="enter"?x.type==="tableHead"?(l=!1,c!==0&&(bA(m,e,c,d,p),p=void 0,c=0),d={type:"table",start:Object.assign({},x.start),end:Object.assign({},x.end)},m.add(r,0,[["enter",d,e]])):x.type==="tableRow"||x.type==="tableDelimiterRow"?(n=!0,g=void 0,s=[0,0,0,0],i=[0,r+1,0,0],l&&(l=!1,p={type:"tableBody",start:Object.assign({},x.start),end:Object.assign({},x.end)},m.add(r,0,[["enter",p,e]])),a=x.type==="tableDelimiterRow"?2:p?3:1):a&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")?(n=!1,i[2]===0&&(s[1]!==0&&(i[0]=i[1],g=Rm(m,e,s,a,void 0,g),s=[0,0,0,0]),i[2]=r)):x.type==="tableCellDivider"&&(n?n=!1:(s[1]!==0&&(i[0]=i[1],g=Rm(m,e,s,a,void 0,g)),s=i,i=[s[1],r,0,0])):x.type==="tableHead"?(l=!0,c=r):x.type==="tableRow"||x.type==="tableDelimiterRow"?(c=r,s[1]!==0?(i[0]=i[1],g=Rm(m,e,s,a,r,g)):i[1]!==0&&(g=Rm(m,e,i,a,r,g)),a=0):a&&(x.type==="data"||x.type==="tableDelimiterMarker"||x.type==="tableDelimiterFiller")&&(i[3]=r)}for(c!==0&&bA(m,e,c,d,p),m.consume(e.events),r=-1;++r<e.events.length;){const y=e.events[r];y[0]==="enter"&&y[1].type==="table"&&(y[1]._align=UX(e.events,r))}return t}function Rm(t,e,r,n,a,s){const i=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",l="tableContent";r[0]!==0&&(s.end=Object.assign({},$d(e.events,r[0])),t.add(r[0],0,[["exit",s,e]]));const c=$d(e.events,r[1]);if(s={type:i,start:Object.assign({},c),end:Object.assign({},c)},t.add(r[1],0,[["enter",s,e]]),r[2]!==0){const d=$d(e.events,r[2]),p=$d(e.events,r[3]),g={type:l,start:Object.assign({},d),end:Object.assign({},p)};if(t.add(r[2],0,[["enter",g,e]]),n!==2){const m=e.events[r[2]],y=e.events[r[3]];if(m[1].end=Object.assign({},y[1].end),m[1].type="chunkText",m[1].contentType="text",r[3]>r[2]+1){const x=r[2]+1,w=r[3]-r[2]-1;t.add(x,w,[])}}t.add(r[3]+1,0,[["exit",g,e]])}return a!==void 0&&(s.end=Object.assign({},$d(e.events,a)),t.add(a,0,[["exit",s,e]]),s=void 0),s}function bA(t,e,r,n,a){const s=[],i=$d(e.events,r);a&&(a.end=Object.assign({},i),s.push(["exit",a,e])),n.end=Object.assign({},i),s.push(["exit",n,e]),t.add(r+1,0,s)}function $d(t,e){const r=t[e],n=r[0]==="enter"?"start":"end";return r[1][n]}const VX={name:"tasklistCheck",tokenize:YX};function WX(){return{text:{91:VX}}}function YX(t,e,r){const n=this;return a;function a(c){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(c):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),s)}function s(c){return Qn(c)?(t.enter("taskListCheckValueUnchecked"),t.consume(c),t.exit("taskListCheckValueUnchecked"),i):c===88||c===120?(t.enter("taskListCheckValueChecked"),t.consume(c),t.exit("taskListCheckValueChecked"),i):r(c)}function i(c){return c===93?(t.enter("taskListCheckMarker"),t.consume(c),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),l):r(c)}function l(c){return Ir(c)?e(c):un(c)?t.check({tokenize:QX},e,r)(c):r(c)}}function QX(t,e,r){return Sn(t,n,"whitespace");function n(a){return a===null?r(a):e(a)}}function KX(t){return VI([wX(),IX(),FX(t),qX(),WX()])}const XX={};function JX(t){const e=this,r=t||XX,n=e.data(),a=n.micromarkExtensions||(n.micromarkExtensions=[]),s=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),i=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);a.push(KX(r)),s.push(yX()),i.push(bX(r))}const xA=/[#.]/g;function ZX(t,e){const r=t||"",n={};let a=0,s,i;for(;a<r.length;){xA.lastIndex=a;const l=xA.exec(r),c=r.slice(a,l?l.index:r.length);c&&(s?s==="#"?n.id=c:Array.isArray(n.className)?n.className.push(c):n.className=[c]:i=c,a+=c.length),l&&(s=l[0],a++)}return{type:"element",tagName:i||e||"div",properties:n,children:[]}}function jR(t,e,r){const n=r?nJ(r):void 0;function a(s,i,...l){let c;if(s==null){c={type:"root",children:[]};const d=i;l.unshift(d)}else{c=ZX(s,e);const d=c.tagName.toLowerCase(),p=n?n.get(d):void 0;if(c.tagName=p||d,eJ(i))l.unshift(i);else for(const[g,m]of Object.entries(i))tJ(t,c.properties,g,m)}for(const d of l)o1(c.children,d);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return a}function eJ(t){if(t===null||typeof t!="object"||Array.isArray(t))return!0;if(typeof t.type!="string")return!1;const e=t,r=Object.keys(t);for(const n of r){const a=e[n];if(a&&typeof a=="object"){if(!Array.isArray(a))return!0;const s=a;for(const i of s)if(typeof i!="number"&&typeof i!="string")return!0}}return!!("children"in t&&Array.isArray(t.children))}function tJ(t,e,r,n){const a=PS(t,r);let s;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;s=n}else typeof n=="boolean"?s=n:typeof n=="string"?a.spaceSeparated?s=R_(n):a.commaSeparated?s=__(n):a.commaOrSpaceSeparated?s=R_(__(n).join(" ")):s=vA(a,a.property,n):Array.isArray(n)?s=[...n]:s=a.property==="style"?rJ(n):String(n);if(Array.isArray(s)){const i=[];for(const l of s)i.push(vA(a,a.property,l));s=i}a.property==="className"&&Array.isArray(e.className)&&(s=e.className.concat(s)),e[a.property]=s}}function o1(t,e){if(e!=null)if(typeof e=="number"||typeof e=="string")t.push({type:"text",value:String(e)});else if(Array.isArray(e))for(const r of e)o1(t,r);else if(typeof e=="object"&&"type"in e)e.type==="root"?o1(t,e.children):t.push(e);else throw new Error("Expected node, nodes, or string, got `"+e+"`")}function vA(t,e,r){if(typeof r=="string"){if(t.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((t.boolean||t.overloadedBoolean)&&(r===""||Rg(r)===Rg(e)))return!0}return r}function rJ(t){const e=[];for(const[r,n]of Object.entries(t))e.push([r,n].join(": "));return e.join("; ")}function nJ(t){const e=new Map;for(const r of t)e.set(r.toLowerCase(),r);return e}const aJ=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],sJ=jR(By,"div"),iJ=jR(_h,"g",aJ);function oJ(t){const e=String(t),r=[];return{toOffset:a,toPoint:n};function n(s){if(typeof s=="number"&&s>-1&&s<=e.length){let i=0;for(;;){let l=r[i];if(l===void 0){const c=wA(e,r[i-1]);l=c===-1?e.length+1:c+1,r[i]=l}if(l>s)return{line:i+1,column:s-(i>0?r[i-1]:0)+1,offset:s};i++}}}function a(s){if(s&&typeof s.line=="number"&&typeof s.column=="number"&&!Number.isNaN(s.line)&&!Number.isNaN(s.column)){for(;r.length<s.line;){const l=r[r.length-1],c=wA(e,l),d=c===-1?e.length+1:c+1;if(l===d)break;r.push(d)}const i=(s.line>1?r[s.line-2]:0)+s.column-1;if(i<r[s.line-1])return i}}}function wA(t,e){const r=t.indexOf("\r",e),n=t.indexOf(`
`,e);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const bu={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},BR={}.hasOwnProperty,lJ=Object.prototype;function cJ(t,e){const r=e||{};return GS({file:r.file||void 0,location:!1,schema:r.space==="svg"?_h:By,verbose:r.verbose||!1},t)}function GS(t,e){let r;switch(e.nodeName){case"#comment":{const n=e;return r={type:"comment",value:n.data},i0(t,n,r),r}case"#document":case"#document-fragment":{const n=e,a="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:FR(t,e.childNodes),data:{quirksMode:a}},t.file&&t.location){const s=String(t.file),i=oJ(s),l=i.toPoint(0),c=i.toPoint(s.length);r.position={start:l,end:c}}return r}case"#documentType":{const n=e;return r={type:"doctype"},i0(t,n,r),r}case"#text":{const n=e;return r={type:"text",value:n.value},i0(t,n,r),r}default:return r=uJ(t,e),r}}function FR(t,e){let r=-1;const n=[];for(;++r<e.length;){const a=GS(t,e[r]);n.push(a)}return n}function uJ(t,e){const r=t.schema;t.schema=e.namespaceURI===bu.svg?_h:By;let n=-1;const a={};for(;++n<e.attrs.length;){const l=e.attrs[n],c=(l.prefix?l.prefix+":":"")+l.name;BR.call(lJ,c)||(a[c]=l.value)}const i=(t.schema.space==="svg"?iJ:sJ)(e.tagName,a,FR(t,e.childNodes));if(i0(t,e,i),i.tagName==="template"){const l=e,c=l.sourceCodeLocation,d=c&&c.startTag&&Yd(c.startTag),p=c&&c.endTag&&Yd(c.endTag),g=GS(t,l.content);d&&p&&t.file&&(g.position={start:d.end,end:p.start}),i.content=g}return t.schema=r,i}function i0(t,e,r){if("sourceCodeLocation"in e&&e.sourceCodeLocation&&t.file){const n=dJ(t,r,e.sourceCodeLocation);n&&(t.location=!0,r.position=n)}}function dJ(t,e,r){const n=Yd(r);if(e.type==="element"){const a=e.children[e.children.length-1];if(n&&!r.endTag&&a&&a.position&&a.position.end&&(n.end=Object.assign({},a.position.end)),t.verbose){const s={};let i;if(r.attrs)for(i in r.attrs)BR.call(r.attrs,i)&&(s[PS(t.schema,i).property]=Yd(r.attrs[i]));r.startTag;const l=Yd(r.startTag),c=r.endTag?Yd(r.endTag):void 0,d={opening:l};c&&(d.closing=c),d.properties=s,e.data={position:d}}}return n}function Yd(t){const e=SA({line:t.startLine,column:t.startCol,offset:t.startOffset}),r=SA({line:t.endLine,column:t.endCol,offset:t.endOffset});return e||r?{start:e,end:r}:void 0}function SA(t){return t.line&&t.column?t:void 0}class uf{constructor(e,r,n){this.property=e,this.normal=r,n&&(this.space=n)}}uf.prototype.property={};uf.prototype.normal={};uf.prototype.space=null;function zR(t,e){const r={},n={};let a=-1;for(;++a<t.length;)Object.assign(r,t[a].property),Object.assign(n,t[a].normal);return new uf(r,n,e)}function l1(t){return t.toLowerCase()}class Ji{constructor(e,r){this.property=e,this.attribute=r}}Ji.prototype.space=null;Ji.prototype.boolean=!1;Ji.prototype.booleanish=!1;Ji.prototype.overloadedBoolean=!1;Ji.prototype.number=!1;Ji.prototype.commaSeparated=!1;Ji.prototype.spaceSeparated=!1;Ji.prototype.commaOrSpaceSeparated=!1;Ji.prototype.mustUseProperty=!1;Ji.prototype.defined=!1;let hJ=0;const Qr=$u(),Ma=$u(),$R=$u(),Ut=$u(),Jn=$u(),Jd=$u(),Ei=$u();function $u(){return 2**++hJ}const c1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Qr,booleanish:Ma,commaOrSpaceSeparated:Ei,commaSeparated:Jd,number:Ut,overloadedBoolean:$R,spaceSeparated:Jn},Symbol.toStringTag,{value:"Module"})),Gv=Object.keys(c1);class VS extends Ji{constructor(e,r,n,a){let s=-1;if(super(e,r),kA(this,"space",a),typeof n=="number")for(;++s<Gv.length;){const i=Gv[s];kA(this,Gv[s],(n&c1[i])===c1[i])}}}VS.prototype.defined=!0;function kA(t,e,r){r&&(t[e]=r)}const pJ={}.hasOwnProperty;function Nh(t){const e={},r={};let n;for(n in t.properties)if(pJ.call(t.properties,n)){const a=t.properties[n],s=new VS(n,t.transform(t.attributes||{},n),a,t.space);t.mustUseProperty&&t.mustUseProperty.includes(n)&&(s.mustUseProperty=!0),e[n]=s,r[l1(n)]=n,r[l1(s.attribute)]=n}return new uf(e,r,t.space)}const UR=Nh({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),qR=Nh({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function HR(t,e){return e in t?t[e]:e}function GR(t,e){return HR(t,e.toLowerCase())}const VR=Nh({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:GR,properties:{xmlns:null,xmlnsXLink:null}}),WR=Nh({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:Ma,ariaAutoComplete:null,ariaBusy:Ma,ariaChecked:Ma,ariaColCount:Ut,ariaColIndex:Ut,ariaColSpan:Ut,ariaControls:Jn,ariaCurrent:null,ariaDescribedBy:Jn,ariaDetails:null,ariaDisabled:Ma,ariaDropEffect:Jn,ariaErrorMessage:null,ariaExpanded:Ma,ariaFlowTo:Jn,ariaGrabbed:Ma,ariaHasPopup:null,ariaHidden:Ma,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Jn,ariaLevel:Ut,ariaLive:null,ariaModal:Ma,ariaMultiLine:Ma,ariaMultiSelectable:Ma,ariaOrientation:null,ariaOwns:Jn,ariaPlaceholder:null,ariaPosInSet:Ut,ariaPressed:Ma,ariaReadOnly:Ma,ariaRelevant:null,ariaRequired:Ma,ariaRoleDescription:Jn,ariaRowCount:Ut,ariaRowIndex:Ut,ariaRowSpan:Ut,ariaSelected:Ma,ariaSetSize:Ut,ariaSort:null,ariaValueMax:Ut,ariaValueMin:Ut,ariaValueNow:Ut,ariaValueText:null,role:null}}),gJ=Nh({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:GR,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Jd,acceptCharset:Jn,accessKey:Jn,action:null,allow:null,allowFullScreen:Qr,allowPaymentRequest:Qr,allowUserMedia:Qr,alt:null,as:null,async:Qr,autoCapitalize:null,autoComplete:Jn,autoFocus:Qr,autoPlay:Qr,blocking:Jn,capture:null,charSet:null,checked:Qr,cite:null,className:Jn,cols:Ut,colSpan:null,content:null,contentEditable:Ma,controls:Qr,controlsList:Jn,coords:Ut|Jd,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Qr,defer:Qr,dir:null,dirName:null,disabled:Qr,download:$R,draggable:Ma,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Qr,formTarget:null,headers:Jn,height:Ut,hidden:Qr,high:Ut,href:null,hrefLang:null,htmlFor:Jn,httpEquiv:Jn,id:null,imageSizes:null,imageSrcSet:null,inert:Qr,inputMode:null,integrity:null,is:null,isMap:Qr,itemId:null,itemProp:Jn,itemRef:Jn,itemScope:Qr,itemType:Jn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Qr,low:Ut,manifest:null,max:null,maxLength:Ut,media:null,method:null,min:null,minLength:Ut,multiple:Qr,muted:Qr,name:null,nonce:null,noModule:Qr,noValidate:Qr,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Qr,optimum:Ut,pattern:null,ping:Jn,placeholder:null,playsInline:Qr,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Qr,referrerPolicy:null,rel:Jn,required:Qr,reversed:Qr,rows:Ut,rowSpan:Ut,sandbox:Jn,scope:null,scoped:Qr,seamless:Qr,selected:Qr,shadowRootClonable:Qr,shadowRootDelegatesFocus:Qr,shadowRootMode:null,shape:null,size:Ut,sizes:null,slot:null,span:Ut,spellCheck:Ma,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ut,step:null,style:null,tabIndex:Ut,target:null,title:null,translate:null,type:null,typeMustMatch:Qr,useMap:null,value:Ma,width:Ut,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Jn,axis:null,background:null,bgColor:null,border:Ut,borderColor:null,bottomMargin:Ut,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Qr,declare:Qr,event:null,face:null,frame:null,frameBorder:null,hSpace:Ut,leftMargin:Ut,link:null,longDesc:null,lowSrc:null,marginHeight:Ut,marginWidth:Ut,noResize:Qr,noHref:Qr,noShade:Qr,noWrap:Qr,object:null,profile:null,prompt:null,rev:null,rightMargin:Ut,rules:null,scheme:null,scrolling:Ma,standby:null,summary:null,text:null,topMargin:Ut,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ut,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Qr,disableRemotePlayback:Qr,prefix:null,property:null,results:Ut,security:null,unselectable:null}}),fJ=Nh({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:HR,properties:{about:Ei,accentHeight:Ut,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ut,amplitude:Ut,arabicForm:null,ascent:Ut,attributeName:null,attributeType:null,azimuth:Ut,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ut,by:null,calcMode:null,capHeight:Ut,className:Jn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ut,diffuseConstant:Ut,direction:null,display:null,dur:null,divisor:Ut,dominantBaseline:null,download:Qr,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ut,enableBackground:null,end:null,event:null,exponent:Ut,externalResourcesRequired:null,fill:null,fillOpacity:Ut,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Jd,g2:Jd,glyphName:Jd,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ut,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ut,horizOriginX:Ut,horizOriginY:Ut,id:null,ideographic:Ut,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ut,k:Ut,k1:Ut,k2:Ut,k3:Ut,k4:Ut,kernelMatrix:Ei,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ut,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ut,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ut,overlineThickness:Ut,paintOrder:null,panose1:null,path:null,pathLength:Ut,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Jn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ut,pointsAtY:Ut,pointsAtZ:Ut,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ei,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ei,rev:Ei,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ei,requiredFeatures:Ei,requiredFonts:Ei,requiredFormats:Ei,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ut,specularExponent:Ut,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ut,strikethroughThickness:Ut,string:null,stroke:null,strokeDashArray:Ei,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ut,strokeOpacity:Ut,strokeWidth:null,style:null,surfaceScale:Ut,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ei,tabIndex:Ut,tableValues:null,target:null,targetX:Ut,targetY:Ut,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ei,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ut,underlineThickness:Ut,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ut,values:null,vAlphabetic:Ut,vMathematical:Ut,vectorEffect:null,vHanging:Ut,vIdeographic:Ut,version:null,vertAdvY:Ut,vertOriginX:Ut,vertOriginY:Ut,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ut,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),mJ=/^data[-\w.:]+$/i,TA=/-[a-z]/g,yJ=/[A-Z]/g;function bJ(t,e){const r=l1(e);let n=e,a=Ji;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&mJ.test(e)){if(e.charAt(4)==="-"){const s=e.slice(5).replace(TA,vJ);n="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=e.slice(4);if(!TA.test(s)){let i=s.replace(yJ,xJ);i.charAt(0)!=="-"&&(i="-"+i),e="data"+i}}a=VS}return new a(n,e)}function xJ(t){return"-"+t.toLowerCase()}function vJ(t){return t.charAt(1).toUpperCase()}const wJ=zR([qR,UR,VR,WR,gJ],"html"),YR=zR([qR,UR,VR,WR,fJ],"svg"),SJ={},kJ={}.hasOwnProperty,QR=yR("type",{handlers:{root:CJ,element:PJ,text:AJ,comment:NJ,doctype:_J}});function TJ(t,e){const n=(e||SJ).space;return QR(t,n==="svg"?YR:wJ)}function CJ(t,e){const r={nodeName:"#document",mode:(t.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=WS(t.children,r,e),Ph(t,r),r}function EJ(t,e){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=WS(t.children,r,e),Ph(t,r),r}function _J(t){const e={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return Ph(t,e),e}function AJ(t){const e={nodeName:"#text",value:t.value,parentNode:null};return Ph(t,e),e}function NJ(t){const e={nodeName:"#comment",data:t.value,parentNode:null};return Ph(t,e),e}function PJ(t,e){const r=e;let n=r;t.type==="element"&&t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=YR);const a=[];let s;if(t.properties){for(s in t.properties)if(s!=="children"&&kJ.call(t.properties,s)){const c=IJ(n,s,t.properties[s]);c&&a.push(c)}}const i=n.space,l={nodeName:t.tagName,tagName:t.tagName,attrs:a,namespaceURI:bu[i],childNodes:[],parentNode:null};return l.childNodes=WS(t.children,l,n),Ph(t,l),t.tagName==="template"&&t.content&&(l.content=EJ(t.content,n)),l}function IJ(t,e,r){const n=bJ(t,e);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?II(r):FI(r));const a={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const s=a.name.indexOf(":");s<0?a.prefix="":(a.name=a.name.slice(s+1),a.prefix=n.attribute.slice(0,s)),a.namespace=bu[n.space]}return a}function WS(t,e,r){let n=-1;const a=[];if(t)for(;++n<t.length;){const s=QR(t[n],r);s.parentNode=e,a.push(s)}return a}function Ph(t,e){const r=t.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,e.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const RJ=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],DJ=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),oa="";var ue;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(ue||(ue={}));const Zs={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function KR(t){return t>=55296&&t<=57343}function LJ(t){return t>=56320&&t<=57343}function MJ(t,e){return(t-55296)*1024+9216+e}function XR(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function JR(t){return t>=64976&&t<=65007||DJ.has(t)}var lt;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(lt||(lt={}));const OJ=65536;class jJ{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=OJ,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,r){const{line:n,col:a,offset:s}=this,i=a+r,l=s+r;return{code:e,startLine:n,endLine:n,startCol:i,endCol:i,startOffset:l,endOffset:l}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(LJ(r))return this.pos++,this._addGap(),MJ(e,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,ue.EOF;return this._err(lt.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,r){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,r){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(e,this.pos);for(let n=0;n<e.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==e.charCodeAt(n))return!1;return!0}peek(e){const r=this.pos+e;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,ue.EOF;const n=this.html.charCodeAt(r);return n===ue.CARRIAGE_RETURN?ue.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,ue.EOF;let e=this.html.charCodeAt(this.pos);return e===ue.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,ue.LINE_FEED):e===ue.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,KR(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===ue.LINE_FEED||e===ue.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){XR(e)?this._err(lt.controlCharacterInInputStream):JR(e)&&this._err(lt.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var nn;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(nn||(nn={}));function ZR(t,e){for(let r=t.attrs.length-1;r>=0;r--)if(t.attrs[r].name===e)return t.attrs[r].value;return null}const BJ=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),FJ=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function zJ(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=FJ.get(t))!==null&&e!==void 0?e:t}var Xa;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(Xa||(Xa={}));const $J=32;var Ec;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Ec||(Ec={}));function u1(t){return t>=Xa.ZERO&&t<=Xa.NINE}function UJ(t){return t>=Xa.UPPER_A&&t<=Xa.UPPER_F||t>=Xa.LOWER_A&&t<=Xa.LOWER_F}function qJ(t){return t>=Xa.UPPER_A&&t<=Xa.UPPER_Z||t>=Xa.LOWER_A&&t<=Xa.LOWER_Z||u1(t)}function HJ(t){return t===Xa.EQUALS||qJ(t)}var Ka;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(Ka||(Ka={}));var Al;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(Al||(Al={}));class GJ{constructor(e,r,n){this.decodeTree=e,this.emitCodePoint=r,this.errors=n,this.state=Ka.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=Al.Strict}startEntity(e){this.decodeMode=e,this.state=Ka.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,r){switch(this.state){case Ka.EntityStart:return e.charCodeAt(r)===Xa.NUM?(this.state=Ka.NumericStart,this.consumed+=1,this.stateNumericStart(e,r+1)):(this.state=Ka.NamedEntity,this.stateNamedEntity(e,r));case Ka.NumericStart:return this.stateNumericStart(e,r);case Ka.NumericDecimal:return this.stateNumericDecimal(e,r);case Ka.NumericHex:return this.stateNumericHex(e,r);case Ka.NamedEntity:return this.stateNamedEntity(e,r)}}stateNumericStart(e,r){return r>=e.length?-1:(e.charCodeAt(r)|$J)===Xa.LOWER_X?(this.state=Ka.NumericHex,this.consumed+=1,this.stateNumericHex(e,r+1)):(this.state=Ka.NumericDecimal,this.stateNumericDecimal(e,r))}addToNumericResult(e,r,n,a){if(r!==n){const s=n-r;this.result=this.result*Math.pow(a,s)+Number.parseInt(e.substr(r,s),a),this.consumed+=s}}stateNumericHex(e,r){const n=r;for(;r<e.length;){const a=e.charCodeAt(r);if(u1(a)||UJ(a))r+=1;else return this.addToNumericResult(e,n,r,16),this.emitNumericEntity(a,3)}return this.addToNumericResult(e,n,r,16),-1}stateNumericDecimal(e,r){const n=r;for(;r<e.length;){const a=e.charCodeAt(r);if(u1(a))r+=1;else return this.addToNumericResult(e,n,r,10),this.emitNumericEntity(a,2)}return this.addToNumericResult(e,n,r,10),-1}emitNumericEntity(e,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Xa.SEMI)this.consumed+=1;else if(this.decodeMode===Al.Strict)return 0;return this.emitCodePoint(zJ(this.result),this.consumed),this.errors&&(e!==Xa.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,r){const{decodeTree:n}=this;let a=n[this.treeIndex],s=(a&Ec.VALUE_LENGTH)>>14;for(;r<e.length;r++,this.excess++){const i=e.charCodeAt(r);if(this.treeIndex=VJ(n,a,this.treeIndex+Math.max(1,s),i),this.treeIndex<0)return this.result===0||this.decodeMode===Al.Attribute&&(s===0||HJ(i))?0:this.emitNotTerminatedNamedEntity();if(a=n[this.treeIndex],s=(a&Ec.VALUE_LENGTH)>>14,s!==0){if(i===Xa.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==Al.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:r,decodeTree:n}=this,a=(n[r]&Ec.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,a,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,r,n){const{decodeTree:a}=this;return this.emitCodePoint(r===1?a[e]&~Ec.VALUE_LENGTH:a[e+1],n),r===3&&this.emitCodePoint(a[e+2],n),n}end(){var e;switch(this.state){case Ka.NamedEntity:return this.result!==0&&(this.decodeMode!==Al.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Ka.NumericDecimal:return this.emitNumericEntity(0,2);case Ka.NumericHex:return this.emitNumericEntity(0,3);case Ka.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Ka.EntityStart:return 0}}}function VJ(t,e,r,n){const a=(e&Ec.BRANCH_LENGTH)>>7,s=e&Ec.JUMP_TABLE;if(a===0)return s!==0&&n===s?r:-1;if(s){const c=n-s;return c<0||c>=a?-1:t[r+c]-1}let i=r,l=i+a-1;for(;i<=l;){const c=i+l>>>1,d=t[c];if(d<n)i=c+1;else if(d>n)l=c-1;else return t[c+a]}return-1}var Pt;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(Pt||(Pt={}));var Eu;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(Eu||(Eu={}));var Wi;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(Wi||(Wi={}));var Je;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SEARCH="search",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(Je||(Je={}));var A;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SEARCH=94]="SEARCH",t[t.SECTION=95]="SECTION",t[t.SELECT=96]="SELECT",t[t.SOURCE=97]="SOURCE",t[t.SMALL=98]="SMALL",t[t.SPAN=99]="SPAN",t[t.STRIKE=100]="STRIKE",t[t.STRONG=101]="STRONG",t[t.STYLE=102]="STYLE",t[t.SUB=103]="SUB",t[t.SUMMARY=104]="SUMMARY",t[t.SUP=105]="SUP",t[t.TABLE=106]="TABLE",t[t.TBODY=107]="TBODY",t[t.TEMPLATE=108]="TEMPLATE",t[t.TEXTAREA=109]="TEXTAREA",t[t.TFOOT=110]="TFOOT",t[t.TD=111]="TD",t[t.TH=112]="TH",t[t.THEAD=113]="THEAD",t[t.TITLE=114]="TITLE",t[t.TR=115]="TR",t[t.TRACK=116]="TRACK",t[t.TT=117]="TT",t[t.U=118]="U",t[t.UL=119]="UL",t[t.SVG=120]="SVG",t[t.VAR=121]="VAR",t[t.WBR=122]="WBR",t[t.XMP=123]="XMP"})(A||(A={}));const WJ=new Map([[Je.A,A.A],[Je.ADDRESS,A.ADDRESS],[Je.ANNOTATION_XML,A.ANNOTATION_XML],[Je.APPLET,A.APPLET],[Je.AREA,A.AREA],[Je.ARTICLE,A.ARTICLE],[Je.ASIDE,A.ASIDE],[Je.B,A.B],[Je.BASE,A.BASE],[Je.BASEFONT,A.BASEFONT],[Je.BGSOUND,A.BGSOUND],[Je.BIG,A.BIG],[Je.BLOCKQUOTE,A.BLOCKQUOTE],[Je.BODY,A.BODY],[Je.BR,A.BR],[Je.BUTTON,A.BUTTON],[Je.CAPTION,A.CAPTION],[Je.CENTER,A.CENTER],[Je.CODE,A.CODE],[Je.COL,A.COL],[Je.COLGROUP,A.COLGROUP],[Je.DD,A.DD],[Je.DESC,A.DESC],[Je.DETAILS,A.DETAILS],[Je.DIALOG,A.DIALOG],[Je.DIR,A.DIR],[Je.DIV,A.DIV],[Je.DL,A.DL],[Je.DT,A.DT],[Je.EM,A.EM],[Je.EMBED,A.EMBED],[Je.FIELDSET,A.FIELDSET],[Je.FIGCAPTION,A.FIGCAPTION],[Je.FIGURE,A.FIGURE],[Je.FONT,A.FONT],[Je.FOOTER,A.FOOTER],[Je.FOREIGN_OBJECT,A.FOREIGN_OBJECT],[Je.FORM,A.FORM],[Je.FRAME,A.FRAME],[Je.FRAMESET,A.FRAMESET],[Je.H1,A.H1],[Je.H2,A.H2],[Je.H3,A.H3],[Je.H4,A.H4],[Je.H5,A.H5],[Je.H6,A.H6],[Je.HEAD,A.HEAD],[Je.HEADER,A.HEADER],[Je.HGROUP,A.HGROUP],[Je.HR,A.HR],[Je.HTML,A.HTML],[Je.I,A.I],[Je.IMG,A.IMG],[Je.IMAGE,A.IMAGE],[Je.INPUT,A.INPUT],[Je.IFRAME,A.IFRAME],[Je.KEYGEN,A.KEYGEN],[Je.LABEL,A.LABEL],[Je.LI,A.LI],[Je.LINK,A.LINK],[Je.LISTING,A.LISTING],[Je.MAIN,A.MAIN],[Je.MALIGNMARK,A.MALIGNMARK],[Je.MARQUEE,A.MARQUEE],[Je.MATH,A.MATH],[Je.MENU,A.MENU],[Je.META,A.META],[Je.MGLYPH,A.MGLYPH],[Je.MI,A.MI],[Je.MO,A.MO],[Je.MN,A.MN],[Je.MS,A.MS],[Je.MTEXT,A.MTEXT],[Je.NAV,A.NAV],[Je.NOBR,A.NOBR],[Je.NOFRAMES,A.NOFRAMES],[Je.NOEMBED,A.NOEMBED],[Je.NOSCRIPT,A.NOSCRIPT],[Je.OBJECT,A.OBJECT],[Je.OL,A.OL],[Je.OPTGROUP,A.OPTGROUP],[Je.OPTION,A.OPTION],[Je.P,A.P],[Je.PARAM,A.PARAM],[Je.PLAINTEXT,A.PLAINTEXT],[Je.PRE,A.PRE],[Je.RB,A.RB],[Je.RP,A.RP],[Je.RT,A.RT],[Je.RTC,A.RTC],[Je.RUBY,A.RUBY],[Je.S,A.S],[Je.SCRIPT,A.SCRIPT],[Je.SEARCH,A.SEARCH],[Je.SECTION,A.SECTION],[Je.SELECT,A.SELECT],[Je.SOURCE,A.SOURCE],[Je.SMALL,A.SMALL],[Je.SPAN,A.SPAN],[Je.STRIKE,A.STRIKE],[Je.STRONG,A.STRONG],[Je.STYLE,A.STYLE],[Je.SUB,A.SUB],[Je.SUMMARY,A.SUMMARY],[Je.SUP,A.SUP],[Je.TABLE,A.TABLE],[Je.TBODY,A.TBODY],[Je.TEMPLATE,A.TEMPLATE],[Je.TEXTAREA,A.TEXTAREA],[Je.TFOOT,A.TFOOT],[Je.TD,A.TD],[Je.TH,A.TH],[Je.THEAD,A.THEAD],[Je.TITLE,A.TITLE],[Je.TR,A.TR],[Je.TRACK,A.TRACK],[Je.TT,A.TT],[Je.U,A.U],[Je.UL,A.UL],[Je.SVG,A.SVG],[Je.VAR,A.VAR],[Je.WBR,A.WBR],[Je.XMP,A.XMP]]);function Ih(t){var e;return(e=WJ.get(t))!==null&&e!==void 0?e:A.UNKNOWN}const Ot=A,YJ={[Pt.HTML]:new Set([Ot.ADDRESS,Ot.APPLET,Ot.AREA,Ot.ARTICLE,Ot.ASIDE,Ot.BASE,Ot.BASEFONT,Ot.BGSOUND,Ot.BLOCKQUOTE,Ot.BODY,Ot.BR,Ot.BUTTON,Ot.CAPTION,Ot.CENTER,Ot.COL,Ot.COLGROUP,Ot.DD,Ot.DETAILS,Ot.DIR,Ot.DIV,Ot.DL,Ot.DT,Ot.EMBED,Ot.FIELDSET,Ot.FIGCAPTION,Ot.FIGURE,Ot.FOOTER,Ot.FORM,Ot.FRAME,Ot.FRAMESET,Ot.H1,Ot.H2,Ot.H3,Ot.H4,Ot.H5,Ot.H6,Ot.HEAD,Ot.HEADER,Ot.HGROUP,Ot.HR,Ot.HTML,Ot.IFRAME,Ot.IMG,Ot.INPUT,Ot.LI,Ot.LINK,Ot.LISTING,Ot.MAIN,Ot.MARQUEE,Ot.MENU,Ot.META,Ot.NAV,Ot.NOEMBED,Ot.NOFRAMES,Ot.NOSCRIPT,Ot.OBJECT,Ot.OL,Ot.P,Ot.PARAM,Ot.PLAINTEXT,Ot.PRE,Ot.SCRIPT,Ot.SECTION,Ot.SELECT,Ot.SOURCE,Ot.STYLE,Ot.SUMMARY,Ot.TABLE,Ot.TBODY,Ot.TD,Ot.TEMPLATE,Ot.TEXTAREA,Ot.TFOOT,Ot.TH,Ot.THEAD,Ot.TITLE,Ot.TR,Ot.TRACK,Ot.UL,Ot.WBR,Ot.XMP]),[Pt.MATHML]:new Set([Ot.MI,Ot.MO,Ot.MN,Ot.MS,Ot.MTEXT,Ot.ANNOTATION_XML]),[Pt.SVG]:new Set([Ot.TITLE,Ot.FOREIGN_OBJECT,Ot.DESC]),[Pt.XLINK]:new Set,[Pt.XML]:new Set,[Pt.XMLNS]:new Set},d1=new Set([Ot.H1,Ot.H2,Ot.H3,Ot.H4,Ot.H5,Ot.H6]);Je.STYLE,Je.SCRIPT,Je.XMP,Je.IFRAME,Je.NOEMBED,Je.NOFRAMES,Je.PLAINTEXT;var pe;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(pe||(pe={}));const ka={DATA:pe.DATA,RCDATA:pe.RCDATA,RAWTEXT:pe.RAWTEXT,SCRIPT_DATA:pe.SCRIPT_DATA,PLAINTEXT:pe.PLAINTEXT,CDATA_SECTION:pe.CDATA_SECTION};function QJ(t){return t>=ue.DIGIT_0&&t<=ue.DIGIT_9}function Kp(t){return t>=ue.LATIN_CAPITAL_A&&t<=ue.LATIN_CAPITAL_Z}function KJ(t){return t>=ue.LATIN_SMALL_A&&t<=ue.LATIN_SMALL_Z}function vc(t){return KJ(t)||Kp(t)}function CA(t){return vc(t)||QJ(t)}function Dm(t){return t+32}function eD(t){return t===ue.SPACE||t===ue.LINE_FEED||t===ue.TABULATION||t===ue.FORM_FEED}function EA(t){return eD(t)||t===ue.SOLIDUS||t===ue.GREATER_THAN_SIGN}function XJ(t){return t===ue.NULL?lt.nullCharacterReference:t>1114111?lt.characterReferenceOutsideUnicodeRange:KR(t)?lt.surrogateCharacterReference:JR(t)?lt.noncharacterCharacterReference:XR(t)||t===ue.CARRIAGE_RETURN?lt.controlCharacterReference:null}class JJ{constructor(e,r){this.options=e,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=pe.DATA,this.returnState=pe.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new jJ(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new GJ(BJ,(n,a)=>{this.preprocessor.pos=this.entityStartPos+a-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(lt.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(lt.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const a=XJ(n);a&&this._err(a,1)}}:void 0)}_err(e,r=0){var n,a;(a=(n=this.handler).onParseError)===null||a===void 0||a.call(n,this.preprocessor.getError(e,r))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e?.())}write(e,r,n){this.active=!0,this.preprocessor.write(e,r),this._runParsingLoop(),this.paused||n?.()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let r=0;r<e;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,r){return this.preprocessor.startsWith(e,r)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:nn.START_TAG,tagName:"",tagID:A.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:nn.END_TAG,tagName:"",tagID:A.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:nn.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:nn.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,r){this.currentCharacterToken={type:e,chars:r,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,r;const n=this.currentToken;if(ZR(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const a=(e=(r=n.location).attrs)!==null&&e!==void 0?e:r.attrs=Object.create(null);a[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(lt.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=Ih(e.tagName),e.type===nn.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(lt.endTagWithAttributes),e.selfClosing&&this._err(lt.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case nn.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case nn.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case nn.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:nn.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,r)}_emitCodePoint(e){const r=eD(e)?nn.WHITESPACE_CHARACTER:e===ue.NULL?nn.NULL_CHARACTER:nn.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(nn.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=pe.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?Al.Attribute:Al.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===pe.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===pe.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===pe.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case pe.DATA:{this._stateData(e);break}case pe.RCDATA:{this._stateRcdata(e);break}case pe.RAWTEXT:{this._stateRawtext(e);break}case pe.SCRIPT_DATA:{this._stateScriptData(e);break}case pe.PLAINTEXT:{this._statePlaintext(e);break}case pe.TAG_OPEN:{this._stateTagOpen(e);break}case pe.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case pe.TAG_NAME:{this._stateTagName(e);break}case pe.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case pe.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case pe.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case pe.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case pe.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case pe.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case pe.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case pe.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case pe.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case pe.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case pe.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case pe.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case pe.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case pe.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case pe.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case pe.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case pe.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case pe.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case pe.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case pe.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case pe.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case pe.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case pe.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case pe.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case pe.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case pe.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case pe.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case pe.BOGUS_COMMENT:{this._stateBogusComment(e);break}case pe.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case pe.COMMENT_START:{this._stateCommentStart(e);break}case pe.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case pe.COMMENT:{this._stateComment(e);break}case pe.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case pe.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case pe.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case pe.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case pe.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case pe.COMMENT_END:{this._stateCommentEnd(e);break}case pe.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case pe.DOCTYPE:{this._stateDoctype(e);break}case pe.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case pe.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case pe.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case pe.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case pe.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case pe.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case pe.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case pe.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case pe.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case pe.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case pe.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case pe.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case pe.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case pe.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case pe.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case pe.CDATA_SECTION:{this._stateCdataSection(e);break}case pe.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case pe.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case pe.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case pe.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case ue.LESS_THAN_SIGN:{this.state=pe.TAG_OPEN;break}case ue.AMPERSAND:{this._startCharacterReference();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitCodePoint(e);break}case ue.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case ue.AMPERSAND:{this._startCharacterReference();break}case ue.LESS_THAN_SIGN:{this.state=pe.RCDATA_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case ue.LESS_THAN_SIGN:{this.state=pe.RAWTEXT_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(vc(e))this._createStartTagToken(),this.state=pe.TAG_NAME,this._stateTagName(e);else switch(e){case ue.EXCLAMATION_MARK:{this.state=pe.MARKUP_DECLARATION_OPEN;break}case ue.SOLIDUS:{this.state=pe.END_TAG_OPEN;break}case ue.QUESTION_MARK:{this._err(lt.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=pe.BOGUS_COMMENT,this._stateBogusComment(e);break}case ue.EOF:{this._err(lt.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(lt.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=pe.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(vc(e))this._createEndTagToken(),this.state=pe.TAG_NAME,this._stateTagName(e);else switch(e){case ue.GREATER_THAN_SIGN:{this._err(lt.missingEndTagName),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(lt.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=pe.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.BEFORE_ATTRIBUTE_NAME;break}case ue.SOLIDUS:{this.state=pe.SELF_CLOSING_START_TAG;break}case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentTagToken();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.tagName+=oa;break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(Kp(e)?Dm(e):e)}}_stateRcdataLessThanSign(e){e===ue.SOLIDUS?this.state=pe.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=pe.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){vc(e)?(this.state=pe.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=pe.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=pe.BEFORE_ATTRIBUTE_NAME,!1;case ue.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=pe.SELF_CLOSING_START_TAG,!1;case ue.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=pe.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=pe.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===ue.SOLIDUS?this.state=pe.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=pe.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){vc(e)?(this.state=pe.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=pe.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=pe.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case ue.SOLIDUS:{this.state=pe.SCRIPT_DATA_END_TAG_OPEN;break}case ue.EXCLAMATION_MARK:{this.state=pe.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=pe.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){vc(e)?(this.state=pe.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=pe.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=pe.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===ue.HYPHEN_MINUS?(this.state=pe.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=pe.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===ue.HYPHEN_MINUS?(this.state=pe.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=pe.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case ue.HYPHEN_MINUS:{this.state=pe.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case ue.HYPHEN_MINUS:{this.state=pe.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.state=pe.SCRIPT_DATA_ESCAPED,this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=pe.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case ue.HYPHEN_MINUS:{this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case ue.GREATER_THAN_SIGN:{this.state=pe.SCRIPT_DATA,this._emitChars(">");break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.state=pe.SCRIPT_DATA_ESCAPED,this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=pe.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===ue.SOLIDUS?this.state=pe.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:vc(e)?(this._emitChars("<"),this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=pe.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){vc(e)?(this.state=pe.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=pe.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=pe.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Zs.SCRIPT,!1)&&EA(this.preprocessor.peek(Zs.SCRIPT.length))){this._emitCodePoint(e);for(let r=0;r<Zs.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=pe.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case ue.HYPHEN_MINUS:{this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case ue.HYPHEN_MINUS:{this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case ue.HYPHEN_MINUS:{this._emitChars("-");break}case ue.LESS_THAN_SIGN:{this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case ue.GREATER_THAN_SIGN:{this.state=pe.SCRIPT_DATA,this._emitChars(">");break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(oa);break}case ue.EOF:{this._err(lt.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===ue.SOLIDUS?(this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Zs.SCRIPT,!1)&&EA(this.preprocessor.peek(Zs.SCRIPT.length))){this._emitCodePoint(e);for(let r=0;r<Zs.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=pe.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=pe.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.SOLIDUS:case ue.GREATER_THAN_SIGN:case ue.EOF:{this.state=pe.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case ue.EQUALS_SIGN:{this._err(lt.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=pe.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=pe.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:case ue.SOLIDUS:case ue.GREATER_THAN_SIGN:case ue.EOF:{this._leaveAttrName(),this.state=pe.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case ue.EQUALS_SIGN:{this._leaveAttrName(),this.state=pe.BEFORE_ATTRIBUTE_VALUE;break}case ue.QUOTATION_MARK:case ue.APOSTROPHE:case ue.LESS_THAN_SIGN:{this._err(lt.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.currentAttr.name+=oa;break}default:this.currentAttr.name+=String.fromCodePoint(Kp(e)?Dm(e):e)}}_stateAfterAttributeName(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.SOLIDUS:{this.state=pe.SELF_CLOSING_START_TAG;break}case ue.EQUALS_SIGN:{this.state=pe.BEFORE_ATTRIBUTE_VALUE;break}case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentTagToken();break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=pe.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.QUOTATION_MARK:{this.state=pe.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{this.state=pe.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingAttributeValue),this.state=pe.DATA,this.emitCurrentTagToken();break}default:this.state=pe.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case ue.QUOTATION_MARK:{this.state=pe.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case ue.AMPERSAND:{this._startCharacterReference();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.currentAttr.value+=oa;break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case ue.APOSTROPHE:{this.state=pe.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case ue.AMPERSAND:{this._startCharacterReference();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.currentAttr.value+=oa;break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this._leaveAttrValue(),this.state=pe.BEFORE_ATTRIBUTE_NAME;break}case ue.AMPERSAND:{this._startCharacterReference();break}case ue.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=pe.DATA,this.emitCurrentTagToken();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),this.currentAttr.value+=oa;break}case ue.QUOTATION_MARK:case ue.APOSTROPHE:case ue.LESS_THAN_SIGN:case ue.EQUALS_SIGN:case ue.GRAVE_ACCENT:{this._err(lt.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this._leaveAttrValue(),this.state=pe.BEFORE_ATTRIBUTE_NAME;break}case ue.SOLIDUS:{this._leaveAttrValue(),this.state=pe.SELF_CLOSING_START_TAG;break}case ue.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=pe.DATA,this.emitCurrentTagToken();break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this._err(lt.missingWhitespaceBetweenAttributes),this.state=pe.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case ue.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=pe.DATA,this.emitCurrentTagToken();break}case ue.EOF:{this._err(lt.eofInTag),this._emitEOFToken();break}default:this._err(lt.unexpectedSolidusInTag),this.state=pe.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const r=this.currentToken;switch(e){case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentComment(r);break}case ue.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.data+=oa;break}default:r.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Zs.DASH_DASH,!0)?(this._createCommentToken(Zs.DASH_DASH.length+1),this.state=pe.COMMENT_START):this._consumeSequenceIfMatch(Zs.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Zs.DOCTYPE.length+1),this.state=pe.DOCTYPE):this._consumeSequenceIfMatch(Zs.CDATA_START,!0)?this.inForeignNode?this.state=pe.CDATA_SECTION:(this._err(lt.cdataInHtmlContent),this._createCommentToken(Zs.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=pe.BOGUS_COMMENT):this._ensureHibernation()||(this._err(lt.incorrectlyOpenedComment),this._createCommentToken(2),this.state=pe.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case ue.HYPHEN_MINUS:{this.state=pe.COMMENT_START_DASH;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptClosingOfEmptyComment),this.state=pe.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=pe.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const r=this.currentToken;switch(e){case ue.HYPHEN_MINUS:{this.state=pe.COMMENT_END;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptClosingOfEmptyComment),this.state=pe.DATA,this.emitCurrentComment(r);break}case ue.EOF:{this._err(lt.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=pe.COMMENT,this._stateComment(e)}}_stateComment(e){const r=this.currentToken;switch(e){case ue.HYPHEN_MINUS:{this.state=pe.COMMENT_END_DASH;break}case ue.LESS_THAN_SIGN:{r.data+="<",this.state=pe.COMMENT_LESS_THAN_SIGN;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.data+=oa;break}case ue.EOF:{this._err(lt.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const r=this.currentToken;switch(e){case ue.EXCLAMATION_MARK:{r.data+="!",this.state=pe.COMMENT_LESS_THAN_SIGN_BANG;break}case ue.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=pe.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===ue.HYPHEN_MINUS?this.state=pe.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=pe.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===ue.HYPHEN_MINUS?this.state=pe.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=pe.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==ue.GREATER_THAN_SIGN&&e!==ue.EOF&&this._err(lt.nestedComment),this.state=pe.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const r=this.currentToken;switch(e){case ue.HYPHEN_MINUS:{this.state=pe.COMMENT_END;break}case ue.EOF:{this._err(lt.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=pe.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const r=this.currentToken;switch(e){case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentComment(r);break}case ue.EXCLAMATION_MARK:{this.state=pe.COMMENT_END_BANG;break}case ue.HYPHEN_MINUS:{r.data+="-";break}case ue.EOF:{this._err(lt.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=pe.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const r=this.currentToken;switch(e){case ue.HYPHEN_MINUS:{r.data+="--!",this.state=pe.COMMENT_END_DASH;break}case ue.GREATER_THAN_SIGN:{this._err(lt.incorrectlyClosedComment),this.state=pe.DATA,this.emitCurrentComment(r);break}case ue.EOF:{this._err(lt.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=pe.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.BEFORE_DOCTYPE_NAME;break}case ue.GREATER_THAN_SIGN:{this.state=pe.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case ue.EOF:{this._err(lt.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingWhitespaceBeforeDoctypeName),this.state=pe.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(Kp(e))this._createDoctypeToken(String.fromCharCode(Dm(e))),this.state=pe.DOCTYPE_NAME;else switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.NULL:{this._err(lt.unexpectedNullCharacter),this._createDoctypeToken(oa),this.state=pe.DOCTYPE_NAME;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=pe.DOCTYPE_NAME}}_stateDoctypeName(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.AFTER_DOCTYPE_NAME;break}case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.name+=oa;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(Kp(e)?Dm(e):e)}}_stateAfterDoctypeName(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Zs.PUBLIC,!1)?this.state=pe.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Zs.SYSTEM,!1)?this.state=pe.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(lt.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case ue.QUOTATION_MARK:{this._err(lt.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=pe.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{this._err(lt.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=pe.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.QUOTATION_MARK:{r.publicId="",this.state=pe.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{r.publicId="",this.state=pe.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const r=this.currentToken;switch(e){case ue.QUOTATION_MARK:{this.state=pe.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.publicId+=oa;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const r=this.currentToken;switch(e){case ue.APOSTROPHE:{this.state=pe.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.publicId+=oa;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case ue.GREATER_THAN_SIGN:{this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.QUOTATION_MARK:{this._err(lt.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{this._err(lt.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.QUOTATION_MARK:{r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:{this.state=pe.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case ue.QUOTATION_MARK:{this._err(lt.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{this._err(lt.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.QUOTATION_MARK:{r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case ue.APOSTROPHE:{r.systemId="",this.state=pe.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case ue.GREATER_THAN_SIGN:{this._err(lt.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.DATA,this.emitCurrentDoctype(r);break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const r=this.currentToken;switch(e){case ue.QUOTATION_MARK:{this.state=pe.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.systemId+=oa;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const r=this.currentToken;switch(e){case ue.APOSTROPHE:{this.state=pe.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter),r.systemId+=oa;break}case ue.GREATER_THAN_SIGN:{this._err(lt.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const r=this.currentToken;switch(e){case ue.SPACE:case ue.LINE_FEED:case ue.TABULATION:case ue.FORM_FEED:break;case ue.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.EOF:{this._err(lt.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(lt.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=pe.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const r=this.currentToken;switch(e){case ue.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=pe.DATA;break}case ue.NULL:{this._err(lt.unexpectedNullCharacter);break}case ue.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case ue.RIGHT_SQUARE_BRACKET:{this.state=pe.CDATA_SECTION_BRACKET;break}case ue.EOF:{this._err(lt.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===ue.RIGHT_SQUARE_BRACKET?this.state=pe.CDATA_SECTION_END:(this._emitChars("]"),this.state=pe.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case ue.GREATER_THAN_SIGN:{this.state=pe.DATA;break}case ue.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=pe.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}e===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(ue.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&CA(this.preprocessor.peek(1))?pe.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){CA(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===ue.SEMICOLON&&this._err(lt.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}}const tD=new Set([A.DD,A.DT,A.LI,A.OPTGROUP,A.OPTION,A.P,A.RB,A.RP,A.RT,A.RTC]),_A=new Set([...tD,A.CAPTION,A.COLGROUP,A.TBODY,A.TD,A.TFOOT,A.TH,A.THEAD,A.TR]),z0=new Set([A.APPLET,A.CAPTION,A.HTML,A.MARQUEE,A.OBJECT,A.TABLE,A.TD,A.TEMPLATE,A.TH]),ZJ=new Set([...z0,A.OL,A.UL]),eZ=new Set([...z0,A.BUTTON]),AA=new Set([A.ANNOTATION_XML,A.MI,A.MN,A.MO,A.MS,A.MTEXT]),NA=new Set([A.DESC,A.FOREIGN_OBJECT,A.TITLE]),tZ=new Set([A.TR,A.TEMPLATE,A.HTML]),rZ=new Set([A.TBODY,A.TFOOT,A.THEAD,A.TEMPLATE,A.HTML]),nZ=new Set([A.TABLE,A.TEMPLATE,A.HTML]),aZ=new Set([A.TD,A.TH]);class sZ{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=A.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===A.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===Pt.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,r){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,r,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,r){const n=this._indexOf(e);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(e,r,n){const a=this._indexOf(e)+1;this.items.splice(a,0,r),this.tagIDs.splice(a,0,n),this.stackTop++,a===this.stackTop&&this._updateCurrentElement(),this.current&&this.currentTagId!==void 0&&this.handler.onItemPush(this.current,this.currentTagId,a===this.stackTop)}popUntilTagNamePopped(e){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(e,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==Pt.HTML);this.shortenToLength(Math.max(r,0))}shortenToLength(e){for(;this.stackTop>=e;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<e)}}popUntilElementPopped(e){const r=this._indexOf(e);this.shortenToLength(Math.max(r,0))}popUntilPopped(e,r){const n=this._indexOfTagNames(e,r);this.shortenToLength(Math.max(n,0))}popUntilNumberedHeaderPopped(){this.popUntilPopped(d1,Pt.HTML)}popUntilTableCellPopped(){this.popUntilPopped(aZ,Pt.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,r){for(let n=this.stackTop;n>=0;n--)if(e.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(e,r){const n=this._indexOfTagNames(e,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(nZ,Pt.HTML)}clearBackToTableBodyContext(){this.clearBackTo(rZ,Pt.HTML)}clearBackToTableRowContext(){this.clearBackTo(tZ,Pt.HTML)}remove(e){const r=this._indexOf(e);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===A.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const r=this._indexOf(e)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===A.HTML}hasInDynamicScope(e,r){for(let n=this.stackTop;n>=0;n--){const a=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case Pt.HTML:{if(a===e)return!0;if(r.has(a))return!1;break}case Pt.SVG:{if(NA.has(a))return!1;break}case Pt.MATHML:{if(AA.has(a))return!1;break}}}return!0}hasInScope(e){return this.hasInDynamicScope(e,z0)}hasInListItemScope(e){return this.hasInDynamicScope(e,ZJ)}hasInButtonScope(e){return this.hasInDynamicScope(e,eZ)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const r=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case Pt.HTML:{if(d1.has(r))return!0;if(z0.has(r))return!1;break}case Pt.SVG:{if(NA.has(r))return!1;break}case Pt.MATHML:{if(AA.has(r))return!1;break}}}return!0}hasInTableScope(e){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===Pt.HTML)switch(this.tagIDs[r]){case e:return!0;case A.TABLE:case A.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===Pt.HTML)switch(this.tagIDs[e]){case A.TBODY:case A.THEAD:case A.TFOOT:return!0;case A.TABLE:case A.HTML:return!1}return!0}hasInSelectScope(e){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===Pt.HTML)switch(this.tagIDs[r]){case e:return!0;case A.OPTION:case A.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;this.currentTagId!==void 0&&tD.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;this.currentTagId!==void 0&&_A.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==void 0&&this.currentTagId!==e&&_A.has(this.currentTagId);)this.pop()}}const Vv=3;var Ho;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(Ho||(Ho={}));const PA={type:Ho.Marker};class iZ{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,r){const n=[],a=r.length,s=this.treeAdapter.getTagName(e),i=this.treeAdapter.getNamespaceURI(e);for(let l=0;l<this.entries.length;l++){const c=this.entries[l];if(c.type===Ho.Marker)break;const{element:d}=c;if(this.treeAdapter.getTagName(d)===s&&this.treeAdapter.getNamespaceURI(d)===i){const p=this.treeAdapter.getAttrList(d);p.length===a&&n.push({idx:l,attrs:p})}}return n}_ensureNoahArkCondition(e){if(this.entries.length<Vv)return;const r=this.treeAdapter.getAttrList(e),n=this._getNoahArkConditionCandidates(e,r);if(n.length<Vv)return;const a=new Map(r.map(i=>[i.name,i.value]));let s=0;for(let i=0;i<n.length;i++){const l=n[i];l.attrs.every(c=>a.get(c.name)===c.value)&&(s+=1,s>=Vv&&this.entries.splice(l.idx,1))}}insertMarker(){this.entries.unshift(PA)}pushElement(e,r){this._ensureNoahArkCondition(e),this.entries.unshift({type:Ho.Element,element:e,token:r})}insertElementAfterBookmark(e,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:Ho.Element,element:e,token:r})}removeEntry(e){const r=this.entries.indexOf(e);r!==-1&&this.entries.splice(r,1)}clearToLastMarker(){const e=this.entries.indexOf(PA);e===-1?this.entries.length=0:this.entries.splice(0,e+1)}getElementEntryInScopeWithTagName(e){const r=this.entries.find(n=>n.type===Ho.Marker||this.treeAdapter.getTagName(n.element)===e);return r&&r.type===Ho.Element?r:null}getElementEntry(e){return this.entries.find(r=>r.type===Ho.Element&&r.element===e)}}const wc={createDocument(){return{nodeName:"#document",mode:Wi.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,r){return{nodeName:t,tagName:t,attrs:r,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},createTextNode(t){return{nodeName:"#text",value:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,r){const n=t.childNodes.indexOf(r);t.childNodes.splice(n,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,r,n){const a=t.childNodes.find(s=>s.nodeName==="#documentType");if(a)a.name=e,a.publicId=r,a.systemId=n;else{const s={nodeName:"#documentType",name:e,publicId:r,systemId:n,parentNode:null};wc.appendChild(t,s)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){const e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){const r=t.childNodes[t.childNodes.length-1];if(wc.isTextNode(r)){r.value+=e;return}}wc.appendChild(t,wc.createTextNode(e))},insertTextBefore(t,e,r){const n=t.childNodes[t.childNodes.indexOf(r)-1];n&&wc.isTextNode(n)?n.value+=e:wc.insertBefore(t,wc.createTextNode(e),r)},adoptAttributes(t,e){const r=new Set(t.attrs.map(n=>n.name));for(let n=0;n<e.length;n++)r.has(e[n].name)||t.attrs.push(e[n])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}},rD="html",oZ="about:legacy-compat",lZ="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",nD=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],cZ=[...nD,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],uZ=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),aD=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],dZ=[...aD,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function IA(t,e){return e.some(r=>t.startsWith(r))}function hZ(t){return t.name===rD&&t.publicId===null&&(t.systemId===null||t.systemId===oZ)}function pZ(t){if(t.name!==rD)return Wi.QUIRKS;const{systemId:e}=t;if(e&&e.toLowerCase()===lZ)return Wi.QUIRKS;let{publicId:r}=t;if(r!==null){if(r=r.toLowerCase(),uZ.has(r))return Wi.QUIRKS;let n=e===null?cZ:nD;if(IA(r,n))return Wi.QUIRKS;if(n=e===null?aD:dZ,IA(r,n))return Wi.LIMITED_QUIRKS}return Wi.NO_QUIRKS}const RA={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},gZ="definitionurl",fZ="definitionURL",mZ=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),yZ=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:Pt.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:Pt.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:Pt.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:Pt.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:Pt.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:Pt.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:Pt.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:Pt.XML}],["xml:space",{prefix:"xml",name:"space",namespace:Pt.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:Pt.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:Pt.XMLNS}]]),bZ=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),xZ=new Set([A.B,A.BIG,A.BLOCKQUOTE,A.BODY,A.BR,A.CENTER,A.CODE,A.DD,A.DIV,A.DL,A.DT,A.EM,A.EMBED,A.H1,A.H2,A.H3,A.H4,A.H5,A.H6,A.HEAD,A.HR,A.I,A.IMG,A.LI,A.LISTING,A.MENU,A.META,A.NOBR,A.OL,A.P,A.PRE,A.RUBY,A.S,A.SMALL,A.SPAN,A.STRONG,A.STRIKE,A.SUB,A.SUP,A.TABLE,A.TT,A.U,A.UL,A.VAR]);function vZ(t){const e=t.tagID;return e===A.FONT&&t.attrs.some(({name:n})=>n===Eu.COLOR||n===Eu.SIZE||n===Eu.FACE)||xZ.has(e)}function sD(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===gZ){t.attrs[e].name=fZ;break}}function iD(t){for(let e=0;e<t.attrs.length;e++){const r=mZ.get(t.attrs[e].name);r!=null&&(t.attrs[e].name=r)}}function YS(t){for(let e=0;e<t.attrs.length;e++){const r=yZ.get(t.attrs[e].name);r&&(t.attrs[e].prefix=r.prefix,t.attrs[e].name=r.name,t.attrs[e].namespace=r.namespace)}}function wZ(t){const e=bZ.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=Ih(t.tagName))}function SZ(t,e){return e===Pt.MATHML&&(t===A.MI||t===A.MO||t===A.MN||t===A.MS||t===A.MTEXT)}function kZ(t,e,r){if(e===Pt.MATHML&&t===A.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===Eu.ENCODING){const a=r[n].value.toLowerCase();return a===RA.TEXT_HTML||a===RA.APPLICATION_XML}}return e===Pt.SVG&&(t===A.FOREIGN_OBJECT||t===A.DESC||t===A.TITLE)}function TZ(t,e,r,n){return(!n||n===Pt.HTML)&&kZ(t,e,r)||(!n||n===Pt.MATHML)&&SZ(t,e)}const CZ="hidden",EZ=8,_Z=3;var we;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(we||(we={}));const AZ={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},oD=new Set([A.TABLE,A.TBODY,A.TFOOT,A.THEAD,A.TR]),DA={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:wc,onParseError:null};class LA{constructor(e,r,n=null,a=null){this.fragmentContext=n,this.scriptHandler=a,this.currentToken=null,this.stopped=!1,this.insertionMode=we.INITIAL,this.originalInsertionMode=we.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...DA,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new JJ(this.options,this),this.activeFormattingElements=new iZ(this.treeAdapter),this.fragmentContextID=n?Ih(this.treeAdapter.getTagName(n)):A.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new sZ(this.document,this.treeAdapter,this)}static parse(e,r){const n=new this(r);return n.tokenizer.write(e,!0),n.document}static getFragmentParser(e,r){const n={...DA,...r};e??(e=n.treeAdapter.createElement(Je.TEMPLATE,Pt.HTML,[]));const a=n.treeAdapter.createElement("documentmock",Pt.HTML,[]),s=new this(n,a,e);return s.fragmentContextID===A.TEMPLATE&&s.tmplInsertionModeStack.unshift(we.IN_TEMPLATE),s._initTokenizerForFragmentParsing(),s._insertFakeRootElement(),s._resetInsertionMode(),s._findFormInFragmentContext(),s}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,r),r}_err(e,r,n){var a;if(!this.onParseError)return;const s=(a=e.location)!==null&&a!==void 0?a:AZ,i={code:r,startLine:s.startLine,startCol:s.startCol,startOffset:s.startOffset,endLine:n?s.startLine:s.endLine,endCol:n?s.startCol:s.endCol,endOffset:n?s.startOffset:s.endOffset};this.onParseError(i)}onItemPush(e,r,n){var a,s;(s=(a=this.treeAdapter).onItemPush)===null||s===void 0||s.call(a,e),n&&this.openElements.stackTop>0&&this._setContextModes(e,r)}onItemPop(e,r){var n,a;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(a=(n=this.treeAdapter).onItemPop)===null||a===void 0||a.call(n,e,this.openElements.current),r){let s,i;this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,i=this.fragmentContextID):{current:s,currentTagId:i}=this.openElements,this._setContextModes(s,i)}}_setContextModes(e,r){const n=e===this.document||e&&this.treeAdapter.getNamespaceURI(e)===Pt.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&e!==void 0&&r!==void 0&&!this._isIntegrationPoint(r,e)}_switchToTextParsing(e,r){this._insertElement(e,Pt.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=we.TEXT}switchToPlaintextParsing(){this.insertionMode=we.TEXT,this.originalInsertionMode=we.IN_BODY,this.tokenizer.state=ka.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===Je.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==Pt.HTML))switch(this.fragmentContextID){case A.TITLE:case A.TEXTAREA:{this.tokenizer.state=ka.RCDATA;break}case A.STYLE:case A.XMP:case A.IFRAME:case A.NOEMBED:case A.NOFRAMES:case A.NOSCRIPT:{this.tokenizer.state=ka.RAWTEXT;break}case A.SCRIPT:{this.tokenizer.state=ka.SCRIPT_DATA;break}case A.PLAINTEXT:{this.tokenizer.state=ka.PLAINTEXT;break}}}_setDocumentType(e){const r=e.name||"",n=e.publicId||"",a=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,a),e.location){const i=this.treeAdapter.getChildNodes(this.document).find(l=>this.treeAdapter.isDocumentTypeNode(l));i&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}}_attachElementToTree(e,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(e,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n??this.document,e)}}_appendElement(e,r){const n=this.treeAdapter.createElement(e.tagName,r,e.attrs);this._attachElementToTree(n,e.location)}_insertElement(e,r){const n=this.treeAdapter.createElement(e.tagName,r,e.attrs);this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID)}_insertFakeElement(e,r){const n=this.treeAdapter.createElement(e,Pt.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(e){const r=this.treeAdapter.createElement(e.tagName,Pt.HTML,e.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,e.location),this.openElements.push(r,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(Je.HTML,Pt.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,A.HTML)}_appendCommentNode(e,r){const n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,e.location)}_insertCharacters(e){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,e.chars,n):this.treeAdapter.insertText(r,e.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,e.chars)),!e.location)return;const a=this.treeAdapter.getChildNodes(r),s=n?a.lastIndexOf(n):a.length,i=a[s-1];if(this.treeAdapter.getNodeSourceCodeLocation(i)){const{endLine:c,endCol:d,endOffset:p}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(i,{endLine:c,endCol:d,endOffset:p})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(i,e.location)}_adoptNodes(e,r){for(let n=this.treeAdapter.getFirstChild(e);n;n=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(e,r){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&r.location){const n=r.location,a=this.treeAdapter.getTagName(e),s=r.type===nn.END_TAG&&a===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,s)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,e.tagID===A.SVG&&this.treeAdapter.getTagName(r)===Je.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===Pt.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===A.MGLYPH||e.tagID===A.MALIGNMARK)&&n!==void 0&&!this._isIntegrationPoint(n,r,Pt.HTML)}_processToken(e){switch(e.type){case nn.CHARACTER:{this.onCharacter(e);break}case nn.NULL_CHARACTER:{this.onNullCharacter(e);break}case nn.COMMENT:{this.onComment(e);break}case nn.DOCTYPE:{this.onDoctype(e);break}case nn.START_TAG:{this._processStartTag(e);break}case nn.END_TAG:{this.onEndTag(e);break}case nn.EOF:{this.onEof(e);break}case nn.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,r,n){const a=this.treeAdapter.getNamespaceURI(r),s=this.treeAdapter.getAttrList(r);return TZ(e,a,s,n)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const r=this.activeFormattingElements.entries.findIndex(a=>a.type===Ho.Marker||this.openElements.contains(a.element)),n=r===-1?e-1:r-1;for(let a=n;a>=0;a--){const s=this.activeFormattingElements.entries[a];this._insertElement(s.token,this.treeAdapter.getNamespaceURI(s.element)),s.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=we.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(A.P),this.openElements.popUntilTagNamePopped(A.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case A.TR:{this.insertionMode=we.IN_ROW;return}case A.TBODY:case A.THEAD:case A.TFOOT:{this.insertionMode=we.IN_TABLE_BODY;return}case A.CAPTION:{this.insertionMode=we.IN_CAPTION;return}case A.COLGROUP:{this.insertionMode=we.IN_COLUMN_GROUP;return}case A.TABLE:{this.insertionMode=we.IN_TABLE;return}case A.BODY:{this.insertionMode=we.IN_BODY;return}case A.FRAMESET:{this.insertionMode=we.IN_FRAMESET;return}case A.SELECT:{this._resetInsertionModeForSelect(e);return}case A.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case A.HTML:{this.insertionMode=this.headElement?we.AFTER_HEAD:we.BEFORE_HEAD;return}case A.TD:case A.TH:{if(e>0){this.insertionMode=we.IN_CELL;return}break}case A.HEAD:{if(e>0){this.insertionMode=we.IN_HEAD;return}break}}this.insertionMode=we.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let r=e-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===A.TEMPLATE)break;if(n===A.TABLE){this.insertionMode=we.IN_SELECT_IN_TABLE;return}}this.insertionMode=we.IN_SELECT}_isElementCausesFosterParenting(e){return oD.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this.openElements.currentTagId!==void 0&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const r=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case A.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===Pt.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case A.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,e,r.beforeElement):this.treeAdapter.appendChild(r.parent,e)}_isSpecialElement(e,r){const n=this.treeAdapter.getNamespaceURI(e);return YJ[n].has(r)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){ate(this,e);return}switch(this.insertionMode){case we.INITIAL:{Lp(this,e);break}case we.BEFORE_HTML:{fg(this,e);break}case we.BEFORE_HEAD:{mg(this,e);break}case we.IN_HEAD:{yg(this,e);break}case we.IN_HEAD_NO_SCRIPT:{bg(this,e);break}case we.AFTER_HEAD:{xg(this,e);break}case we.IN_BODY:case we.IN_CAPTION:case we.IN_CELL:case we.IN_TEMPLATE:{cD(this,e);break}case we.TEXT:case we.IN_SELECT:case we.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case we.IN_TABLE:case we.IN_TABLE_BODY:case we.IN_ROW:{Wv(this,e);break}case we.IN_TABLE_TEXT:{fD(this,e);break}case we.IN_COLUMN_GROUP:{$0(this,e);break}case we.AFTER_BODY:{U0(this,e);break}case we.AFTER_AFTER_BODY:{o0(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){nte(this,e);return}switch(this.insertionMode){case we.INITIAL:{Lp(this,e);break}case we.BEFORE_HTML:{fg(this,e);break}case we.BEFORE_HEAD:{mg(this,e);break}case we.IN_HEAD:{yg(this,e);break}case we.IN_HEAD_NO_SCRIPT:{bg(this,e);break}case we.AFTER_HEAD:{xg(this,e);break}case we.TEXT:{this._insertCharacters(e);break}case we.IN_TABLE:case we.IN_TABLE_BODY:case we.IN_ROW:{Wv(this,e);break}case we.IN_COLUMN_GROUP:{$0(this,e);break}case we.AFTER_BODY:{U0(this,e);break}case we.AFTER_AFTER_BODY:{o0(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){h1(this,e);return}switch(this.insertionMode){case we.INITIAL:case we.BEFORE_HTML:case we.BEFORE_HEAD:case we.IN_HEAD:case we.IN_HEAD_NO_SCRIPT:case we.AFTER_HEAD:case we.IN_BODY:case we.IN_TABLE:case we.IN_CAPTION:case we.IN_COLUMN_GROUP:case we.IN_TABLE_BODY:case we.IN_ROW:case we.IN_CELL:case we.IN_SELECT:case we.IN_SELECT_IN_TABLE:case we.IN_TEMPLATE:case we.IN_FRAMESET:case we.AFTER_FRAMESET:{h1(this,e);break}case we.IN_TABLE_TEXT:{Mp(this,e);break}case we.AFTER_BODY:{MZ(this,e);break}case we.AFTER_AFTER_BODY:case we.AFTER_AFTER_FRAMESET:{OZ(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case we.INITIAL:{jZ(this,e);break}case we.BEFORE_HEAD:case we.IN_HEAD:case we.IN_HEAD_NO_SCRIPT:case we.AFTER_HEAD:{this._err(e,lt.misplacedDoctype);break}case we.IN_TABLE_TEXT:{Mp(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,lt.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?ste(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case we.INITIAL:{Lp(this,e);break}case we.BEFORE_HTML:{BZ(this,e);break}case we.BEFORE_HEAD:{zZ(this,e);break}case we.IN_HEAD:{wo(this,e);break}case we.IN_HEAD_NO_SCRIPT:{qZ(this,e);break}case we.AFTER_HEAD:{GZ(this,e);break}case we.IN_BODY:{ks(this,e);break}case we.IN_TABLE:{ph(this,e);break}case we.IN_TABLE_TEXT:{Mp(this,e);break}case we.IN_CAPTION:{$ee(this,e);break}case we.IN_COLUMN_GROUP:{XS(this,e);break}case we.IN_TABLE_BODY:{Vy(this,e);break}case we.IN_ROW:{Wy(this,e);break}case we.IN_CELL:{Hee(this,e);break}case we.IN_SELECT:{bD(this,e);break}case we.IN_SELECT_IN_TABLE:{Vee(this,e);break}case we.IN_TEMPLATE:{Yee(this,e);break}case we.AFTER_BODY:{Kee(this,e);break}case we.IN_FRAMESET:{Xee(this,e);break}case we.AFTER_FRAMESET:{Zee(this,e);break}case we.AFTER_AFTER_BODY:{tte(this,e);break}case we.AFTER_AFTER_FRAMESET:{rte(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?ite(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case we.INITIAL:{Lp(this,e);break}case we.BEFORE_HTML:{FZ(this,e);break}case we.BEFORE_HEAD:{$Z(this,e);break}case we.IN_HEAD:{UZ(this,e);break}case we.IN_HEAD_NO_SCRIPT:{HZ(this,e);break}case we.AFTER_HEAD:{VZ(this,e);break}case we.IN_BODY:{Gy(this,e);break}case we.TEXT:{Iee(this,e);break}case we.IN_TABLE:{Mg(this,e);break}case we.IN_TABLE_TEXT:{Mp(this,e);break}case we.IN_CAPTION:{Uee(this,e);break}case we.IN_COLUMN_GROUP:{qee(this,e);break}case we.IN_TABLE_BODY:{p1(this,e);break}case we.IN_ROW:{yD(this,e);break}case we.IN_CELL:{Gee(this,e);break}case we.IN_SELECT:{xD(this,e);break}case we.IN_SELECT_IN_TABLE:{Wee(this,e);break}case we.IN_TEMPLATE:{Qee(this,e);break}case we.AFTER_BODY:{wD(this,e);break}case we.IN_FRAMESET:{Jee(this,e);break}case we.AFTER_FRAMESET:{ete(this,e);break}case we.AFTER_AFTER_BODY:{o0(this,e);break}}}onEof(e){switch(this.insertionMode){case we.INITIAL:{Lp(this,e);break}case we.BEFORE_HTML:{fg(this,e);break}case we.BEFORE_HEAD:{mg(this,e);break}case we.IN_HEAD:{yg(this,e);break}case we.IN_HEAD_NO_SCRIPT:{bg(this,e);break}case we.AFTER_HEAD:{xg(this,e);break}case we.IN_BODY:case we.IN_TABLE:case we.IN_CAPTION:case we.IN_COLUMN_GROUP:case we.IN_TABLE_BODY:case we.IN_ROW:case we.IN_CELL:case we.IN_SELECT:case we.IN_SELECT_IN_TABLE:{pD(this,e);break}case we.TEXT:{Ree(this,e);break}case we.IN_TABLE_TEXT:{Mp(this,e);break}case we.IN_TEMPLATE:{vD(this,e);break}case we.AFTER_BODY:case we.IN_FRAMESET:case we.AFTER_FRAMESET:case we.AFTER_AFTER_BODY:case we.AFTER_AFTER_FRAMESET:{KS(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===ue.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case we.IN_HEAD:case we.IN_HEAD_NO_SCRIPT:case we.AFTER_HEAD:case we.TEXT:case we.IN_COLUMN_GROUP:case we.IN_SELECT:case we.IN_SELECT_IN_TABLE:case we.IN_FRAMESET:case we.AFTER_FRAMESET:{this._insertCharacters(e);break}case we.IN_BODY:case we.IN_CAPTION:case we.IN_CELL:case we.IN_TEMPLATE:case we.AFTER_BODY:case we.AFTER_AFTER_BODY:case we.AFTER_AFTER_FRAMESET:{lD(this,e);break}case we.IN_TABLE:case we.IN_TABLE_BODY:case we.IN_ROW:{Wv(this,e);break}case we.IN_TABLE_TEXT:{gD(this,e);break}}}}function NZ(t,e){let r=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return r?t.openElements.contains(r.element)?t.openElements.hasInScope(e.tagID)||(r=null):(t.activeFormattingElements.removeEntry(r),r=null):hD(t,e),r}function PZ(t,e){let r=null,n=t.openElements.stackTop;for(;n>=0;n--){const a=t.openElements.items[n];if(a===e.element)break;t._isSpecialElement(a,t.openElements.tagIDs[n])&&(r=a)}return r||(t.openElements.shortenToLength(Math.max(n,0)),t.activeFormattingElements.removeEntry(e)),r}function IZ(t,e,r){let n=e,a=t.openElements.getCommonAncestor(e);for(let s=0,i=a;i!==r;s++,i=a){a=t.openElements.getCommonAncestor(i);const l=t.activeFormattingElements.getElementEntry(i),c=l&&s>=_Z;!l||c?(c&&t.activeFormattingElements.removeEntry(l),t.openElements.remove(i)):(i=RZ(t,l),n===e&&(t.activeFormattingElements.bookmark=l),t.treeAdapter.detachNode(n),t.treeAdapter.appendChild(i,n),n=i)}return n}function RZ(t,e){const r=t.treeAdapter.getNamespaceURI(e.element),n=t.treeAdapter.createElement(e.token.tagName,r,e.token.attrs);return t.openElements.replace(e.element,n),e.element=n,n}function DZ(t,e,r){const n=t.treeAdapter.getTagName(e),a=Ih(n);if(t._isElementCausesFosterParenting(a))t._fosterParentElement(r);else{const s=t.treeAdapter.getNamespaceURI(e);a===A.TEMPLATE&&s===Pt.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,r)}}function LZ(t,e,r){const n=t.treeAdapter.getNamespaceURI(r.element),{token:a}=r,s=t.treeAdapter.createElement(a.tagName,n,a.attrs);t._adoptNodes(e,s),t.treeAdapter.appendChild(e,s),t.activeFormattingElements.insertElementAfterBookmark(s,a),t.activeFormattingElements.removeEntry(r),t.openElements.remove(r.element),t.openElements.insertAfter(e,s,a.tagID)}function QS(t,e){for(let r=0;r<EZ;r++){const n=NZ(t,e);if(!n)break;const a=PZ(t,n);if(!a)break;t.activeFormattingElements.bookmark=n;const s=IZ(t,a,n.element),i=t.openElements.getCommonAncestor(n.element);t.treeAdapter.detachNode(s),i&&DZ(t,i,s),LZ(t,a,n)}}function h1(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function MZ(t,e){t._appendCommentNode(e,t.openElements.items[0])}function OZ(t,e){t._appendCommentNode(e,t.document)}function KS(t,e){if(t.stopped=!0,e.location){const r=t.fragmentContext?0:2;for(let n=t.openElements.stackTop;n>=r;n--)t._setEndLocation(t.openElements.items[n],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){const n=t.openElements.items[0],a=t.treeAdapter.getNodeSourceCodeLocation(n);if(a&&!a.endTag&&(t._setEndLocation(n,e),t.openElements.stackTop>=1)){const s=t.openElements.items[1],i=t.treeAdapter.getNodeSourceCodeLocation(s);i&&!i.endTag&&t._setEndLocation(s,e)}}}}function jZ(t,e){t._setDocumentType(e);const r=e.forceQuirks?Wi.QUIRKS:pZ(e);hZ(e)||t._err(e,lt.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,r),t.insertionMode=we.BEFORE_HTML}function Lp(t,e){t._err(e,lt.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,Wi.QUIRKS),t.insertionMode=we.BEFORE_HTML,t._processToken(e)}function BZ(t,e){e.tagID===A.HTML?(t._insertElement(e,Pt.HTML),t.insertionMode=we.BEFORE_HEAD):fg(t,e)}function FZ(t,e){const r=e.tagID;(r===A.HTML||r===A.HEAD||r===A.BODY||r===A.BR)&&fg(t,e)}function fg(t,e){t._insertFakeRootElement(),t.insertionMode=we.BEFORE_HEAD,t._processToken(e)}function zZ(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.HEAD:{t._insertElement(e,Pt.HTML),t.headElement=t.openElements.current,t.insertionMode=we.IN_HEAD;break}default:mg(t,e)}}function $Z(t,e){const r=e.tagID;r===A.HEAD||r===A.BODY||r===A.HTML||r===A.BR?mg(t,e):t._err(e,lt.endTagWithoutMatchingOpenElement)}function mg(t,e){t._insertFakeElement(Je.HEAD,A.HEAD),t.headElement=t.openElements.current,t.insertionMode=we.IN_HEAD,t._processToken(e)}function wo(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.BASE:case A.BASEFONT:case A.BGSOUND:case A.LINK:case A.META:{t._appendElement(e,Pt.HTML),e.ackSelfClosing=!0;break}case A.TITLE:{t._switchToTextParsing(e,ka.RCDATA);break}case A.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,ka.RAWTEXT):(t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_HEAD_NO_SCRIPT);break}case A.NOFRAMES:case A.STYLE:{t._switchToTextParsing(e,ka.RAWTEXT);break}case A.SCRIPT:{t._switchToTextParsing(e,ka.SCRIPT_DATA);break}case A.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=we.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(we.IN_TEMPLATE);break}case A.HEAD:{t._err(e,lt.misplacedStartTagForHeadElement);break}default:yg(t,e)}}function UZ(t,e){switch(e.tagID){case A.HEAD:{t.openElements.pop(),t.insertionMode=we.AFTER_HEAD;break}case A.BODY:case A.BR:case A.HTML:{yg(t,e);break}case A.TEMPLATE:{Uu(t,e);break}default:t._err(e,lt.endTagWithoutMatchingOpenElement)}}function Uu(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==A.TEMPLATE&&t._err(e,lt.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(A.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,lt.endTagWithoutMatchingOpenElement)}function yg(t,e){t.openElements.pop(),t.insertionMode=we.AFTER_HEAD,t._processToken(e)}function qZ(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.BASEFONT:case A.BGSOUND:case A.HEAD:case A.LINK:case A.META:case A.NOFRAMES:case A.STYLE:{wo(t,e);break}case A.NOSCRIPT:{t._err(e,lt.nestedNoscriptInHead);break}default:bg(t,e)}}function HZ(t,e){switch(e.tagID){case A.NOSCRIPT:{t.openElements.pop(),t.insertionMode=we.IN_HEAD;break}case A.BR:{bg(t,e);break}default:t._err(e,lt.endTagWithoutMatchingOpenElement)}}function bg(t,e){const r=e.type===nn.EOF?lt.openElementsLeftAfterEof:lt.disallowedContentInNoscriptInHead;t._err(e,r),t.openElements.pop(),t.insertionMode=we.IN_HEAD,t._processToken(e)}function GZ(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.BODY:{t._insertElement(e,Pt.HTML),t.framesetOk=!1,t.insertionMode=we.IN_BODY;break}case A.FRAMESET:{t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_FRAMESET;break}case A.BASE:case A.BASEFONT:case A.BGSOUND:case A.LINK:case A.META:case A.NOFRAMES:case A.SCRIPT:case A.STYLE:case A.TEMPLATE:case A.TITLE:{t._err(e,lt.abandonedHeadElementChild),t.openElements.push(t.headElement,A.HEAD),wo(t,e),t.openElements.remove(t.headElement);break}case A.HEAD:{t._err(e,lt.misplacedStartTagForHeadElement);break}default:xg(t,e)}}function VZ(t,e){switch(e.tagID){case A.BODY:case A.HTML:case A.BR:{xg(t,e);break}case A.TEMPLATE:{Uu(t,e);break}default:t._err(e,lt.endTagWithoutMatchingOpenElement)}}function xg(t,e){t._insertFakeElement(Je.BODY,A.BODY),t.insertionMode=we.IN_BODY,Hy(t,e)}function Hy(t,e){switch(e.type){case nn.CHARACTER:{cD(t,e);break}case nn.WHITESPACE_CHARACTER:{lD(t,e);break}case nn.COMMENT:{h1(t,e);break}case nn.START_TAG:{ks(t,e);break}case nn.END_TAG:{Gy(t,e);break}case nn.EOF:{pD(t,e);break}}}function lD(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function cD(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function WZ(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function YZ(t,e){const r=t.openElements.tryPeekProperlyNestedBodyElement();r&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(r,e.attrs))}function QZ(t,e){const r=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&r&&(t.treeAdapter.detachNode(r),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_FRAMESET)}function KZ(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML)}function XZ(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t.openElements.currentTagId!==void 0&&d1.has(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,Pt.HTML)}function JZ(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function ZZ(t,e){const r=t.openElements.tmplCount>0;(!t.formElement||r)&&(t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML),r||(t.formElement=t.openElements.current))}function eee(t,e){t.framesetOk=!1;const r=e.tagID;for(let n=t.openElements.stackTop;n>=0;n--){const a=t.openElements.tagIDs[n];if(r===A.LI&&a===A.LI||(r===A.DD||r===A.DT)&&(a===A.DD||a===A.DT)){t.openElements.generateImpliedEndTagsWithExclusion(a),t.openElements.popUntilTagNamePopped(a);break}if(a!==A.ADDRESS&&a!==A.DIV&&a!==A.P&&t._isSpecialElement(t.openElements.items[n],a))break}t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML)}function tee(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML),t.tokenizer.state=ka.PLAINTEXT}function ree(t,e){t.openElements.hasInScope(A.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(A.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML),t.framesetOk=!1}function nee(t,e){const r=t.activeFormattingElements.getElementEntryInScopeWithTagName(Je.A);r&&(QS(t,e),t.openElements.remove(r.element),t.activeFormattingElements.removeEntry(r)),t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function aee(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function see(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(A.NOBR)&&(QS(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,Pt.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function iee(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function oee(t,e){t.treeAdapter.getDocumentMode(t.document)!==Wi.QUIRKS&&t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._insertElement(e,Pt.HTML),t.framesetOk=!1,t.insertionMode=we.IN_TABLE}function uD(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Pt.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function dD(t){const e=ZR(t,Eu.TYPE);return e!=null&&e.toLowerCase()===CZ}function lee(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,Pt.HTML),dD(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function cee(t,e){t._appendElement(e,Pt.HTML),e.ackSelfClosing=!0}function uee(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._appendElement(e,Pt.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function dee(t,e){e.tagName=Je.IMG,e.tagID=A.IMG,uD(t,e)}function hee(t,e){t._insertElement(e,Pt.HTML),t.skipNextNewLine=!0,t.tokenizer.state=ka.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=we.TEXT}function pee(t,e){t.openElements.hasInButtonScope(A.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,ka.RAWTEXT)}function gee(t,e){t.framesetOk=!1,t._switchToTextParsing(e,ka.RAWTEXT)}function MA(t,e){t._switchToTextParsing(e,ka.RAWTEXT)}function fee(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===we.IN_TABLE||t.insertionMode===we.IN_CAPTION||t.insertionMode===we.IN_TABLE_BODY||t.insertionMode===we.IN_ROW||t.insertionMode===we.IN_CELL?we.IN_SELECT_IN_TABLE:we.IN_SELECT}function mee(t,e){t.openElements.currentTagId===A.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML)}function yee(t,e){t.openElements.hasInScope(A.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,Pt.HTML)}function bee(t,e){t.openElements.hasInScope(A.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(A.RTC),t._insertElement(e,Pt.HTML)}function xee(t,e){t._reconstructActiveFormattingElements(),sD(e),YS(e),e.selfClosing?t._appendElement(e,Pt.MATHML):t._insertElement(e,Pt.MATHML),e.ackSelfClosing=!0}function vee(t,e){t._reconstructActiveFormattingElements(),iD(e),YS(e),e.selfClosing?t._appendElement(e,Pt.SVG):t._insertElement(e,Pt.SVG),e.ackSelfClosing=!0}function OA(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,Pt.HTML)}function ks(t,e){switch(e.tagID){case A.I:case A.S:case A.B:case A.U:case A.EM:case A.TT:case A.BIG:case A.CODE:case A.FONT:case A.SMALL:case A.STRIKE:case A.STRONG:{aee(t,e);break}case A.A:{nee(t,e);break}case A.H1:case A.H2:case A.H3:case A.H4:case A.H5:case A.H6:{XZ(t,e);break}case A.P:case A.DL:case A.OL:case A.UL:case A.DIV:case A.DIR:case A.NAV:case A.MAIN:case A.MENU:case A.ASIDE:case A.CENTER:case A.FIGURE:case A.FOOTER:case A.HEADER:case A.HGROUP:case A.DIALOG:case A.DETAILS:case A.ADDRESS:case A.ARTICLE:case A.SEARCH:case A.SECTION:case A.SUMMARY:case A.FIELDSET:case A.BLOCKQUOTE:case A.FIGCAPTION:{KZ(t,e);break}case A.LI:case A.DD:case A.DT:{eee(t,e);break}case A.BR:case A.IMG:case A.WBR:case A.AREA:case A.EMBED:case A.KEYGEN:{uD(t,e);break}case A.HR:{uee(t,e);break}case A.RB:case A.RTC:{yee(t,e);break}case A.RT:case A.RP:{bee(t,e);break}case A.PRE:case A.LISTING:{JZ(t,e);break}case A.XMP:{pee(t,e);break}case A.SVG:{vee(t,e);break}case A.HTML:{WZ(t,e);break}case A.BASE:case A.LINK:case A.META:case A.STYLE:case A.TITLE:case A.SCRIPT:case A.BGSOUND:case A.BASEFONT:case A.TEMPLATE:{wo(t,e);break}case A.BODY:{YZ(t,e);break}case A.FORM:{ZZ(t,e);break}case A.NOBR:{see(t,e);break}case A.MATH:{xee(t,e);break}case A.TABLE:{oee(t,e);break}case A.INPUT:{lee(t,e);break}case A.PARAM:case A.TRACK:case A.SOURCE:{cee(t,e);break}case A.IMAGE:{dee(t,e);break}case A.BUTTON:{ree(t,e);break}case A.APPLET:case A.OBJECT:case A.MARQUEE:{iee(t,e);break}case A.IFRAME:{gee(t,e);break}case A.SELECT:{fee(t,e);break}case A.OPTION:case A.OPTGROUP:{mee(t,e);break}case A.NOEMBED:case A.NOFRAMES:{MA(t,e);break}case A.FRAMESET:{QZ(t,e);break}case A.TEXTAREA:{hee(t,e);break}case A.NOSCRIPT:{t.options.scriptingEnabled?MA(t,e):OA(t,e);break}case A.PLAINTEXT:{tee(t,e);break}case A.COL:case A.TH:case A.TD:case A.TR:case A.HEAD:case A.FRAME:case A.TBODY:case A.TFOOT:case A.THEAD:case A.CAPTION:case A.COLGROUP:break;default:OA(t,e)}}function wee(t,e){if(t.openElements.hasInScope(A.BODY)&&(t.insertionMode=we.AFTER_BODY,t.options.sourceCodeLocationInfo)){const r=t.openElements.tryPeekProperlyNestedBodyElement();r&&t._setEndLocation(r,e)}}function See(t,e){t.openElements.hasInScope(A.BODY)&&(t.insertionMode=we.AFTER_BODY,wD(t,e))}function kee(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r))}function Tee(t){const e=t.openElements.tmplCount>0,{formElement:r}=t;e||(t.formElement=null),(r||e)&&t.openElements.hasInScope(A.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(A.FORM):r&&t.openElements.remove(r))}function Cee(t){t.openElements.hasInButtonScope(A.P)||t._insertFakeElement(Je.P,A.P),t._closePElement()}function Eee(t){t.openElements.hasInListItemScope(A.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(A.LI),t.openElements.popUntilTagNamePopped(A.LI))}function _ee(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.popUntilTagNamePopped(r))}function Aee(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function Nee(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r),t.activeFormattingElements.clearToLastMarker())}function Pee(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(Je.BR,A.BR),t.openElements.pop(),t.framesetOk=!1}function hD(t,e){const r=e.tagName,n=e.tagID;for(let a=t.openElements.stackTop;a>0;a--){const s=t.openElements.items[a],i=t.openElements.tagIDs[a];if(n===i&&(n!==A.UNKNOWN||t.treeAdapter.getTagName(s)===r)){t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.stackTop>=a&&t.openElements.shortenToLength(a);break}if(t._isSpecialElement(s,i))break}}function Gy(t,e){switch(e.tagID){case A.A:case A.B:case A.I:case A.S:case A.U:case A.EM:case A.TT:case A.BIG:case A.CODE:case A.FONT:case A.NOBR:case A.SMALL:case A.STRIKE:case A.STRONG:{QS(t,e);break}case A.P:{Cee(t);break}case A.DL:case A.UL:case A.OL:case A.DIR:case A.DIV:case A.NAV:case A.PRE:case A.MAIN:case A.MENU:case A.ASIDE:case A.BUTTON:case A.CENTER:case A.FIGURE:case A.FOOTER:case A.HEADER:case A.HGROUP:case A.DIALOG:case A.ADDRESS:case A.ARTICLE:case A.DETAILS:case A.SEARCH:case A.SECTION:case A.SUMMARY:case A.LISTING:case A.FIELDSET:case A.BLOCKQUOTE:case A.FIGCAPTION:{kee(t,e);break}case A.LI:{Eee(t);break}case A.DD:case A.DT:{_ee(t,e);break}case A.H1:case A.H2:case A.H3:case A.H4:case A.H5:case A.H6:{Aee(t);break}case A.BR:{Pee(t);break}case A.BODY:{wee(t,e);break}case A.HTML:{See(t,e);break}case A.FORM:{Tee(t);break}case A.APPLET:case A.OBJECT:case A.MARQUEE:{Nee(t,e);break}case A.TEMPLATE:{Uu(t,e);break}default:hD(t,e)}}function pD(t,e){t.tmplInsertionModeStack.length>0?vD(t,e):KS(t,e)}function Iee(t,e){var r;e.tagID===A.SCRIPT&&((r=t.scriptHandler)===null||r===void 0||r.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function Ree(t,e){t._err(e,lt.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function Wv(t,e){if(t.openElements.currentTagId!==void 0&&oD.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=we.IN_TABLE_TEXT,e.type){case nn.CHARACTER:{fD(t,e);break}case nn.WHITESPACE_CHARACTER:{gD(t,e);break}}else df(t,e)}function Dee(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_CAPTION}function Lee(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_COLUMN_GROUP}function Mee(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(Je.COLGROUP,A.COLGROUP),t.insertionMode=we.IN_COLUMN_GROUP,XS(t,e)}function Oee(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_TABLE_BODY}function jee(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(Je.TBODY,A.TBODY),t.insertionMode=we.IN_TABLE_BODY,Vy(t,e)}function Bee(t,e){t.openElements.hasInTableScope(A.TABLE)&&(t.openElements.popUntilTagNamePopped(A.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function Fee(t,e){dD(e)?t._appendElement(e,Pt.HTML):df(t,e),e.ackSelfClosing=!0}function zee(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,Pt.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function ph(t,e){switch(e.tagID){case A.TD:case A.TH:case A.TR:{jee(t,e);break}case A.STYLE:case A.SCRIPT:case A.TEMPLATE:{wo(t,e);break}case A.COL:{Mee(t,e);break}case A.FORM:{zee(t,e);break}case A.TABLE:{Bee(t,e);break}case A.TBODY:case A.TFOOT:case A.THEAD:{Oee(t,e);break}case A.INPUT:{Fee(t,e);break}case A.CAPTION:{Dee(t,e);break}case A.COLGROUP:{Lee(t,e);break}default:df(t,e)}}function Mg(t,e){switch(e.tagID){case A.TABLE:{t.openElements.hasInTableScope(A.TABLE)&&(t.openElements.popUntilTagNamePopped(A.TABLE),t._resetInsertionMode());break}case A.TEMPLATE:{Uu(t,e);break}case A.BODY:case A.CAPTION:case A.COL:case A.COLGROUP:case A.HTML:case A.TBODY:case A.TD:case A.TFOOT:case A.TH:case A.THEAD:case A.TR:break;default:df(t,e)}}function df(t,e){const r=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,Hy(t,e),t.fosterParentingEnabled=r}function gD(t,e){t.pendingCharacterTokens.push(e)}function fD(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function Mp(t,e){let r=0;if(t.hasNonWhitespacePendingCharacterToken)for(;r<t.pendingCharacterTokens.length;r++)df(t,t.pendingCharacterTokens[r]);else for(;r<t.pendingCharacterTokens.length;r++)t._insertCharacters(t.pendingCharacterTokens[r]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}const mD=new Set([A.CAPTION,A.COL,A.COLGROUP,A.TBODY,A.TD,A.TFOOT,A.TH,A.THEAD,A.TR]);function $ee(t,e){const r=e.tagID;mD.has(r)?t.openElements.hasInTableScope(A.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(A.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=we.IN_TABLE,ph(t,e)):ks(t,e)}function Uee(t,e){const r=e.tagID;switch(r){case A.CAPTION:case A.TABLE:{t.openElements.hasInTableScope(A.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(A.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=we.IN_TABLE,r===A.TABLE&&Mg(t,e));break}case A.BODY:case A.COL:case A.COLGROUP:case A.HTML:case A.TBODY:case A.TD:case A.TFOOT:case A.TH:case A.THEAD:case A.TR:break;default:Gy(t,e)}}function XS(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.COL:{t._appendElement(e,Pt.HTML),e.ackSelfClosing=!0;break}case A.TEMPLATE:{wo(t,e);break}default:$0(t,e)}}function qee(t,e){switch(e.tagID){case A.COLGROUP:{t.openElements.currentTagId===A.COLGROUP&&(t.openElements.pop(),t.insertionMode=we.IN_TABLE);break}case A.TEMPLATE:{Uu(t,e);break}case A.COL:break;default:$0(t,e)}}function $0(t,e){t.openElements.currentTagId===A.COLGROUP&&(t.openElements.pop(),t.insertionMode=we.IN_TABLE,t._processToken(e))}function Vy(t,e){switch(e.tagID){case A.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_ROW;break}case A.TH:case A.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(Je.TR,A.TR),t.insertionMode=we.IN_ROW,Wy(t,e);break}case A.CAPTION:case A.COL:case A.COLGROUP:case A.TBODY:case A.TFOOT:case A.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE,ph(t,e));break}default:ph(t,e)}}function p1(t,e){const r=e.tagID;switch(e.tagID){case A.TBODY:case A.TFOOT:case A.THEAD:{t.openElements.hasInTableScope(r)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE);break}case A.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE,Mg(t,e));break}case A.BODY:case A.CAPTION:case A.COL:case A.COLGROUP:case A.HTML:case A.TD:case A.TH:case A.TR:break;default:Mg(t,e)}}function Wy(t,e){switch(e.tagID){case A.TH:case A.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,Pt.HTML),t.insertionMode=we.IN_CELL,t.activeFormattingElements.insertMarker();break}case A.CAPTION:case A.COL:case A.COLGROUP:case A.TBODY:case A.TFOOT:case A.THEAD:case A.TR:{t.openElements.hasInTableScope(A.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE_BODY,Vy(t,e));break}default:ph(t,e)}}function yD(t,e){switch(e.tagID){case A.TR:{t.openElements.hasInTableScope(A.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE_BODY);break}case A.TABLE:{t.openElements.hasInTableScope(A.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE_BODY,p1(t,e));break}case A.TBODY:case A.TFOOT:case A.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(A.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=we.IN_TABLE_BODY,p1(t,e));break}case A.BODY:case A.CAPTION:case A.COL:case A.COLGROUP:case A.HTML:case A.TD:case A.TH:break;default:Mg(t,e)}}function Hee(t,e){const r=e.tagID;mD.has(r)?(t.openElements.hasInTableScope(A.TD)||t.openElements.hasInTableScope(A.TH))&&(t._closeTableCell(),Wy(t,e)):ks(t,e)}function Gee(t,e){const r=e.tagID;switch(r){case A.TD:case A.TH:{t.openElements.hasInTableScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=we.IN_ROW);break}case A.TABLE:case A.TBODY:case A.TFOOT:case A.THEAD:case A.TR:{t.openElements.hasInTableScope(r)&&(t._closeTableCell(),yD(t,e));break}case A.BODY:case A.CAPTION:case A.COL:case A.COLGROUP:case A.HTML:break;default:Gy(t,e)}}function bD(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.OPTION:{t.openElements.currentTagId===A.OPTION&&t.openElements.pop(),t._insertElement(e,Pt.HTML);break}case A.OPTGROUP:{t.openElements.currentTagId===A.OPTION&&t.openElements.pop(),t.openElements.currentTagId===A.OPTGROUP&&t.openElements.pop(),t._insertElement(e,Pt.HTML);break}case A.HR:{t.openElements.currentTagId===A.OPTION&&t.openElements.pop(),t.openElements.currentTagId===A.OPTGROUP&&t.openElements.pop(),t._appendElement(e,Pt.HTML),e.ackSelfClosing=!0;break}case A.INPUT:case A.KEYGEN:case A.TEXTAREA:case A.SELECT:{t.openElements.hasInSelectScope(A.SELECT)&&(t.openElements.popUntilTagNamePopped(A.SELECT),t._resetInsertionMode(),e.tagID!==A.SELECT&&t._processStartTag(e));break}case A.SCRIPT:case A.TEMPLATE:{wo(t,e);break}}}function xD(t,e){switch(e.tagID){case A.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===A.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===A.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===A.OPTGROUP&&t.openElements.pop();break}case A.OPTION:{t.openElements.currentTagId===A.OPTION&&t.openElements.pop();break}case A.SELECT:{t.openElements.hasInSelectScope(A.SELECT)&&(t.openElements.popUntilTagNamePopped(A.SELECT),t._resetInsertionMode());break}case A.TEMPLATE:{Uu(t,e);break}}}function Vee(t,e){const r=e.tagID;r===A.CAPTION||r===A.TABLE||r===A.TBODY||r===A.TFOOT||r===A.THEAD||r===A.TR||r===A.TD||r===A.TH?(t.openElements.popUntilTagNamePopped(A.SELECT),t._resetInsertionMode(),t._processStartTag(e)):bD(t,e)}function Wee(t,e){const r=e.tagID;r===A.CAPTION||r===A.TABLE||r===A.TBODY||r===A.TFOOT||r===A.THEAD||r===A.TR||r===A.TD||r===A.TH?t.openElements.hasInTableScope(r)&&(t.openElements.popUntilTagNamePopped(A.SELECT),t._resetInsertionMode(),t.onEndTag(e)):xD(t,e)}function Yee(t,e){switch(e.tagID){case A.BASE:case A.BASEFONT:case A.BGSOUND:case A.LINK:case A.META:case A.NOFRAMES:case A.SCRIPT:case A.STYLE:case A.TEMPLATE:case A.TITLE:{wo(t,e);break}case A.CAPTION:case A.COLGROUP:case A.TBODY:case A.TFOOT:case A.THEAD:{t.tmplInsertionModeStack[0]=we.IN_TABLE,t.insertionMode=we.IN_TABLE,ph(t,e);break}case A.COL:{t.tmplInsertionModeStack[0]=we.IN_COLUMN_GROUP,t.insertionMode=we.IN_COLUMN_GROUP,XS(t,e);break}case A.TR:{t.tmplInsertionModeStack[0]=we.IN_TABLE_BODY,t.insertionMode=we.IN_TABLE_BODY,Vy(t,e);break}case A.TD:case A.TH:{t.tmplInsertionModeStack[0]=we.IN_ROW,t.insertionMode=we.IN_ROW,Wy(t,e);break}default:t.tmplInsertionModeStack[0]=we.IN_BODY,t.insertionMode=we.IN_BODY,ks(t,e)}}function Qee(t,e){e.tagID===A.TEMPLATE&&Uu(t,e)}function vD(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(A.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):KS(t,e)}function Kee(t,e){e.tagID===A.HTML?ks(t,e):U0(t,e)}function wD(t,e){var r;if(e.tagID===A.HTML){if(t.fragmentContext||(t.insertionMode=we.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===A.HTML){t._setEndLocation(t.openElements.items[0],e);const n=t.openElements.items[1];n&&!(!((r=t.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&t._setEndLocation(n,e)}}else U0(t,e)}function U0(t,e){t.insertionMode=we.IN_BODY,Hy(t,e)}function Xee(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.FRAMESET:{t._insertElement(e,Pt.HTML);break}case A.FRAME:{t._appendElement(e,Pt.HTML),e.ackSelfClosing=!0;break}case A.NOFRAMES:{wo(t,e);break}}}function Jee(t,e){e.tagID===A.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==A.FRAMESET&&(t.insertionMode=we.AFTER_FRAMESET))}function Zee(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.NOFRAMES:{wo(t,e);break}}}function ete(t,e){e.tagID===A.HTML&&(t.insertionMode=we.AFTER_AFTER_FRAMESET)}function tte(t,e){e.tagID===A.HTML?ks(t,e):o0(t,e)}function o0(t,e){t.insertionMode=we.IN_BODY,Hy(t,e)}function rte(t,e){switch(e.tagID){case A.HTML:{ks(t,e);break}case A.NOFRAMES:{wo(t,e);break}}}function nte(t,e){e.chars=oa,t._insertCharacters(e)}function ate(t,e){t._insertCharacters(e),t.framesetOk=!1}function SD(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==Pt.HTML&&t.openElements.currentTagId!==void 0&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function ste(t,e){if(vZ(e))SD(t),t._startTagOutsideForeignContent(e);else{const r=t._getAdjustedCurrentElement(),n=t.treeAdapter.getNamespaceURI(r);n===Pt.MATHML?sD(e):n===Pt.SVG&&(wZ(e),iD(e)),YS(e),e.selfClosing?t._appendElement(e,n):t._insertElement(e,n),e.ackSelfClosing=!0}}function ite(t,e){if(e.tagID===A.P||e.tagID===A.BR){SD(t),t._endTagOutsideForeignContent(e);return}for(let r=t.openElements.stackTop;r>0;r--){const n=t.openElements.items[r];if(t.treeAdapter.getNamespaceURI(n)===Pt.HTML){t._endTagOutsideForeignContent(e);break}const a=t.treeAdapter.getTagName(n);if(a.toLowerCase()===e.tagName){e.tagName=a,t.openElements.shortenToLength(r);break}}}Je.AREA,Je.BASE,Je.BASEFONT,Je.BGSOUND,Je.BR,Je.COL,Je.EMBED,Je.FRAME,Je.HR,Je.IMG,Je.INPUT,Je.KEYGEN,Je.LINK,Je.META,Je.PARAM,Je.SOURCE,Je.TRACK,Je.WBR;const ote=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,lte=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),jA={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function kD(t,e){const r=bte(t),n=yR("type",{handlers:{root:cte,element:ute,text:dte,comment:CD,doctype:hte,raw:gte},unknown:fte}),a={parser:r?new LA(jA):LA.getFragmentParser(void 0,jA),handle(l){n(l,a)},stitches:!1,options:e||{}};n(t,a),Rh(a,Zo());const s=r?a.parser.document:a.parser.getFragment(),i=cJ(s,{file:a.options.file});return a.stitches&&lf(i,"comment",function(l,c,d){const p=l;if(p.value.stitch&&d&&c!==void 0){const g=d.children;return g[c]=p.value.stitch,c}}),i.type==="root"&&i.children.length===1&&i.children[0].type===t.type?i.children[0]:i}function TD(t,e){let r=-1;if(t)for(;++r<t.length;)e.handle(t[r])}function cte(t,e){TD(t.children,e)}function ute(t,e){mte(t,e),TD(t.children,e),yte(t,e)}function dte(t,e){e.parser.tokenizer.state>4&&(e.parser.tokenizer.state=0);const r={type:nn.CHARACTER,chars:t.value,location:hf(t)};Rh(e,Zo(t)),e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)}function hte(t,e){const r={type:nn.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:hf(t)};Rh(e,Zo(t)),e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)}function pte(t,e){e.stitches=!0;const r=xte(t);if("children"in t&&"children"in r){const n=kD({type:"root",children:t.children},e.options);r.children=n.children}CD({type:"comment",value:{stitch:r}},e)}function CD(t,e){const r=t.value,n={type:nn.COMMENT,data:r,location:hf(t)};Rh(e,Zo(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function gte(t,e){if(e.parser.tokenizer.preprocessor.html="",e.parser.tokenizer.preprocessor.pos=-1,e.parser.tokenizer.preprocessor.lastGapPos=-2,e.parser.tokenizer.preprocessor.gapStack=[],e.parser.tokenizer.preprocessor.skipNextNewLine=!1,e.parser.tokenizer.preprocessor.lastChunkWritten=!1,e.parser.tokenizer.preprocessor.endOfChunkHit=!1,e.parser.tokenizer.preprocessor.isEol=!1,ED(e,Zo(t)),e.parser.tokenizer.write(e.options.tagfilter?t.value.replace(ote,"&lt;$1$2"):t.value,!1),e.parser.tokenizer._runParsingLoop(),e.parser.tokenizer.state===72||e.parser.tokenizer.state===78){e.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=e.parser.tokenizer._consume();e.parser.tokenizer._callState(r)}}function fte(t,e){const r=t;if(e.options.passThrough&&e.options.passThrough.includes(r.type))pte(r,e);else{let n="";throw lte.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function Rh(t,e){ED(t,e);const r=t.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=t.parser.tokenizer.preprocessor.line,r.location.endCol=t.parser.tokenizer.preprocessor.col+1,r.location.endOffset=t.parser.tokenizer.preprocessor.offset+1,t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)),t.parser.tokenizer.paused=!1,t.parser.tokenizer.inLoop=!1,t.parser.tokenizer.active=!1,t.parser.tokenizer.returnState=ka.DATA,t.parser.tokenizer.charRefCode=-1,t.parser.tokenizer.consumedAfterSnapshot=-1,t.parser.tokenizer.currentLocation=null,t.parser.tokenizer.currentCharacterToken=null,t.parser.tokenizer.currentToken=null,t.parser.tokenizer.currentAttr={name:"",value:""}}function ED(t,e){if(e&&e.offset!==void 0){const r={startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:-1,endCol:-1,endOffset:-1};t.parser.tokenizer.preprocessor.lineStartPos=-e.column+1,t.parser.tokenizer.preprocessor.droppedBufferSize=e.offset,t.parser.tokenizer.preprocessor.line=e.line,t.parser.tokenizer.currentLocation=r}}function mte(t,e){const r=t.tagName.toLowerCase();if(e.parser.tokenizer.state===ka.PLAINTEXT)return;Rh(e,Zo(t));const n=e.parser.openElements.current;let a="namespaceURI"in n?n.namespaceURI:bu.html;a===bu.html&&r==="svg"&&(a=bu.svg);const s=TJ({...t,children:[]},{space:a===bu.svg?"svg":"html"}),i={type:nn.START_TAG,tagName:r,tagID:Ih(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in s?s.attrs:[],location:hf(t)};e.parser.currentToken=i,e.parser._processToken(e.parser.currentToken),e.parser.tokenizer.lastStartTagName=r}function yte(t,e){const r=t.tagName.toLowerCase();if(!e.parser.tokenizer.inForeignNode&&RJ.includes(r)||e.parser.tokenizer.state===ka.PLAINTEXT)return;Rh(e,Fy(t));const n={type:nn.END_TAG,tagName:r,tagID:Ih(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:hf(t)};e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken),r===e.parser.tokenizer.lastStartTagName&&(e.parser.tokenizer.state===ka.RCDATA||e.parser.tokenizer.state===ka.RAWTEXT||e.parser.tokenizer.state===ka.SCRIPT_DATA)&&(e.parser.tokenizer.state=ka.DATA)}function bte(t){const e=t.type==="root"?t.children[0]:t;return!!(e&&(e.type==="doctype"||e.type==="element"&&e.tagName.toLowerCase()==="html"))}function hf(t){const e=Zo(t)||{line:void 0,column:void 0,offset:void 0},r=Fy(t)||{line:void 0,column:void 0,offset:void 0};return{startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function xte(t){return"children"in t?hh({...t,children:[]}):hh(t)}function vte(t){return function(e,r){return kD(e,{...t,file:r})}}const BA=(function(t,e,r){const n=of(r);if(!t||!t.type||!t.children)throw new Error("Expected parent node");if(typeof e=="number"){if(e<0||e===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if(e=t.children.indexOf(e),e<0)throw new Error("Expected child node or index");for(;++e<t.children.length;)if(n(t.children[e],e,t))return t.children[e]}),qu=(function(t){if(t==null)return kte;if(typeof t=="string")return Ste(t);if(typeof t=="object")return wte(t);if(typeof t=="function")return JS(t);throw new Error("Expected function, string, or array as `test`")});function wte(t){const e=[];let r=-1;for(;++r<t.length;)e[r]=qu(t[r]);return JS(n);function n(...a){let s=-1;for(;++s<e.length;)if(e[s].apply(this,a))return!0;return!1}}function Ste(t){return JS(e);function e(r){return r.tagName===t}}function JS(t){return e;function e(r,n,a){return!!(Tte(r)&&t.call(this,r,typeof n=="number"?n:void 0,a||void 0))}}function kte(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="element"&&"tagName"in t&&typeof t.tagName=="string")}function Tte(t){return t!==null&&typeof t=="object"&&"type"in t&&"tagName"in t}const FA=/\n/g,zA=/[\t ]+/g,g1=qu("br"),$A=qu(Rte),Cte=qu("p"),UA=qu("tr"),Ete=qu(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",Ite,Dte]),_D=qu(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function _te(t,e){const r=e||{},n="children"in t?t.children:[],a=_D(t),s=PD(t,{whitespace:r.whitespace||"normal"}),i=[];(t.type==="text"||t.type==="comment")&&i.push(...ND(t,{breakBefore:!0,breakAfter:!0}));let l=-1;for(;++l<n.length;)i.push(...AD(n[l],t,{whitespace:s,breakBefore:l?void 0:a,breakAfter:l<n.length-1?g1(n[l+1]):a}));const c=[];let d;for(l=-1;++l<i.length;){const p=i[l];typeof p=="number"?d!==void 0&&p>d&&(d=p):p&&(d!==void 0&&d>-1&&c.push(`
`.repeat(d)||" "),d=-1,c.push(p))}return c.join("")}function AD(t,e,r){return t.type==="element"?Ate(t,e,r):t.type==="text"?r.whitespace==="normal"?ND(t,r):Nte(t):[]}function Ate(t,e,r){const n=PD(t,r),a=t.children||[];let s=-1,i=[];if(Ete(t))return i;let l,c;for(g1(t)||UA(t)&&BA(e,t,UA)?c=`
`:Cte(t)?(l=2,c=2):_D(t)&&(l=1,c=1);++s<a.length;)i=i.concat(AD(a[s],t,{whitespace:n,breakBefore:s?void 0:l,breakAfter:s<a.length-1?g1(a[s+1]):c}));return $A(t)&&BA(e,t,$A)&&i.push("	"),l&&i.unshift(l),c&&i.push(c),i}function ND(t,e){const r=String(t.value),n=[],a=[];let s=0;for(;s<=r.length;){FA.lastIndex=s;const c=FA.exec(r),d=c&&"index"in c?c.index:r.length;n.push(Pte(r.slice(s,d).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),s===0?e.breakBefore:!0,d===r.length?e.breakAfter:!0)),s=d+1}let i=-1,l;for(;++i<n.length;)n[i].charCodeAt(n[i].length-1)===8203||i<n.length-1&&n[i+1].charCodeAt(0)===8203?(a.push(n[i]),l=void 0):n[i]?(typeof l=="number"&&a.push(l),a.push(n[i]),l=0):(i===0||i===n.length-1)&&a.push(0);return a}function Nte(t){return[String(t.value)]}function Pte(t,e,r){const n=[];let a=0,s;for(;a<t.length;){zA.lastIndex=a;const i=zA.exec(t);s=i?i.index:t.length,!a&&!s&&i&&!e&&n.push(""),a!==s&&n.push(t.slice(a,s)),a=i?s+i[0].length:s}return a!==s&&!r&&n.push(""),n.join(" ")}function PD(t,e){if(t.type==="element"){const r=t.properties||{};switch(t.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return r.wrap?"pre-wrap":"pre";case"td":case"th":return r.noWrap?"nowrap":e.whitespace;case"textarea":return"pre-wrap"}}return e.whitespace}function Ite(t){return!!(t.properties||{}).hidden}function Rte(t){return t.tagName==="td"||t.tagName==="th"}function Dte(t){return t.tagName==="dialog"&&!(t.properties||{}).open}function Lte(t){const e=t.regex,r=t.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="(?!struct)("+n+"|"+e.optional(a)+"[a-zA-Z_]\\w*"+e.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},d={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},t.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},p={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},g={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},t.inherit(d,{className:"string"}),{className:"string",begin:/<.*?>/},r,t.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:e.optional(a)+t.IDENT_RE,relevance:0},y=e.optional(a)+t.IDENT_RE+"\\s*\\(",x=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],w=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],T=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],k=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],F={type:w,keyword:x,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:T},D={className:"function.dispatch",relevance:0,keywords:{_hint:k},begin:e.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,t.IDENT_RE,e.lookahead(/(<[^<>]+>|)\s*\(/))},B=[D,g,l,r,t.C_BLOCK_COMMENT_MODE,p,d],M={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:F,contains:B.concat([{begin:/\(/,end:/\)/,keywords:F,contains:B.concat(["self"]),relevance:0}]),relevance:0},$={className:"function",begin:"("+i+"[\\*&\\s]+)+"+y,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:F,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:F,relevance:0},{begin:y,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[d,p]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:F,relevance:0,contains:[r,t.C_BLOCK_COMMENT_MODE,d,p,l,{begin:/\(/,end:/\)/,keywords:F,relevance:0,contains:["self",r,t.C_BLOCK_COMMENT_MODE,d,p,l]}]},l,r,t.C_BLOCK_COMMENT_MODE,g]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:F,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(M,$,D,B,[g,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:F,contains:["self",l]},{begin:t.IDENT_RE+"::",keywords:F},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function Mte(t){const e={type:["boolean","byte","word","String"],built_in:["KeyboardController","MouseController","SoftwareSerial","EthernetServer","EthernetClient","LiquidCrystal","RobotControl","GSMVoiceCall","EthernetUDP","EsploraTFT","HttpClient","RobotMotor","WiFiClient","GSMScanner","FileSystem","Scheduler","GSMServer","YunClient","YunServer","IPAddress","GSMClient","GSMModem","Keyboard","Ethernet","Console","GSMBand","Esplora","Stepper","Process","WiFiUDP","GSM_SMS","Mailbox","USBHost","Firmata","PImage","Client","Server","GSMPIN","FileIO","Bridge","Serial","EEPROM","Stream","Mouse","Audio","Servo","File","Task","GPRS","WiFi","Wire","TFT","GSM","SPI","SD"],_hints:["setup","loop","runShellCommandAsynchronously","analogWriteResolution","retrieveCallingNumber","printFirmwareVersion","analogReadResolution","sendDigitalPortPair","noListenOnLocalhost","readJoystickButton","setFirmwareVersion","readJoystickSwitch","scrollDisplayRight","getVoiceCallStatus","scrollDisplayLeft","writeMicroseconds","delayMicroseconds","beginTransmission","getSignalStrength","runAsynchronously","getAsynchronously","listenOnLocalhost","getCurrentCarrier","readAccelerometer","messageAvailable","sendDigitalPorts","lineFollowConfig","countryNameWrite","runShellCommand","readStringUntil","rewindDirectory","readTemperature","setClockDivider","readLightSensor","endTransmission","analogReference","detachInterrupt","countryNameRead","attachInterrupt","encryptionType","readBytesUntil","robotNameWrite","readMicrophone","robotNameRead","cityNameWrite","userNameWrite","readJoystickY","readJoystickX","mouseReleased","openNextFile","scanNetworks","noInterrupts","digitalWrite","beginSpeaker","mousePressed","isActionDone","mouseDragged","displayLogos","noAutoscroll","addParameter","remoteNumber","getModifiers","keyboardRead","userNameRead","waitContinue","processInput","parseCommand","printVersion","readNetworks","writeMessage","blinkVersion","cityNameRead","readMessage","setDataMode","parsePacket","isListening","setBitOrder","beginPacket","isDirectory","motorsWrite","drawCompass","digitalRead","clearScreen","serialEvent","rightToLeft","setTextSize","leftToRight","requestFrom","keyReleased","compassRead","analogWrite","interrupts","WiFiServer","disconnect","playMelody","parseFloat","autoscroll","getPINUsed","setPINUsed","setTimeout","sendAnalog","readSlider","analogRead","beginWrite","createChar","motorsStop","keyPressed","tempoWrite","readButton","subnetMask","debugPrint","macAddress","writeGreen","randomSeed","attachGPRS","readString","sendString","remotePort","releaseAll","mouseMoved","background","getXChange","getYChange","answerCall","getResult","voiceCall","endPacket","constrain","getSocket","writeJSON","getButton","available","connected","findUntil","readBytes","exitValue","readGreen","writeBlue","startLoop","IPAddress","isPressed","sendSysex","pauseMode","gatewayIP","setCursor","getOemKey","tuneWrite","noDisplay","loadImage","switchPIN","onRequest","onReceive","changePIN","playFile","noBuffer","parseInt","overflow","checkPIN","knobRead","beginTFT","bitClear","updateIR","bitWrite","position","writeRGB","highByte","writeRed","setSpeed","readBlue","noStroke","remoteIP","transfer","shutdown","hangCall","beginSMS","endWrite","attached","maintain","noCursor","checkReg","checkPUK","shiftOut","isValid","shiftIn","pulseIn","connect","println","localIP","pinMode","getIMEI","display","noBlink","process","getBand","running","beginSD","drawBMP","lowByte","setBand","release","bitRead","prepare","pointTo","readRed","setMode","noFill","remove","listen","stroke","detach","attach","noTone","exists","buffer","height","bitSet","circle","config","cursor","random","IRread","setDNS","endSMS","getKey","micros","millis","begin","print","write","ready","flush","width","isPIN","blink","clear","press","mkdir","rmdir","close","point","yield","image","BSSID","click","delay","read","text","move","peek","beep","rect","line","open","seek","fill","size","turn","stop","home","find","step","tone","sqrt","RSSI","SSID","end","bit","tan","cos","sin","pow","map","abs","max","min","get","run","put"],literal:["DIGITAL_MESSAGE","FIRMATA_STRING","ANALOG_MESSAGE","REPORT_DIGITAL","REPORT_ANALOG","INPUT_PULLUP","SET_PIN_MODE","INTERNAL2V56","SYSTEM_RESET","LED_BUILTIN","INTERNAL1V1","SYSEX_START","INTERNAL","EXTERNAL","DEFAULT","OUTPUT","INPUT","HIGH","LOW"]},r=Lte(t),n=r.keywords;return n.type=[...n.type,...e.type],n.literal=[...n.literal,...e.literal],n.built_in=[...n.built_in,...e.built_in],n._hints=e._hints,r.name="Arduino",r.aliases=["ino"],r.supersetOf="cpp",r}function Ote(t){const e=t.regex,r={},n={begin:/\$\{/,end:/\}/,contains:["self",{begin:/:-/,contains:[r]}]};Object.assign(r,{className:"variable",variants:[{begin:e.concat(/\$[\w\d#@][\w\d_]*/,"(?![\\w\\d])(?![$])")},n]});const a={className:"subst",begin:/\$\(/,end:/\)/,contains:[t.BACKSLASH_ESCAPE]},s=t.inherit(t.COMMENT(),{match:[/(^|\s)/,/#.*$/],scope:{2:"comment"}}),i={begin:/<<-?\s*(?=\w+)/,starts:{contains:[t.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,className:"string"})]}},l={className:"string",begin:/"/,end:/"/,contains:[t.BACKSLASH_ESCAPE,r,a]};a.contains.push(l);const c={match:/\\"/},d={className:"string",begin:/'/,end:/'/},p={match:/\\'/},g={begin:/\$?\(\(/,end:/\)\)/,contains:[{begin:/\d+#[0-9a-f]+/,className:"number"},t.NUMBER_MODE,r]},m=["fish","bash","zsh","sh","csh","ksh","tcsh","dash","scsh"],y=t.SHEBANG({binary:`(${m.join("|")})`,relevance:10}),x={className:"function",begin:/\w[\w\d_]*\s*\(\s*\)\s*\{/,returnBegin:!0,contains:[t.inherit(t.TITLE_MODE,{begin:/\w[\w\d_]*/})],relevance:0},w=["if","then","else","elif","fi","time","for","while","until","in","do","done","case","esac","coproc","function","select"],T=["true","false"],k={match:/(\/[a-z._-]+)+/},_=["break","cd","continue","eval","exec","exit","export","getopts","hash","pwd","readonly","return","shift","test","times","trap","umask","unset"],P=["alias","bind","builtin","caller","command","declare","echo","enable","help","let","local","logout","mapfile","printf","read","readarray","source","sudo","type","typeset","ulimit","unalias"],F=["autoload","bg","bindkey","bye","cap","chdir","clone","comparguments","compcall","compctl","compdescribe","compfiles","compgroups","compquote","comptags","comptry","compvalues","dirs","disable","disown","echotc","echoti","emulate","fc","fg","float","functions","getcap","getln","history","integer","jobs","kill","limit","log","noglob","popd","print","pushd","pushln","rehash","sched","setcap","setopt","stat","suspend","ttyctl","unfunction","unhash","unlimit","unsetopt","vared","wait","whence","where","which","zcompile","zformat","zftp","zle","zmodload","zparseopts","zprof","zpty","zregexparse","zsocket","zstyle","ztcp"],D=["chcon","chgrp","chown","chmod","cp","dd","df","dir","dircolors","ln","ls","mkdir","mkfifo","mknod","mktemp","mv","realpath","rm","rmdir","shred","sync","touch","truncate","vdir","b2sum","base32","base64","cat","cksum","comm","csplit","cut","expand","fmt","fold","head","join","md5sum","nl","numfmt","od","paste","ptx","pr","sha1sum","sha224sum","sha256sum","sha384sum","sha512sum","shuf","sort","split","sum","tac","tail","tr","tsort","unexpand","uniq","wc","arch","basename","chroot","date","dirname","du","echo","env","expr","factor","groups","hostid","id","link","logname","nice","nohup","nproc","pathchk","pinky","printenv","printf","pwd","readlink","runcon","seq","sleep","stat","stdbuf","stty","tee","test","timeout","tty","uname","unlink","uptime","users","who","whoami","yes"];return{name:"Bash",aliases:["sh","zsh"],keywords:{$pattern:/\b[a-z][a-z0-9._-]+\b/,keyword:w,literal:T,built_in:[..._,...P,"set","shopt",...F,...D]},contains:[y,t.SHEBANG(),x,g,s,i,k,l,c,d,p,r]}}function jte(t){const e=t.regex,r=t.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="("+n+"|"+e.optional(a)+"[a-zA-Z_]\\w*"+e.optional("<[^<>]+>")+")",l={className:"type",variants:[{begin:"\\b[a-z\\d_]*_t\\b"},{match:/\batomic_[a-z]{3,6}\b/}]},d={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},t.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},p={className:"number",variants:[{match:/\b(0b[01']+)/},{match:/(-?)\b([\d']+(\.[\d']*)?|\.[\d']+)((ll|LL|l|L)(u|U)?|(u|U)(ll|LL|l|L)?|f|F|b|B)/},{match:/(-?)\b(0[xX][a-fA-F0-9]+(?:'[a-fA-F0-9]+)*(?:\.[a-fA-F0-9]*(?:'[a-fA-F0-9]*)*)?(?:[pP][-+]?[0-9]+)?(l|L)?(u|U)?)/},{match:/(-?)\b\d+(?:'\d+)*(?:\.\d*(?:'\d*)*)?(?:[eE][-+]?\d+)?/}],relevance:0},g={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef elifdef elifndef include"},contains:[{begin:/\\\n/,relevance:0},t.inherit(d,{className:"string"}),{className:"string",begin:/<.*?>/},r,t.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:e.optional(a)+t.IDENT_RE,relevance:0},y=e.optional(a)+t.IDENT_RE+"\\s*\\(",T={keyword:["asm","auto","break","case","continue","default","do","else","enum","extern","for","fortran","goto","if","inline","register","restrict","return","sizeof","typeof","typeof_unqual","struct","switch","typedef","union","volatile","while","_Alignas","_Alignof","_Atomic","_Generic","_Noreturn","_Static_assert","_Thread_local","alignas","alignof","noreturn","static_assert","thread_local","_Pragma"],type:["float","double","signed","unsigned","int","short","long","char","void","_Bool","_BitInt","_Complex","_Imaginary","_Decimal32","_Decimal64","_Decimal96","_Decimal128","_Decimal64x","_Decimal128x","_Float16","_Float32","_Float64","_Float128","_Float32x","_Float64x","_Float128x","const","static","constexpr","complex","bool","imaginary"],literal:"true false NULL",built_in:"std string wstring cin cout cerr clog stdin stdout stderr stringstream istringstream ostringstream auto_ptr deque list queue stack vector map set pair bitset multiset multimap unordered_set unordered_map unordered_multiset unordered_multimap priority_queue make_pair array shared_ptr abort terminate abs acos asin atan2 atan calloc ceil cosh cos exit exp fabs floor fmod fprintf fputs free frexp fscanf future isalnum isalpha iscntrl isdigit isgraph islower isprint ispunct isspace isupper isxdigit tolower toupper labs ldexp log10 log malloc realloc memchr memcmp memcpy memset modf pow printf putchar puts scanf sinh sin snprintf sprintf sqrt sscanf strcat strchr strcmp strcpy strcspn strlen strncat strncmp strncpy strpbrk strrchr strspn strstr tanh tan vfprintf vprintf vsprintf endl initializer_list unique_ptr"},k=[g,l,r,t.C_BLOCK_COMMENT_MODE,p,d],_={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:T,contains:k.concat([{begin:/\(/,end:/\)/,keywords:T,contains:k.concat(["self"]),relevance:0}]),relevance:0},P={begin:"("+i+"[\\*&\\s]+)+"+y,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:T,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:T,relevance:0},{begin:y,returnBegin:!0,contains:[t.inherit(m,{className:"title.function"})],relevance:0},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:T,relevance:0,contains:[r,t.C_BLOCK_COMMENT_MODE,d,p,l,{begin:/\(/,end:/\)/,keywords:T,relevance:0,contains:["self",r,t.C_BLOCK_COMMENT_MODE,d,p,l]}]},l,r,t.C_BLOCK_COMMENT_MODE,g]};return{name:"C",aliases:["h"],keywords:T,disableAutodetect:!0,illegal:"</",contains:[].concat(_,P,k,[g,{begin:t.IDENT_RE+"::",keywords:T},{className:"class",beginKeywords:"enum class struct union",end:/[{;:<>=]/,contains:[{beginKeywords:"final class struct"},t.TITLE_MODE]}]),exports:{preprocessor:g,strings:d,keywords:T}}}function Bte(t){const e=t.regex,r=t.COMMENT("//","$",{contains:[{begin:/\\\n/}]}),n="decltype\\(auto\\)",a="[a-zA-Z_]\\w*::",i="(?!struct)("+n+"|"+e.optional(a)+"[a-zA-Z_]\\w*"+e.optional("<[^<>]+>")+")",l={className:"type",begin:"\\b[a-z\\d_]*_t\\b"},d={className:"string",variants:[{begin:'(u8?|U|L)?"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]},{begin:"(u8?|U|L)?'("+"\\\\(x[0-9A-Fa-f]{2}|u[0-9A-Fa-f]{4,8}|[0-7]{3}|\\S)"+"|.)",end:"'",illegal:"."},t.END_SAME_AS_BEGIN({begin:/(?:u8?|U|L)?R"([^()\\ ]{0,16})\(/,end:/\)([^()\\ ]{0,16})"/})]},p={className:"number",variants:[{begin:"[+-]?(?:(?:[0-9](?:'?[0-9])*\\.(?:[0-9](?:'?[0-9])*)?|\\.[0-9](?:'?[0-9])*)(?:[Ee][+-]?[0-9](?:'?[0-9])*)?|[0-9](?:'?[0-9])*[Ee][+-]?[0-9](?:'?[0-9])*|0[Xx](?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*(?:\\.(?:[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)?)?|\\.[0-9A-Fa-f](?:'?[0-9A-Fa-f])*)[Pp][+-]?[0-9](?:'?[0-9])*)(?:[Ff](?:16|32|64|128)?|(BF|bf)16|[Ll]|)"},{begin:"[+-]?\\b(?:0[Bb][01](?:'?[01])*|0[Xx][0-9A-Fa-f](?:'?[0-9A-Fa-f])*|0(?:'?[0-7])*|[1-9](?:'?[0-9])*)(?:[Uu](?:LL?|ll?)|[Uu][Zz]?|(?:LL?|ll?)[Uu]?|[Zz][Uu]|)"}],relevance:0},g={className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma _Pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},t.inherit(d,{className:"string"}),{className:"string",begin:/<.*?>/},r,t.C_BLOCK_COMMENT_MODE]},m={className:"title",begin:e.optional(a)+t.IDENT_RE,relevance:0},y=e.optional(a)+t.IDENT_RE+"\\s*\\(",x=["alignas","alignof","and","and_eq","asm","atomic_cancel","atomic_commit","atomic_noexcept","auto","bitand","bitor","break","case","catch","class","co_await","co_return","co_yield","compl","concept","const_cast|10","consteval","constexpr","constinit","continue","decltype","default","delete","do","dynamic_cast|10","else","enum","explicit","export","extern","false","final","for","friend","goto","if","import","inline","module","mutable","namespace","new","noexcept","not","not_eq","nullptr","operator","or","or_eq","override","private","protected","public","reflexpr","register","reinterpret_cast|10","requires","return","sizeof","static_assert","static_cast|10","struct","switch","synchronized","template","this","thread_local","throw","transaction_safe","transaction_safe_dynamic","true","try","typedef","typeid","typename","union","using","virtual","volatile","while","xor","xor_eq"],w=["bool","char","char16_t","char32_t","char8_t","double","float","int","long","short","void","wchar_t","unsigned","signed","const","static"],T=["any","auto_ptr","barrier","binary_semaphore","bitset","complex","condition_variable","condition_variable_any","counting_semaphore","deque","false_type","flat_map","flat_set","future","imaginary","initializer_list","istringstream","jthread","latch","lock_guard","multimap","multiset","mutex","optional","ostringstream","packaged_task","pair","promise","priority_queue","queue","recursive_mutex","recursive_timed_mutex","scoped_lock","set","shared_future","shared_lock","shared_mutex","shared_timed_mutex","shared_ptr","stack","string_view","stringstream","timed_mutex","thread","true_type","tuple","unique_lock","unique_ptr","unordered_map","unordered_multimap","unordered_multiset","unordered_set","variant","vector","weak_ptr","wstring","wstring_view"],k=["abort","abs","acos","apply","as_const","asin","atan","atan2","calloc","ceil","cerr","cin","clog","cos","cosh","cout","declval","endl","exchange","exit","exp","fabs","floor","fmod","forward","fprintf","fputs","free","frexp","fscanf","future","invoke","isalnum","isalpha","iscntrl","isdigit","isgraph","islower","isprint","ispunct","isspace","isupper","isxdigit","labs","launder","ldexp","log","log10","make_pair","make_shared","make_shared_for_overwrite","make_tuple","make_unique","malloc","memchr","memcmp","memcpy","memset","modf","move","pow","printf","putchar","puts","realloc","scanf","sin","sinh","snprintf","sprintf","sqrt","sscanf","std","stderr","stdin","stdout","strcat","strchr","strcmp","strcpy","strcspn","strlen","strncat","strncmp","strncpy","strpbrk","strrchr","strspn","strstr","swap","tan","tanh","terminate","to_underlying","tolower","toupper","vfprintf","visit","vprintf","vsprintf"],F={type:w,keyword:x,literal:["NULL","false","nullopt","nullptr","true"],built_in:["_Pragma"],_type_hints:T},D={className:"function.dispatch",relevance:0,keywords:{_hint:k},begin:e.concat(/\b/,/(?!decltype)/,/(?!if)/,/(?!for)/,/(?!switch)/,/(?!while)/,t.IDENT_RE,e.lookahead(/(<[^<>]+>|)\s*\(/))},B=[D,g,l,r,t.C_BLOCK_COMMENT_MODE,p,d],M={variants:[{begin:/=/,end:/;/},{begin:/\(/,end:/\)/},{beginKeywords:"new throw return else",end:/;/}],keywords:F,contains:B.concat([{begin:/\(/,end:/\)/,keywords:F,contains:B.concat(["self"]),relevance:0}]),relevance:0},$={className:"function",begin:"("+i+"[\\*&\\s]+)+"+y,returnBegin:!0,end:/[{;=]/,excludeEnd:!0,keywords:F,illegal:/[^\w\s\*&:<>.]/,contains:[{begin:n,keywords:F,relevance:0},{begin:y,returnBegin:!0,contains:[m],relevance:0},{begin:/::/,relevance:0},{begin:/:/,endsWithParent:!0,contains:[d,p]},{relevance:0,match:/,/},{className:"params",begin:/\(/,end:/\)/,keywords:F,relevance:0,contains:[r,t.C_BLOCK_COMMENT_MODE,d,p,l,{begin:/\(/,end:/\)/,keywords:F,relevance:0,contains:["self",r,t.C_BLOCK_COMMENT_MODE,d,p,l]}]},l,r,t.C_BLOCK_COMMENT_MODE,g]};return{name:"C++",aliases:["cc","c++","h++","hpp","hh","hxx","cxx"],keywords:F,illegal:"</",classNameAliases:{"function.dispatch":"built_in"},contains:[].concat(M,$,D,B,[g,{begin:"\\b(deque|list|queue|priority_queue|pair|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array|tuple|optional|variant|function|flat_map|flat_set)\\s*<(?!<)",end:">",keywords:F,contains:["self",l]},{begin:t.IDENT_RE+"::",keywords:F},{match:[/\b(?:enum(?:\s+(?:class|struct))?|class|struct|union)/,/\s+/,/\w+/],className:{1:"keyword",3:"title.class"}}])}}function Fte(t){const e=["bool","byte","char","decimal","delegate","double","dynamic","enum","float","int","long","nint","nuint","object","sbyte","short","string","ulong","uint","ushort"],r=["public","private","protected","static","internal","protected","abstract","async","extern","override","unsafe","virtual","new","sealed","partial"],n=["default","false","null","true"],a=["abstract","as","base","break","case","catch","class","const","continue","do","else","event","explicit","extern","finally","fixed","for","foreach","goto","if","implicit","in","interface","internal","is","lock","namespace","new","operator","out","override","params","private","protected","public","readonly","record","ref","return","scoped","sealed","sizeof","stackalloc","static","struct","switch","this","throw","try","typeof","unchecked","unsafe","using","virtual","void","volatile","while"],s=["add","alias","and","ascending","args","async","await","by","descending","dynamic","equals","file","from","get","global","group","init","into","join","let","nameof","not","notnull","on","or","orderby","partial","record","remove","required","scoped","select","set","unmanaged","value|0","var","when","where","with","yield"],i={keyword:a.concat(s),built_in:e,literal:n},l=t.inherit(t.TITLE_MODE,{begin:"[a-zA-Z](\\.?\\w)*"}),c={className:"number",variants:[{begin:"\\b(0b[01']+)"},{begin:"(-?)\\b([\\d']+(\\.[\\d']*)?|\\.[\\d']+)(u|U|l|L|ul|UL|f|F|b|B)"},{begin:"(-?)(\\b0[xX][a-fA-F0-9']+|(\\b[\\d']+(\\.[\\d']*)?|\\.[\\d']+)([eE][-+]?[\\d']+)?)"}],relevance:0},d={className:"string",begin:/"""("*)(?!")(.|\n)*?"""\1/,relevance:1},p={className:"string",begin:'@"',end:'"',contains:[{begin:'""'}]},g=t.inherit(p,{illegal:/\n/}),m={className:"subst",begin:/\{/,end:/\}/,keywords:i},y=t.inherit(m,{illegal:/\n/}),x={className:"string",begin:/\$"/,end:'"',illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},t.BACKSLASH_ESCAPE,y]},w={className:"string",begin:/\$@"/,end:'"',contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},m]},T=t.inherit(w,{illegal:/\n/,contains:[{begin:/\{\{/},{begin:/\}\}/},{begin:'""'},y]});m.contains=[w,x,p,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,c,t.C_BLOCK_COMMENT_MODE],y.contains=[T,x,g,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,c,t.inherit(t.C_BLOCK_COMMENT_MODE,{illegal:/\n/})];const k={variants:[d,w,x,p,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},_={begin:"<",end:">",contains:[{beginKeywords:"in out"},l]},P=t.IDENT_RE+"(<"+t.IDENT_RE+"(\\s*,\\s*"+t.IDENT_RE+")*>)?(\\[\\])?",F={begin:"@"+t.IDENT_RE,relevance:0};return{name:"C#",aliases:["cs","c#"],keywords:i,illegal:/::/,contains:[t.COMMENT("///","$",{returnBegin:!0,contains:[{className:"doctag",variants:[{begin:"///",relevance:0},{begin:"<!--|-->"},{begin:"</?",end:">"}]}]}),t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,{className:"meta",begin:"#",end:"$",keywords:{keyword:"if else elif endif define undef warning error line region endregion pragma checksum"}},k,c,{beginKeywords:"class interface",relevance:0,end:/[{;=]/,illegal:/[^\s:,]/,contains:[{beginKeywords:"where class"},l,_,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},{beginKeywords:"namespace",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},{beginKeywords:"record",relevance:0,end:/[{;=]/,illegal:/[^\s:]/,contains:[l,_,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},{className:"meta",begin:"^\\s*\\[(?=[\\w])",excludeBegin:!0,end:"\\]",excludeEnd:!0,contains:[{className:"string",begin:/"/,end:/"/}]},{beginKeywords:"new return throw await else",relevance:0},{className:"function",begin:"("+P+"\\s+)+"+t.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,end:/\s*[{;=]/,excludeEnd:!0,keywords:i,contains:[{beginKeywords:r.join(" "),relevance:0},{begin:t.IDENT_RE+"\\s*(<[^=]+>\\s*)?\\(",returnBegin:!0,contains:[t.TITLE_MODE,_],relevance:0},{match:/\(\)/},{className:"params",begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:i,relevance:0,contains:[k,c,t.C_BLOCK_COMMENT_MODE]},t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},F]}}const zte=t=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:t.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),$te=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],Ute=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],qte=[...$te,...Ute],Hte=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),Gte=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),Vte=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),Wte=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function Yte(t){const e=t.regex,r=zte(t),n={begin:/-(webkit|moz|ms|o)-(?=[a-z])/},a="and or not only",s=/@-?\w[\w]*(-\w+)*/,i="[a-zA-Z-][a-zA-Z0-9_-]*",l=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE];return{name:"CSS",case_insensitive:!0,illegal:/[=|'\$]/,keywords:{keyframePosition:"from to"},classNameAliases:{keyframePosition:"selector-tag"},contains:[r.BLOCK_COMMENT,n,r.CSS_NUMBER_MODE,{className:"selector-id",begin:/#[A-Za-z0-9_-]+/,relevance:0},{className:"selector-class",begin:"\\."+i,relevance:0},r.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",variants:[{begin:":("+Gte.join("|")+")"},{begin:":(:)?("+Vte.join("|")+")"}]},r.CSS_VARIABLE,{className:"attribute",begin:"\\b("+Wte.join("|")+")\\b"},{begin:/:/,end:/[;}{]/,contains:[r.BLOCK_COMMENT,r.HEXCOLOR,r.IMPORTANT,r.CSS_NUMBER_MODE,...l,{begin:/(url|data-uri)\(/,end:/\)/,relevance:0,keywords:{built_in:"url data-uri"},contains:[...l,{className:"string",begin:/[^)]/,endsWithParent:!0,excludeEnd:!0}]},r.FUNCTION_DISPATCH]},{begin:e.lookahead(/@/),end:"[{;]",relevance:0,illegal:/:/,contains:[{className:"keyword",begin:s},{begin:/\s/,endsWithParent:!0,excludeEnd:!0,relevance:0,keywords:{$pattern:/[a-z-]+/,keyword:a,attribute:Hte.join(" ")},contains:[{begin:/[a-z-]+(?=:)/,className:"attribute"},...l,r.CSS_NUMBER_MODE]}]},{className:"selector-tag",begin:"\\b("+qte.join("|")+")\\b"}]}}function Qte(t){const e=t.regex;return{name:"Diff",aliases:["patch"],contains:[{className:"meta",relevance:10,match:e.either(/^@@ +-\d+,\d+ +\+\d+,\d+ +@@/,/^\*\*\* +\d+,\d+ +\*\*\*\*$/,/^--- +\d+,\d+ +----$/)},{className:"comment",variants:[{begin:e.either(/Index: /,/^index/,/={3,}/,/^-{3}/,/^\*{3} /,/^\+{3}/,/^diff --git/),end:/$/},{match:/^\*{15}$/}]},{className:"addition",begin:/^\+/,end:/$/},{className:"deletion",begin:/^-/,end:/$/},{className:"addition",begin:/^!/,end:/$/}]}}function Kte(t){const s={keyword:["break","case","chan","const","continue","default","defer","else","fallthrough","for","func","go","goto","if","import","interface","map","package","range","return","select","struct","switch","type","var"],type:["bool","byte","complex64","complex128","error","float32","float64","int8","int16","int32","int64","string","uint8","uint16","uint32","uint64","int","uint","uintptr","rune"],literal:["true","false","iota","nil"],built_in:["append","cap","close","complex","copy","imag","len","make","new","panic","print","println","real","recover","delete"]};return{name:"Go",aliases:["golang"],keywords:s,illegal:"</",contains:[t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,{className:"string",variants:[t.QUOTE_STRING_MODE,t.APOS_STRING_MODE,{begin:"`",end:"`"}]},{className:"number",variants:[{match:/-?\b0[xX]\.[a-fA-F0-9](_?[a-fA-F0-9])*[pP][+-]?\d(_?\d)*i?/,relevance:0},{match:/-?\b0[xX](_?[a-fA-F0-9])+((\.([a-fA-F0-9](_?[a-fA-F0-9])*)?)?[pP][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b0[oO](_?[0-7])*i?/,relevance:0},{match:/-?\.\d(_?\d)*([eE][+-]?\d(_?\d)*)?i?/,relevance:0},{match:/-?\b\d(_?\d)*(\.(\d(_?\d)*)?)?([eE][+-]?\d(_?\d)*)?i?/,relevance:0}]},{begin:/:=/},{className:"function",beginKeywords:"func",end:"\\s*(\\{|$)",excludeEnd:!0,contains:[t.TITLE_MODE,{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:s,illegal:/["']/}]}]}}function Xte(t){const e=t.regex,r=/[_A-Za-z][_0-9A-Za-z]*/;return{name:"GraphQL",aliases:["gql"],case_insensitive:!0,disableAutodetect:!1,keywords:{keyword:["query","mutation","subscription","type","input","schema","directive","interface","union","scalar","fragment","enum","on"],literal:["true","false","null"]},contains:[t.HASH_COMMENT_MODE,t.QUOTE_STRING_MODE,t.NUMBER_MODE,{scope:"punctuation",match:/[.]{3}/,relevance:0},{scope:"punctuation",begin:/[\!\(\)\:\=\[\]\{\|\}]{1}/,relevance:0},{scope:"variable",begin:/\$/,end:/\W/,excludeEnd:!0,relevance:0},{scope:"meta",match:/@\w+/,excludeEnd:!0},{scope:"symbol",begin:e.concat(r,e.lookahead(/\s*:/)),relevance:0}],illegal:[/[;<']/,/BEGIN/]}}function Jte(t){const e=t.regex,r={className:"number",relevance:0,variants:[{begin:/([+-]+)?[\d]+_[\d_]+/},{begin:t.NUMBER_RE}]},n=t.COMMENT();n.variants=[{begin:/;/,end:/$/},{begin:/#/,end:/$/}];const a={className:"variable",variants:[{begin:/\$[\w\d"][\w\d_]*/},{begin:/\$\{(.*?)\}/}]},s={className:"literal",begin:/\bon|off|true|false|yes|no\b/},i={className:"string",contains:[t.BACKSLASH_ESCAPE],variants:[{begin:"'''",end:"'''",relevance:10},{begin:'"""',end:'"""',relevance:10},{begin:'"',end:'"'},{begin:"'",end:"'"}]},l={begin:/\[/,end:/\]/,contains:[n,s,a,i,r,"self"],relevance:0},c=/[A-Za-z0-9_-]+/,d=/"(\\"|[^"])*"/,p=/'[^']*'/,g=e.either(c,d,p),m=e.concat(g,"(\\s*\\.\\s*",g,")*",e.lookahead(/\s*=\s*[^#\s]/));return{name:"TOML, also INI",aliases:["toml"],case_insensitive:!0,illegal:/\S/,contains:[n,{className:"section",begin:/\[+/,end:/\]+/},{begin:m,className:"attr",starts:{end:/$/,contains:[n,l,s,a,i,r]}}]}}var Ud="[0-9](_*[0-9])*",Lm=`\\.(${Ud})`,Mm="[0-9a-fA-F](_*[0-9a-fA-F])*",qA={className:"number",variants:[{begin:`(\\b(${Ud})((${Lm})|\\.)?|(${Lm}))[eE][+-]?(${Ud})[fFdD]?\\b`},{begin:`\\b(${Ud})((${Lm})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${Lm})[fFdD]?\\b`},{begin:`\\b(${Ud})[fFdD]\\b`},{begin:`\\b0[xX]((${Mm})\\.?|(${Mm})?\\.(${Mm}))[pP][+-]?(${Ud})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${Mm})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function ID(t,e,r){return r===-1?"":t.replace(e,n=>ID(t,e,r-1))}function Zte(t){const e=t.regex,r="[-a-zA-Z_$][-a-zA-Z_$0-9]*",n=r+ID("(?:<"+r+"~~~(?:\\s*,\\s*"+r+"~~~)*>)?",/~~~/g,2),c={keyword:["synchronized","abstract","private","var","static","if","const ","for","while","strictfp","finally","protected","import","native","final","void","enum","else","break","transient","catch","instanceof","volatile","case","assert","package","default","public","try","switch","continue","throws","protected","public","private","module","requires","exports","do","sealed","yield","permits","goto","when"],literal:["false","true","null"],type:["char","boolean","long","float","int","byte","short","double"],built_in:["super","this"]},d={className:"meta",begin:"@"+r,contains:[{begin:/\(/,end:/\)/,contains:["self"]}]},p={className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[t.C_BLOCK_COMMENT_MODE],endsParent:!0};return{name:"Java",aliases:["jsp"],keywords:c,illegal:/<\/|#/,contains:[t.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{begin:/\w+@/,relevance:0},{className:"doctag",begin:"@[A-Za-z]+"}]}),{begin:/import java\.[a-z]+\./,keywords:"import",relevance:2},t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,{begin:/"""/,end:/"""/,className:"string",contains:[t.BACKSLASH_ESCAPE]},t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,{match:[/\b(?:class|interface|enum|extends|implements|new)/,/\s+/,r],className:{1:"keyword",3:"title.class"}},{match:/non-sealed/,scope:"keyword"},{begin:[e.concat(/(?!else)/,r),/\s+/,r,/\s+/,/=(?!=)/],className:{1:"type",3:"variable",5:"operator"}},{begin:[/record/,/\s+/,r],className:{1:"keyword",3:"title.class"},contains:[p,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},{beginKeywords:"new throw return else",relevance:0},{begin:["(?:"+n+"\\s+)",t.UNDERSCORE_IDENT_RE,/\s*(?=\()/],className:{2:"title.function"},keywords:c,contains:[{className:"params",begin:/\(/,end:/\)/,keywords:c,relevance:0,contains:[d,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,qA,t.C_BLOCK_COMMENT_MODE]},t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},qA,d]}}const HA="[A-Za-z$_][0-9A-Za-z$_]*",ere=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],tre=["true","false","null","undefined","NaN","Infinity"],RD=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],DD=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],LD=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],rre=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],nre=[].concat(LD,RD,DD);function are(t){const e=t.regex,r=(ne,{after:ve})=>{const O="</"+ne[0].slice(1);return ne.input.indexOf(O,ve)!==-1},n=HA,a={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,i={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(ne,ve)=>{const O=ne[0].length+ne.index,I=ne.input[O];if(I==="<"||I===","){ve.ignoreMatch();return}I===">"&&(r(ne,{after:O})||ve.ignoreMatch());let K;const U=ne.input.substring(O);if(K=U.match(/^\s*=/)){ve.ignoreMatch();return}if((K=U.match(/^\s+extends\s+/))&&K.index===0){ve.ignoreMatch();return}}},l={$pattern:HA,keyword:ere,literal:tre,built_in:nre,"variable.language":rre},c="[0-9](_?[0-9])*",d=`\\.(${c})`,p="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",g={className:"number",variants:[{begin:`(\\b(${p})((${d})|\\.)?|(${d}))[eE][+-]?(${c})\\b`},{begin:`\\b(${p})\\b((${d})\\b|\\.)?|(${d})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},y={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},x={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"css"}},w={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},T={className:"string",begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[t.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),t.C_BLOCK_COMMENT_MODE,t.C_LINE_COMMENT_MODE]},P=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,y,x,w,T,{match:/\$\d+/},g];m.contains=P.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(P)});const F=[].concat(_,m.contains),D=F.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(F)}]),B={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:D},M={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,e.concat(n,"(",e.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},$={relevance:0,match:e.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...RD,...DD]}},Z={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},z={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[B],illegal:/%/},ee={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function te(ne){return e.concat("(?!",ne.join("|"),")")}const X={match:e.concat(/\b/,te([...LD,"super","import"].map(ne=>`${ne}\\s*\\(`)),n,e.lookahead(/\s*\(/)),className:"title.function",relevance:0},Q={begin:e.concat(/\./,e.lookahead(e.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},W={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},B]},H="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+t.UNDERSCORE_IDENT_RE+")\\s*=>",re={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,e.lookahead(H)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[B]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:D,CLASS_REFERENCE:$},illegal:/#(?![$_A-z])/,contains:[t.SHEBANG({label:"shebang",binary:"node",relevance:5}),Z,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,y,x,w,T,_,{match:/\$\d+/},g,$,{scope:"attr",match:n+e.lookahead(":"),relevance:0},re,{begin:"("+t.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,t.REGEXP_MODE,{className:"function",begin:H,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:t.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:D}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:s},{begin:i.begin,"on:begin":i.isTrulyOpeningTag,end:i.end}],subLanguage:"xml",contains:[{begin:i.begin,end:i.end,skip:!0,contains:["self"]}]}]},z,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+t.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[B,t.inherit(t.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},Q,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[B]},X,ee,M,W,{match:/\$[(.]/}]}}function sre(t){const e={className:"attr",begin:/"(\\.|[^\\"\r\n])*"(?=\s*:)/,relevance:1.01},r={match:/[{}[\],:]/,className:"punctuation",relevance:0},n=["true","false","null"],a={scope:"literal",beginKeywords:n.join(" ")};return{name:"JSON",aliases:["jsonc"],keywords:{literal:n},contains:[e,r,t.QUOTE_STRING_MODE,a,t.C_NUMBER_MODE,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE],illegal:"\\S"}}var qd="[0-9](_*[0-9])*",Om=`\\.(${qd})`,jm="[0-9a-fA-F](_*[0-9a-fA-F])*",ire={className:"number",variants:[{begin:`(\\b(${qd})((${Om})|\\.)?|(${Om}))[eE][+-]?(${qd})[fFdD]?\\b`},{begin:`\\b(${qd})((${Om})[fFdD]?\\b|\\.([fFdD]\\b)?)`},{begin:`(${Om})[fFdD]?\\b`},{begin:`\\b(${qd})[fFdD]\\b`},{begin:`\\b0[xX]((${jm})\\.?|(${jm})?\\.(${jm}))[pP][+-]?(${qd})[fFdD]?\\b`},{begin:"\\b(0|[1-9](_*[0-9])*)[lL]?\\b"},{begin:`\\b0[xX](${jm})[lL]?\\b`},{begin:"\\b0(_*[0-7])*[lL]?\\b"},{begin:"\\b0[bB][01](_*[01])*[lL]?\\b"}],relevance:0};function ore(t){const e={keyword:"abstract as val var vararg get set class object open private protected public noinline crossinline dynamic final enum if else do while for when throw try catch finally import package is in fun override companion reified inline lateinit init interface annotation data sealed internal infix operator out by constructor super tailrec where const inner suspend typealias external expect actual",built_in:"Byte Short Char Int Long Boolean Float Double Void Unit Nothing",literal:"true false null"},r={className:"keyword",begin:/\b(break|continue|return|this)\b/,starts:{contains:[{className:"symbol",begin:/@\w+/}]}},n={className:"symbol",begin:t.UNDERSCORE_IDENT_RE+"@"},a={className:"subst",begin:/\$\{/,end:/\}/,contains:[t.C_NUMBER_MODE]},s={className:"variable",begin:"\\$"+t.UNDERSCORE_IDENT_RE},i={className:"string",variants:[{begin:'"""',end:'"""(?=[^"])',contains:[s,a]},{begin:"'",end:"'",illegal:/\n/,contains:[t.BACKSLASH_ESCAPE]},{begin:'"',end:'"',illegal:/\n/,contains:[t.BACKSLASH_ESCAPE,s,a]}]};a.contains.push(i);const l={className:"meta",begin:"@(?:file|property|field|get|set|receiver|param|setparam|delegate)\\s*:(?:\\s*"+t.UNDERSCORE_IDENT_RE+")?"},c={className:"meta",begin:"@"+t.UNDERSCORE_IDENT_RE,contains:[{begin:/\(/,end:/\)/,contains:[t.inherit(i,{className:"string"}),"self"]}]},d=ire,p=t.COMMENT("/\\*","\\*/",{contains:[t.C_BLOCK_COMMENT_MODE]}),g={variants:[{className:"type",begin:t.UNDERSCORE_IDENT_RE},{begin:/\(/,end:/\)/,contains:[]}]},m=g;return m.variants[1].contains=[g],g.variants[1].contains=[m],{name:"Kotlin",aliases:["kt","kts"],keywords:e,contains:[t.COMMENT("/\\*\\*","\\*/",{relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"}]}),t.C_LINE_COMMENT_MODE,p,r,n,l,c,{className:"function",beginKeywords:"fun",end:"[(]|$",returnBegin:!0,excludeEnd:!0,keywords:e,relevance:5,contains:[{begin:t.UNDERSCORE_IDENT_RE+"\\s*\\(",returnBegin:!0,relevance:0,contains:[t.UNDERSCORE_TITLE_MODE]},{className:"type",begin:/</,end:/>/,keywords:"reified",relevance:0},{className:"params",begin:/\(/,end:/\)/,endsParent:!0,keywords:e,relevance:0,contains:[{begin:/:/,end:/[=,\/]/,endsWithParent:!0,contains:[g,t.C_LINE_COMMENT_MODE,p],relevance:0},t.C_LINE_COMMENT_MODE,p,l,c,i,t.C_NUMBER_MODE]},p]},{begin:[/class|interface|trait/,/\s+/,t.UNDERSCORE_IDENT_RE],beginScope:{3:"title.class"},keywords:"class interface trait",end:/[:\{(]|$/,excludeEnd:!0,illegal:"extends implements",contains:[{beginKeywords:"public protected internal private constructor"},t.UNDERSCORE_TITLE_MODE,{className:"type",begin:/</,end:/>/,excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:/[,:]\s*/,end:/[<\(,){\s]|$/,excludeBegin:!0,returnEnd:!0},l,c]},i,{className:"meta",begin:"^#!/usr/bin/env",end:"$",illegal:`
`},d]}}const lre=t=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:t.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),cre=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],ure=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],dre=[...cre,...ure],hre=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),MD=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),OD=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),pre=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse(),gre=MD.concat(OD).sort().reverse();function fre(t){const e=lre(t),r=gre,n="and or not only",a="[\\w-]+",s="("+a+"|@\\{"+a+"\\})",i=[],l=[],c=function(P){return{className:"string",begin:"~?"+P+".*?"+P}},d=function(P,F,D){return{className:P,begin:F,relevance:D}},p={$pattern:/[a-z-]+/,keyword:n,attribute:hre.join(" ")},g={begin:"\\(",end:"\\)",contains:l,keywords:p,relevance:0};l.push(t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,c("'"),c('"'),e.CSS_NUMBER_MODE,{begin:"(url|data-uri)\\(",starts:{className:"string",end:"[\\)\\n]",excludeEnd:!0}},e.HEXCOLOR,g,d("variable","@@?"+a,10),d("variable","@\\{"+a+"\\}"),d("built_in","~?`[^`]*?`"),{className:"attribute",begin:a+"\\s*:",end:":",returnBegin:!0,excludeEnd:!0},e.IMPORTANT,{beginKeywords:"and not"},e.FUNCTION_DISPATCH);const m=l.concat({begin:/\{/,end:/\}/,contains:i}),y={beginKeywords:"when",endsWithParent:!0,contains:[{beginKeywords:"and not"}].concat(l)},x={begin:s+"\\s*:",returnBegin:!0,end:/[;}]/,relevance:0,contains:[{begin:/-(webkit|moz|ms|o)-/},e.CSS_VARIABLE,{className:"attribute",begin:"\\b("+pre.join("|")+")\\b",end:/(?=:)/,starts:{endsWithParent:!0,illegal:"[<=$]",relevance:0,contains:l}}]},w={className:"keyword",begin:"@(import|media|charset|font-face|(-[a-z]+-)?keyframes|supports|document|namespace|page|viewport|host)\\b",starts:{end:"[;{}]",keywords:p,returnEnd:!0,contains:l,relevance:0}},T={className:"variable",variants:[{begin:"@"+a+"\\s*:",relevance:15},{begin:"@"+a}],starts:{end:"[;}]",returnEnd:!0,contains:m}},k={variants:[{begin:"[\\.#:&\\[>]",end:"[;{}]"},{begin:s,end:/\{/}],returnBegin:!0,returnEnd:!0,illegal:`[<='$"]`,relevance:0,contains:[t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,y,d("keyword","all\\b"),d("variable","@\\{"+a+"\\}"),{begin:"\\b("+dre.join("|")+")\\b",className:"selector-tag"},e.CSS_NUMBER_MODE,d("selector-tag",s,0),d("selector-id","#"+s),d("selector-class","\\."+s,0),d("selector-tag","&",0),e.ATTRIBUTE_SELECTOR_MODE,{className:"selector-pseudo",begin:":("+MD.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+OD.join("|")+")"},{begin:/\(/,end:/\)/,relevance:0,contains:m},{begin:"!important"},e.FUNCTION_DISPATCH]},_={begin:a+`:(:)?(${r.join("|")})`,returnBegin:!0,contains:[k]};return i.push(t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,w,T,_,x,k,y,e.FUNCTION_DISPATCH),{name:"Less",case_insensitive:!0,illegal:`[=>'/<($"]`,contains:i}}function mre(t){const e="\\[=*\\[",r="\\]=*\\]",n={begin:e,end:r,contains:["self"]},a=[t.COMMENT("--(?!"+e+")","$"),t.COMMENT("--"+e,r,{contains:[n],relevance:10})];return{name:"Lua",aliases:["pluto"],keywords:{$pattern:t.UNDERSCORE_IDENT_RE,literal:"true false nil",keyword:"and break do else elseif end for goto if in local not or repeat return then until while",built_in:"_G _ENV _VERSION __index __newindex __mode __call __metatable __tostring __len __gc __add __sub __mul __div __mod __pow __concat __unm __eq __lt __le assert collectgarbage dofile error getfenv getmetatable ipairs load loadfile loadstring module next pairs pcall print rawequal rawget rawset require select setfenv setmetatable tonumber tostring type unpack xpcall arg self coroutine resume yield status wrap create running debug getupvalue debug sethook getmetatable gethook setmetatable setlocal traceback setfenv getinfo setupvalue getlocal getregistry getfenv io lines write close flush open output type read stderr stdin input stdout popen tmpfile math log max acos huge ldexp pi cos tanh pow deg tan cosh sinh random randomseed frexp ceil floor rad abs sqrt modf asin min mod fmod log10 atan2 exp sin atan os exit setlocale date getenv difftime remove time clock tmpname rename execute package preload loadlib loaded loaders cpath config path seeall string sub upper len gfind rep find match char dump gmatch reverse byte format gsub lower table setn insert getn foreachi maxn foreach concat sort remove"},contains:a.concat([{className:"function",beginKeywords:"function",end:"\\)",contains:[t.inherit(t.TITLE_MODE,{begin:"([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*"}),{className:"params",begin:"\\(",endsWithParent:!0,contains:a}].concat(a)},t.C_NUMBER_MODE,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,{className:"string",begin:e,end:r,contains:[n],relevance:5}])}}function yre(t){const e={className:"variable",variants:[{begin:"\\$\\("+t.UNDERSCORE_IDENT_RE+"\\)",contains:[t.BACKSLASH_ESCAPE]},{begin:/\$[@%<?\^\+\*]/}]},r={className:"string",begin:/"/,end:/"/,contains:[t.BACKSLASH_ESCAPE,e]},n={className:"variable",begin:/\$\([\w-]+\s/,end:/\)/,keywords:{built_in:"subst patsubst strip findstring filter filter-out sort word wordlist firstword lastword dir notdir suffix basename addsuffix addprefix join wildcard realpath abspath error warning shell origin flavor foreach if or and call eval file value"},contains:[e,r]},a={begin:"^"+t.UNDERSCORE_IDENT_RE+"\\s*(?=[:+?]?=)"},s={className:"meta",begin:/^\.PHONY:/,end:/$/,keywords:{$pattern:/[\.\w]+/,keyword:".PHONY"}},i={className:"section",begin:/^[^\s]+:/,end:/$/,contains:[e]};return{name:"Makefile",aliases:["mk","mak","make"],keywords:{$pattern:/[\w-]+/,keyword:"define endef undefine ifdef ifndef ifeq ifneq else endif include -include sinclude override export unexport private vpath"},contains:[t.HASH_COMMENT_MODE,e,r,n,a,s,i]}}function bre(t){const e=t.regex,r={begin:/<\/?[A-Za-z_]/,end:">",subLanguage:"xml",relevance:0},n={begin:"^[-\\*]{3,}",end:"$"},a={className:"code",variants:[{begin:"(`{3,})[^`](.|\\n)*?\\1`*[ ]*"},{begin:"(~{3,})[^~](.|\\n)*?\\1~*[ ]*"},{begin:"```",end:"```+[ ]*$"},{begin:"~~~",end:"~~~+[ ]*$"},{begin:"`.+?`"},{begin:"(?=^( {4}|\\t))",contains:[{begin:"^( {4}|\\t)",end:"(\\n)$"}],relevance:0}]},s={className:"bullet",begin:"^[ 	]*([*+-]|(\\d+\\.))(?=\\s+)",end:"\\s+",excludeEnd:!0},i={begin:/^\[[^\n]+\]:/,returnBegin:!0,contains:[{className:"symbol",begin:/\[/,end:/\]/,excludeBegin:!0,excludeEnd:!0},{className:"link",begin:/:\s*/,end:/$/,excludeBegin:!0}]},l=/[A-Za-z][A-Za-z0-9+.-]*/,c={variants:[{begin:/\[.+?\]\[.*?\]/,relevance:0},{begin:/\[.+?\]\(((data|javascript|mailto):|(?:http|ftp)s?:\/\/).*?\)/,relevance:2},{begin:e.concat(/\[.+?\]\(/,l,/:\/\/.*?\)/),relevance:2},{begin:/\[.+?\]\([./?&#].*?\)/,relevance:1},{begin:/\[.*?\]\(.*?\)/,relevance:0}],returnBegin:!0,contains:[{match:/\[(?=\])/},{className:"string",relevance:0,begin:"\\[",end:"\\]",excludeBegin:!0,returnEnd:!0},{className:"link",relevance:0,begin:"\\]\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0},{className:"symbol",relevance:0,begin:"\\]\\[",end:"\\]",excludeBegin:!0,excludeEnd:!0}]},d={className:"strong",contains:[],variants:[{begin:/_{2}(?!\s)/,end:/_{2}/},{begin:/\*{2}(?!\s)/,end:/\*{2}/}]},p={className:"emphasis",contains:[],variants:[{begin:/\*(?![*\s])/,end:/\*/},{begin:/_(?![_\s])/,end:/_/,relevance:0}]},g=t.inherit(d,{contains:[]}),m=t.inherit(p,{contains:[]});d.contains.push(m),p.contains.push(g);let y=[r,c];return[d,p,g,m].forEach(k=>{k.contains=k.contains.concat(y)}),y=y.concat(d,p),{name:"Markdown",aliases:["md","mkdown","mkd"],contains:[{className:"section",variants:[{begin:"^#{1,6}",end:"$",contains:y},{begin:"(?=^.+?\\n[=-]{2,}$)",contains:[{begin:"^[=-]*$"},{begin:"^",end:"\\n",contains:y}]}]},r,s,d,p,{className:"quote",begin:"^>\\s+",contains:y,end:"$"},a,n,c,i,{scope:"literal",match:/&([a-zA-Z0-9]+|#[0-9]{1,7}|#[Xx][0-9a-fA-F]{1,6});/}]}}function xre(t){const e={className:"built_in",begin:"\\b(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)\\w+"},r=/[a-zA-Z@][a-zA-Z0-9_]*/,l={"variable.language":["this","super"],$pattern:r,keyword:["while","export","sizeof","typedef","const","struct","for","union","volatile","static","mutable","if","do","return","goto","enum","else","break","extern","asm","case","default","register","explicit","typename","switch","continue","inline","readonly","assign","readwrite","self","@synchronized","id","typeof","nonatomic","IBOutlet","IBAction","strong","weak","copy","in","out","inout","bycopy","byref","oneway","__strong","__weak","__block","__autoreleasing","@private","@protected","@public","@try","@property","@end","@throw","@catch","@finally","@autoreleasepool","@synthesize","@dynamic","@selector","@optional","@required","@encode","@package","@import","@defs","@compatibility_alias","__bridge","__bridge_transfer","__bridge_retained","__bridge_retain","__covariant","__contravariant","__kindof","_Nonnull","_Nullable","_Null_unspecified","__FUNCTION__","__PRETTY_FUNCTION__","__attribute__","getter","setter","retain","unsafe_unretained","nonnull","nullable","null_unspecified","null_resettable","class","instancetype","NS_DESIGNATED_INITIALIZER","NS_UNAVAILABLE","NS_REQUIRES_SUPER","NS_RETURNS_INNER_POINTER","NS_INLINE","NS_AVAILABLE","NS_DEPRECATED","NS_ENUM","NS_OPTIONS","NS_SWIFT_UNAVAILABLE","NS_ASSUME_NONNULL_BEGIN","NS_ASSUME_NONNULL_END","NS_REFINED_FOR_SWIFT","NS_SWIFT_NAME","NS_SWIFT_NOTHROW","NS_DURING","NS_HANDLER","NS_ENDHANDLER","NS_VALUERETURN","NS_VOIDRETURN"],literal:["false","true","FALSE","TRUE","nil","YES","NO","NULL"],built_in:["dispatch_once_t","dispatch_queue_t","dispatch_sync","dispatch_async","dispatch_once"],type:["int","float","char","unsigned","signed","short","long","double","wchar_t","unichar","void","bool","BOOL","id|0","_Bool"]},c={$pattern:r,keyword:["@interface","@class","@protocol","@implementation"]};return{name:"Objective-C",aliases:["mm","objc","obj-c","obj-c++","objective-c++"],keywords:l,illegal:"</",contains:[e,t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,t.C_NUMBER_MODE,t.QUOTE_STRING_MODE,t.APOS_STRING_MODE,{className:"string",variants:[{begin:'@"',end:'"',illegal:"\\n",contains:[t.BACKSLASH_ESCAPE]}]},{className:"meta",begin:/#\s*[a-z]+\b/,end:/$/,keywords:{keyword:"if else elif endif define undef warning error line pragma ifdef ifndef include"},contains:[{begin:/\\\n/,relevance:0},t.inherit(t.QUOTE_STRING_MODE,{className:"string"}),{className:"string",begin:/<.*?>/,end:/$/,illegal:"\\n"},t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE]},{className:"class",begin:"("+c.keyword.join("|")+")\\b",end:/(\{|$)/,excludeEnd:!0,keywords:c,contains:[t.UNDERSCORE_TITLE_MODE]},{begin:"\\."+t.UNDERSCORE_IDENT_RE,relevance:0}]}}function vre(t){const e=t.regex,r=["abs","accept","alarm","and","atan2","bind","binmode","bless","break","caller","chdir","chmod","chomp","chop","chown","chr","chroot","class","close","closedir","connect","continue","cos","crypt","dbmclose","dbmopen","defined","delete","die","do","dump","each","else","elsif","endgrent","endhostent","endnetent","endprotoent","endpwent","endservent","eof","eval","exec","exists","exit","exp","fcntl","field","fileno","flock","for","foreach","fork","format","formline","getc","getgrent","getgrgid","getgrnam","gethostbyaddr","gethostbyname","gethostent","getlogin","getnetbyaddr","getnetbyname","getnetent","getpeername","getpgrp","getpriority","getprotobyname","getprotobynumber","getprotoent","getpwent","getpwnam","getpwuid","getservbyname","getservbyport","getservent","getsockname","getsockopt","given","glob","gmtime","goto","grep","gt","hex","if","index","int","ioctl","join","keys","kill","last","lc","lcfirst","length","link","listen","local","localtime","log","lstat","lt","ma","map","method","mkdir","msgctl","msgget","msgrcv","msgsnd","my","ne","next","no","not","oct","open","opendir","or","ord","our","pack","package","pipe","pop","pos","print","printf","prototype","push","q|0","qq","quotemeta","qw","qx","rand","read","readdir","readline","readlink","readpipe","recv","redo","ref","rename","require","reset","return","reverse","rewinddir","rindex","rmdir","say","scalar","seek","seekdir","select","semctl","semget","semop","send","setgrent","sethostent","setnetent","setpgrp","setpriority","setprotoent","setpwent","setservent","setsockopt","shift","shmctl","shmget","shmread","shmwrite","shutdown","sin","sleep","socket","socketpair","sort","splice","split","sprintf","sqrt","srand","stat","state","study","sub","substr","symlink","syscall","sysopen","sysread","sysseek","system","syswrite","tell","telldir","tie","tied","time","times","tr","truncate","uc","ucfirst","umask","undef","unless","unlink","unpack","unshift","untie","until","use","utime","values","vec","wait","waitpid","wantarray","warn","when","while","write","x|0","xor","y|0"],n=/[dualxmsipngr]{0,12}/,a={$pattern:/[\w.]+/,keyword:r.join(" ")},s={className:"subst",begin:"[$@]\\{",end:"\\}",keywords:a},i={begin:/->\{/,end:/\}/},l={scope:"attr",match:/\s+:\s*\w+(\s*\(.*?\))?/},c={scope:"variable",variants:[{begin:/\$\d/},{begin:e.concat(/[$%@](?!")(\^\w\b|#\w+(::\w+)*|\{\w+\}|\w+(::\w*)*)/,"(?![A-Za-z])(?![@$%])")},{begin:/[$%@](?!")[^\s\w{=]|\$=/,relevance:0}],contains:[l]},d={className:"number",variants:[{match:/0?\.[0-9][0-9_]+\b/},{match:/\bv?(0|[1-9][0-9_]*(\.[0-9_]+)?|[1-9][0-9_]*)\b/},{match:/\b0[0-7][0-7_]*\b/},{match:/\b0x[0-9a-fA-F][0-9a-fA-F_]*\b/},{match:/\b0b[0-1][0-1_]*\b/}],relevance:0},p=[t.BACKSLASH_ESCAPE,s,c],g=[/!/,/\//,/\|/,/\?/,/'/,/"/,/#/],m=(w,T,k="\\1")=>{const _=k==="\\1"?k:e.concat(k,T);return e.concat(e.concat("(?:",w,")"),T,/(?:\\.|[^\\\/])*?/,_,/(?:\\.|[^\\\/])*?/,k,n)},y=(w,T,k)=>e.concat(e.concat("(?:",w,")"),T,/(?:\\.|[^\\\/])*?/,k,n),x=[c,t.HASH_COMMENT_MODE,t.COMMENT(/^=\w/,/=cut/,{endsWithParent:!0}),i,{className:"string",contains:p,variants:[{begin:"q[qwxr]?\\s*\\(",end:"\\)",relevance:5},{begin:"q[qwxr]?\\s*\\[",end:"\\]",relevance:5},{begin:"q[qwxr]?\\s*\\{",end:"\\}",relevance:5},{begin:"q[qwxr]?\\s*\\|",end:"\\|",relevance:5},{begin:"q[qwxr]?\\s*<",end:">",relevance:5},{begin:"qw\\s+q",end:"q",relevance:5},{begin:"'",end:"'",contains:[t.BACKSLASH_ESCAPE]},{begin:'"',end:'"'},{begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE]},{begin:/\{\w+\}/,relevance:0},{begin:"-?\\w+\\s*=>",relevance:0}]},d,{begin:"(\\/\\/|"+t.RE_STARTERS_RE+"|\\b(split|return|print|reverse|grep)\\b)\\s*",keywords:"split return print reverse grep",relevance:0,contains:[t.HASH_COMMENT_MODE,{className:"regexp",variants:[{begin:m("s|tr|y",e.either(...g,{capture:!0}))},{begin:m("s|tr|y","\\(","\\)")},{begin:m("s|tr|y","\\[","\\]")},{begin:m("s|tr|y","\\{","\\}")}],relevance:2},{className:"regexp",variants:[{begin:/(m|qr)\/\//,relevance:0},{begin:y("(?:m|qr)?",/\//,/\//)},{begin:y("m|qr",e.either(...g,{capture:!0}),/\1/)},{begin:y("m|qr",/\(/,/\)/)},{begin:y("m|qr",/\[/,/\]/)},{begin:y("m|qr",/\{/,/\}/)}]}]},{className:"function",beginKeywords:"sub method",end:"(\\s*\\(.*?\\))?[;{]",excludeEnd:!0,relevance:5,contains:[t.TITLE_MODE,l]},{className:"class",beginKeywords:"class",end:"[;{]",excludeEnd:!0,relevance:5,contains:[t.TITLE_MODE,l,d]},{begin:"-\\w\\b",relevance:0},{begin:"^__DATA__$",end:"^__END__$",subLanguage:"mojolicious",contains:[{begin:"^@@.*",end:"$",className:"comment"}]}];return s.contains=x,i.contains=x,{name:"Perl",aliases:["pl","pm"],keywords:a,contains:x}}function wre(t){const e=t.regex,r=/(?![A-Za-z0-9])(?![$])/,n=e.concat(/[a-zA-Z_\x7f-\xff][a-zA-Z0-9_\x7f-\xff]*/,r),a=e.concat(/(\\?[A-Z][a-z0-9_\x7f-\xff]+|\\?[A-Z]+(?=[A-Z][a-z0-9_\x7f-\xff])){1,}/,r),s=e.concat(/[A-Z]+/,r),i={scope:"variable",match:"\\$+"+n},l={scope:"meta",variants:[{begin:/<\?php/,relevance:10},{begin:/<\?=/},{begin:/<\?/,relevance:.1},{begin:/\?>/}]},c={scope:"subst",variants:[{begin:/\$\w+/},{begin:/\{\$/,end:/\}/}]},d=t.inherit(t.APOS_STRING_MODE,{illegal:null}),p=t.inherit(t.QUOTE_STRING_MODE,{illegal:null,contains:t.QUOTE_STRING_MODE.contains.concat(c)}),g={begin:/<<<[ \t]*(?:(\w+)|"(\w+)")\n/,end:/[ \t]*(\w+)\b/,contains:t.QUOTE_STRING_MODE.contains.concat(c),"on:begin":(Q,W)=>{W.data._beginMatch=Q[1]||Q[2]},"on:end":(Q,W)=>{W.data._beginMatch!==Q[1]&&W.ignoreMatch()}},m=t.END_SAME_AS_BEGIN({begin:/<<<[ \t]*'(\w+)'\n/,end:/[ \t]*(\w+)\b/}),y=`[ 	
]`,x={scope:"string",variants:[p,d,g,m]},w={scope:"number",variants:[{begin:"\\b0[bB][01]+(?:_[01]+)*\\b"},{begin:"\\b0[oO][0-7]+(?:_[0-7]+)*\\b"},{begin:"\\b0[xX][\\da-fA-F]+(?:_[\\da-fA-F]+)*\\b"},{begin:"(?:\\b\\d+(?:_\\d+)*(\\.(?:\\d+(?:_\\d+)*))?|\\B\\.\\d+)(?:[eE][+-]?\\d+)?"}],relevance:0},T=["false","null","true"],k=["__CLASS__","__DIR__","__FILE__","__FUNCTION__","__COMPILER_HALT_OFFSET__","__LINE__","__METHOD__","__NAMESPACE__","__TRAIT__","die","echo","exit","include","include_once","print","require","require_once","array","abstract","and","as","binary","bool","boolean","break","callable","case","catch","class","clone","const","continue","declare","default","do","double","else","elseif","empty","enddeclare","endfor","endforeach","endif","endswitch","endwhile","enum","eval","extends","final","finally","float","for","foreach","from","global","goto","if","implements","instanceof","insteadof","int","integer","interface","isset","iterable","list","match|0","mixed","new","never","object","or","private","protected","public","readonly","real","return","string","switch","throw","trait","try","unset","use","var","void","while","xor","yield"],_=["Error|0","AppendIterator","ArgumentCountError","ArithmeticError","ArrayIterator","ArrayObject","AssertionError","BadFunctionCallException","BadMethodCallException","CachingIterator","CallbackFilterIterator","CompileError","Countable","DirectoryIterator","DivisionByZeroError","DomainException","EmptyIterator","ErrorException","Exception","FilesystemIterator","FilterIterator","GlobIterator","InfiniteIterator","InvalidArgumentException","IteratorIterator","LengthException","LimitIterator","LogicException","MultipleIterator","NoRewindIterator","OutOfBoundsException","OutOfRangeException","OuterIterator","OverflowException","ParentIterator","ParseError","RangeException","RecursiveArrayIterator","RecursiveCachingIterator","RecursiveCallbackFilterIterator","RecursiveDirectoryIterator","RecursiveFilterIterator","RecursiveIterator","RecursiveIteratorIterator","RecursiveRegexIterator","RecursiveTreeIterator","RegexIterator","RuntimeException","SeekableIterator","SplDoublyLinkedList","SplFileInfo","SplFileObject","SplFixedArray","SplHeap","SplMaxHeap","SplMinHeap","SplObjectStorage","SplObserver","SplPriorityQueue","SplQueue","SplStack","SplSubject","SplTempFileObject","TypeError","UnderflowException","UnexpectedValueException","UnhandledMatchError","ArrayAccess","BackedEnum","Closure","Fiber","Generator","Iterator","IteratorAggregate","Serializable","Stringable","Throwable","Traversable","UnitEnum","WeakReference","WeakMap","Directory","__PHP_Incomplete_Class","parent","php_user_filter","self","static","stdClass"],F={keyword:k,literal:(Q=>{const W=[];return Q.forEach(H=>{W.push(H),H.toLowerCase()===H?W.push(H.toUpperCase()):W.push(H.toLowerCase())}),W})(T),built_in:_},D=Q=>Q.map(W=>W.replace(/\|\d+$/,"")),B={variants:[{match:[/new/,e.concat(y,"+"),e.concat("(?!",D(_).join("\\b|"),"\\b)"),a],scope:{1:"keyword",4:"title.class"}}]},M=e.concat(n,"\\b(?!\\()"),$={variants:[{match:[e.concat(/::/,e.lookahead(/(?!class\b)/)),M],scope:{2:"variable.constant"}},{match:[/::/,/class/],scope:{2:"variable.language"}},{match:[a,e.concat(/::/,e.lookahead(/(?!class\b)/)),M],scope:{1:"title.class",3:"variable.constant"}},{match:[a,e.concat("::",e.lookahead(/(?!class\b)/))],scope:{1:"title.class"}},{match:[a,/::/,/class/],scope:{1:"title.class",3:"variable.language"}}]},Z={scope:"attr",match:e.concat(n,e.lookahead(":"),e.lookahead(/(?!::)/))},z={relevance:0,begin:/\(/,end:/\)/,keywords:F,contains:[Z,i,$,t.C_BLOCK_COMMENT_MODE,x,w,B]},ee={relevance:0,match:[/\b/,e.concat("(?!fn\\b|function\\b|",D(k).join("\\b|"),"|",D(_).join("\\b|"),"\\b)"),n,e.concat(y,"*"),e.lookahead(/(?=\()/)],scope:{3:"title.function.invoke"},contains:[z]};z.contains.push(ee);const te=[Z,$,t.C_BLOCK_COMMENT_MODE,x,w,B],X={begin:e.concat(/#\[\s*\\?/,e.either(a,s)),beginScope:"meta",end:/]/,endScope:"meta",keywords:{literal:T,keyword:["new","array"]},contains:[{begin:/\[/,end:/]/,keywords:{literal:T,keyword:["new","array"]},contains:["self",...te]},...te,{scope:"meta",variants:[{match:a},{match:s}]}]};return{case_insensitive:!1,keywords:F,contains:[X,t.HASH_COMMENT_MODE,t.COMMENT("//","$"),t.COMMENT("/\\*","\\*/",{contains:[{scope:"doctag",match:"@[A-Za-z]+"}]}),{match:/__halt_compiler\(\);/,keywords:"__halt_compiler",starts:{scope:"comment",end:t.MATCH_NOTHING_RE,contains:[{match:/\?>/,scope:"meta",endsParent:!0}]}},l,{scope:"variable.language",match:/\$this\b/},i,ee,$,{match:[/const/,/\s/,n],scope:{1:"keyword",3:"variable.constant"}},B,{scope:"function",relevance:0,beginKeywords:"fn function",end:/[;{]/,excludeEnd:!0,illegal:"[$%\\[]",contains:[{beginKeywords:"use"},t.UNDERSCORE_TITLE_MODE,{begin:"=>",endsParent:!0},{scope:"params",begin:"\\(",end:"\\)",excludeBegin:!0,excludeEnd:!0,keywords:F,contains:["self",X,i,$,t.C_BLOCK_COMMENT_MODE,x,w]}]},{scope:"class",variants:[{beginKeywords:"enum",illegal:/[($"]/},{beginKeywords:"class interface trait",illegal:/[:($"]/}],relevance:0,end:/\{/,excludeEnd:!0,contains:[{beginKeywords:"extends implements"},t.UNDERSCORE_TITLE_MODE]},{beginKeywords:"namespace",relevance:0,end:";",illegal:/[.']/,contains:[t.inherit(t.UNDERSCORE_TITLE_MODE,{scope:"title.class"})]},{beginKeywords:"use",relevance:0,end:";",contains:[{match:/\b(as|const|function)\b/,scope:"keyword"},t.UNDERSCORE_TITLE_MODE]},x,w]}}function Sre(t){return{name:"PHP template",subLanguage:"xml",contains:[{begin:/<\?(php|=)?/,end:/\?>/,subLanguage:"php",contains:[{begin:"/\\*",end:"\\*/",skip:!0},{begin:'b"',end:'"',skip:!0},{begin:"b'",end:"'",skip:!0},t.inherit(t.APOS_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0}),t.inherit(t.QUOTE_STRING_MODE,{illegal:null,className:null,contains:null,skip:!0})]}]}}function kre(t){return{name:"Plain text",aliases:["text","txt"],disableAutodetect:!0}}function Tre(t){const e=t.regex,r=new RegExp("[\\p{XID_Start}_]\\p{XID_Continue}*","u"),n=["and","as","assert","async","await","break","case","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","in","is","lambda","match","nonlocal|10","not","or","pass","raise","return","try","while","with","yield"],l={$pattern:/[A-Za-z]\w+|__\w+__/,keyword:n,built_in:["__import__","abs","all","any","ascii","bin","bool","breakpoint","bytearray","bytes","callable","chr","classmethod","compile","complex","delattr","dict","dir","divmod","enumerate","eval","exec","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip"],literal:["__debug__","Ellipsis","False","None","NotImplemented","True"],type:["Any","Callable","Coroutine","Dict","List","Literal","Generic","Optional","Sequence","Set","Tuple","Type","Union"]},c={className:"meta",begin:/^(>>>|\.\.\.) /},d={className:"subst",begin:/\{/,end:/\}/,keywords:l,illegal:/#/},p={begin:/\{\{/,relevance:0},g={className:"string",contains:[t.BACKSLASH_ESCAPE],variants:[{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?'''/,end:/'''/,contains:[t.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([uU]|[bB]|[rR]|[bB][rR]|[rR][bB])?"""/,end:/"""/,contains:[t.BACKSLASH_ESCAPE,c],relevance:10},{begin:/([fF][rR]|[rR][fF]|[fF])'''/,end:/'''/,contains:[t.BACKSLASH_ESCAPE,c,p,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"""/,end:/"""/,contains:[t.BACKSLASH_ESCAPE,c,p,d]},{begin:/([uU]|[rR])'/,end:/'/,relevance:10},{begin:/([uU]|[rR])"/,end:/"/,relevance:10},{begin:/([bB]|[bB][rR]|[rR][bB])'/,end:/'/},{begin:/([bB]|[bB][rR]|[rR][bB])"/,end:/"/},{begin:/([fF][rR]|[rR][fF]|[fF])'/,end:/'/,contains:[t.BACKSLASH_ESCAPE,p,d]},{begin:/([fF][rR]|[rR][fF]|[fF])"/,end:/"/,contains:[t.BACKSLASH_ESCAPE,p,d]},t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},m="[0-9](_?[0-9])*",y=`(\\b(${m}))?\\.(${m})|\\b(${m})\\.`,x=`\\b|${n.join("|")}`,w={className:"number",relevance:0,variants:[{begin:`(\\b(${m})|(${y}))[eE][+-]?(${m})[jJ]?(?=${x})`},{begin:`(${y})[jJ]?`},{begin:`\\b([1-9](_?[0-9])*|0+(_?0)*)[lLjJ]?(?=${x})`},{begin:`\\b0[bB](_?[01])+[lL]?(?=${x})`},{begin:`\\b0[oO](_?[0-7])+[lL]?(?=${x})`},{begin:`\\b0[xX](_?[0-9a-fA-F])+[lL]?(?=${x})`},{begin:`\\b(${m})[jJ](?=${x})`}]},T={className:"comment",begin:e.lookahead(/# type:/),end:/$/,keywords:l,contains:[{begin:/# type:/},{begin:/#/,end:/\b\B/,endsWithParent:!0}]},k={className:"params",variants:[{className:"",begin:/\(\s*\)/,skip:!0},{begin:/\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:["self",c,w,g,t.HASH_COMMENT_MODE]}]};return d.contains=[g,w,c],{name:"Python",aliases:["py","gyp","ipython"],unicodeRegex:!0,keywords:l,illegal:/(<\/|\?)|=>/,contains:[c,w,{scope:"variable.language",match:/\bself\b/},{beginKeywords:"if",relevance:0},{match:/\bor\b/,scope:"keyword"},g,T,t.HASH_COMMENT_MODE,{match:[/\bdef/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[k]},{variants:[{match:[/\bclass/,/\s+/,r,/\s*/,/\(\s*/,r,/\s*\)/]},{match:[/\bclass/,/\s+/,r]}],scope:{1:"keyword",3:"title.class",6:"title.class.inherited"}},{className:"meta",begin:/^[\t ]*@/,end:/(?=#)|$/,contains:[w,k,g]}]}}function Cre(t){return{aliases:["pycon"],contains:[{className:"meta.prompt",starts:{end:/ |$/,starts:{end:"$",subLanguage:"python"}},variants:[{begin:/^>>>(?=[ ]|$)/},{begin:/^\.\.\.(?=[ ]|$)/}]}]}}function Ere(t){const e=t.regex,r=/(?:(?:[a-zA-Z]|\.[._a-zA-Z])[._a-zA-Z0-9]*)|\.(?!\d)/,n=e.either(/0[xX][0-9a-fA-F]+\.[0-9a-fA-F]*[pP][+-]?\d+i?/,/0[xX][0-9a-fA-F]+(?:[pP][+-]?\d+)?[Li]?/,/(?:\d+(?:\.\d*)?|\.\d+)(?:[eE][+-]?\d+)?[Li]?/),a=/[=!<>:]=|\|\||&&|:::?|<-|<<-|->>|->|\|>|[-+*\/?!$&|:<=>@^~]|\*\*/,s=e.either(/[()]/,/[{}]/,/\[\[/,/[[\]]/,/\\/,/,/);return{name:"R",keywords:{$pattern:r,keyword:"function if in break next repeat else for while",literal:"NULL NA TRUE FALSE Inf NaN NA_integer_|10 NA_real_|10 NA_character_|10 NA_complex_|10",built_in:"LETTERS letters month.abb month.name pi T F abs acos acosh all any anyNA Arg as.call as.character as.complex as.double as.environment as.integer as.logical as.null.default as.numeric as.raw asin asinh atan atanh attr attributes baseenv browser c call ceiling class Conj cos cosh cospi cummax cummin cumprod cumsum digamma dim dimnames emptyenv exp expression floor forceAndCall gamma gc.time globalenv Im interactive invisible is.array is.atomic is.call is.character is.complex is.double is.environment is.expression is.finite is.function is.infinite is.integer is.language is.list is.logical is.matrix is.na is.name is.nan is.null is.numeric is.object is.pairlist is.raw is.recursive is.single is.symbol lazyLoadDBfetch length lgamma list log max min missing Mod names nargs nzchar oldClass on.exit pos.to.env proc.time prod quote range Re rep retracemem return round seq_along seq_len seq.int sign signif sin sinh sinpi sqrt standardGeneric substitute sum switch tan tanh tanpi tracemem trigamma trunc unclass untracemem UseMethod xtfrm"},contains:[t.COMMENT(/#'/,/$/,{contains:[{scope:"doctag",match:/@examples/,starts:{end:e.lookahead(e.either(/\n^#'\s*(?=@[a-zA-Z]+)/,/\n^(?!#')/)),endsParent:!0}},{scope:"doctag",begin:"@param",end:/$/,contains:[{scope:"variable",variants:[{match:r},{match:/`(?:\\.|[^`\\])+`/}],endsParent:!0}]},{scope:"doctag",match:/@[a-zA-Z]+/},{scope:"keyword",match:/\\[a-zA-Z]+/}]}),t.HASH_COMMENT_MODE,{scope:"string",contains:[t.BACKSLASH_ESCAPE],variants:[t.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\(/,end:/\)(-*)"/}),t.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\{/,end:/\}(-*)"/}),t.END_SAME_AS_BEGIN({begin:/[rR]"(-*)\[/,end:/\](-*)"/}),t.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\(/,end:/\)(-*)'/}),t.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\{/,end:/\}(-*)'/}),t.END_SAME_AS_BEGIN({begin:/[rR]'(-*)\[/,end:/\](-*)'/}),{begin:'"',end:'"',relevance:0},{begin:"'",end:"'",relevance:0}]},{relevance:0,variants:[{scope:{1:"operator",2:"number"},match:[a,n]},{scope:{1:"operator",2:"number"},match:[/%[^%]*%/,n]},{scope:{1:"punctuation",2:"number"},match:[s,n]},{scope:{2:"number"},match:[/[^a-zA-Z0-9._]|^/,n]}]},{scope:{3:"operator"},match:[r,/\s+/,/<-/,/\s+/]},{scope:"operator",relevance:0,variants:[{match:a},{match:/%[^%]*%/}]},{scope:"punctuation",relevance:0,match:s},{begin:"`",end:"`",contains:[{begin:/\\./}]}]}}function _re(t){const e=t.regex,r="([a-zA-Z_]\\w*[!?=]?|[-+~]@|<<|>>|=~|===?|<=>|[<>]=?|\\*\\*|[-/+%^&*~`|]|\\[\\]=?)",n=e.either(/\b([A-Z]+[a-z0-9]+)+/,/\b([A-Z]+[a-z0-9]+)+[A-Z]+/),a=e.concat(n,/(::\w+)*/),i={"variable.constant":["__FILE__","__LINE__","__ENCODING__"],"variable.language":["self","super"],keyword:["alias","and","begin","BEGIN","break","case","class","defined","do","else","elsif","end","END","ensure","for","if","in","module","next","not","or","redo","require","rescue","retry","return","then","undef","unless","until","when","while","yield",...["include","extend","prepend","public","private","protected","raise","throw"]],built_in:["proc","lambda","attr_accessor","attr_reader","attr_writer","define_method","private_constant","module_function"],literal:["true","false","nil"]},l={className:"doctag",begin:"@[A-Za-z]+"},c={begin:"#<",end:">"},d=[t.COMMENT("#","$",{contains:[l]}),t.COMMENT("^=begin","^=end",{contains:[l],relevance:10}),t.COMMENT("^__END__",t.MATCH_NOTHING_RE)],p={className:"subst",begin:/#\{/,end:/\}/,keywords:i},g={className:"string",contains:[t.BACKSLASH_ESCAPE,p],variants:[{begin:/'/,end:/'/},{begin:/"/,end:/"/},{begin:/`/,end:/`/},{begin:/%[qQwWx]?\(/,end:/\)/},{begin:/%[qQwWx]?\[/,end:/\]/},{begin:/%[qQwWx]?\{/,end:/\}/},{begin:/%[qQwWx]?</,end:/>/},{begin:/%[qQwWx]?\//,end:/\//},{begin:/%[qQwWx]?%/,end:/%/},{begin:/%[qQwWx]?-/,end:/-/},{begin:/%[qQwWx]?\|/,end:/\|/},{begin:/\B\?(\\\d{1,3})/},{begin:/\B\?(\\x[A-Fa-f0-9]{1,2})/},{begin:/\B\?(\\u\{?[A-Fa-f0-9]{1,6}\}?)/},{begin:/\B\?(\\M-\\C-|\\M-\\c|\\c\\M-|\\M-|\\C-\\M-)[\x20-\x7e]/},{begin:/\B\?\\(c|C-)[\x20-\x7e]/},{begin:/\B\?\\?\S/},{begin:e.concat(/<<[-~]?'?/,e.lookahead(/(\w+)(?=\W)[^\n]*\n(?:[^\n]*\n)*?\s*\1\b/)),contains:[t.END_SAME_AS_BEGIN({begin:/(\w+)/,end:/(\w+)/,contains:[t.BACKSLASH_ESCAPE,p]})]}]},m="[1-9](_?[0-9])*|0",y="[0-9](_?[0-9])*",x={className:"number",relevance:0,variants:[{begin:`\\b(${m})(\\.(${y}))?([eE][+-]?(${y})|r)?i?\\b`},{begin:"\\b0[dD][0-9](_?[0-9])*r?i?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*r?i?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*r?i?\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*r?i?\\b"},{begin:"\\b0(_?[0-7])+r?i?\\b"}]},w={variants:[{match:/\(\)/},{className:"params",begin:/\(/,end:/(?=\))/,excludeBegin:!0,endsParent:!0,keywords:i}]},B=[g,{variants:[{match:[/class\s+/,a,/\s+<\s+/,a]},{match:[/\b(class|module)\s+/,a]}],scope:{2:"title.class",4:"title.class.inherited"},keywords:i},{match:[/(include|extend)\s+/,a],scope:{2:"title.class"},keywords:i},{relevance:0,match:[a,/\.new[. (]/],scope:{1:"title.class"}},{relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"},{relevance:0,match:n,scope:"title.class"},{match:[/def/,/\s+/,r],scope:{1:"keyword",3:"title.function"},contains:[w]},{begin:t.IDENT_RE+"::"},{className:"symbol",begin:t.UNDERSCORE_IDENT_RE+"(!|\\?)?:",relevance:0},{className:"symbol",begin:":(?!\\s)",contains:[g,{begin:r}],relevance:0},x,{className:"variable",begin:"(\\$\\W)|((\\$|@@?)(\\w+))(?=[^@$?])(?![A-Za-z])(?![@$?'])"},{className:"params",begin:/\|(?!=)/,end:/\|/,excludeBegin:!0,excludeEnd:!0,relevance:0,keywords:i},{begin:"("+t.RE_STARTERS_RE+"|unless)\\s*",keywords:"unless",contains:[{className:"regexp",contains:[t.BACKSLASH_ESCAPE,p],illegal:/\n/,variants:[{begin:"/",end:"/[a-z]*"},{begin:/%r\{/,end:/\}[a-z]*/},{begin:"%r\\(",end:"\\)[a-z]*"},{begin:"%r!",end:"![a-z]*"},{begin:"%r\\[",end:"\\][a-z]*"}]}].concat(c,d),relevance:0}].concat(c,d);p.contains=B,w.contains=B;const z=[{begin:/^\s*=>/,starts:{end:"$",contains:B}},{className:"meta.prompt",begin:"^("+"[>?]>"+"|"+"[\\w#]+\\(\\w+\\):\\d+:\\d+[>*]"+"|"+"(\\w+-)?\\d+\\.\\d+\\.\\d+(p\\d+)?[^\\d][^>]+>"+")(?=[ ])",starts:{end:"$",keywords:i,contains:B}}];return d.unshift(c),{name:"Ruby",aliases:["rb","gemspec","podspec","thor","irb"],keywords:i,illegal:/\/\*/,contains:[t.SHEBANG({binary:"ruby"})].concat(z).concat(d).concat(B)}}function Are(t){const e=t.regex,r=/(r#)?/,n=e.concat(r,t.UNDERSCORE_IDENT_RE),a=e.concat(r,t.IDENT_RE),s={className:"title.function.invoke",relevance:0,begin:e.concat(/\b/,/(?!let|for|while|if|else|match\b)/,a,e.lookahead(/\s*\(/))},i="([ui](8|16|32|64|128|size)|f(32|64))?",l=["abstract","as","async","await","become","box","break","const","continue","crate","do","dyn","else","enum","extern","false","final","fn","for","if","impl","in","let","loop","macro","match","mod","move","mut","override","priv","pub","ref","return","self","Self","static","struct","super","trait","true","try","type","typeof","union","unsafe","unsized","use","virtual","where","while","yield"],c=["true","false","Some","None","Ok","Err"],d=["drop ","Copy","Send","Sized","Sync","Drop","Fn","FnMut","FnOnce","ToOwned","Clone","Debug","PartialEq","PartialOrd","Eq","Ord","AsRef","AsMut","Into","From","Default","Iterator","Extend","IntoIterator","DoubleEndedIterator","ExactSizeIterator","SliceConcatExt","ToString","assert!","assert_eq!","bitflags!","bytes!","cfg!","col!","concat!","concat_idents!","debug_assert!","debug_assert_eq!","env!","eprintln!","panic!","file!","format!","format_args!","include_bytes!","include_str!","line!","local_data_key!","module_path!","option_env!","print!","println!","select!","stringify!","try!","unimplemented!","unreachable!","vec!","write!","writeln!","macro_rules!","assert_ne!","debug_assert_ne!"],p=["i8","i16","i32","i64","i128","isize","u8","u16","u32","u64","u128","usize","f32","f64","str","char","bool","Box","Option","Result","String","Vec"];return{name:"Rust",aliases:["rs"],keywords:{$pattern:t.IDENT_RE+"!?",type:p,keyword:l,literal:c,built_in:d},illegal:"</",contains:[t.C_LINE_COMMENT_MODE,t.COMMENT("/\\*","\\*/",{contains:["self"]}),t.inherit(t.QUOTE_STRING_MODE,{begin:/b?"/,illegal:null}),{className:"symbol",begin:/'[a-zA-Z_][a-zA-Z0-9_]*(?!')/},{scope:"string",variants:[{begin:/b?r(#*)"(.|\n)*?"\1(?!#)/},{begin:/b?'/,end:/'/,contains:[{scope:"char.escape",match:/\\('|\w|x\w{2}|u\w{4}|U\w{8})/}]}]},{className:"number",variants:[{begin:"\\b0b([01_]+)"+i},{begin:"\\b0o([0-7_]+)"+i},{begin:"\\b0x([A-Fa-f0-9_]+)"+i},{begin:"\\b(\\d[\\d_]*(\\.[0-9_]+)?([eE][+-]?[0-9_]+)?)"+i}],relevance:0},{begin:[/fn/,/\s+/,n],className:{1:"keyword",3:"title.function"}},{className:"meta",begin:"#!?\\[",end:"\\]",contains:[{className:"string",begin:/"/,end:/"/,contains:[t.BACKSLASH_ESCAPE]}]},{begin:[/let/,/\s+/,/(?:mut\s+)?/,n],className:{1:"keyword",3:"keyword",4:"variable"}},{begin:[/for/,/\s+/,n,/\s+/,/in/],className:{1:"keyword",3:"variable",5:"keyword"}},{begin:[/type/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:[/(?:trait|enum|struct|union|impl|for)/,/\s+/,n],className:{1:"keyword",3:"title.class"}},{begin:t.IDENT_RE+"::",keywords:{keyword:"Self",built_in:d,type:p}},{className:"punctuation",begin:"->"},s]}}const Nre=t=>({IMPORTANT:{scope:"meta",begin:"!important"},BLOCK_COMMENT:t.C_BLOCK_COMMENT_MODE,HEXCOLOR:{scope:"number",begin:/#(([0-9a-fA-F]{3,4})|(([0-9a-fA-F]{2}){3,4}))\b/},FUNCTION_DISPATCH:{className:"built_in",begin:/[\w-]+(?=\()/},ATTRIBUTE_SELECTOR_MODE:{scope:"selector-attr",begin:/\[/,end:/\]/,illegal:"$",contains:[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE]},CSS_NUMBER_MODE:{scope:"number",begin:t.NUMBER_RE+"(%|em|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc|px|deg|grad|rad|turn|s|ms|Hz|kHz|dpi|dpcm|dppx)?",relevance:0},CSS_VARIABLE:{className:"attr",begin:/--[A-Za-z_][A-Za-z0-9_-]*/}}),Pre=["a","abbr","address","article","aside","audio","b","blockquote","body","button","canvas","caption","cite","code","dd","del","details","dfn","div","dl","dt","em","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","html","i","iframe","img","input","ins","kbd","label","legend","li","main","mark","menu","nav","object","ol","optgroup","option","p","picture","q","quote","samp","section","select","source","span","strong","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","ul","var","video"],Ire=["defs","g","marker","mask","pattern","svg","switch","symbol","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feGaussianBlur","feImage","feMerge","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","linearGradient","radialGradient","stop","circle","ellipse","image","line","path","polygon","polyline","rect","text","use","textPath","tspan","foreignObject","clipPath"],Rre=[...Pre,...Ire],Dre=["any-hover","any-pointer","aspect-ratio","color","color-gamut","color-index","device-aspect-ratio","device-height","device-width","display-mode","forced-colors","grid","height","hover","inverted-colors","monochrome","orientation","overflow-block","overflow-inline","pointer","prefers-color-scheme","prefers-contrast","prefers-reduced-motion","prefers-reduced-transparency","resolution","scan","scripting","update","width","min-width","max-width","min-height","max-height"].sort().reverse(),Lre=["active","any-link","blank","checked","current","default","defined","dir","disabled","drop","empty","enabled","first","first-child","first-of-type","fullscreen","future","focus","focus-visible","focus-within","has","host","host-context","hover","indeterminate","in-range","invalid","is","lang","last-child","last-of-type","left","link","local-link","not","nth-child","nth-col","nth-last-child","nth-last-col","nth-last-of-type","nth-of-type","only-child","only-of-type","optional","out-of-range","past","placeholder-shown","read-only","read-write","required","right","root","scope","target","target-within","user-invalid","valid","visited","where"].sort().reverse(),Mre=["after","backdrop","before","cue","cue-region","first-letter","first-line","grammar-error","marker","part","placeholder","selection","slotted","spelling-error"].sort().reverse(),Ore=["accent-color","align-content","align-items","align-self","alignment-baseline","all","anchor-name","animation","animation-composition","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-range","animation-range-end","animation-range-start","animation-timeline","animation-timing-function","appearance","aspect-ratio","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","block-size","border","border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-end-end-radius","border-end-start-radius","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-start-end-radius","border-start-start-radius","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-align","box-decoration-break","box-direction","box-flex","box-flex-group","box-lines","box-ordinal-group","box-orient","box-pack","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","color-scheme","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","contain-intrinsic-block-size","contain-intrinsic-height","contain-intrinsic-inline-size","contain-intrinsic-size","contain-intrinsic-width","container","container-name","container-type","content","content-visibility","counter-increment","counter-reset","counter-set","cue","cue-after","cue-before","cursor","cx","cy","direction","display","dominant-baseline","empty-cells","enable-background","field-sizing","fill","fill-opacity","fill-rule","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","flood-color","flood-opacity","flow","font","font-display","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-palette","font-size","font-size-adjust","font-smooth","font-smoothing","font-stretch","font-style","font-synthesis","font-synthesis-position","font-synthesis-small-caps","font-synthesis-style","font-synthesis-weight","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-emoji","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","forced-color-adjust","gap","glyph-orientation-horizontal","glyph-orientation-vertical","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphenate-character","hyphenate-limit-chars","hyphens","icon","image-orientation","image-rendering","image-resolution","ime-mode","initial-letter","initial-letter-align","inline-size","inset","inset-area","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","kerning","left","letter-spacing","lighting-color","line-break","line-height","line-height-step","list-style","list-style-image","list-style-position","list-style-type","margin","margin-block","margin-block-end","margin-block-start","margin-bottom","margin-inline","margin-inline-end","margin-inline-start","margin-left","margin-right","margin-top","margin-trim","marker","marker-end","marker-mid","marker-start","marks","mask","mask-border","mask-border-mode","mask-border-outset","mask-border-repeat","mask-border-slice","mask-border-source","mask-border-width","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","masonry-auto-flow","math-depth","math-shift","math-style","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","nav-down","nav-index","nav-left","nav-right","nav-up","none","normal","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-anchor","overflow-block","overflow-clip-margin","overflow-inline","overflow-wrap","overflow-x","overflow-y","overlay","overscroll-behavior","overscroll-behavior-block","overscroll-behavior-inline","overscroll-behavior-x","overscroll-behavior-y","padding","padding-block","padding-block-end","padding-block-start","padding-bottom","padding-inline","padding-inline-end","padding-inline-start","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","paint-order","pause","pause-after","pause-before","perspective","perspective-origin","place-content","place-items","place-self","pointer-events","position","position-anchor","position-visibility","print-color-adjust","quotes","r","resize","rest","rest-after","rest-before","right","rotate","row-gap","ruby-align","ruby-position","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-stop","scroll-snap-type","scroll-timeline","scroll-timeline-axis","scroll-timeline-name","scrollbar-color","scrollbar-gutter","scrollbar-width","shape-image-threshold","shape-margin","shape-outside","shape-rendering","speak","speak-as","src","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","table-layout","text-align","text-align-all","text-align-last","text-anchor","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-decoration-thickness","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-indent","text-justify","text-orientation","text-overflow","text-rendering","text-shadow","text-size-adjust","text-transform","text-underline-offset","text-underline-position","text-wrap","text-wrap-mode","text-wrap-style","timeline-scope","top","touch-action","transform","transform-box","transform-origin","transform-style","transition","transition-behavior","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-modify","user-select","vector-effect","vertical-align","view-timeline","view-timeline-axis","view-timeline-inset","view-timeline-name","view-transition-name","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","white-space","white-space-collapse","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","x","y","z-index","zoom"].sort().reverse();function jre(t){const e=Nre(t),r=Mre,n=Lre,a="@[a-z-]+",s="and or not only",l={className:"variable",begin:"(\\$"+"[a-zA-Z-][a-zA-Z0-9_-]*"+")\\b",relevance:0};return{name:"SCSS",case_insensitive:!0,illegal:"[=/|']",contains:[t.C_LINE_COMMENT_MODE,t.C_BLOCK_COMMENT_MODE,e.CSS_NUMBER_MODE,{className:"selector-id",begin:"#[A-Za-z0-9_-]+",relevance:0},{className:"selector-class",begin:"\\.[A-Za-z0-9_-]+",relevance:0},e.ATTRIBUTE_SELECTOR_MODE,{className:"selector-tag",begin:"\\b("+Rre.join("|")+")\\b",relevance:0},{className:"selector-pseudo",begin:":("+n.join("|")+")"},{className:"selector-pseudo",begin:":(:)?("+r.join("|")+")"},l,{begin:/\(/,end:/\)/,contains:[e.CSS_NUMBER_MODE]},e.CSS_VARIABLE,{className:"attribute",begin:"\\b("+Ore.join("|")+")\\b"},{begin:"\\b(whitespace|wait|w-resize|visible|vertical-text|vertical-ideographic|uppercase|upper-roman|upper-alpha|underline|transparent|top|thin|thick|text|text-top|text-bottom|tb-rl|table-header-group|table-footer-group|sw-resize|super|strict|static|square|solid|small-caps|separate|se-resize|scroll|s-resize|rtl|row-resize|ridge|right|repeat|repeat-y|repeat-x|relative|progress|pointer|overline|outside|outset|oblique|nowrap|not-allowed|normal|none|nw-resize|no-repeat|no-drop|newspaper|ne-resize|n-resize|move|middle|medium|ltr|lr-tb|lowercase|lower-roman|lower-alpha|loose|list-item|line|line-through|line-edge|lighter|left|keep-all|justify|italic|inter-word|inter-ideograph|inside|inset|inline|inline-block|inherit|inactive|ideograph-space|ideograph-parenthesis|ideograph-numeric|ideograph-alpha|horizontal|hidden|help|hand|groove|fixed|ellipsis|e-resize|double|dotted|distribute|distribute-space|distribute-letter|distribute-all-lines|disc|disabled|default|decimal|dashed|crosshair|collapse|col-resize|circle|char|center|capitalize|break-word|break-all|bottom|both|bolder|bold|block|bidi-override|below|baseline|auto|always|all-scroll|absolute|table|table-cell)\\b"},{begin:/:/,end:/[;}{]/,relevance:0,contains:[e.BLOCK_COMMENT,l,e.HEXCOLOR,e.CSS_NUMBER_MODE,t.QUOTE_STRING_MODE,t.APOS_STRING_MODE,e.IMPORTANT,e.FUNCTION_DISPATCH]},{begin:"@(page|font-face)",keywords:{$pattern:a,keyword:"@page @font-face"}},{begin:"@",end:"[{;]",returnBegin:!0,keywords:{$pattern:/[a-z-]+/,keyword:s,attribute:Dre.join(" ")},contains:[{begin:a,className:"keyword"},{begin:/[a-z-]+(?=:)/,className:"attribute"},l,t.QUOTE_STRING_MODE,t.APOS_STRING_MODE,e.HEXCOLOR,e.CSS_NUMBER_MODE]},e.FUNCTION_DISPATCH]}}function Bre(t){return{name:"Shell Session",aliases:["console","shellsession"],contains:[{className:"meta.prompt",begin:/^\s{0,3}[/~\w\d[\]()@-]*[>%$#][ ]?/,starts:{end:/[^\\](?=\s*$)/,subLanguage:"bash"}}]}}function Fre(t){const e=t.regex,r=t.COMMENT("--","$"),n={scope:"string",variants:[{begin:/'/,end:/'/,contains:[{match:/''/}]}]},a={begin:/"/,end:/"/,contains:[{match:/""/}]},s=["true","false","unknown"],i=["double precision","large object","with timezone","without timezone"],l=["bigint","binary","blob","boolean","char","character","clob","date","dec","decfloat","decimal","float","int","integer","interval","nchar","nclob","national","numeric","real","row","smallint","time","timestamp","varchar","varying","varbinary"],c=["add","asc","collation","desc","final","first","last","view"],d=["abs","acos","all","allocate","alter","and","any","are","array","array_agg","array_max_cardinality","as","asensitive","asin","asymmetric","at","atan","atomic","authorization","avg","begin","begin_frame","begin_partition","between","bigint","binary","blob","boolean","both","by","call","called","cardinality","cascaded","case","cast","ceil","ceiling","char","char_length","character","character_length","check","classifier","clob","close","coalesce","collate","collect","column","commit","condition","connect","constraint","contains","convert","copy","corr","corresponding","cos","cosh","count","covar_pop","covar_samp","create","cross","cube","cume_dist","current","current_catalog","current_date","current_default_transform_group","current_path","current_role","current_row","current_schema","current_time","current_timestamp","current_path","current_role","current_transform_group_for_type","current_user","cursor","cycle","date","day","deallocate","dec","decimal","decfloat","declare","default","define","delete","dense_rank","deref","describe","deterministic","disconnect","distinct","double","drop","dynamic","each","element","else","empty","end","end_frame","end_partition","end-exec","equals","escape","every","except","exec","execute","exists","exp","external","extract","false","fetch","filter","first_value","float","floor","for","foreign","frame_row","free","from","full","function","fusion","get","global","grant","group","grouping","groups","having","hold","hour","identity","in","indicator","initial","inner","inout","insensitive","insert","int","integer","intersect","intersection","interval","into","is","join","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","language","large","last_value","lateral","lead","leading","left","like","like_regex","listagg","ln","local","localtime","localtimestamp","log","log10","lower","match","match_number","match_recognize","matches","max","member","merge","method","min","minute","mod","modifies","module","month","multiset","national","natural","nchar","nclob","new","no","none","normalize","not","nth_value","ntile","null","nullif","numeric","octet_length","occurrences_regex","of","offset","old","omit","on","one","only","open","or","order","out","outer","over","overlaps","overlay","parameter","partition","pattern","per","percent","percent_rank","percentile_cont","percentile_disc","period","portion","position","position_regex","power","precedes","precision","prepare","primary","procedure","ptf","range","rank","reads","real","recursive","ref","references","referencing","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","release","result","return","returns","revoke","right","rollback","rollup","row","row_number","rows","running","savepoint","scope","scroll","search","second","seek","select","sensitive","session_user","set","show","similar","sin","sinh","skip","smallint","some","specific","specifictype","sql","sqlexception","sqlstate","sqlwarning","sqrt","start","static","stddev_pop","stddev_samp","submultiset","subset","substring","substring_regex","succeeds","sum","symmetric","system","system_time","system_user","table","tablesample","tan","tanh","then","time","timestamp","timezone_hour","timezone_minute","to","trailing","translate","translate_regex","translation","treat","trigger","trim","trim_array","true","truncate","uescape","union","unique","unknown","unnest","update","upper","user","using","value","values","value_of","var_pop","var_samp","varbinary","varchar","varying","versioning","when","whenever","where","width_bucket","window","with","within","without","year"],p=["abs","acos","array_agg","asin","atan","avg","cast","ceil","ceiling","coalesce","corr","cos","cosh","count","covar_pop","covar_samp","cume_dist","dense_rank","deref","element","exp","extract","first_value","floor","json_array","json_arrayagg","json_exists","json_object","json_objectagg","json_query","json_table","json_table_primitive","json_value","lag","last_value","lead","listagg","ln","log","log10","lower","max","min","mod","nth_value","ntile","nullif","percent_rank","percentile_cont","percentile_disc","position","position_regex","power","rank","regr_avgx","regr_avgy","regr_count","regr_intercept","regr_r2","regr_slope","regr_sxx","regr_sxy","regr_syy","row_number","sin","sinh","sqrt","stddev_pop","stddev_samp","substring","substring_regex","sum","tan","tanh","translate","translate_regex","treat","trim","trim_array","unnest","upper","value_of","var_pop","var_samp","width_bucket"],g=["current_catalog","current_date","current_default_transform_group","current_path","current_role","current_schema","current_transform_group_for_type","current_user","session_user","system_time","system_user","current_time","localtime","current_timestamp","localtimestamp"],m=["create table","insert into","primary key","foreign key","not null","alter table","add constraint","grouping sets","on overflow","character set","respect nulls","ignore nulls","nulls first","nulls last","depth first","breadth first"],y=p,x=[...d,...c].filter(D=>!p.includes(D)),w={scope:"variable",match:/@[a-z0-9][a-z0-9_]*/},T={scope:"operator",match:/[-+*/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?/,relevance:0},k={match:e.concat(/\b/,e.either(...y),/\s*\(/),relevance:0,keywords:{built_in:y}};function _(D){return e.concat(/\b/,e.either(...D.map(B=>B.replace(/\s+/,"\\s+"))),/\b/)}const P={scope:"keyword",match:_(m),relevance:0};function F(D,{exceptions:B,when:M}={}){const $=M;return B=B||[],D.map(Z=>Z.match(/\|\d+$/)||B.includes(Z)?Z:$(Z)?`${Z}|0`:Z)}return{name:"SQL",case_insensitive:!0,illegal:/[{}]|<\//,keywords:{$pattern:/\b[\w\.]+/,keyword:F(x,{when:D=>D.length<3}),literal:s,type:l,built_in:g},contains:[{scope:"type",match:_(i)},P,k,w,n,a,t.C_NUMBER_MODE,t.C_BLOCK_COMMENT_MODE,r,T]}}function jD(t){return t?typeof t=="string"?t:t.source:null}function Op(t){return Un("(?=",t,")")}function Un(...t){return t.map(r=>jD(r)).join("")}function zre(t){const e=t[t.length-1];return typeof e=="object"&&e.constructor===Object?(t.splice(t.length-1,1),e):{}}function Ps(...t){return"("+(zre(t).capture?"":"?:")+t.map(n=>jD(n)).join("|")+")"}const ZS=t=>Un(/\b/,t,/\w$/.test(t)?/\b/:/\B/),$re=["Protocol","Type"].map(ZS),GA=["init","self"].map(ZS),Ure=["Any","Self"],Yv=["actor","any","associatedtype","async","await",/as\?/,/as!/,"as","borrowing","break","case","catch","class","consume","consuming","continue","convenience","copy","default","defer","deinit","didSet","distributed","do","dynamic","each","else","enum","extension","fallthrough",/fileprivate\(set\)/,"fileprivate","final","for","func","get","guard","if","import","indirect","infix",/init\?/,/init!/,"inout",/internal\(set\)/,"internal","in","is","isolated","nonisolated","lazy","let","macro","mutating","nonmutating",/open\(set\)/,"open","operator","optional","override","package","postfix","precedencegroup","prefix",/private\(set\)/,"private","protocol",/public\(set\)/,"public","repeat","required","rethrows","return","set","some","static","struct","subscript","super","switch","throws","throw",/try\?/,/try!/,"try","typealias",/unowned\(safe\)/,/unowned\(unsafe\)/,"unowned","var","weak","where","while","willSet"],VA=["false","nil","true"],qre=["assignment","associativity","higherThan","left","lowerThan","none","right"],Hre=["#colorLiteral","#column","#dsohandle","#else","#elseif","#endif","#error","#file","#fileID","#fileLiteral","#filePath","#function","#if","#imageLiteral","#keyPath","#line","#selector","#sourceLocation","#warning"],WA=["abs","all","any","assert","assertionFailure","debugPrint","dump","fatalError","getVaList","isKnownUniquelyReferenced","max","min","numericCast","pointwiseMax","pointwiseMin","precondition","preconditionFailure","print","readLine","repeatElement","sequence","stride","swap","swift_unboxFromSwiftValueWithType","transcode","type","unsafeBitCast","unsafeDowncast","withExtendedLifetime","withUnsafeMutablePointer","withUnsafePointer","withVaList","withoutActuallyEscaping","zip"],BD=Ps(/[/=\-+!*%<>&|^~?]/,/[\u00A1-\u00A7]/,/[\u00A9\u00AB]/,/[\u00AC\u00AE]/,/[\u00B0\u00B1]/,/[\u00B6\u00BB\u00BF\u00D7\u00F7]/,/[\u2016-\u2017]/,/[\u2020-\u2027]/,/[\u2030-\u203E]/,/[\u2041-\u2053]/,/[\u2055-\u205E]/,/[\u2190-\u23FF]/,/[\u2500-\u2775]/,/[\u2794-\u2BFF]/,/[\u2E00-\u2E7F]/,/[\u3001-\u3003]/,/[\u3008-\u3020]/,/[\u3030]/),FD=Ps(BD,/[\u0300-\u036F]/,/[\u1DC0-\u1DFF]/,/[\u20D0-\u20FF]/,/[\uFE00-\uFE0F]/,/[\uFE20-\uFE2F]/),Qv=Un(BD,FD,"*"),zD=Ps(/[a-zA-Z_]/,/[\u00A8\u00AA\u00AD\u00AF\u00B2-\u00B5\u00B7-\u00BA]/,/[\u00BC-\u00BE\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF]/,/[\u0100-\u02FF\u0370-\u167F\u1681-\u180D\u180F-\u1DBF]/,/[\u1E00-\u1FFF]/,/[\u200B-\u200D\u202A-\u202E\u203F-\u2040\u2054\u2060-\u206F]/,/[\u2070-\u20CF\u2100-\u218F\u2460-\u24FF\u2776-\u2793]/,/[\u2C00-\u2DFF\u2E80-\u2FFF]/,/[\u3004-\u3007\u3021-\u302F\u3031-\u303F\u3040-\uD7FF]/,/[\uF900-\uFD3D\uFD40-\uFDCF\uFDF0-\uFE1F\uFE30-\uFE44]/,/[\uFE47-\uFEFE\uFF00-\uFFFD]/),q0=Ps(zD,/\d/,/[\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]/),Bo=Un(zD,q0,"*"),Bm=Un(/[A-Z]/,q0,"*"),Gre=["attached","autoclosure",Un(/convention\(/,Ps("swift","block","c"),/\)/),"discardableResult","dynamicCallable","dynamicMemberLookup","escaping","freestanding","frozen","GKInspectable","IBAction","IBDesignable","IBInspectable","IBOutlet","IBSegueAction","inlinable","main","nonobjc","NSApplicationMain","NSCopying","NSManaged",Un(/objc\(/,Bo,/\)/),"objc","objcMembers","propertyWrapper","requires_stored_property_inits","resultBuilder","Sendable","testable","UIApplicationMain","unchecked","unknown","usableFromInline","warn_unqualified_access"],Vre=["iOS","iOSApplicationExtension","macOS","macOSApplicationExtension","macCatalyst","macCatalystApplicationExtension","watchOS","watchOSApplicationExtension","tvOS","tvOSApplicationExtension","swift"];function Wre(t){const e={match:/\s+/,relevance:0},r=t.COMMENT("/\\*","\\*/",{contains:["self"]}),n=[t.C_LINE_COMMENT_MODE,r],a={match:[/\./,Ps(...$re,...GA)],className:{2:"keyword"}},s={match:Un(/\./,Ps(...Yv)),relevance:0},i=Yv.filter(Ie=>typeof Ie=="string").concat(["_|0"]),l=Yv.filter(Ie=>typeof Ie!="string").concat(Ure).map(ZS),c={variants:[{className:"keyword",match:Ps(...l,...GA)}]},d={$pattern:Ps(/\b\w+/,/#\w+/),keyword:i.concat(Hre),literal:VA},p=[a,s,c],g={match:Un(/\./,Ps(...WA)),relevance:0},m={className:"built_in",match:Un(/\b/,Ps(...WA),/(?=\()/)},y=[g,m],x={match:/->/,relevance:0},w={className:"operator",relevance:0,variants:[{match:Qv},{match:`\\.(\\.|${FD})+`}]},T=[x,w],k="([0-9]_*)+",_="([0-9a-fA-F]_*)+",P={className:"number",relevance:0,variants:[{match:`\\b(${k})(\\.(${k}))?([eE][+-]?(${k}))?\\b`},{match:`\\b0x(${_})(\\.(${_}))?([pP][+-]?(${k}))?\\b`},{match:/\b0o([0-7]_*)+\b/},{match:/\b0b([01]_*)+\b/}]},F=(Ie="")=>({className:"subst",variants:[{match:Un(/\\/,Ie,/[0\\tnr"']/)},{match:Un(/\\/,Ie,/u\{[0-9a-fA-F]{1,8}\}/)}]}),D=(Ie="")=>({className:"subst",match:Un(/\\/,Ie,/[\t ]*(?:[\r\n]|\r\n)/)}),B=(Ie="")=>({className:"subst",label:"interpol",begin:Un(/\\/,Ie,/\(/),end:/\)/}),M=(Ie="")=>({begin:Un(Ie,/"""/),end:Un(/"""/,Ie),contains:[F(Ie),D(Ie),B(Ie)]}),$=(Ie="")=>({begin:Un(Ie,/"/),end:Un(/"/,Ie),contains:[F(Ie),B(Ie)]}),Z={className:"string",variants:[M(),M("#"),M("##"),M("###"),$(),$("#"),$("##"),$("###")]},z=[t.BACKSLASH_ESCAPE,{begin:/\[/,end:/\]/,relevance:0,contains:[t.BACKSLASH_ESCAPE]}],ee={begin:/\/[^\s](?=[^/\n]*\/)/,end:/\//,contains:z},te=Ie=>{const ze=Un(Ie,/\//),nt=Un(/\//,Ie);return{begin:ze,end:nt,contains:[...z,{scope:"comment",begin:`#(?!.*${nt})`,end:/$/}]}},X={scope:"regexp",variants:[te("###"),te("##"),te("#"),ee]},Q={match:Un(/`/,Bo,/`/)},W={className:"variable",match:/\$\d+/},H={className:"variable",match:`\\$${q0}+`},re=[Q,W,H],ne={match:/(@|#(un)?)available/,scope:"keyword",starts:{contains:[{begin:/\(/,end:/\)/,keywords:Vre,contains:[...T,P,Z]}]}},ve={scope:"keyword",match:Un(/@/,Ps(...Gre),Op(Ps(/\(/,/\s+/)))},O={scope:"meta",match:Un(/@/,Bo)},I=[ne,ve,O],K={match:Op(/\b[A-Z]/),relevance:0,contains:[{className:"type",match:Un(/(AV|CA|CF|CG|CI|CL|CM|CN|CT|MK|MP|MTK|MTL|NS|SCN|SK|UI|WK|XC)/,q0,"+")},{className:"type",match:Bm,relevance:0},{match:/[?!]+/,relevance:0},{match:/\.\.\./,relevance:0},{match:Un(/\s+&\s+/,Op(Bm)),relevance:0}]},U={begin:/</,end:/>/,keywords:d,contains:[...n,...p,...I,x,K]};K.contains.push(U);const ce={match:Un(Bo,/\s*:/),keywords:"_|0",relevance:0},ye={begin:/\(/,end:/\)/,relevance:0,keywords:d,contains:["self",ce,...n,X,...p,...y,...T,P,Z,...re,...I,K]},Ae={begin:/</,end:/>/,keywords:"repeat each",contains:[...n,K]},fe={begin:Ps(Op(Un(Bo,/\s*:/)),Op(Un(Bo,/\s+/,Bo,/\s*:/))),end:/:/,relevance:0,contains:[{className:"keyword",match:/\b_\b/},{className:"params",match:Bo}]},Ne={begin:/\(/,end:/\)/,keywords:d,contains:[fe,...n,...p,...T,P,Z,...I,K,ye],endsParent:!0,illegal:/["']/},Te={match:[/(func|macro)/,/\s+/,Ps(Q.match,Bo,Qv)],className:{1:"keyword",3:"title.function"},contains:[Ae,Ne,e],illegal:[/\[/,/%/]},se={match:[/\b(?:subscript|init[?!]?)/,/\s*(?=[<(])/],className:{1:"keyword"},contains:[Ae,Ne,e],illegal:/\[|%/},be={match:[/operator/,/\s+/,Qv],className:{1:"keyword",3:"title"}},xe={begin:[/precedencegroup/,/\s+/,Bm],className:{1:"keyword",3:"title"},contains:[K],keywords:[...qre,...VA],end:/}/},me={match:[/class\b/,/\s+/,/func\b/,/\s+/,/\b[A-Za-z_][A-Za-z0-9_]*\b/],scope:{1:"keyword",3:"keyword",5:"title.function"}},de={match:[/class\b/,/\s+/,/var\b/],scope:{1:"keyword",3:"keyword"}},he={begin:[/(struct|protocol|class|extension|enum|actor)/,/\s+/,Bo,/\s*/],beginScope:{1:"keyword",3:"title.class"},keywords:d,contains:[Ae,...p,{begin:/:/,end:/\{/,keywords:d,contains:[{scope:"title.class.inherited",match:Bm},...p],relevance:0}]};for(const Ie of Z.variants){const ze=Ie.contains.find(mt=>mt.label==="interpol");ze.keywords=d;const nt=[...p,...y,...T,P,Z,...re];ze.contains=[...nt,{begin:/\(/,end:/\)/,contains:["self",...nt]}]}return{name:"Swift",keywords:d,contains:[...n,Te,se,me,de,he,be,xe,{beginKeywords:"import",end:/$/,contains:[...n],relevance:0},X,...p,...y,...T,P,Z,...re,...I,K,ye]}}const H0="[A-Za-z$_][0-9A-Za-z$_]*",$D=["as","in","of","if","for","while","finally","var","new","function","do","return","void","else","break","catch","instanceof","with","throw","case","default","try","switch","continue","typeof","delete","let","yield","const","class","debugger","async","await","static","import","from","export","extends","using"],UD=["true","false","null","undefined","NaN","Infinity"],qD=["Object","Function","Boolean","Symbol","Math","Date","Number","BigInt","String","RegExp","Array","Float32Array","Float64Array","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Int32Array","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array","Set","Map","WeakSet","WeakMap","ArrayBuffer","SharedArrayBuffer","Atomics","DataView","JSON","Promise","Generator","GeneratorFunction","AsyncFunction","Reflect","Proxy","Intl","WebAssembly"],HD=["Error","EvalError","InternalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"],GD=["setInterval","setTimeout","clearInterval","clearTimeout","require","exports","eval","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","unescape"],VD=["arguments","this","super","console","window","document","localStorage","sessionStorage","module","global"],WD=[].concat(GD,qD,HD);function Yre(t){const e=t.regex,r=(ne,{after:ve})=>{const O="</"+ne[0].slice(1);return ne.input.indexOf(O,ve)!==-1},n=H0,a={begin:"<>",end:"</>"},s=/<[A-Za-z0-9\\._:-]+\s*\/>/,i={begin:/<[A-Za-z0-9\\._:-]+/,end:/\/[A-Za-z0-9\\._:-]+>|\/>/,isTrulyOpeningTag:(ne,ve)=>{const O=ne[0].length+ne.index,I=ne.input[O];if(I==="<"||I===","){ve.ignoreMatch();return}I===">"&&(r(ne,{after:O})||ve.ignoreMatch());let K;const U=ne.input.substring(O);if(K=U.match(/^\s*=/)){ve.ignoreMatch();return}if((K=U.match(/^\s+extends\s+/))&&K.index===0){ve.ignoreMatch();return}}},l={$pattern:H0,keyword:$D,literal:UD,built_in:WD,"variable.language":VD},c="[0-9](_?[0-9])*",d=`\\.(${c})`,p="0|[1-9](_?[0-9])*|0[0-7]*[89][0-9]*",g={className:"number",variants:[{begin:`(\\b(${p})((${d})|\\.)?|(${d}))[eE][+-]?(${c})\\b`},{begin:`\\b(${p})\\b((${d})\\b|\\.)?|(${d})\\b`},{begin:"\\b(0|[1-9](_?[0-9])*)n\\b"},{begin:"\\b0[xX][0-9a-fA-F](_?[0-9a-fA-F])*n?\\b"},{begin:"\\b0[bB][0-1](_?[0-1])*n?\\b"},{begin:"\\b0[oO][0-7](_?[0-7])*n?\\b"},{begin:"\\b0[0-7]+n?\\b"}],relevance:0},m={className:"subst",begin:"\\$\\{",end:"\\}",keywords:l,contains:[]},y={begin:".?html`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"xml"}},x={begin:".?css`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"css"}},w={begin:".?gql`",end:"",starts:{end:"`",returnEnd:!1,contains:[t.BACKSLASH_ESCAPE,m],subLanguage:"graphql"}},T={className:"string",begin:"`",end:"`",contains:[t.BACKSLASH_ESCAPE,m]},_={className:"comment",variants:[t.COMMENT(/\/\*\*(?!\/)/,"\\*/",{relevance:0,contains:[{begin:"(?=@[A-Za-z]+)",relevance:0,contains:[{className:"doctag",begin:"@[A-Za-z]+"},{className:"type",begin:"\\{",end:"\\}",excludeEnd:!0,excludeBegin:!0,relevance:0},{className:"variable",begin:n+"(?=\\s*(-)|$)",endsParent:!0,relevance:0},{begin:/(?=[^\n])\s/,relevance:0}]}]}),t.C_BLOCK_COMMENT_MODE,t.C_LINE_COMMENT_MODE]},P=[t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,y,x,w,T,{match:/\$\d+/},g];m.contains=P.concat({begin:/\{/,end:/\}/,keywords:l,contains:["self"].concat(P)});const F=[].concat(_,m.contains),D=F.concat([{begin:/(\s*)\(/,end:/\)/,keywords:l,contains:["self"].concat(F)}]),B={className:"params",begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:D},M={variants:[{match:[/class/,/\s+/,n,/\s+/,/extends/,/\s+/,e.concat(n,"(",e.concat(/\./,n),")*")],scope:{1:"keyword",3:"title.class",5:"keyword",7:"title.class.inherited"}},{match:[/class/,/\s+/,n],scope:{1:"keyword",3:"title.class"}}]},$={relevance:0,match:e.either(/\bJSON/,/\b[A-Z][a-z]+([A-Z][a-z]*|\d)*/,/\b[A-Z]{2,}([A-Z][a-z]+|\d)+([A-Z][a-z]*)*/,/\b[A-Z]{2,}[a-z]+([A-Z][a-z]+|\d)*([A-Z][a-z]*)*/),className:"title.class",keywords:{_:[...qD,...HD]}},Z={label:"use_strict",className:"meta",relevance:10,begin:/^\s*['"]use (strict|asm)['"]/},z={variants:[{match:[/function/,/\s+/,n,/(?=\s*\()/]},{match:[/function/,/\s*(?=\()/]}],className:{1:"keyword",3:"title.function"},label:"func.def",contains:[B],illegal:/%/},ee={relevance:0,match:/\b[A-Z][A-Z_0-9]+\b/,className:"variable.constant"};function te(ne){return e.concat("(?!",ne.join("|"),")")}const X={match:e.concat(/\b/,te([...GD,"super","import"].map(ne=>`${ne}\\s*\\(`)),n,e.lookahead(/\s*\(/)),className:"title.function",relevance:0},Q={begin:e.concat(/\./,e.lookahead(e.concat(n,/(?![0-9A-Za-z$_(])/))),end:n,excludeBegin:!0,keywords:"prototype",className:"property",relevance:0},W={match:[/get|set/,/\s+/,n,/(?=\()/],className:{1:"keyword",3:"title.function"},contains:[{begin:/\(\)/},B]},H="(\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)|"+t.UNDERSCORE_IDENT_RE+")\\s*=>",re={match:[/const|var|let/,/\s+/,n,/\s*/,/=\s*/,/(async\s*)?/,e.lookahead(H)],keywords:"async",className:{1:"keyword",3:"title.function"},contains:[B]};return{name:"JavaScript",aliases:["js","jsx","mjs","cjs"],keywords:l,exports:{PARAMS_CONTAINS:D,CLASS_REFERENCE:$},illegal:/#(?![$_A-z])/,contains:[t.SHEBANG({label:"shebang",binary:"node",relevance:5}),Z,t.APOS_STRING_MODE,t.QUOTE_STRING_MODE,y,x,w,T,_,{match:/\$\d+/},g,$,{scope:"attr",match:n+e.lookahead(":"),relevance:0},re,{begin:"("+t.RE_STARTERS_RE+"|\\b(case|return|throw)\\b)\\s*",keywords:"return throw case",relevance:0,contains:[_,t.REGEXP_MODE,{className:"function",begin:H,returnBegin:!0,end:"\\s*=>",contains:[{className:"params",variants:[{begin:t.UNDERSCORE_IDENT_RE,relevance:0},{className:null,begin:/\(\s*\)/,skip:!0},{begin:/(\s*)\(/,end:/\)/,excludeBegin:!0,excludeEnd:!0,keywords:l,contains:D}]}]},{begin:/,/,relevance:0},{match:/\s+/,relevance:0},{variants:[{begin:a.begin,end:a.end},{match:s},{begin:i.begin,"on:begin":i.isTrulyOpeningTag,end:i.end}],subLanguage:"xml",contains:[{begin:i.begin,end:i.end,skip:!0,contains:["self"]}]}]},z,{beginKeywords:"while if switch catch for"},{begin:"\\b(?!function)"+t.UNDERSCORE_IDENT_RE+"\\([^()]*(\\([^()]*(\\([^()]*\\)[^()]*)*\\)[^()]*)*\\)\\s*\\{",returnBegin:!0,label:"func.def",contains:[B,t.inherit(t.TITLE_MODE,{begin:n,className:"title.function"})]},{match:/\.\.\./,relevance:0},Q,{match:"\\$"+n,relevance:0},{match:[/\bconstructor(?=\s*\()/],className:{1:"title.function"},contains:[B]},X,ee,M,W,{match:/\$[(.]/}]}}function Qre(t){const e=t.regex,r=Yre(t),n=H0,a=["any","void","number","boolean","string","object","never","symbol","bigint","unknown"],s={begin:[/namespace/,/\s+/,t.IDENT_RE],beginScope:{1:"keyword",3:"title.class"}},i={beginKeywords:"interface",end:/\{/,excludeEnd:!0,keywords:{keyword:"interface extends",built_in:a},contains:[r.exports.CLASS_REFERENCE]},l={className:"meta",relevance:10,begin:/^\s*['"]use strict['"]/},c=["type","interface","public","private","protected","implements","declare","abstract","readonly","enum","override","satisfies"],d={$pattern:H0,keyword:$D.concat(c),literal:UD,built_in:WD.concat(a),"variable.language":VD},p={className:"meta",begin:"@"+n},g=(w,T,k)=>{const _=w.contains.findIndex(P=>P.label===T);if(_===-1)throw new Error("can not find mode to replace");w.contains.splice(_,1,k)};Object.assign(r.keywords,d),r.exports.PARAMS_CONTAINS.push(p);const m=r.contains.find(w=>w.scope==="attr"),y=Object.assign({},m,{match:e.concat(n,e.lookahead(/\s*\?:/))});r.exports.PARAMS_CONTAINS.push([r.exports.CLASS_REFERENCE,m,y]),r.contains=r.contains.concat([p,s,i,y]),g(r,"shebang",t.SHEBANG()),g(r,"use_strict",l);const x=r.contains.find(w=>w.label==="func.def");return x.relevance=0,Object.assign(r,{name:"TypeScript",aliases:["ts","tsx","mts","cts"]}),r}function Kre(t){const e=t.regex,r={className:"string",begin:/"(""|[^/n])"C\b/},n={className:"string",begin:/"/,end:/"/,illegal:/\n/,contains:[{begin:/""/}]},a=/\d{1,2}\/\d{1,2}\/\d{4}/,s=/\d{4}-\d{1,2}-\d{1,2}/,i=/(\d|1[012])(:\d+){0,2} *(AM|PM)/,l=/\d{1,2}(:\d{1,2}){1,2}/,c={className:"literal",variants:[{begin:e.concat(/# */,e.either(s,a),/ *#/)},{begin:e.concat(/# */,l,/ *#/)},{begin:e.concat(/# */,i,/ *#/)},{begin:e.concat(/# */,e.either(s,a),/ +/,e.either(i,l),/ *#/)}]},d={className:"number",relevance:0,variants:[{begin:/\b\d[\d_]*((\.[\d_]+(E[+-]?[\d_]+)?)|(E[+-]?[\d_]+))[RFD@!#]?/},{begin:/\b\d[\d_]*((U?[SIL])|[%&])?/},{begin:/&H[\dA-F_]+((U?[SIL])|[%&])?/},{begin:/&O[0-7_]+((U?[SIL])|[%&])?/},{begin:/&B[01_]+((U?[SIL])|[%&])?/}]},p={className:"label",begin:/^\w+:/},g=t.COMMENT(/'''/,/$/,{contains:[{className:"doctag",begin:/<\/?/,end:/>/}]}),m=t.COMMENT(null,/$/,{variants:[{begin:/'/},{begin:/([\t ]|^)REM(?=\s)/}]});return{name:"Visual Basic .NET",aliases:["vb"],case_insensitive:!0,classNameAliases:{label:"symbol"},keywords:{keyword:"addhandler alias aggregate ansi as async assembly auto binary by byref byval call case catch class compare const continue custom declare default delegate dim distinct do each equals else elseif end enum erase error event exit explicit finally for friend from function get global goto group handles if implements imports in inherits interface into iterator join key let lib loop me mid module mustinherit mustoverride mybase myclass namespace narrowing new next notinheritable notoverridable of off on operator option optional order overloads overridable overrides paramarray partial preserve private property protected public raiseevent readonly redim removehandler resume return select set shadows shared skip static step stop structure strict sub synclock take text then throw to try unicode until using when where while widening with withevents writeonly yield",built_in:"addressof and andalso await directcast gettype getxmlnamespace is isfalse isnot istrue like mod nameof new not or orelse trycast typeof xor cbool cbyte cchar cdate cdbl cdec cint clng cobj csbyte cshort csng cstr cuint culng cushort",type:"boolean byte char date decimal double integer long object sbyte short single string uinteger ulong ushort",literal:"true false nothing"},illegal:"//|\\{|\\}|endif|gosub|variant|wend|^\\$ ",contains:[r,n,c,d,p,g,m,{className:"meta",begin:/[\t ]*#(const|disable|else|elseif|enable|end|externalsource|if|region)\b/,end:/$/,keywords:{keyword:"const disable else elseif enable end externalsource if region then"},contains:[m]}]}}function Xre(t){t.regex;const e=t.COMMENT(/\(;/,/;\)/);e.contains.push("self");const r=t.COMMENT(/;;/,/$/),n=["anyfunc","block","br","br_if","br_table","call","call_indirect","data","drop","elem","else","end","export","func","global.get","global.set","local.get","local.set","local.tee","get_global","get_local","global","if","import","local","loop","memory","memory.grow","memory.size","module","mut","nop","offset","param","result","return","select","set_global","set_local","start","table","tee_local","then","type","unreachable"],a={begin:[/(?:func|call|call_indirect)/,/\s+/,/\$[^\s)]+/],className:{1:"keyword",3:"title.function"}},s={className:"variable",begin:/\$[\w_]+/},i={match:/(\((?!;)|\))+/,className:"punctuation",relevance:0},l={className:"number",relevance:0,match:/[+-]?\b(?:\d(?:_?\d)*(?:\.\d(?:_?\d)*)?(?:[eE][+-]?\d(?:_?\d)*)?|0x[\da-fA-F](?:_?[\da-fA-F])*(?:\.[\da-fA-F](?:_?[\da-fA-D])*)?(?:[pP][+-]?\d(?:_?\d)*)?)\b|\binf\b|\bnan(?::0x[\da-fA-F](?:_?[\da-fA-D])*)?\b/},c={match:/(i32|i64|f32|f64)(?!\.)/,className:"type"},d={className:"keyword",match:/\b(f32|f64|i32|i64)(?:\.(?:abs|add|and|ceil|clz|const|convert_[su]\/i(?:32|64)|copysign|ctz|demote\/f64|div(?:_[su])?|eqz?|extend_[su]\/i32|floor|ge(?:_[su])?|gt(?:_[su])?|le(?:_[su])?|load(?:(?:8|16|32)_[su])?|lt(?:_[su])?|max|min|mul|nearest|neg?|or|popcnt|promote\/f32|reinterpret\/[fi](?:32|64)|rem_[su]|rot[lr]|shl|shr_[su]|store(?:8|16|32)?|sqrt|sub|trunc(?:_[su]\/f(?:32|64))?|wrap\/i64|xor))\b/};return{name:"WebAssembly",keywords:{$pattern:/[\w.]+/,keyword:n},contains:[r,e,{match:[/(?:offset|align)/,/\s*/,/=/],className:{1:"keyword",3:"operator"}},s,i,a,t.QUOTE_STRING_MODE,c,d,l]}}function Jre(t){const e=t.regex,r=e.concat(/[\p{L}_]/u,e.optional(/[\p{L}0-9_.-]*:/u),/[\p{L}0-9_.-]*/u),n=/[\p{L}0-9._:-]+/u,a={className:"symbol",begin:/&[a-z]+;|&#[0-9]+;|&#x[a-f0-9]+;/},s={begin:/\s/,contains:[{className:"keyword",begin:/#?[a-z_][a-z1-9_-]+/,illegal:/\n/}]},i=t.inherit(s,{begin:/\(/,end:/\)/}),l=t.inherit(t.APOS_STRING_MODE,{className:"string"}),c=t.inherit(t.QUOTE_STRING_MODE,{className:"string"}),d={endsWithParent:!0,illegal:/</,relevance:0,contains:[{className:"attr",begin:n,relevance:0},{begin:/=\s*/,relevance:0,contains:[{className:"string",endsParent:!0,variants:[{begin:/"/,end:/"/,contains:[a]},{begin:/'/,end:/'/,contains:[a]},{begin:/[^\s"'=<>`]+/}]}]}]};return{name:"HTML, XML",aliases:["html","xhtml","rss","atom","xjb","xsd","xsl","plist","wsf","svg"],case_insensitive:!0,unicodeRegex:!0,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,relevance:10,contains:[s,c,l,i,{begin:/\[/,end:/\]/,contains:[{className:"meta",begin:/<![a-z]/,end:/>/,contains:[s,i,c,l]}]}]},t.COMMENT(/<!--/,/-->/,{relevance:10}),{begin:/<!\[CDATA\[/,end:/\]\]>/,relevance:10},a,{className:"meta",end:/\?>/,variants:[{begin:/<\?xml/,relevance:10,contains:[c]},{begin:/<\?[a-z][a-z0-9]+/}]},{className:"tag",begin:/<style(?=\s|>)/,end:/>/,keywords:{name:"style"},contains:[d],starts:{end:/<\/style>/,returnEnd:!0,subLanguage:["css","xml"]}},{className:"tag",begin:/<script(?=\s|>)/,end:/>/,keywords:{name:"script"},contains:[d],starts:{end:/<\/script>/,returnEnd:!0,subLanguage:["javascript","handlebars","xml"]}},{className:"tag",begin:/<>|<\/>/},{className:"tag",begin:e.concat(/</,e.lookahead(e.concat(r,e.either(/\/>/,/>/,/\s/)))),end:/\/?>/,contains:[{className:"name",begin:r,relevance:0,starts:d}]},{className:"tag",begin:e.concat(/<\//,e.lookahead(e.concat(r,/>/))),contains:[{className:"name",begin:r,relevance:0},{begin:/>/,relevance:0,endsParent:!0}]}]}}function Zre(t){const e="true false yes no null",r="[\\w#;/?:@&=+$,.~*'()[\\]]+",n={className:"attr",variants:[{begin:/[\w*@][\w*@ :()\./-]*:(?=[ \t]|$)/},{begin:/"[\w*@][\w*@ :()\./-]*":(?=[ \t]|$)/},{begin:/'[\w*@][\w*@ :()\./-]*':(?=[ \t]|$)/}]},a={className:"template-variable",variants:[{begin:/\{\{/,end:/\}\}/},{begin:/%\{/,end:/\}/}]},s={className:"string",relevance:0,begin:/'/,end:/'/,contains:[{match:/''/,scope:"char.escape",relevance:0}]},i={className:"string",relevance:0,variants:[{begin:/"/,end:/"/},{begin:/\S+/}],contains:[t.BACKSLASH_ESCAPE,a]},l=t.inherit(i,{variants:[{begin:/'/,end:/'/,contains:[{begin:/''/,relevance:0}]},{begin:/"/,end:/"/},{begin:/[^\s,{}[\]]+/}]}),m={className:"number",begin:"\\b"+"[0-9]{4}(-[0-9][0-9]){0,2}"+"([Tt \\t][0-9][0-9]?(:[0-9][0-9]){2})?"+"(\\.[0-9]*)?"+"([ \\t])*(Z|[-+][0-9][0-9]?(:[0-9][0-9])?)?"+"\\b"},y={end:",",endsWithParent:!0,excludeEnd:!0,keywords:e,relevance:0},x={begin:/\{/,end:/\}/,contains:[y],illegal:"\\n",relevance:0},w={begin:"\\[",end:"\\]",contains:[y],illegal:"\\n",relevance:0},T=[n,{className:"meta",begin:"^---\\s*$",relevance:10},{className:"string",begin:"[\\|>]([1-9]?[+-])?[ ]*\\n( +)[^ ][^\\n]*\\n(\\2[^\\n]+\\n?)*"},{begin:"<%[%=-]?",end:"[%-]?%>",subLanguage:"ruby",excludeBegin:!0,excludeEnd:!0,relevance:0},{className:"type",begin:"!\\w+!"+r},{className:"type",begin:"!<"+r+">"},{className:"type",begin:"!"+r},{className:"type",begin:"!!"+r},{className:"meta",begin:"&"+t.UNDERSCORE_IDENT_RE+"$"},{className:"meta",begin:"\\*"+t.UNDERSCORE_IDENT_RE+"$"},{className:"bullet",begin:"-(?=[ ]|$)",relevance:0},t.HASH_COMMENT_MODE,{beginKeywords:e,keywords:{literal:e}},m,{className:"number",begin:t.C_NUMBER_RE+"\\b",relevance:0},x,w,s,i],k=[...T];return k.pop(),k.push(l),y.contains=k,{name:"YAML",case_insensitive:!0,aliases:["yml"],contains:T}}const ene={arduino:Mte,bash:Ote,c:jte,cpp:Bte,csharp:Fte,css:Yte,diff:Qte,go:Kte,graphql:Xte,ini:Jte,java:Zte,javascript:are,json:sre,kotlin:ore,less:fre,lua:mre,makefile:yre,markdown:bre,objectivec:xre,perl:vre,php:wre,"php-template":Sre,plaintext:kre,python:Tre,"python-repl":Cre,r:Ere,ruby:_re,rust:Are,scss:jre,shell:Bre,sql:Fre,swift:Wre,typescript:Qre,vbnet:Kre,wasm:Xre,xml:Jre,yaml:Zre};var Kv,YA;function tne(){if(YA)return Kv;YA=1;function t(Se){return Se instanceof Map?Se.clear=Se.delete=Se.set=function(){throw new Error("map is read-only")}:Se instanceof Set&&(Se.add=Se.clear=Se.delete=function(){throw new Error("set is read-only")}),Object.freeze(Se),Object.getOwnPropertyNames(Se).forEach(ut=>{const Nt=Se[ut],xr=typeof Nt;(xr==="object"||xr==="function")&&!Object.isFrozen(Nt)&&t(Nt)}),Se}class e{constructor(ut){ut.data===void 0&&(ut.data={}),this.data=ut.data,this.isMatchIgnored=!1}ignoreMatch(){this.isMatchIgnored=!0}}function r(Se){return Se.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}function n(Se,...ut){const Nt=Object.create(null);for(const xr in Se)Nt[xr]=Se[xr];return ut.forEach(function(xr){for(const Kr in xr)Nt[Kr]=xr[Kr]}),Nt}const a="</span>",s=Se=>!!Se.scope,i=(Se,{prefix:ut})=>{if(Se.startsWith("language:"))return Se.replace("language:","language-");if(Se.includes(".")){const Nt=Se.split(".");return[`${ut}${Nt.shift()}`,...Nt.map((xr,Kr)=>`${xr}${"_".repeat(Kr+1)}`)].join(" ")}return`${ut}${Se}`};class l{constructor(ut,Nt){this.buffer="",this.classPrefix=Nt.classPrefix,ut.walk(this)}addText(ut){this.buffer+=r(ut)}openNode(ut){if(!s(ut))return;const Nt=i(ut.scope,{prefix:this.classPrefix});this.span(Nt)}closeNode(ut){s(ut)&&(this.buffer+=a)}value(){return this.buffer}span(ut){this.buffer+=`<span class="${ut}">`}}const c=(Se={})=>{const ut={children:[]};return Object.assign(ut,Se),ut};class d{constructor(){this.rootNode=c(),this.stack=[this.rootNode]}get top(){return this.stack[this.stack.length-1]}get root(){return this.rootNode}add(ut){this.top.children.push(ut)}openNode(ut){const Nt=c({scope:ut});this.add(Nt),this.stack.push(Nt)}closeNode(){if(this.stack.length>1)return this.stack.pop()}closeAllNodes(){for(;this.closeNode(););}toJSON(){return JSON.stringify(this.rootNode,null,4)}walk(ut){return this.constructor._walk(ut,this.rootNode)}static _walk(ut,Nt){return typeof Nt=="string"?ut.addText(Nt):Nt.children&&(ut.openNode(Nt),Nt.children.forEach(xr=>this._walk(ut,xr)),ut.closeNode(Nt)),ut}static _collapse(ut){typeof ut!="string"&&ut.children&&(ut.children.every(Nt=>typeof Nt=="string")?ut.children=[ut.children.join("")]:ut.children.forEach(Nt=>{d._collapse(Nt)}))}}class p extends d{constructor(ut){super(),this.options=ut}addText(ut){ut!==""&&this.add(ut)}startScope(ut){this.openNode(ut)}endScope(){this.closeNode()}__addSublanguage(ut,Nt){const xr=ut.root;Nt&&(xr.scope=`language:${Nt}`),this.add(xr)}toHTML(){return new l(this,this.options).value()}finalize(){return this.closeAllNodes(),!0}}function g(Se){return Se?typeof Se=="string"?Se:Se.source:null}function m(Se){return w("(?=",Se,")")}function y(Se){return w("(?:",Se,")*")}function x(Se){return w("(?:",Se,")?")}function w(...Se){return Se.map(Nt=>g(Nt)).join("")}function T(Se){const ut=Se[Se.length-1];return typeof ut=="object"&&ut.constructor===Object?(Se.splice(Se.length-1,1),ut):{}}function k(...Se){return"("+(T(Se).capture?"":"?:")+Se.map(xr=>g(xr)).join("|")+")"}function _(Se){return new RegExp(Se.toString()+"|").exec("").length-1}function P(Se,ut){const Nt=Se&&Se.exec(ut);return Nt&&Nt.index===0}const F=/\[(?:[^\\\]]|\\.)*\]|\(\??|\\([1-9][0-9]*)|\\./;function D(Se,{joinWith:ut}){let Nt=0;return Se.map(xr=>{Nt+=1;const Kr=Nt;let Xr=g(xr),tr="";for(;Xr.length>0;){const Vt=F.exec(Xr);if(!Vt){tr+=Xr;break}tr+=Xr.substring(0,Vt.index),Xr=Xr.substring(Vt.index+Vt[0].length),Vt[0][0]==="\\"&&Vt[1]?tr+="\\"+String(Number(Vt[1])+Kr):(tr+=Vt[0],Vt[0]==="("&&Nt++)}return tr}).map(xr=>`(${xr})`).join(ut)}const B=/\b\B/,M="[a-zA-Z]\\w*",$="[a-zA-Z_]\\w*",Z="\\b\\d+(\\.\\d+)?",z="(-?)(\\b0[xX][a-fA-F0-9]+|(\\b\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)",ee="\\b(0b[01]+)",te="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|-|-=|/=|/|:|;|<<|<<=|<=|<|===|==|=|>>>=|>>=|>=|>>>|>>|>|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~",X=(Se={})=>{const ut=/^#![ ]*\//;return Se.binary&&(Se.begin=w(ut,/.*\b/,Se.binary,/\b.*/)),n({scope:"meta",begin:ut,end:/$/,relevance:0,"on:begin":(Nt,xr)=>{Nt.index!==0&&xr.ignoreMatch()}},Se)},Q={begin:"\\\\[\\s\\S]",relevance:0},W={scope:"string",begin:"'",end:"'",illegal:"\\n",contains:[Q]},H={scope:"string",begin:'"',end:'"',illegal:"\\n",contains:[Q]},re={begin:/\b(a|an|the|are|I'm|isn't|don't|doesn't|won't|but|just|should|pretty|simply|enough|gonna|going|wtf|so|such|will|you|your|they|like|more)\b/},ne=function(Se,ut,Nt={}){const xr=n({scope:"comment",begin:Se,end:ut,contains:[]},Nt);xr.contains.push({scope:"doctag",begin:"[ ]*(?=(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):)",end:/(TODO|FIXME|NOTE|BUG|OPTIMIZE|HACK|XXX):/,excludeBegin:!0,relevance:0});const Kr=k("I","a","is","so","us","to","at","if","in","it","on",/[A-Za-z]+['](d|ve|re|ll|t|s|n)/,/[A-Za-z]+[-][a-z]+/,/[A-Za-z][a-z]{2,}/);return xr.contains.push({begin:w(/[ ]+/,"(",Kr,/[.]?[:]?([.][ ]|[ ])/,"){3}")}),xr},ve=ne("//","$"),O=ne("/\\*","\\*/"),I=ne("#","$"),K={scope:"number",begin:Z,relevance:0},U={scope:"number",begin:z,relevance:0},ce={scope:"number",begin:ee,relevance:0},ye={scope:"regexp",begin:/\/(?=[^/\n]*\/)/,end:/\/[gimuy]*/,contains:[Q,{begin:/\[/,end:/\]/,relevance:0,contains:[Q]}]},Ae={scope:"title",begin:M,relevance:0},fe={scope:"title",begin:$,relevance:0},Ne={begin:"\\.\\s*"+$,relevance:0};var se=Object.freeze({__proto__:null,APOS_STRING_MODE:W,BACKSLASH_ESCAPE:Q,BINARY_NUMBER_MODE:ce,BINARY_NUMBER_RE:ee,COMMENT:ne,C_BLOCK_COMMENT_MODE:O,C_LINE_COMMENT_MODE:ve,C_NUMBER_MODE:U,C_NUMBER_RE:z,END_SAME_AS_BEGIN:function(Se){return Object.assign(Se,{"on:begin":(ut,Nt)=>{Nt.data._beginMatch=ut[1]},"on:end":(ut,Nt)=>{Nt.data._beginMatch!==ut[1]&&Nt.ignoreMatch()}})},HASH_COMMENT_MODE:I,IDENT_RE:M,MATCH_NOTHING_RE:B,METHOD_GUARD:Ne,NUMBER_MODE:K,NUMBER_RE:Z,PHRASAL_WORDS_MODE:re,QUOTE_STRING_MODE:H,REGEXP_MODE:ye,RE_STARTERS_RE:te,SHEBANG:X,TITLE_MODE:Ae,UNDERSCORE_IDENT_RE:$,UNDERSCORE_TITLE_MODE:fe});function be(Se,ut){Se.input[Se.index-1]==="."&&ut.ignoreMatch()}function xe(Se,ut){Se.className!==void 0&&(Se.scope=Se.className,delete Se.className)}function me(Se,ut){ut&&Se.beginKeywords&&(Se.begin="\\b("+Se.beginKeywords.split(" ").join("|")+")(?!\\.)(?=\\b|\\s)",Se.__beforeBegin=be,Se.keywords=Se.keywords||Se.beginKeywords,delete Se.beginKeywords,Se.relevance===void 0&&(Se.relevance=0))}function de(Se,ut){Array.isArray(Se.illegal)&&(Se.illegal=k(...Se.illegal))}function he(Se,ut){if(Se.match){if(Se.begin||Se.end)throw new Error("begin & end are not supported with match");Se.begin=Se.match,delete Se.match}}function Ie(Se,ut){Se.relevance===void 0&&(Se.relevance=1)}const ze=(Se,ut)=>{if(!Se.beforeMatch)return;if(Se.starts)throw new Error("beforeMatch cannot be used with starts");const Nt=Object.assign({},Se);Object.keys(Se).forEach(xr=>{delete Se[xr]}),Se.keywords=Nt.keywords,Se.begin=w(Nt.beforeMatch,m(Nt.begin)),Se.starts={relevance:0,contains:[Object.assign(Nt,{endsParent:!0})]},Se.relevance=0,delete Nt.beforeMatch},nt=["of","and","for","in","not","or","if","then","parent","list","value"],mt="keyword";function ht(Se,ut,Nt=mt){const xr=Object.create(null);return typeof Se=="string"?Kr(Nt,Se.split(" ")):Array.isArray(Se)?Kr(Nt,Se):Object.keys(Se).forEach(function(Xr){Object.assign(xr,ht(Se[Xr],ut,Xr))}),xr;function Kr(Xr,tr){ut&&(tr=tr.map(Vt=>Vt.toLowerCase())),tr.forEach(function(Vt){const Qt=Vt.split("|");xr[Qt[0]]=[Xr,er(Qt[0],Qt[1])]})}}function er(Se,ut){return ut?Number(ut):ct(Se)?0:1}function ct(Se){return nt.includes(Se.toLowerCase())}const Dt={},kt=Se=>{console.error(Se)},fr=(Se,...ut)=>{console.log(`WARN: ${Se}`,...ut)},qe=(Se,ut)=>{Dt[`${Se}/${ut}`]||(console.log(`Deprecated as of ${Se}. ${ut}`),Dt[`${Se}/${ut}`]=!0)},st=new Error;function Gt(Se,ut,{key:Nt}){let xr=0;const Kr=Se[Nt],Xr={},tr={};for(let Vt=1;Vt<=ut.length;Vt++)tr[Vt+xr]=Kr[Vt],Xr[Vt+xr]=!0,xr+=_(ut[Vt-1]);Se[Nt]=tr,Se[Nt]._emit=Xr,Se[Nt]._multi=!0}function Kt(Se){if(Array.isArray(Se.begin)){if(Se.skip||Se.excludeBegin||Se.returnBegin)throw kt("skip, excludeBegin, returnBegin not compatible with beginScope: {}"),st;if(typeof Se.beginScope!="object"||Se.beginScope===null)throw kt("beginScope must be object"),st;Gt(Se,Se.begin,{key:"beginScope"}),Se.begin=D(Se.begin,{joinWith:""})}}function lr(Se){if(Array.isArray(Se.end)){if(Se.skip||Se.excludeEnd||Se.returnEnd)throw kt("skip, excludeEnd, returnEnd not compatible with endScope: {}"),st;if(typeof Se.endScope!="object"||Se.endScope===null)throw kt("endScope must be object"),st;Gt(Se,Se.end,{key:"endScope"}),Se.end=D(Se.end,{joinWith:""})}}function Qe(Se){Se.scope&&typeof Se.scope=="object"&&Se.scope!==null&&(Se.beginScope=Se.scope,delete Se.scope)}function Yt(Se){Qe(Se),typeof Se.beginScope=="string"&&(Se.beginScope={_wrap:Se.beginScope}),typeof Se.endScope=="string"&&(Se.endScope={_wrap:Se.endScope}),Kt(Se),lr(Se)}function ur(Se){function ut(tr,Vt){return new RegExp(g(tr),"m"+(Se.case_insensitive?"i":"")+(Se.unicodeRegex?"u":"")+(Vt?"g":""))}class Nt{constructor(){this.matchIndexes={},this.regexes=[],this.matchAt=1,this.position=0}addRule(Vt,Qt){Qt.position=this.position++,this.matchIndexes[this.matchAt]=Qt,this.regexes.push([Qt,Vt]),this.matchAt+=_(Vt)+1}compile(){this.regexes.length===0&&(this.exec=()=>null);const Vt=this.regexes.map(Qt=>Qt[1]);this.matcherRe=ut(D(Vt,{joinWith:"|"}),!0),this.lastIndex=0}exec(Vt){this.matcherRe.lastIndex=this.lastIndex;const Qt=this.matcherRe.exec(Vt);if(!Qt)return null;const Or=Qt.findIndex((Dn,Ba)=>Ba>0&&Dn!==void 0),Hr=this.matchIndexes[Or];return Qt.splice(0,Or),Object.assign(Qt,Hr)}}class xr{constructor(){this.rules=[],this.multiRegexes=[],this.count=0,this.lastIndex=0,this.regexIndex=0}getMatcher(Vt){if(this.multiRegexes[Vt])return this.multiRegexes[Vt];const Qt=new Nt;return this.rules.slice(Vt).forEach(([Or,Hr])=>Qt.addRule(Or,Hr)),Qt.compile(),this.multiRegexes[Vt]=Qt,Qt}resumingScanAtSamePosition(){return this.regexIndex!==0}considerAll(){this.regexIndex=0}addRule(Vt,Qt){this.rules.push([Vt,Qt]),Qt.type==="begin"&&this.count++}exec(Vt){const Qt=this.getMatcher(this.regexIndex);Qt.lastIndex=this.lastIndex;let Or=Qt.exec(Vt);if(this.resumingScanAtSamePosition()&&!(Or&&Or.index===this.lastIndex)){const Hr=this.getMatcher(0);Hr.lastIndex=this.lastIndex+1,Or=Hr.exec(Vt)}return Or&&(this.regexIndex+=Or.position+1,this.regexIndex===this.count&&this.considerAll()),Or}}function Kr(tr){const Vt=new xr;return tr.contains.forEach(Qt=>Vt.addRule(Qt.begin,{rule:Qt,type:"begin"})),tr.terminatorEnd&&Vt.addRule(tr.terminatorEnd,{type:"end"}),tr.illegal&&Vt.addRule(tr.illegal,{type:"illegal"}),Vt}function Xr(tr,Vt){const Qt=tr;if(tr.isCompiled)return Qt;[xe,he,Yt,ze].forEach(Hr=>Hr(tr,Vt)),Se.compilerExtensions.forEach(Hr=>Hr(tr,Vt)),tr.__beforeBegin=null,[me,de,Ie].forEach(Hr=>Hr(tr,Vt)),tr.isCompiled=!0;let Or=null;return typeof tr.keywords=="object"&&tr.keywords.$pattern&&(tr.keywords=Object.assign({},tr.keywords),Or=tr.keywords.$pattern,delete tr.keywords.$pattern),Or=Or||/\w+/,tr.keywords&&(tr.keywords=ht(tr.keywords,Se.case_insensitive)),Qt.keywordPatternRe=ut(Or,!0),Vt&&(tr.begin||(tr.begin=/\B|\b/),Qt.beginRe=ut(Qt.begin),!tr.end&&!tr.endsWithParent&&(tr.end=/\B|\b/),tr.end&&(Qt.endRe=ut(Qt.end)),Qt.terminatorEnd=g(Qt.end)||"",tr.endsWithParent&&Vt.terminatorEnd&&(Qt.terminatorEnd+=(tr.end?"|":"")+Vt.terminatorEnd)),tr.illegal&&(Qt.illegalRe=ut(tr.illegal)),tr.contains||(tr.contains=[]),tr.contains=[].concat(...tr.contains.map(function(Hr){return sr(Hr==="self"?tr:Hr)})),tr.contains.forEach(function(Hr){Xr(Hr,Qt)}),tr.starts&&Xr(tr.starts,Vt),Qt.matcher=Kr(Qt),Qt}if(Se.compilerExtensions||(Se.compilerExtensions=[]),Se.contains&&Se.contains.includes("self"))throw new Error("ERR: contains `self` is not supported at the top-level of a language.  See documentation.");return Se.classNameAliases=n(Se.classNameAliases||{}),Xr(Se)}function _t(Se){return Se?Se.endsWithParent||_t(Se.starts):!1}function sr(Se){return Se.variants&&!Se.cachedVariants&&(Se.cachedVariants=Se.variants.map(function(ut){return n(Se,{variants:null},ut)})),Se.cachedVariants?Se.cachedVariants:_t(Se)?n(Se,{starts:Se.starts?n(Se.starts):null}):Object.isFrozen(Se)?n(Se):Se}var vt="11.11.1";class pn extends Error{constructor(ut,Nt){super(ut),this.name="HTMLInjectionError",this.html=Nt}}const Ar=r,Ja=n,zt=Symbol("nomatch"),Ca=7,Bs=function(Se){const ut=Object.create(null),Nt=Object.create(null),xr=[];let Kr=!0;const Xr="Could not find the language '{}', did you forget to load/include a language module?",tr={disableAutodetect:!0,name:"Plain text",contains:[]};let Vt={ignoreUnescapedHTML:!1,throwUnescapedHTML:!1,noHighlightRe:/^(no-?highlight)$/i,languageDetectRe:/\blang(?:uage)?-([\w-]+)\b/i,classPrefix:"hljs-",cssSelector:"pre code",languages:null,__emitter:p};function Qt(Tt){return Vt.noHighlightRe.test(Tt)}function Or(Tt){let qt=Tt.className+" ";qt+=Tt.parentNode?Tt.parentNode.className:"";const Lr=Vt.languageDetectRe.exec(qt);if(Lr){const Gr=bt(Lr[1]);return Gr||(fr(Xr.replace("{}",Lr[1])),fr("Falling back to no-highlight mode for this block.",Tt)),Gr?Lr[1]:"no-highlight"}return qt.split(/\s+/).find(Gr=>Qt(Gr)||bt(Gr))}function Hr(Tt,qt,Lr){let Gr="",Gn="";typeof qt=="object"?(Gr=Tt,Lr=qt.ignoreIllegals,Gn=qt.language):(qe("10.7.0","highlight(lang, code, ...args) has been deprecated."),qe("10.7.0",`Please use highlight(code, options) instead.
https://github.com/highlightjs/highlight.js/issues/2277`),Gn=Tt,Gr=qt),Lr===void 0&&(Lr=!0);const vr={code:Gr,language:Gn};Kn("before:highlight",vr);const Fa=vr.result?vr.result:Dn(vr.language,vr.code,Lr);return Fa.code=vr.code,Kn("after:highlight",Fa),Fa}function Dn(Tt,qt,Lr,Gr){const Gn=Object.create(null);function vr(Bt,ar){return Bt.keywords[ar]}function Fa(){if(!kr.keywords){wr.addText(xn);return}let Bt=0;kr.keywordPatternRe.lastIndex=0;let ar=kr.keywordPatternRe.exec(xn),Pr="";for(;ar;){Pr+=xn.substring(Bt,ar.index);const Vr=An.case_insensitive?ar[0].toLowerCase():ar[0],$r=vr(kr,Vr);if($r){const[jn,hi]=$r;if(wr.addText(Pr),Pr="",Gn[Vr]=(Gn[Vr]||0)+1,Gn[Vr]<=Ca&&($s+=hi),jn.startsWith("_"))Pr+=ar[0];else{const Es=An.classNameAliases[jn]||jn;xa(ar[0],Es)}}else Pr+=ar[0];Bt=kr.keywordPatternRe.lastIndex,ar=kr.keywordPatternRe.exec(xn)}Pr+=xn.substring(Bt),wr.addText(Pr)}function ua(){if(xn==="")return;let Bt=null;if(typeof kr.subLanguage=="string"){if(!ut[kr.subLanguage]){wr.addText(xn);return}Bt=Dn(kr.subLanguage,xn,!0,di[kr.subLanguage]),di[kr.subLanguage]=Bt._top}else Bt=Za(xn,kr.subLanguage.length?kr.subLanguage:null);kr.relevance>0&&($s+=Bt.relevance),wr.__addSublanguage(Bt._emitter,Bt.language)}function yn(){kr.subLanguage!=null?ua():Fa(),xn=""}function xa(Bt,ar){Bt!==""&&(wr.startScope(ar),wr.addText(Bt),wr.endScope())}function ko(Bt,ar){let Pr=1;const Vr=ar.length-1;for(;Pr<=Vr;){if(!Bt._emit[Pr]){Pr++;continue}const $r=An.classNameAliases[Bt[Pr]]||Bt[Pr],jn=ar[Pr];$r?xa(jn,$r):(xn=jn,Fa(),xn=""),Pr++}}function ci(Bt,ar){return Bt.scope&&typeof Bt.scope=="string"&&wr.openNode(An.classNameAliases[Bt.scope]||Bt.scope),Bt.beginScope&&(Bt.beginScope._wrap?(xa(xn,An.classNameAliases[Bt.beginScope._wrap]||Bt.beginScope._wrap),xn=""):Bt.beginScope._multi&&(ko(Bt.beginScope,ar),xn="")),kr=Object.create(Bt,{parent:{value:kr}}),kr}function Ii(Bt,ar,Pr){let Vr=P(Bt.endRe,Pr);if(Vr){if(Bt["on:end"]){const $r=new e(Bt);Bt["on:end"](ar,$r),$r.isMatchIgnored&&(Vr=!1)}if(Vr){for(;Bt.endsParent&&Bt.parent;)Bt=Bt.parent;return Bt}}if(Bt.endsWithParent)return Ii(Bt.parent,ar,Pr)}function _r(Bt){return kr.matcher.regexIndex===0?(xn+=Bt[0],1):(Nn=!0,0)}function Cs(Bt){const ar=Bt[0],Pr=Bt.rule,Vr=new e(Pr),$r=[Pr.__beforeBegin,Pr["on:begin"]];for(const jn of $r)if(jn&&(jn(Bt,Vr),Vr.isMatchIgnored))return _r(ar);return Pr.skip?xn+=ar:(Pr.excludeBegin&&(xn+=ar),yn(),!Pr.returnBegin&&!Pr.excludeBegin&&(xn=ar)),ci(Pr,Bt),Pr.returnBegin?0:ar.length}function da(Bt){const ar=Bt[0],Pr=qt.substring(Bt.index),Vr=Ii(kr,Bt,Pr);if(!Vr)return zt;const $r=kr;kr.endScope&&kr.endScope._wrap?(yn(),xa(ar,kr.endScope._wrap)):kr.endScope&&kr.endScope._multi?(yn(),ko(kr.endScope,Bt)):$r.skip?xn+=ar:($r.returnEnd||$r.excludeEnd||(xn+=ar),yn(),$r.excludeEnd&&(xn=ar));do kr.scope&&wr.closeNode(),!kr.skip&&!kr.subLanguage&&($s+=kr.relevance),kr=kr.parent;while(kr!==Vr.parent);return Vr.starts&&ci(Vr.starts,Bt),$r.returnEnd?0:ar.length}function Fs(){const Bt=[];for(let ar=kr;ar!==An;ar=ar.parent)ar.scope&&Bt.unshift(ar.scope);Bt.forEach(ar=>wr.openNode(ar))}let ui={};function cs(Bt,ar){const Pr=ar&&ar[0];if(xn+=Bt,Pr==null)return yn(),0;if(ui.type==="begin"&&ar.type==="end"&&ui.index===ar.index&&Pr===""){if(xn+=qt.slice(ar.index,ar.index+1),!Kr){const Vr=new Error(`0 width match regex (${Tt})`);throw Vr.languageName=Tt,Vr.badRule=ui.rule,Vr}return 1}if(ui=ar,ar.type==="begin")return Cs(ar);if(ar.type==="illegal"&&!Lr){const Vr=new Error('Illegal lexeme "'+Pr+'" for mode "'+(kr.scope||"<unnamed>")+'"');throw Vr.mode=kr,Vr}else if(ar.type==="end"){const Vr=da(ar);if(Vr!==zt)return Vr}if(ar.type==="illegal"&&Pr==="")return xn+=`
`,1;if(ha>1e5&&ha>ar.index*3)throw new Error("potential infinite loop, way more iterations than matches");return xn+=Pr,Pr.length}const An=bt(Tt);if(!An)throw kt(Xr.replace("{}",Tt)),new Error('Unknown language: "'+Tt+'"');const To=ur(An);let zs="",kr=Gr||To;const di={},wr=new Vt.__emitter(Vt);Fs();let xn="",$s=0,Us=0,ha=0,Nn=!1;try{if(An.__emitTokens)An.__emitTokens(qt,wr);else{for(kr.matcher.considerAll();;){ha++,Nn?Nn=!1:kr.matcher.considerAll(),kr.matcher.lastIndex=Us;const Bt=kr.matcher.exec(qt);if(!Bt)break;const ar=qt.substring(Us,Bt.index),Pr=cs(ar,Bt);Us=Bt.index+Pr}cs(qt.substring(Us))}return wr.finalize(),zs=wr.toHTML(),{language:Tt,value:zs,relevance:$s,illegal:!1,_emitter:wr,_top:kr}}catch(Bt){if(Bt.message&&Bt.message.includes("Illegal"))return{language:Tt,value:Ar(qt),illegal:!0,relevance:0,_illegalBy:{message:Bt.message,index:Us,context:qt.slice(Us-100,Us+100),mode:Bt.mode,resultSoFar:zs},_emitter:wr};if(Kr)return{language:Tt,value:Ar(qt),illegal:!1,relevance:0,errorRaised:Bt,_emitter:wr,_top:kr};throw Bt}}function Ba(Tt){const qt={value:Ar(Tt),illegal:!1,relevance:0,_top:tr,_emitter:new Vt.__emitter(Vt)};return qt._emitter.addText(Tt),qt}function Za(Tt,qt){qt=qt||Vt.languages||Object.keys(ut);const Lr=Ba(Tt),Gr=qt.filter(bt).filter(zr).map(yn=>Dn(yn,Tt,!1));Gr.unshift(Lr);const Gn=Gr.sort((yn,xa)=>{if(yn.relevance!==xa.relevance)return xa.relevance-yn.relevance;if(yn.language&&xa.language){if(bt(yn.language).supersetOf===xa.language)return 1;if(bt(xa.language).supersetOf===yn.language)return-1}return 0}),[vr,Fa]=Gn,ua=vr;return ua.secondBest=Fa,ua}function Ea(Tt,qt,Lr){const Gr=qt&&Nt[qt]||Lr;Tt.classList.add("hljs"),Tt.classList.add(`language-${Gr}`)}function an(Tt){let qt=null;const Lr=Or(Tt);if(Qt(Lr))return;if(Kn("before:highlightElement",{el:Tt,language:Lr}),Tt.dataset.highlighted){console.log("Element previously highlighted. To highlight again, first unset `dataset.highlighted`.",Tt);return}if(Tt.children.length>0&&(Vt.ignoreUnescapedHTML||(console.warn("One of your code blocks includes unescaped HTML. This is a potentially serious security risk."),console.warn("https://github.com/highlightjs/highlight.js/wiki/security"),console.warn("The element with unescaped HTML:"),console.warn(Tt)),Vt.throwUnescapedHTML))throw new pn("One of your code blocks includes unescaped HTML.",Tt.innerHTML);qt=Tt;const Gr=qt.textContent,Gn=Lr?Hr(Gr,{language:Lr,ignoreIllegals:!0}):Za(Gr);Tt.innerHTML=Gn.value,Tt.dataset.highlighted="yes",Ea(Tt,Lr,Gn.language),Tt.result={language:Gn.language,re:Gn.relevance,relevance:Gn.relevance},Gn.secondBest&&(Tt.secondBest={language:Gn.secondBest.language,relevance:Gn.secondBest.relevance}),Kn("after:highlightElement",{el:Tt,result:Gn,text:Gr})}function tn(Tt){Vt=Ja(Vt,Tt)}const ca=()=>{Zn(),qe("10.6.0","initHighlighting() deprecated.  Use highlightAll() now.")};function _a(){Zn(),qe("10.6.0","initHighlightingOnLoad() deprecated.  Use highlightAll() now.")}let Zi=!1;function Zn(){function Tt(){Zn()}if(document.readyState==="loading"){Zi||window.addEventListener("DOMContentLoaded",Tt,!1),Zi=!0;return}document.querySelectorAll(Vt.cssSelector).forEach(an)}function Pi(Tt,qt){let Lr=null;try{Lr=qt(Se)}catch(Gr){if(kt("Language definition for '{}' could not be registered.".replace("{}",Tt)),Kr)kt(Gr);else throw Gr;Lr=tr}Lr.name||(Lr.name=Tt),ut[Tt]=Lr,Lr.rawDefinition=qt.bind(null,Se),Lr.aliases&&Mt(Lr.aliases,{languageName:Tt})}function rr(Tt){delete ut[Tt];for(const qt of Object.keys(Nt))Nt[qt]===Tt&&delete Nt[qt]}function De(){return Object.keys(ut)}function bt(Tt){return Tt=(Tt||"").toLowerCase(),ut[Tt]||ut[Nt[Tt]]}function Mt(Tt,{languageName:qt}){typeof Tt=="string"&&(Tt=[Tt]),Tt.forEach(Lr=>{Nt[Lr.toLowerCase()]=qt})}function zr(Tt){const qt=bt(Tt);return qt&&!qt.disableAutodetect}function rn(Tt){Tt["before:highlightBlock"]&&!Tt["before:highlightElement"]&&(Tt["before:highlightElement"]=qt=>{Tt["before:highlightBlock"](Object.assign({block:qt.el},qt))}),Tt["after:highlightBlock"]&&!Tt["after:highlightElement"]&&(Tt["after:highlightElement"]=qt=>{Tt["after:highlightBlock"](Object.assign({block:qt.el},qt))})}function jr(Tt){rn(Tt),xr.push(Tt)}function ir(Tt){const qt=xr.indexOf(Tt);qt!==-1&&xr.splice(qt,1)}function Kn(Tt,qt){const Lr=Tt;xr.forEach(function(Gr){Gr[Lr]&&Gr[Lr](qt)})}function Hn(Tt){return qe("10.7.0","highlightBlock will be removed entirely in v12.0"),qe("10.7.0","Please use highlightElement now."),an(Tt)}Object.assign(Se,{highlight:Hr,highlightAuto:Za,highlightAll:Zn,highlightElement:an,highlightBlock:Hn,configure:tn,initHighlighting:ca,initHighlightingOnLoad:_a,registerLanguage:Pi,unregisterLanguage:rr,listLanguages:De,getLanguage:bt,registerAliases:Mt,autoDetection:zr,inherit:Ja,addPlugin:jr,removePlugin:ir}),Se.debugMode=function(){Kr=!1},Se.safeMode=function(){Kr=!0},Se.versionString=vt,Se.regex={concat:w,lookahead:m,either:k,optional:x,anyNumberOfTimes:y};for(const Tt in se)typeof se[Tt]=="object"&&t(se[Tt]);return Object.assign(Se,se),Se},qn=Bs({});return qn.newInstance=()=>Bs({}),Kv=qn,qn.HighlightJS=qn,qn.default=qn,Kv}var rne=tne();const nne=Dc(rne),QA={},ane="hljs-";function sne(t){const e=nne.newInstance();return t&&s(t),{highlight:r,highlightAuto:n,listLanguages:a,register:s,registerAlias:i,registered:l};function r(c,d,p){const g=p||QA,m=typeof g.prefix=="string"?g.prefix:ane;if(!e.getLanguage(c))throw new Error("Unknown language: `"+c+"` is not registered");e.configure({__emitter:ine,classPrefix:m});const y=e.highlight(d,{ignoreIllegals:!0,language:c});if(y.errorRaised)throw new Error("Could not highlight with `Highlight.js`",{cause:y.errorRaised});const x=y._emitter.root,w=x.data;return w.language=y.language,w.relevance=y.relevance,x}function n(c,d){const g=(d||QA).subset||a();let m=-1,y=0,x;for(;++m<g.length;){const w=g[m];if(!e.getLanguage(w))continue;const T=r(w,c,d);T.data&&T.data.relevance!==void 0&&T.data.relevance>y&&(y=T.data.relevance,x=T)}return x||{type:"root",children:[],data:{language:void 0,relevance:y}}}function a(){return e.listLanguages()}function s(c,d){if(typeof c=="string")e.registerLanguage(c,d);else{let p;for(p in c)Object.hasOwn(c,p)&&e.registerLanguage(p,c[p])}}function i(c,d){if(typeof c=="string")e.registerAliases(typeof d=="string"?d:[...d],{languageName:c});else{let p;for(p in c)if(Object.hasOwn(c,p)){const g=c[p];e.registerAliases(typeof g=="string"?g:[...g],{languageName:p})}}}function l(c){return!!e.getLanguage(c)}}class ine{constructor(e){this.options=e,this.root={type:"root",children:[],data:{language:void 0,relevance:0}},this.stack=[this.root]}addText(e){if(e==="")return;const r=this.stack[this.stack.length-1],n=r.children[r.children.length-1];n&&n.type==="text"?n.value+=e:r.children.push({type:"text",value:e})}startScope(e){this.openNode(String(e))}endScope(){this.closeNode()}__addSublanguage(e,r){const n=this.stack[this.stack.length-1],a=e.root.children;r?n.children.push({type:"element",tagName:"span",properties:{className:[r]},children:a}):n.children.push(...a)}openNode(e){const r=this,n=e.split(".").map(function(i,l){return l?i+"_".repeat(l):r.options.classPrefix+i}),a=this.stack[this.stack.length-1],s={type:"element",tagName:"span",properties:{className:n},children:[]};a.children.push(s),this.stack.push(s)}closeNode(){this.stack.pop()}finalize(){}toHTML(){return""}}const one={};function lne(t){const e=t||one,r=e.aliases,n=e.detect||!1,a=e.languages||ene,s=e.plainText,i=e.prefix,l=e.subset;let c="hljs";const d=sne(a);if(r&&d.registerAlias(r),i){const p=i.indexOf("-");c=p===-1?i:i.slice(0,p)}return function(p,g){lf(p,"element",function(m,y,x){if(m.tagName!=="code"||!x||x.type!=="element"||x.tagName!=="pre")return;const w=cne(m);if(w===!1||!w&&!n||w&&s&&s.includes(w))return;Array.isArray(m.properties.className)||(m.properties.className=[]),m.properties.className.includes(c)||m.properties.className.unshift(c);const T=_te(m,{whitespace:"pre"});let k;try{k=w?d.highlight(w,T,{prefix:i}):d.highlightAuto(T,{prefix:i,subset:l})}catch(_){const P=_;if(w&&/Unknown language/.test(P.message)){g.message("Cannot highlight as `"+w+"`, its not registered",{ancestors:[x,m],cause:P,place:m.position,ruleId:"missing-language",source:"rehype-highlight"});return}throw P}!w&&k.data&&k.data.language&&m.properties.className.push("language-"+k.data.language),k.children.length>0&&(m.children=k.children)})}}function cne(t){const e=t.properties.className;let r=-1;if(!Array.isArray(e))return;let n;for(;++r<e.length;){const a=String(e[r]);if(a==="no-highlight"||a==="nohighlight")return!1;!n&&a.slice(0,5)==="lang-"&&(n=a.slice(5)),!n&&a.slice(0,9)==="language-"&&(n=a.slice(9))}return n}var KA={name:"mermaid",version:"11.12.1",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.1.1","@iconify/utils":"^3.0.1","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.13",dayjs:"^1.11.18",dompurify:"^3.2.5",katex:"^0.16.22",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^16.2.1",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.5","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",canvas:"^3.1.2",chokidar:"3.6.0",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.1.0",jison:"^0.4.18","js-base64":"^3.7.8",jsdom:"^26.1.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.3",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.13","type-fest":"^4.35.0",typedoc:"^0.28.12","typedoc-plugin-markdown":"^4.8.1",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.6.4","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},l0={exports:{}},une=l0.exports,XA;function dne(){return XA||(XA=1,(function(t,e){(function(r,n){t.exports=n()})(une,(function(){var r=1e3,n=6e4,a=36e5,s="millisecond",i="second",l="minute",c="hour",d="day",p="week",g="month",m="quarter",y="year",x="date",w="Invalid Date",T=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,k=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(Q){var W=["th","st","nd","rd"],H=Q%100;return"["+Q+(W[(H-20)%10]||W[H]||W[0])+"]"}},P=function(Q,W,H){var re=String(Q);return!re||re.length>=W?Q:""+Array(W+1-re.length).join(H)+Q},F={s:P,z:function(Q){var W=-Q.utcOffset(),H=Math.abs(W),re=Math.floor(H/60),ne=H%60;return(W<=0?"+":"-")+P(re,2,"0")+":"+P(ne,2,"0")},m:function Q(W,H){if(W.date()<H.date())return-Q(H,W);var re=12*(H.year()-W.year())+(H.month()-W.month()),ne=W.clone().add(re,g),ve=H-ne<0,O=W.clone().add(re+(ve?-1:1),g);return+(-(re+(H-ne)/(ve?ne-O:O-ne))||0)},a:function(Q){return Q<0?Math.ceil(Q)||0:Math.floor(Q)},p:function(Q){return{M:g,y,w:p,d,D:x,h:c,m:l,s:i,ms:s,Q:m}[Q]||String(Q||"").toLowerCase().replace(/s$/,"")},u:function(Q){return Q===void 0}},D="en",B={};B[D]=_;var M="$isDayjsObject",$=function(Q){return Q instanceof te||!(!Q||!Q[M])},Z=function Q(W,H,re){var ne;if(!W)return D;if(typeof W=="string"){var ve=W.toLowerCase();B[ve]&&(ne=ve),H&&(B[ve]=H,ne=ve);var O=W.split("-");if(!ne&&O.length>1)return Q(O[0])}else{var I=W.name;B[I]=W,ne=I}return!re&&ne&&(D=ne),ne||!re&&D},z=function(Q,W){if($(Q))return Q.clone();var H=typeof W=="object"?W:{};return H.date=Q,H.args=arguments,new te(H)},ee=F;ee.l=Z,ee.i=$,ee.w=function(Q,W){return z(Q,{locale:W.$L,utc:W.$u,x:W.$x,$offset:W.$offset})};var te=(function(){function Q(H){this.$L=Z(H.locale,null,!0),this.parse(H),this.$x=this.$x||H.x||{},this[M]=!0}var W=Q.prototype;return W.parse=function(H){this.$d=(function(re){var ne=re.date,ve=re.utc;if(ne===null)return new Date(NaN);if(ee.u(ne))return new Date;if(ne instanceof Date)return new Date(ne);if(typeof ne=="string"&&!/Z$/i.test(ne)){var O=ne.match(T);if(O){var I=O[2]-1||0,K=(O[7]||"0").substring(0,3);return ve?new Date(Date.UTC(O[1],I,O[3]||1,O[4]||0,O[5]||0,O[6]||0,K)):new Date(O[1],I,O[3]||1,O[4]||0,O[5]||0,O[6]||0,K)}}return new Date(ne)})(H),this.init()},W.init=function(){var H=this.$d;this.$y=H.getFullYear(),this.$M=H.getMonth(),this.$D=H.getDate(),this.$W=H.getDay(),this.$H=H.getHours(),this.$m=H.getMinutes(),this.$s=H.getSeconds(),this.$ms=H.getMilliseconds()},W.$utils=function(){return ee},W.isValid=function(){return this.$d.toString()!==w},W.isSame=function(H,re){var ne=z(H);return this.startOf(re)<=ne&&ne<=this.endOf(re)},W.isAfter=function(H,re){return z(H)<this.startOf(re)},W.isBefore=function(H,re){return this.endOf(re)<z(H)},W.$g=function(H,re,ne){return ee.u(H)?this[re]:this.set(ne,H)},W.unix=function(){return Math.floor(this.valueOf()/1e3)},W.valueOf=function(){return this.$d.getTime()},W.startOf=function(H,re){var ne=this,ve=!!ee.u(re)||re,O=ee.p(H),I=function(Te,se){var be=ee.w(ne.$u?Date.UTC(ne.$y,se,Te):new Date(ne.$y,se,Te),ne);return ve?be:be.endOf(d)},K=function(Te,se){return ee.w(ne.toDate()[Te].apply(ne.toDate("s"),(ve?[0,0,0,0]:[23,59,59,999]).slice(se)),ne)},U=this.$W,ce=this.$M,ye=this.$D,Ae="set"+(this.$u?"UTC":"");switch(O){case y:return ve?I(1,0):I(31,11);case g:return ve?I(1,ce):I(0,ce+1);case p:var fe=this.$locale().weekStart||0,Ne=(U<fe?U+7:U)-fe;return I(ve?ye-Ne:ye+(6-Ne),ce);case d:case x:return K(Ae+"Hours",0);case c:return K(Ae+"Minutes",1);case l:return K(Ae+"Seconds",2);case i:return K(Ae+"Milliseconds",3);default:return this.clone()}},W.endOf=function(H){return this.startOf(H,!1)},W.$set=function(H,re){var ne,ve=ee.p(H),O="set"+(this.$u?"UTC":""),I=(ne={},ne[d]=O+"Date",ne[x]=O+"Date",ne[g]=O+"Month",ne[y]=O+"FullYear",ne[c]=O+"Hours",ne[l]=O+"Minutes",ne[i]=O+"Seconds",ne[s]=O+"Milliseconds",ne)[ve],K=ve===d?this.$D+(re-this.$W):re;if(ve===g||ve===y){var U=this.clone().set(x,1);U.$d[I](K),U.init(),this.$d=U.set(x,Math.min(this.$D,U.daysInMonth())).$d}else I&&this.$d[I](K);return this.init(),this},W.set=function(H,re){return this.clone().$set(H,re)},W.get=function(H){return this[ee.p(H)]()},W.add=function(H,re){var ne,ve=this;H=Number(H);var O=ee.p(re),I=function(ce){var ye=z(ve);return ee.w(ye.date(ye.date()+Math.round(ce*H)),ve)};if(O===g)return this.set(g,this.$M+H);if(O===y)return this.set(y,this.$y+H);if(O===d)return I(1);if(O===p)return I(7);var K=(ne={},ne[l]=n,ne[c]=a,ne[i]=r,ne)[O]||1,U=this.$d.getTime()+H*K;return ee.w(U,this)},W.subtract=function(H,re){return this.add(-1*H,re)},W.format=function(H){var re=this,ne=this.$locale();if(!this.isValid())return ne.invalidDate||w;var ve=H||"YYYY-MM-DDTHH:mm:ssZ",O=ee.z(this),I=this.$H,K=this.$m,U=this.$M,ce=ne.weekdays,ye=ne.months,Ae=ne.meridiem,fe=function(se,be,xe,me){return se&&(se[be]||se(re,ve))||xe[be].slice(0,me)},Ne=function(se){return ee.s(I%12||12,se,"0")},Te=Ae||function(se,be,xe){var me=se<12?"AM":"PM";return xe?me.toLowerCase():me};return ve.replace(k,(function(se,be){return be||(function(xe){switch(xe){case"YY":return String(re.$y).slice(-2);case"YYYY":return ee.s(re.$y,4,"0");case"M":return U+1;case"MM":return ee.s(U+1,2,"0");case"MMM":return fe(ne.monthsShort,U,ye,3);case"MMMM":return fe(ye,U);case"D":return re.$D;case"DD":return ee.s(re.$D,2,"0");case"d":return String(re.$W);case"dd":return fe(ne.weekdaysMin,re.$W,ce,2);case"ddd":return fe(ne.weekdaysShort,re.$W,ce,3);case"dddd":return ce[re.$W];case"H":return String(I);case"HH":return ee.s(I,2,"0");case"h":return Ne(1);case"hh":return Ne(2);case"a":return Te(I,K,!0);case"A":return Te(I,K,!1);case"m":return String(K);case"mm":return ee.s(K,2,"0");case"s":return String(re.$s);case"ss":return ee.s(re.$s,2,"0");case"SSS":return ee.s(re.$ms,3,"0");case"Z":return O}return null})(se)||O.replace(":","")}))},W.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},W.diff=function(H,re,ne){var ve,O=this,I=ee.p(re),K=z(H),U=(K.utcOffset()-this.utcOffset())*n,ce=this-K,ye=function(){return ee.m(O,K)};switch(I){case y:ve=ye()/12;break;case g:ve=ye();break;case m:ve=ye()/3;break;case p:ve=(ce-U)/6048e5;break;case d:ve=(ce-U)/864e5;break;case c:ve=ce/a;break;case l:ve=ce/n;break;case i:ve=ce/r;break;default:ve=ce}return ne?ve:ee.a(ve)},W.daysInMonth=function(){return this.endOf(g).$D},W.$locale=function(){return B[this.$L]},W.locale=function(H,re){if(!H)return this.$L;var ne=this.clone(),ve=Z(H,re,!0);return ve&&(ne.$L=ve),ne},W.clone=function(){return ee.w(this.$d,this)},W.toDate=function(){return new Date(this.valueOf())},W.toJSON=function(){return this.isValid()?this.toISOString():null},W.toISOString=function(){return this.$d.toISOString()},W.toString=function(){return this.$d.toUTCString()},Q})(),X=te.prototype;return z.prototype=X,[["$ms",s],["$s",i],["$m",l],["$H",c],["$W",d],["$M",g],["$y",y],["$D",x]].forEach((function(Q){X[Q[1]]=function(W){return this.$g(W,Q[0],Q[1])}})),z.extend=function(Q,W){return Q.$i||(Q(W,te,z),Q.$i=!0),z},z.locale=Z,z.isDayjs=$,z.unix=function(Q){return z(1e3*Q)},z.en=B[D],z.Ls=B,z.p={},z}))})(l0)),l0.exports}var hne=dne();const pne=Dc(hne);var YD=Object.defineProperty,L=(t,e)=>YD(t,"name",{value:e,configurable:!0}),gne=(t,e)=>{for(var r in e)YD(t,r,{get:e[r],enumerable:!0})},kl={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},wt={trace:L((...t)=>{},"trace"),debug:L((...t)=>{},"debug"),info:L((...t)=>{},"info"),warn:L((...t)=>{},"warn"),error:L((...t)=>{},"error"),fatal:L((...t)=>{},"fatal")},ek=L(function(t="fatal"){let e=kl.fatal;typeof t=="string"?t.toLowerCase()in kl&&(e=kl[t]):typeof t=="number"&&(e=t),wt.trace=()=>{},wt.debug=()=>{},wt.info=()=>{},wt.warn=()=>{},wt.error=()=>{},wt.fatal=()=>{},e<=kl.fatal&&(wt.fatal=console.error?console.error.bind(console,Hi("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Hi("FATAL"))),e<=kl.error&&(wt.error=console.error?console.error.bind(console,Hi("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Hi("ERROR"))),e<=kl.warn&&(wt.warn=console.warn?console.warn.bind(console,Hi("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Hi("WARN"))),e<=kl.info&&(wt.info=console.info?console.info.bind(console,Hi("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Hi("INFO"))),e<=kl.debug&&(wt.debug=console.debug?console.debug.bind(console,Hi("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Hi("DEBUG"))),e<=kl.trace&&(wt.trace=console.debug?console.debug.bind(console,Hi("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Hi("TRACE")))},"setLogLevel"),Hi=L(t=>`%c${pne().format("ss.SSS")} : ${t} : `,"format");const c0={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:t=>t>=255?255:t<0?0:t,g:t=>t>=255?255:t<0?0:t,b:t=>t>=255?255:t<0?0:t,h:t=>t%360,s:t=>t>=100?100:t<0?0:t,l:t=>t>=100?100:t<0?0:t,a:t=>t>=1?1:t<0?0:t},toLinear:t=>{const e=t/255;return t>.03928?Math.pow((e+.055)/1.055,2.4):e/12.92},hue2rgb:(t,e,r)=>(r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t),hsl2rgb:({h:t,s:e,l:r},n)=>{if(!e)return r*2.55;t/=360,e/=100,r/=100;const a=r<.5?r*(1+e):r+e-r*e,s=2*r-a;switch(n){case"r":return c0.hue2rgb(s,a,t+1/3)*255;case"g":return c0.hue2rgb(s,a,t)*255;case"b":return c0.hue2rgb(s,a,t-1/3)*255}},rgb2hsl:({r:t,g:e,b:r},n)=>{t/=255,e/=255,r/=255;const a=Math.max(t,e,r),s=Math.min(t,e,r),i=(a+s)/2;if(n==="l")return i*100;if(a===s)return 0;const l=a-s,c=i>.5?l/(2-a-s):l/(a+s);if(n==="s")return c*100;switch(a){case t:return((e-r)/l+(e<r?6:0))*60;case e:return((r-t)/l+2)*60;case r:return((t-e)/l+4)*60;default:return-1}}},fne={clamp:(t,e,r)=>e>r?Math.min(e,Math.max(r,t)):Math.min(r,Math.max(e,t)),round:t=>Math.round(t*1e10)/1e10},mne={dec2hex:t=>{const e=Math.round(t).toString(16);return e.length>1?e:`0${e}`}},Br={channel:c0,lang:fne,unit:mne},Sc={};for(let t=0;t<=255;t++)Sc[t]=Br.unit.dec2hex(t);const gs={ALL:0,RGB:1,HSL:2};class yne{constructor(){this.type=gs.ALL}get(){return this.type}set(e){if(this.type&&this.type!==e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=gs.ALL}is(e){return this.type===e}}class bne{constructor(e,r){this.color=r,this.changed=!1,this.data=e,this.type=new yne}set(e,r){return this.color=r,this.changed=!1,this.data=e,this.type.type=gs.ALL,this}_ensureHSL(){const e=this.data,{h:r,s:n,l:a}=e;r===void 0&&(e.h=Br.channel.rgb2hsl(e,"h")),n===void 0&&(e.s=Br.channel.rgb2hsl(e,"s")),a===void 0&&(e.l=Br.channel.rgb2hsl(e,"l"))}_ensureRGB(){const e=this.data,{r,g:n,b:a}=e;r===void 0&&(e.r=Br.channel.hsl2rgb(e,"r")),n===void 0&&(e.g=Br.channel.hsl2rgb(e,"g")),a===void 0&&(e.b=Br.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,r=e.r;return!this.type.is(gs.HSL)&&r!==void 0?r:(this._ensureHSL(),Br.channel.hsl2rgb(e,"r"))}get g(){const e=this.data,r=e.g;return!this.type.is(gs.HSL)&&r!==void 0?r:(this._ensureHSL(),Br.channel.hsl2rgb(e,"g"))}get b(){const e=this.data,r=e.b;return!this.type.is(gs.HSL)&&r!==void 0?r:(this._ensureHSL(),Br.channel.hsl2rgb(e,"b"))}get h(){const e=this.data,r=e.h;return!this.type.is(gs.RGB)&&r!==void 0?r:(this._ensureRGB(),Br.channel.rgb2hsl(e,"h"))}get s(){const e=this.data,r=e.s;return!this.type.is(gs.RGB)&&r!==void 0?r:(this._ensureRGB(),Br.channel.rgb2hsl(e,"s"))}get l(){const e=this.data,r=e.l;return!this.type.is(gs.RGB)&&r!==void 0?r:(this._ensureRGB(),Br.channel.rgb2hsl(e,"l"))}get a(){return this.data.a}set r(e){this.type.set(gs.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(gs.RGB),this.changed=!0,this.data.g=e}set b(e){this.type.set(gs.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(gs.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(gs.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(gs.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}const Yy=new bne({r:0,g:0,b:0,a:0},"transparent"),Zd={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:t=>{if(t.charCodeAt(0)!==35)return;const e=t.match(Zd.re);if(!e)return;const r=e[1],n=parseInt(r,16),a=r.length,s=a%4===0,i=a>4,l=i?1:17,c=i?8:4,d=s?0:-1,p=i?255:15;return Yy.set({r:(n>>c*(d+3)&p)*l,g:(n>>c*(d+2)&p)*l,b:(n>>c*(d+1)&p)*l,a:s?(n&p)*l/255:1},t)},stringify:t=>{const{r:e,g:r,b:n,a}=t;return a<1?`#${Sc[Math.round(e)]}${Sc[Math.round(r)]}${Sc[Math.round(n)]}${Sc[Math.round(a*255)]}`:`#${Sc[Math.round(e)]}${Sc[Math.round(r)]}${Sc[Math.round(n)]}`}},xu={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:t=>{const e=t.match(xu.hueRe);if(e){const[,r,n]=e;switch(n){case"grad":return Br.channel.clamp.h(parseFloat(r)*.9);case"rad":return Br.channel.clamp.h(parseFloat(r)*180/Math.PI);case"turn":return Br.channel.clamp.h(parseFloat(r)*360)}}return Br.channel.clamp.h(parseFloat(t))},parse:t=>{const e=t.charCodeAt(0);if(e!==104&&e!==72)return;const r=t.match(xu.re);if(!r)return;const[,n,a,s,i,l]=r;return Yy.set({h:xu._hue2deg(n),s:Br.channel.clamp.s(parseFloat(a)),l:Br.channel.clamp.l(parseFloat(s)),a:i?Br.channel.clamp.a(l?parseFloat(i)/100:parseFloat(i)):1},t)},stringify:t=>{const{h:e,s:r,l:n,a}=t;return a<1?`hsla(${Br.lang.round(e)}, ${Br.lang.round(r)}%, ${Br.lang.round(n)}%, ${a})`:`hsl(${Br.lang.round(e)}, ${Br.lang.round(r)}%, ${Br.lang.round(n)}%)`}},vg={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:t=>{t=t.toLowerCase();const e=vg.colors[t];if(e)return Zd.parse(e)},stringify:t=>{const e=Zd.stringify(t);for(const r in vg.colors)if(vg.colors[r]===e)return r}},Xp={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:t=>{const e=t.charCodeAt(0);if(e!==114&&e!==82)return;const r=t.match(Xp.re);if(!r)return;const[,n,a,s,i,l,c,d,p]=r;return Yy.set({r:Br.channel.clamp.r(a?parseFloat(n)*2.55:parseFloat(n)),g:Br.channel.clamp.g(i?parseFloat(s)*2.55:parseFloat(s)),b:Br.channel.clamp.b(c?parseFloat(l)*2.55:parseFloat(l)),a:d?Br.channel.clamp.a(p?parseFloat(d)/100:parseFloat(d)):1},t)},stringify:t=>{const{r:e,g:r,b:n,a}=t;return a<1?`rgba(${Br.lang.round(e)}, ${Br.lang.round(r)}, ${Br.lang.round(n)}, ${Br.lang.round(a)})`:`rgb(${Br.lang.round(e)}, ${Br.lang.round(r)}, ${Br.lang.round(n)})`}},Qo={format:{keyword:vg,hex:Zd,rgb:Xp,rgba:Xp,hsl:xu,hsla:xu},parse:t=>{if(typeof t!="string")return t;const e=Zd.parse(t)||Xp.parse(t)||xu.parse(t)||vg.parse(t);if(e)return e;throw new Error(`Unsupported color format: "${t}"`)},stringify:t=>!t.changed&&t.color?t.color:t.type.is(gs.HSL)||t.data.r===void 0?xu.stringify(t):t.a<1||!Number.isInteger(t.r)||!Number.isInteger(t.g)||!Number.isInteger(t.b)?Xp.stringify(t):Zd.stringify(t)},QD=(t,e)=>{const r=Qo.parse(t);for(const n in e)r[n]=Br.channel.clamp[n](e[n]);return Qo.stringify(r)},wg=(t,e,r=0,n=1)=>{if(typeof t!="number")return QD(t,{a:e});const a=Yy.set({r:Br.channel.clamp.r(t),g:Br.channel.clamp.g(e),b:Br.channel.clamp.b(r),a:Br.channel.clamp.a(n)});return Qo.stringify(a)},xne=t=>{const{r:e,g:r,b:n}=Qo.parse(t),a=.2126*Br.channel.toLinear(e)+.7152*Br.channel.toLinear(r)+.0722*Br.channel.toLinear(n);return Br.lang.round(a)},vne=t=>xne(t)>=.5,pf=t=>!vne(t),KD=(t,e,r)=>{const n=Qo.parse(t),a=n[e],s=Br.channel.clamp[e](a+r);return a!==s&&(n[e]=s),Qo.stringify(n)},dr=(t,e)=>KD(t,"l",e),Er=(t,e)=>KD(t,"l",-e),Ye=(t,e)=>{const r=Qo.parse(t),n={};for(const a in e)e[a]&&(n[a]=r[a]+e[a]);return QD(t,n)},wne=(t,e,r=50)=>{const{r:n,g:a,b:s,a:i}=Qo.parse(t),{r:l,g:c,b:d,a:p}=Qo.parse(e),g=r/100,m=g*2-1,y=i-p,w=((m*y===-1?m:(m+y)/(1+m*y))+1)/2,T=1-w,k=n*w+l*T,_=a*w+c*T,P=s*w+d*T,F=i*g+p*(1-g);return wg(k,_,P,F)},Jt=(t,e=100)=>{const r=Qo.parse(t);return r.r=255-r.r,r.g=255-r.g,r.b=255-r.b,wne(r,t,e)};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:XD,setPrototypeOf:JA,isFrozen:Sne,getPrototypeOf:kne,getOwnPropertyDescriptor:Tne}=Object;let{freeze:Os,seal:Yi,create:f1}=Object,{apply:m1,construct:y1}=typeof Reflect<"u"&&Reflect;Os||(Os=function(e){return e});Yi||(Yi=function(e){return e});m1||(m1=function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return e.apply(r,a)});y1||(y1=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return new e(...n)});const Fm=js(Array.prototype.forEach),Cne=js(Array.prototype.lastIndexOf),ZA=js(Array.prototype.pop),jp=js(Array.prototype.push),Ene=js(Array.prototype.splice),u0=js(String.prototype.toLowerCase),Xv=js(String.prototype.toString),Jv=js(String.prototype.match),Bp=js(String.prototype.replace),_ne=js(String.prototype.indexOf),Ane=js(String.prototype.trim),oo=js(Object.prototype.hasOwnProperty),Ns=js(RegExp.prototype.test),Fp=Nne(TypeError);function js(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];return m1(t,e,n)}}function Nne(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return y1(t,r)}}function ln(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:u0;JA&&JA(t,null);let n=e.length;for(;n--;){let a=e[n];if(typeof a=="string"){const s=r(a);s!==a&&(Sne(e)||(e[n]=s),a=s)}t[a]=!0}return t}function Pne(t){for(let e=0;e<t.length;e++)oo(t,e)||(t[e]=null);return t}function Cl(t){const e=f1(null);for(const[r,n]of XD(t))oo(t,r)&&(Array.isArray(n)?e[r]=Pne(n):n&&typeof n=="object"&&n.constructor===Object?e[r]=Cl(n):e[r]=n);return e}function zp(t,e){for(;t!==null;){const n=Tne(t,e);if(n){if(n.get)return js(n.get);if(typeof n.value=="function")return js(n.value)}t=kne(t)}function r(){return null}return r}const eN=Os(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zv=Os(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ew=Os(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ine=Os(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),tw=Os(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Rne=Os(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tN=Os(["#text"]),rN=Os(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),rw=Os(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nN=Os(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zm=Os(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Dne=Yi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Lne=Yi(/<%[\w\W]*|[\w\W]*%>/gm),Mne=Yi(/\$\{[\w\W]*/gm),One=Yi(/^data-[\-\w.\u00B7-\uFFFF]+$/),jne=Yi(/^aria-[\-\w]+$/),JD=Yi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Bne=Yi(/^(?:\w+script|data):/i),Fne=Yi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ZD=Yi(/^html$/i),zne=Yi(/^[a-z][.\w]*(-[.\w]+)+$/i);var aN=Object.freeze({__proto__:null,ARIA_ATTR:jne,ATTR_WHITESPACE:Fne,CUSTOM_ELEMENT:zne,DATA_ATTR:One,DOCTYPE_NAME:ZD,ERB_EXPR:Lne,IS_ALLOWED_URI:JD,IS_SCRIPT_OR_DATA:Bne,MUSTACHE_EXPR:Dne,TMPLIT_EXPR:Mne});const $p={element:1,text:3,progressingInstruction:7,comment:8,document:9},$ne=function(){return typeof window>"u"?null:window},Une=function(e,r){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const a="data-tt-policy-suffix";r&&r.hasAttribute(a)&&(n=r.getAttribute(a));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(i){return i},createScriptURL(i){return i}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},sN=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function eL(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$ne();const e=rr=>eL(rr);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==$p.document||!t.Element)return e.isSupported=!1,e;let{document:r}=t;const n=r,a=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:i,Node:l,Element:c,NodeFilter:d,NamedNodeMap:p=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:g,DOMParser:m,trustedTypes:y}=t,x=c.prototype,w=zp(x,"cloneNode"),T=zp(x,"remove"),k=zp(x,"nextSibling"),_=zp(x,"childNodes"),P=zp(x,"parentNode");if(typeof i=="function"){const rr=r.createElement("template");rr.content&&rr.content.ownerDocument&&(r=rr.content.ownerDocument)}let F,D="";const{implementation:B,createNodeIterator:M,createDocumentFragment:$,getElementsByTagName:Z}=r,{importNode:z}=n;let ee=sN();e.isSupported=typeof XD=="function"&&typeof P=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:te,ERB_EXPR:X,TMPLIT_EXPR:Q,DATA_ATTR:W,ARIA_ATTR:H,IS_SCRIPT_OR_DATA:re,ATTR_WHITESPACE:ne,CUSTOM_ELEMENT:ve}=aN;let{IS_ALLOWED_URI:O}=aN,I=null;const K=ln({},[...eN,...Zv,...ew,...tw,...tN]);let U=null;const ce=ln({},[...rN,...rw,...nN,...zm]);let ye=Object.seal(f1(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ae=null,fe=null;const Ne=Object.seal(f1(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let Te=!0,se=!0,be=!1,xe=!0,me=!1,de=!0,he=!1,Ie=!1,ze=!1,nt=!1,mt=!1,ht=!1,er=!0,ct=!1;const Dt="user-content-";let kt=!0,fr=!1,qe={},st=null;const Gt=ln({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Kt=null;const lr=ln({},["audio","video","img","source","image","track"]);let Qe=null;const Yt=ln({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ur="http://www.w3.org/1998/Math/MathML",_t="http://www.w3.org/2000/svg",sr="http://www.w3.org/1999/xhtml";let vt=sr,pn=!1,Ar=null;const Ja=ln({},[ur,_t,sr],Xv);let zt=ln({},["mi","mo","mn","ms","mtext"]),Ca=ln({},["annotation-xml"]);const Bs=ln({},["title","style","font","a","script"]);let qn=null;const Se=["application/xhtml+xml","text/html"],ut="text/html";let Nt=null,xr=null;const Kr=r.createElement("form"),Xr=function(De){return De instanceof RegExp||De instanceof Function},tr=function(){let De=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(xr&&xr===De)){if((!De||typeof De!="object")&&(De={}),De=Cl(De),qn=Se.indexOf(De.PARSER_MEDIA_TYPE)===-1?ut:De.PARSER_MEDIA_TYPE,Nt=qn==="application/xhtml+xml"?Xv:u0,I=oo(De,"ALLOWED_TAGS")?ln({},De.ALLOWED_TAGS,Nt):K,U=oo(De,"ALLOWED_ATTR")?ln({},De.ALLOWED_ATTR,Nt):ce,Ar=oo(De,"ALLOWED_NAMESPACES")?ln({},De.ALLOWED_NAMESPACES,Xv):Ja,Qe=oo(De,"ADD_URI_SAFE_ATTR")?ln(Cl(Yt),De.ADD_URI_SAFE_ATTR,Nt):Yt,Kt=oo(De,"ADD_DATA_URI_TAGS")?ln(Cl(lr),De.ADD_DATA_URI_TAGS,Nt):lr,st=oo(De,"FORBID_CONTENTS")?ln({},De.FORBID_CONTENTS,Nt):Gt,Ae=oo(De,"FORBID_TAGS")?ln({},De.FORBID_TAGS,Nt):Cl({}),fe=oo(De,"FORBID_ATTR")?ln({},De.FORBID_ATTR,Nt):Cl({}),qe=oo(De,"USE_PROFILES")?De.USE_PROFILES:!1,Te=De.ALLOW_ARIA_ATTR!==!1,se=De.ALLOW_DATA_ATTR!==!1,be=De.ALLOW_UNKNOWN_PROTOCOLS||!1,xe=De.ALLOW_SELF_CLOSE_IN_ATTR!==!1,me=De.SAFE_FOR_TEMPLATES||!1,de=De.SAFE_FOR_XML!==!1,he=De.WHOLE_DOCUMENT||!1,nt=De.RETURN_DOM||!1,mt=De.RETURN_DOM_FRAGMENT||!1,ht=De.RETURN_TRUSTED_TYPE||!1,ze=De.FORCE_BODY||!1,er=De.SANITIZE_DOM!==!1,ct=De.SANITIZE_NAMED_PROPS||!1,kt=De.KEEP_CONTENT!==!1,fr=De.IN_PLACE||!1,O=De.ALLOWED_URI_REGEXP||JD,vt=De.NAMESPACE||sr,zt=De.MATHML_TEXT_INTEGRATION_POINTS||zt,Ca=De.HTML_INTEGRATION_POINTS||Ca,ye=De.CUSTOM_ELEMENT_HANDLING||{},De.CUSTOM_ELEMENT_HANDLING&&Xr(De.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ye.tagNameCheck=De.CUSTOM_ELEMENT_HANDLING.tagNameCheck),De.CUSTOM_ELEMENT_HANDLING&&Xr(De.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ye.attributeNameCheck=De.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),De.CUSTOM_ELEMENT_HANDLING&&typeof De.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ye.allowCustomizedBuiltInElements=De.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),me&&(se=!1),mt&&(nt=!0),qe&&(I=ln({},tN),U=[],qe.html===!0&&(ln(I,eN),ln(U,rN)),qe.svg===!0&&(ln(I,Zv),ln(U,rw),ln(U,zm)),qe.svgFilters===!0&&(ln(I,ew),ln(U,rw),ln(U,zm)),qe.mathMl===!0&&(ln(I,tw),ln(U,nN),ln(U,zm))),De.ADD_TAGS&&(typeof De.ADD_TAGS=="function"?Ne.tagCheck=De.ADD_TAGS:(I===K&&(I=Cl(I)),ln(I,De.ADD_TAGS,Nt))),De.ADD_ATTR&&(typeof De.ADD_ATTR=="function"?Ne.attributeCheck=De.ADD_ATTR:(U===ce&&(U=Cl(U)),ln(U,De.ADD_ATTR,Nt))),De.ADD_URI_SAFE_ATTR&&ln(Qe,De.ADD_URI_SAFE_ATTR,Nt),De.FORBID_CONTENTS&&(st===Gt&&(st=Cl(st)),ln(st,De.FORBID_CONTENTS,Nt)),kt&&(I["#text"]=!0),he&&ln(I,["html","head","body"]),I.table&&(ln(I,["tbody"]),delete Ae.tbody),De.TRUSTED_TYPES_POLICY){if(typeof De.TRUSTED_TYPES_POLICY.createHTML!="function")throw Fp('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof De.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Fp('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');F=De.TRUSTED_TYPES_POLICY,D=F.createHTML("")}else F===void 0&&(F=Une(y,a)),F!==null&&typeof D=="string"&&(D=F.createHTML(""));Os&&Os(De),xr=De}},Vt=ln({},[...Zv,...ew,...Ine]),Qt=ln({},[...tw,...Rne]),Or=function(De){let bt=P(De);(!bt||!bt.tagName)&&(bt={namespaceURI:vt,tagName:"template"});const Mt=u0(De.tagName),zr=u0(bt.tagName);return Ar[De.namespaceURI]?De.namespaceURI===_t?bt.namespaceURI===sr?Mt==="svg":bt.namespaceURI===ur?Mt==="svg"&&(zr==="annotation-xml"||zt[zr]):!!Vt[Mt]:De.namespaceURI===ur?bt.namespaceURI===sr?Mt==="math":bt.namespaceURI===_t?Mt==="math"&&Ca[zr]:!!Qt[Mt]:De.namespaceURI===sr?bt.namespaceURI===_t&&!Ca[zr]||bt.namespaceURI===ur&&!zt[zr]?!1:!Qt[Mt]&&(Bs[Mt]||!Vt[Mt]):!!(qn==="application/xhtml+xml"&&Ar[De.namespaceURI]):!1},Hr=function(De){jp(e.removed,{element:De});try{P(De).removeChild(De)}catch{T(De)}},Dn=function(De,bt){try{jp(e.removed,{attribute:bt.getAttributeNode(De),from:bt})}catch{jp(e.removed,{attribute:null,from:bt})}if(bt.removeAttribute(De),De==="is")if(nt||mt)try{Hr(bt)}catch{}else try{bt.setAttribute(De,"")}catch{}},Ba=function(De){let bt=null,Mt=null;if(ze)De="<remove></remove>"+De;else{const jr=Jv(De,/^[\r\n\t ]+/);Mt=jr&&jr[0]}qn==="application/xhtml+xml"&&vt===sr&&(De='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+De+"</body></html>");const zr=F?F.createHTML(De):De;if(vt===sr)try{bt=new m().parseFromString(zr,qn)}catch{}if(!bt||!bt.documentElement){bt=B.createDocument(vt,"template",null);try{bt.documentElement.innerHTML=pn?D:zr}catch{}}const rn=bt.body||bt.documentElement;return De&&Mt&&rn.insertBefore(r.createTextNode(Mt),rn.childNodes[0]||null),vt===sr?Z.call(bt,he?"html":"body")[0]:he?bt.documentElement:rn},Za=function(De){return M.call(De.ownerDocument||De,De,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},Ea=function(De){return De instanceof g&&(typeof De.nodeName!="string"||typeof De.textContent!="string"||typeof De.removeChild!="function"||!(De.attributes instanceof p)||typeof De.removeAttribute!="function"||typeof De.setAttribute!="function"||typeof De.namespaceURI!="string"||typeof De.insertBefore!="function"||typeof De.hasChildNodes!="function")},an=function(De){return typeof l=="function"&&De instanceof l};function tn(rr,De,bt){Fm(rr,Mt=>{Mt.call(e,De,bt,xr)})}const ca=function(De){let bt=null;if(tn(ee.beforeSanitizeElements,De,null),Ea(De))return Hr(De),!0;const Mt=Nt(De.nodeName);if(tn(ee.uponSanitizeElement,De,{tagName:Mt,allowedTags:I}),de&&De.hasChildNodes()&&!an(De.firstElementChild)&&Ns(/<[/\w!]/g,De.innerHTML)&&Ns(/<[/\w!]/g,De.textContent)||De.nodeType===$p.progressingInstruction||de&&De.nodeType===$p.comment&&Ns(/<[/\w]/g,De.data))return Hr(De),!0;if(!(Ne.tagCheck instanceof Function&&Ne.tagCheck(Mt))&&(!I[Mt]||Ae[Mt])){if(!Ae[Mt]&&Zi(Mt)&&(ye.tagNameCheck instanceof RegExp&&Ns(ye.tagNameCheck,Mt)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(Mt)))return!1;if(kt&&!st[Mt]){const zr=P(De)||De.parentNode,rn=_(De)||De.childNodes;if(rn&&zr){const jr=rn.length;for(let ir=jr-1;ir>=0;--ir){const Kn=w(rn[ir],!0);Kn.__removalCount=(De.__removalCount||0)+1,zr.insertBefore(Kn,k(De))}}}return Hr(De),!0}return De instanceof c&&!Or(De)||(Mt==="noscript"||Mt==="noembed"||Mt==="noframes")&&Ns(/<\/no(script|embed|frames)/i,De.innerHTML)?(Hr(De),!0):(me&&De.nodeType===$p.text&&(bt=De.textContent,Fm([te,X,Q],zr=>{bt=Bp(bt,zr," ")}),De.textContent!==bt&&(jp(e.removed,{element:De.cloneNode()}),De.textContent=bt)),tn(ee.afterSanitizeElements,De,null),!1)},_a=function(De,bt,Mt){if(er&&(bt==="id"||bt==="name")&&(Mt in r||Mt in Kr))return!1;if(!(se&&!fe[bt]&&Ns(W,bt))){if(!(Te&&Ns(H,bt))){if(!(Ne.attributeCheck instanceof Function&&Ne.attributeCheck(bt,De))){if(!U[bt]||fe[bt]){if(!(Zi(De)&&(ye.tagNameCheck instanceof RegExp&&Ns(ye.tagNameCheck,De)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(De))&&(ye.attributeNameCheck instanceof RegExp&&Ns(ye.attributeNameCheck,bt)||ye.attributeNameCheck instanceof Function&&ye.attributeNameCheck(bt,De))||bt==="is"&&ye.allowCustomizedBuiltInElements&&(ye.tagNameCheck instanceof RegExp&&Ns(ye.tagNameCheck,Mt)||ye.tagNameCheck instanceof Function&&ye.tagNameCheck(Mt))))return!1}else if(!Qe[bt]){if(!Ns(O,Bp(Mt,ne,""))){if(!((bt==="src"||bt==="xlink:href"||bt==="href")&&De!=="script"&&_ne(Mt,"data:")===0&&Kt[De])){if(!(be&&!Ns(re,Bp(Mt,ne,"")))){if(Mt)return!1}}}}}}}return!0},Zi=function(De){return De!=="annotation-xml"&&Jv(De,ve)},Zn=function(De){tn(ee.beforeSanitizeAttributes,De,null);const{attributes:bt}=De;if(!bt||Ea(De))return;const Mt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U,forceKeepAttr:void 0};let zr=bt.length;for(;zr--;){const rn=bt[zr],{name:jr,namespaceURI:ir,value:Kn}=rn,Hn=Nt(jr),Tt=Kn;let qt=jr==="value"?Tt:Ane(Tt);if(Mt.attrName=Hn,Mt.attrValue=qt,Mt.keepAttr=!0,Mt.forceKeepAttr=void 0,tn(ee.uponSanitizeAttribute,De,Mt),qt=Mt.attrValue,ct&&(Hn==="id"||Hn==="name")&&(Dn(jr,De),qt=Dt+qt),de&&Ns(/((--!?|])>)|<\/(style|title|textarea)/i,qt)){Dn(jr,De);continue}if(Hn==="attributename"&&Jv(qt,"href")){Dn(jr,De);continue}if(Mt.forceKeepAttr)continue;if(!Mt.keepAttr){Dn(jr,De);continue}if(!xe&&Ns(/\/>/i,qt)){Dn(jr,De);continue}me&&Fm([te,X,Q],Gr=>{qt=Bp(qt,Gr," ")});const Lr=Nt(De.nodeName);if(!_a(Lr,Hn,qt)){Dn(jr,De);continue}if(F&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!ir)switch(y.getAttributeType(Lr,Hn)){case"TrustedHTML":{qt=F.createHTML(qt);break}case"TrustedScriptURL":{qt=F.createScriptURL(qt);break}}if(qt!==Tt)try{ir?De.setAttributeNS(ir,jr,qt):De.setAttribute(jr,qt),Ea(De)?Hr(De):ZA(e.removed)}catch{Dn(jr,De)}}tn(ee.afterSanitizeAttributes,De,null)},Pi=function rr(De){let bt=null;const Mt=Za(De);for(tn(ee.beforeSanitizeShadowDOM,De,null);bt=Mt.nextNode();)tn(ee.uponSanitizeShadowNode,bt,null),ca(bt),Zn(bt),bt.content instanceof s&&rr(bt.content);tn(ee.afterSanitizeShadowDOM,De,null)};return e.sanitize=function(rr){let De=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},bt=null,Mt=null,zr=null,rn=null;if(pn=!rr,pn&&(rr="<!-->"),typeof rr!="string"&&!an(rr))if(typeof rr.toString=="function"){if(rr=rr.toString(),typeof rr!="string")throw Fp("dirty is not a string, aborting")}else throw Fp("toString is not a function");if(!e.isSupported)return rr;if(Ie||tr(De),e.removed=[],typeof rr=="string"&&(fr=!1),fr){if(rr.nodeName){const Kn=Nt(rr.nodeName);if(!I[Kn]||Ae[Kn])throw Fp("root node is forbidden and cannot be sanitized in-place")}}else if(rr instanceof l)bt=Ba("<!---->"),Mt=bt.ownerDocument.importNode(rr,!0),Mt.nodeType===$p.element&&Mt.nodeName==="BODY"||Mt.nodeName==="HTML"?bt=Mt:bt.appendChild(Mt);else{if(!nt&&!me&&!he&&rr.indexOf("<")===-1)return F&&ht?F.createHTML(rr):rr;if(bt=Ba(rr),!bt)return nt?null:ht?D:""}bt&&ze&&Hr(bt.firstChild);const jr=Za(fr?rr:bt);for(;zr=jr.nextNode();)ca(zr),Zn(zr),zr.content instanceof s&&Pi(zr.content);if(fr)return rr;if(nt){if(mt)for(rn=$.call(bt.ownerDocument);bt.firstChild;)rn.appendChild(bt.firstChild);else rn=bt;return(U.shadowroot||U.shadowrootmode)&&(rn=z.call(n,rn,!0)),rn}let ir=he?bt.outerHTML:bt.innerHTML;return he&&I["!doctype"]&&bt.ownerDocument&&bt.ownerDocument.doctype&&bt.ownerDocument.doctype.name&&Ns(ZD,bt.ownerDocument.doctype.name)&&(ir="<!DOCTYPE "+bt.ownerDocument.doctype.name+`>
`+ir),me&&Fm([te,X,Q],Kn=>{ir=Bp(ir,Kn," ")}),F&&ht?F.createHTML(ir):ir},e.setConfig=function(){let rr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};tr(rr),Ie=!0},e.clearConfig=function(){xr=null,Ie=!1},e.isValidAttribute=function(rr,De,bt){xr||tr({});const Mt=Nt(rr),zr=Nt(De);return _a(Mt,zr,bt)},e.addHook=function(rr,De){typeof De=="function"&&jp(ee[rr],De)},e.removeHook=function(rr,De){if(De!==void 0){const bt=Cne(ee[rr],De);return bt===-1?void 0:Ene(ee[rr],bt,1)[0]}return ZA(ee[rr])},e.removeHooks=function(rr){ee[rr]=[]},e.removeAllHooks=function(){ee=sN()},e}var gh=eL(),tL=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Sg=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,qne=/\s*%%.*\n/gm,rh,rL=(rh=class extends Error{constructor(e){super(e),this.name="UnknownDiagramError"}},L(rh,"UnknownDiagramError"),rh),Ru={},tk=L(function(t,e){t=t.replace(tL,"").replace(Sg,"").replace(qne,`
`);for(const[r,{detector:n}]of Object.entries(Ru))if(n(t,e))return r;throw new rL(`No diagram type detected matching given configuration for text: ${t}`)},"detectType"),b1=L((...t)=>{for(const{id:e,detector:r,loader:n}of t)nL(e,r,n)},"registerLazyLoadedDiagrams"),nL=L((t,e,r)=>{Ru[t]&&wt.warn(`Detector with key ${t} already exists. Overwriting.`),Ru[t]={detector:e,loader:r},wt.debug(`Detector with key ${t} added${r?" with loader":""}`)},"addDetector"),Hne=L(t=>Ru[t].loader,"getDiagramLoader"),x1=L((t,e,{depth:r=2,clobber:n=!1}={})=>{const a={depth:r,clobber:n};return Array.isArray(e)&&!Array.isArray(t)?(e.forEach(s=>x1(t,s,a)),t):Array.isArray(e)&&Array.isArray(t)?(e.forEach(s=>{t.includes(s)||t.push(s)}),t):t===void 0||r<=0?t!=null&&typeof t=="object"&&typeof e=="object"?Object.assign(t,e):e:(e!==void 0&&typeof t=="object"&&typeof e=="object"&&Object.keys(e).forEach(s=>{typeof e[s]=="object"&&(t[s]===void 0||typeof t[s]=="object")?(t[s]===void 0&&(t[s]=Array.isArray(e[s])?[]:{}),t[s]=x1(t[s],e[s],{depth:r-1,clobber:n})):(n||typeof t[s]!="object"&&typeof e[s]!="object")&&(t[s]=e[s])}),t)},"assignWithDepth"),Ga=x1,Qy="#ffffff",Ky="#f2f2f2",Ds=L((t,e)=>e?Ye(t,{s:-40,l:10}):Ye(t,{s:-40,l:-10}),"mkBorder"),nh,Gne=(nh=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||Ye(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||Ye(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Ds(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Ds(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Ds(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Ds(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||Jt(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||Jt(this.tertiaryColor),this.lineColor=this.lineColor||Jt(this.background),this.arrowheadColor=this.arrowheadColor||Jt(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Er(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Er(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||Jt(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||dr(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.vertLineColor=this.vertLineColor||"navy",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||Er(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Er(this.mainBkg,10)):(this.rowOdd=this.rowOdd||dr(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||dr(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||Ye(this.primaryColor,{h:30}),this.cScale4=this.cScale4||Ye(this.primaryColor,{h:60}),this.cScale5=this.cScale5||Ye(this.primaryColor,{h:90}),this.cScale6=this.cScale6||Ye(this.primaryColor,{h:120}),this.cScale7=this.cScale7||Ye(this.primaryColor,{h:150}),this.cScale8=this.cScale8||Ye(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||Ye(this.primaryColor,{h:270}),this.cScale10=this.cScale10||Ye(this.primaryColor,{h:300}),this.cScale11=this.cScale11||Ye(this.primaryColor,{h:330}),this.darkMode)for(let r=0;r<this.THEME_COLOR_LIMIT;r++)this["cScale"+r]=Er(this["cScale"+r],75);else for(let r=0;r<this.THEME_COLOR_LIMIT;r++)this["cScale"+r]=Er(this["cScale"+r],25);for(let r=0;r<this.THEME_COLOR_LIMIT;r++)this["cScaleInv"+r]=this["cScaleInv"+r]||Jt(this["cScale"+r]);for(let r=0;r<this.THEME_COLOR_LIMIT;r++)this.darkMode?this["cScalePeer"+r]=this["cScalePeer"+r]||dr(this["cScale"+r],10):this["cScalePeer"+r]=this["cScalePeer"+r]||Er(this["cScale"+r],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let r=0;r<this.THEME_COLOR_LIMIT;r++)this["cScaleLabel"+r]=this["cScaleLabel"+r]||this.scaleLabelColor;const e=this.darkMode?-4:-1;for(let r=0;r<5;r++)this["surface"+r]=this["surface"+r]||Ye(this.mainBkg,{h:180,s:-15,l:e*(5+r*3)}),this["surfacePeer"+r]=this["surfacePeer"+r]||Ye(this.mainBkg,{h:180,s:-15,l:e*(8+r*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||Ye(this.primaryColor,{h:64}),this.fillType3=this.fillType3||Ye(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||Ye(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||Ye(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||Ye(this.primaryColor,{h:128}),this.fillType7=this.fillType7||Ye(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||Ye(this.primaryColor,{l:-10}),this.pie5=this.pie5||Ye(this.secondaryColor,{l:-10}),this.pie6=this.pie6||Ye(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||Ye(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||Ye(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||Ye(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||Ye(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||Ye(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||Ye(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:this.radar?.axisColor||this.lineColor,axisStrokeWidth:this.radar?.axisStrokeWidth||2,axisLabelFontSize:this.radar?.axisLabelFontSize||12,curveOpacity:this.radar?.curveOpacity||.5,curveStrokeWidth:this.radar?.curveStrokeWidth||2,graticuleColor:this.radar?.graticuleColor||"#DEDEDE",graticuleStrokeWidth:this.radar?.graticuleStrokeWidth||1,graticuleOpacity:this.radar?.graticuleOpacity||.3,legendBoxSize:this.radar?.legendBoxSize||12,legendFontSize:this.radar?.legendFontSize||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||Ye(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||Ye(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||Ye(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||Ye(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||Ye(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||Ye(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||pf(this.quadrant1Fill)?dr(this.quadrant1Fill):Er(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:this.xyChart?.backgroundColor||this.background,titleColor:this.xyChart?.titleColor||this.primaryTextColor,xAxisTitleColor:this.xyChart?.xAxisTitleColor||this.primaryTextColor,xAxisLabelColor:this.xyChart?.xAxisLabelColor||this.primaryTextColor,xAxisTickColor:this.xyChart?.xAxisTickColor||this.primaryTextColor,xAxisLineColor:this.xyChart?.xAxisLineColor||this.primaryTextColor,yAxisTitleColor:this.xyChart?.yAxisTitleColor||this.primaryTextColor,yAxisLabelColor:this.xyChart?.yAxisLabelColor||this.primaryTextColor,yAxisTickColor:this.xyChart?.yAxisTickColor||this.primaryTextColor,yAxisLineColor:this.xyChart?.yAxisLineColor||this.primaryTextColor,plotColorPalette:this.xyChart?.plotColorPalette||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Er(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||Ye(this.primaryColor,{h:-30}),this.git4=this.git4||Ye(this.primaryColor,{h:-60}),this.git5=this.git5||Ye(this.primaryColor,{h:-90}),this.git6=this.git6||Ye(this.primaryColor,{h:60}),this.git7=this.git7||Ye(this.primaryColor,{h:120}),this.darkMode?(this.git0=dr(this.git0,25),this.git1=dr(this.git1,25),this.git2=dr(this.git2,25),this.git3=dr(this.git3,25),this.git4=dr(this.git4,25),this.git5=dr(this.git5,25),this.git6=dr(this.git6,25),this.git7=dr(this.git7,25)):(this.git0=Er(this.git0,25),this.git1=Er(this.git1,25),this.git2=Er(this.git2,25),this.git3=Er(this.git3,25),this.git4=Er(this.git4,25),this.git5=Er(this.git5,25),this.git6=Er(this.git6,25),this.git7=Er(this.git7,25)),this.gitInv0=this.gitInv0||Jt(this.git0),this.gitInv1=this.gitInv1||Jt(this.git1),this.gitInv2=this.gitInv2||Jt(this.git2),this.gitInv3=this.gitInv3||Jt(this.git3),this.gitInv4=this.gitInv4||Jt(this.git4),this.gitInv5=this.gitInv5||Jt(this.git5),this.gitInv6=this.gitInv6||Jt(this.git6),this.gitInv7=this.gitInv7||Jt(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Qy,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ky}calculate(e){if(typeof e!="object"){this.updateColors();return}const r=Object.keys(e);r.forEach(n=>{this[n]=e[n]}),this.updateColors(),r.forEach(n=>{this[n]=e[n]})}},L(nh,"Theme"),nh),Vne=L(t=>{const e=new Gne;return e.calculate(t),e},"getThemeVariables"),ah,Wne=(ah=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=dr(this.primaryColor,16),this.tertiaryColor=Ye(this.primaryColor,{h:-160}),this.primaryBorderColor=Jt(this.background),this.secondaryBorderColor=Ds(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ds(this.tertiaryColor,this.darkMode),this.primaryTextColor=Jt(this.primaryColor),this.secondaryTextColor=Jt(this.secondaryColor),this.tertiaryTextColor=Jt(this.tertiaryColor),this.lineColor=Jt(this.background),this.textColor=Jt(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=dr(Jt("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=wg(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Er("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Er(this.sectionBkgColor,10),this.taskBorderColor=wg(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=wg(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.vertLineColor="#00BFFF",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||dr(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Er(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){this.secondBkg=dr(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=dr(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=dr(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=Ye(this.primaryColor,{h:64}),this.fillType3=Ye(this.secondaryColor,{h:64}),this.fillType4=Ye(this.primaryColor,{h:-64}),this.fillType5=Ye(this.secondaryColor,{h:-64}),this.fillType6=Ye(this.primaryColor,{h:128}),this.fillType7=Ye(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||Ye(this.primaryColor,{h:30}),this.cScale4=this.cScale4||Ye(this.primaryColor,{h:60}),this.cScale5=this.cScale5||Ye(this.primaryColor,{h:90}),this.cScale6=this.cScale6||Ye(this.primaryColor,{h:120}),this.cScale7=this.cScale7||Ye(this.primaryColor,{h:150}),this.cScale8=this.cScale8||Ye(this.primaryColor,{h:210}),this.cScale9=this.cScale9||Ye(this.primaryColor,{h:270}),this.cScale10=this.cScale10||Ye(this.primaryColor,{h:300}),this.cScale11=this.cScale11||Ye(this.primaryColor,{h:330});for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||Jt(this["cScale"+e]);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScalePeer"+e]=this["cScalePeer"+e]||dr(this["cScale"+e],10);for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||Ye(this.mainBkg,{h:30,s:-30,l:-(-10+e*4)}),this["surfacePeer"+e]=this["surfacePeer"+e]||Ye(this.mainBkg,{h:30,s:-30,l:-(-7+e*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["pie"+e]=this["cScale"+e];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||Ye(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||Ye(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||Ye(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||Ye(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||Ye(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||Ye(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||pf(this.quadrant1Fill)?dr(this.quadrant1Fill):Er(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:this.xyChart?.backgroundColor||this.background,titleColor:this.xyChart?.titleColor||this.primaryTextColor,xAxisTitleColor:this.xyChart?.xAxisTitleColor||this.primaryTextColor,xAxisLabelColor:this.xyChart?.xAxisLabelColor||this.primaryTextColor,xAxisTickColor:this.xyChart?.xAxisTickColor||this.primaryTextColor,xAxisLineColor:this.xyChart?.xAxisLineColor||this.primaryTextColor,yAxisTitleColor:this.xyChart?.yAxisTitleColor||this.primaryTextColor,yAxisLabelColor:this.xyChart?.yAxisLabelColor||this.primaryTextColor,yAxisTickColor:this.xyChart?.yAxisTickColor||this.primaryTextColor,yAxisLineColor:this.xyChart?.yAxisLineColor||this.primaryTextColor,plotColorPalette:this.xyChart?.plotColorPalette||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:this.radar?.axisColor||this.lineColor,axisStrokeWidth:this.radar?.axisStrokeWidth||2,axisLabelFontSize:this.radar?.axisLabelFontSize||12,curveOpacity:this.radar?.curveOpacity||.5,curveStrokeWidth:this.radar?.curveStrokeWidth||2,graticuleColor:this.radar?.graticuleColor||"#DEDEDE",graticuleStrokeWidth:this.radar?.graticuleStrokeWidth||1,graticuleOpacity:this.radar?.graticuleOpacity||.3,legendBoxSize:this.radar?.legendBoxSize||12,legendFontSize:this.radar?.legendFontSize||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Er(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=dr(this.secondaryColor,20),this.git1=dr(this.pie2||this.secondaryColor,20),this.git2=dr(this.pie3||this.tertiaryColor,20),this.git3=dr(this.pie4||Ye(this.primaryColor,{h:-30}),20),this.git4=dr(this.pie5||Ye(this.primaryColor,{h:-60}),20),this.git5=dr(this.pie6||Ye(this.primaryColor,{h:-90}),10),this.git6=dr(this.pie7||Ye(this.primaryColor,{h:60}),10),this.git7=dr(this.pie8||Ye(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||Jt(this.git0),this.gitInv1=this.gitInv1||Jt(this.git1),this.gitInv2=this.gitInv2||Jt(this.git2),this.gitInv3=this.gitInv3||Jt(this.git3),this.gitInv4=this.gitInv4||Jt(this.git4),this.gitInv5=this.gitInv5||Jt(this.git5),this.gitInv6=this.gitInv6||Jt(this.git6),this.gitInv7=this.gitInv7||Jt(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||Jt(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||Jt(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||dr(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||dr(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(e){if(typeof e!="object"){this.updateColors();return}const r=Object.keys(e);r.forEach(n=>{this[n]=e[n]}),this.updateColors(),r.forEach(n=>{this[n]=e[n]})}},L(ah,"Theme"),ah),Yne=L(t=>{const e=new Wne;return e.calculate(t),e},"getThemeVariables"),sh,Qne=(sh=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=Ye(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=Ye(this.primaryColor,{h:-160}),this.primaryBorderColor=Ds(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ds(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ds(this.tertiaryColor,this.darkMode),this.primaryTextColor=Jt(this.primaryColor),this.secondaryTextColor=Jt(this.secondaryColor),this.tertiaryTextColor=Jt(this.tertiaryColor),this.lineColor=Jt(this.background),this.textColor=Jt(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.vertLineColor="calculated",this.sectionBkgColor=wg(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.vertLineColor="navy",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||Ye(this.primaryColor,{h:30}),this.cScale4=this.cScale4||Ye(this.primaryColor,{h:60}),this.cScale5=this.cScale5||Ye(this.primaryColor,{h:90}),this.cScale6=this.cScale6||Ye(this.primaryColor,{h:120}),this.cScale7=this.cScale7||Ye(this.primaryColor,{h:150}),this.cScale8=this.cScale8||Ye(this.primaryColor,{h:210}),this.cScale9=this.cScale9||Ye(this.primaryColor,{h:270}),this.cScale10=this.cScale10||Ye(this.primaryColor,{h:300}),this.cScale11=this.cScale11||Ye(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Er(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Er(this.tertiaryColor,40);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=Er(this["cScale"+e],10),this["cScalePeer"+e]=this["cScalePeer"+e]||Er(this["cScale"+e],25);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||Ye(this["cScale"+e],{h:180});for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||Ye(this.mainBkg,{h:30,l:-(5+e*5)}),this["surfacePeer"+e]=this["surfacePeer"+e]||Ye(this.mainBkg,{h:30,l:-(7+e*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||Jt(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||Jt(this.labelTextColor);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=dr(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||dr(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||dr(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=Ye(this.primaryColor,{h:64}),this.fillType3=Ye(this.secondaryColor,{h:64}),this.fillType4=Ye(this.primaryColor,{h:-64}),this.fillType5=Ye(this.secondaryColor,{h:-64}),this.fillType6=Ye(this.primaryColor,{h:128}),this.fillType7=Ye(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||Ye(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||Ye(this.primaryColor,{l:-10}),this.pie5=this.pie5||Ye(this.secondaryColor,{l:-30}),this.pie6=this.pie6||Ye(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||Ye(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||Ye(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||Ye(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||Ye(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||Ye(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||Ye(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||Ye(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||Ye(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||Ye(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||Ye(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||Ye(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||Ye(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||pf(this.quadrant1Fill)?dr(this.quadrant1Fill):Er(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:this.radar?.axisColor||this.lineColor,axisStrokeWidth:this.radar?.axisStrokeWidth||2,axisLabelFontSize:this.radar?.axisLabelFontSize||12,curveOpacity:this.radar?.curveOpacity||.5,curveStrokeWidth:this.radar?.curveStrokeWidth||2,graticuleColor:this.radar?.graticuleColor||"#DEDEDE",graticuleStrokeWidth:this.radar?.graticuleStrokeWidth||1,graticuleOpacity:this.radar?.graticuleOpacity||.3,legendBoxSize:this.radar?.legendBoxSize||12,legendFontSize:this.radar?.legendFontSize||12},this.xyChart={backgroundColor:this.xyChart?.backgroundColor||this.background,titleColor:this.xyChart?.titleColor||this.primaryTextColor,xAxisTitleColor:this.xyChart?.xAxisTitleColor||this.primaryTextColor,xAxisLabelColor:this.xyChart?.xAxisLabelColor||this.primaryTextColor,xAxisTickColor:this.xyChart?.xAxisTickColor||this.primaryTextColor,xAxisLineColor:this.xyChart?.xAxisLineColor||this.primaryTextColor,yAxisTitleColor:this.xyChart?.yAxisTitleColor||this.primaryTextColor,yAxisLabelColor:this.xyChart?.yAxisLabelColor||this.primaryTextColor,yAxisTickColor:this.xyChart?.yAxisTickColor||this.primaryTextColor,yAxisLineColor:this.xyChart?.yAxisLineColor||this.primaryTextColor,plotColorPalette:this.xyChart?.plotColorPalette||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||Ye(this.primaryColor,{h:-30}),this.git4=this.git4||Ye(this.primaryColor,{h:-60}),this.git5=this.git5||Ye(this.primaryColor,{h:-90}),this.git6=this.git6||Ye(this.primaryColor,{h:60}),this.git7=this.git7||Ye(this.primaryColor,{h:120}),this.darkMode?(this.git0=dr(this.git0,25),this.git1=dr(this.git1,25),this.git2=dr(this.git2,25),this.git3=dr(this.git3,25),this.git4=dr(this.git4,25),this.git5=dr(this.git5,25),this.git6=dr(this.git6,25),this.git7=dr(this.git7,25)):(this.git0=Er(this.git0,25),this.git1=Er(this.git1,25),this.git2=Er(this.git2,25),this.git3=Er(this.git3,25),this.git4=Er(this.git4,25),this.git5=Er(this.git5,25),this.git6=Er(this.git6,25),this.git7=Er(this.git7,25)),this.gitInv0=this.gitInv0||Er(Jt(this.git0),25),this.gitInv1=this.gitInv1||Jt(this.git1),this.gitInv2=this.gitInv2||Jt(this.git2),this.gitInv3=this.gitInv3||Jt(this.git3),this.gitInv4=this.gitInv4||Jt(this.git4),this.gitInv5=this.gitInv5||Jt(this.git5),this.gitInv6=this.gitInv6||Jt(this.git6),this.gitInv7=this.gitInv7||Jt(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||Jt(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||Jt(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Qy,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ky}calculate(e){if(Object.keys(this).forEach(n=>{this[n]==="calculated"&&(this[n]=void 0)}),typeof e!="object"){this.updateColors();return}const r=Object.keys(e);r.forEach(n=>{this[n]=e[n]}),this.updateColors(),r.forEach(n=>{this[n]=e[n]})}},L(sh,"Theme"),sh),Kne=L(t=>{const e=new Qne;return e.calculate(t),e},"getThemeVariables"),ih,Xne=(ih=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=dr("#cde498",10),this.primaryBorderColor=Ds(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ds(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ds(this.tertiaryColor,this.darkMode),this.primaryTextColor=Jt(this.primaryColor),this.secondaryTextColor=Jt(this.secondaryColor),this.tertiaryTextColor=Jt(this.primaryColor),this.lineColor=Jt(this.background),this.textColor=Jt(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.vertLineColor="#00BFFF",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){this.actorBorder=Er(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||Ye(this.primaryColor,{h:30}),this.cScale4=this.cScale4||Ye(this.primaryColor,{h:60}),this.cScale5=this.cScale5||Ye(this.primaryColor,{h:90}),this.cScale6=this.cScale6||Ye(this.primaryColor,{h:120}),this.cScale7=this.cScale7||Ye(this.primaryColor,{h:150}),this.cScale8=this.cScale8||Ye(this.primaryColor,{h:210}),this.cScale9=this.cScale9||Ye(this.primaryColor,{h:270}),this.cScale10=this.cScale10||Ye(this.primaryColor,{h:300}),this.cScale11=this.cScale11||Ye(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Er(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Er(this.tertiaryColor,40);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=Er(this["cScale"+e],10),this["cScalePeer"+e]=this["cScalePeer"+e]||Er(this["cScale"+e],25);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||Ye(this["cScale"+e],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||Ye(this.mainBkg,{h:30,s:-30,l:-(5+e*5)}),this["surfacePeer"+e]=this["surfacePeer"+e]||Ye(this.mainBkg,{h:30,s:-30,l:-(8+e*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||dr(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||dr(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=Ye(this.primaryColor,{h:64}),this.fillType3=Ye(this.secondaryColor,{h:64}),this.fillType4=Ye(this.primaryColor,{h:-64}),this.fillType5=Ye(this.secondaryColor,{h:-64}),this.fillType6=Ye(this.primaryColor,{h:128}),this.fillType7=Ye(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||Ye(this.primaryColor,{l:-30}),this.pie5=this.pie5||Ye(this.secondaryColor,{l:-30}),this.pie6=this.pie6||Ye(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||Ye(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||Ye(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||Ye(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||Ye(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||Ye(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||Ye(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||Ye(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||Ye(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||Ye(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||Ye(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||Ye(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||Ye(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||pf(this.quadrant1Fill)?dr(this.quadrant1Fill):Er(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:this.radar?.axisColor||this.lineColor,axisStrokeWidth:this.radar?.axisStrokeWidth||2,axisLabelFontSize:this.radar?.axisLabelFontSize||12,curveOpacity:this.radar?.curveOpacity||.5,curveStrokeWidth:this.radar?.curveStrokeWidth||2,graticuleColor:this.radar?.graticuleColor||"#DEDEDE",graticuleStrokeWidth:this.radar?.graticuleStrokeWidth||1,graticuleOpacity:this.radar?.graticuleOpacity||.3,legendBoxSize:this.radar?.legendBoxSize||12,legendFontSize:this.radar?.legendFontSize||12},this.xyChart={backgroundColor:this.xyChart?.backgroundColor||this.background,titleColor:this.xyChart?.titleColor||this.primaryTextColor,xAxisTitleColor:this.xyChart?.xAxisTitleColor||this.primaryTextColor,xAxisLabelColor:this.xyChart?.xAxisLabelColor||this.primaryTextColor,xAxisTickColor:this.xyChart?.xAxisTickColor||this.primaryTextColor,xAxisLineColor:this.xyChart?.xAxisLineColor||this.primaryTextColor,yAxisTitleColor:this.xyChart?.yAxisTitleColor||this.primaryTextColor,yAxisLabelColor:this.xyChart?.yAxisLabelColor||this.primaryTextColor,yAxisTickColor:this.xyChart?.yAxisTickColor||this.primaryTextColor,yAxisLineColor:this.xyChart?.yAxisLineColor||this.primaryTextColor,plotColorPalette:this.xyChart?.plotColorPalette||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||Ye(this.primaryColor,{h:-30}),this.git4=this.git4||Ye(this.primaryColor,{h:-60}),this.git5=this.git5||Ye(this.primaryColor,{h:-90}),this.git6=this.git6||Ye(this.primaryColor,{h:60}),this.git7=this.git7||Ye(this.primaryColor,{h:120}),this.darkMode?(this.git0=dr(this.git0,25),this.git1=dr(this.git1,25),this.git2=dr(this.git2,25),this.git3=dr(this.git3,25),this.git4=dr(this.git4,25),this.git5=dr(this.git5,25),this.git6=dr(this.git6,25),this.git7=dr(this.git7,25)):(this.git0=Er(this.git0,25),this.git1=Er(this.git1,25),this.git2=Er(this.git2,25),this.git3=Er(this.git3,25),this.git4=Er(this.git4,25),this.git5=Er(this.git5,25),this.git6=Er(this.git6,25),this.git7=Er(this.git7,25)),this.gitInv0=this.gitInv0||Jt(this.git0),this.gitInv1=this.gitInv1||Jt(this.git1),this.gitInv2=this.gitInv2||Jt(this.git2),this.gitInv3=this.gitInv3||Jt(this.git3),this.gitInv4=this.gitInv4||Jt(this.git4),this.gitInv5=this.gitInv5||Jt(this.git5),this.gitInv6=this.gitInv6||Jt(this.git6),this.gitInv7=this.gitInv7||Jt(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||Jt(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||Jt(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Qy,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ky}calculate(e){if(typeof e!="object"){this.updateColors();return}const r=Object.keys(e);r.forEach(n=>{this[n]=e[n]}),this.updateColors(),r.forEach(n=>{this[n]=e[n]})}},L(ih,"Theme"),ih),Jne=L(t=>{const e=new Xne;return e.calculate(t),e},"getThemeVariables"),oh,Zne=(oh=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=dr(this.contrast,55),this.background="#ffffff",this.tertiaryColor=Ye(this.primaryColor,{h:-160}),this.primaryBorderColor=Ds(this.primaryColor,this.darkMode),this.secondaryBorderColor=Ds(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Ds(this.tertiaryColor,this.darkMode),this.primaryTextColor=Jt(this.primaryColor),this.secondaryTextColor=Jt(this.secondaryColor),this.tertiaryTextColor=Jt(this.tertiaryColor),this.lineColor=Jt(this.background),this.textColor=Jt(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.vertLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||dr(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){this.secondBkg=dr(this.contrast,55),this.border2=this.contrast,this.actorBorder=dr(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||Jt(this["cScale"+e]);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this.darkMode?this["cScalePeer"+e]=this["cScalePeer"+e]||dr(this["cScale"+e],10):this["cScalePeer"+e]=this["cScalePeer"+e]||Er(this["cScale"+e],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||Ye(this.mainBkg,{l:-(5+e*5)}),this["surfacePeer"+e]=this["surfacePeer"+e]||Ye(this.mainBkg,{l:-(8+e*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=dr(this.contrast,30),this.sectionBkgColor2=dr(this.contrast,30),this.taskBorderColor=Er(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=dr(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Er(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.vertLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=Ye(this.primaryColor,{h:64}),this.fillType3=Ye(this.secondaryColor,{h:64}),this.fillType4=Ye(this.primaryColor,{h:-64}),this.fillType5=Ye(this.secondaryColor,{h:-64}),this.fillType6=Ye(this.primaryColor,{h:128}),this.fillType7=Ye(this.secondaryColor,{h:128});for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["pie"+e]=this["cScale"+e];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||Ye(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||Ye(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||Ye(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||Ye(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||Ye(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||Ye(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||pf(this.quadrant1Fill)?dr(this.quadrant1Fill):Er(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:this.xyChart?.backgroundColor||this.background,titleColor:this.xyChart?.titleColor||this.primaryTextColor,xAxisTitleColor:this.xyChart?.xAxisTitleColor||this.primaryTextColor,xAxisLabelColor:this.xyChart?.xAxisLabelColor||this.primaryTextColor,xAxisTickColor:this.xyChart?.xAxisTickColor||this.primaryTextColor,xAxisLineColor:this.xyChart?.xAxisLineColor||this.primaryTextColor,yAxisTitleColor:this.xyChart?.yAxisTitleColor||this.primaryTextColor,yAxisLabelColor:this.xyChart?.yAxisLabelColor||this.primaryTextColor,yAxisTickColor:this.xyChart?.yAxisTickColor||this.primaryTextColor,yAxisLineColor:this.xyChart?.yAxisLineColor||this.primaryTextColor,plotColorPalette:this.xyChart?.plotColorPalette||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:this.radar?.axisColor||this.lineColor,axisStrokeWidth:this.radar?.axisStrokeWidth||2,axisLabelFontSize:this.radar?.axisLabelFontSize||12,curveOpacity:this.radar?.curveOpacity||.5,curveStrokeWidth:this.radar?.curveStrokeWidth||2,graticuleColor:this.radar?.graticuleColor||"#DEDEDE",graticuleStrokeWidth:this.radar?.graticuleStrokeWidth||1,graticuleOpacity:this.radar?.graticuleOpacity||.3,legendBoxSize:this.radar?.legendBoxSize||12,legendFontSize:this.radar?.legendFontSize||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Er(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||Ye(this.primaryColor,{h:-30}),this.git4=this.pie5||Ye(this.primaryColor,{h:-60}),this.git5=this.pie6||Ye(this.primaryColor,{h:-90}),this.git6=this.pie7||Ye(this.primaryColor,{h:60}),this.git7=this.pie8||Ye(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||Jt(this.git0),this.gitInv1=this.gitInv1||Jt(this.git1),this.gitInv2=this.gitInv2||Jt(this.git2),this.gitInv3=this.gitInv3||Jt(this.git3),this.gitInv4=this.gitInv4||Jt(this.git4),this.gitInv5=this.gitInv5||Jt(this.git5),this.gitInv6=this.gitInv6||Jt(this.git6),this.gitInv7=this.gitInv7||Jt(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Qy,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ky}calculate(e){if(typeof e!="object"){this.updateColors();return}const r=Object.keys(e);r.forEach(n=>{this[n]=e[n]}),this.updateColors(),r.forEach(n=>{this[n]=e[n]})}},L(oh,"Theme"),oh),eae=L(t=>{const e=new Zne;return e.calculate(t),e},"getThemeVariables"),Il={base:{getThemeVariables:Vne},dark:{getThemeVariables:Yne},default:{getThemeVariables:Kne},forest:{getThemeVariables:Jne},neutral:{getThemeVariables:eae}},Oo={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200,inheritDir:!1},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,maxLabelWidth:360,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],titleColor:"",titleFontFamily:'"trebuchet ms", verdana, arial, sans-serif',titleFontSize:"4ex"},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showDataLabel:!1,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200,layoutAlgorithm:"cose-bilkent"},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},aL={...Oo,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF",forceNodeModelOrder:!1,considerModelOrder:"NODES_AND_EDGES"},themeCSS:void 0,themeVariables:Il.default.getThemeVariables(),sequence:{...Oo.sequence,messageFont:L(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:L(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:L(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{...Oo.gantt,tickInterval:void 0,useWidth:void 0},c4:{...Oo.c4,useWidth:void 0,personFont:L(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),flowchart:{...Oo.flowchart,inheritDir:!1},external_personFont:L(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:L(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:L(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:L(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:L(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:L(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:L(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:L(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:L(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:L(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:L(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:L(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:L(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:L(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:L(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:L(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:L(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:L(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:L(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:L(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:L(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{...Oo.pie,useWidth:984},xyChart:{...Oo.xyChart,useWidth:void 0},requirement:{...Oo.requirement,useWidth:void 0},packet:{...Oo.packet},radar:{...Oo.radar},treemap:{useMaxWidth:!0,padding:10,diagramPadding:8,showValues:!0,nodeWidth:100,nodeHeight:40,borderWidth:1,valueFontSize:12,labelFontSize:14,valueFormat:","}},sL=L((t,e="")=>Object.keys(t).reduce((r,n)=>Array.isArray(t[n])?r:typeof t[n]=="object"&&t[n]!==null?[...r,e+n,...sL(t[n],"")]:[...r,e+n],[]),"keyify"),tae=new Set(sL(aL,"")),iL=aL,G0=L(t=>{if(wt.debug("sanitizeDirective called with",t),!(typeof t!="object"||t==null)){if(Array.isArray(t)){t.forEach(e=>G0(e));return}for(const e of Object.keys(t)){if(wt.debug("Checking key",e),e.startsWith("__")||e.includes("proto")||e.includes("constr")||!tae.has(e)||t[e]==null){wt.debug("sanitize deleting key: ",e),delete t[e];continue}if(typeof t[e]=="object"){wt.debug("sanitizing object",e),G0(t[e]);continue}const r=["themeCSS","fontFamily","altFontFamily"];for(const n of r)e.includes(n)&&(wt.debug("sanitizing css option",e),t[e]=rae(t[e]))}if(t.themeVariables)for(const e of Object.keys(t.themeVariables)){const r=t.themeVariables[e];r?.match&&!r.match(/^[\d "#%(),.;A-Za-z]+$/)&&(t.themeVariables[e]="")}wt.debug("After sanitization",t)}},"sanitizeDirective"),rae=L(t=>{let e=0,r=0;for(const n of t){if(e<r)return"{ /* ERROR: Unbalanced CSS */ }";n==="{"?e++:n==="}"&&r++}return e!==r?"{ /* ERROR: Unbalanced CSS */ }":t},"sanitizeCss"),fh=Object.freeze(iL),ai=Ga({},fh),V0,Du=[],kg=Ga({},fh),Xy=L((t,e)=>{let r=Ga({},t),n={};for(const a of e)cL(a),n=Ga(n,a);if(r=Ga(r,n),n.theme&&n.theme in Il){const a=Ga({},V0),s=Ga(a.themeVariables||{},n.themeVariables);r.theme&&r.theme in Il&&(r.themeVariables=Il[r.theme].getThemeVariables(s))}return kg=r,uL(kg),kg},"updateCurrentConfig"),nae=L(t=>(ai=Ga({},fh),ai=Ga(ai,t),t.theme&&Il[t.theme]&&(ai.themeVariables=Il[t.theme].getThemeVariables(t.themeVariables)),Xy(ai,Du),ai),"setSiteConfig"),aae=L(t=>{V0=Ga({},t)},"saveConfigFromInitialize"),sae=L(t=>(ai=Ga(ai,t),Xy(ai,Du),ai),"updateSiteConfig"),oL=L(()=>Ga({},ai),"getSiteConfig"),lL=L(t=>(uL(t),Ga(kg,t),bs()),"setConfig"),bs=L(()=>Ga({},kg),"getConfig"),cL=L(t=>{t&&(["secure",...ai.secure??[]].forEach(e=>{Object.hasOwn(t,e)&&(wt.debug(`Denied attempt to modify a secure key ${e}`,t[e]),delete t[e])}),Object.keys(t).forEach(e=>{e.startsWith("__")&&delete t[e]}),Object.keys(t).forEach(e=>{typeof t[e]=="string"&&(t[e].includes("<")||t[e].includes(">")||t[e].includes("url(data:"))&&delete t[e],typeof t[e]=="object"&&cL(t[e])}))},"sanitize"),iae=L(t=>{G0(t),t.fontFamily&&!t.themeVariables?.fontFamily&&(t.themeVariables={...t.themeVariables,fontFamily:t.fontFamily}),Du.push(t),Xy(ai,Du)},"addDirective"),W0=L((t=ai)=>{Du=[],Xy(t,Du)},"reset"),oae={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},iN={},lae=L(t=>{iN[t]||(wt.warn(oae[t]),iN[t]=!0)},"issueWarning"),uL=L(t=>{t&&(t.lazyLoadedDiagrams||t.loadExternalDiagramsAtStartup)&&lae("LAZY_LOAD_DEPRECATED")},"checkConfig"),qxe=L(()=>{let t={};V0&&(t=Ga(t,V0));for(const e of Du)t=Ga(t,e);return t},"getUserDefinedConfig"),gf=/<br\s*\/?>/gi,cae=L(t=>t?pL(t).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),uae=(()=>{let t=!1;return()=>{t||(dL(),t=!0)}})();function dL(){const t="data-temp-href-target";gh.addHook("beforeSanitizeAttributes",e=>{e.tagName==="A"&&e.hasAttribute("target")&&e.setAttribute(t,e.getAttribute("target")??"")}),gh.addHook("afterSanitizeAttributes",e=>{e.tagName==="A"&&e.hasAttribute(t)&&(e.setAttribute("target",e.getAttribute(t)??""),e.removeAttribute(t),e.getAttribute("target")==="_blank"&&e.setAttribute("rel","noopener"))})}L(dL,"setupDompurifyHooks");var hL=L(t=>(uae(),gh.sanitize(t)),"removeScript"),oN=L((t,e)=>{if(e.flowchart?.htmlLabels!==!1){const r=e.securityLevel;r==="antiscript"||r==="strict"?t=hL(t):r!=="loose"&&(t=pL(t),t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"),t=t.replace(/=/g,"&equals;"),t=gae(t))}return t},"sanitizeMore"),Qi=L((t,e)=>t&&(e.dompurifyConfig?t=gh.sanitize(oN(t,e),e.dompurifyConfig).toString():t=gh.sanitize(oN(t,e),{FORBID_TAGS:["style"]}).toString(),t),"sanitizeText"),dae=L((t,e)=>typeof t=="string"?Qi(t,e):t.flat().map(r=>Qi(r,e)),"sanitizeTextOrArray"),hae=L(t=>gf.test(t),"hasBreaks"),pae=L(t=>t.split(gf),"splitBreaks"),gae=L(t=>t.replace(/#br#/g,"<br/>"),"placeholderToBreak"),pL=L(t=>t.replace(gf,"#br#"),"breakToPlaceholder"),fae=L(t=>{let e="";return t&&(e=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,e=CSS.escape(e)),e},"getUrl"),Wa=L(t=>!(t===!1||["false","null","0"].includes(String(t).trim().toLowerCase())),"evaluate"),mae=L(function(...t){const e=t.filter(r=>!isNaN(r));return Math.max(...e)},"getMax"),yae=L(function(...t){const e=t.filter(r=>!isNaN(r));return Math.min(...e)},"getMin"),lN=L(function(t){const e=t.split(/(,)/),r=[];for(let n=0;n<e.length;n++){let a=e[n];if(a===","&&n>0&&n+1<e.length){const s=e[n-1],i=e[n+1];bae(s,i)&&(a=s+","+i,n++,r.pop())}r.push(xae(a))}return r.join("")},"parseGenericTypes"),v1=L((t,e)=>Math.max(0,t.split(e).length-1),"countOccurrence"),bae=L((t,e)=>{const r=v1(t,"~"),n=v1(e,"~");return r===1&&n===1},"shouldCombineSets"),xae=L(t=>{const e=v1(t,"~");let r=!1;if(e<=1)return t;e%2!==0&&t.startsWith("~")&&(t=t.substring(1),r=!0);const n=[...t];let a=n.indexOf("~"),s=n.lastIndexOf("~");for(;a!==-1&&s!==-1&&a!==s;)n[a]="<",n[s]=">",a=n.indexOf("~"),s=n.lastIndexOf("~");return r&&n.unshift("~"),n.join("")},"processSet"),cN=L(()=>window.MathMLElement!==void 0,"isMathMLSupported"),w1=/\$\$(.*)\$\$/g,mh=L(t=>(t.match(w1)?.length??0)>0,"hasKatex"),Hxe=L(async(t,e)=>{const r=document.createElement("div");r.innerHTML=await rk(t,e),r.id="katex-temp",r.style.visibility="hidden",r.style.position="absolute",r.style.top="0",document.querySelector("body")?.insertAdjacentElement("beforeend",r);const a={width:r.clientWidth,height:r.clientHeight};return r.remove(),a},"calculateMathMLDimensions"),vae=L(async(t,e)=>{if(!mh(t))return t;if(!(cN()||e.legacyMathML||e.forceLegacyMathML))return t.replace(w1,"MathML is unsupported in this environment.");{const{default:r}=await Zt(async()=>{const{default:a}=await import("./katex-qrhCpa0F.js");return{default:a}},[]),n=e.forceLegacyMathML||!cN()&&e.legacyMathML?"htmlAndMathml":"mathml";return t.split(gf).map(a=>mh(a)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${a}</div>`:`<div>${a}</div>`).join("").replace(w1,(a,s)=>r.renderToString(s,{throwOnError:!0,displayMode:!0,output:n}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))}},"renderKatexUnsanitized"),rk=L(async(t,e)=>Qi(await vae(t,e),e),"renderKatexSanitized"),Dh={getRows:cae,sanitizeText:Qi,sanitizeTextOrArray:dae,hasBreaks:hae,splitBreaks:pae,lineBreakRegex:gf,removeScript:hL,getUrl:fae,evaluate:Wa,getMax:mae,getMin:yae},wae=L(function(t,e){for(let r of e)t.attr(r[0],r[1])},"d3Attrs"),Sae=L(function(t,e,r){let n=new Map;return r?(n.set("width","100%"),n.set("style",`max-width: ${e}px;`)):(n.set("height",t),n.set("width",e)),n},"calculateSvgSizeAttrs"),gL=L(function(t,e,r,n){const a=Sae(e,r,n);wae(t,a)},"configureSvgSize"),kae=L(function(t,e,r,n){const a=e.node().getBBox(),s=a.width,i=a.height;wt.info(`SVG bounds: ${s}x${i}`,a);let l=0,c=0;wt.info(`Graph bounds: ${l}x${c}`,t),l=s+r*2,c=i+r*2,wt.info(`Calculated bounds: ${l}x${c}`),gL(e,c,l,n);const d=`${a.x-r} ${a.y-r} ${a.width+2*r} ${a.height+2*r}`;e.attr("viewBox",d)},"setupGraphViewbox"),d0={},Tae=L((t,e,r)=>{let n="";return t in d0&&d0[t]?n=d0[t](r):wt.warn(`No theme found for ${t}`),` & {
    font-family: ${r.fontFamily};
    font-size: ${r.fontSize};
    fill: ${r.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${r.errorBkgColor};
  }
  & .error-text {
    fill: ${r.errorTextColor};
    stroke: ${r.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${r.lineColor};
    stroke: ${r.lineColor};
  }
  & .marker.cross {
    stroke: ${r.lineColor};
  }

  & svg {
    font-family: ${r.fontFamily};
    font-size: ${r.fontSize};
  }
   & p {
    margin: 0
   }

  ${n}

  ${e}
`},"getStyles"),Cae=L((t,e)=>{e!==void 0&&(d0[t]=e)},"addStylesForDiagram"),Eae=Tae,fL={};gne(fL,{clear:()=>_ae,getAccDescription:()=>Iae,getAccTitle:()=>Nae,getDiagramTitle:()=>Dae,setAccDescription:()=>Pae,setAccTitle:()=>Aae,setDiagramTitle:()=>Rae});var nk="",ak="",sk="",ik=L(t=>Qi(t,bs()),"sanitizeText"),_ae=L(()=>{nk="",sk="",ak=""},"clear"),Aae=L(t=>{nk=ik(t).replace(/^\s+/g,"")},"setAccTitle"),Nae=L(()=>nk,"getAccTitle"),Pae=L(t=>{sk=ik(t).replace(/\n\s+/g,`
`)},"setAccDescription"),Iae=L(()=>sk,"getAccDescription"),Rae=L(t=>{ak=ik(t)},"setDiagramTitle"),Dae=L(()=>ak,"getDiagramTitle"),uN=wt,Lae=ek,In=bs,Gxe=lL,Vxe=fh,ok=L(t=>Qi(t,In()),"sanitizeText"),Mae=kae,Oae=L(()=>fL,"getCommonDb"),Y0={},Q0=L((t,e,r)=>{Y0[t]&&uN.warn(`Diagram with id ${t} already registered. Overwriting.`),Y0[t]=e,r&&nL(t,r),Cae(t,e.styles),e.injectUtils?.(uN,Lae,In,ok,Mae,Oae(),()=>{})},"registerDiagram"),S1=L(t=>{if(t in Y0)return Y0[t];throw new jae(t)},"getDiagram"),lh,jae=(lh=class extends Error{constructor(e){super(`Diagram ${e} not found.`)}},L(lh,"DiagramNotFoundError"),lh),Bae={value:()=>{}};function mL(){for(var t=0,e=arguments.length,r={},n;t<e;++t){if(!(n=arguments[t]+"")||n in r||/[\s.]/.test(n))throw new Error("illegal type: "+n);r[n]=[]}return new h0(r)}function h0(t){this._=t}function Fae(t,e){return t.trim().split(/^|\s+/).map(function(r){var n="",a=r.indexOf(".");if(a>=0&&(n=r.slice(a+1),r=r.slice(0,a)),r&&!e.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:n}})}h0.prototype=mL.prototype={constructor:h0,on:function(t,e){var r=this._,n=Fae(t+"",r),a,s=-1,i=n.length;if(arguments.length<2){for(;++s<i;)if((a=(t=n[s]).type)&&(a=zae(r[a],t.name)))return a;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<i;)if(a=(t=n[s]).type)r[a]=dN(r[a],t.name,e);else if(e==null)for(a in r)r[a]=dN(r[a],t.name,null);return this},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new h0(t)},call:function(t,e){if((a=arguments.length-2)>0)for(var r=new Array(a),n=0,a,s;n<a;++n)r[n]=arguments[n+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],n=0,a=s.length;n<a;++n)s[n].value.apply(e,r)},apply:function(t,e,r){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var n=this._[t],a=0,s=n.length;a<s;++a)n[a].value.apply(e,r)}};function zae(t,e){for(var r=0,n=t.length,a;r<n;++r)if((a=t[r]).name===e)return a.value}function dN(t,e,r){for(var n=0,a=t.length;n<a;++n)if(t[n].name===e){t[n]=Bae,t=t.slice(0,n).concat(t.slice(n+1));break}return r!=null&&t.push({name:e,value:r}),t}var k1="http://www.w3.org/1999/xhtml";const hN={svg:"http://www.w3.org/2000/svg",xhtml:k1,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jy(t){var e=t+="",r=e.indexOf(":");return r>=0&&(e=t.slice(0,r))!=="xmlns"&&(t=t.slice(r+1)),hN.hasOwnProperty(e)?{space:hN[e],local:t}:t}function $ae(t){return function(){var e=this.ownerDocument,r=this.namespaceURI;return r===k1&&e.documentElement.namespaceURI===k1?e.createElement(t):e.createElementNS(r,t)}}function Uae(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function yL(t){var e=Jy(t);return(e.local?Uae:$ae)(e)}function qae(){}function lk(t){return t==null?qae:function(){return this.querySelector(t)}}function Hae(t){typeof t!="function"&&(t=lk(t));for(var e=this._groups,r=e.length,n=new Array(r),a=0;a<r;++a)for(var s=e[a],i=s.length,l=n[a]=new Array(i),c,d,p=0;p<i;++p)(c=s[p])&&(d=t.call(c,c.__data__,p,s))&&("__data__"in c&&(d.__data__=c.__data__),l[p]=d);return new Ni(n,this._parents)}function Gae(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Vae(){return[]}function bL(t){return t==null?Vae:function(){return this.querySelectorAll(t)}}function Wae(t){return function(){return Gae(t.apply(this,arguments))}}function Yae(t){typeof t=="function"?t=Wae(t):t=bL(t);for(var e=this._groups,r=e.length,n=[],a=[],s=0;s<r;++s)for(var i=e[s],l=i.length,c,d=0;d<l;++d)(c=i[d])&&(n.push(t.call(c,c.__data__,d,i)),a.push(c));return new Ni(n,a)}function xL(t){return function(){return this.matches(t)}}function vL(t){return function(e){return e.matches(t)}}var Qae=Array.prototype.find;function Kae(t){return function(){return Qae.call(this.children,t)}}function Xae(){return this.firstElementChild}function Jae(t){return this.select(t==null?Xae:Kae(typeof t=="function"?t:vL(t)))}var Zae=Array.prototype.filter;function ese(){return Array.from(this.children)}function tse(t){return function(){return Zae.call(this.children,t)}}function rse(t){return this.selectAll(t==null?ese:tse(typeof t=="function"?t:vL(t)))}function nse(t){typeof t!="function"&&(t=xL(t));for(var e=this._groups,r=e.length,n=new Array(r),a=0;a<r;++a)for(var s=e[a],i=s.length,l=n[a]=[],c,d=0;d<i;++d)(c=s[d])&&t.call(c,c.__data__,d,s)&&l.push(c);return new Ni(n,this._parents)}function wL(t){return new Array(t.length)}function ase(){return new Ni(this._enter||this._groups.map(wL),this._parents)}function K0(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}K0.prototype={constructor:K0,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function sse(t){return function(){return t}}function ise(t,e,r,n,a,s){for(var i=0,l,c=e.length,d=s.length;i<d;++i)(l=e[i])?(l.__data__=s[i],n[i]=l):r[i]=new K0(t,s[i]);for(;i<c;++i)(l=e[i])&&(a[i]=l)}function ose(t,e,r,n,a,s,i){var l,c,d=new Map,p=e.length,g=s.length,m=new Array(p),y;for(l=0;l<p;++l)(c=e[l])&&(m[l]=y=i.call(c,c.__data__,l,e)+"",d.has(y)?a[l]=c:d.set(y,c));for(l=0;l<g;++l)y=i.call(t,s[l],l,s)+"",(c=d.get(y))?(n[l]=c,c.__data__=s[l],d.delete(y)):r[l]=new K0(t,s[l]);for(l=0;l<p;++l)(c=e[l])&&d.get(m[l])===c&&(a[l]=c)}function lse(t){return t.__data__}function cse(t,e){if(!arguments.length)return Array.from(this,lse);var r=e?ose:ise,n=this._parents,a=this._groups;typeof t!="function"&&(t=sse(t));for(var s=a.length,i=new Array(s),l=new Array(s),c=new Array(s),d=0;d<s;++d){var p=n[d],g=a[d],m=g.length,y=use(t.call(p,p&&p.__data__,d,n)),x=y.length,w=l[d]=new Array(x),T=i[d]=new Array(x),k=c[d]=new Array(m);r(p,g,w,T,k,y,e);for(var _=0,P=0,F,D;_<x;++_)if(F=w[_]){for(_>=P&&(P=_+1);!(D=T[P])&&++P<x;);F._next=D||null}}return i=new Ni(i,n),i._enter=l,i._exit=c,i}function use(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function dse(){return new Ni(this._exit||this._groups.map(wL),this._parents)}function hse(t,e,r){var n=this.enter(),a=this,s=this.exit();return typeof t=="function"?(n=t(n),n&&(n=n.selection())):n=n.append(t+""),e!=null&&(a=e(a),a&&(a=a.selection())),r==null?s.remove():r(s),n&&a?n.merge(a).order():a}function pse(t){for(var e=t.selection?t.selection():t,r=this._groups,n=e._groups,a=r.length,s=n.length,i=Math.min(a,s),l=new Array(a),c=0;c<i;++c)for(var d=r[c],p=n[c],g=d.length,m=l[c]=new Array(g),y,x=0;x<g;++x)(y=d[x]||p[x])&&(m[x]=y);for(;c<a;++c)l[c]=r[c];return new Ni(l,this._parents)}function gse(){for(var t=this._groups,e=-1,r=t.length;++e<r;)for(var n=t[e],a=n.length-1,s=n[a],i;--a>=0;)(i=n[a])&&(s&&i.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(i,s),s=i);return this}function fse(t){t||(t=mse);function e(g,m){return g&&m?t(g.__data__,m.__data__):!g-!m}for(var r=this._groups,n=r.length,a=new Array(n),s=0;s<n;++s){for(var i=r[s],l=i.length,c=a[s]=new Array(l),d,p=0;p<l;++p)(d=i[p])&&(c[p]=d);c.sort(e)}return new Ni(a,this._parents).order()}function mse(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function yse(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function bse(){return Array.from(this)}function xse(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],a=0,s=n.length;a<s;++a){var i=n[a];if(i)return i}return null}function vse(){let t=0;for(const e of this)++t;return t}function wse(){return!this.node()}function Sse(t){for(var e=this._groups,r=0,n=e.length;r<n;++r)for(var a=e[r],s=0,i=a.length,l;s<i;++s)(l=a[s])&&t.call(l,l.__data__,s,a);return this}function kse(t){return function(){this.removeAttribute(t)}}function Tse(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Cse(t,e){return function(){this.setAttribute(t,e)}}function Ese(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _se(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttribute(t):this.setAttribute(t,r)}}function Ase(t,e){return function(){var r=e.apply(this,arguments);r==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}}function Nse(t,e){var r=Jy(t);if(arguments.length<2){var n=this.node();return r.local?n.getAttributeNS(r.space,r.local):n.getAttribute(r)}return this.each((e==null?r.local?Tse:kse:typeof e=="function"?r.local?Ase:_se:r.local?Ese:Cse)(r,e))}function SL(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Pse(t){return function(){this.style.removeProperty(t)}}function Ise(t,e,r){return function(){this.style.setProperty(t,e,r)}}function Rse(t,e,r){return function(){var n=e.apply(this,arguments);n==null?this.style.removeProperty(t):this.style.setProperty(t,n,r)}}function Dse(t,e,r){return arguments.length>1?this.each((e==null?Pse:typeof e=="function"?Rse:Ise)(t,e,r??"")):yh(this.node(),t)}function yh(t,e){return t.style.getPropertyValue(e)||SL(t).getComputedStyle(t,null).getPropertyValue(e)}function Lse(t){return function(){delete this[t]}}function Mse(t,e){return function(){this[t]=e}}function Ose(t,e){return function(){var r=e.apply(this,arguments);r==null?delete this[t]:this[t]=r}}function jse(t,e){return arguments.length>1?this.each((e==null?Lse:typeof e=="function"?Ose:Mse)(t,e)):this.node()[t]}function kL(t){return t.trim().split(/^|\s+/)}function ck(t){return t.classList||new TL(t)}function TL(t){this._node=t,this._names=kL(t.getAttribute("class")||"")}TL.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function CL(t,e){for(var r=ck(t),n=-1,a=e.length;++n<a;)r.add(e[n])}function EL(t,e){for(var r=ck(t),n=-1,a=e.length;++n<a;)r.remove(e[n])}function Bse(t){return function(){CL(this,t)}}function Fse(t){return function(){EL(this,t)}}function zse(t,e){return function(){(e.apply(this,arguments)?CL:EL)(this,t)}}function $se(t,e){var r=kL(t+"");if(arguments.length<2){for(var n=ck(this.node()),a=-1,s=r.length;++a<s;)if(!n.contains(r[a]))return!1;return!0}return this.each((typeof e=="function"?zse:e?Bse:Fse)(r,e))}function Use(){this.textContent=""}function qse(t){return function(){this.textContent=t}}function Hse(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Gse(t){return arguments.length?this.each(t==null?Use:(typeof t=="function"?Hse:qse)(t)):this.node().textContent}function Vse(){this.innerHTML=""}function Wse(t){return function(){this.innerHTML=t}}function Yse(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Qse(t){return arguments.length?this.each(t==null?Vse:(typeof t=="function"?Yse:Wse)(t)):this.node().innerHTML}function Kse(){this.nextSibling&&this.parentNode.appendChild(this)}function Xse(){return this.each(Kse)}function Jse(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Zse(){return this.each(Jse)}function eie(t){var e=typeof t=="function"?t:yL(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function tie(){return null}function rie(t,e){var r=typeof t=="function"?t:yL(t),n=e==null?tie:typeof e=="function"?e:lk(e);return this.select(function(){return this.insertBefore(r.apply(this,arguments),n.apply(this,arguments)||null)})}function nie(){var t=this.parentNode;t&&t.removeChild(this)}function aie(){return this.each(nie)}function sie(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function iie(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function oie(t){return this.select(t?iie:sie)}function lie(t){return arguments.length?this.property("__data__",t):this.node().__data__}function cie(t){return function(e){t.call(this,e,this.__data__)}}function uie(t){return t.trim().split(/^|\s+/).map(function(e){var r="",n=e.indexOf(".");return n>=0&&(r=e.slice(n+1),e=e.slice(0,n)),{type:e,name:r}})}function die(t){return function(){var e=this.__on;if(e){for(var r=0,n=-1,a=e.length,s;r<a;++r)s=e[r],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++n]=s;++n?e.length=n:delete this.__on}}}function hie(t,e,r){return function(){var n=this.__on,a,s=cie(e);if(n){for(var i=0,l=n.length;i<l;++i)if((a=n[i]).type===t.type&&a.name===t.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=s,a.options=r),a.value=e;return}}this.addEventListener(t.type,s,r),a={type:t.type,name:t.name,value:e,listener:s,options:r},n?n.push(a):this.__on=[a]}}function pie(t,e,r){var n=uie(t+""),a,s=n.length,i;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,d=l.length,p;c<d;++c)for(a=0,p=l[c];a<s;++a)if((i=n[a]).type===p.type&&i.name===p.name)return p.value}return}for(l=e?hie:die,a=0;a<s;++a)this.each(l(n[a],e,r));return this}function _L(t,e,r){var n=SL(t),a=n.CustomEvent;typeof a=="function"?a=new a(e,r):(a=n.document.createEvent("Event"),r?(a.initEvent(e,r.bubbles,r.cancelable),a.detail=r.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function gie(t,e){return function(){return _L(this,t,e)}}function fie(t,e){return function(){return _L(this,t,e.apply(this,arguments))}}function mie(t,e){return this.each((typeof e=="function"?fie:gie)(t,e))}function*yie(){for(var t=this._groups,e=0,r=t.length;e<r;++e)for(var n=t[e],a=0,s=n.length,i;a<s;++a)(i=n[a])&&(yield i)}var AL=[null];function Ni(t,e){this._groups=t,this._parents=e}function ff(){return new Ni([[document.documentElement]],AL)}function bie(){return this}Ni.prototype=ff.prototype={constructor:Ni,select:Hae,selectAll:Yae,selectChild:Jae,selectChildren:rse,filter:nse,data:cse,enter:ase,exit:dse,join:hse,merge:pse,selection:bie,order:gse,sort:fse,call:yse,nodes:bse,node:xse,size:vse,empty:wse,each:Sse,attr:Nse,style:Dse,property:jse,classed:$se,text:Gse,html:Qse,raise:Xse,lower:Zse,append:eie,insert:rie,remove:aie,clone:oie,datum:lie,on:pie,dispatch:mie,[Symbol.iterator]:yie};function wn(t){return typeof t=="string"?new Ni([[document.querySelector(t)]],[document.documentElement]):new Ni([[t]],AL)}function uk(t,e,r){t.prototype=e.prototype=r,r.constructor=t}function NL(t,e){var r=Object.create(t.prototype);for(var n in e)r[n]=e[n];return r}function mf(){}var Og=.7,X0=1/Og,eh="\\s*([+-]?\\d+)\\s*",jg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xie=/^#([0-9a-f]{3,8})$/,vie=new RegExp(`^rgb\\(${eh},${eh},${eh}\\)$`),wie=new RegExp(`^rgb\\(${Yo},${Yo},${Yo}\\)$`),Sie=new RegExp(`^rgba\\(${eh},${eh},${eh},${jg}\\)$`),kie=new RegExp(`^rgba\\(${Yo},${Yo},${Yo},${jg}\\)$`),Tie=new RegExp(`^hsl\\(${jg},${Yo},${Yo}\\)$`),Cie=new RegExp(`^hsla\\(${jg},${Yo},${Yo},${jg}\\)$`),pN={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};uk(mf,Bg,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:gN,formatHex:gN,formatHex8:Eie,formatHsl:_ie,formatRgb:fN,toString:fN});function gN(){return this.rgb().formatHex()}function Eie(){return this.rgb().formatHex8()}function _ie(){return PL(this).formatHsl()}function fN(){return this.rgb().formatRgb()}function Bg(t){var e,r;return t=(t+"").trim().toLowerCase(),(e=xie.exec(t))?(r=e[1].length,e=parseInt(e[1],16),r===6?mN(e):r===3?new ii(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):r===8?$m(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):r===4?$m(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=vie.exec(t))?new ii(e[1],e[2],e[3],1):(e=wie.exec(t))?new ii(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Sie.exec(t))?$m(e[1],e[2],e[3],e[4]):(e=kie.exec(t))?$m(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Tie.exec(t))?xN(e[1],e[2]/100,e[3]/100,1):(e=Cie.exec(t))?xN(e[1],e[2]/100,e[3]/100,e[4]):pN.hasOwnProperty(t)?mN(pN[t]):t==="transparent"?new ii(NaN,NaN,NaN,0):null}function mN(t){return new ii(t>>16&255,t>>8&255,t&255,1)}function $m(t,e,r,n){return n<=0&&(t=e=r=NaN),new ii(t,e,r,n)}function Aie(t){return t instanceof mf||(t=Bg(t)),t?(t=t.rgb(),new ii(t.r,t.g,t.b,t.opacity)):new ii}function T1(t,e,r,n){return arguments.length===1?Aie(t):new ii(t,e,r,n??1)}function ii(t,e,r,n){this.r=+t,this.g=+e,this.b=+r,this.opacity=+n}uk(ii,T1,NL(mf,{brighter(t){return t=t==null?X0:Math.pow(X0,t),new ii(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Og:Math.pow(Og,t),new ii(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new ii(_u(this.r),_u(this.g),_u(this.b),J0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:yN,formatHex:yN,formatHex8:Nie,formatRgb:bN,toString:bN}));function yN(){return`#${vu(this.r)}${vu(this.g)}${vu(this.b)}`}function Nie(){return`#${vu(this.r)}${vu(this.g)}${vu(this.b)}${vu((isNaN(this.opacity)?1:this.opacity)*255)}`}function bN(){const t=J0(this.opacity);return`${t===1?"rgb(":"rgba("}${_u(this.r)}, ${_u(this.g)}, ${_u(this.b)}${t===1?")":`, ${t})`}`}function J0(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function _u(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function vu(t){return t=_u(t),(t<16?"0":"")+t.toString(16)}function xN(t,e,r,n){return n<=0?t=e=r=NaN:r<=0||r>=1?t=e=NaN:e<=0&&(t=NaN),new uo(t,e,r,n)}function PL(t){if(t instanceof uo)return new uo(t.h,t.s,t.l,t.opacity);if(t instanceof mf||(t=Bg(t)),!t)return new uo;if(t instanceof uo)return t;t=t.rgb();var e=t.r/255,r=t.g/255,n=t.b/255,a=Math.min(e,r,n),s=Math.max(e,r,n),i=NaN,l=s-a,c=(s+a)/2;return l?(e===s?i=(r-n)/l+(r<n)*6:r===s?i=(n-e)/l+2:i=(e-r)/l+4,l/=c<.5?s+a:2-s-a,i*=60):l=c>0&&c<1?0:i,new uo(i,l,c,t.opacity)}function Pie(t,e,r,n){return arguments.length===1?PL(t):new uo(t,e,r,n??1)}function uo(t,e,r,n){this.h=+t,this.s=+e,this.l=+r,this.opacity=+n}uk(uo,Pie,NL(mf,{brighter(t){return t=t==null?X0:Math.pow(X0,t),new uo(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Og:Math.pow(Og,t),new uo(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*e,a=2*r-n;return new ii(nw(t>=240?t-240:t+120,a,n),nw(t,a,n),nw(t<120?t+240:t-120,a,n),this.opacity)},clamp(){return new uo(vN(this.h),Um(this.s),Um(this.l),J0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=J0(this.opacity);return`${t===1?"hsl(":"hsla("}${vN(this.h)}, ${Um(this.s)*100}%, ${Um(this.l)*100}%${t===1?")":`, ${t})`}`}}));function vN(t){return t=(t||0)%360,t<0?t+360:t}function Um(t){return Math.max(0,Math.min(1,t||0))}function nw(t,e,r){return(t<60?e+(r-e)*t/60:t<180?r:t<240?e+(r-e)*(240-t)/60:e)*255}const dk=t=>()=>t;function IL(t,e){return function(r){return t+r*e}}function Iie(t,e,r){return t=Math.pow(t,r),e=Math.pow(e,r)-t,r=1/r,function(n){return Math.pow(t+n*e,r)}}function Wxe(t,e){var r=e-t;return r?IL(t,r>180||r<-180?r-360*Math.round(r/360):r):dk(isNaN(t)?e:t)}function Rie(t){return(t=+t)==1?RL:function(e,r){return r-e?Iie(e,r,t):dk(isNaN(e)?r:e)}}function RL(t,e){var r=e-t;return r?IL(t,r):dk(isNaN(t)?e:t)}const wN=(function t(e){var r=Rie(e);function n(a,s){var i=r((a=T1(a)).r,(s=T1(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),d=RL(a.opacity,s.opacity);return function(p){return a.r=i(p),a.g=l(p),a.b=c(p),a.opacity=d(p),a+""}}return n.gamma=t,n})(1);function Tc(t,e){return t=+t,e=+e,function(r){return t*(1-r)+e*r}}var C1=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,aw=new RegExp(C1.source,"g");function Die(t){return function(){return t}}function Lie(t){return function(e){return t(e)+""}}function Mie(t,e){var r=C1.lastIndex=aw.lastIndex=0,n,a,s,i=-1,l=[],c=[];for(t=t+"",e=e+"";(n=C1.exec(t))&&(a=aw.exec(e));)(s=a.index)>r&&(s=e.slice(r,s),l[i]?l[i]+=s:l[++i]=s),(n=n[0])===(a=a[0])?l[i]?l[i]+=a:l[++i]=a:(l[++i]=null,c.push({i,x:Tc(n,a)})),r=aw.lastIndex;return r<e.length&&(s=e.slice(r),l[i]?l[i]+=s:l[++i]=s),l.length<2?c[0]?Lie(c[0].x):Die(e):(e=c.length,function(d){for(var p=0,g;p<e;++p)l[(g=c[p]).i]=g.x(d);return l.join("")})}var SN=180/Math.PI,E1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function DL(t,e,r,n,a,s){var i,l,c;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(c=t*r+e*n)&&(r-=t*c,n-=e*c),(l=Math.sqrt(r*r+n*n))&&(r/=l,n/=l,c/=l),t*n<e*r&&(t=-t,e=-e,c=-c,i=-i),{translateX:a,translateY:s,rotate:Math.atan2(e,t)*SN,skewX:Math.atan(c)*SN,scaleX:i,scaleY:l}}var qm;function Oie(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?E1:DL(e.a,e.b,e.c,e.d,e.e,e.f)}function jie(t){return t==null||(qm||(qm=document.createElementNS("http://www.w3.org/2000/svg","g")),qm.setAttribute("transform",t),!(t=qm.transform.baseVal.consolidate()))?E1:(t=t.matrix,DL(t.a,t.b,t.c,t.d,t.e,t.f))}function LL(t,e,r,n){function a(d){return d.length?d.pop()+" ":""}function s(d,p,g,m,y,x){if(d!==g||p!==m){var w=y.push("translate(",null,e,null,r);x.push({i:w-4,x:Tc(d,g)},{i:w-2,x:Tc(p,m)})}else(g||m)&&y.push("translate("+g+e+m+r)}function i(d,p,g,m){d!==p?(d-p>180?p+=360:p-d>180&&(d+=360),m.push({i:g.push(a(g)+"rotate(",null,n)-2,x:Tc(d,p)})):p&&g.push(a(g)+"rotate("+p+n)}function l(d,p,g,m){d!==p?m.push({i:g.push(a(g)+"skewX(",null,n)-2,x:Tc(d,p)}):p&&g.push(a(g)+"skewX("+p+n)}function c(d,p,g,m,y,x){if(d!==g||p!==m){var w=y.push(a(y)+"scale(",null,",",null,")");x.push({i:w-4,x:Tc(d,g)},{i:w-2,x:Tc(p,m)})}else(g!==1||m!==1)&&y.push(a(y)+"scale("+g+","+m+")")}return function(d,p){var g=[],m=[];return d=t(d),p=t(p),s(d.translateX,d.translateY,p.translateX,p.translateY,g,m),i(d.rotate,p.rotate,g,m),l(d.skewX,p.skewX,g,m),c(d.scaleX,d.scaleY,p.scaleX,p.scaleY,g,m),d=p=null,function(y){for(var x=-1,w=m.length,T;++x<w;)g[(T=m[x]).i]=T.x(y);return g.join("")}}}var Bie=LL(Oie,"px, ","px)","deg)"),Fie=LL(jie,", ",")",")"),bh=0,Jp=0,Up=0,ML=1e3,Z0,Zp,ey=0,Lu=0,Zy=0,Fg=typeof performance=="object"&&performance.now?performance:Date,OL=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function hk(){return Lu||(OL(zie),Lu=Fg.now()+Zy)}function zie(){Lu=0}function ty(){this._call=this._time=this._next=null}ty.prototype=jL.prototype={constructor:ty,restart:function(t,e,r){if(typeof t!="function")throw new TypeError("callback is not a function");r=(r==null?hk():+r)+(e==null?0:+e),!this._next&&Zp!==this&&(Zp?Zp._next=this:Z0=this,Zp=this),this._call=t,this._time=r,_1()},stop:function(){this._call&&(this._call=null,this._time=1/0,_1())}};function jL(t,e,r){var n=new ty;return n.restart(t,e,r),n}function $ie(){hk(),++bh;for(var t=Z0,e;t;)(e=Lu-t._time)>=0&&t._call.call(void 0,e),t=t._next;--bh}function kN(){Lu=(ey=Fg.now())+Zy,bh=Jp=0;try{$ie()}finally{bh=0,qie(),Lu=0}}function Uie(){var t=Fg.now(),e=t-ey;e>ML&&(Zy-=e,ey=t)}function qie(){for(var t,e=Z0,r,n=1/0;e;)e._call?(n>e._time&&(n=e._time),t=e,e=e._next):(r=e._next,e._next=null,e=t?t._next=r:Z0=r);Zp=t,_1(n)}function _1(t){if(!bh){Jp&&(Jp=clearTimeout(Jp));var e=t-Lu;e>24?(t<1/0&&(Jp=setTimeout(kN,t-Fg.now()-Zy)),Up&&(Up=clearInterval(Up))):(Up||(ey=Fg.now(),Up=setInterval(Uie,ML)),bh=1,OL(kN))}}function TN(t,e,r){var n=new ty;return e=e==null?0:+e,n.restart(a=>{n.stop(),t(a+e)},e,r),n}var Hie=mL("start","end","cancel","interrupt"),Gie=[],BL=0,CN=1,A1=2,p0=3,EN=4,N1=5,g0=6;function eb(t,e,r,n,a,s){var i=t.__transition;if(!i)t.__transition={};else if(r in i)return;Vie(t,r,{name:e,index:n,group:a,on:Hie,tween:Gie,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:BL})}function pk(t,e){var r=So(t,e);if(r.state>BL)throw new Error("too late; already scheduled");return r}function tl(t,e){var r=So(t,e);if(r.state>p0)throw new Error("too late; already running");return r}function So(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}function Vie(t,e,r){var n=t.__transition,a;n[e]=r,r.timer=jL(s,0,r.time);function s(d){r.state=CN,r.timer.restart(i,r.delay,r.time),r.delay<=d&&i(d-r.delay)}function i(d){var p,g,m,y;if(r.state!==CN)return c();for(p in n)if(y=n[p],y.name===r.name){if(y.state===p0)return TN(i);y.state===EN?(y.state=g0,y.timer.stop(),y.on.call("interrupt",t,t.__data__,y.index,y.group),delete n[p]):+p<e&&(y.state=g0,y.timer.stop(),y.on.call("cancel",t,t.__data__,y.index,y.group),delete n[p])}if(TN(function(){r.state===p0&&(r.state=EN,r.timer.restart(l,r.delay,r.time),l(d))}),r.state=A1,r.on.call("start",t,t.__data__,r.index,r.group),r.state===A1){for(r.state=p0,a=new Array(m=r.tween.length),p=0,g=-1;p<m;++p)(y=r.tween[p].value.call(t,t.__data__,r.index,r.group))&&(a[++g]=y);a.length=g+1}}function l(d){for(var p=d<r.duration?r.ease.call(null,d/r.duration):(r.timer.restart(c),r.state=N1,1),g=-1,m=a.length;++g<m;)a[g].call(t,p);r.state===N1&&(r.on.call("end",t,t.__data__,r.index,r.group),c())}function c(){r.state=g0,r.timer.stop(),delete n[e];for(var d in n)return;delete t.__transition}}function Wie(t,e){var r=t.__transition,n,a,s=!0,i;if(r){e=e==null?null:e+"";for(i in r){if((n=r[i]).name!==e){s=!1;continue}a=n.state>A1&&n.state<N1,n.state=g0,n.timer.stop(),n.on.call(a?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete r[i]}s&&delete t.__transition}}function Yie(t){return this.each(function(){Wie(this,t)})}function Qie(t,e){var r,n;return function(){var a=tl(this,t),s=a.tween;if(s!==r){n=r=s;for(var i=0,l=n.length;i<l;++i)if(n[i].name===e){n=n.slice(),n.splice(i,1);break}}a.tween=n}}function Kie(t,e,r){var n,a;if(typeof r!="function")throw new Error;return function(){var s=tl(this,t),i=s.tween;if(i!==n){a=(n=i).slice();for(var l={name:e,value:r},c=0,d=a.length;c<d;++c)if(a[c].name===e){a[c]=l;break}c===d&&a.push(l)}s.tween=a}}function Xie(t,e){var r=this._id;if(t+="",arguments.length<2){for(var n=So(this.node(),r).tween,a=0,s=n.length,i;a<s;++a)if((i=n[a]).name===t)return i.value;return null}return this.each((e==null?Qie:Kie)(r,t,e))}function gk(t,e,r){var n=t._id;return t.each(function(){var a=tl(this,n);(a.value||(a.value={}))[e]=r.apply(this,arguments)}),function(a){return So(a,n).value[e]}}function FL(t,e){var r;return(typeof e=="number"?Tc:e instanceof Bg?wN:(r=Bg(e))?(e=r,wN):Mie)(t,e)}function Jie(t){return function(){this.removeAttribute(t)}}function Zie(t){return function(){this.removeAttributeNS(t.space,t.local)}}function eoe(t,e,r){var n,a=r+"",s;return function(){var i=this.getAttribute(t);return i===a?null:i===n?s:s=e(n=i,r)}}function toe(t,e,r){var n,a=r+"",s;return function(){var i=this.getAttributeNS(t.space,t.local);return i===a?null:i===n?s:s=e(n=i,r)}}function roe(t,e,r){var n,a,s;return function(){var i,l=r(this),c;return l==null?void this.removeAttribute(t):(i=this.getAttribute(t),c=l+"",i===c?null:i===n&&c===a?s:(a=c,s=e(n=i,l)))}}function noe(t,e,r){var n,a,s;return function(){var i,l=r(this),c;return l==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),c=l+"",i===c?null:i===n&&c===a?s:(a=c,s=e(n=i,l)))}}function aoe(t,e){var r=Jy(t),n=r==="transform"?Fie:FL;return this.attrTween(t,typeof e=="function"?(r.local?noe:roe)(r,n,gk(this,"attr."+t,e)):e==null?(r.local?Zie:Jie)(r):(r.local?toe:eoe)(r,n,e))}function soe(t,e){return function(r){this.setAttribute(t,e.call(this,r))}}function ioe(t,e){return function(r){this.setAttributeNS(t.space,t.local,e.call(this,r))}}function ooe(t,e){var r,n;function a(){var s=e.apply(this,arguments);return s!==n&&(r=(n=s)&&ioe(t,s)),r}return a._value=e,a}function loe(t,e){var r,n;function a(){var s=e.apply(this,arguments);return s!==n&&(r=(n=s)&&soe(t,s)),r}return a._value=e,a}function coe(t,e){var r="attr."+t;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;var n=Jy(t);return this.tween(r,(n.local?ooe:loe)(n,e))}function uoe(t,e){return function(){pk(this,t).delay=+e.apply(this,arguments)}}function doe(t,e){return e=+e,function(){pk(this,t).delay=e}}function hoe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?uoe:doe)(e,t)):So(this.node(),e).delay}function poe(t,e){return function(){tl(this,t).duration=+e.apply(this,arguments)}}function goe(t,e){return e=+e,function(){tl(this,t).duration=e}}function foe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?poe:goe)(e,t)):So(this.node(),e).duration}function moe(t,e){if(typeof e!="function")throw new Error;return function(){tl(this,t).ease=e}}function yoe(t){var e=this._id;return arguments.length?this.each(moe(e,t)):So(this.node(),e).ease}function boe(t,e){return function(){var r=e.apply(this,arguments);if(typeof r!="function")throw new Error;tl(this,t).ease=r}}function xoe(t){if(typeof t!="function")throw new Error;return this.each(boe(this._id,t))}function voe(t){typeof t!="function"&&(t=xL(t));for(var e=this._groups,r=e.length,n=new Array(r),a=0;a<r;++a)for(var s=e[a],i=s.length,l=n[a]=[],c,d=0;d<i;++d)(c=s[d])&&t.call(c,c.__data__,d,s)&&l.push(c);return new Ll(n,this._parents,this._name,this._id)}function woe(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,r=t._groups,n=e.length,a=r.length,s=Math.min(n,a),i=new Array(n),l=0;l<s;++l)for(var c=e[l],d=r[l],p=c.length,g=i[l]=new Array(p),m,y=0;y<p;++y)(m=c[y]||d[y])&&(g[y]=m);for(;l<n;++l)i[l]=e[l];return new Ll(i,this._parents,this._name,this._id)}function Soe(t){return(t+"").trim().split(/^|\s+/).every(function(e){var r=e.indexOf(".");return r>=0&&(e=e.slice(0,r)),!e||e==="start"})}function koe(t,e,r){var n,a,s=Soe(e)?pk:tl;return function(){var i=s(this,t),l=i.on;l!==n&&(a=(n=l).copy()).on(e,r),i.on=a}}function Toe(t,e){var r=this._id;return arguments.length<2?So(this.node(),r).on.on(t):this.each(koe(r,t,e))}function Coe(t){return function(){var e=this.parentNode;for(var r in this.__transition)if(+r!==t)return;e&&e.removeChild(this)}}function Eoe(){return this.on("end.remove",Coe(this._id))}function _oe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=lk(t));for(var n=this._groups,a=n.length,s=new Array(a),i=0;i<a;++i)for(var l=n[i],c=l.length,d=s[i]=new Array(c),p,g,m=0;m<c;++m)(p=l[m])&&(g=t.call(p,p.__data__,m,l))&&("__data__"in p&&(g.__data__=p.__data__),d[m]=g,eb(d[m],e,r,m,d,So(p,r)));return new Ll(s,this._parents,e,r)}function Aoe(t){var e=this._name,r=this._id;typeof t!="function"&&(t=bL(t));for(var n=this._groups,a=n.length,s=[],i=[],l=0;l<a;++l)for(var c=n[l],d=c.length,p,g=0;g<d;++g)if(p=c[g]){for(var m=t.call(p,p.__data__,g,c),y,x=So(p,r),w=0,T=m.length;w<T;++w)(y=m[w])&&eb(y,e,r,w,m,x);s.push(m),i.push(p)}return new Ll(s,i,e,r)}var Noe=ff.prototype.constructor;function Poe(){return new Noe(this._groups,this._parents)}function Ioe(t,e){var r,n,a;return function(){var s=yh(this,t),i=(this.style.removeProperty(t),yh(this,t));return s===i?null:s===r&&i===n?a:a=e(r=s,n=i)}}function zL(t){return function(){this.style.removeProperty(t)}}function Roe(t,e,r){var n,a=r+"",s;return function(){var i=yh(this,t);return i===a?null:i===n?s:s=e(n=i,r)}}function Doe(t,e,r){var n,a,s;return function(){var i=yh(this,t),l=r(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(t),yh(this,t))),i===c?null:i===n&&c===a?s:(a=c,s=e(n=i,l))}}function Loe(t,e){var r,n,a,s="style."+e,i="end."+s,l;return function(){var c=tl(this,t),d=c.on,p=c.value[s]==null?l||(l=zL(e)):void 0;(d!==r||a!==p)&&(n=(r=d).copy()).on(i,a=p),c.on=n}}function Moe(t,e,r){var n=(t+="")=="transform"?Bie:FL;return e==null?this.styleTween(t,Ioe(t,n)).on("end.style."+t,zL(t)):typeof e=="function"?this.styleTween(t,Doe(t,n,gk(this,"style."+t,e))).each(Loe(this._id,t)):this.styleTween(t,Roe(t,n,e),r).on("end.style."+t,null)}function Ooe(t,e,r){return function(n){this.style.setProperty(t,e.call(this,n),r)}}function joe(t,e,r){var n,a;function s(){var i=e.apply(this,arguments);return i!==a&&(n=(a=i)&&Ooe(t,i,r)),n}return s._value=e,s}function Boe(t,e,r){var n="style."+(t+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,joe(t,e,r??""))}function Foe(t){return function(){this.textContent=t}}function zoe(t){return function(){var e=t(this);this.textContent=e??""}}function $oe(t){return this.tween("text",typeof t=="function"?zoe(gk(this,"text",t)):Foe(t==null?"":t+""))}function Uoe(t){return function(e){this.textContent=t.call(this,e)}}function qoe(t){var e,r;function n(){var a=t.apply(this,arguments);return a!==r&&(e=(r=a)&&Uoe(a)),e}return n._value=t,n}function Hoe(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,qoe(t))}function Goe(){for(var t=this._name,e=this._id,r=$L(),n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],l=i.length,c,d=0;d<l;++d)if(c=i[d]){var p=So(c,e);eb(c,t,r,d,i,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Ll(n,this._parents,t,r)}function Voe(){var t,e,r=this,n=r._id,a=r.size();return new Promise(function(s,i){var l={value:i},c={value:function(){--a===0&&s()}};r.each(function(){var d=tl(this,n),p=d.on;p!==t&&(e=(t=p).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(c)),d.on=e}),a===0&&s()})}var Woe=0;function Ll(t,e,r,n){this._groups=t,this._parents=e,this._name=r,this._id=n}function $L(){return++Woe}var Tl=ff.prototype;Ll.prototype={constructor:Ll,select:_oe,selectAll:Aoe,selectChild:Tl.selectChild,selectChildren:Tl.selectChildren,filter:voe,merge:woe,selection:Poe,transition:Goe,call:Tl.call,nodes:Tl.nodes,node:Tl.node,size:Tl.size,empty:Tl.empty,each:Tl.each,on:Toe,attr:aoe,attrTween:coe,style:Moe,styleTween:Boe,text:$oe,textTween:Hoe,remove:Eoe,tween:Xie,delay:hoe,duration:foe,ease:yoe,easeVarying:xoe,end:Voe,[Symbol.iterator]:Tl[Symbol.iterator]};function Yoe(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Qoe={time:null,delay:0,duration:250,ease:Yoe};function Koe(t,e){for(var r;!(r=t.__transition)||!(r=r[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return r}function Xoe(t){var e,r;t instanceof Ll?(e=t._id,t=t._name):(e=$L(),(r=Qoe).time=hk(),t=t==null?null:t+"");for(var n=this._groups,a=n.length,s=0;s<a;++s)for(var i=n[s],l=i.length,c,d=0;d<l;++d)(c=i[d])&&eb(c,t,e,d,i,r||Koe(c,e));return new Ll(n,this._parents,t,e)}ff.prototype.interrupt=Yie;ff.prototype.transition=Xoe;const P1=Math.PI,I1=2*P1,gu=1e-6,Joe=I1-gu;function UL(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=arguments[e]+t[e]}function Zoe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return UL;const r=10**e;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class ele{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?UL:Zoe(e)}moveTo(e,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,r){this._append`L${this._x1=+e},${this._y1=+r}`}quadraticCurveTo(e,r,n,a){this._append`Q${+e},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,r,n,a,s,i){this._append`C${+e},${+r},${+n},${+a},${this._x1=+s},${this._y1=+i}`}arcTo(e,r,n,a,s){if(e=+e,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let i=this._x1,l=this._y1,c=n-e,d=a-r,p=i-e,g=l-r,m=p*p+g*g;if(this._x1===null)this._append`M${this._x1=e},${this._y1=r}`;else if(m>gu)if(!(Math.abs(g*c-d*p)>gu)||!s)this._append`L${this._x1=e},${this._y1=r}`;else{let y=n-i,x=a-l,w=c*c+d*d,T=y*y+x*x,k=Math.sqrt(w),_=Math.sqrt(m),P=s*Math.tan((P1-Math.acos((w+m-T)/(2*k*_)))/2),F=P/_,D=P/k;Math.abs(F-1)>gu&&this._append`L${e+F*p},${r+F*g}`,this._append`A${s},${s},0,0,${+(g*y>p*x)},${this._x1=e+D*c},${this._y1=r+D*d}`}}arc(e,r,n,a,s,i){if(e=+e,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),d=e+l,p=r+c,g=1^i,m=i?a-s:s-a;this._x1===null?this._append`M${d},${p}`:(Math.abs(this._x1-d)>gu||Math.abs(this._y1-p)>gu)&&this._append`L${d},${p}`,n&&(m<0&&(m=m%I1+I1),m>Joe?this._append`A${n},${n},0,1,${g},${e-l},${r-c}A${n},${n},0,1,${g},${this._x1=d},${this._y1=p}`:m>gu&&this._append`A${n},${n},0,${+(m>=P1)},${g},${this._x1=e+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(e,r,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Od(t){return function(){return t}}const Yxe=Math.abs,Qxe=Math.atan2,Kxe=Math.cos,Xxe=Math.max,Jxe=Math.min,Zxe=Math.sin,eve=Math.sqrt,_N=1e-12,fk=Math.PI,AN=fk/2,tve=2*fk;function rve(t){return t>1?0:t<-1?fk:Math.acos(t)}function nve(t){return t>=1?AN:t<=-1?-AN:Math.asin(t)}function tle(t){let e=3;return t.digits=function(r){if(!arguments.length)return e;if(r==null)e=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);e=n}return t},()=>new ele(e)}function rle(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function qL(t){this._context=t}qL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function ry(t){return new qL(t)}function nle(t){return t[0]}function ale(t){return t[1]}function sle(t,e){var r=Od(!0),n=null,a=ry,s=null,i=tle(l);t=typeof t=="function"?t:t===void 0?nle:Od(t),e=typeof e=="function"?e:e===void 0?ale:Od(e);function l(c){var d,p=(c=rle(c)).length,g,m=!1,y;for(n==null&&(s=a(y=i())),d=0;d<=p;++d)!(d<p&&r(g=c[d],d,c))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+t(g,d,c),+e(g,d,c));if(y)return s=null,y+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:Od(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:Od(+c),l):e},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Od(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}class HL{constructor(e,r){this._context=e,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,r){switch(e=+e,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,r):this._context.moveTo(e,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,r,e,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,e,this._y0,e,r);break}}this._x0=e,this._y0=r}}function GL(t){return new HL(t,!0)}function VL(t){return new HL(t,!1)}function Nc(){}function ny(t,e,r){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+r)/6)}function tb(t){this._context=t}tb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ny(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ny(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function f0(t){return new tb(t)}function WL(t){this._context=t}WL.prototype={areaStart:Nc,areaEnd:Nc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ny(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ile(t){return new WL(t)}function YL(t){this._context=t}YL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+t)/6,n=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:ny(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function ole(t){return new YL(t)}function QL(t,e){this._basis=new tb(t),this._beta=e}QL.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,r=t.length-1;if(r>0)for(var n=t[0],a=e[0],s=t[r]-n,i=e[r]-a,l=-1,c;++l<=r;)c=l/r,this._basis.point(this._beta*t[l]+(1-this._beta)*(n+c*s),this._beta*e[l]+(1-this._beta)*(a+c*i));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const lle=(function t(e){function r(n){return e===1?new tb(n):new QL(n,e)}return r.beta=function(n){return t(+n)},r})(.85);function ay(t,e,r){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-r),t._x2,t._y2)}function mk(t,e){this._context=t,this._k=(1-e)/6}mk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ay(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:ay(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const KL=(function t(e){function r(n){return new mk(n,e)}return r.tension=function(n){return t(+n)},r})(0);function yk(t,e){this._context=t,this._k=(1-e)/6}yk.prototype={areaStart:Nc,areaEnd:Nc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:ay(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const cle=(function t(e){function r(n){return new yk(n,e)}return r.tension=function(n){return t(+n)},r})(0);function bk(t,e){this._context=t,this._k=(1-e)/6}bk.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ay(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ule=(function t(e){function r(n){return new bk(n,e)}return r.tension=function(n){return t(+n)},r})(0);function xk(t,e,r){var n=t._x1,a=t._y1,s=t._x2,i=t._y2;if(t._l01_a>_N){var l=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);n=(n*l-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,a=(a*l-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>_N){var d=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,p=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*d+t._x1*t._l23_2a-e*t._l12_2a)/p,i=(i*d+t._y1*t._l23_2a-r*t._l12_2a)/p}t._context.bezierCurveTo(n,a,s,i,t._x2,t._y2)}function XL(t,e){this._context=t,this._alpha=e}XL.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:xk(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const JL=(function t(e){function r(n){return e?new XL(n,e):new mk(n,0)}return r.alpha=function(n){return t(+n)},r})(.5);function ZL(t,e){this._context=t,this._alpha=e}ZL.prototype={areaStart:Nc,areaEnd:Nc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:xk(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const dle=(function t(e){function r(n){return e?new ZL(n,e):new yk(n,0)}return r.alpha=function(n){return t(+n)},r})(.5);function eM(t,e){this._context=t,this._alpha=e}eM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var r=this._x2-t,n=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:xk(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const hle=(function t(e){function r(n){return e?new eM(n,e):new bk(n,0)}return r.alpha=function(n){return t(+n)},r})(.5);function tM(t){this._context=t}tM.prototype={areaStart:Nc,areaEnd:Nc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function ple(t){return new tM(t)}function NN(t){return t<0?-1:1}function PN(t,e,r){var n=t._x1-t._x0,a=e-t._x1,s=(t._y1-t._y0)/(n||a<0&&-0),i=(r-t._y1)/(a||n<0&&-0),l=(s*a+i*n)/(n+a);return(NN(s)+NN(i))*Math.min(Math.abs(s),Math.abs(i),.5*Math.abs(l))||0}function IN(t,e){var r=t._x1-t._x0;return r?(3*(t._y1-t._y0)/r-e)/2:e}function sw(t,e,r){var n=t._x0,a=t._y0,s=t._x1,i=t._y1,l=(s-n)/3;t._context.bezierCurveTo(n+l,a+l*e,s-l,i-l*r,s,i)}function sy(t){this._context=t}sy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:sw(this,this._t0,IN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var r=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,sw(this,IN(this,r=PN(this,t,e)),r);break;default:sw(this,this._t0,r=PN(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=r}}};function rM(t){this._context=new nM(t)}(rM.prototype=Object.create(sy.prototype)).point=function(t,e){sy.prototype.point.call(this,e,t)};function nM(t){this._context=t}nM.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,r,n,a,s){this._context.bezierCurveTo(e,t,n,r,s,a)}};function aM(t){return new sy(t)}function sM(t){return new rM(t)}function iM(t){this._context=t}iM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,r=t.length;if(r)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),r===2)this._context.lineTo(t[1],e[1]);else for(var n=RN(t),a=RN(e),s=0,i=1;i<r;++s,++i)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],t[i],e[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function RN(t){var e,r=t.length-1,n,a=new Array(r),s=new Array(r),i=new Array(r);for(a[0]=0,s[0]=2,i[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,s[e]=4,i[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,s[r-1]=7,i[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/s[e-1],s[e]-=n,i[e]-=n*i[e-1];for(a[r-1]=i[r-1]/s[r-1],e=r-2;e>=0;--e)a[e]=(i[e]-a[e+1])/s[e];for(s[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)s[e]=2*t[e+1]-a[e+1];return[a,s]}function oM(t){return new iM(t)}function rb(t,e){this._context=t,this._t=e}rb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var r=this._x*(1-this._t)+t*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,e)}break}}this._x=t,this._y=e}};function lM(t){return new rb(t,.5)}function cM(t){return new rb(t,0)}function uM(t){return new rb(t,1)}function eg(t,e,r){this.k=t,this.x=e,this.y=r}eg.prototype={constructor:eg,scale:function(t){return t===1?this:new eg(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new eg(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};eg.prototype;var gle=L(t=>{const{securityLevel:e}=In();let r=wn("body");if(e==="sandbox"){const s=wn(`#i${t}`).node()?.contentDocument??document;r=wn(s.body)}return r.select(`#${t}`)},"selectSvgElement");function vk(t){return typeof t>"u"||t===null}L(vk,"isNothing");function dM(t){return typeof t=="object"&&t!==null}L(dM,"isObject");function hM(t){return Array.isArray(t)?t:vk(t)?[]:[t]}L(hM,"toArray");function pM(t,e){var r,n,a,s;if(e)for(s=Object.keys(e),r=0,n=s.length;r<n;r+=1)a=s[r],t[a]=e[a];return t}L(pM,"extend");function gM(t,e){var r="",n;for(n=0;n<e;n+=1)r+=t;return r}L(gM,"repeat");function fM(t){return t===0&&Number.NEGATIVE_INFINITY===1/t}L(fM,"isNegativeZero");var fle=vk,mle=dM,yle=hM,ble=gM,xle=fM,vle=pM,Va={isNothing:fle,isObject:mle,toArray:yle,repeat:ble,isNegativeZero:xle,extend:vle};function wk(t,e){var r="",n=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(r+='in "'+t.mark.name+'" '),r+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!e&&t.mark.snippet&&(r+=`

`+t.mark.snippet),n+" "+r):n}L(wk,"formatError");function xh(t,e){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=e,this.message=wk(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}L(xh,"YAMLException$1");xh.prototype=Object.create(Error.prototype);xh.prototype.constructor=xh;xh.prototype.toString=L(function(e){return this.name+": "+wk(this,e)},"toString");var si=xh;function m0(t,e,r,n,a){var s="",i="",l=Math.floor(a/2)-1;return n-e>l&&(s=" ... ",e=n-l+s.length),r-n>l&&(i=" ...",r=n+l-i.length),{str:s+t.slice(e,r).replace(/\t/g,"")+i,pos:n-e+s.length}}L(m0,"getLine");function y0(t,e){return Va.repeat(" ",e-t.length)+t}L(y0,"padStart");function mM(t,e){if(e=Object.create(e||null),!t.buffer)return null;e.maxLength||(e.maxLength=79),typeof e.indent!="number"&&(e.indent=1),typeof e.linesBefore!="number"&&(e.linesBefore=3),typeof e.linesAfter!="number"&&(e.linesAfter=2);for(var r=/\r?\n|\r|\0/g,n=[0],a=[],s,i=-1;s=r.exec(t.buffer);)a.push(s.index),n.push(s.index+s[0].length),t.position<=s.index&&i<0&&(i=n.length-2);i<0&&(i=n.length-1);var l="",c,d,p=Math.min(t.line+e.linesAfter,a.length).toString().length,g=e.maxLength-(e.indent+p+3);for(c=1;c<=e.linesBefore&&!(i-c<0);c++)d=m0(t.buffer,n[i-c],a[i-c],t.position-(n[i]-n[i-c]),g),l=Va.repeat(" ",e.indent)+y0((t.line-c+1).toString(),p)+" | "+d.str+`
`+l;for(d=m0(t.buffer,n[i],a[i],t.position,g),l+=Va.repeat(" ",e.indent)+y0((t.line+1).toString(),p)+" | "+d.str+`
`,l+=Va.repeat("-",e.indent+p+3+d.pos)+`^
`,c=1;c<=e.linesAfter&&!(i+c>=a.length);c++)d=m0(t.buffer,n[i+c],a[i+c],t.position-(n[i]-n[i+c]),g),l+=Va.repeat(" ",e.indent)+y0((t.line+c+1).toString(),p)+" | "+d.str+`
`;return l.replace(/\n$/,"")}L(mM,"makeSnippet");var wle=mM,Sle=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],kle=["scalar","sequence","mapping"];function yM(t){var e={};return t!==null&&Object.keys(t).forEach(function(r){t[r].forEach(function(n){e[String(n)]=r})}),e}L(yM,"compileStyleAliases");function bM(t,e){if(e=e||{},Object.keys(e).forEach(function(r){if(Sle.indexOf(r)===-1)throw new si('Unknown option "'+r+'" is met in definition of "'+t+'" YAML type.')}),this.options=e,this.tag=t,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=yM(e.styleAliases||null),kle.indexOf(this.kind)===-1)throw new si('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')}L(bM,"Type$1");var xs=bM;function R1(t,e){var r=[];return t[e].forEach(function(n){var a=r.length;r.forEach(function(s,i){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(a=i)}),r[a]=n}),r}L(R1,"compileList");function xM(){var t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function n(a){a.multi?(t.multi[a.kind].push(a),t.multi.fallback.push(a)):t[a.kind][a.tag]=t.fallback[a.tag]=a}for(L(n,"collectType"),e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(n);return t}L(xM,"compileMap");function iy(t){return this.extend(t)}L(iy,"Schema$1");iy.prototype.extend=L(function(e){var r=[],n=[];if(e instanceof xs)n.push(e);else if(Array.isArray(e))n=n.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit));else throw new si("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof xs))throw new si("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new si("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new si("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof xs))throw new si("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(iy.prototype);return a.implicit=(this.implicit||[]).concat(r),a.explicit=(this.explicit||[]).concat(n),a.compiledImplicit=R1(a,"implicit"),a.compiledExplicit=R1(a,"explicit"),a.compiledTypeMap=xM(a.compiledImplicit,a.compiledExplicit),a},"extend");var Tle=iy,Cle=new xs("tag:yaml.org,2002:str",{kind:"scalar",construct:L(function(t){return t!==null?t:""},"construct")}),Ele=new xs("tag:yaml.org,2002:seq",{kind:"sequence",construct:L(function(t){return t!==null?t:[]},"construct")}),_le=new xs("tag:yaml.org,2002:map",{kind:"mapping",construct:L(function(t){return t!==null?t:{}},"construct")}),Ale=new Tle({explicit:[Cle,Ele,_le]});function vM(t){if(t===null)return!0;var e=t.length;return e===1&&t==="~"||e===4&&(t==="null"||t==="Null"||t==="NULL")}L(vM,"resolveYamlNull");function wM(){return null}L(wM,"constructYamlNull");function SM(t){return t===null}L(SM,"isNull");var Nle=new xs("tag:yaml.org,2002:null",{kind:"scalar",resolve:vM,construct:wM,predicate:SM,represent:{canonical:L(function(){return"~"},"canonical"),lowercase:L(function(){return"null"},"lowercase"),uppercase:L(function(){return"NULL"},"uppercase"),camelcase:L(function(){return"Null"},"camelcase"),empty:L(function(){return""},"empty")},defaultStyle:"lowercase"});function kM(t){if(t===null)return!1;var e=t.length;return e===4&&(t==="true"||t==="True"||t==="TRUE")||e===5&&(t==="false"||t==="False"||t==="FALSE")}L(kM,"resolveYamlBoolean");function TM(t){return t==="true"||t==="True"||t==="TRUE"}L(TM,"constructYamlBoolean");function CM(t){return Object.prototype.toString.call(t)==="[object Boolean]"}L(CM,"isBoolean");var Ple=new xs("tag:yaml.org,2002:bool",{kind:"scalar",resolve:kM,construct:TM,predicate:CM,represent:{lowercase:L(function(t){return t?"true":"false"},"lowercase"),uppercase:L(function(t){return t?"TRUE":"FALSE"},"uppercase"),camelcase:L(function(t){return t?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function EM(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}L(EM,"isHexCode");function _M(t){return 48<=t&&t<=55}L(_M,"isOctCode");function AM(t){return 48<=t&&t<=57}L(AM,"isDecCode");function NM(t){if(t===null)return!1;var e=t.length,r=0,n=!1,a;if(!e)return!1;if(a=t[r],(a==="-"||a==="+")&&(a=t[++r]),a==="0"){if(r+1===e)return!0;if(a=t[++r],a==="b"){for(r++;r<e;r++)if(a=t[r],a!=="_"){if(a!=="0"&&a!=="1")return!1;n=!0}return n&&a!=="_"}if(a==="x"){for(r++;r<e;r++)if(a=t[r],a!=="_"){if(!EM(t.charCodeAt(r)))return!1;n=!0}return n&&a!=="_"}if(a==="o"){for(r++;r<e;r++)if(a=t[r],a!=="_"){if(!_M(t.charCodeAt(r)))return!1;n=!0}return n&&a!=="_"}}if(a==="_")return!1;for(;r<e;r++)if(a=t[r],a!=="_"){if(!AM(t.charCodeAt(r)))return!1;n=!0}return!(!n||a==="_")}L(NM,"resolveYamlInteger");function PM(t){var e=t,r=1,n;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),n=e[0],(n==="-"||n==="+")&&(n==="-"&&(r=-1),e=e.slice(1),n=e[0]),e==="0")return 0;if(n==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}L(PM,"constructYamlInteger");function IM(t){return Object.prototype.toString.call(t)==="[object Number]"&&t%1===0&&!Va.isNegativeZero(t)}L(IM,"isInteger");var Ile=new xs("tag:yaml.org,2002:int",{kind:"scalar",resolve:NM,construct:PM,predicate:IM,represent:{binary:L(function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},"binary"),octal:L(function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},"octal"),decimal:L(function(t){return t.toString(10)},"decimal"),hexadecimal:L(function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Rle=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function RM(t){return!(t===null||!Rle.test(t)||t[t.length-1]==="_")}L(RM,"resolveYamlFloat");function DM(t){var e,r;return e=t.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}L(DM,"constructYamlFloat");var Dle=/^[-+]?[0-9]+e/;function LM(t,e){var r;if(isNaN(t))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Va.isNegativeZero(t))return"-0.0";return r=t.toString(10),Dle.test(r)?r.replace("e",".e"):r}L(LM,"representYamlFloat");function MM(t){return Object.prototype.toString.call(t)==="[object Number]"&&(t%1!==0||Va.isNegativeZero(t))}L(MM,"isFloat");var Lle=new xs("tag:yaml.org,2002:float",{kind:"scalar",resolve:RM,construct:DM,predicate:MM,represent:LM,defaultStyle:"lowercase"}),OM=Ale.extend({implicit:[Nle,Ple,Ile,Lle]}),Mle=OM,jM=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),BM=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function FM(t){return t===null?!1:jM.exec(t)!==null||BM.exec(t)!==null}L(FM,"resolveYamlTimestamp");function zM(t){var e,r,n,a,s,i,l,c=0,d=null,p,g,m;if(e=jM.exec(t),e===null&&(e=BM.exec(t)),e===null)throw new Error("Date resolve error");if(r=+e[1],n=+e[2]-1,a=+e[3],!e[4])return new Date(Date.UTC(r,n,a));if(s=+e[4],i=+e[5],l=+e[6],e[7]){for(c=e[7].slice(0,3);c.length<3;)c+="0";c=+c}return e[9]&&(p=+e[10],g=+(e[11]||0),d=(p*60+g)*6e4,e[9]==="-"&&(d=-d)),m=new Date(Date.UTC(r,n,a,s,i,l,c)),d&&m.setTime(m.getTime()-d),m}L(zM,"constructYamlTimestamp");function $M(t){return t.toISOString()}L($M,"representYamlTimestamp");var Ole=new xs("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:FM,construct:zM,instanceOf:Date,represent:$M});function UM(t){return t==="<<"||t===null}L(UM,"resolveYamlMerge");var jle=new xs("tag:yaml.org,2002:merge",{kind:"scalar",resolve:UM}),Sk=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function qM(t){if(t===null)return!1;var e,r,n=0,a=t.length,s=Sk;for(r=0;r<a;r++)if(e=s.indexOf(t.charAt(r)),!(e>64)){if(e<0)return!1;n+=6}return n%8===0}L(qM,"resolveYamlBinary");function HM(t){var e,r,n=t.replace(/[\r\n=]/g,""),a=n.length,s=Sk,i=0,l=[];for(e=0;e<a;e++)e%4===0&&e&&(l.push(i>>16&255),l.push(i>>8&255),l.push(i&255)),i=i<<6|s.indexOf(n.charAt(e));return r=a%4*6,r===0?(l.push(i>>16&255),l.push(i>>8&255),l.push(i&255)):r===18?(l.push(i>>10&255),l.push(i>>2&255)):r===12&&l.push(i>>4&255),new Uint8Array(l)}L(HM,"constructYamlBinary");function GM(t){var e="",r=0,n,a,s=t.length,i=Sk;for(n=0;n<s;n++)n%3===0&&n&&(e+=i[r>>18&63],e+=i[r>>12&63],e+=i[r>>6&63],e+=i[r&63]),r=(r<<8)+t[n];return a=s%3,a===0?(e+=i[r>>18&63],e+=i[r>>12&63],e+=i[r>>6&63],e+=i[r&63]):a===2?(e+=i[r>>10&63],e+=i[r>>4&63],e+=i[r<<2&63],e+=i[64]):a===1&&(e+=i[r>>2&63],e+=i[r<<4&63],e+=i[64],e+=i[64]),e}L(GM,"representYamlBinary");function VM(t){return Object.prototype.toString.call(t)==="[object Uint8Array]"}L(VM,"isBinary");var Ble=new xs("tag:yaml.org,2002:binary",{kind:"scalar",resolve:qM,construct:HM,predicate:VM,represent:GM}),Fle=Object.prototype.hasOwnProperty,zle=Object.prototype.toString;function WM(t){if(t===null)return!0;var e=[],r,n,a,s,i,l=t;for(r=0,n=l.length;r<n;r+=1){if(a=l[r],i=!1,zle.call(a)!=="[object Object]")return!1;for(s in a)if(Fle.call(a,s))if(!i)i=!0;else return!1;if(!i)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}L(WM,"resolveYamlOmap");function YM(t){return t!==null?t:[]}L(YM,"constructYamlOmap");var $le=new xs("tag:yaml.org,2002:omap",{kind:"sequence",resolve:WM,construct:YM}),Ule=Object.prototype.toString;function QM(t){if(t===null)return!0;var e,r,n,a,s,i=t;for(s=new Array(i.length),e=0,r=i.length;e<r;e+=1){if(n=i[e],Ule.call(n)!=="[object Object]"||(a=Object.keys(n),a.length!==1))return!1;s[e]=[a[0],n[a[0]]]}return!0}L(QM,"resolveYamlPairs");function KM(t){if(t===null)return[];var e,r,n,a,s,i=t;for(s=new Array(i.length),e=0,r=i.length;e<r;e+=1)n=i[e],a=Object.keys(n),s[e]=[a[0],n[a[0]]];return s}L(KM,"constructYamlPairs");var qle=new xs("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:QM,construct:KM}),Hle=Object.prototype.hasOwnProperty;function XM(t){if(t===null)return!0;var e,r=t;for(e in r)if(Hle.call(r,e)&&r[e]!==null)return!1;return!0}L(XM,"resolveYamlSet");function JM(t){return t!==null?t:{}}L(JM,"constructYamlSet");var Gle=new xs("tag:yaml.org,2002:set",{kind:"mapping",resolve:XM,construct:JM}),ZM=Mle.extend({implicit:[Ole,jle],explicit:[Ble,$le,qle,Gle]}),Pc=Object.prototype.hasOwnProperty,oy=1,e4=2,t4=3,ly=4,iw=1,Vle=2,DN=3,Wle=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Yle=/[\x85\u2028\u2029]/,Qle=/[,\[\]\{\}]/,r4=/^(?:!|!!|![a-z\-]+!)$/i,n4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function D1(t){return Object.prototype.toString.call(t)}L(D1,"_class");function mo(t){return t===10||t===13}L(mo,"is_EOL");function Ac(t){return t===9||t===32}L(Ac,"is_WHITE_SPACE");function Ls(t){return t===9||t===32||t===10||t===13}L(Ls,"is_WS_OR_EOL");function wu(t){return t===44||t===91||t===93||t===123||t===125}L(wu,"is_FLOW_INDICATOR");function a4(t){var e;return 48<=t&&t<=57?t-48:(e=t|32,97<=e&&e<=102?e-97+10:-1)}L(a4,"fromHexCode");function s4(t){return t===120?2:t===117?4:t===85?8:0}L(s4,"escapedHexLen");function i4(t){return 48<=t&&t<=57?t-48:-1}L(i4,"fromDecimalCode");function L1(t){return t===48?"\0":t===97?"\x07":t===98?"\b":t===116||t===9?"	":t===110?`
`:t===118?"\v":t===102?"\f":t===114?"\r":t===101?"\x1B":t===32?" ":t===34?'"':t===47?"/":t===92?"\\":t===78?"":t===95?"":t===76?"\u2028":t===80?"\u2029":""}L(L1,"simpleEscapeSequence");function o4(t){return t<=65535?String.fromCharCode(t):String.fromCharCode((t-65536>>10)+55296,(t-65536&1023)+56320)}L(o4,"charFromCodepoint");var l4=new Array(256),c4=new Array(256);for(lu=0;lu<256;lu++)l4[lu]=L1(lu)?1:0,c4[lu]=L1(lu);var lu;function u4(t,e){this.input=t,this.filename=e.filename||null,this.schema=e.schema||ZM,this.onWarning=e.onWarning||null,this.legacy=e.legacy||!1,this.json=e.json||!1,this.listener=e.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}L(u4,"State$1");function kk(t,e){var r={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return r.snippet=wle(r),new si(e,r)}L(kk,"generateError");function Sr(t,e){throw kk(t,e)}L(Sr,"throwError");function zg(t,e){t.onWarning&&t.onWarning.call(null,kk(t,e))}L(zg,"throwWarning");var LN={YAML:L(function(e,r,n){var a,s,i;e.version!==null&&Sr(e,"duplication of %YAML directive"),n.length!==1&&Sr(e,"YAML directive accepts exactly one argument"),a=/^([0-9]+)\.([0-9]+)$/.exec(n[0]),a===null&&Sr(e,"ill-formed argument of the YAML directive"),s=parseInt(a[1],10),i=parseInt(a[2],10),s!==1&&Sr(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=i<2,i!==1&&i!==2&&zg(e,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:L(function(e,r,n){var a,s;n.length!==2&&Sr(e,"TAG directive accepts exactly two arguments"),a=n[0],s=n[1],r4.test(a)||Sr(e,"ill-formed tag handle (first argument) of the TAG directive"),Pc.call(e.tagMap,a)&&Sr(e,'there is a previously declared suffix for "'+a+'" tag handle'),n4.test(s)||Sr(e,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch{Sr(e,"tag prefix is malformed: "+s)}e.tagMap[a]=s},"handleTagDirective")};function Rl(t,e,r,n){var a,s,i,l;if(e<r){if(l=t.input.slice(e,r),n)for(a=0,s=l.length;a<s;a+=1)i=l.charCodeAt(a),i===9||32<=i&&i<=1114111||Sr(t,"expected valid JSON character");else Wle.test(l)&&Sr(t,"the stream contains non-printable characters");t.result+=l}}L(Rl,"captureSegment");function M1(t,e,r,n){var a,s,i,l;for(Va.isObject(r)||Sr(t,"cannot merge mappings; the provided source object is unacceptable"),a=Object.keys(r),i=0,l=a.length;i<l;i+=1)s=a[i],Pc.call(e,s)||(e[s]=r[s],n[s]=!0)}L(M1,"mergeMappings");function Su(t,e,r,n,a,s,i,l,c){var d,p;if(Array.isArray(a))for(a=Array.prototype.slice.call(a),d=0,p=a.length;d<p;d+=1)Array.isArray(a[d])&&Sr(t,"nested arrays are not supported inside keys"),typeof a=="object"&&D1(a[d])==="[object Object]"&&(a[d]="[object Object]");if(typeof a=="object"&&D1(a)==="[object Object]"&&(a="[object Object]"),a=String(a),e===null&&(e={}),n==="tag:yaml.org,2002:merge")if(Array.isArray(s))for(d=0,p=s.length;d<p;d+=1)M1(t,e,s[d],r);else M1(t,e,s,r);else!t.json&&!Pc.call(r,a)&&Pc.call(e,a)&&(t.line=i||t.line,t.lineStart=l||t.lineStart,t.position=c||t.position,Sr(t,"duplicated mapping key")),a==="__proto__"?Object.defineProperty(e,a,{configurable:!0,enumerable:!0,writable:!0,value:s}):e[a]=s,delete r[a];return e}L(Su,"storeMappingPair");function nb(t){var e;e=t.input.charCodeAt(t.position),e===10?t.position++:e===13?(t.position++,t.input.charCodeAt(t.position)===10&&t.position++):Sr(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}L(nb,"readLineBreak");function Ta(t,e,r){for(var n=0,a=t.input.charCodeAt(t.position);a!==0;){for(;Ac(a);)a===9&&t.firstTabInLine===-1&&(t.firstTabInLine=t.position),a=t.input.charCodeAt(++t.position);if(e&&a===35)do a=t.input.charCodeAt(++t.position);while(a!==10&&a!==13&&a!==0);if(mo(a))for(nb(t),a=t.input.charCodeAt(t.position),n++,t.lineIndent=0;a===32;)t.lineIndent++,a=t.input.charCodeAt(++t.position);else break}return r!==-1&&n!==0&&t.lineIndent<r&&zg(t,"deficient indentation"),n}L(Ta,"skipSeparationSpace");function yf(t){var e=t.position,r;return r=t.input.charCodeAt(e),!!((r===45||r===46)&&r===t.input.charCodeAt(e+1)&&r===t.input.charCodeAt(e+2)&&(e+=3,r=t.input.charCodeAt(e),r===0||Ls(r)))}L(yf,"testDocumentSeparator");function ab(t,e){e===1?t.result+=" ":e>1&&(t.result+=Va.repeat(`
`,e-1))}L(ab,"writeFoldedLines");function d4(t,e,r){var n,a,s,i,l,c,d,p,g=t.kind,m=t.result,y;if(y=t.input.charCodeAt(t.position),Ls(y)||wu(y)||y===35||y===38||y===42||y===33||y===124||y===62||y===39||y===34||y===37||y===64||y===96||(y===63||y===45)&&(a=t.input.charCodeAt(t.position+1),Ls(a)||r&&wu(a)))return!1;for(t.kind="scalar",t.result="",s=i=t.position,l=!1;y!==0;){if(y===58){if(a=t.input.charCodeAt(t.position+1),Ls(a)||r&&wu(a))break}else if(y===35){if(n=t.input.charCodeAt(t.position-1),Ls(n))break}else{if(t.position===t.lineStart&&yf(t)||r&&wu(y))break;if(mo(y))if(c=t.line,d=t.lineStart,p=t.lineIndent,Ta(t,!1,-1),t.lineIndent>=e){l=!0,y=t.input.charCodeAt(t.position);continue}else{t.position=i,t.line=c,t.lineStart=d,t.lineIndent=p;break}}l&&(Rl(t,s,i,!1),ab(t,t.line-c),s=i=t.position,l=!1),Ac(y)||(i=t.position+1),y=t.input.charCodeAt(++t.position)}return Rl(t,s,i,!1),t.result?!0:(t.kind=g,t.result=m,!1)}L(d4,"readPlainScalar");function h4(t,e){var r,n,a;if(r=t.input.charCodeAt(t.position),r!==39)return!1;for(t.kind="scalar",t.result="",t.position++,n=a=t.position;(r=t.input.charCodeAt(t.position))!==0;)if(r===39)if(Rl(t,n,t.position,!0),r=t.input.charCodeAt(++t.position),r===39)n=t.position,t.position++,a=t.position;else return!0;else mo(r)?(Rl(t,n,a,!0),ab(t,Ta(t,!1,e)),n=a=t.position):t.position===t.lineStart&&yf(t)?Sr(t,"unexpected end of the document within a single quoted scalar"):(t.position++,a=t.position);Sr(t,"unexpected end of the stream within a single quoted scalar")}L(h4,"readSingleQuotedScalar");function p4(t,e){var r,n,a,s,i,l;if(l=t.input.charCodeAt(t.position),l!==34)return!1;for(t.kind="scalar",t.result="",t.position++,r=n=t.position;(l=t.input.charCodeAt(t.position))!==0;){if(l===34)return Rl(t,r,t.position,!0),t.position++,!0;if(l===92){if(Rl(t,r,t.position,!0),l=t.input.charCodeAt(++t.position),mo(l))Ta(t,!1,e);else if(l<256&&l4[l])t.result+=c4[l],t.position++;else if((i=s4(l))>0){for(a=i,s=0;a>0;a--)l=t.input.charCodeAt(++t.position),(i=a4(l))>=0?s=(s<<4)+i:Sr(t,"expected hexadecimal character");t.result+=o4(s),t.position++}else Sr(t,"unknown escape sequence");r=n=t.position}else mo(l)?(Rl(t,r,n,!0),ab(t,Ta(t,!1,e)),r=n=t.position):t.position===t.lineStart&&yf(t)?Sr(t,"unexpected end of the document within a double quoted scalar"):(t.position++,n=t.position)}Sr(t,"unexpected end of the stream within a double quoted scalar")}L(p4,"readDoubleQuotedScalar");function g4(t,e){var r=!0,n,a,s,i=t.tag,l,c=t.anchor,d,p,g,m,y,x=Object.create(null),w,T,k,_;if(_=t.input.charCodeAt(t.position),_===91)p=93,y=!1,l=[];else if(_===123)p=125,y=!0,l={};else return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=l),_=t.input.charCodeAt(++t.position);_!==0;){if(Ta(t,!0,e),_=t.input.charCodeAt(t.position),_===p)return t.position++,t.tag=i,t.anchor=c,t.kind=y?"mapping":"sequence",t.result=l,!0;r?_===44&&Sr(t,"expected the node content, but found ','"):Sr(t,"missed comma between flow collection entries"),T=w=k=null,g=m=!1,_===63&&(d=t.input.charCodeAt(t.position+1),Ls(d)&&(g=m=!0,t.position++,Ta(t,!0,e))),n=t.line,a=t.lineStart,s=t.position,Mu(t,e,oy,!1,!0),T=t.tag,w=t.result,Ta(t,!0,e),_=t.input.charCodeAt(t.position),(m||t.line===n)&&_===58&&(g=!0,_=t.input.charCodeAt(++t.position),Ta(t,!0,e),Mu(t,e,oy,!1,!0),k=t.result),y?Su(t,l,x,T,w,k,n,a,s):g?l.push(Su(t,null,x,T,w,k,n,a,s)):l.push(w),Ta(t,!0,e),_=t.input.charCodeAt(t.position),_===44?(r=!0,_=t.input.charCodeAt(++t.position)):r=!1}Sr(t,"unexpected end of the stream within a flow collection")}L(g4,"readFlowCollection");function f4(t,e){var r,n,a=iw,s=!1,i=!1,l=e,c=0,d=!1,p,g;if(g=t.input.charCodeAt(t.position),g===124)n=!1;else if(g===62)n=!0;else return!1;for(t.kind="scalar",t.result="";g!==0;)if(g=t.input.charCodeAt(++t.position),g===43||g===45)iw===a?a=g===43?DN:Vle:Sr(t,"repeat of a chomping mode identifier");else if((p=i4(g))>=0)p===0?Sr(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):i?Sr(t,"repeat of an indentation width identifier"):(l=e+p-1,i=!0);else break;if(Ac(g)){do g=t.input.charCodeAt(++t.position);while(Ac(g));if(g===35)do g=t.input.charCodeAt(++t.position);while(!mo(g)&&g!==0)}for(;g!==0;){for(nb(t),t.lineIndent=0,g=t.input.charCodeAt(t.position);(!i||t.lineIndent<l)&&g===32;)t.lineIndent++,g=t.input.charCodeAt(++t.position);if(!i&&t.lineIndent>l&&(l=t.lineIndent),mo(g)){c++;continue}if(t.lineIndent<l){a===DN?t.result+=Va.repeat(`
`,s?1+c:c):a===iw&&s&&(t.result+=`
`);break}for(n?Ac(g)?(d=!0,t.result+=Va.repeat(`
`,s?1+c:c)):d?(d=!1,t.result+=Va.repeat(`
`,c+1)):c===0?s&&(t.result+=" "):t.result+=Va.repeat(`
`,c):t.result+=Va.repeat(`
`,s?1+c:c),s=!0,i=!0,c=0,r=t.position;!mo(g)&&g!==0;)g=t.input.charCodeAt(++t.position);Rl(t,r,t.position,!1)}return!0}L(f4,"readBlockScalar");function O1(t,e){var r,n=t.tag,a=t.anchor,s=[],i,l=!1,c;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=s),c=t.input.charCodeAt(t.position);c!==0&&(t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Sr(t,"tab characters must not be used in indentation")),!(c!==45||(i=t.input.charCodeAt(t.position+1),!Ls(i))));){if(l=!0,t.position++,Ta(t,!0,-1)&&t.lineIndent<=e){s.push(null),c=t.input.charCodeAt(t.position);continue}if(r=t.line,Mu(t,e,t4,!1,!0),s.push(t.result),Ta(t,!0,-1),c=t.input.charCodeAt(t.position),(t.line===r||t.lineIndent>e)&&c!==0)Sr(t,"bad indentation of a sequence entry");else if(t.lineIndent<e)break}return l?(t.tag=n,t.anchor=a,t.kind="sequence",t.result=s,!0):!1}L(O1,"readBlockSequence");function m4(t,e,r){var n,a,s,i,l,c,d=t.tag,p=t.anchor,g={},m=Object.create(null),y=null,x=null,w=null,T=!1,k=!1,_;if(t.firstTabInLine!==-1)return!1;for(t.anchor!==null&&(t.anchorMap[t.anchor]=g),_=t.input.charCodeAt(t.position);_!==0;){if(!T&&t.firstTabInLine!==-1&&(t.position=t.firstTabInLine,Sr(t,"tab characters must not be used in indentation")),n=t.input.charCodeAt(t.position+1),s=t.line,(_===63||_===58)&&Ls(n))_===63?(T&&(Su(t,g,m,y,x,null,i,l,c),y=x=w=null),k=!0,T=!0,a=!0):T?(T=!1,a=!0):Sr(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,_=n;else{if(i=t.line,l=t.lineStart,c=t.position,!Mu(t,r,e4,!1,!0))break;if(t.line===s){for(_=t.input.charCodeAt(t.position);Ac(_);)_=t.input.charCodeAt(++t.position);if(_===58)_=t.input.charCodeAt(++t.position),Ls(_)||Sr(t,"a whitespace character is expected after the key-value separator within a block mapping"),T&&(Su(t,g,m,y,x,null,i,l,c),y=x=w=null),k=!0,T=!1,a=!1,y=t.tag,x=t.result;else if(k)Sr(t,"can not read an implicit mapping pair; a colon is missed");else return t.tag=d,t.anchor=p,!0}else if(k)Sr(t,"can not read a block mapping entry; a multiline key may not be an implicit key");else return t.tag=d,t.anchor=p,!0}if((t.line===s||t.lineIndent>e)&&(T&&(i=t.line,l=t.lineStart,c=t.position),Mu(t,e,ly,!0,a)&&(T?x=t.result:w=t.result),T||(Su(t,g,m,y,x,w,i,l,c),y=x=w=null),Ta(t,!0,-1),_=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>e)&&_!==0)Sr(t,"bad indentation of a mapping entry");else if(t.lineIndent<e)break}return T&&Su(t,g,m,y,x,null,i,l,c),k&&(t.tag=d,t.anchor=p,t.kind="mapping",t.result=g),k}L(m4,"readBlockMapping");function y4(t){var e,r=!1,n=!1,a,s,i;if(i=t.input.charCodeAt(t.position),i!==33)return!1;if(t.tag!==null&&Sr(t,"duplication of a tag property"),i=t.input.charCodeAt(++t.position),i===60?(r=!0,i=t.input.charCodeAt(++t.position)):i===33?(n=!0,a="!!",i=t.input.charCodeAt(++t.position)):a="!",e=t.position,r){do i=t.input.charCodeAt(++t.position);while(i!==0&&i!==62);t.position<t.length?(s=t.input.slice(e,t.position),i=t.input.charCodeAt(++t.position)):Sr(t,"unexpected end of the stream within a verbatim tag")}else{for(;i!==0&&!Ls(i);)i===33&&(n?Sr(t,"tag suffix cannot contain exclamation marks"):(a=t.input.slice(e-1,t.position+1),r4.test(a)||Sr(t,"named tag handle cannot contain such characters"),n=!0,e=t.position+1)),i=t.input.charCodeAt(++t.position);s=t.input.slice(e,t.position),Qle.test(s)&&Sr(t,"tag suffix cannot contain flow indicator characters")}s&&!n4.test(s)&&Sr(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch{Sr(t,"tag name is malformed: "+s)}return r?t.tag=s:Pc.call(t.tagMap,a)?t.tag=t.tagMap[a]+s:a==="!"?t.tag="!"+s:a==="!!"?t.tag="tag:yaml.org,2002:"+s:Sr(t,'undeclared tag handle "'+a+'"'),!0}L(y4,"readTagProperty");function b4(t){var e,r;if(r=t.input.charCodeAt(t.position),r!==38)return!1;for(t.anchor!==null&&Sr(t,"duplication of an anchor property"),r=t.input.charCodeAt(++t.position),e=t.position;r!==0&&!Ls(r)&&!wu(r);)r=t.input.charCodeAt(++t.position);return t.position===e&&Sr(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(e,t.position),!0}L(b4,"readAnchorProperty");function x4(t){var e,r,n;if(n=t.input.charCodeAt(t.position),n!==42)return!1;for(n=t.input.charCodeAt(++t.position),e=t.position;n!==0&&!Ls(n)&&!wu(n);)n=t.input.charCodeAt(++t.position);return t.position===e&&Sr(t,"name of an alias node must contain at least one character"),r=t.input.slice(e,t.position),Pc.call(t.anchorMap,r)||Sr(t,'unidentified alias "'+r+'"'),t.result=t.anchorMap[r],Ta(t,!0,-1),!0}L(x4,"readAlias");function Mu(t,e,r,n,a){var s,i,l,c=1,d=!1,p=!1,g,m,y,x,w,T;if(t.listener!==null&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=i=l=ly===r||t4===r,n&&Ta(t,!0,-1)&&(d=!0,t.lineIndent>e?c=1:t.lineIndent===e?c=0:t.lineIndent<e&&(c=-1)),c===1)for(;y4(t)||b4(t);)Ta(t,!0,-1)?(d=!0,l=s,t.lineIndent>e?c=1:t.lineIndent===e?c=0:t.lineIndent<e&&(c=-1)):l=!1;if(l&&(l=d||a),(c===1||ly===r)&&(oy===r||e4===r?w=e:w=e+1,T=t.position-t.lineStart,c===1?l&&(O1(t,T)||m4(t,T,w))||g4(t,w)?p=!0:(i&&f4(t,w)||h4(t,w)||p4(t,w)?p=!0:x4(t)?(p=!0,(t.tag!==null||t.anchor!==null)&&Sr(t,"alias node should not have any properties")):d4(t,w,oy===r)&&(p=!0,t.tag===null&&(t.tag="?")),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):c===0&&(p=l&&O1(t,T))),t.tag===null)t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);else if(t.tag==="?"){for(t.result!==null&&t.kind!=="scalar"&&Sr(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),g=0,m=t.implicitTypes.length;g<m;g+=1)if(x=t.implicitTypes[g],x.resolve(t.result)){t.result=x.construct(t.result),t.tag=x.tag,t.anchor!==null&&(t.anchorMap[t.anchor]=t.result);break}}else if(t.tag!=="!"){if(Pc.call(t.typeMap[t.kind||"fallback"],t.tag))x=t.typeMap[t.kind||"fallback"][t.tag];else for(x=null,y=t.typeMap.multi[t.kind||"fallback"],g=0,m=y.length;g<m;g+=1)if(t.tag.slice(0,y[g].tag.length)===y[g].tag){x=y[g];break}x||Sr(t,"unknown tag !<"+t.tag+">"),t.result!==null&&x.kind!==t.kind&&Sr(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+x.kind+'", not "'+t.kind+'"'),x.resolve(t.result,t.tag)?(t.result=x.construct(t.result,t.tag),t.anchor!==null&&(t.anchorMap[t.anchor]=t.result)):Sr(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return t.listener!==null&&t.listener("close",t),t.tag!==null||t.anchor!==null||p}L(Mu,"composeNode");function v4(t){var e=t.position,r,n,a,s=!1,i;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);(i=t.input.charCodeAt(t.position))!==0&&(Ta(t,!0,-1),i=t.input.charCodeAt(t.position),!(t.lineIndent>0||i!==37));){for(s=!0,i=t.input.charCodeAt(++t.position),r=t.position;i!==0&&!Ls(i);)i=t.input.charCodeAt(++t.position);for(n=t.input.slice(r,t.position),a=[],n.length<1&&Sr(t,"directive name must not be less than one character in length");i!==0;){for(;Ac(i);)i=t.input.charCodeAt(++t.position);if(i===35){do i=t.input.charCodeAt(++t.position);while(i!==0&&!mo(i));break}if(mo(i))break;for(r=t.position;i!==0&&!Ls(i);)i=t.input.charCodeAt(++t.position);a.push(t.input.slice(r,t.position))}i!==0&&nb(t),Pc.call(LN,n)?LN[n](t,n,a):zg(t,'unknown document directive "'+n+'"')}if(Ta(t,!0,-1),t.lineIndent===0&&t.input.charCodeAt(t.position)===45&&t.input.charCodeAt(t.position+1)===45&&t.input.charCodeAt(t.position+2)===45?(t.position+=3,Ta(t,!0,-1)):s&&Sr(t,"directives end mark is expected"),Mu(t,t.lineIndent-1,ly,!1,!0),Ta(t,!0,-1),t.checkLineBreaks&&Yle.test(t.input.slice(e,t.position))&&zg(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&yf(t)){t.input.charCodeAt(t.position)===46&&(t.position+=3,Ta(t,!0,-1));return}if(t.position<t.length-1)Sr(t,"end of the stream or a document separator is expected");else return}L(v4,"readDocument");function Tk(t,e){t=String(t),e=e||{},t.length!==0&&(t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t.charCodeAt(0)===65279&&(t=t.slice(1)));var r=new u4(t,e),n=t.indexOf("\0");for(n!==-1&&(r.position=n,Sr(r,"null byte is not allowed in input")),r.input+="\0";r.input.charCodeAt(r.position)===32;)r.lineIndent+=1,r.position+=1;for(;r.position<r.length-1;)v4(r);return r.documents}L(Tk,"loadDocuments");function Kle(t,e,r){e!==null&&typeof e=="object"&&typeof r>"u"&&(r=e,e=null);var n=Tk(t,r);if(typeof e!="function")return n;for(var a=0,s=n.length;a<s;a+=1)e(n[a])}L(Kle,"loadAll$1");function w4(t,e){var r=Tk(t,e);if(r.length!==0){if(r.length===1)return r[0];throw new si("expected a single document in the stream, but found more")}}L(w4,"load$1");var Xle=w4,Jle={load:Xle},S4=Object.prototype.toString,k4=Object.prototype.hasOwnProperty,Ck=65279,Zle=9,$g=10,ece=13,tce=32,rce=33,nce=34,j1=35,ace=37,sce=38,ice=39,oce=42,T4=44,lce=45,cy=58,cce=61,uce=62,dce=63,hce=64,C4=91,E4=93,pce=96,_4=123,gce=124,A4=125,Ts={};Ts[0]="\\0";Ts[7]="\\a";Ts[8]="\\b";Ts[9]="\\t";Ts[10]="\\n";Ts[11]="\\v";Ts[12]="\\f";Ts[13]="\\r";Ts[27]="\\e";Ts[34]='\\"';Ts[92]="\\\\";Ts[133]="\\N";Ts[160]="\\_";Ts[8232]="\\L";Ts[8233]="\\P";var fce=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],mce=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function N4(t,e){var r,n,a,s,i,l,c;if(e===null)return{};for(r={},n=Object.keys(e),a=0,s=n.length;a<s;a+=1)i=n[a],l=String(e[i]),i.slice(0,2)==="!!"&&(i="tag:yaml.org,2002:"+i.slice(2)),c=t.compiledTypeMap.fallback[i],c&&k4.call(c.styleAliases,l)&&(l=c.styleAliases[l]),r[i]=l;return r}L(N4,"compileStyleMap");function P4(t){var e,r,n;if(e=t.toString(16).toUpperCase(),t<=255)r="x",n=2;else if(t<=65535)r="u",n=4;else if(t<=4294967295)r="U",n=8;else throw new si("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+r+Va.repeat("0",n-e.length)+e}L(P4,"encodeHex");var yce=1,Ug=2;function I4(t){this.schema=t.schema||ZM,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=Va.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=N4(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType=t.quotingType==='"'?Ug:yce,this.forceQuotes=t.forceQuotes||!1,this.replacer=typeof t.replacer=="function"?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}L(I4,"State");function B1(t,e){for(var r=Va.repeat(" ",e),n=0,a=-1,s="",i,l=t.length;n<l;)a=t.indexOf(`
`,n),a===-1?(i=t.slice(n),n=l):(i=t.slice(n,a+1),n=a+1),i.length&&i!==`
`&&(s+=r),s+=i;return s}L(B1,"indentString");function uy(t,e){return`
`+Va.repeat(" ",t.indent*e)}L(uy,"generateNextLine");function R4(t,e){var r,n,a;for(r=0,n=t.implicitTypes.length;r<n;r+=1)if(a=t.implicitTypes[r],a.resolve(e))return!0;return!1}L(R4,"testImplicitResolving");function qg(t){return t===tce||t===Zle}L(qg,"isWhitespace");function vh(t){return 32<=t&&t<=126||161<=t&&t<=55295&&t!==8232&&t!==8233||57344<=t&&t<=65533&&t!==Ck||65536<=t&&t<=1114111}L(vh,"isPrintable");function F1(t){return vh(t)&&t!==Ck&&t!==ece&&t!==$g}L(F1,"isNsCharOrWhitespace");function z1(t,e,r){var n=F1(t),a=n&&!qg(t);return(r?n:n&&t!==T4&&t!==C4&&t!==E4&&t!==_4&&t!==A4)&&t!==j1&&!(e===cy&&!a)||F1(e)&&!qg(e)&&t===j1||e===cy&&a}L(z1,"isPlainSafe");function D4(t){return vh(t)&&t!==Ck&&!qg(t)&&t!==lce&&t!==dce&&t!==cy&&t!==T4&&t!==C4&&t!==E4&&t!==_4&&t!==A4&&t!==j1&&t!==sce&&t!==oce&&t!==rce&&t!==gce&&t!==cce&&t!==uce&&t!==ice&&t!==nce&&t!==ace&&t!==hce&&t!==pce}L(D4,"isPlainSafeFirst");function L4(t){return!qg(t)&&t!==cy}L(L4,"isPlainSafeLast");function Qd(t,e){var r=t.charCodeAt(e),n;return r>=55296&&r<=56319&&e+1<t.length&&(n=t.charCodeAt(e+1),n>=56320&&n<=57343)?(r-55296)*1024+n-56320+65536:r}L(Qd,"codePointAt");function Ek(t){var e=/^\n* /;return e.test(t)}L(Ek,"needIndentIndicator");var M4=1,$1=2,O4=3,j4=4,Hd=5;function B4(t,e,r,n,a,s,i,l){var c,d=0,p=null,g=!1,m=!1,y=n!==-1,x=-1,w=D4(Qd(t,0))&&L4(Qd(t,t.length-1));if(e||i)for(c=0;c<t.length;d>=65536?c+=2:c++){if(d=Qd(t,c),!vh(d))return Hd;w=w&&z1(d,p,l),p=d}else{for(c=0;c<t.length;d>=65536?c+=2:c++){if(d=Qd(t,c),d===$g)g=!0,y&&(m=m||c-x-1>n&&t[x+1]!==" ",x=c);else if(!vh(d))return Hd;w=w&&z1(d,p,l),p=d}m=m||y&&c-x-1>n&&t[x+1]!==" "}return!g&&!m?w&&!i&&!a(t)?M4:s===Ug?Hd:$1:r>9&&Ek(t)?Hd:i?s===Ug?Hd:$1:m?j4:O4}L(B4,"chooseScalarStyle");function F4(t,e,r,n,a){t.dump=(function(){if(e.length===0)return t.quotingType===Ug?'""':"''";if(!t.noCompatMode&&(fce.indexOf(e)!==-1||mce.test(e)))return t.quotingType===Ug?'"'+e+'"':"'"+e+"'";var s=t.indent*Math.max(1,r),i=t.lineWidth===-1?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-s),l=n||t.flowLevel>-1&&r>=t.flowLevel;function c(d){return R4(t,d)}switch(L(c,"testAmbiguity"),B4(e,l,t.indent,i,c,t.quotingType,t.forceQuotes&&!n,a)){case M4:return e;case $1:return"'"+e.replace(/'/g,"''")+"'";case O4:return"|"+U1(e,t.indent)+q1(B1(e,s));case j4:return">"+U1(e,t.indent)+q1(B1(z4(e,i),s));case Hd:return'"'+$4(e)+'"';default:throw new si("impossible error: invalid scalar style")}})()}L(F4,"writeScalar");function U1(t,e){var r=Ek(t)?String(e):"",n=t[t.length-1]===`
`,a=n&&(t[t.length-2]===`
`||t===`
`),s=a?"+":n?"":"-";return r+s+`
`}L(U1,"blockHeader");function q1(t){return t[t.length-1]===`
`?t.slice(0,-1):t}L(q1,"dropEndingNewline");function z4(t,e){for(var r=/(\n+)([^\n]*)/g,n=(function(){var d=t.indexOf(`
`);return d=d!==-1?d:t.length,r.lastIndex=d,H1(t.slice(0,d),e)})(),a=t[0]===`
`||t[0]===" ",s,i;i=r.exec(t);){var l=i[1],c=i[2];s=c[0]===" ",n+=l+(!a&&!s&&c!==""?`
`:"")+H1(c,e),a=s}return n}L(z4,"foldString");function H1(t,e){if(t===""||t[0]===" ")return t;for(var r=/ [^ ]/g,n,a=0,s,i=0,l=0,c="";n=r.exec(t);)l=n.index,l-a>e&&(s=i>a?i:l,c+=`
`+t.slice(a,s),a=s+1),i=l;return c+=`
`,t.length-a>e&&i>a?c+=t.slice(a,i)+`
`+t.slice(i+1):c+=t.slice(a),c.slice(1)}L(H1,"foldLine");function $4(t){for(var e="",r=0,n,a=0;a<t.length;r>=65536?a+=2:a++)r=Qd(t,a),n=Ts[r],!n&&vh(r)?(e+=t[a],r>=65536&&(e+=t[a+1])):e+=n||P4(r);return e}L($4,"escapeString");function U4(t,e,r){var n="",a=t.tag,s,i,l;for(s=0,i=r.length;s<i;s+=1)l=r[s],t.replacer&&(l=t.replacer.call(r,String(s),l)),(Ko(t,e,l,!1,!1)||typeof l>"u"&&Ko(t,e,null,!1,!1))&&(n!==""&&(n+=","+(t.condenseFlow?"":" ")),n+=t.dump);t.tag=a,t.dump="["+n+"]"}L(U4,"writeFlowSequence");function G1(t,e,r,n){var a="",s=t.tag,i,l,c;for(i=0,l=r.length;i<l;i+=1)c=r[i],t.replacer&&(c=t.replacer.call(r,String(i),c)),(Ko(t,e+1,c,!0,!0,!1,!0)||typeof c>"u"&&Ko(t,e+1,null,!0,!0,!1,!0))&&((!n||a!=="")&&(a+=uy(t,e)),t.dump&&$g===t.dump.charCodeAt(0)?a+="-":a+="- ",a+=t.dump);t.tag=s,t.dump=a||"[]"}L(G1,"writeBlockSequence");function q4(t,e,r){var n="",a=t.tag,s=Object.keys(r),i,l,c,d,p;for(i=0,l=s.length;i<l;i+=1)p="",n!==""&&(p+=", "),t.condenseFlow&&(p+='"'),c=s[i],d=r[c],t.replacer&&(d=t.replacer.call(r,c,d)),Ko(t,e,c,!1,!1)&&(t.dump.length>1024&&(p+="? "),p+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),Ko(t,e,d,!1,!1)&&(p+=t.dump,n+=p));t.tag=a,t.dump="{"+n+"}"}L(q4,"writeFlowMapping");function H4(t,e,r,n){var a="",s=t.tag,i=Object.keys(r),l,c,d,p,g,m;if(t.sortKeys===!0)i.sort();else if(typeof t.sortKeys=="function")i.sort(t.sortKeys);else if(t.sortKeys)throw new si("sortKeys must be a boolean or a function");for(l=0,c=i.length;l<c;l+=1)m="",(!n||a!=="")&&(m+=uy(t,e)),d=i[l],p=r[d],t.replacer&&(p=t.replacer.call(r,d,p)),Ko(t,e+1,d,!0,!0,!0)&&(g=t.tag!==null&&t.tag!=="?"||t.dump&&t.dump.length>1024,g&&(t.dump&&$g===t.dump.charCodeAt(0)?m+="?":m+="? "),m+=t.dump,g&&(m+=uy(t,e)),Ko(t,e+1,p,!0,g)&&(t.dump&&$g===t.dump.charCodeAt(0)?m+=":":m+=": ",m+=t.dump,a+=m));t.tag=s,t.dump=a||"{}"}L(H4,"writeBlockMapping");function V1(t,e,r){var n,a,s,i,l,c;for(a=r?t.explicitTypes:t.implicitTypes,s=0,i=a.length;s<i;s+=1)if(l=a[s],(l.instanceOf||l.predicate)&&(!l.instanceOf||typeof e=="object"&&e instanceof l.instanceOf)&&(!l.predicate||l.predicate(e))){if(r?l.multi&&l.representName?t.tag=l.representName(e):t.tag=l.tag:t.tag="?",l.represent){if(c=t.styleMap[l.tag]||l.defaultStyle,S4.call(l.represent)==="[object Function]")n=l.represent(e,c);else if(k4.call(l.represent,c))n=l.represent[c](e,c);else throw new si("!<"+l.tag+'> tag resolver accepts not "'+c+'" style');t.dump=n}return!0}return!1}L(V1,"detectType");function Ko(t,e,r,n,a,s,i){t.tag=null,t.dump=r,V1(t,r,!1)||V1(t,r,!0);var l=S4.call(t.dump),c=n,d;n&&(n=t.flowLevel<0||t.flowLevel>e);var p=l==="[object Object]"||l==="[object Array]",g,m;if(p&&(g=t.duplicates.indexOf(r),m=g!==-1),(t.tag!==null&&t.tag!=="?"||m||t.indent!==2&&e>0)&&(a=!1),m&&t.usedDuplicates[g])t.dump="*ref_"+g;else{if(p&&m&&!t.usedDuplicates[g]&&(t.usedDuplicates[g]=!0),l==="[object Object]")n&&Object.keys(t.dump).length!==0?(H4(t,e,t.dump,a),m&&(t.dump="&ref_"+g+t.dump)):(q4(t,e,t.dump),m&&(t.dump="&ref_"+g+" "+t.dump));else if(l==="[object Array]")n&&t.dump.length!==0?(t.noArrayIndent&&!i&&e>0?G1(t,e-1,t.dump,a):G1(t,e,t.dump,a),m&&(t.dump="&ref_"+g+t.dump)):(U4(t,e,t.dump),m&&(t.dump="&ref_"+g+" "+t.dump));else if(l==="[object String]")t.tag!=="?"&&F4(t,t.dump,e,s,c);else{if(l==="[object Undefined]")return!1;if(t.skipInvalid)return!1;throw new si("unacceptable kind of an object to dump "+l)}t.tag!==null&&t.tag!=="?"&&(d=encodeURI(t.tag[0]==="!"?t.tag.slice(1):t.tag).replace(/!/g,"%21"),t.tag[0]==="!"?d="!"+d:d.slice(0,18)==="tag:yaml.org,2002:"?d="!!"+d.slice(18):d="!<"+d+">",t.dump=d+" "+t.dump)}return!0}L(Ko,"writeNode");function G4(t,e){var r=[],n=[],a,s;for(dy(t,r,n),a=0,s=n.length;a<s;a+=1)e.duplicates.push(r[n[a]]);e.usedDuplicates=new Array(s)}L(G4,"getDuplicateReferences");function dy(t,e,r){var n,a,s;if(t!==null&&typeof t=="object")if(a=e.indexOf(t),a!==-1)r.indexOf(a)===-1&&r.push(a);else if(e.push(t),Array.isArray(t))for(a=0,s=t.length;a<s;a+=1)dy(t[a],e,r);else for(n=Object.keys(t),a=0,s=n.length;a<s;a+=1)dy(t[n[a]],e,r)}L(dy,"inspectNode");function bce(t,e){e=e||{};var r=new I4(e);r.noRefs||G4(t,r);var n=t;return r.replacer&&(n=r.replacer.call({"":n},"",n)),Ko(r,0,n,!0,!0)?r.dump+`
`:""}L(bce,"dump$1");function xce(t,e){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+e+" instead, which is now safe by default.")}}L(xce,"renamed");var vce=OM,wce=Jle.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var fs={aggregation:17.25,extension:17.25,composition:17.25,dependency:6,lollipop:13.5,arrow_point:4},MN={arrow_point:9,arrow_cross:12.5,arrow_circle:12.5};function tg(t,e){if(t===void 0||e===void 0)return{angle:0,deltaX:0,deltaY:0};t=la(t),e=la(e);const[r,n]=[t.x,t.y],[a,s]=[e.x,e.y],i=a-r,l=s-n;return{angle:Math.atan(l/i),deltaX:i,deltaY:l}}L(tg,"calculateDeltaAndAngle");var la=L(t=>Array.isArray(t)?{x:t[0],y:t[1]}:t,"pointTransformer"),Sce=L(t=>({x:L(function(e,r,n){let a=0;const s=la(n[0]).x<la(n[n.length-1]).x?"left":"right";if(r===0&&Object.hasOwn(fs,t.arrowTypeStart)){const{angle:y,deltaX:x}=tg(n[0],n[1]);a=fs[t.arrowTypeStart]*Math.cos(y)*(x>=0?1:-1)}else if(r===n.length-1&&Object.hasOwn(fs,t.arrowTypeEnd)){const{angle:y,deltaX:x}=tg(n[n.length-1],n[n.length-2]);a=fs[t.arrowTypeEnd]*Math.cos(y)*(x>=0?1:-1)}const i=Math.abs(la(e).x-la(n[n.length-1]).x),l=Math.abs(la(e).y-la(n[n.length-1]).y),c=Math.abs(la(e).x-la(n[0]).x),d=Math.abs(la(e).y-la(n[0]).y),p=fs[t.arrowTypeStart],g=fs[t.arrowTypeEnd],m=1;if(i<g&&i>0&&l<g){let y=g+m-i;y*=s==="right"?-1:1,a-=y}if(c<p&&c>0&&d<p){let y=p+m-c;y*=s==="right"?-1:1,a+=y}return la(e).x+a},"x"),y:L(function(e,r,n){let a=0;const s=la(n[0]).y<la(n[n.length-1]).y?"down":"up";if(r===0&&Object.hasOwn(fs,t.arrowTypeStart)){const{angle:y,deltaY:x}=tg(n[0],n[1]);a=fs[t.arrowTypeStart]*Math.abs(Math.sin(y))*(x>=0?1:-1)}else if(r===n.length-1&&Object.hasOwn(fs,t.arrowTypeEnd)){const{angle:y,deltaY:x}=tg(n[n.length-1],n[n.length-2]);a=fs[t.arrowTypeEnd]*Math.abs(Math.sin(y))*(x>=0?1:-1)}const i=Math.abs(la(e).y-la(n[n.length-1]).y),l=Math.abs(la(e).x-la(n[n.length-1]).x),c=Math.abs(la(e).y-la(n[0]).y),d=Math.abs(la(e).x-la(n[0]).x),p=fs[t.arrowTypeStart],g=fs[t.arrowTypeEnd],m=1;if(i<g&&i>0&&l<g){let y=g+m-i;y*=s==="up"?-1:1,a-=y}if(c<p&&c>0&&d<p){let y=p+m-c;y*=s==="up"?-1:1,a+=y}return la(e).y+a},"y")}),"getLineFunctionsWithOffset"),_k=L(({flowchart:t})=>{const e=t?.subGraphTitleMargin?.top??0,r=t?.subGraphTitleMargin?.bottom??0,n=e+r;return{subGraphTitleTopMargin:e,subGraphTitleBottomMargin:r,subGraphTitleTotalMargin:n}},"getSubGraphTitleMargins"),kce=L(t=>{const{handDrawnSeed:e}=In();return{fill:t,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:t,seed:e}},"solidStateFill"),Lh=L(t=>{const e=Tce([...t.cssCompiledStyles||[],...t.cssStyles||[],...t.labelStyle||[]]);return{stylesMap:e,stylesArray:[...e]}},"compileStyles"),Tce=L(t=>{const e=new Map;return t.forEach(r=>{const[n,a]=r.split(":");e.set(n.trim(),a?.trim())}),e},"styles2Map"),V4=L(t=>t==="color"||t==="font-size"||t==="font-family"||t==="font-weight"||t==="font-style"||t==="text-decoration"||t==="text-align"||t==="text-transform"||t==="line-height"||t==="letter-spacing"||t==="word-spacing"||t==="text-shadow"||t==="text-overflow"||t==="white-space"||t==="word-wrap"||t==="word-break"||t==="overflow-wrap"||t==="hyphens","isLabelStyle"),gr=L(t=>{const{stylesArray:e}=Lh(t),r=[],n=[],a=[],s=[];return e.forEach(i=>{const l=i[0];V4(l)?r.push(i.join(":")+" !important"):(n.push(i.join(":")+" !important"),l.includes("stroke")&&a.push(i.join(":")+" !important"),l==="fill"&&s.push(i.join(":")+" !important"))}),{labelStyles:r.join(";"),nodeStyles:n.join(";"),stylesArray:e,borderStyles:a,backgroundStyles:s}},"styles2String"),pr=L((t,e)=>{const{themeVariables:r,handDrawnSeed:n}=In(),{nodeBorder:a,mainBkg:s}=r,{stylesMap:i}=Lh(t);return Object.assign({roughness:.7,fill:i.get("fill")||s,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:i.get("stroke")||a,seed:n,strokeWidth:i.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0],strokeLineDash:Cce(i.get("stroke-dasharray"))},e)},"userNodeOverrides"),Cce=L(t=>{if(!t)return[0,0];const e=t.trim().split(/\s+/).map(Number);if(e.length===1){const a=isNaN(e[0])?0:e[0];return[a,a]}const r=isNaN(e[0])?0:e[0],n=isNaN(e[1])?0:e[1];return[r,n]},"getStrokeDashArray"),qp={},qa={},ON;function Ece(){return ON||(ON=1,Object.defineProperty(qa,"__esModule",{value:!0}),qa.BLANK_URL=qa.relativeFirstCharacters=qa.whitespaceEscapeCharsRegex=qa.urlSchemeRegex=qa.ctrlCharactersRegex=qa.htmlCtrlEntityRegex=qa.htmlEntitiesRegex=qa.invalidProtocolRegex=void 0,qa.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,qa.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,qa.htmlCtrlEntityRegex=/&(newline|tab);/gi,qa.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,qa.urlSchemeRegex=/^.+(:|&colon;)/gim,qa.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,qa.relativeFirstCharacters=[".","/"],qa.BLANK_URL="about:blank"),qa}var jN;function _ce(){if(jN)return qp;jN=1,Object.defineProperty(qp,"__esModule",{value:!0}),qp.sanitizeUrl=void 0;var t=Ece();function e(i){return t.relativeFirstCharacters.indexOf(i[0])>-1}function r(i){var l=i.replace(t.ctrlCharactersRegex,"");return l.replace(t.htmlEntitiesRegex,function(c,d){return String.fromCharCode(d)})}function n(i){return URL.canParse(i)}function a(i){try{return decodeURIComponent(i)}catch{return i}}function s(i){if(!i)return t.BLANK_URL;var l,c=a(i.trim());do c=r(c).replace(t.htmlCtrlEntityRegex,"").replace(t.ctrlCharactersRegex,"").replace(t.whitespaceEscapeCharsRegex,"").trim(),c=a(c),l=c.match(t.ctrlCharactersRegex)||c.match(t.htmlEntitiesRegex)||c.match(t.htmlCtrlEntityRegex)||c.match(t.whitespaceEscapeCharsRegex);while(l&&l.length>0);var d=c;if(!d)return t.BLANK_URL;if(e(d))return d;var p=d.trimStart(),g=p.match(t.urlSchemeRegex);if(!g)return d;var m=g[0].toLowerCase().trim();if(t.invalidProtocolRegex.test(m))return t.BLANK_URL;var y=p.replace(/\\/g,"/");if(m==="mailto:"||m.includes("://"))return y;if(m==="http:"||m==="https:"){if(!n(y))return t.BLANK_URL;var x=new URL(y);return x.protocol=x.protocol.toLowerCase(),x.hostname=x.hostname.toLowerCase(),x.toString()}return y}return qp.sanitizeUrl=s,qp}var Ace=_ce(),W4=typeof global=="object"&&global&&global.Object===Object&&global,Nce=typeof self=="object"&&self&&self.Object===Object&&self,rl=W4||Nce||Function("return this")(),hy=rl.Symbol,Y4=Object.prototype,Pce=Y4.hasOwnProperty,Ice=Y4.toString,Hp=hy?hy.toStringTag:void 0;function Rce(t){var e=Pce.call(t,Hp),r=t[Hp];try{t[Hp]=void 0;var n=!0}catch{}var a=Ice.call(t);return n&&(e?t[Hp]=r:delete t[Hp]),a}var Dce=Object.prototype,Lce=Dce.toString;function Mce(t){return Lce.call(t)}var Oce="[object Null]",jce="[object Undefined]",BN=hy?hy.toStringTag:void 0;function Mh(t){return t==null?t===void 0?jce:Oce:BN&&BN in Object(t)?Rce(t):Mce(t)}function Hu(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Bce="[object AsyncFunction]",Fce="[object Function]",zce="[object GeneratorFunction]",$ce="[object Proxy]";function Ak(t){if(!Hu(t))return!1;var e=Mh(t);return e==Fce||e==zce||e==Bce||e==$ce}var ow=rl["__core-js_shared__"],FN=(function(){var t=/[^.]+$/.exec(ow&&ow.keys&&ow.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""})();function Uce(t){return!!FN&&FN in t}var qce=Function.prototype,Hce=qce.toString;function Gu(t){if(t!=null){try{return Hce.call(t)}catch{}try{return t+""}catch{}}return""}var Gce=/[\\^$.*+?()[\]{}|]/g,Vce=/^\[object .+?Constructor\]$/,Wce=Function.prototype,Yce=Object.prototype,Qce=Wce.toString,Kce=Yce.hasOwnProperty,Xce=RegExp("^"+Qce.call(Kce).replace(Gce,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Jce(t){if(!Hu(t)||Uce(t))return!1;var e=Ak(t)?Xce:Vce;return e.test(Gu(t))}function Zce(t,e){return t?.[e]}function Vu(t,e){var r=Zce(t,e);return Jce(r)?r:void 0}var Hg=Vu(Object,"create");function eue(){this.__data__=Hg?Hg(null):{},this.size=0}function tue(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var rue="__lodash_hash_undefined__",nue=Object.prototype,aue=nue.hasOwnProperty;function sue(t){var e=this.__data__;if(Hg){var r=e[t];return r===rue?void 0:r}return aue.call(e,t)?e[t]:void 0}var iue=Object.prototype,oue=iue.hasOwnProperty;function lue(t){var e=this.__data__;return Hg?e[t]!==void 0:oue.call(e,t)}var cue="__lodash_hash_undefined__";function uue(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=Hg&&e===void 0?cue:e,this}function Ou(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Ou.prototype.clear=eue;Ou.prototype.delete=tue;Ou.prototype.get=sue;Ou.prototype.has=lue;Ou.prototype.set=uue;function due(){this.__data__=[],this.size=0}function sb(t,e){return t===e||t!==t&&e!==e}function ib(t,e){for(var r=t.length;r--;)if(sb(t[r][0],e))return r;return-1}var hue=Array.prototype,pue=hue.splice;function gue(t){var e=this.__data__,r=ib(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():pue.call(e,r,1),--this.size,!0}function fue(t){var e=this.__data__,r=ib(e,t);return r<0?void 0:e[r][1]}function mue(t){return ib(this.__data__,t)>-1}function yue(t,e){var r=this.__data__,n=ib(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function zl(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}zl.prototype.clear=due;zl.prototype.delete=gue;zl.prototype.get=fue;zl.prototype.has=mue;zl.prototype.set=yue;var Gg=Vu(rl,"Map");function bue(){this.size=0,this.__data__={hash:new Ou,map:new(Gg||zl),string:new Ou}}function xue(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function ob(t,e){var r=t.__data__;return xue(e)?r[typeof e=="string"?"string":"hash"]:r.map}function vue(t){var e=ob(this,t).delete(t);return this.size-=e?1:0,e}function wue(t){return ob(this,t).get(t)}function Sue(t){return ob(this,t).has(t)}function kue(t,e){var r=ob(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Oc(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Oc.prototype.clear=bue;Oc.prototype.delete=vue;Oc.prototype.get=wue;Oc.prototype.has=Sue;Oc.prototype.set=kue;var Tue="Expected a function";function bf(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Tue);var r=function(){var n=arguments,a=e?e.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=t.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(bf.Cache||Oc),r}bf.Cache=Oc;function Cue(){this.__data__=new zl,this.size=0}function Eue(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function _ue(t){return this.__data__.get(t)}function Aue(t){return this.__data__.has(t)}var Nue=200;function Pue(t,e){var r=this.__data__;if(r instanceof zl){var n=r.__data__;if(!Gg||n.length<Nue-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Oc(n)}return r.set(t,e),this.size=r.size,this}function Oh(t){var e=this.__data__=new zl(t);this.size=e.size}Oh.prototype.clear=Cue;Oh.prototype.delete=Eue;Oh.prototype.get=_ue;Oh.prototype.has=Aue;Oh.prototype.set=Pue;var py=(function(){try{var t=Vu(Object,"defineProperty");return t({},"",{}),t}catch{}})();function Nk(t,e,r){e=="__proto__"&&py?py(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function W1(t,e,r){(r!==void 0&&!sb(t[e],r)||r===void 0&&!(e in t))&&Nk(t,e,r)}function Iue(t){return function(e,r,n){for(var a=-1,s=Object(e),i=n(e),l=i.length;l--;){var c=i[++a];if(r(s[c],c,s)===!1)break}return e}}var Rue=Iue(),Q4=typeof exports=="object"&&exports&&!exports.nodeType&&exports,zN=Q4&&typeof module=="object"&&module&&!module.nodeType&&module,Due=zN&&zN.exports===Q4,$N=Due?rl.Buffer:void 0,UN=$N?$N.allocUnsafe:void 0;function Lue(t,e){if(e)return t.slice();var r=t.length,n=UN?UN(r):new t.constructor(r);return t.copy(n),n}var qN=rl.Uint8Array;function Mue(t){var e=new t.constructor(t.byteLength);return new qN(e).set(new qN(t)),e}function Oue(t,e){var r=e?Mue(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function jue(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var HN=Object.create,Bue=(function(){function t(){}return function(e){if(!Hu(e))return{};if(HN)return HN(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}})();function K4(t,e){return function(r){return t(e(r))}}var X4=K4(Object.getPrototypeOf,Object),Fue=Object.prototype;function lb(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Fue;return t===r}function zue(t){return typeof t.constructor=="function"&&!lb(t)?Bue(X4(t)):{}}function xf(t){return t!=null&&typeof t=="object"}var $ue="[object Arguments]";function GN(t){return xf(t)&&Mh(t)==$ue}var J4=Object.prototype,Uue=J4.hasOwnProperty,que=J4.propertyIsEnumerable,gy=GN((function(){return arguments})())?GN:function(t){return xf(t)&&Uue.call(t,"callee")&&!que.call(t,"callee")},fy=Array.isArray,Hue=9007199254740991;function Z4(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Hue}function cb(t){return t!=null&&Z4(t.length)&&!Ak(t)}function Gue(t){return xf(t)&&cb(t)}function Vue(){return!1}var eO=typeof exports=="object"&&exports&&!exports.nodeType&&exports,VN=eO&&typeof module=="object"&&module&&!module.nodeType&&module,Wue=VN&&VN.exports===eO,WN=Wue?rl.Buffer:void 0,Yue=WN?WN.isBuffer:void 0,Pk=Yue||Vue,Que="[object Object]",Kue=Function.prototype,Xue=Object.prototype,tO=Kue.toString,Jue=Xue.hasOwnProperty,Zue=tO.call(Object);function ede(t){if(!xf(t)||Mh(t)!=Que)return!1;var e=X4(t);if(e===null)return!0;var r=Jue.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&tO.call(r)==Zue}var tde="[object Arguments]",rde="[object Array]",nde="[object Boolean]",ade="[object Date]",sde="[object Error]",ide="[object Function]",ode="[object Map]",lde="[object Number]",cde="[object Object]",ude="[object RegExp]",dde="[object Set]",hde="[object String]",pde="[object WeakMap]",gde="[object ArrayBuffer]",fde="[object DataView]",mde="[object Float32Array]",yde="[object Float64Array]",bde="[object Int8Array]",xde="[object Int16Array]",vde="[object Int32Array]",wde="[object Uint8Array]",Sde="[object Uint8ClampedArray]",kde="[object Uint16Array]",Tde="[object Uint32Array]",aa={};aa[mde]=aa[yde]=aa[bde]=aa[xde]=aa[vde]=aa[wde]=aa[Sde]=aa[kde]=aa[Tde]=!0;aa[tde]=aa[rde]=aa[gde]=aa[nde]=aa[fde]=aa[ade]=aa[sde]=aa[ide]=aa[ode]=aa[lde]=aa[cde]=aa[ude]=aa[dde]=aa[hde]=aa[pde]=!1;function Cde(t){return xf(t)&&Z4(t.length)&&!!aa[Mh(t)]}function Ede(t){return function(e){return t(e)}}var rO=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Tg=rO&&typeof module=="object"&&module&&!module.nodeType&&module,_de=Tg&&Tg.exports===rO,lw=_de&&W4.process,YN=(function(){try{var t=Tg&&Tg.require&&Tg.require("util").types;return t||lw&&lw.binding&&lw.binding("util")}catch{}})(),QN=YN&&YN.isTypedArray,Ik=QN?Ede(QN):Cde;function Y1(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Ade=Object.prototype,Nde=Ade.hasOwnProperty;function Pde(t,e,r){var n=t[e];(!(Nde.call(t,e)&&sb(n,r))||r===void 0&&!(e in t))&&Nk(t,e,r)}function Ide(t,e,r,n){var a=!r;r||(r={});for(var s=-1,i=e.length;++s<i;){var l=e[s],c=void 0;c===void 0&&(c=t[l]),a?Nk(r,l,c):Pde(r,l,c)}return r}function Rde(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Dde=9007199254740991,Lde=/^(?:0|[1-9]\d*)$/;function nO(t,e){var r=typeof t;return e=e??Dde,!!e&&(r=="number"||r!="symbol"&&Lde.test(t))&&t>-1&&t%1==0&&t<e}var Mde=Object.prototype,Ode=Mde.hasOwnProperty;function jde(t,e){var r=fy(t),n=!r&&gy(t),a=!r&&!n&&Pk(t),s=!r&&!n&&!a&&Ik(t),i=r||n||a||s,l=i?Rde(t.length,String):[],c=l.length;for(var d in t)(e||Ode.call(t,d))&&!(i&&(d=="length"||a&&(d=="offset"||d=="parent")||s&&(d=="buffer"||d=="byteLength"||d=="byteOffset")||nO(d,c)))&&l.push(d);return l}function Bde(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Fde=Object.prototype,zde=Fde.hasOwnProperty;function $de(t){if(!Hu(t))return Bde(t);var e=lb(t),r=[];for(var n in t)n=="constructor"&&(e||!zde.call(t,n))||r.push(n);return r}function aO(t){return cb(t)?jde(t,!0):$de(t)}function Ude(t){return Ide(t,aO(t))}function qde(t,e,r,n,a,s,i){var l=Y1(t,r),c=Y1(e,r),d=i.get(c);if(d){W1(t,r,d);return}var p=s?s(l,c,r+"",t,e,i):void 0,g=p===void 0;if(g){var m=fy(c),y=!m&&Pk(c),x=!m&&!y&&Ik(c);p=c,m||y||x?fy(l)?p=l:Gue(l)?p=jue(l):y?(g=!1,p=Lue(c,!0)):x?(g=!1,p=Oue(c,!0)):p=[]:ede(c)||gy(c)?(p=l,gy(l)?p=Ude(l):(!Hu(l)||Ak(l))&&(p=zue(c))):g=!1}g&&(i.set(c,p),a(p,c,n,s,i),i.delete(c)),W1(t,r,p)}function sO(t,e,r,n,a){t!==e&&Rue(e,function(s,i){if(a||(a=new Oh),Hu(s))qde(t,e,i,r,sO,n,a);else{var l=n?n(Y1(t,i),s,i+"",t,e,a):void 0;l===void 0&&(l=s),W1(t,i,l)}},aO)}function iO(t){return t}function Hde(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var KN=Math.max;function Gde(t,e,r){return e=KN(e===void 0?t.length-1:e,0),function(){for(var n=arguments,a=-1,s=KN(n.length-e,0),i=Array(s);++a<s;)i[a]=n[e+a];a=-1;for(var l=Array(e+1);++a<e;)l[a]=n[a];return l[e]=r(i),Hde(t,this,l)}}function Vde(t){return function(){return t}}var Wde=py?function(t,e){return py(t,"toString",{configurable:!0,enumerable:!1,value:Vde(e),writable:!0})}:iO,Yde=800,Qde=16,Kde=Date.now;function Xde(t){var e=0,r=0;return function(){var n=Kde(),a=Qde-(n-r);if(r=n,a>0){if(++e>=Yde)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Jde=Xde(Wde);function Zde(t,e){return Jde(Gde(t,e,iO),t+"")}function ehe(t,e,r){if(!Hu(r))return!1;var n=typeof e;return(n=="number"?cb(r)&&nO(e,r.length):n=="string"&&e in r)?sb(r[e],t):!1}function the(t){return Zde(function(e,r){var n=-1,a=r.length,s=a>1?r[a-1]:void 0,i=a>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(a--,s):void 0,i&&ehe(r[0],r[1],i)&&(s=a<3?void 0:s,a=1),e=Object(e);++n<a;){var l=r[n];l&&t(e,l,n,s)}return e})}var rhe=the(function(t,e,r){sO(t,e,r)}),nhe="",ahe={curveBasis:f0,curveBasisClosed:ile,curveBasisOpen:ole,curveBumpX:GL,curveBumpY:VL,curveBundle:lle,curveCardinalClosed:cle,curveCardinalOpen:ule,curveCardinal:KL,curveCatmullRomClosed:dle,curveCatmullRomOpen:hle,curveCatmullRom:JL,curveLinear:ry,curveLinearClosed:ple,curveMonotoneX:aM,curveMonotoneY:sM,curveNatural:oM,curveStep:lM,curveStepAfter:uM,curveStepBefore:cM},she=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,ihe=L(function(t,e){const r=oO(t,/(?:init\b)|(?:initialize\b)/);let n={};if(Array.isArray(r)){const i=r.map(l=>l.args);G0(i),n=Ga(n,[...i])}else n=r.args;if(!n)return;let a=tk(t,e);const s="config";return n[s]!==void 0&&(a==="flowchart-v2"&&(a="flowchart"),n[a]=n[s],delete n[s]),n},"detectInit"),oO=L(function(t,e=null){try{const r=new RegExp(`[%]{2}(?![{]${she.source})(?=[}][%]{2}).*
`,"ig");t=t.trim().replace(r,"").replace(/'/gm,'"'),wt.debug(`Detecting diagram directive${e!==null?" type:"+e:""} based on the text:${t}`);let n;const a=[];for(;(n=Sg.exec(t))!==null;)if(n.index===Sg.lastIndex&&Sg.lastIndex++,n&&!e||e&&n[1]?.match(e)||e&&n[2]?.match(e)){const s=n[1]?n[1]:n[2],i=n[3]?n[3].trim():n[4]?JSON.parse(n[4].trim()):null;a.push({type:s,args:i})}return a.length===0?{type:t,args:null}:a.length===1?a[0]:a}catch(r){return wt.error(`ERROR: ${r.message} - Unable to parse directive type: '${e}' based on the text: '${t}'`),{type:void 0,args:null}}},"detectDirective"),ohe=L(function(t){return t.replace(Sg,"")},"removeDirectives"),lhe=L(function(t,e){for(const[r,n]of e.entries())if(n.match(t))return r;return-1},"isSubstringInArray");function Rk(t,e){if(!t)return e;const r=`curve${t.charAt(0).toUpperCase()+t.slice(1)}`;return ahe[r]??e}L(Rk,"interpolateToCurve");function lO(t,e){const r=t.trim();if(r)return e.securityLevel!=="loose"?Ace.sanitizeUrl(r):r}L(lO,"formatUrl");var che=L((t,...e)=>{const r=t.split("."),n=r.length-1,a=r[n];let s=window;for(let i=0;i<n;i++)if(s=s[r[i]],!s){wt.error(`Function name: ${t} not found in window`);return}s[a](...e)},"runFunc");function Dk(t,e){return!t||!e?0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}L(Dk,"distance");function cO(t){let e,r=0;t.forEach(a=>{r+=Dk(a,e),e=a});const n=r/2;return Lk(t,n)}L(cO,"traverseEdge");function uO(t){return t.length===1?t[0]:cO(t)}L(uO,"calcLabelPosition");var XN=L((t,e=2)=>{const r=Math.pow(10,e);return Math.round(t*r)/r},"roundNumber"),Lk=L((t,e)=>{let r,n=e;for(const a of t){if(r){const s=Dk(a,r);if(s===0)return r;if(s<n)n-=s;else{const i=n/s;if(i<=0)return r;if(i>=1)return{x:a.x,y:a.y};if(i>0&&i<1)return{x:XN((1-i)*r.x+i*a.x,5),y:XN((1-i)*r.y+i*a.y,5)}}}r=a}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),uhe=L((t,e,r)=>{wt.info(`our points ${JSON.stringify(e)}`),e[0]!==r&&(e=e.reverse());const a=Lk(e,25),s=t?10:5,i=Math.atan2(e[0].y-a.y,e[0].x-a.x),l={x:0,y:0};return l.x=Math.sin(i)*s+(e[0].x+a.x)/2,l.y=-Math.cos(i)*s+(e[0].y+a.y)/2,l},"calcCardinalityPosition");function dO(t,e,r){const n=structuredClone(r);wt.info("our points",n),e!=="start_left"&&e!=="start_right"&&n.reverse();const a=25+t,s=Lk(n,a),i=10+t*.5,l=Math.atan2(n[0].y-s.y,n[0].x-s.x),c={x:0,y:0};return e==="start_left"?(c.x=Math.sin(l+Math.PI)*i+(n[0].x+s.x)/2,c.y=-Math.cos(l+Math.PI)*i+(n[0].y+s.y)/2):e==="end_right"?(c.x=Math.sin(l-Math.PI)*i+(n[0].x+s.x)/2-5,c.y=-Math.cos(l-Math.PI)*i+(n[0].y+s.y)/2-5):e==="end_left"?(c.x=Math.sin(l)*i+(n[0].x+s.x)/2-5,c.y=-Math.cos(l)*i+(n[0].y+s.y)/2-5):(c.x=Math.sin(l)*i+(n[0].x+s.x)/2,c.y=-Math.cos(l)*i+(n[0].y+s.y)/2),c}L(dO,"calcTerminalLabelPosition");function hO(t){let e="",r="";for(const n of t)n!==void 0&&(n.startsWith("color:")||n.startsWith("text-align:")?r=r+n+";":e=e+n+";");return{style:e,labelStyle:r}}L(hO,"getStylesFromArray");var JN=0,dhe=L(()=>(JN++,"id-"+Math.random().toString(36).substr(2,12)+"-"+JN),"generateId");function pO(t){let e="";const r="0123456789abcdef",n=r.length;for(let a=0;a<t;a++)e+=r.charAt(Math.floor(Math.random()*n));return e}L(pO,"makeRandomHex");var hhe=L(t=>pO(t.length),"random"),phe=L(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),ghe=L(function(t,e){const r=e.text.replace(Dh.lineBreakRegex," "),[,n]=ub(e.fontSize),a=t.append("text");a.attr("x",e.x),a.attr("y",e.y),a.style("text-anchor",e.anchor),a.style("font-family",e.fontFamily),a.style("font-size",n),a.style("font-weight",e.fontWeight),a.attr("fill",e.fill),e.class!==void 0&&a.attr("class",e.class);const s=a.append("tspan");return s.attr("x",e.x+e.textMargin*2),s.attr("fill",e.fill),s.text(r),a},"drawSimpleText"),fhe=bf((t,e,r)=>{if(!t||(r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},r),Dh.lineBreakRegex.test(t)))return t;const n=t.split(" ").filter(Boolean),a=[];let s="";return n.forEach((i,l)=>{const c=Ml(`${i} `,r),d=Ml(s,r);if(c>e){const{hyphenatedStrings:m,remainingWord:y}=mhe(i,e,"-",r);a.push(s,...m),s=y}else d+c>=e?(a.push(s),s=i):s=[s,i].filter(Boolean).join(" ");l+1===n.length&&a.push(s)}),a.filter(i=>i!=="").join(r.joinWith)},(t,e,r)=>`${t}${e}${r.fontSize}${r.fontWeight}${r.fontFamily}${r.joinWith}`),mhe=bf((t,e,r="-",n)=>{n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},n);const a=[...t],s=[];let i="";return a.forEach((l,c)=>{const d=`${i}${l}`;if(Ml(d,n)>=e){const g=c+1,m=a.length===g,y=`${d}${r}`;s.push(m?d:y),i=""}else i=d}),{hyphenatedStrings:s,remainingWord:i}},(t,e,r="-",n)=>`${t}${e}${r}${n.fontSize}${n.fontWeight}${n.fontFamily}`);function gO(t,e){return Mk(t,e).height}L(gO,"calculateTextHeight");function Ml(t,e){return Mk(t,e).width}L(Ml,"calculateTextWidth");var Mk=bf((t,e)=>{const{fontSize:r=12,fontFamily:n="Arial",fontWeight:a=400}=e;if(!t)return{width:0,height:0};const[,s]=ub(r),i=["sans-serif",n],l=t.split(Dh.lineBreakRegex),c=[],d=wn("body");if(!d.remove)return{width:0,height:0,lineHeight:0};const p=d.append("svg");for(const m of i){let y=0;const x={width:0,height:0,lineHeight:0};for(const w of l){const T=phe();T.text=w||nhe;const k=ghe(p,T).style("font-size",s).style("font-weight",a).style("font-family",m),_=(k._groups||k)[0][0].getBBox();if(_.width===0&&_.height===0)throw new Error("svg element not in render tree");x.width=Math.round(Math.max(x.width,_.width)),y=Math.round(_.height),x.height+=y,x.lineHeight=Math.round(Math.max(x.lineHeight,y))}c.push(x)}p.remove();const g=isNaN(c[1].height)||isNaN(c[1].width)||isNaN(c[1].lineHeight)||c[0].height>c[1].height&&c[0].width>c[1].width&&c[0].lineHeight>c[1].lineHeight?0:1;return c[g]},(t,e)=>`${t}${e.fontSize}${e.fontWeight}${e.fontFamily}`),ch,yhe=(ch=class{constructor(e=!1,r){this.count=0,this.count=r?r.length:0,this.next=e?()=>this.count++:()=>Date.now()}},L(ch,"InitIDGenerator"),ch),Hm,bhe=L(function(t){return Hm=Hm||document.createElement("div"),t=escape(t).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),Hm.innerHTML=t,unescape(Hm.textContent)},"entityDecode");function Ok(t){return"str"in t}L(Ok,"isDetailedError");var xhe=L((t,e,r,n)=>{if(!n)return;const a=t.node()?.getBBox();a&&t.append("text").text(n).attr("text-anchor","middle").attr("x",a.x+a.width/2).attr("y",-r).attr("class",e)},"insertTitle"),ub=L(t=>{if(typeof t=="number")return[t,t+"px"];const e=parseInt(t??"",10);return Number.isNaN(e)?[void 0,void 0]:t===String(e)?[e,t+"px"]:[e,t]},"parseFontSize");function jk(t,e){return rhe({},t,e)}L(jk,"cleanAndMerge");var ho={assignWithDepth:Ga,wrapLabel:fhe,calculateTextHeight:gO,calculateTextWidth:Ml,calculateTextDimensions:Mk,cleanAndMerge:jk,detectInit:ihe,detectDirective:oO,isSubstringInArray:lhe,interpolateToCurve:Rk,calcLabelPosition:uO,calcCardinalityPosition:uhe,calcTerminalLabelPosition:dO,formatUrl:lO,getStylesFromArray:hO,generateId:dhe,random:hhe,runFunc:che,entityDecode:bhe,insertTitle:xhe,isLabelCoordinateInPath:fO,parseFontSize:ub,InitIDGenerator:yhe},vhe=L(function(t){let e=t;return e=e.replace(/style.*:\S*#.*;/g,function(r){return r.substring(0,r.length-1)}),e=e.replace(/classDef.*:\S*#.*;/g,function(r){return r.substring(0,r.length-1)}),e=e.replace(/#\w+;/g,function(r){const n=r.substring(1,r.length-1);return/^\+?\d+$/.test(n)?""+n+"":""+n+""}),e},"encodeEntities"),Wu=L(function(t){return t.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),ave=L((t,e,{counter:r=0,prefix:n,suffix:a},s)=>s||`${n?`${n}_`:""}${t}_${e}_${r}${a?`_${a}`:""}`,"getEdgeId");function vs(t){return t??null}L(vs,"handleUndefinedAttr");function fO(t,e){const r=Math.round(t.x),n=Math.round(t.y),a=e.replace(/(\d+\.\d+)/g,s=>Math.round(parseFloat(s)).toString());return a.includes(r.toString())||a.includes(n.toString())}L(fO,"isLabelCoordinateInPath");const whe=Object.freeze({left:0,top:0,width:16,height:16}),my=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),mO=Object.freeze({...whe,...my}),She=Object.freeze({...mO,body:"",hidden:!1}),khe=Object.freeze({width:null,height:null}),The=Object.freeze({...khe,...my}),Che=(t,e,r,n="")=>{const a=t.split(":");if(t.slice(0,1)==="@"){if(a.length<2||a.length>3)return null;n=a.shift().slice(1)}if(a.length>3||!a.length)return null;if(a.length>1){const l=a.pop(),c=a.pop(),d={provider:a.length>0?a[0]:n,prefix:c,name:l};return cw(d)?d:null}const s=a[0],i=s.split("-");if(i.length>1){const l={provider:n,prefix:i.shift(),name:i.join("-")};return cw(l)?l:null}if(r&&n===""){const l={provider:n,prefix:"",name:s};return cw(l,r)?l:null}return null},cw=(t,e)=>t?!!((e&&t.prefix===""||t.prefix)&&t.name):!1;function Ehe(t,e){const r={};!t.hFlip!=!e.hFlip&&(r.hFlip=!0),!t.vFlip!=!e.vFlip&&(r.vFlip=!0);const n=((t.rotate||0)+(e.rotate||0))%4;return n&&(r.rotate=n),r}function ZN(t,e){const r=Ehe(t,e);for(const n in She)n in my?n in t&&!(n in r)&&(r[n]=my[n]):n in e?r[n]=e[n]:n in t&&(r[n]=t[n]);return r}function _he(t,e){const r=t.icons,n=t.aliases||Object.create(null),a=Object.create(null);function s(i){if(r[i])return a[i]=[];if(!(i in a)){a[i]=null;const l=n[i]&&n[i].parent,c=l&&s(l);c&&(a[i]=[l].concat(c))}return a[i]}return(e||Object.keys(r).concat(Object.keys(n))).forEach(s),a}function e3(t,e,r){const n=t.icons,a=t.aliases||Object.create(null);let s={};function i(l){s=ZN(n[l]||a[l],s)}return i(e),r.forEach(i),ZN(t,s)}function Ahe(t,e){if(t.icons[e])return e3(t,e,[]);const r=_he(t,[e])[e];return r?e3(t,e,r):null}const Nhe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,Phe=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function t3(t,e,r){if(e===1)return t;if(r=r||100,typeof t=="number")return Math.ceil(t*e*r)/r;if(typeof t!="string")return t;const n=t.split(Nhe);if(n===null||!n.length)return t;const a=[];let s=n.shift(),i=Phe.test(s);for(;;){if(i){const l=parseFloat(s);isNaN(l)?a.push(s):a.push(Math.ceil(l*e*r)/r)}else a.push(s);if(s=n.shift(),s===void 0)return a.join("");i=!i}}function Ihe(t,e="defs"){let r="";const n=t.indexOf("<"+e);for(;n>=0;){const a=t.indexOf(">",n),s=t.indexOf("</"+e);if(a===-1||s===-1)break;const i=t.indexOf(">",s);if(i===-1)break;r+=t.slice(a+1,s).trim(),t=t.slice(0,n).trim()+t.slice(i+1)}return{defs:r,content:t}}function Rhe(t,e){return t?"<defs>"+t+"</defs>"+e:e}function Dhe(t,e,r){const n=Ihe(t);return Rhe(n.defs,e+n.content+r)}const Lhe=t=>t==="unset"||t==="undefined"||t==="none";function Mhe(t,e){const r={...mO,...t},n={...The,...e},a={left:r.left,top:r.top,width:r.width,height:r.height};let s=r.body;[r,n].forEach(w=>{const T=[],k=w.hFlip,_=w.vFlip;let P=w.rotate;k?_?P+=2:(T.push("translate("+(a.width+a.left).toString()+" "+(0-a.top).toString()+")"),T.push("scale(-1 1)"),a.top=a.left=0):_&&(T.push("translate("+(0-a.left).toString()+" "+(a.height+a.top).toString()+")"),T.push("scale(1 -1)"),a.top=a.left=0);let F;switch(P<0&&(P-=Math.floor(P/4)*4),P=P%4,P){case 1:F=a.height/2+a.top,T.unshift("rotate(90 "+F.toString()+" "+F.toString()+")");break;case 2:T.unshift("rotate(180 "+(a.width/2+a.left).toString()+" "+(a.height/2+a.top).toString()+")");break;case 3:F=a.width/2+a.left,T.unshift("rotate(-90 "+F.toString()+" "+F.toString()+")");break}P%2===1&&(a.left!==a.top&&(F=a.left,a.left=a.top,a.top=F),a.width!==a.height&&(F=a.width,a.width=a.height,a.height=F)),T.length&&(s=Dhe(s,'<g transform="'+T.join(" ")+'">',"</g>"))});const i=n.width,l=n.height,c=a.width,d=a.height;let p,g;i===null?(g=l===null?"1em":l==="auto"?d:l,p=t3(g,c/d)):(p=i==="auto"?c:i,g=l===null?t3(p,d/c):l==="auto"?d:l);const m={},y=(w,T)=>{Lhe(T)||(m[w]=T.toString())};y("width",p),y("height",g);const x=[a.left,a.top,c,d];return m.viewBox=x.join(" "),{attributes:m,viewBox:x,body:s}}const Ohe=/\sid="(\S+)"/g,jhe="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let Bhe=0;function Fhe(t,e=jhe){const r=[];let n;for(;n=Ohe.exec(t);)r.push(n[1]);if(!r.length)return t;const a="suffix"+(Math.random()*16777216|Date.now()).toString(16);return r.forEach(s=>{const i=typeof e=="function"?e(s):e+(Bhe++).toString(),l=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");t=t.replace(new RegExp('([#;"])('+l+')([")]|\\.[a-z])',"g"),"$1"+i+a+"$3")}),t=t.replace(new RegExp(a,"g"),""),t}function zhe(t,e){let r=t.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const n in e)r+=" "+n+'="'+e[n]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+r+">"+t+"</svg>"}function Bk(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var Yu=Bk();function yO(t){Yu=t}var Cg={exec:()=>null};function En(t,e=""){let r=typeof t=="string"?t:t.source,n={replace:(a,s)=>{let i=typeof s=="string"?s:s.source;return i=i.replace(Ms.caret,"$1"),r=r.replace(a,i),n},getRegex:()=>new RegExp(r,e)};return n}var $he=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),Ms={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:t=>new RegExp(`^( {0,3}${t})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}#`),htmlBeginRegex:t=>new RegExp(`^ {0,${Math.min(3,t-1)}}<(?:[a-z].*>|!--)`,"i")},Uhe=/^(?:[ \t]*(?:\n|$))+/,qhe=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Hhe=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,vf=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Ghe=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Fk=/(?:[*+-]|\d{1,9}[.)])/,bO=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,xO=En(bO).replace(/bull/g,Fk).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Vhe=En(bO).replace(/bull/g,Fk).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),zk=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Whe=/^[^\n]+/,$k=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,Yhe=En(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",$k).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Qhe=En(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Fk).getRegex(),db="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Uk=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Khe=En("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Uk).replace("tag",db).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),vO=En(zk).replace("hr",vf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",db).getRegex(),Xhe=En(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",vO).getRegex(),qk={blockquote:Xhe,code:qhe,def:Yhe,fences:Hhe,heading:Ghe,hr:vf,html:Khe,lheading:xO,list:Qhe,newline:Uhe,paragraph:vO,table:Cg,text:Whe},r3=En("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",vf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",db).getRegex(),Jhe={...qk,lheading:Vhe,table:r3,paragraph:En(zk).replace("hr",vf).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",r3).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",db).getRegex()},Zhe={...qk,html:En(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Uk).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cg,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:En(zk).replace("hr",vf).replace("heading",` *#{1,6} *[^
]`).replace("lheading",xO).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},epe=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,tpe=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,wO=/^( {2,}|\\)\n(?!\s*$)/,rpe=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,hb=/[\p{P}\p{S}]/u,Hk=/[\s\p{P}\p{S}]/u,SO=/[^\s\p{P}\p{S}]/u,npe=En(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Hk).getRegex(),kO=/(?!~)[\p{P}\p{S}]/u,ape=/(?!~)[\s\p{P}\p{S}]/u,spe=/(?:[^\s\p{P}\p{S}]|~)/u,ipe=En(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",$he?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),TO=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,ope=En(TO,"u").replace(/punct/g,hb).getRegex(),lpe=En(TO,"u").replace(/punct/g,kO).getRegex(),CO="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",cpe=En(CO,"gu").replace(/notPunctSpace/g,SO).replace(/punctSpace/g,Hk).replace(/punct/g,hb).getRegex(),upe=En(CO,"gu").replace(/notPunctSpace/g,spe).replace(/punctSpace/g,ape).replace(/punct/g,kO).getRegex(),dpe=En("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,SO).replace(/punctSpace/g,Hk).replace(/punct/g,hb).getRegex(),hpe=En(/\\(punct)/,"gu").replace(/punct/g,hb).getRegex(),ppe=En(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),gpe=En(Uk).replace("(?:-->|$)","-->").getRegex(),fpe=En("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",gpe).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),yy=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,mpe=En(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",yy).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),EO=En(/^!?\[(label)\]\[(ref)\]/).replace("label",yy).replace("ref",$k).getRegex(),_O=En(/^!?\[(ref)\](?:\[\])?/).replace("ref",$k).getRegex(),ype=En("reflink|nolink(?!\\()","g").replace("reflink",EO).replace("nolink",_O).getRegex(),n3=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,Gk={_backpedal:Cg,anyPunctuation:hpe,autolink:ppe,blockSkip:ipe,br:wO,code:tpe,del:Cg,emStrongLDelim:ope,emStrongRDelimAst:cpe,emStrongRDelimUnd:dpe,escape:epe,link:mpe,nolink:_O,punctuation:npe,reflink:EO,reflinkSearch:ype,tag:fpe,text:rpe,url:Cg},bpe={...Gk,link:En(/^!?\[(label)\]\((.*?)\)/).replace("label",yy).getRegex(),reflink:En(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",yy).getRegex()},Q1={...Gk,emStrongRDelimAst:upe,emStrongLDelim:lpe,url:En(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",n3).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:En(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",n3).getRegex()},xpe={...Q1,br:En(wO).replace("{2,}","*").getRegex(),text:En(Q1.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Gm={normal:qk,gfm:Jhe,pedantic:Zhe},Gp={normal:Gk,gfm:Q1,breaks:xpe,pedantic:bpe},vpe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},a3=t=>vpe[t];function Fo(t,e){if(e){if(Ms.escapeTest.test(t))return t.replace(Ms.escapeReplace,a3)}else if(Ms.escapeTestNoEncode.test(t))return t.replace(Ms.escapeReplaceNoEncode,a3);return t}function s3(t){try{t=encodeURI(t).replace(Ms.percentDecode,"%")}catch{return null}return t}function i3(t,e){let r=t.replace(Ms.findPipe,(s,i,l)=>{let c=!1,d=i;for(;--d>=0&&l[d]==="\\";)c=!c;return c?"|":" |"}),n=r.split(Ms.splitPipe),a=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;a<n.length;a++)n[a]=n[a].trim().replace(Ms.slashPipe,"|");return n}function Vp(t,e,r){let n=t.length;if(n===0)return"";let a=0;for(;a<n&&t.charAt(n-a-1)===e;)a++;return t.slice(0,n-a)}function wpe(t,e){if(t.indexOf(e[1])===-1)return-1;let r=0;for(let n=0;n<t.length;n++)if(t[n]==="\\")n++;else if(t[n]===e[0])r++;else if(t[n]===e[1]&&(r--,r<0))return n;return r>0?-2:-1}function o3(t,e,r,n,a){let s=e.href,i=e.title||null,l=t[1].replace(a.other.outputLinkReplace,"$1");n.state.inLink=!0;let c={type:t[0].charAt(0)==="!"?"image":"link",raw:r,href:s,title:i,text:l,tokens:n.inlineTokens(l)};return n.state.inLink=!1,c}function Spe(t,e,r){let n=t.match(r.other.indentCodeCompensation);if(n===null)return e;let a=n[1];return e.split(`
`).map(s=>{let i=s.match(r.other.beginningSpace);if(i===null)return s;let[l]=i;return l.length>=a.length?s.slice(a.length):s}).join(`
`)}var by=class{options;rules;lexer;constructor(e){this.options=e||Yu}space(e){let r=this.rules.block.newline.exec(e);if(r&&r[0].length>0)return{type:"space",raw:r[0]}}code(e){let r=this.rules.block.code.exec(e);if(r){let n=r[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:r[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Vp(n,`
`)}}}fences(e){let r=this.rules.block.fences.exec(e);if(r){let n=r[0],a=Spe(n,r[3]||"",this.rules);return{type:"code",raw:n,lang:r[2]?r[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):r[2],text:a}}}heading(e){let r=this.rules.block.heading.exec(e);if(r){let n=r[2].trim();if(this.rules.other.endingHash.test(n)){let a=Vp(n,"#");(this.options.pedantic||!a||this.rules.other.endingSpaceChar.test(a))&&(n=a.trim())}return{type:"heading",raw:r[0],depth:r[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let r=this.rules.block.hr.exec(e);if(r)return{type:"hr",raw:Vp(r[0],`
`)}}blockquote(e){let r=this.rules.block.blockquote.exec(e);if(r){let n=Vp(r[0],`
`).split(`
`),a="",s="",i=[];for(;n.length>0;){let l=!1,c=[],d;for(d=0;d<n.length;d++)if(this.rules.other.blockquoteStart.test(n[d]))c.push(n[d]),l=!0;else if(!l)c.push(n[d]);else break;n=n.slice(d);let p=c.join(`
`),g=p.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");a=a?`${a}
${p}`:p,s=s?`${s}
${g}`:g;let m=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(g,i,!0),this.lexer.state.top=m,n.length===0)break;let y=i.at(-1);if(y?.type==="code")break;if(y?.type==="blockquote"){let x=y,w=x.raw+`
`+n.join(`
`),T=this.blockquote(w);i[i.length-1]=T,a=a.substring(0,a.length-x.raw.length)+T.raw,s=s.substring(0,s.length-x.text.length)+T.text;break}else if(y?.type==="list"){let x=y,w=x.raw+`
`+n.join(`
`),T=this.list(w);i[i.length-1]=T,a=a.substring(0,a.length-y.raw.length)+T.raw,s=s.substring(0,s.length-x.raw.length)+T.raw,n=w.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:a,tokens:i,text:s}}}list(e){let r=this.rules.block.list.exec(e);if(r){let n=r[1].trim(),a=n.length>1,s={type:"list",raw:"",ordered:a,start:a?+n.slice(0,-1):"",loose:!1,items:[]};n=a?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=a?n:"[*+-]");let i=this.rules.other.listItemRegex(n),l=!1;for(;e;){let d=!1,p="",g="";if(!(r=i.exec(e))||this.rules.block.hr.test(e))break;p=r[0],e=e.substring(p.length);let m=r[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,_=>" ".repeat(3*_.length)),y=e.split(`
`,1)[0],x=!m.trim(),w=0;if(this.options.pedantic?(w=2,g=m.trimStart()):x?w=r[1].length+1:(w=r[2].search(this.rules.other.nonSpaceChar),w=w>4?1:w,g=m.slice(w),w+=r[1].length),x&&this.rules.other.blankLine.test(y)&&(p+=y+`
`,e=e.substring(y.length+1),d=!0),!d){let _=this.rules.other.nextBulletRegex(w),P=this.rules.other.hrRegex(w),F=this.rules.other.fencesBeginRegex(w),D=this.rules.other.headingBeginRegex(w),B=this.rules.other.htmlBeginRegex(w);for(;e;){let M=e.split(`
`,1)[0],$;if(y=M,this.options.pedantic?(y=y.replace(this.rules.other.listReplaceNesting,"  "),$=y):$=y.replace(this.rules.other.tabCharGlobal,"    "),F.test(y)||D.test(y)||B.test(y)||_.test(y)||P.test(y))break;if($.search(this.rules.other.nonSpaceChar)>=w||!y.trim())g+=`
`+$.slice(w);else{if(x||m.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||F.test(m)||D.test(m)||P.test(m))break;g+=`
`+y}!x&&!y.trim()&&(x=!0),p+=M+`
`,e=e.substring(M.length+1),m=$.slice(w)}}s.loose||(l?s.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(l=!0));let T=null,k;this.options.gfm&&(T=this.rules.other.listIsTask.exec(g),T&&(k=T[0]!=="[ ] ",g=g.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:p,task:!!T,checked:k,loose:!1,text:g,tokens:[]}),s.raw+=p}let c=s.items.at(-1);if(c)c.raw=c.raw.trimEnd(),c.text=c.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let d=0;d<s.items.length;d++)if(this.lexer.state.top=!1,s.items[d].tokens=this.lexer.blockTokens(s.items[d].text,[]),!s.loose){let p=s.items[d].tokens.filter(m=>m.type==="space"),g=p.length>0&&p.some(m=>this.rules.other.anyLine.test(m.raw));s.loose=g}if(s.loose)for(let d=0;d<s.items.length;d++)s.items[d].loose=!0;return s}}html(e){let r=this.rules.block.html.exec(e);if(r)return{type:"html",block:!0,raw:r[0],pre:r[1]==="pre"||r[1]==="script"||r[1]==="style",text:r[0]}}def(e){let r=this.rules.block.def.exec(e);if(r){let n=r[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),a=r[2]?r[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=r[3]?r[3].substring(1,r[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):r[3];return{type:"def",tag:n,raw:r[0],href:a,title:s}}}table(e){let r=this.rules.block.table.exec(e);if(!r||!this.rules.other.tableDelimiter.test(r[2]))return;let n=i3(r[1]),a=r[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=r[3]?.trim()?r[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:r[0],header:[],align:[],rows:[]};if(n.length===a.length){for(let l of a)this.rules.other.tableAlignRight.test(l)?i.align.push("right"):this.rules.other.tableAlignCenter.test(l)?i.align.push("center"):this.rules.other.tableAlignLeft.test(l)?i.align.push("left"):i.align.push(null);for(let l=0;l<n.length;l++)i.header.push({text:n[l],tokens:this.lexer.inline(n[l]),header:!0,align:i.align[l]});for(let l of s)i.rows.push(i3(l,i.header.length).map((c,d)=>({text:c,tokens:this.lexer.inline(c),header:!1,align:i.align[d]})));return i}}lheading(e){let r=this.rules.block.lheading.exec(e);if(r)return{type:"heading",raw:r[0],depth:r[2].charAt(0)==="="?1:2,text:r[1],tokens:this.lexer.inline(r[1])}}paragraph(e){let r=this.rules.block.paragraph.exec(e);if(r){let n=r[1].charAt(r[1].length-1)===`
`?r[1].slice(0,-1):r[1];return{type:"paragraph",raw:r[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let r=this.rules.block.text.exec(e);if(r)return{type:"text",raw:r[0],text:r[0],tokens:this.lexer.inline(r[0])}}escape(e){let r=this.rules.inline.escape.exec(e);if(r)return{type:"escape",raw:r[0],text:r[1]}}tag(e){let r=this.rules.inline.tag.exec(e);if(r)return!this.lexer.state.inLink&&this.rules.other.startATag.test(r[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(r[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(r[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(r[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:r[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:r[0]}}link(e){let r=this.rules.inline.link.exec(e);if(r){let n=r[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let i=Vp(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{let i=wpe(r[2],"()");if(i===-2)return;if(i>-1){let l=(r[0].indexOf("!")===0?5:4)+r[1].length+i;r[2]=r[2].substring(0,i),r[0]=r[0].substring(0,l).trim(),r[3]=""}}let a=r[2],s="";if(this.options.pedantic){let i=this.rules.other.pedanticHrefTitle.exec(a);i&&(a=i[1],s=i[3])}else s=r[3]?r[3].slice(1,-1):"";return a=a.trim(),this.rules.other.startAngleBracket.test(a)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?a=a.slice(1):a=a.slice(1,-1)),o3(r,{href:a&&a.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},r[0],this.lexer,this.rules)}}reflink(e,r){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let a=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=r[a.toLowerCase()];if(!s){let i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return o3(n,s,n[0],this.lexer,this.rules)}}emStrong(e,r,n=""){let a=this.rules.inline.emStrongLDelim.exec(e);if(!(!a||a[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!(a[1]||a[2])||!n||this.rules.inline.punctuation.exec(n))){let s=[...a[0]].length-1,i,l,c=s,d=0,p=a[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(p.lastIndex=0,r=r.slice(-1*e.length+s);(a=p.exec(r))!=null;){if(i=a[1]||a[2]||a[3]||a[4]||a[5]||a[6],!i)continue;if(l=[...i].length,a[3]||a[4]){c+=l;continue}else if((a[5]||a[6])&&s%3&&!((s+l)%3)){d+=l;continue}if(c-=l,c>0)continue;l=Math.min(l,l+c+d);let g=[...a[0]][0].length,m=e.slice(0,s+a.index+g+l);if(Math.min(s,l)%2){let x=m.slice(1,-1);return{type:"em",raw:m,text:x,tokens:this.lexer.inlineTokens(x)}}let y=m.slice(2,-2);return{type:"strong",raw:m,text:y,tokens:this.lexer.inlineTokens(y)}}}}codespan(e){let r=this.rules.inline.code.exec(e);if(r){let n=r[2].replace(this.rules.other.newLineCharGlobal," "),a=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return a&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:r[0],text:n}}}br(e){let r=this.rules.inline.br.exec(e);if(r)return{type:"br",raw:r[0]}}del(e){let r=this.rules.inline.del.exec(e);if(r)return{type:"del",raw:r[0],text:r[2],tokens:this.lexer.inlineTokens(r[2])}}autolink(e){let r=this.rules.inline.autolink.exec(e);if(r){let n,a;return r[2]==="@"?(n=r[1],a="mailto:"+n):(n=r[1],a=n),{type:"link",raw:r[0],text:n,href:a,tokens:[{type:"text",raw:n,text:n}]}}}url(e){let r;if(r=this.rules.inline.url.exec(e)){let n,a;if(r[2]==="@")n=r[0],a="mailto:"+n;else{let s;do s=r[0],r[0]=this.rules.inline._backpedal.exec(r[0])?.[0]??"";while(s!==r[0]);n=r[0],r[1]==="www."?a="http://"+r[0]:a=r[0]}return{type:"link",raw:r[0],text:n,href:a,tokens:[{type:"text",raw:n,text:n}]}}}inlineText(e){let r=this.rules.inline.text.exec(e);if(r){let n=this.lexer.state.inRawBlock;return{type:"text",raw:r[0],text:r[0],escaped:n}}}},lo=class K1{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||Yu,this.options.tokenizer=this.options.tokenizer||new by,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let r={other:Ms,block:Gm.normal,inline:Gp.normal};this.options.pedantic?(r.block=Gm.pedantic,r.inline=Gp.pedantic):this.options.gfm&&(r.block=Gm.gfm,this.options.breaks?r.inline=Gp.breaks:r.inline=Gp.gfm),this.tokenizer.rules=r}static get rules(){return{block:Gm,inline:Gp}}static lex(e,r){return new K1(r).lex(e)}static lexInline(e,r){return new K1(r).inlineTokens(e)}lex(e){e=e.replace(Ms.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let r=0;r<this.inlineQueue.length;r++){let n=this.inlineQueue[r];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,r=[],n=!1){for(this.options.pedantic&&(e=e.replace(Ms.tabCharGlobal,"    ").replace(Ms.spaceLine,""));e;){let a;if(this.options.extensions?.block?.some(i=>(a=i.call({lexer:this},e,r))?(e=e.substring(a.raw.length),r.push(a),!0):!1))continue;if(a=this.tokenizer.space(e)){e=e.substring(a.raw.length);let i=r.at(-1);a.raw.length===1&&i!==void 0?i.raw+=`
`:r.push(a);continue}if(a=this.tokenizer.code(e)){e=e.substring(a.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.at(-1).src=i.text):r.push(a);continue}if(a=this.tokenizer.fences(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.heading(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.hr(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.blockquote(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.list(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.html(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.def(e)){e=e.substring(a.raw.length);let i=r.at(-1);i?.type==="paragraph"||i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.raw,this.inlineQueue.at(-1).src=i.text):this.tokens.links[a.tag]||(this.tokens.links[a.tag]={href:a.href,title:a.title},r.push(a));continue}if(a=this.tokenizer.table(e)){e=e.substring(a.raw.length),r.push(a);continue}if(a=this.tokenizer.lheading(e)){e=e.substring(a.raw.length),r.push(a);continue}let s=e;if(this.options.extensions?.startBlock){let i=1/0,l=e.slice(1),c;this.options.extensions.startBlock.forEach(d=>{c=d.call({lexer:this},l),typeof c=="number"&&c>=0&&(i=Math.min(i,c))}),i<1/0&&i>=0&&(s=e.substring(0,i+1))}if(this.state.top&&(a=this.tokenizer.paragraph(s))){let i=r.at(-1);n&&i?.type==="paragraph"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(a),n=s.length!==e.length,e=e.substring(a.raw.length);continue}if(a=this.tokenizer.text(e)){e=e.substring(a.raw.length);let i=r.at(-1);i?.type==="text"?(i.raw+=(i.raw.endsWith(`
`)?"":`
`)+a.raw,i.text+=`
`+a.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=i.text):r.push(a);continue}if(e){let i="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(i);break}else throw new Error(i)}}return this.state.top=!0,r}inline(e,r=[]){return this.inlineQueue.push({src:e,tokens:r}),r}inlineTokens(e,r=[]){let n=e,a=null;if(this.tokens.links){let c=Object.keys(this.tokens.links);if(c.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)c.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(n=n.slice(0,a.index)+"["+"a".repeat(a[0].length-2)+"]"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,a.index)+"++"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let s;for(;(a=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)s=a[2]?a[2].length:0,n=n.slice(0,a.index+s)+"["+"a".repeat(a[0].length-s-2)+"]"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=this.options.hooks?.emStrongMask?.call({lexer:this},n)??n;let i=!1,l="";for(;e;){i||(l=""),i=!1;let c;if(this.options.extensions?.inline?.some(p=>(c=p.call({lexer:this},e,r))?(e=e.substring(c.raw.length),r.push(c),!0):!1))continue;if(c=this.tokenizer.escape(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.tag(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.link(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(c.raw.length);let p=r.at(-1);c.type==="text"&&p?.type==="text"?(p.raw+=c.raw,p.text+=c.text):r.push(c);continue}if(c=this.tokenizer.emStrong(e,n,l)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.codespan(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.br(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.del(e)){e=e.substring(c.raw.length),r.push(c);continue}if(c=this.tokenizer.autolink(e)){e=e.substring(c.raw.length),r.push(c);continue}if(!this.state.inLink&&(c=this.tokenizer.url(e))){e=e.substring(c.raw.length),r.push(c);continue}let d=e;if(this.options.extensions?.startInline){let p=1/0,g=e.slice(1),m;this.options.extensions.startInline.forEach(y=>{m=y.call({lexer:this},g),typeof m=="number"&&m>=0&&(p=Math.min(p,m))}),p<1/0&&p>=0&&(d=e.substring(0,p+1))}if(c=this.tokenizer.inlineText(d)){e=e.substring(c.raw.length),c.raw.slice(-1)!=="_"&&(l=c.raw.slice(-1)),i=!0;let p=r.at(-1);p?.type==="text"?(p.raw+=c.raw,p.text+=c.text):r.push(c);continue}if(e){let p="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return r}},xy=class{options;parser;constructor(e){this.options=e||Yu}space(e){return""}code({text:e,lang:r,escaped:n}){let a=(r||"").match(Ms.notSpaceStart)?.[0],s=e.replace(Ms.endingNewline,"")+`
`;return a?'<pre><code class="language-'+Fo(a)+'">'+(n?s:Fo(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:Fo(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:r}){return`<h${r}>${this.parser.parseInline(e)}</h${r}>
`}hr(e){return`<hr>
`}list(e){let r=e.ordered,n=e.start,a="";for(let l=0;l<e.items.length;l++){let c=e.items[l];a+=this.listitem(c)}let s=r?"ol":"ul",i=r&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+a+"</"+s+`>
`}listitem(e){let r="";if(e.task){let n=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=n+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=n+" "+Fo(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:n+" ",text:n+" ",escaped:!0}):r+=n+" "}return r+=this.parser.parse(e.tokens,!!e.loose),`<li>${r}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let r="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);r+=this.tablerow({text:n});let a="";for(let s=0;s<e.rows.length;s++){let i=e.rows[s];n="";for(let l=0;l<i.length;l++)n+=this.tablecell(i[l]);a+=this.tablerow({text:n})}return a&&(a=`<tbody>${a}</tbody>`),`<table>
<thead>
`+r+`</thead>
`+a+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let r=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+r+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${Fo(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:r,tokens:n}){let a=this.parser.parseInline(n),s=s3(e);if(s===null)return a;e=s;let i='<a href="'+e+'"';return r&&(i+=' title="'+Fo(r)+'"'),i+=">"+a+"</a>",i}image({href:e,title:r,text:n,tokens:a}){a&&(n=this.parser.parseInline(a,this.parser.textRenderer));let s=s3(e);if(s===null)return Fo(n);e=s;let i=`<img src="${e}" alt="${n}"`;return r&&(i+=` title="${Fo(r)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:Fo(e.text)}},Vk=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},co=class X1{options;renderer;textRenderer;constructor(e){this.options=e||Yu,this.options.renderer=this.options.renderer||new xy,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Vk}static parse(e,r){return new X1(r).parse(e)}static parseInline(e,r){return new X1(r).parseInline(e)}parse(e,r=!0){let n="";for(let a=0;a<e.length;a++){let s=e[a];if(this.options.extensions?.renderers?.[s.type]){let l=s,c=this.options.extensions.renderers[l.type].call({parser:this},l);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(l.type)){n+=c||"";continue}}let i=s;switch(i.type){case"space":{n+=this.renderer.space(i);continue}case"hr":{n+=this.renderer.hr(i);continue}case"heading":{n+=this.renderer.heading(i);continue}case"code":{n+=this.renderer.code(i);continue}case"table":{n+=this.renderer.table(i);continue}case"blockquote":{n+=this.renderer.blockquote(i);continue}case"list":{n+=this.renderer.list(i);continue}case"html":{n+=this.renderer.html(i);continue}case"def":{n+=this.renderer.def(i);continue}case"paragraph":{n+=this.renderer.paragraph(i);continue}case"text":{let l=i,c=this.renderer.text(l);for(;a+1<e.length&&e[a+1].type==="text";)l=e[++a],c+=`
`+this.renderer.text(l);r?n+=this.renderer.paragraph({type:"paragraph",raw:c,text:c,tokens:[{type:"text",raw:c,text:c,escaped:!0}]}):n+=c;continue}default:{let l='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}parseInline(e,r=this.renderer){let n="";for(let a=0;a<e.length;a++){let s=e[a];if(this.options.extensions?.renderers?.[s.type]){let l=this.options.extensions.renderers[s.type].call({parser:this},s);if(l!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=l||"";continue}}let i=s;switch(i.type){case"escape":{n+=r.text(i);break}case"html":{n+=r.html(i);break}case"link":{n+=r.link(i);break}case"image":{n+=r.image(i);break}case"strong":{n+=r.strong(i);break}case"em":{n+=r.em(i);break}case"codespan":{n+=r.codespan(i);break}case"br":{n+=r.br(i);break}case"del":{n+=r.del(i);break}case"text":{n+=r.text(i);break}default:{let l='Token with "'+i.type+'" type was not found.';if(this.options.silent)return console.error(l),"";throw new Error(l)}}}return n}},rg=class{options;block;constructor(e){this.options=e||Yu}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?lo.lex:lo.lexInline}provideParser(){return this.block?co.parse:co.parseInline}},kpe=class{defaults=Bk();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=co;Renderer=xy;TextRenderer=Vk;Lexer=lo;Tokenizer=by;Hooks=rg;constructor(...e){this.use(...e)}walkTokens(e,r){let n=[];for(let a of e)switch(n=n.concat(r.call(this,a)),a.type){case"table":{let s=a;for(let i of s.header)n=n.concat(this.walkTokens(i.tokens,r));for(let i of s.rows)for(let l of i)n=n.concat(this.walkTokens(l.tokens,r));break}case"list":{let s=a;n=n.concat(this.walkTokens(s.items,r));break}default:{let s=a;this.defaults.extensions?.childTokens?.[s.type]?this.defaults.extensions.childTokens[s.type].forEach(i=>{let l=s[i].flat(1/0);n=n.concat(this.walkTokens(l,r))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,r)))}}return n}use(...e){let r=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let a={...n};if(a.async=this.defaults.async||a.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){let i=r.renderers[s.name];i?r.renderers[s.name]=function(...l){let c=s.renderer.apply(this,l);return c===!1&&(c=i.apply(this,l)),c}:r.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let i=r[s.level];i?i.unshift(s.tokenizer):r[s.level]=[s.tokenizer],s.start&&(s.level==="block"?r.startBlock?r.startBlock.push(s.start):r.startBlock=[s.start]:s.level==="inline"&&(r.startInline?r.startInline.push(s.start):r.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(r.childTokens[s.name]=s.childTokens)}),a.extensions=r),n.renderer){let s=this.defaults.renderer||new xy(this.defaults);for(let i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;let l=i,c=n.renderer[l],d=s[l];s[l]=(...p)=>{let g=c.apply(s,p);return g===!1&&(g=d.apply(s,p)),g||""}}a.renderer=s}if(n.tokenizer){let s=this.defaults.tokenizer||new by(this.defaults);for(let i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;let l=i,c=n.tokenizer[l],d=s[l];s[l]=(...p)=>{let g=c.apply(s,p);return g===!1&&(g=d.apply(s,p)),g}}a.tokenizer=s}if(n.hooks){let s=this.defaults.hooks||new rg;for(let i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;let l=i,c=n.hooks[l],d=s[l];rg.passThroughHooks.has(i)?s[l]=p=>{if(this.defaults.async&&rg.passThroughHooksRespectAsync.has(i))return(async()=>{let m=await c.call(s,p);return d.call(s,m)})();let g=c.call(s,p);return d.call(s,g)}:s[l]=(...p)=>{if(this.defaults.async)return(async()=>{let m=await c.apply(s,p);return m===!1&&(m=await d.apply(s,p)),m})();let g=c.apply(s,p);return g===!1&&(g=d.apply(s,p)),g}}a.hooks=s}if(n.walkTokens){let s=this.defaults.walkTokens,i=n.walkTokens;a.walkTokens=function(l){let c=[];return c.push(i.call(this,l)),s&&(c=c.concat(s.call(this,l))),c}}this.defaults={...this.defaults,...a}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,r){return lo.lex(e,r??this.defaults)}parser(e,r){return co.parse(e,r??this.defaults)}parseMarkdown(e){return(r,n)=>{let a={...n},s={...this.defaults,...a},i=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&a.async===!1)return i(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof r>"u"||r===null)return i(new Error("marked(): input parameter is undefined or null"));if(typeof r!="string")return i(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(r)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let l=s.hooks?await s.hooks.preprocess(r):r,c=await(s.hooks?await s.hooks.provideLexer():e?lo.lex:lo.lexInline)(l,s),d=s.hooks?await s.hooks.processAllTokens(c):c;s.walkTokens&&await Promise.all(this.walkTokens(d,s.walkTokens));let p=await(s.hooks?await s.hooks.provideParser():e?co.parse:co.parseInline)(d,s);return s.hooks?await s.hooks.postprocess(p):p})().catch(i);try{s.hooks&&(r=s.hooks.preprocess(r));let l=(s.hooks?s.hooks.provideLexer():e?lo.lex:lo.lexInline)(r,s);s.hooks&&(l=s.hooks.processAllTokens(l)),s.walkTokens&&this.walkTokens(l,s.walkTokens);let c=(s.hooks?s.hooks.provideParser():e?co.parse:co.parseInline)(l,s);return s.hooks&&(c=s.hooks.postprocess(c)),c}catch(l){return i(l)}}}onError(e,r){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){let a="<p>An error occurred:</p><pre>"+Fo(n.message+"",!0)+"</pre>";return r?Promise.resolve(a):a}if(r)return Promise.reject(n);throw n}}},ju=new kpe;function Rn(t,e){return ju.parse(t,e)}Rn.options=Rn.setOptions=function(t){return ju.setOptions(t),Rn.defaults=ju.defaults,yO(Rn.defaults),Rn};Rn.getDefaults=Bk;Rn.defaults=Yu;Rn.use=function(...t){return ju.use(...t),Rn.defaults=ju.defaults,yO(Rn.defaults),Rn};Rn.walkTokens=function(t,e){return ju.walkTokens(t,e)};Rn.parseInline=ju.parseInline;Rn.Parser=co;Rn.parser=co.parse;Rn.Renderer=xy;Rn.TextRenderer=Vk;Rn.Lexer=lo;Rn.lexer=lo.lex;Rn.Tokenizer=by;Rn.Hooks=rg;Rn.parse=Rn;Rn.options;Rn.setOptions;Rn.use;Rn.walkTokens;Rn.parseInline;co.parse;lo.lex;function AO(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var n=Array.from(typeof t=="string"?[t]:t);n[n.length-1]=n[n.length-1].replace(/\r?\n([\t ]*)$/,"");var a=n.reduce(function(l,c){var d=c.match(/\n([\t ]+|(?!\s).)/g);return d?l.concat(d.map(function(p){var g,m;return(m=(g=p.match(/[\t ]/g))===null||g===void 0?void 0:g.length)!==null&&m!==void 0?m:0})):l},[]);if(a.length){var s=new RegExp(`
[	 ]{`+Math.min.apply(Math,a)+"}","g");n=n.map(function(l){return l.replace(s,`
`)})}n[0]=n[0].replace(/^\r?\n/,"");var i=n[0];return e.forEach(function(l,c){var d=i.match(/(?:^|\n)( *)$/),p=d?d[1]:"",g=l;typeof l=="string"&&l.includes(`
`)&&(g=String(l).split(`
`).map(function(m,y){return y===0?m:""+p+m}).join(`
`)),i+=g+n[c+1]}),i}var Tpe={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},J1=new Map,NO=new Map,Cpe=L(t=>{for(const e of t){if(!e.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(wt.debug("Registering icon pack:",e.name),"loader"in e)NO.set(e.name,e.loader);else if("icons"in e)J1.set(e.name,e.icons);else throw wt.error("Invalid icon loader:",e),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),PO=L(async(t,e)=>{const r=Che(t,!0,e!==void 0);if(!r)throw new Error(`Invalid icon name: ${t}`);const n=r.prefix||e;if(!n)throw new Error(`Icon name must contain a prefix: ${t}`);let a=J1.get(n);if(!a){const i=NO.get(n);if(!i)throw new Error(`Icon set not found: ${r.prefix}`);try{a={...await i(),prefix:n},J1.set(n,a)}catch(l){throw wt.error(l),new Error(`Failed to load icon set: ${r.prefix}`)}}const s=Ahe(a,r.name);if(!s)throw new Error(`Icon not found: ${t}`);return s},"getRegisteredIconData"),Epe=L(async t=>{try{return await PO(t),!0}catch{return!1}},"isIconAvailable"),wf=L(async(t,e,r)=>{let n;try{n=await PO(t,e?.fallbackPrefix)}catch(i){wt.error(i),n=Tpe}const a=Mhe(n,e),s=zhe(Fhe(a.body),{...a.attributes,...r});return Qi(s,bs())},"getIconSVG");function IO(t,{markdownAutoWrap:e}){const n=t.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),a=AO(n);return e===!1?a.replace(/ /g,"&nbsp;"):a}L(IO,"preprocessMarkdown");function RO(t,e={}){const r=IO(t,e),n=Rn.lexer(r),a=[[]];let s=0;function i(l,c="normal"){l.type==="text"?l.text.split(`
`).forEach((p,g)=>{g!==0&&(s++,a.push([])),p.split(" ").forEach(m=>{m=m.replace(/&#39;/g,"'"),m&&a[s].push({content:m,type:c})})}):l.type==="strong"||l.type==="em"?l.tokens.forEach(d=>{i(d,l.type)}):l.type==="html"&&a[s].push({content:l.text,type:"normal"})}return L(i,"processNode"),n.forEach(l=>{l.type==="paragraph"?l.tokens?.forEach(c=>{i(c)}):l.type==="html"?a[s].push({content:l.text,type:"normal"}):a[s].push({content:l.raw,type:"normal"})}),a}L(RO,"markdownToLines");function DO(t,{markdownAutoWrap:e}={}){const r=Rn.lexer(t);function n(a){return a.type==="text"?e===!1?a.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):a.text.replace(/\n */g,"<br/>"):a.type==="strong"?`<strong>${a.tokens?.map(n).join("")}</strong>`:a.type==="em"?`<em>${a.tokens?.map(n).join("")}</em>`:a.type==="paragraph"?`<p>${a.tokens?.map(n).join("")}</p>`:a.type==="space"?"":a.type==="html"?`${a.text}`:a.type==="escape"?a.text:(wt.warn(`Unsupported markdown: ${a.type}`),a.raw)}return L(n,"output"),r.map(n).join("")}L(DO,"markdownToHTML");function LO(t){return Intl.Segmenter?[...new Intl.Segmenter().segment(t)].map(e=>e.segment):[...t]}L(LO,"splitTextToChars");function MO(t,e){const r=LO(e.content);return Wk(t,[],r,e.type)}L(MO,"splitWordToFitWidth");function Wk(t,e,r,n){if(r.length===0)return[{content:e.join(""),type:n},{content:"",type:n}];const[a,...s]=r,i=[...e,a];return t([{content:i.join(""),type:n}])?Wk(t,i,s,n):(e.length===0&&a&&(e.push(a),r.shift()),[{content:e.join(""),type:n},{content:r.join(""),type:n}])}L(Wk,"splitWordToFitWidthRecursion");function OO(t,e){if(t.some(({content:r})=>r.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return vy(t,e)}L(OO,"splitLineToFitWidth");function vy(t,e,r=[],n=[]){if(t.length===0)return n.length>0&&r.push(n),r.length>0?r:[];let a="";t[0].content===" "&&(a=" ",t.shift());const s=t.shift()??{content:" ",type:"normal"},i=[...n];if(a!==""&&i.push({content:a,type:"normal"}),i.push(s),e(i))return vy(t,e,r,i);if(n.length>0)r.push(n),t.unshift(s);else if(s.content){const[l,c]=MO(e,s);r.push([l]),c.content&&t.unshift(c)}return vy(t,e,r)}L(vy,"splitLineToFitWidthRecursion");function Z1(t,e){e&&t.attr("style",e)}L(Z1,"applyStyle");async function jO(t,e,r,n,a=!1,s=bs()){const i=t.append("foreignObject");i.attr("width",`${10*r}px`),i.attr("height",`${10*r}px`);const l=i.append("xhtml:div"),c=mh(e.label)?await rk(e.label.replace(Dh.lineBreakRegex,`
`),s):Qi(e.label,s),d=e.isNode?"nodeLabel":"edgeLabel",p=l.append("span");p.html(c),Z1(p,e.labelStyle),p.attr("class",`${d} ${n}`),Z1(l,e.labelStyle),l.style("display","table-cell"),l.style("white-space","nowrap"),l.style("line-height","1.5"),l.style("max-width",r+"px"),l.style("text-align","center"),l.attr("xmlns","http://www.w3.org/1999/xhtml"),a&&l.attr("class","labelBkg");let g=l.node().getBoundingClientRect();return g.width===r&&(l.style("display","table"),l.style("white-space","break-spaces"),l.style("width",r+"px"),g=l.node().getBoundingClientRect()),i.node()}L(jO,"addHtmlSpan");function pb(t,e,r){return t.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",e*r-.1+"em").attr("dy",r+"em")}L(pb,"createTspan");function BO(t,e,r){const n=t.append("text"),a=pb(n,1,e);gb(a,r);const s=a.node().getComputedTextLength();return n.remove(),s}L(BO,"computeWidthOfText");function _pe(t,e,r){const n=t.append("text"),a=pb(n,1,e);gb(a,[{content:r,type:"normal"}]);const s=a.node()?.getBoundingClientRect();return s&&n.remove(),s}L(_pe,"computeDimensionOfText");function FO(t,e,r,n=!1){const s=e.append("g"),i=s.insert("rect").attr("class","background").attr("style","stroke: none"),l=s.append("text").attr("y","-10.1");let c=0;for(const d of r){const p=L(m=>BO(s,1.1,m)<=t,"checkWidth"),g=p(d)?[d]:OO(d,p);for(const m of g){const y=pb(l,c,1.1);gb(y,m),c++}}if(n){const d=l.node().getBBox(),p=2;return i.attr("x",d.x-p).attr("y",d.y-p).attr("width",d.width+2*p).attr("height",d.height+2*p),s.node()}else return l.node()}L(FO,"createFormattedText");function gb(t,e){t.text(""),e.forEach((r,n)=>{const a=t.append("tspan").attr("font-style",r.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",r.type==="strong"?"bold":"normal");n===0?a.text(r.content):a.text(" "+r.content)})}L(gb,"updateTextContentAndStyles");async function zO(t,e={}){const r=[];t.replace(/(fa[bklrs]?):fa-([\w-]+)/g,(a,s,i)=>(r.push((async()=>{const l=`${s}:${i}`;return await Epe(l)?await wf(l,void 0,{class:"label-icon"}):`<i class='${Qi(a,e).replace(":"," ")}'></i>`})()),a));const n=await Promise.all(r);return t.replace(/(fa[bklrs]?):fa-([\w-]+)/g,()=>n.shift()??"")}L(zO,"replaceIconSubstring");var jc=L(async(t,e="",{style:r="",isTitle:n=!1,classes:a="",useHtmlLabels:s=!0,isNode:i=!0,width:l=200,addSvgBackground:c=!1}={},d)=>{if(wt.debug("XYZ createText",e,r,n,a,s,i,"addSvgBackground: ",c),s){const p=DO(e,d),g=await zO(Wu(p),d),m=e.replace(/\\\\/g,"\\"),y={isNode:i,label:mh(e)?m:g,labelStyle:r.replace("fill:","color:")};return await jO(t,y,l,a,c,d)}else{const p=e.replace(/<br\s*\/?>/g,"<br/>"),g=RO(p.replace("<br>","<br/>"),d),m=FO(l,t,g,e?c:!1);if(i){/stroke:/.exec(r)&&(r=r.replace("stroke:","lineColor:"));const y=r.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");wn(m).attr("style",y)}else{const y=r.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");wn(m).select("rect").attr("style",y.replace(/background:/g,"fill:"));const x=r.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");wn(m).select("text").attr("style",x)}return m}},"createText");function uw(t,e,r){if(t&&t.length){const[n,a]=e,s=Math.PI/180*r,i=Math.cos(s),l=Math.sin(s);for(const c of t){const[d,p]=c;c[0]=(d-n)*i-(p-a)*l+n,c[1]=(d-n)*l+(p-a)*i+a}}}function Ape(t,e){return t[0]===e[0]&&t[1]===e[1]}function Npe(t,e,r,n=1){const a=r,s=Math.max(e,.1),i=t[0]&&t[0][0]&&typeof t[0][0]=="number"?[t]:t,l=[0,0];if(a)for(const d of i)uw(d,l,a);const c=(function(d,p,g){const m=[];for(const _ of d){const P=[..._];Ape(P[0],P[P.length-1])||P.push([P[0][0],P[0][1]]),P.length>2&&m.push(P)}const y=[];p=Math.max(p,.1);const x=[];for(const _ of m)for(let P=0;P<_.length-1;P++){const F=_[P],D=_[P+1];if(F[1]!==D[1]){const B=Math.min(F[1],D[1]);x.push({ymin:B,ymax:Math.max(F[1],D[1]),x:B===F[1]?F[0]:D[0],islope:(D[0]-F[0])/(D[1]-F[1])})}}if(x.sort(((_,P)=>_.ymin<P.ymin?-1:_.ymin>P.ymin?1:_.x<P.x?-1:_.x>P.x?1:_.ymax===P.ymax?0:(_.ymax-P.ymax)/Math.abs(_.ymax-P.ymax))),!x.length)return y;let w=[],T=x[0].ymin,k=0;for(;w.length||x.length;){if(x.length){let _=-1;for(let P=0;P<x.length&&!(x[P].ymin>T);P++)_=P;x.splice(0,_+1).forEach((P=>{w.push({s:T,edge:P})}))}if(w=w.filter((_=>!(_.edge.ymax<=T))),w.sort(((_,P)=>_.edge.x===P.edge.x?0:(_.edge.x-P.edge.x)/Math.abs(_.edge.x-P.edge.x))),(g!==1||k%p==0)&&w.length>1)for(let _=0;_<w.length;_+=2){const P=_+1;if(P>=w.length)break;const F=w[_].edge,D=w[P].edge;y.push([[Math.round(F.x),T],[Math.round(D.x),T]])}T+=g,w.forEach((_=>{_.edge.x=_.edge.x+g*_.edge.islope})),k++}return y})(i,s,n);if(a){for(const d of i)uw(d,l,-a);(function(d,p,g){const m=[];d.forEach((y=>m.push(...y))),uw(m,p,g)})(c,l,-a)}return c}function Sf(t,e){var r;const n=e.hachureAngle+90;let a=e.hachureGap;a<0&&(a=4*e.strokeWidth),a=Math.round(Math.max(a,.1));let s=1;return e.roughness>=1&&(((r=e.randomizer)===null||r===void 0?void 0:r.next())||Math.random())>.7&&(s=a),Npe(t,a,n,s||1)}class Yk{constructor(e){this.helper=e}fillPolygons(e,r){return this._fillPolygons(e,r)}_fillPolygons(e,r){const n=Sf(e,r);return{type:"fillSketch",ops:this.renderLines(n,r)}}renderLines(e,r){const n=[];for(const a of e)n.push(...this.helper.doubleLineOps(a[0][0],a[0][1],a[1][0],a[1][1],r));return n}}function fb(t){const e=t[0],r=t[1];return Math.sqrt(Math.pow(e[0]-r[0],2)+Math.pow(e[1]-r[1],2))}class Ppe extends Yk{fillPolygons(e,r){let n=r.hachureGap;n<0&&(n=4*r.strokeWidth),n=Math.max(n,.1);const a=Sf(e,Object.assign({},r,{hachureGap:n})),s=Math.PI/180*r.hachureAngle,i=[],l=.5*n*Math.cos(s),c=.5*n*Math.sin(s);for(const[d,p]of a)fb([d,p])&&i.push([[d[0]-l,d[1]+c],[...p]],[[d[0]+l,d[1]-c],[...p]]);return{type:"fillSketch",ops:this.renderLines(i,r)}}}class Ipe extends Yk{fillPolygons(e,r){const n=this._fillPolygons(e,r),a=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),s=this._fillPolygons(e,a);return n.ops=n.ops.concat(s.ops),n}}class Rpe{constructor(e){this.helper=e}fillPolygons(e,r){const n=Sf(e,r=Object.assign({},r,{hachureAngle:0}));return this.dotsOnLines(n,r)}dotsOnLines(e,r){const n=[];let a=r.hachureGap;a<0&&(a=4*r.strokeWidth),a=Math.max(a,.1);let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=a/4;for(const l of e){const c=fb(l),d=c/a,p=Math.ceil(d)-1,g=c-p*a,m=(l[0][0]+l[1][0])/2-a/4,y=Math.min(l[0][1],l[1][1]);for(let x=0;x<p;x++){const w=y+g+x*a,T=m-i+2*Math.random()*i,k=w-i+2*Math.random()*i,_=this.helper.ellipse(T,k,s,s,r);n.push(..._.ops)}}return{type:"fillSketch",ops:n}}}class Dpe{constructor(e){this.helper=e}fillPolygons(e,r){const n=Sf(e,r);return{type:"fillSketch",ops:this.dashedLine(n,r)}}dashedLine(e,r){const n=r.dashOffset<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashOffset,a=r.dashGap<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashGap,s=[];return e.forEach((i=>{const l=fb(i),c=Math.floor(l/(n+a)),d=(l+a-c*(n+a))/2;let p=i[0],g=i[1];p[0]>g[0]&&(p=i[1],g=i[0]);const m=Math.atan((g[1]-p[1])/(g[0]-p[0]));for(let y=0;y<c;y++){const x=y*(n+a),w=x+n,T=[p[0]+x*Math.cos(m)+d*Math.cos(m),p[1]+x*Math.sin(m)+d*Math.sin(m)],k=[p[0]+w*Math.cos(m)+d*Math.cos(m),p[1]+w*Math.sin(m)+d*Math.sin(m)];s.push(...this.helper.doubleLineOps(T[0],T[1],k[0],k[1],r))}})),s}}class Lpe{constructor(e){this.helper=e}fillPolygons(e,r){const n=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,a=r.zigzagOffset<0?n:r.zigzagOffset,s=Sf(e,r=Object.assign({},r,{hachureGap:n+a}));return{type:"fillSketch",ops:this.zigzagLines(s,a,r)}}zigzagLines(e,r,n){const a=[];return e.forEach((s=>{const i=fb(s),l=Math.round(i/(2*r));let c=s[0],d=s[1];c[0]>d[0]&&(c=s[1],d=s[0]);const p=Math.atan((d[1]-c[1])/(d[0]-c[0]));for(let g=0;g<l;g++){const m=2*g*r,y=2*(g+1)*r,x=Math.sqrt(2*Math.pow(r,2)),w=[c[0]+m*Math.cos(p),c[1]+m*Math.sin(p)],T=[c[0]+y*Math.cos(p),c[1]+y*Math.sin(p)],k=[w[0]+x*Math.cos(p+Math.PI/4),w[1]+x*Math.sin(p+Math.PI/4)];a.push(...this.helper.doubleLineOps(w[0],w[1],k[0],k[1],n),...this.helper.doubleLineOps(k[0],k[1],T[0],T[1],n))}})),a}}const ei={};class Mpe{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Ope=0,dw=1,l3=2,Vm={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function hw(t,e){return t.type===e}function Qk(t){const e=[],r=(function(i){const l=new Array;for(;i!=="";)if(i.match(/^([ \t\r\n,]+)/))i=i.substr(RegExp.$1.length);else if(i.match(/^([aAcChHlLmMqQsStTvVzZ])/))l[l.length]={type:Ope,text:RegExp.$1},i=i.substr(RegExp.$1.length);else{if(!i.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];l[l.length]={type:dw,text:`${parseFloat(RegExp.$1)}`},i=i.substr(RegExp.$1.length)}return l[l.length]={type:l3,text:""},l})(t);let n="BOD",a=0,s=r[a];for(;!hw(s,l3);){let i=0;const l=[];if(n==="BOD"){if(s.text!=="M"&&s.text!=="m")return Qk("M0,0"+t);a++,i=Vm[s.text],n=s.text}else hw(s,dw)?i=Vm[n]:(a++,i=Vm[s.text],n=s.text);if(!(a+i<r.length))throw new Error("Path data ended short");for(let c=a;c<a+i;c++){const d=r[c];if(!hw(d,dw))throw new Error("Param not a number: "+n+","+d.text);l[l.length]=+d.text}if(typeof Vm[n]!="number")throw new Error("Bad segment: "+n);{const c={key:n,data:l};e.push(c),a+=i,s=r[a],n==="M"&&(n="L"),n==="m"&&(n="l")}}return e}function $O(t){let e=0,r=0,n=0,a=0;const s=[];for(const{key:i,data:l}of t)switch(i){case"M":s.push({key:"M",data:[...l]}),[e,r]=l,[n,a]=l;break;case"m":e+=l[0],r+=l[1],s.push({key:"M",data:[e,r]}),n=e,a=r;break;case"L":s.push({key:"L",data:[...l]}),[e,r]=l;break;case"l":e+=l[0],r+=l[1],s.push({key:"L",data:[e,r]});break;case"C":s.push({key:"C",data:[...l]}),e=l[4],r=l[5];break;case"c":{const c=l.map(((d,p)=>p%2?d+r:d+e));s.push({key:"C",data:c}),e=c[4],r=c[5];break}case"Q":s.push({key:"Q",data:[...l]}),e=l[2],r=l[3];break;case"q":{const c=l.map(((d,p)=>p%2?d+r:d+e));s.push({key:"Q",data:c}),e=c[2],r=c[3];break}case"A":s.push({key:"A",data:[...l]}),e=l[5],r=l[6];break;case"a":e+=l[5],r+=l[6],s.push({key:"A",data:[l[0],l[1],l[2],l[3],l[4],e,r]});break;case"H":s.push({key:"H",data:[...l]}),e=l[0];break;case"h":e+=l[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...l]}),r=l[0];break;case"v":r+=l[0],s.push({key:"V",data:[r]});break;case"S":s.push({key:"S",data:[...l]}),e=l[2],r=l[3];break;case"s":{const c=l.map(((d,p)=>p%2?d+r:d+e));s.push({key:"S",data:c}),e=c[2],r=c[3];break}case"T":s.push({key:"T",data:[...l]}),e=l[0],r=l[1];break;case"t":e+=l[0],r+=l[1],s.push({key:"T",data:[e,r]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=n,r=a}return s}function UO(t){const e=[];let r="",n=0,a=0,s=0,i=0,l=0,c=0;for(const{key:d,data:p}of t){switch(d){case"M":e.push({key:"M",data:[...p]}),[n,a]=p,[s,i]=p;break;case"C":e.push({key:"C",data:[...p]}),n=p[4],a=p[5],l=p[2],c=p[3];break;case"L":e.push({key:"L",data:[...p]}),[n,a]=p;break;case"H":n=p[0],e.push({key:"L",data:[n,a]});break;case"V":a=p[0],e.push({key:"L",data:[n,a]});break;case"S":{let g=0,m=0;r==="C"||r==="S"?(g=n+(n-l),m=a+(a-c)):(g=n,m=a),e.push({key:"C",data:[g,m,...p]}),l=p[0],c=p[1],n=p[2],a=p[3];break}case"T":{const[g,m]=p;let y=0,x=0;r==="Q"||r==="T"?(y=n+(n-l),x=a+(a-c)):(y=n,x=a);const w=n+2*(y-n)/3,T=a+2*(x-a)/3,k=g+2*(y-g)/3,_=m+2*(x-m)/3;e.push({key:"C",data:[w,T,k,_,g,m]}),l=y,c=x,n=g,a=m;break}case"Q":{const[g,m,y,x]=p,w=n+2*(g-n)/3,T=a+2*(m-a)/3,k=y+2*(g-y)/3,_=x+2*(m-x)/3;e.push({key:"C",data:[w,T,k,_,y,x]}),l=g,c=m,n=y,a=x;break}case"A":{const g=Math.abs(p[0]),m=Math.abs(p[1]),y=p[2],x=p[3],w=p[4],T=p[5],k=p[6];g===0||m===0?(e.push({key:"C",data:[n,a,T,k,T,k]}),n=T,a=k):(n!==T||a!==k)&&(qO(n,a,T,k,g,m,y,x,w).forEach((function(_){e.push({key:"C",data:_})})),n=T,a=k);break}case"Z":e.push({key:"Z",data:[]}),n=s,a=i}r=d}return e}function Wp(t,e,r){return[t*Math.cos(r)-e*Math.sin(r),t*Math.sin(r)+e*Math.cos(r)]}function qO(t,e,r,n,a,s,i,l,c,d){const p=(g=i,Math.PI*g/180);var g;let m=[],y=0,x=0,w=0,T=0;if(d)[y,x,w,T]=d;else{[t,e]=Wp(t,e,-p),[r,n]=Wp(r,n,-p);const X=(t-r)/2,Q=(e-n)/2;let W=X*X/(a*a)+Q*Q/(s*s);W>1&&(W=Math.sqrt(W),a*=W,s*=W);const H=a*a,re=s*s,ne=H*re-H*Q*Q-re*X*X,ve=H*Q*Q+re*X*X,O=(l===c?-1:1)*Math.sqrt(Math.abs(ne/ve));w=O*a*Q/s+(t+r)/2,T=O*-s*X/a+(e+n)/2,y=Math.asin(parseFloat(((e-T)/s).toFixed(9))),x=Math.asin(parseFloat(((n-T)/s).toFixed(9))),t<w&&(y=Math.PI-y),r<w&&(x=Math.PI-x),y<0&&(y=2*Math.PI+y),x<0&&(x=2*Math.PI+x),c&&y>x&&(y-=2*Math.PI),!c&&x>y&&(x-=2*Math.PI)}let k=x-y;if(Math.abs(k)>120*Math.PI/180){const X=x,Q=r,W=n;x=c&&x>y?y+120*Math.PI/180*1:y+120*Math.PI/180*-1,m=qO(r=w+a*Math.cos(x),n=T+s*Math.sin(x),Q,W,a,s,i,0,c,[x,X,w,T])}k=x-y;const _=Math.cos(y),P=Math.sin(y),F=Math.cos(x),D=Math.sin(x),B=Math.tan(k/4),M=4/3*a*B,$=4/3*s*B,Z=[t,e],z=[t+M*P,e-$*_],ee=[r+M*D,n-$*F],te=[r,n];if(z[0]=2*Z[0]-z[0],z[1]=2*Z[1]-z[1],d)return[z,ee,te].concat(m);{m=[z,ee,te].concat(m);const X=[];for(let Q=0;Q<m.length;Q+=3){const W=Wp(m[Q][0],m[Q][1],p),H=Wp(m[Q+1][0],m[Q+1][1],p),re=Wp(m[Q+2][0],m[Q+2][1],p);X.push([W[0],W[1],H[0],H[1],re[0],re[1]])}return X}}const jpe={randOffset:function(t,e){return Mr(t,e)},randOffsetWithRange:function(t,e,r){return wy(t,e,r)},ellipse:function(t,e,r,n,a){const s=GO(r,n,a);return eS(t,e,a,s).opset},doubleLineOps:function(t,e,r,n,a){return Ic(t,e,r,n,a,!0)}};function HO(t,e,r,n,a){return{type:"path",ops:Ic(t,e,r,n,a)}}function b0(t,e,r){const n=(t||[]).length;if(n>2){const a=[];for(let s=0;s<n-1;s++)a.push(...Ic(t[s][0],t[s][1],t[s+1][0],t[s+1][1],r));return e&&a.push(...Ic(t[n-1][0],t[n-1][1],t[0][0],t[0][1],r)),{type:"path",ops:a}}return n===2?HO(t[0][0],t[0][1],t[1][0],t[1][1],r):{type:"path",ops:[]}}function Bpe(t,e,r,n,a){return(function(s,i){return b0(s,!0,i)})([[t,e],[t+r,e],[t+r,e+n],[t,e+n]],a)}function c3(t,e){if(t.length){const r=typeof t[0][0]=="number"?[t]:t,n=Wm(r[0],1*(1+.2*e.roughness),e),a=e.disableMultiStroke?[]:Wm(r[0],1.5*(1+.22*e.roughness),h3(e));for(let s=1;s<r.length;s++){const i=r[s];if(i.length){const l=Wm(i,1*(1+.2*e.roughness),e),c=e.disableMultiStroke?[]:Wm(i,1.5*(1+.22*e.roughness),h3(e));for(const d of l)d.op!=="move"&&n.push(d);for(const d of c)d.op!=="move"&&a.push(d)}}return{type:"path",ops:n.concat(a)}}return{type:"path",ops:[]}}function GO(t,e,r){const n=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(t/2,2)+Math.pow(e/2,2))/2)),a=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*n)),s=2*Math.PI/a;let i=Math.abs(t/2),l=Math.abs(e/2);const c=1-r.curveFitting;return i+=Mr(i*c,r),l+=Mr(l*c,r),{increment:s,rx:i,ry:l}}function eS(t,e,r,n){const[a,s]=p3(n.increment,t,e,n.rx,n.ry,1,n.increment*wy(.1,wy(.4,1,r),r),r);let i=Sy(a,null,r);if(!r.disableMultiStroke&&r.roughness!==0){const[l]=p3(n.increment,t,e,n.rx,n.ry,1.5,0,r),c=Sy(l,null,r);i=i.concat(c)}return{estimatedPoints:s,opset:{type:"path",ops:i}}}function u3(t,e,r,n,a,s,i,l,c){const d=t,p=e;let g=Math.abs(r/2),m=Math.abs(n/2);g+=Mr(.01*g,c),m+=Mr(.01*m,c);let y=a,x=s;for(;y<0;)y+=2*Math.PI,x+=2*Math.PI;x-y>2*Math.PI&&(y=0,x=2*Math.PI);const w=2*Math.PI/c.curveStepCount,T=Math.min(w/2,(x-y)/2),k=g3(T,d,p,g,m,y,x,1,c);if(!c.disableMultiStroke){const _=g3(T,d,p,g,m,y,x,1.5,c);k.push(..._)}return i&&(l?k.push(...Ic(d,p,d+g*Math.cos(y),p+m*Math.sin(y),c),...Ic(d,p,d+g*Math.cos(x),p+m*Math.sin(x),c)):k.push({op:"lineTo",data:[d,p]},{op:"lineTo",data:[d+g*Math.cos(y),p+m*Math.sin(y)]})),{type:"path",ops:k}}function d3(t,e){const r=UO($O(Qk(t))),n=[];let a=[0,0],s=[0,0];for(const{key:i,data:l}of r)switch(i){case"M":s=[l[0],l[1]],a=[l[0],l[1]];break;case"L":n.push(...Ic(s[0],s[1],l[0],l[1],e)),s=[l[0],l[1]];break;case"C":{const[c,d,p,g,m,y]=l;n.push(...Fpe(c,d,p,g,m,y,s,e)),s=[m,y];break}case"Z":n.push(...Ic(s[0],s[1],a[0],a[1],e)),s=[a[0],a[1]]}return{type:"path",ops:n}}function pw(t,e){const r=[];for(const n of t)if(n.length){const a=e.maxRandomnessOffset||0,s=n.length;if(s>2){r.push({op:"move",data:[n[0][0]+Mr(a,e),n[0][1]+Mr(a,e)]});for(let i=1;i<s;i++)r.push({op:"lineTo",data:[n[i][0]+Mr(a,e),n[i][1]+Mr(a,e)]})}}return{type:"fillPath",ops:r}}function jd(t,e){return(function(r,n){let a=r.fillStyle||"hachure";if(!ei[a])switch(a){case"zigzag":ei[a]||(ei[a]=new Ppe(n));break;case"cross-hatch":ei[a]||(ei[a]=new Ipe(n));break;case"dots":ei[a]||(ei[a]=new Rpe(n));break;case"dashed":ei[a]||(ei[a]=new Dpe(n));break;case"zigzag-line":ei[a]||(ei[a]=new Lpe(n));break;default:a="hachure",ei[a]||(ei[a]=new Yk(n))}return ei[a]})(e,jpe).fillPolygons(t,e)}function h3(t){const e=Object.assign({},t);return e.randomizer=void 0,t.seed&&(e.seed=t.seed+1),e}function VO(t){return t.randomizer||(t.randomizer=new Mpe(t.seed||0)),t.randomizer.next()}function wy(t,e,r,n=1){return r.roughness*n*(VO(r)*(e-t)+t)}function Mr(t,e,r=1){return wy(-t,t,e,r)}function Ic(t,e,r,n,a,s=!1){const i=s?a.disableMultiStrokeFill:a.disableMultiStroke,l=tS(t,e,r,n,a,!0,!1);if(i)return l;const c=tS(t,e,r,n,a,!0,!0);return l.concat(c)}function tS(t,e,r,n,a,s,i){const l=Math.pow(t-r,2)+Math.pow(e-n,2),c=Math.sqrt(l);let d=1;d=c<200?1:c>500?.4:-.0016668*c+1.233334;let p=a.maxRandomnessOffset||0;p*p*100>l&&(p=c/10);const g=p/2,m=.2+.2*VO(a);let y=a.bowing*a.maxRandomnessOffset*(n-e)/200,x=a.bowing*a.maxRandomnessOffset*(t-r)/200;y=Mr(y,a,d),x=Mr(x,a,d);const w=[],T=()=>Mr(g,a,d),k=()=>Mr(p,a,d),_=a.preserveVertices;return i?w.push({op:"move",data:[t+(_?0:T()),e+(_?0:T())]}):w.push({op:"move",data:[t+(_?0:Mr(p,a,d)),e+(_?0:Mr(p,a,d))]}),i?w.push({op:"bcurveTo",data:[y+t+(r-t)*m+T(),x+e+(n-e)*m+T(),y+t+2*(r-t)*m+T(),x+e+2*(n-e)*m+T(),r+(_?0:T()),n+(_?0:T())]}):w.push({op:"bcurveTo",data:[y+t+(r-t)*m+k(),x+e+(n-e)*m+k(),y+t+2*(r-t)*m+k(),x+e+2*(n-e)*m+k(),r+(_?0:k()),n+(_?0:k())]}),w}function Wm(t,e,r){if(!t.length)return[];const n=[];n.push([t[0][0]+Mr(e,r),t[0][1]+Mr(e,r)]),n.push([t[0][0]+Mr(e,r),t[0][1]+Mr(e,r)]);for(let a=1;a<t.length;a++)n.push([t[a][0]+Mr(e,r),t[a][1]+Mr(e,r)]),a===t.length-1&&n.push([t[a][0]+Mr(e,r),t[a][1]+Mr(e,r)]);return Sy(n,null,r)}function Sy(t,e,r){const n=t.length,a=[];if(n>3){const s=[],i=1-r.curveTightness;a.push({op:"move",data:[t[1][0],t[1][1]]});for(let l=1;l+2<n;l++){const c=t[l];s[0]=[c[0],c[1]],s[1]=[c[0]+(i*t[l+1][0]-i*t[l-1][0])/6,c[1]+(i*t[l+1][1]-i*t[l-1][1])/6],s[2]=[t[l+1][0]+(i*t[l][0]-i*t[l+2][0])/6,t[l+1][1]+(i*t[l][1]-i*t[l+2][1])/6],s[3]=[t[l+1][0],t[l+1][1]],a.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else n===3?(a.push({op:"move",data:[t[1][0],t[1][1]]}),a.push({op:"bcurveTo",data:[t[1][0],t[1][1],t[2][0],t[2][1],t[2][0],t[2][1]]})):n===2&&a.push(...tS(t[0][0],t[0][1],t[1][0],t[1][1],r,!0,!0));return a}function p3(t,e,r,n,a,s,i,l){const c=[],d=[];if(l.roughness===0){t/=4,d.push([e+n*Math.cos(-t),r+a*Math.sin(-t)]);for(let p=0;p<=2*Math.PI;p+=t){const g=[e+n*Math.cos(p),r+a*Math.sin(p)];c.push(g),d.push(g)}d.push([e+n*Math.cos(0),r+a*Math.sin(0)]),d.push([e+n*Math.cos(t),r+a*Math.sin(t)])}else{const p=Mr(.5,l)-Math.PI/2;d.push([Mr(s,l)+e+.9*n*Math.cos(p-t),Mr(s,l)+r+.9*a*Math.sin(p-t)]);const g=2*Math.PI+p-.01;for(let m=p;m<g;m+=t){const y=[Mr(s,l)+e+n*Math.cos(m),Mr(s,l)+r+a*Math.sin(m)];c.push(y),d.push(y)}d.push([Mr(s,l)+e+n*Math.cos(p+2*Math.PI+.5*i),Mr(s,l)+r+a*Math.sin(p+2*Math.PI+.5*i)]),d.push([Mr(s,l)+e+.98*n*Math.cos(p+i),Mr(s,l)+r+.98*a*Math.sin(p+i)]),d.push([Mr(s,l)+e+.9*n*Math.cos(p+.5*i),Mr(s,l)+r+.9*a*Math.sin(p+.5*i)])}return[d,c]}function g3(t,e,r,n,a,s,i,l,c){const d=s+Mr(.1,c),p=[];p.push([Mr(l,c)+e+.9*n*Math.cos(d-t),Mr(l,c)+r+.9*a*Math.sin(d-t)]);for(let g=d;g<=i;g+=t)p.push([Mr(l,c)+e+n*Math.cos(g),Mr(l,c)+r+a*Math.sin(g)]);return p.push([e+n*Math.cos(i),r+a*Math.sin(i)]),p.push([e+n*Math.cos(i),r+a*Math.sin(i)]),Sy(p,null,c)}function Fpe(t,e,r,n,a,s,i,l){const c=[],d=[l.maxRandomnessOffset||1,(l.maxRandomnessOffset||1)+.3];let p=[0,0];const g=l.disableMultiStroke?1:2,m=l.preserveVertices;for(let y=0;y<g;y++)y===0?c.push({op:"move",data:[i[0],i[1]]}):c.push({op:"move",data:[i[0]+(m?0:Mr(d[0],l)),i[1]+(m?0:Mr(d[0],l))]}),p=m?[a,s]:[a+Mr(d[y],l),s+Mr(d[y],l)],c.push({op:"bcurveTo",data:[t+Mr(d[y],l),e+Mr(d[y],l),r+Mr(d[y],l),n+Mr(d[y],l),p[0],p[1]]});return c}function Yp(t){return[...t]}function f3(t,e=0){const r=t.length;if(r<3)throw new Error("A curve must have at least three points.");const n=[];if(r===3)n.push(Yp(t[0]),Yp(t[1]),Yp(t[2]),Yp(t[2]));else{const a=[];a.push(t[0],t[0]);for(let l=1;l<t.length;l++)a.push(t[l]),l===t.length-1&&a.push(t[l]);const s=[],i=1-e;n.push(Yp(a[0]));for(let l=1;l+2<a.length;l++){const c=a[l];s[0]=[c[0],c[1]],s[1]=[c[0]+(i*a[l+1][0]-i*a[l-1][0])/6,c[1]+(i*a[l+1][1]-i*a[l-1][1])/6],s[2]=[a[l+1][0]+(i*a[l][0]-i*a[l+2][0])/6,a[l+1][1]+(i*a[l][1]-i*a[l+2][1])/6],s[3]=[a[l+1][0],a[l+1][1]],n.push(s[1],s[2],s[3])}}return n}function x0(t,e){return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)}function zpe(t,e,r){const n=x0(e,r);if(n===0)return x0(t,e);let a=((t[0]-e[0])*(r[0]-e[0])+(t[1]-e[1])*(r[1]-e[1]))/n;return a=Math.max(0,Math.min(1,a)),x0(t,fu(e,r,a))}function fu(t,e,r){return[t[0]+(e[0]-t[0])*r,t[1]+(e[1]-t[1])*r]}function rS(t,e,r,n){const a=n||[];if((function(l,c){const d=l[c+0],p=l[c+1],g=l[c+2],m=l[c+3];let y=3*p[0]-2*d[0]-m[0];y*=y;let x=3*p[1]-2*d[1]-m[1];x*=x;let w=3*g[0]-2*m[0]-d[0];w*=w;let T=3*g[1]-2*m[1]-d[1];return T*=T,y<w&&(y=w),x<T&&(x=T),y+x})(t,e)<r){const l=t[e+0];a.length?(s=a[a.length-1],i=l,Math.sqrt(x0(s,i))>1&&a.push(l)):a.push(l),a.push(t[e+3])}else{const c=t[e+0],d=t[e+1],p=t[e+2],g=t[e+3],m=fu(c,d,.5),y=fu(d,p,.5),x=fu(p,g,.5),w=fu(m,y,.5),T=fu(y,x,.5),k=fu(w,T,.5);rS([c,m,w,k],0,r,a),rS([k,T,x,g],0,r,a)}var s,i;return a}function $pe(t,e){return ky(t,0,t.length,e)}function ky(t,e,r,n,a){const s=a||[],i=t[e],l=t[r-1];let c=0,d=1;for(let p=e+1;p<r-1;++p){const g=zpe(t[p],i,l);g>c&&(c=g,d=p)}return Math.sqrt(c)>n?(ky(t,e,d+1,n,s),ky(t,d,r,n,s)):(s.length||s.push(i),s.push(l)),s}function gw(t,e=.15,r){const n=[],a=(t.length-1)/3;for(let s=0;s<a;s++)rS(t,3*s,e,n);return r&&r>0?ky(n,0,n.length,r):n}const Ti="none";class Ty{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,r,n){return{shape:e,sets:r||[],options:n||this.defaultOptions}}line(e,r,n,a,s){const i=this._o(s);return this._d("line",[HO(e,r,n,a,i)],i)}rectangle(e,r,n,a,s){const i=this._o(s),l=[],c=Bpe(e,r,n,a,i);if(i.fill){const d=[[e,r],[e+n,r],[e+n,r+a],[e,r+a]];i.fillStyle==="solid"?l.push(pw([d],i)):l.push(jd([d],i))}return i.stroke!==Ti&&l.push(c),this._d("rectangle",l,i)}ellipse(e,r,n,a,s){const i=this._o(s),l=[],c=GO(n,a,i),d=eS(e,r,i,c);if(i.fill)if(i.fillStyle==="solid"){const p=eS(e,r,i,c).opset;p.type="fillPath",l.push(p)}else l.push(jd([d.estimatedPoints],i));return i.stroke!==Ti&&l.push(d.opset),this._d("ellipse",l,i)}circle(e,r,n,a){const s=this.ellipse(e,r,n,n,a);return s.shape="circle",s}linearPath(e,r){const n=this._o(r);return this._d("linearPath",[b0(e,!1,n)],n)}arc(e,r,n,a,s,i,l=!1,c){const d=this._o(c),p=[],g=u3(e,r,n,a,s,i,l,!0,d);if(l&&d.fill)if(d.fillStyle==="solid"){const m=Object.assign({},d);m.disableMultiStroke=!0;const y=u3(e,r,n,a,s,i,!0,!1,m);y.type="fillPath",p.push(y)}else p.push((function(m,y,x,w,T,k,_){const P=m,F=y;let D=Math.abs(x/2),B=Math.abs(w/2);D+=Mr(.01*D,_),B+=Mr(.01*B,_);let M=T,$=k;for(;M<0;)M+=2*Math.PI,$+=2*Math.PI;$-M>2*Math.PI&&(M=0,$=2*Math.PI);const Z=($-M)/_.curveStepCount,z=[];for(let ee=M;ee<=$;ee+=Z)z.push([P+D*Math.cos(ee),F+B*Math.sin(ee)]);return z.push([P+D*Math.cos($),F+B*Math.sin($)]),z.push([P,F]),jd([z],_)})(e,r,n,a,s,i,d));return d.stroke!==Ti&&p.push(g),this._d("arc",p,d)}curve(e,r){const n=this._o(r),a=[],s=c3(e,n);if(n.fill&&n.fill!==Ti)if(n.fillStyle==="solid"){const i=c3(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(i.ops)})}else{const i=[],l=e;if(l.length){const c=typeof l[0][0]=="number"?[l]:l;for(const d of c)d.length<3?i.push(...d):d.length===3?i.push(...gw(f3([d[0],d[0],d[1],d[2]]),10,(1+n.roughness)/2)):i.push(...gw(f3(d),10,(1+n.roughness)/2))}i.length&&a.push(jd([i],n))}return n.stroke!==Ti&&a.push(s),this._d("curve",a,n)}polygon(e,r){const n=this._o(r),a=[],s=b0(e,!0,n);return n.fill&&(n.fillStyle==="solid"?a.push(pw([e],n)):a.push(jd([e],n))),n.stroke!==Ti&&a.push(s),this._d("polygon",a,n)}path(e,r){const n=this._o(r),a=[];if(!e)return this._d("path",a,n);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=n.fill&&n.fill!=="transparent"&&n.fill!==Ti,i=n.stroke!==Ti,l=!!(n.simplification&&n.simplification<1),c=(function(p,g,m){const y=UO($O(Qk(p))),x=[];let w=[],T=[0,0],k=[];const _=()=>{k.length>=4&&w.push(...gw(k,g)),k=[]},P=()=>{_(),w.length&&(x.push(w),w=[])};for(const{key:D,data:B}of y)switch(D){case"M":P(),T=[B[0],B[1]],w.push(T);break;case"L":_(),w.push([B[0],B[1]]);break;case"C":if(!k.length){const M=w.length?w[w.length-1]:T;k.push([M[0],M[1]])}k.push([B[0],B[1]]),k.push([B[2],B[3]]),k.push([B[4],B[5]]);break;case"Z":_(),w.push([T[0],T[1]])}if(P(),!m)return x;const F=[];for(const D of x){const B=$pe(D,m);B.length&&F.push(B)}return F})(e,1,l?4-4*(n.simplification||1):(1+n.roughness)/2),d=d3(e,n);if(s)if(n.fillStyle==="solid")if(c.length===1){const p=d3(e,Object.assign(Object.assign({},n),{disableMultiStroke:!0,roughness:n.roughness?n.roughness+n.fillShapeRoughnessGain:0}));a.push({type:"fillPath",ops:this._mergedShape(p.ops)})}else a.push(pw(c,n));else a.push(jd(c,n));return i&&(l?c.forEach((p=>{a.push(b0(p,!1,n))})):a.push(d)),this._d("path",a,n)}opsToPath(e,r){let n="";for(const a of e.ops){const s=typeof r=="number"&&r>=0?a.data.map((i=>+i.toFixed(r))):a.data;switch(a.op){case"move":n+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":n+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":n+=`L${s[0]} ${s[1]} `}}return n.trim()}toPaths(e){const r=e.sets||[],n=e.options||this.defaultOptions,a=[];for(const s of r){let i=null;switch(s.type){case"path":i={d:this.opsToPath(s),stroke:n.stroke,strokeWidth:n.strokeWidth,fill:Ti};break;case"fillPath":i={d:this.opsToPath(s),stroke:Ti,strokeWidth:0,fill:n.fill||Ti};break;case"fillSketch":i=this.fillSketch(s,n)}i&&a.push(i)}return a}fillSketch(e,r){let n=r.fillWeight;return n<0&&(n=r.strokeWidth/2),{d:this.opsToPath(e),stroke:r.fill||Ti,strokeWidth:n,fill:Ti}}_mergedShape(e){return e.filter(((r,n)=>n===0||r.op!=="move"))}}class Upe{constructor(e,r){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new Ty(r)}draw(e){const r=e.sets||[],n=e.options||this.getDefaultOptions(),a=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const i of r)switch(i.type){case"path":a.save(),a.strokeStyle=n.stroke==="none"?"transparent":n.stroke,a.lineWidth=n.strokeWidth,n.strokeLineDash&&a.setLineDash(n.strokeLineDash),n.strokeLineDashOffset&&(a.lineDashOffset=n.strokeLineDashOffset),this._drawToContext(a,i,s),a.restore();break;case"fillPath":{a.save(),a.fillStyle=n.fill||"";const l=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(a,i,s,l),a.restore();break}case"fillSketch":this.fillSketch(a,i,n)}}fillSketch(e,r,n){let a=n.fillWeight;a<0&&(a=n.strokeWidth/2),e.save(),n.fillLineDash&&e.setLineDash(n.fillLineDash),n.fillLineDashOffset&&(e.lineDashOffset=n.fillLineDashOffset),e.strokeStyle=n.fill||"",e.lineWidth=a,this._drawToContext(e,r,n.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,r,n,a="nonzero"){e.beginPath();for(const s of r.ops){const i=typeof n=="number"&&n>=0?s.data.map((l=>+l.toFixed(n))):s.data;switch(s.op){case"move":e.moveTo(i[0],i[1]);break;case"bcurveTo":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"lineTo":e.lineTo(i[0],i[1])}}r.type==="fillPath"?e.fill(a):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,r,n,a,s){const i=this.gen.line(e,r,n,a,s);return this.draw(i),i}rectangle(e,r,n,a,s){const i=this.gen.rectangle(e,r,n,a,s);return this.draw(i),i}ellipse(e,r,n,a,s){const i=this.gen.ellipse(e,r,n,a,s);return this.draw(i),i}circle(e,r,n,a){const s=this.gen.circle(e,r,n,a);return this.draw(s),s}linearPath(e,r){const n=this.gen.linearPath(e,r);return this.draw(n),n}polygon(e,r){const n=this.gen.polygon(e,r);return this.draw(n),n}arc(e,r,n,a,s,i,l=!1,c){const d=this.gen.arc(e,r,n,a,s,i,l,c);return this.draw(d),d}curve(e,r){const n=this.gen.curve(e,r);return this.draw(n),n}path(e,r){const n=this.gen.path(e,r);return this.draw(n),n}}const Ym="http://www.w3.org/2000/svg";class qpe{constructor(e,r){this.svg=e,this.gen=new Ty(r)}draw(e){const r=e.sets||[],n=e.options||this.getDefaultOptions(),a=this.svg.ownerDocument||window.document,s=a.createElementNS(Ym,"g"),i=e.options.fixedDecimalPlaceDigits;for(const l of r){let c=null;switch(l.type){case"path":c=a.createElementNS(Ym,"path"),c.setAttribute("d",this.opsToPath(l,i)),c.setAttribute("stroke",n.stroke),c.setAttribute("stroke-width",n.strokeWidth+""),c.setAttribute("fill","none"),n.strokeLineDash&&c.setAttribute("stroke-dasharray",n.strokeLineDash.join(" ").trim()),n.strokeLineDashOffset&&c.setAttribute("stroke-dashoffset",`${n.strokeLineDashOffset}`);break;case"fillPath":c=a.createElementNS(Ym,"path"),c.setAttribute("d",this.opsToPath(l,i)),c.setAttribute("stroke","none"),c.setAttribute("stroke-width","0"),c.setAttribute("fill",n.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||c.setAttribute("fill-rule","evenodd");break;case"fillSketch":c=this.fillSketch(a,l,n)}c&&s.appendChild(c)}return s}fillSketch(e,r,n){let a=n.fillWeight;a<0&&(a=n.strokeWidth/2);const s=e.createElementNS(Ym,"path");return s.setAttribute("d",this.opsToPath(r,n.fixedDecimalPlaceDigits)),s.setAttribute("stroke",n.fill||""),s.setAttribute("stroke-width",a+""),s.setAttribute("fill","none"),n.fillLineDash&&s.setAttribute("stroke-dasharray",n.fillLineDash.join(" ").trim()),n.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${n.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,r){return this.gen.opsToPath(e,r)}line(e,r,n,a,s){const i=this.gen.line(e,r,n,a,s);return this.draw(i)}rectangle(e,r,n,a,s){const i=this.gen.rectangle(e,r,n,a,s);return this.draw(i)}ellipse(e,r,n,a,s){const i=this.gen.ellipse(e,r,n,a,s);return this.draw(i)}circle(e,r,n,a){const s=this.gen.circle(e,r,n,a);return this.draw(s)}linearPath(e,r){const n=this.gen.linearPath(e,r);return this.draw(n)}polygon(e,r){const n=this.gen.polygon(e,r);return this.draw(n)}arc(e,r,n,a,s,i,l=!1,c){const d=this.gen.arc(e,r,n,a,s,i,l,c);return this.draw(d)}curve(e,r){const n=this.gen.curve(e,r);return this.draw(n)}path(e,r){const n=this.gen.path(e,r);return this.draw(n)}}var hr={canvas:(t,e)=>new Upe(t,e),svg:(t,e)=>new qpe(t,e),generator:t=>new Ty(t),newSeed:()=>Ty.newSeed()},Dr=L(async(t,e,r)=>{let n;const a=e.useHtmlLabels||Wa(In()?.htmlLabels);r?n=r:n="node default";const s=t.insert("g").attr("class",n).attr("id",e.domId||e.id),i=s.insert("g").attr("class","label").attr("style",vs(e.labelStyle));let l;e.label===void 0?l="":l=typeof e.label=="string"?e.label:e.label[0];const c=await jc(i,Qi(Wu(l),In()),{useHtmlLabels:a,width:e.width||In().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:e.labelStyle,addSvgBackground:!!e.icon||!!e.img});let d=c.getBBox();const p=(e?.padding??0)/2;if(a){const g=c.children[0],m=wn(c),y=g.getElementsByTagName("img");if(y){const x=l.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...y].map(w=>new Promise(T=>{function k(){if(w.style.display="flex",w.style.flexDirection="column",x){const _=In().fontSize?In().fontSize:window.getComputedStyle(document.body).fontSize,P=5,[F=iL.fontSize]=ub(_),D=F*P+"px";w.style.minWidth=D,w.style.maxWidth=D}else w.style.width="100%";T(w)}L(k,"setupImage"),setTimeout(()=>{w.complete&&k()}),w.addEventListener("error",k),w.addEventListener("load",k)})))}d=g.getBoundingClientRect(),m.attr("width",d.width),m.attr("height",d.height)}return a?i.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"):i.attr("transform","translate(0, "+-d.height/2+")"),e.centerLabel&&i.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),i.insert("rect",":first-child"),{shapeSvg:s,bbox:d,halfPadding:p,label:i}},"labelHelper"),fw=L(async(t,e,r)=>{const n=r.useHtmlLabels||Wa(In()?.flowchart?.htmlLabels),a=t.insert("g").attr("class","label").attr("style",r.labelStyle||""),s=await jc(a,Qi(Wu(e),In()),{useHtmlLabels:n,width:r.width||In()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img});let i=s.getBBox();const l=r.padding/2;if(Wa(In()?.flowchart?.htmlLabels)){const c=s.children[0],d=wn(s);i=c.getBoundingClientRect(),d.attr("width",i.width),d.attr("height",i.height)}return n?a.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"):a.attr("transform","translate(0, "+-i.height/2+")"),r.centerLabel&&a.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:t,bbox:i,halfPadding:l,label:a}},"insertLabel"),mr=L((t,e)=>{const r=e.node().getBBox();t.width=r.width,t.height=r.height},"updateNodeBounds"),Nr=L((t,e)=>(t.look==="handDrawn"?"rough-node":"node")+" "+t.cssClasses+" "+(e||""),"getNodeClasses");function hn(t){const e=t.map((r,n)=>`${n===0?"M":"L"}${r.x},${r.y}`);return e.push("Z"),e.join(" ")}L(hn,"createPathFromPoints");function Rc(t,e,r,n,a,s){const i=[],c=r-t,d=n-e,p=c/s,g=2*Math.PI/p,m=e+d/2;for(let y=0;y<=50;y++){const x=y/50,w=t+x*c,T=m+a*Math.sin(g*(w-t));i.push({x:w,y:T})}return i}L(Rc,"generateFullSineWavePoints");function Vg(t,e,r,n,a,s){const i=[],l=a*Math.PI/180,p=(s*Math.PI/180-l)/(n-1);for(let g=0;g<n;g++){const m=l+g*p,y=t+r*Math.cos(m),x=e+r*Math.sin(m);i.push({x:-y,y:-x})}return i}L(Vg,"generateCirclePoints");var Hpe=L((t,e)=>{var r=t.x,n=t.y,a=e.x-r,s=e.y-n,i=t.width/2,l=t.height/2,c,d;return Math.abs(s)*i>Math.abs(a)*l?(s<0&&(l=-l),c=s===0?0:l*a/s,d=l):(a<0&&(i=-i),c=i,d=a===0?0:i*s/a),{x:r+c,y:n+d}},"intersectRect"),jh=Hpe;function WO(t,e){e&&t.attr("style",e)}L(WO,"applyStyle");async function YO(t){const e=wn(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=e.append("xhtml:div"),n=In();let a=t.label;t.label&&mh(t.label)&&(a=await rk(t.label.replace(Dh.lineBreakRegex,`
`),n));const i='<span class="'+(t.isNode?"nodeLabel":"edgeLabel")+'" '+(t.labelStyle?'style="'+t.labelStyle+'"':"")+">"+a+"</span>";return r.html(Qi(i,n)),WO(r,t.labelStyle),r.style("display","inline-block"),r.style("padding-right","1px"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),e.node()}L(YO,"addHtmlLabel");var Gpe=L(async(t,e,r,n)=>{let a=t||"";if(typeof a=="object"&&(a=a[0]),Wa(In().flowchart.htmlLabels)){a=a.replace(/\\n|\n/g,"<br />"),wt.info("vertexText"+a);const s={isNode:n,label:Wu(a).replace(/fa[blrs]?:fa-[\w-]+/g,l=>`<i class='${l.replace(":"," ")}'></i>`),labelStyle:e&&e.replace("fill:","color:")};return await YO(s)}else{const s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("style",e.replace("color:","fill:"));let i=[];typeof a=="string"?i=a.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(a)?i=a:i=[];for(const l of i){const c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),r?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=l.trim(),s.appendChild(c)}return s}},"createLabel"),ku=Gpe,Bc=L((t,e,r,n,a)=>["M",t+a,e,"H",t+r-a,"A",a,a,0,0,1,t+r,e+a,"V",e+n-a,"A",a,a,0,0,1,t+r-a,e+n,"H",t+a,"A",a,a,0,0,1,t,e+n-a,"V",e+a,"A",a,a,0,0,1,t+a,e,"Z"].join(" "),"createRoundedRectPathD"),QO=L(async(t,e)=>{wt.info("Creating subgraph rect for ",e.id,e);const r=In(),{themeVariables:n,handDrawnSeed:a}=r,{clusterBkg:s,clusterBorder:i}=n,{labelStyles:l,nodeStyles:c,borderStyles:d,backgroundStyles:p}=gr(e),g=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),m=Wa(r.flowchart.htmlLabels),y=g.insert("g").attr("class","cluster-label "),x=await jc(y,e.label,{style:e.labelStyle,useHtmlLabels:m,isNode:!0});let w=x.getBBox();if(Wa(r.flowchart.htmlLabels)){const M=x.children[0],$=wn(x);w=M.getBoundingClientRect(),$.attr("width",w.width),$.attr("height",w.height)}const T=e.width<=w.width+e.padding?w.width+e.padding:e.width;e.width<=w.width+e.padding?e.diff=(T-e.width)/2-e.padding:e.diff=-e.padding;const k=e.height,_=e.x-T/2,P=e.y-k/2;wt.trace("Data ",e,JSON.stringify(e));let F;if(e.look==="handDrawn"){const M=hr.svg(g),$=pr(e,{roughness:.7,fill:s,stroke:i,fillWeight:3,seed:a}),Z=M.path(Bc(_,P,T,k,0),$);F=g.insert(()=>(wt.debug("Rough node insert CXC",Z),Z),":first-child"),F.select("path:nth-child(2)").attr("style",d.join(";")),F.select("path").attr("style",p.join(";").replace("fill","stroke"))}else F=g.insert("rect",":first-child"),F.attr("style",c).attr("rx",e.rx).attr("ry",e.ry).attr("x",_).attr("y",P).attr("width",T).attr("height",k);const{subGraphTitleTopMargin:D}=_k(r);if(y.attr("transform",`translate(${e.x-w.width/2}, ${e.y-e.height/2+D})`),l){const M=y.select("span");M&&M.attr("style",l)}const B=F.node().getBBox();return e.offsetX=0,e.width=B.width,e.height=B.height,e.offsetY=w.height-e.padding/2,e.intersect=function(M){return jh(e,M)},{cluster:g,labelBBox:w}},"rect"),Vpe=L((t,e)=>{const r=t.insert("g").attr("class","note-cluster").attr("id",e.id),n=r.insert("rect",":first-child"),a=0*e.padding,s=a/2;n.attr("rx",e.rx).attr("ry",e.ry).attr("x",e.x-e.width/2-s).attr("y",e.y-e.height/2-s).attr("width",e.width+a).attr("height",e.height+a).attr("fill","none");const i=n.node().getBBox();return e.width=i.width,e.height=i.height,e.intersect=function(l){return jh(e,l)},{cluster:r,labelBBox:{width:0,height:0}}},"noteGroup"),Wpe=L(async(t,e)=>{const r=In(),{themeVariables:n,handDrawnSeed:a}=r,{altBackground:s,compositeBackground:i,compositeTitleBackground:l,nodeBorder:c}=n,d=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-id",e.id).attr("data-look",e.look),p=d.insert("g",":first-child"),g=d.insert("g").attr("class","cluster-label");let m=d.append("rect");const y=g.node().appendChild(await ku(e.label,e.labelStyle,void 0,!0));let x=y.getBBox();if(Wa(r.flowchart.htmlLabels)){const Z=y.children[0],z=wn(y);x=Z.getBoundingClientRect(),z.attr("width",x.width),z.attr("height",x.height)}const w=0*e.padding,T=w/2,k=(e.width<=x.width+e.padding?x.width+e.padding:e.width)+w;e.width<=x.width+e.padding?e.diff=(k-e.width)/2-e.padding:e.diff=-e.padding;const _=e.height+w,P=e.height+w-x.height-6,F=e.x-k/2,D=e.y-_/2;e.width=k;const B=e.y-e.height/2-T+x.height+2;let M;if(e.look==="handDrawn"){const Z=e.cssClasses.includes("statediagram-cluster-alt"),z=hr.svg(d),ee=e.rx||e.ry?z.path(Bc(F,D,k,_,10),{roughness:.7,fill:l,fillStyle:"solid",stroke:c,seed:a}):z.rectangle(F,D,k,_,{seed:a});M=d.insert(()=>ee,":first-child");const te=z.rectangle(F,B,k,P,{fill:Z?s:i,fillStyle:Z?"hachure":"solid",stroke:c,seed:a});M=d.insert(()=>ee,":first-child"),m=d.insert(()=>te)}else M=p.insert("rect",":first-child"),M.attr("class","outer").attr("x",F).attr("y",D).attr("width",k).attr("height",_).attr("data-look",e.look),m.attr("class","inner").attr("x",F).attr("y",B).attr("width",k).attr("height",P);g.attr("transform",`translate(${e.x-x.width/2}, ${D+1-(Wa(r.flowchart.htmlLabels)?0:3)})`);const $=M.node().getBBox();return e.height=$.height,e.offsetX=0,e.offsetY=x.height-e.padding/2,e.labelBBox=x,e.intersect=function(Z){return jh(e,Z)},{cluster:d,labelBBox:x}},"roundedWithTitle"),Ype=L(async(t,e)=>{wt.info("Creating subgraph rect for ",e.id,e);const r=In(),{themeVariables:n,handDrawnSeed:a}=r,{clusterBkg:s,clusterBorder:i}=n,{labelStyles:l,nodeStyles:c,borderStyles:d,backgroundStyles:p}=gr(e),g=t.insert("g").attr("class","cluster "+e.cssClasses).attr("id",e.id).attr("data-look",e.look),m=Wa(r.flowchart.htmlLabels),y=g.insert("g").attr("class","cluster-label "),x=await jc(y,e.label,{style:e.labelStyle,useHtmlLabels:m,isNode:!0,width:e.width});let w=x.getBBox();if(Wa(r.flowchart.htmlLabels)){const M=x.children[0],$=wn(x);w=M.getBoundingClientRect(),$.attr("width",w.width),$.attr("height",w.height)}const T=e.width<=w.width+e.padding?w.width+e.padding:e.width;e.width<=w.width+e.padding?e.diff=(T-e.width)/2-e.padding:e.diff=-e.padding;const k=e.height,_=e.x-T/2,P=e.y-k/2;wt.trace("Data ",e,JSON.stringify(e));let F;if(e.look==="handDrawn"){const M=hr.svg(g),$=pr(e,{roughness:.7,fill:s,stroke:i,fillWeight:4,seed:a}),Z=M.path(Bc(_,P,T,k,e.rx),$);F=g.insert(()=>(wt.debug("Rough node insert CXC",Z),Z),":first-child"),F.select("path:nth-child(2)").attr("style",d.join(";")),F.select("path").attr("style",p.join(";").replace("fill","stroke"))}else F=g.insert("rect",":first-child"),F.attr("style",c).attr("rx",e.rx).attr("ry",e.ry).attr("x",_).attr("y",P).attr("width",T).attr("height",k);const{subGraphTitleTopMargin:D}=_k(r);if(y.attr("transform",`translate(${e.x-w.width/2}, ${e.y-e.height/2+D})`),l){const M=y.select("span");M&&M.attr("style",l)}const B=F.node().getBBox();return e.offsetX=0,e.width=B.width,e.height=B.height,e.offsetY=w.height-e.padding/2,e.intersect=function(M){return jh(e,M)},{cluster:g,labelBBox:w}},"kanbanSection"),Qpe=L((t,e)=>{const r=In(),{themeVariables:n,handDrawnSeed:a}=r,{nodeBorder:s}=n,i=t.insert("g").attr("class",e.cssClasses).attr("id",e.id).attr("data-look",e.look),l=i.insert("g",":first-child"),c=0*e.padding,d=e.width+c;e.diff=-e.padding;const p=e.height+c,g=e.x-d/2,m=e.y-p/2;e.width=d;let y;if(e.look==="handDrawn"){const T=hr.svg(i).rectangle(g,m,d,p,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:s,seed:a});y=i.insert(()=>T,":first-child")}else y=l.insert("rect",":first-child"),y.attr("class","divider").attr("x",g).attr("y",m).attr("width",d).attr("height",p).attr("data-look",e.look);const x=y.node().getBBox();return e.height=x.height,e.offsetX=0,e.offsetY=0,e.intersect=function(w){return jh(e,w)},{cluster:i,labelBBox:{}}},"divider"),Kpe=QO,Xpe={rect:QO,squareRect:Kpe,roundedWithTitle:Wpe,noteGroup:Vpe,divider:Qpe,kanbanSection:Ype},KO=new Map,Jpe=L(async(t,e)=>{const r=e.shape||"rect",n=await Xpe[r](t,e);return KO.set(e.id,n),n},"insertCluster"),uve=L(()=>{KO=new Map},"clear");function XO(t,e){return t.intersect(e)}L(XO,"intersectNode");var Zpe=XO;function JO(t,e,r,n){var a=t.x,s=t.y,i=a-n.x,l=s-n.y,c=Math.sqrt(e*e*l*l+r*r*i*i),d=Math.abs(e*r*i/c);n.x<a&&(d=-d);var p=Math.abs(e*r*l/c);return n.y<s&&(p=-p),{x:a+d,y:s+p}}L(JO,"intersectEllipse");var ZO=JO;function e6(t,e,r){return ZO(t,e,e,r)}L(e6,"intersectCircle");var ege=e6;function t6(t,e,r,n){{const a=e.y-t.y,s=t.x-e.x,i=e.x*t.y-t.x*e.y,l=a*r.x+s*r.y+i,c=a*n.x+s*n.y+i,d=1e-6;if(l!==0&&c!==0&&nS(l,c))return;const p=n.y-r.y,g=r.x-n.x,m=n.x*r.y-r.x*n.y,y=p*t.x+g*t.y+m,x=p*e.x+g*e.y+m;if(Math.abs(y)<d&&Math.abs(x)<d&&nS(y,x))return;const w=a*g-p*s;if(w===0)return;const T=Math.abs(w/2);let k=s*m-g*i;const _=k<0?(k-T)/w:(k+T)/w;k=p*i-a*m;const P=k<0?(k-T)/w:(k+T)/w;return{x:_,y:P}}}L(t6,"intersectLine");function nS(t,e){return t*e>0}L(nS,"sameSign");var tge=t6;function r6(t,e,r){let n=t.x,a=t.y,s=[],i=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY;typeof e.forEach=="function"?e.forEach(function(p){i=Math.min(i,p.x),l=Math.min(l,p.y)}):(i=Math.min(i,e.x),l=Math.min(l,e.y));let c=n-t.width/2-i,d=a-t.height/2-l;for(let p=0;p<e.length;p++){let g=e[p],m=e[p<e.length-1?p+1:0],y=tge(t,r,{x:c+g.x,y:d+g.y},{x:c+m.x,y:d+m.y});y&&s.push(y)}return s.length?(s.length>1&&s.sort(function(p,g){let m=p.x-r.x,y=p.y-r.y,x=Math.sqrt(m*m+y*y),w=g.x-r.x,T=g.y-r.y,k=Math.sqrt(w*w+T*T);return x<k?-1:x===k?0:1}),s[0]):t}L(r6,"intersectPolygon");var rge=r6,or={node:Zpe,circle:ege,ellipse:ZO,polygon:rge,rect:jh};function n6(t,e){const{labelStyles:r}=gr(e);e.labelStyle=r;const n=Nr(e);let a=n;n||(a="anchor");const s=t.insert("g").attr("class",a).attr("id",e.domId||e.id),i=1,{cssStyles:l}=e,c=hr.svg(s),d=pr(e,{fill:"black",stroke:"none",fillStyle:"solid"});e.look!=="handDrawn"&&(d.roughness=0);const p=c.circle(0,0,i*2,d),g=s.insert(()=>p,":first-child");return g.attr("class","anchor").attr("style",vs(l)),mr(e,g),e.intersect=function(m){return wt.info("Circle intersect",e,i,m),or.circle(e,i,m)},s}L(n6,"anchor");function aS(t,e,r,n,a,s,i){const c=(t+r)/2,d=(e+n)/2,p=Math.atan2(n-e,r-t),g=(r-t)/2,m=(n-e)/2,y=g/a,x=m/s,w=Math.sqrt(y**2+x**2);if(w>1)throw new Error("The given radii are too small to create an arc between the points.");const T=Math.sqrt(1-w**2),k=c+T*s*Math.sin(p)*(i?-1:1),_=d-T*a*Math.cos(p)*(i?-1:1),P=Math.atan2((e-_)/s,(t-k)/a);let D=Math.atan2((n-_)/s,(r-k)/a)-P;i&&D<0&&(D+=2*Math.PI),!i&&D>0&&(D-=2*Math.PI);const B=[];for(let M=0;M<20;M++){const $=M/19,Z=P+$*D,z=k+a*Math.cos(Z),ee=_+s*Math.sin(Z);B.push({x:z,y:ee})}return B}L(aS,"generateArcPoints");async function a6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.width+e.padding+20,l=s.height+e.padding,c=l/2,d=c/(2.5+l/50),{cssStyles:p}=e,g=[{x:i/2,y:-l/2},{x:-i/2,y:-l/2},...aS(-i/2,-l/2,-i/2,l/2,d,c,!1),{x:i/2,y:l/2},...aS(i/2,l/2,i/2,-l/2,d,c,!0)],m=hr.svg(a),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=hn(g),w=m.path(x,y),T=a.insert(()=>w,":first-child");return T.attr("class","basic label-container"),p&&e.look!=="handDrawn"&&T.selectAll("path").attr("style",p),n&&e.look!=="handDrawn"&&T.selectAll("path").attr("style",n),T.attr("transform",`translate(${d/2}, 0)`),mr(e,T),e.intersect=function(k){return or.polygon(e,g,k)},a}L(a6,"bowTieRect");function Fc(t,e,r,n){return t.insert("polygon",":first-child").attr("points",n.map(function(a){return a.x+","+a.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-e/2+","+r/2+")")}L(Fc,"insertPolygonShape");async function s6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.height+e.padding,l=12,c=s.width+e.padding+l,d=0,p=c,g=-i,m=0,y=[{x:d+l,y:g},{x:p,y:g},{x:p,y:m},{x:d,y:m},{x:d,y:g+l},{x:d+l,y:g}];let x;const{cssStyles:w}=e;if(e.look==="handDrawn"){const T=hr.svg(a),k=pr(e,{}),_=hn(y),P=T.path(_,k);x=a.insert(()=>P,":first-child").attr("transform",`translate(${-c/2}, ${i/2})`),w&&x.attr("style",w)}else x=Fc(a,c,i,y);return n&&x.attr("style",n),mr(e,x),e.intersect=function(T){return or.polygon(e,y,T)},a}L(s6,"card");function i6(t,e){const{nodeStyles:r}=gr(e);e.label="";const n=t.insert("g").attr("class",Nr(e)).attr("id",e.domId??e.id),{cssStyles:a}=e,s=Math.max(28,e.width??0),i=[{x:0,y:s/2},{x:s/2,y:0},{x:0,y:-s/2},{x:-s/2,y:0}],l=hr.svg(n),c=pr(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const d=hn(i),p=l.path(d,c),g=n.insert(()=>p,":first-child");return a&&e.look!=="handDrawn"&&g.selectAll("path").attr("style",a),r&&e.look!=="handDrawn"&&g.selectAll("path").attr("style",r),e.width=28,e.height=28,e.intersect=function(m){return or.polygon(e,i,m)},n}L(i6,"choice");async function Kk(t,e,r){const{labelStyles:n,nodeStyles:a}=gr(e);e.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:l}=await Dr(t,e,Nr(e)),c=r?.padding??l,d=i.width/2+c;let p;const{cssStyles:g}=e;if(e.look==="handDrawn"){const m=hr.svg(s),y=pr(e,{}),x=m.circle(0,0,d*2,y);p=s.insert(()=>x,":first-child"),p.attr("class","basic label-container").attr("style",vs(g))}else p=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",a).attr("r",d).attr("cx",0).attr("cy",0);return mr(e,p),e.calcIntersect=function(m,y){const x=m.width/2;return or.circle(m,x,y)},e.intersect=function(m){return wt.info("Circle intersect",e,d,m),or.circle(e,d,m)},s}L(Kk,"circle");function o6(t){const e=Math.cos(Math.PI/4),r=Math.sin(Math.PI/4),n=t*2,a={x:n/2*e,y:n/2*r},s={x:-(n/2)*e,y:n/2*r},i={x:-(n/2)*e,y:-(n/2)*r},l={x:n/2*e,y:-(n/2)*r};return`M ${s.x},${s.y} L ${l.x},${l.y}
                   M ${a.x},${a.y} L ${i.x},${i.y}`}L(o6,"createLine");function l6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r,e.label="";const a=t.insert("g").attr("class",Nr(e)).attr("id",e.domId??e.id),s=Math.max(30,e?.width??0),{cssStyles:i}=e,l=hr.svg(a),c=pr(e,{});e.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const d=l.circle(0,0,s*2,c),p=o6(s),g=l.path(p,c),m=a.insert(()=>d,":first-child");return m.insert(()=>g),i&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",i),n&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",n),mr(e,m),e.intersect=function(y){return wt.info("crossedCircle intersect",e,{radius:s,point:y}),or.circle(e,s,y)},a}L(l6,"crossedCircle");function El(t,e,r,n=100,a=0,s=180){const i=[],l=a*Math.PI/180,p=(s*Math.PI/180-l)/(n-1);for(let g=0;g<n;g++){const m=l+g*p,y=t+r*Math.cos(m),x=e+r*Math.sin(m);i.push({x:-y,y:-x})}return i}L(El,"generateCirclePoints");async function c6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=s.width+(e.padding??0),c=s.height+(e.padding??0),d=Math.max(5,c*.1),{cssStyles:p}=e,g=[...El(l/2,-c/2,d,30,-90,0),{x:-l/2-d,y:d},...El(l/2+d*2,-d,d,20,-180,-270),...El(l/2+d*2,d,d,20,-90,-180),{x:-l/2-d,y:-c/2},...El(l/2,c/2,d,20,0,90)],m=[{x:l/2,y:-c/2-d},{x:-l/2,y:-c/2-d},...El(l/2,-c/2,d,20,-90,0),{x:-l/2-d,y:-d},...El(l/2+l*.1,-d,d,20,-180,-270),...El(l/2+l*.1,d,d,20,-90,-180),{x:-l/2-d,y:c/2},...El(l/2,c/2,d,20,0,90),{x:-l/2,y:c/2+d},{x:l/2,y:c/2+d}],y=hr.svg(a),x=pr(e,{fill:"none"});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const T=hn(g).replace("Z",""),k=y.path(T,x),_=hn(m),P=y.path(_,{...x}),F=a.insert("g",":first-child");return F.insert(()=>P,":first-child").attr("stroke-opacity",0),F.insert(()=>k,":first-child"),F.attr("class","text"),p&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",p),n&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",n),F.attr("transform",`translate(${d}, 0)`),i.attr("transform",`translate(${-l/2+d-(s.x-(s.left??0))},${-c/2+(e.padding??0)/2-(s.y-(s.top??0))})`),mr(e,F),e.intersect=function(D){return or.polygon(e,m,D)},a}L(c6,"curlyBraceLeft");function _l(t,e,r,n=100,a=0,s=180){const i=[],l=a*Math.PI/180,p=(s*Math.PI/180-l)/(n-1);for(let g=0;g<n;g++){const m=l+g*p,y=t+r*Math.cos(m),x=e+r*Math.sin(m);i.push({x:y,y:x})}return i}L(_l,"generateCirclePoints");async function u6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=s.width+(e.padding??0),c=s.height+(e.padding??0),d=Math.max(5,c*.1),{cssStyles:p}=e,g=[..._l(l/2,-c/2,d,20,-90,0),{x:l/2+d,y:-d},..._l(l/2+d*2,-d,d,20,-180,-270),..._l(l/2+d*2,d,d,20,-90,-180),{x:l/2+d,y:c/2},..._l(l/2,c/2,d,20,0,90)],m=[{x:-l/2,y:-c/2-d},{x:l/2,y:-c/2-d},..._l(l/2,-c/2,d,20,-90,0),{x:l/2+d,y:-d},..._l(l/2+d*2,-d,d,20,-180,-270),..._l(l/2+d*2,d,d,20,-90,-180),{x:l/2+d,y:c/2},..._l(l/2,c/2,d,20,0,90),{x:l/2,y:c/2+d},{x:-l/2,y:c/2+d}],y=hr.svg(a),x=pr(e,{fill:"none"});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const T=hn(g).replace("Z",""),k=y.path(T,x),_=hn(m),P=y.path(_,{...x}),F=a.insert("g",":first-child");return F.insert(()=>P,":first-child").attr("stroke-opacity",0),F.insert(()=>k,":first-child"),F.attr("class","text"),p&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",p),n&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",n),F.attr("transform",`translate(${-d}, 0)`),i.attr("transform",`translate(${-l/2+(e.padding??0)/2-(s.x-(s.left??0))},${-c/2+(e.padding??0)/2-(s.y-(s.top??0))})`),mr(e,F),e.intersect=function(D){return or.polygon(e,m,D)},a}L(u6,"curlyBraceRight");function is(t,e,r,n=100,a=0,s=180){const i=[],l=a*Math.PI/180,p=(s*Math.PI/180-l)/(n-1);for(let g=0;g<n;g++){const m=l+g*p,y=t+r*Math.cos(m),x=e+r*Math.sin(m);i.push({x:-y,y:-x})}return i}L(is,"generateCirclePoints");async function d6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=s.width+(e.padding??0),c=s.height+(e.padding??0),d=Math.max(5,c*.1),{cssStyles:p}=e,g=[...is(l/2,-c/2,d,30,-90,0),{x:-l/2-d,y:d},...is(l/2+d*2,-d,d,20,-180,-270),...is(l/2+d*2,d,d,20,-90,-180),{x:-l/2-d,y:-c/2},...is(l/2,c/2,d,20,0,90)],m=[...is(-l/2+d+d/2,-c/2,d,20,-90,-180),{x:l/2-d/2,y:d},...is(-l/2-d/2,-d,d,20,0,90),...is(-l/2-d/2,d,d,20,-90,0),{x:l/2-d/2,y:-d},...is(-l/2+d+d/2,c/2,d,30,-180,-270)],y=[{x:l/2,y:-c/2-d},{x:-l/2,y:-c/2-d},...is(l/2,-c/2,d,20,-90,0),{x:-l/2-d,y:-d},...is(l/2+d*2,-d,d,20,-180,-270),...is(l/2+d*2,d,d,20,-90,-180),{x:-l/2-d,y:c/2},...is(l/2,c/2,d,20,0,90),{x:-l/2,y:c/2+d},{x:l/2-d-d/2,y:c/2+d},...is(-l/2+d+d/2,-c/2,d,20,-90,-180),{x:l/2-d/2,y:d},...is(-l/2-d/2,-d,d,20,0,90),...is(-l/2-d/2,d,d,20,-90,0),{x:l/2-d/2,y:-d},...is(-l/2+d+d/2,c/2,d,30,-180,-270)],x=hr.svg(a),w=pr(e,{fill:"none"});e.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");const k=hn(g).replace("Z",""),_=x.path(k,w),F=hn(m).replace("Z",""),D=x.path(F,w),B=hn(y),M=x.path(B,{...w}),$=a.insert("g",":first-child");return $.insert(()=>M,":first-child").attr("stroke-opacity",0),$.insert(()=>_,":first-child"),$.insert(()=>D,":first-child"),$.attr("class","text"),p&&e.look!=="handDrawn"&&$.selectAll("path").attr("style",p),n&&e.look!=="handDrawn"&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(${d-d/4}, 0)`),i.attr("transform",`translate(${-l/2+(e.padding??0)/2-(s.x-(s.left??0))},${-c/2+(e.padding??0)/2-(s.y-(s.top??0))})`),mr(e,$),e.intersect=function(Z){return or.polygon(e,y,Z)},a}L(d6,"curlyBraces");async function h6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=80,l=20,c=Math.max(i,(s.width+(e.padding??0)*2)*1.25,e?.width??0),d=Math.max(l,s.height+(e.padding??0)*2,e?.height??0),p=d/2,{cssStyles:g}=e,m=hr.svg(a),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=c,w=d,T=x-p,k=w/4,_=[{x:T,y:0},{x:k,y:0},{x:0,y:w/2},{x:k,y:w},{x:T,y:w},...Vg(-T,-w/2,p,50,270,90)],P=hn(_),F=m.path(P,y),D=a.insert(()=>F,":first-child");return D.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&D.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&D.selectChildren("path").attr("style",n),D.attr("transform",`translate(${-c/2}, ${-d/2})`),mr(e,D),e.intersect=function(B){return or.polygon(e,_,B)},a}L(h6,"curvedTrapezoid");var nge=L((t,e,r,n,a,s)=>[`M${t},${e+s}`,`a${a},${s} 0,0,0 ${r},0`,`a${a},${s} 0,0,0 ${-r},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${r},0`,`l0,${-n}`].join(" "),"createCylinderPathD"),age=L((t,e,r,n,a,s)=>[`M${t},${e+s}`,`M${t+r},${e+s}`,`a${a},${s} 0,0,0 ${-r},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${r},0`,`l0,${-n}`].join(" "),"createOuterCylinderPathD"),sge=L((t,e,r,n,a,s)=>[`M${t-r/2},${-n/2}`,`a${a},${s} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");async function p6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+e.padding,e.width??0),c=l/2,d=c/(2.5+l/50),p=Math.max(s.height+d+e.padding,e.height??0);let g;const{cssStyles:m}=e;if(e.look==="handDrawn"){const y=hr.svg(a),x=age(0,0,l,p,c,d),w=sge(0,d,l,p,c,d),T=y.path(x,pr(e,{})),k=y.path(w,pr(e,{fill:"none"}));g=a.insert(()=>k,":first-child"),g=a.insert(()=>T,":first-child"),g.attr("class","basic label-container"),m&&g.attr("style",m)}else{const y=nge(0,0,l,p,c,d);g=a.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",vs(m)).attr("style",n)}return g.attr("label-offset-y",d),g.attr("transform",`translate(${-l/2}, ${-(p/2+d)})`),mr(e,g),i.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+(e.padding??0)/1.5-(s.y-(s.top??0))})`),e.intersect=function(y){const x=or.rect(e,y),w=x.x-(e.x??0);if(c!=0&&(Math.abs(w)<(e.width??0)/2||Math.abs(w)==(e.width??0)/2&&Math.abs(x.y-(e.y??0))>(e.height??0)/2-d)){let T=d*d*(1-w*w/(c*c));T>0&&(T=Math.sqrt(T)),T=d-T,y.y-(e.y??0)>0&&(T=-T),x.y+=T}return x},a}L(p6,"cylinder");async function g6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=s.width+e.padding,c=s.height+e.padding,d=c*.2,p=-l/2,g=-c/2-d/2,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:p,y:g+d},{x:-p,y:g+d},{x:-p,y:-g},{x:p,y:-g},{x:p,y:g},{x:-p,y:g},{x:-p,y:g+d}],T=y.polygon(w.map(_=>[_.x,_.y]),x),k=a.insert(()=>T,":first-child");return k.attr("class","basic label-container"),m&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",m),n&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",n),i.attr("transform",`translate(${p+(e.padding??0)/2-(s.x-(s.left??0))}, ${g+d+(e.padding??0)/2-(s.y-(s.top??0))})`),mr(e,k),e.intersect=function(_){return or.rect(e,_)},a}L(g6,"dividedRectangle");async function f6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,halfPadding:i}=await Dr(t,e,Nr(e)),c=s.width/2+i+5,d=s.width/2+i;let p;const{cssStyles:g}=e;if(e.look==="handDrawn"){const m=hr.svg(a),y=pr(e,{roughness:.2,strokeWidth:2.5}),x=pr(e,{roughness:.2,strokeWidth:1.5}),w=m.circle(0,0,c*2,y),T=m.circle(0,0,d*2,x);p=a.insert("g",":first-child"),p.attr("class",vs(e.cssClasses)).attr("style",vs(g)),p.node()?.appendChild(w),p.node()?.appendChild(T)}else{p=a.insert("g",":first-child");const m=p.insert("circle",":first-child"),y=p.insert("circle");p.attr("class","basic label-container").attr("style",n),m.attr("class","outer-circle").attr("style",n).attr("r",c).attr("cx",0).attr("cy",0),y.attr("class","inner-circle").attr("style",n).attr("r",d).attr("cx",0).attr("cy",0)}return mr(e,p),e.intersect=function(m){return wt.info("DoubleCircle intersect",e,c,m),or.circle(e,c,m)},a}L(f6,"doublecircle");function m6(t,e,{config:{themeVariables:r}}){const{labelStyles:n,nodeStyles:a}=gr(e);e.label="",e.labelStyle=n;const s=t.insert("g").attr("class",Nr(e)).attr("id",e.domId??e.id),i=7,{cssStyles:l}=e,c=hr.svg(s),{nodeBorder:d}=r,p=pr(e,{fillStyle:"solid"});e.look!=="handDrawn"&&(p.roughness=0);const g=c.circle(0,0,i*2,p),m=s.insert(()=>g,":first-child");return m.selectAll("path").attr("style",`fill: ${d} !important;`),l&&l.length>0&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",l),a&&e.look!=="handDrawn"&&m.selectAll("path").attr("style",a),mr(e,m),e.intersect=function(y){return wt.info("filledCircle intersect",e,{radius:i,point:y}),or.circle(e,i,y)},s}L(m6,"filledCircle");async function y6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=s.width+(e.padding??0),c=l+s.height,d=l+s.height,p=[{x:0,y:-c},{x:d,y:-c},{x:d/2,y:0}],{cssStyles:g}=e,m=hr.svg(a),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=hn(p),w=m.path(x,y),T=a.insert(()=>w,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return g&&e.look!=="handDrawn"&&T.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&T.selectChildren("path").attr("style",n),e.width=l,e.height=c,mr(e,T),i.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${-c/2+(e.padding??0)/2+(s.y-(s.top??0))})`),e.intersect=function(k){return wt.info("Triangle intersect",e,p,k),or.polygon(e,p,k)},a}L(y6,"flippedTriangle");function b6(t,e,{dir:r,config:{state:n,themeVariables:a}}){const{nodeStyles:s}=gr(e);e.label="";const i=t.insert("g").attr("class",Nr(e)).attr("id",e.domId??e.id),{cssStyles:l}=e;let c=Math.max(70,e?.width??0),d=Math.max(10,e?.height??0);r==="LR"&&(c=Math.max(10,e?.width??0),d=Math.max(70,e?.height??0));const p=-1*c/2,g=-1*d/2,m=hr.svg(i),y=pr(e,{stroke:a.lineColor,fill:a.lineColor});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.rectangle(p,g,c,d,y),w=i.insert(()=>x,":first-child");l&&e.look!=="handDrawn"&&w.selectAll("path").attr("style",l),s&&e.look!=="handDrawn"&&w.selectAll("path").attr("style",s),mr(e,w);const T=n?.padding??0;return e.width&&e.height&&(e.width+=T/2||0,e.height+=T/2||0),e.intersect=function(k){return or.rect(e,k)},i}L(b6,"forkJoin");async function x6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const a=80,s=50,{shapeSvg:i,bbox:l}=await Dr(t,e,Nr(e)),c=Math.max(a,l.width+(e.padding??0)*2,e?.width??0),d=Math.max(s,l.height+(e.padding??0)*2,e?.height??0),p=d/2,{cssStyles:g}=e,m=hr.svg(i),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=[{x:-c/2,y:-d/2},{x:c/2-p,y:-d/2},...Vg(-c/2+p,0,p,50,90,270),{x:c/2-p,y:d/2},{x:-c/2,y:d/2}],w=hn(x),T=m.path(w,y),k=i.insert(()=>T,":first-child");return k.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",n),mr(e,k),e.intersect=function(_){return wt.info("Pill intersect",e,{radius:p,point:_}),or.polygon(e,x,_)},i}L(x6,"halfRoundedRectangle");async function v6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.height+(e.padding??0),l=s.width+(e.padding??0)*2.5,{cssStyles:c}=e,d=hr.svg(a),p=pr(e,{});e.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let g=l/2;const m=g/6;g=g+m;const y=i/2,x=y/2,w=g-x,T=[{x:-w,y:-y},{x:0,y:-y},{x:w,y:-y},{x:g,y:0},{x:w,y},{x:0,y},{x:-w,y},{x:-g,y:0}],k=hn(T),_=d.path(k,p),P=a.insert(()=>_,":first-child");return P.attr("class","basic label-container"),c&&e.look!=="handDrawn"&&P.selectChildren("path").attr("style",c),n&&e.look!=="handDrawn"&&P.selectChildren("path").attr("style",n),e.width=l,e.height=i,mr(e,P),e.intersect=function(F){return or.polygon(e,T,F)},a}L(v6,"hexagon");async function w6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.label="",e.labelStyle=r;const{shapeSvg:a}=await Dr(t,e,Nr(e)),s=Math.max(30,e?.width??0),i=Math.max(30,e?.height??0),{cssStyles:l}=e,c=hr.svg(a),d=pr(e,{});e.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const p=[{x:0,y:0},{x:s,y:0},{x:0,y:i},{x:s,y:i}],g=hn(p),m=c.path(g,d),y=a.insert(()=>m,":first-child");return y.attr("class","basic label-container"),l&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",l),n&&e.look!=="handDrawn"&&y.selectChildren("path").attr("style",n),y.attr("transform",`translate(${-s/2}, ${-i/2})`),mr(e,y),e.intersect=function(x){return wt.info("Pill intersect",e,{points:p}),or.polygon(e,p,x)},a}L(w6,"hourglass");async function S6(t,e,{config:{themeVariables:r,flowchart:n}}){const{labelStyles:a}=gr(e);e.labelStyle=a;const s=e.assetHeight??48,i=e.assetWidth??48,l=Math.max(s,i),c=n?.wrappingWidth;e.width=Math.max(l,c??0);const{shapeSvg:d,bbox:p,label:g}=await Dr(t,e,"icon-shape default"),m=e.pos==="t",y=l,x=l,{nodeBorder:w}=r,{stylesMap:T}=Lh(e),k=-x/2,_=-y/2,P=e.label?8:0,F=hr.svg(d),D=pr(e,{stroke:"none",fill:"none"});e.look!=="handDrawn"&&(D.roughness=0,D.fillStyle="solid");const B=F.rectangle(k,_,x,y,D),M=Math.max(x,p.width),$=y+p.height+P,Z=F.rectangle(-M/2,-$/2,M,$,{...D,fill:"transparent",stroke:"none"}),z=d.insert(()=>B,":first-child"),ee=d.insert(()=>Z);if(e.icon){const te=d.append("g");te.html(`<g>${await wf(e.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);const X=te.node().getBBox(),Q=X.width,W=X.height,H=X.x,re=X.y;te.attr("transform",`translate(${-Q/2-H},${m?p.height/2+P/2-W/2-re:-p.height/2-P/2-W/2-re})`),te.attr("style",`color: ${T.get("stroke")??w};`)}return g.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${m?-$/2:$/2-p.height})`),z.attr("transform",`translate(0,${m?p.height/2+P/2:-p.height/2-P/2})`),mr(e,ee),e.intersect=function(te){if(wt.info("iconSquare intersect",e,te),!e.label)return or.rect(e,te);const X=e.x??0,Q=e.y??0,W=e.height??0;let H=[];return m?H=[{x:X-p.width/2,y:Q-W/2},{x:X+p.width/2,y:Q-W/2},{x:X+p.width/2,y:Q-W/2+p.height+P},{x:X+x/2,y:Q-W/2+p.height+P},{x:X+x/2,y:Q+W/2},{x:X-x/2,y:Q+W/2},{x:X-x/2,y:Q-W/2+p.height+P},{x:X-p.width/2,y:Q-W/2+p.height+P}]:H=[{x:X-x/2,y:Q-W/2},{x:X+x/2,y:Q-W/2},{x:X+x/2,y:Q-W/2+y},{x:X+p.width/2,y:Q-W/2+y},{x:X+p.width/2/2,y:Q+W/2},{x:X-p.width/2,y:Q+W/2},{x:X-p.width/2,y:Q-W/2+y},{x:X-x/2,y:Q-W/2+y}],or.polygon(e,H,te)},d}L(S6,"icon");async function k6(t,e,{config:{themeVariables:r,flowchart:n}}){const{labelStyles:a}=gr(e);e.labelStyle=a;const s=e.assetHeight??48,i=e.assetWidth??48,l=Math.max(s,i),c=n?.wrappingWidth;e.width=Math.max(l,c??0);const{shapeSvg:d,bbox:p,label:g}=await Dr(t,e,"icon-shape default"),m=20,y=e.label?8:0,x=e.pos==="t",{nodeBorder:w,mainBkg:T}=r,{stylesMap:k}=Lh(e),_=hr.svg(d),P=pr(e,{});e.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");const F=k.get("fill");P.stroke=F??T;const D=d.append("g");e.icon&&D.html(`<g>${await wf(e.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);const B=D.node().getBBox(),M=B.width,$=B.height,Z=B.x,z=B.y,ee=Math.max(M,$)*Math.SQRT2+m*2,te=_.circle(0,0,ee,P),X=Math.max(ee,p.width),Q=ee+p.height+y,W=_.rectangle(-X/2,-Q/2,X,Q,{...P,fill:"transparent",stroke:"none"}),H=d.insert(()=>te,":first-child"),re=d.insert(()=>W);return D.attr("transform",`translate(${-M/2-Z},${x?p.height/2+y/2-$/2-z:-p.height/2-y/2-$/2-z})`),D.attr("style",`color: ${k.get("stroke")??w};`),g.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${x?-Q/2:Q/2-p.height})`),H.attr("transform",`translate(0,${x?p.height/2+y/2:-p.height/2-y/2})`),mr(e,re),e.intersect=function(ne){return wt.info("iconSquare intersect",e,ne),or.rect(e,ne)},d}L(k6,"iconCircle");async function T6(t,e,{config:{themeVariables:r,flowchart:n}}){const{labelStyles:a}=gr(e);e.labelStyle=a;const s=e.assetHeight??48,i=e.assetWidth??48,l=Math.max(s,i),c=n?.wrappingWidth;e.width=Math.max(l,c??0);const{shapeSvg:d,bbox:p,halfPadding:g,label:m}=await Dr(t,e,"icon-shape default"),y=e.pos==="t",x=l+g*2,w=l+g*2,{nodeBorder:T,mainBkg:k}=r,{stylesMap:_}=Lh(e),P=-w/2,F=-x/2,D=e.label?8:0,B=hr.svg(d),M=pr(e,{});e.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");const $=_.get("fill");M.stroke=$??k;const Z=B.path(Bc(P,F,w,x,5),M),z=Math.max(w,p.width),ee=x+p.height+D,te=B.rectangle(-z/2,-ee/2,z,ee,{...M,fill:"transparent",stroke:"none"}),X=d.insert(()=>Z,":first-child").attr("class","icon-shape2"),Q=d.insert(()=>te);if(e.icon){const W=d.append("g");W.html(`<g>${await wf(e.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);const H=W.node().getBBox(),re=H.width,ne=H.height,ve=H.x,O=H.y;W.attr("transform",`translate(${-re/2-ve},${y?p.height/2+D/2-ne/2-O:-p.height/2-D/2-ne/2-O})`),W.attr("style",`color: ${_.get("stroke")??T};`)}return m.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${y?-ee/2:ee/2-p.height})`),X.attr("transform",`translate(0,${y?p.height/2+D/2:-p.height/2-D/2})`),mr(e,Q),e.intersect=function(W){if(wt.info("iconSquare intersect",e,W),!e.label)return or.rect(e,W);const H=e.x??0,re=e.y??0,ne=e.height??0;let ve=[];return y?ve=[{x:H-p.width/2,y:re-ne/2},{x:H+p.width/2,y:re-ne/2},{x:H+p.width/2,y:re-ne/2+p.height+D},{x:H+w/2,y:re-ne/2+p.height+D},{x:H+w/2,y:re+ne/2},{x:H-w/2,y:re+ne/2},{x:H-w/2,y:re-ne/2+p.height+D},{x:H-p.width/2,y:re-ne/2+p.height+D}]:ve=[{x:H-w/2,y:re-ne/2},{x:H+w/2,y:re-ne/2},{x:H+w/2,y:re-ne/2+x},{x:H+p.width/2,y:re-ne/2+x},{x:H+p.width/2/2,y:re+ne/2},{x:H-p.width/2,y:re+ne/2},{x:H-p.width/2,y:re-ne/2+x},{x:H-w/2,y:re-ne/2+x}],or.polygon(e,ve,W)},d}L(T6,"iconRounded");async function C6(t,e,{config:{themeVariables:r,flowchart:n}}){const{labelStyles:a}=gr(e);e.labelStyle=a;const s=e.assetHeight??48,i=e.assetWidth??48,l=Math.max(s,i),c=n?.wrappingWidth;e.width=Math.max(l,c??0);const{shapeSvg:d,bbox:p,halfPadding:g,label:m}=await Dr(t,e,"icon-shape default"),y=e.pos==="t",x=l+g*2,w=l+g*2,{nodeBorder:T,mainBkg:k}=r,{stylesMap:_}=Lh(e),P=-w/2,F=-x/2,D=e.label?8:0,B=hr.svg(d),M=pr(e,{});e.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");const $=_.get("fill");M.stroke=$??k;const Z=B.path(Bc(P,F,w,x,.1),M),z=Math.max(w,p.width),ee=x+p.height+D,te=B.rectangle(-z/2,-ee/2,z,ee,{...M,fill:"transparent",stroke:"none"}),X=d.insert(()=>Z,":first-child"),Q=d.insert(()=>te);if(e.icon){const W=d.append("g");W.html(`<g>${await wf(e.icon,{height:l,width:l,fallbackPrefix:""})}</g>`);const H=W.node().getBBox(),re=H.width,ne=H.height,ve=H.x,O=H.y;W.attr("transform",`translate(${-re/2-ve},${y?p.height/2+D/2-ne/2-O:-p.height/2-D/2-ne/2-O})`),W.attr("style",`color: ${_.get("stroke")??T};`)}return m.attr("transform",`translate(${-p.width/2-(p.x-(p.left??0))},${y?-ee/2:ee/2-p.height})`),X.attr("transform",`translate(0,${y?p.height/2+D/2:-p.height/2-D/2})`),mr(e,Q),e.intersect=function(W){if(wt.info("iconSquare intersect",e,W),!e.label)return or.rect(e,W);const H=e.x??0,re=e.y??0,ne=e.height??0;let ve=[];return y?ve=[{x:H-p.width/2,y:re-ne/2},{x:H+p.width/2,y:re-ne/2},{x:H+p.width/2,y:re-ne/2+p.height+D},{x:H+w/2,y:re-ne/2+p.height+D},{x:H+w/2,y:re+ne/2},{x:H-w/2,y:re+ne/2},{x:H-w/2,y:re-ne/2+p.height+D},{x:H-p.width/2,y:re-ne/2+p.height+D}]:ve=[{x:H-w/2,y:re-ne/2},{x:H+w/2,y:re-ne/2},{x:H+w/2,y:re-ne/2+x},{x:H+p.width/2,y:re-ne/2+x},{x:H+p.width/2/2,y:re+ne/2},{x:H-p.width/2,y:re+ne/2},{x:H-p.width/2,y:re-ne/2+x},{x:H-w/2,y:re-ne/2+x}],or.polygon(e,ve,W)},d}L(C6,"iconSquare");async function E6(t,e,{config:{flowchart:r}}){const n=new Image;n.src=e?.img??"",await n.decode();const a=Number(n.naturalWidth.toString().replace("px","")),s=Number(n.naturalHeight.toString().replace("px",""));e.imageAspectRatio=a/s;const{labelStyles:i}=gr(e);e.labelStyle=i;const l=r?.wrappingWidth;e.defaultWidth=r?.wrappingWidth;const c=Math.max(e.label?l??0:0,e?.assetWidth??a),d=e.constraint==="on"&&e?.assetHeight?e.assetHeight*e.imageAspectRatio:c,p=e.constraint==="on"?d/e.imageAspectRatio:e?.assetHeight??s;e.width=Math.max(d,l??0);const{shapeSvg:g,bbox:m,label:y}=await Dr(t,e,"image-shape default"),x=e.pos==="t",w=-d/2,T=-p/2,k=e.label?8:0,_=hr.svg(g),P=pr(e,{});e.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");const F=_.rectangle(w,T,d,p,P),D=Math.max(d,m.width),B=p+m.height+k,M=_.rectangle(-D/2,-B/2,D,B,{...P,fill:"none",stroke:"none"}),$=g.insert(()=>F,":first-child"),Z=g.insert(()=>M);if(e.img){const z=g.append("image");z.attr("href",e.img),z.attr("width",d),z.attr("height",p),z.attr("preserveAspectRatio","none"),z.attr("transform",`translate(${-d/2},${x?B/2-p:-B/2})`)}return y.attr("transform",`translate(${-m.width/2-(m.x-(m.left??0))},${x?-p/2-m.height/2-k/2:p/2-m.height/2+k/2})`),$.attr("transform",`translate(0,${x?m.height/2+k/2:-m.height/2-k/2})`),mr(e,Z),e.intersect=function(z){if(wt.info("iconSquare intersect",e,z),!e.label)return or.rect(e,z);const ee=e.x??0,te=e.y??0,X=e.height??0;let Q=[];return x?Q=[{x:ee-m.width/2,y:te-X/2},{x:ee+m.width/2,y:te-X/2},{x:ee+m.width/2,y:te-X/2+m.height+k},{x:ee+d/2,y:te-X/2+m.height+k},{x:ee+d/2,y:te+X/2},{x:ee-d/2,y:te+X/2},{x:ee-d/2,y:te-X/2+m.height+k},{x:ee-m.width/2,y:te-X/2+m.height+k}]:Q=[{x:ee-d/2,y:te-X/2},{x:ee+d/2,y:te-X/2},{x:ee+d/2,y:te-X/2+p},{x:ee+m.width/2,y:te-X/2+p},{x:ee+m.width/2/2,y:te+X/2},{x:ee-m.width/2,y:te+X/2},{x:ee-m.width/2,y:te-X/2+p},{x:ee-d/2,y:te-X/2+p}],or.polygon(e,Q,z)},g}L(E6,"imageSquare");async function _6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=Math.max(s.width+(e.padding??0)*2,e?.width??0),l=Math.max(s.height+(e.padding??0)*2,e?.height??0),c=[{x:0,y:0},{x:i,y:0},{x:i+3*l/6,y:-l},{x:-3*l/6,y:-l}];let d;const{cssStyles:p}=e;if(e.look==="handDrawn"){const g=hr.svg(a),m=pr(e,{}),y=hn(c),x=g.path(y,m);d=a.insert(()=>x,":first-child").attr("transform",`translate(${-i/2}, ${l/2})`),p&&d.attr("style",p)}else d=Fc(a,i,l,c);return n&&d.attr("style",n),e.width=i,e.height=l,mr(e,d),e.intersect=function(g){return or.polygon(e,c,g)},a}L(_6,"inv_trapezoid");async function mb(t,e,r){const{labelStyles:n,nodeStyles:a}=gr(e);e.labelStyle=n;const{shapeSvg:s,bbox:i}=await Dr(t,e,Nr(e)),l=Math.max(i.width+r.labelPaddingX*2,e?.width||0),c=Math.max(i.height+r.labelPaddingY*2,e?.height||0),d=-l/2,p=-c/2;let g,{rx:m,ry:y}=e;const{cssStyles:x}=e;if(r?.rx&&r.ry&&(m=r.rx,y=r.ry),e.look==="handDrawn"){const w=hr.svg(s),T=pr(e,{}),k=m||y?w.path(Bc(d,p,l,c,m||0),T):w.rectangle(d,p,l,c,T);g=s.insert(()=>k,":first-child"),g.attr("class","basic label-container").attr("style",vs(x))}else g=s.insert("rect",":first-child"),g.attr("class","basic label-container").attr("style",a).attr("rx",vs(m)).attr("ry",vs(y)).attr("x",d).attr("y",p).attr("width",l).attr("height",c);return mr(e,g),e.calcIntersect=function(w,T){return or.rect(w,T)},e.intersect=function(w){return or.rect(e,w)},s}L(mb,"drawRect");async function A6(t,e){const{shapeSvg:r,bbox:n,label:a}=await Dr(t,e,"label"),s=r.insert("rect",":first-child");return s.attr("width",.1).attr("height",.1),r.attr("class","label edgeLabel"),a.attr("transform",`translate(${-(n.width/2)-(n.x-(n.left??0))}, ${-(n.height/2)-(n.y-(n.top??0))})`),mr(e,s),e.intersect=function(c){return or.rect(e,c)},r}L(A6,"labelRect");async function N6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=Math.max(s.width+(e.padding??0),e?.width??0),l=Math.max(s.height+(e.padding??0),e?.height??0),c=[{x:0,y:0},{x:i+3*l/6,y:0},{x:i,y:-l},{x:-(3*l)/6,y:-l}];let d;const{cssStyles:p}=e;if(e.look==="handDrawn"){const g=hr.svg(a),m=pr(e,{}),y=hn(c),x=g.path(y,m);d=a.insert(()=>x,":first-child").attr("transform",`translate(${-i/2}, ${l/2})`),p&&d.attr("style",p)}else d=Fc(a,i,l,c);return n&&d.attr("style",n),e.width=i,e.height=l,mr(e,d),e.intersect=function(g){return or.polygon(e,c,g)},a}L(N6,"lean_left");async function P6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=Math.max(s.width+(e.padding??0),e?.width??0),l=Math.max(s.height+(e.padding??0),e?.height??0),c=[{x:-3*l/6,y:0},{x:i,y:0},{x:i+3*l/6,y:-l},{x:0,y:-l}];let d;const{cssStyles:p}=e;if(e.look==="handDrawn"){const g=hr.svg(a),m=pr(e,{}),y=hn(c),x=g.path(y,m);d=a.insert(()=>x,":first-child").attr("transform",`translate(${-i/2}, ${l/2})`),p&&d.attr("style",p)}else d=Fc(a,i,l,c);return n&&d.attr("style",n),e.width=i,e.height=l,mr(e,d),e.intersect=function(g){return or.polygon(e,c,g)},a}L(P6,"lean_right");function I6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.label="",e.labelStyle=r;const a=t.insert("g").attr("class",Nr(e)).attr("id",e.domId??e.id),{cssStyles:s}=e,i=Math.max(35,e?.width??0),l=Math.max(35,e?.height??0),c=7,d=[{x:i,y:0},{x:0,y:l+c/2},{x:i-2*c,y:l+c/2},{x:0,y:2*l},{x:i,y:l-c/2},{x:2*c,y:l-c/2}],p=hr.svg(a),g=pr(e,{});e.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const m=hn(d),y=p.path(m,g),x=a.insert(()=>y,":first-child");return s&&e.look!=="handDrawn"&&x.selectAll("path").attr("style",s),n&&e.look!=="handDrawn"&&x.selectAll("path").attr("style",n),x.attr("transform",`translate(-${i/2},${-l})`),mr(e,x),e.intersect=function(w){return wt.info("lightningBolt intersect",e,w),or.polygon(e,d,w)},a}L(I6,"lightningBolt");var ige=L((t,e,r,n,a,s,i)=>[`M${t},${e+s}`,`a${a},${s} 0,0,0 ${r},0`,`a${a},${s} 0,0,0 ${-r},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${r},0`,`l0,${-n}`,`M${t},${e+s+i}`,`a${a},${s} 0,0,0 ${r},0`].join(" "),"createCylinderPathD"),oge=L((t,e,r,n,a,s,i)=>[`M${t},${e+s}`,`M${t+r},${e+s}`,`a${a},${s} 0,0,0 ${-r},0`,`l0,${n}`,`a${a},${s} 0,0,0 ${r},0`,`l0,${-n}`,`M${t},${e+s+i}`,`a${a},${s} 0,0,0 ${r},0`].join(" "),"createOuterCylinderPathD"),lge=L((t,e,r,n,a,s)=>[`M${t-r/2},${-n/2}`,`a${a},${s} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");async function R6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0),e.width??0),c=l/2,d=c/(2.5+l/50),p=Math.max(s.height+d+(e.padding??0),e.height??0),g=p*.1;let m;const{cssStyles:y}=e;if(e.look==="handDrawn"){const x=hr.svg(a),w=oge(0,0,l,p,c,d,g),T=lge(0,d,l,p,c,d),k=pr(e,{}),_=x.path(w,k),P=x.path(T,k);a.insert(()=>P,":first-child").attr("class","line"),m=a.insert(()=>_,":first-child"),m.attr("class","basic label-container"),y&&m.attr("style",y)}else{const x=ige(0,0,l,p,c,d,g);m=a.insert("path",":first-child").attr("d",x).attr("class","basic label-container").attr("style",vs(y)).attr("style",n)}return m.attr("label-offset-y",d),m.attr("transform",`translate(${-l/2}, ${-(p/2+d)})`),mr(e,m),i.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)+d-(s.y-(s.top??0))})`),e.intersect=function(x){const w=or.rect(e,x),T=w.x-(e.x??0);if(c!=0&&(Math.abs(T)<(e.width??0)/2||Math.abs(T)==(e.width??0)/2&&Math.abs(w.y-(e.y??0))>(e.height??0)/2-d)){let k=d*d*(1-T*T/(c*c));k>0&&(k=Math.sqrt(k)),k=d-k,x.y-(e.y??0)>0&&(k=-k),w.y+=k}return w},a}L(R6,"linedCylinder");async function D6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=c/4,p=c+d,{cssStyles:g}=e,m=hr.svg(a),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=[{x:-l/2-l/2*.1,y:-p/2},{x:-l/2-l/2*.1,y:p/2},...Rc(-l/2-l/2*.1,p/2,l/2+l/2*.1,p/2,d,.8),{x:l/2+l/2*.1,y:-p/2},{x:-l/2-l/2*.1,y:-p/2},{x:-l/2,y:-p/2},{x:-l/2,y:p/2*1.1},{x:-l/2,y:-p/2}],w=m.polygon(x.map(k=>[k.x,k.y]),y),T=a.insert(()=>w,":first-child");return T.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&T.selectAll("path").attr("style",g),n&&e.look!=="handDrawn"&&T.selectAll("path").attr("style",n),T.attr("transform",`translate(0,${-d/2})`),i.attr("transform",`translate(${-l/2+(e.padding??0)+l/2*.1/2-(s.x-(s.left??0))},${-c/2+(e.padding??0)-d/2-(s.y-(s.top??0))})`),mr(e,T),e.intersect=function(k){return or.polygon(e,x,k)},a}L(D6,"linedWaveEdgedRect");async function L6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=5,p=-l/2,g=-c/2,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{}),w=[{x:p-d,y:g+d},{x:p-d,y:g+c+d},{x:p+l-d,y:g+c+d},{x:p+l-d,y:g+c},{x:p+l,y:g+c},{x:p+l,y:g+c-d},{x:p+l+d,y:g+c-d},{x:p+l+d,y:g-d},{x:p+d,y:g-d},{x:p+d,y:g},{x:p,y:g},{x:p,y:g+d}],T=[{x:p,y:g+d},{x:p+l-d,y:g+d},{x:p+l-d,y:g+c},{x:p+l,y:g+c},{x:p+l,y:g},{x:p,y:g}];e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const k=hn(w),_=y.path(k,x),P=hn(T),F=y.path(P,{...x,fill:"none"}),D=a.insert(()=>F,":first-child");return D.insert(()=>_,":first-child"),D.attr("class","basic label-container"),m&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",m),n&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",n),i.attr("transform",`translate(${-(s.width/2)-d-(s.x-(s.left??0))}, ${-(s.height/2)+d-(s.y-(s.top??0))})`),mr(e,D),e.intersect=function(B){return or.polygon(e,w,B)},a}L(L6,"multiRect");async function M6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=c/4,p=c+d,g=-l/2,m=-p/2,y=5,{cssStyles:x}=e,w=Rc(g-y,m+p+y,g+l-y,m+p+y,d,.8),T=w?.[w.length-1],k=[{x:g-y,y:m+y},{x:g-y,y:m+p+y},...w,{x:g+l-y,y:T.y-y},{x:g+l,y:T.y-y},{x:g+l,y:T.y-2*y},{x:g+l+y,y:T.y-2*y},{x:g+l+y,y:m-y},{x:g+y,y:m-y},{x:g+y,y:m},{x:g,y:m},{x:g,y:m+y}],_=[{x:g,y:m+y},{x:g+l-y,y:m+y},{x:g+l-y,y:T.y-y},{x:g+l,y:T.y-y},{x:g+l,y:m},{x:g,y:m}],P=hr.svg(a),F=pr(e,{});e.look!=="handDrawn"&&(F.roughness=0,F.fillStyle="solid");const D=hn(k),B=P.path(D,F),M=hn(_),$=P.path(M,F),Z=a.insert(()=>B,":first-child");return Z.insert(()=>$),Z.attr("class","basic label-container"),x&&e.look!=="handDrawn"&&Z.selectAll("path").attr("style",x),n&&e.look!=="handDrawn"&&Z.selectAll("path").attr("style",n),Z.attr("transform",`translate(0,${-d/2})`),i.attr("transform",`translate(${-(s.width/2)-y-(s.x-(s.left??0))}, ${-(s.height/2)+y-d/2-(s.y-(s.top??0))})`),mr(e,Z),e.intersect=function(z){return or.polygon(e,k,z)},a}L(M6,"multiWaveEdgedRectangle");async function O6(t,e,{config:{themeVariables:r}}){const{labelStyles:n,nodeStyles:a}=gr(e);e.labelStyle=n,e.useHtmlLabels||bs().flowchart?.htmlLabels!==!1||(e.centerLabel=!0);const{shapeSvg:i,bbox:l,label:c}=await Dr(t,e,Nr(e)),d=Math.max(l.width+(e.padding??0)*2,e?.width??0),p=Math.max(l.height+(e.padding??0)*2,e?.height??0),g=-d/2,m=-p/2,{cssStyles:y}=e,x=hr.svg(i),w=pr(e,{fill:r.noteBkgColor,stroke:r.noteBorderColor});e.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");const T=x.rectangle(g,m,d,p,w),k=i.insert(()=>T,":first-child");return k.attr("class","basic label-container"),y&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",y),a&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",a),c.attr("transform",`translate(${-l.width/2-(l.x-(l.left??0))}, ${-(l.height/2)-(l.y-(l.top??0))})`),mr(e,k),e.intersect=function(_){return or.rect(e,_)},i}L(O6,"note");var cge=L((t,e,r)=>[`M${t+r/2},${e}`,`L${t+r},${e-r/2}`,`L${t+r/2},${e-r}`,`L${t},${e-r/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function j6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.width+e.padding,l=s.height+e.padding,c=i+l,d=.5,p=[{x:c/2,y:0},{x:c,y:-c/2},{x:c/2,y:-c},{x:0,y:-c/2}];let g;const{cssStyles:m}=e;if(e.look==="handDrawn"){const y=hr.svg(a),x=pr(e,{}),w=cge(0,0,c),T=y.path(w,x);g=a.insert(()=>T,":first-child").attr("transform",`translate(${-c/2+d}, ${c/2})`),m&&g.attr("style",m)}else g=Fc(a,c,c,p),g.attr("transform",`translate(${-c/2+d}, ${c/2})`);return n&&g.attr("style",n),mr(e,g),e.calcIntersect=function(y,x){const w=y.width,T=[{x:w/2,y:0},{x:w,y:-w/2},{x:w/2,y:-w},{x:0,y:-w/2}],k=or.polygon(y,T,x);return{x:k.x-.5,y:k.y-.5}},e.intersect=function(y){return this.calcIntersect(e,y)},a}L(j6,"question");async function B6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0),e?.width??0),c=Math.max(s.height+(e.padding??0),e?.height??0),d=-l/2,p=-c/2,g=p/2,m=[{x:d+g,y:p},{x:d,y:0},{x:d+g,y:-p},{x:-d,y:-p},{x:-d,y:p}],{cssStyles:y}=e,x=hr.svg(a),w=pr(e,{});e.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");const T=hn(m),k=x.path(T,w),_=a.insert(()=>k,":first-child");return _.attr("class","basic label-container"),y&&e.look!=="handDrawn"&&_.selectAll("path").attr("style",y),n&&e.look!=="handDrawn"&&_.selectAll("path").attr("style",n),_.attr("transform",`translate(${-g/2},0)`),i.attr("transform",`translate(${-g/2-s.width/2-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),mr(e,_),e.intersect=function(P){return or.polygon(e,m,P)},a}L(B6,"rect_left_inv_arrow");async function F6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;let a;e.cssClasses?a="node "+e.cssClasses:a="node default";const s=t.insert("g").attr("class",a).attr("id",e.domId||e.id),i=s.insert("g"),l=s.insert("g").attr("class","label").attr("style",n),c=e.description,d=e.label,p=l.node().appendChild(await ku(d,e.labelStyle,!0,!0));let g={width:0,height:0};if(Wa(In()?.flowchart?.htmlLabels)){const $=p.children[0],Z=wn(p);g=$.getBoundingClientRect(),Z.attr("width",g.width),Z.attr("height",g.height)}wt.info("Text 2",c);const m=c||[],y=p.getBBox(),x=l.node().appendChild(await ku(m.join?m.join("<br/>"):m,e.labelStyle,!0,!0)),w=x.children[0],T=wn(x);g=w.getBoundingClientRect(),T.attr("width",g.width),T.attr("height",g.height);const k=(e.padding||0)/2;wn(x).attr("transform","translate( "+(g.width>y.width?0:(y.width-g.width)/2)+", "+(y.height+k+5)+")"),wn(p).attr("transform","translate( "+(g.width<y.width?0:-(y.width-g.width)/2)+", 0)"),g=l.node().getBBox(),l.attr("transform","translate("+-g.width/2+", "+(-g.height/2-k+3)+")");const _=g.width+(e.padding||0),P=g.height+(e.padding||0),F=-g.width/2-k,D=-g.height/2-k;let B,M;if(e.look==="handDrawn"){const $=hr.svg(s),Z=pr(e,{}),z=$.path(Bc(F,D,_,P,e.rx||0),Z),ee=$.line(-g.width/2-k,-g.height/2-k+y.height+k,g.width/2+k,-g.height/2-k+y.height+k,Z);M=s.insert(()=>(wt.debug("Rough node insert CXC",z),ee),":first-child"),B=s.insert(()=>(wt.debug("Rough node insert CXC",z),z),":first-child")}else B=i.insert("rect",":first-child"),M=i.insert("line"),B.attr("class","outer title-state").attr("style",n).attr("x",-g.width/2-k).attr("y",-g.height/2-k).attr("width",g.width+(e.padding||0)).attr("height",g.height+(e.padding||0)),M.attr("class","divider").attr("x1",-g.width/2-k).attr("x2",g.width/2+k).attr("y1",-g.height/2-k+y.height+k).attr("y2",-g.height/2-k+y.height+k);return mr(e,B),e.intersect=function($){return or.rect(e,$)},s}L(F6,"rectWithTitle");function ng(t,e,r,n,a,s,i){const c=(t+r)/2,d=(e+n)/2,p=Math.atan2(n-e,r-t),g=(r-t)/2,m=(n-e)/2,y=g/a,x=m/s,w=Math.sqrt(y**2+x**2);if(w>1)throw new Error("The given radii are too small to create an arc between the points.");const T=Math.sqrt(1-w**2),k=c+T*s*Math.sin(p)*(i?-1:1),_=d-T*a*Math.cos(p)*(i?-1:1),P=Math.atan2((e-_)/s,(t-k)/a);let D=Math.atan2((n-_)/s,(r-k)/a)-P;i&&D<0&&(D+=2*Math.PI),!i&&D>0&&(D-=2*Math.PI);const B=[];for(let M=0;M<20;M++){const $=M/19,Z=P+$*D,z=k+a*Math.cos(Z),ee=_+s*Math.sin(Z);B.push({x:z,y:ee})}return B}L(ng,"generateArcPoints");async function z6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=e?.padding??0,l=e?.padding??0,c=(e?.width?e?.width:s.width)+i*2,d=(e?.height?e?.height:s.height)+l*2,p=e.radius||5,g=e.taper||5,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{});e.stroke&&(x.stroke=e.stroke),e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-c/2+g,y:-d/2},{x:c/2-g,y:-d/2},...ng(c/2-g,-d/2,c/2,-d/2+g,p,p,!0),{x:c/2,y:-d/2+g},{x:c/2,y:d/2-g},...ng(c/2,d/2-g,c/2-g,d/2,p,p,!0),{x:c/2-g,y:d/2},{x:-c/2+g,y:d/2},...ng(-c/2+g,d/2,-c/2,d/2-g,p,p,!0),{x:-c/2,y:d/2-g},{x:-c/2,y:-d/2+g},...ng(-c/2,-d/2+g,-c/2+g,-d/2,p,p,!0)],T=hn(w),k=y.path(T,x),_=a.insert(()=>k,":first-child");return _.attr("class","basic label-container outer-path"),m&&e.look!=="handDrawn"&&_.selectChildren("path").attr("style",m),n&&e.look!=="handDrawn"&&_.selectChildren("path").attr("style",n),mr(e,_),e.intersect=function(P){return or.polygon(e,w,P)},a}L(z6,"roundedRect");async function $6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=e?.padding??0,c=Math.max(s.width+(e.padding??0)*2,e?.width??0),d=Math.max(s.height+(e.padding??0)*2,e?.height??0),p=-s.width/2-l,g=-s.height/2-l,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:p,y:g},{x:p+c+8,y:g},{x:p+c+8,y:g+d},{x:p-8,y:g+d},{x:p-8,y:g},{x:p,y:g},{x:p,y:g+d}],T=y.polygon(w.map(_=>[_.x,_.y]),x),k=a.insert(()=>T,":first-child");return k.attr("class","basic label-container").attr("style",vs(m)),n&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",n),m&&e.look!=="handDrawn"&&k.selectAll("path").attr("style",n),i.attr("transform",`translate(${-c/2+4+(e.padding??0)-(s.x-(s.left??0))},${-d/2+(e.padding??0)-(s.y-(s.top??0))})`),mr(e,k),e.intersect=function(_){return or.rect(e,_)},a}L($6,"shadedProcess");async function U6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=-l/2,p=-c/2,{cssStyles:g}=e,m=hr.svg(a),y=pr(e,{});e.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=[{x:d,y:p},{x:d,y:p+c},{x:d+l,y:p+c},{x:d+l,y:p-c/2}],w=hn(x),T=m.path(w,y),k=a.insert(()=>T,":first-child");return k.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",g),n&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",n),k.attr("transform",`translate(0, ${c/4})`),i.attr("transform",`translate(${-l/2+(e.padding??0)-(s.x-(s.left??0))}, ${-c/4+(e.padding??0)-(s.y-(s.top??0))})`),mr(e,k),e.intersect=function(_){return or.polygon(e,x,_)},a}L(U6,"slopedRect");async function q6(t,e){const r={rx:0,ry:0,labelPaddingX:e.labelPaddingX??(e?.padding||0)*2,labelPaddingY:(e?.padding||0)*1};return mb(t,e,r)}L(q6,"squareRect");async function H6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.height+e.padding,l=s.width+i/4+e.padding,c=i/2,{cssStyles:d}=e,p=hr.svg(a),g=pr(e,{});e.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const m=[{x:-l/2+c,y:-i/2},{x:l/2-c,y:-i/2},...Vg(-l/2+c,0,c,50,90,270),{x:l/2-c,y:i/2},...Vg(l/2-c,0,c,50,270,450)],y=hn(m),x=p.path(y,g),w=a.insert(()=>x,":first-child");return w.attr("class","basic label-container outer-path"),d&&e.look!=="handDrawn"&&w.selectChildren("path").attr("style",d),n&&e.look!=="handDrawn"&&w.selectChildren("path").attr("style",n),mr(e,w),e.intersect=function(T){return or.polygon(e,m,T)},a}L(H6,"stadium");async function G6(t,e){return mb(t,e,{rx:5,ry:5})}L(G6,"state");function V6(t,e,{config:{themeVariables:r}}){const{labelStyles:n,nodeStyles:a}=gr(e);e.labelStyle=n;const{cssStyles:s}=e,{lineColor:i,stateBorder:l,nodeBorder:c}=r,d=t.insert("g").attr("class","node default").attr("id",e.domId||e.id),p=hr.svg(d),g=pr(e,{});e.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");const m=p.circle(0,0,14,{...g,stroke:i,strokeWidth:2}),y=l??c,x=p.circle(0,0,5,{...g,fill:y,stroke:y,strokeWidth:2,fillStyle:"solid"}),w=d.insert(()=>m,":first-child");return w.insert(()=>x),s&&w.selectAll("path").attr("style",s),a&&w.selectAll("path").attr("style",a),mr(e,w),e.intersect=function(T){return or.circle(e,7,T)},d}L(V6,"stateEnd");function W6(t,e,{config:{themeVariables:r}}){const{lineColor:n}=r,a=t.insert("g").attr("class","node default").attr("id",e.domId||e.id);let s;if(e.look==="handDrawn"){const l=hr.svg(a).circle(0,0,14,kce(n));s=a.insert(()=>l),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else s=a.insert("circle",":first-child"),s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return mr(e,s),e.intersect=function(i){return or.circle(e,7,i)},a}L(W6,"stateStart");async function Y6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=(e?.padding||0)/2,l=s.width+e.padding,c=s.height+e.padding,d=-s.width/2-i,p=-s.height/2-i,g=[{x:0,y:0},{x:l,y:0},{x:l,y:-c},{x:0,y:-c},{x:0,y:0},{x:-8,y:0},{x:l+8,y:0},{x:l+8,y:-c},{x:-8,y:-c},{x:-8,y:0}];if(e.look==="handDrawn"){const m=hr.svg(a),y=pr(e,{}),x=m.rectangle(d-8,p,l+16,c,y),w=m.line(d,p,d,p+c,y),T=m.line(d+l,p,d+l,p+c,y);a.insert(()=>w,":first-child"),a.insert(()=>T,":first-child");const k=a.insert(()=>x,":first-child"),{cssStyles:_}=e;k.attr("class","basic label-container").attr("style",vs(_)),mr(e,k)}else{const m=Fc(a,l,c,g);n&&m.attr("style",n),mr(e,m)}return e.intersect=function(m){return or.polygon(e,g,m)},a}L(Y6,"subroutine");async function Q6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=Math.max(s.width+(e.padding??0)*2,e?.width??0),l=Math.max(s.height+(e.padding??0)*2,e?.height??0),c=-i/2,d=-l/2,p=.2*l,g=.2*l,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{}),w=[{x:c-p/2,y:d},{x:c+i+p/2,y:d},{x:c+i+p/2,y:d+l},{x:c-p/2,y:d+l}],T=[{x:c+i-p/2,y:d+l},{x:c+i+p/2,y:d+l},{x:c+i+p/2,y:d+l-g}];e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const k=hn(w),_=y.path(k,x),P=hn(T),F=y.path(P,{...x,fillStyle:"solid"}),D=a.insert(()=>F,":first-child");return D.insert(()=>_,":first-child"),D.attr("class","basic label-container"),m&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",m),n&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",n),mr(e,D),e.intersect=function(B){return or.polygon(e,w,B)},a}L(Q6,"taggedRect");async function K6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=c/4,p=.2*l,g=.2*c,m=c+d,{cssStyles:y}=e,x=hr.svg(a),w=pr(e,{});e.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");const T=[{x:-l/2-l/2*.1,y:m/2},...Rc(-l/2-l/2*.1,m/2,l/2+l/2*.1,m/2,d,.8),{x:l/2+l/2*.1,y:-m/2},{x:-l/2-l/2*.1,y:-m/2}],k=-l/2+l/2*.1,_=-m/2-g*.4,P=[{x:k+l-p,y:(_+c)*1.4},{x:k+l,y:_+c-g},{x:k+l,y:(_+c)*.9},...Rc(k+l,(_+c)*1.3,k+l-p,(_+c)*1.5,-c*.03,.5)],F=hn(T),D=x.path(F,w),B=hn(P),M=x.path(B,{...w,fillStyle:"solid"}),$=a.insert(()=>M,":first-child");return $.insert(()=>D,":first-child"),$.attr("class","basic label-container"),y&&e.look!=="handDrawn"&&$.selectAll("path").attr("style",y),n&&e.look!=="handDrawn"&&$.selectAll("path").attr("style",n),$.attr("transform",`translate(0,${-d/2})`),i.attr("transform",`translate(${-l/2+(e.padding??0)-(s.x-(s.left??0))},${-c/2+(e.padding??0)-d/2-(s.y-(s.top??0))})`),mr(e,$),e.intersect=function(Z){return or.polygon(e,T,Z)},a}L(K6,"taggedWaveEdgedRectangle");async function X6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=Math.max(s.width+e.padding,e?.width||0),l=Math.max(s.height+e.padding,e?.height||0),c=-i/2,d=-l/2,p=a.insert("rect",":first-child");return p.attr("class","text").attr("style",n).attr("rx",0).attr("ry",0).attr("x",c).attr("y",d).attr("width",i).attr("height",l),mr(e,p),e.intersect=function(g){return or.rect(e,g)},a}L(X6,"text");var uge=L((t,e,r,n,a,s)=>`M${t},${e}
    a${a},${s} 0,0,1 0,${-n}
    l${r},0
    a${a},${s} 0,0,1 0,${n}
    M${r},${-n}
    a${a},${s} 0,0,0 0,${n}
    l${-r},0`,"createCylinderPathD"),dge=L((t,e,r,n,a,s)=>[`M${t},${e}`,`M${t+r},${e}`,`a${a},${s} 0,0,0 0,${-n}`,`l${-r},0`,`a${a},${s} 0,0,0 0,${n}`,`l${r},0`].join(" "),"createOuterCylinderPathD"),hge=L((t,e,r,n,a,s)=>[`M${t+r/2},${-n/2}`,`a${a},${s} 0,0,0 0,${n}`].join(" "),"createInnerCylinderPathD");async function J6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i,halfPadding:l}=await Dr(t,e,Nr(e)),c=e.look==="neo"?l*2:l,d=s.height+c,p=d/2,g=p/(2.5+d/50),m=s.width+g+c,{cssStyles:y}=e;let x;if(e.look==="handDrawn"){const w=hr.svg(a),T=dge(0,0,m,d,g,p),k=hge(0,0,m,d,g,p),_=w.path(T,pr(e,{})),P=w.path(k,pr(e,{fill:"none"}));x=a.insert(()=>P,":first-child"),x=a.insert(()=>_,":first-child"),x.attr("class","basic label-container"),y&&x.attr("style",y)}else{const w=uge(0,0,m,d,g,p);x=a.insert("path",":first-child").attr("d",w).attr("class","basic label-container").attr("style",vs(y)).attr("style",n),x.attr("class","basic label-container"),y&&x.selectAll("path").attr("style",y),n&&x.selectAll("path").attr("style",n)}return x.attr("label-offset-x",g),x.attr("transform",`translate(${-m/2}, ${d/2} )`),i.attr("transform",`translate(${-(s.width/2)-g-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),mr(e,x),e.intersect=function(w){const T=or.rect(e,w),k=T.y-(e.y??0);if(p!=0&&(Math.abs(k)<(e.height??0)/2||Math.abs(k)==(e.height??0)/2&&Math.abs(T.x-(e.x??0))>(e.width??0)/2-g)){let _=g*g*(1-k*k/(p*p));_!=0&&(_=Math.sqrt(Math.abs(_))),_=g-_,w.x-(e.x??0)>0&&(_=-_),T.x+=_}return T},a}L(J6,"tiltedCylinder");async function Z6(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=s.width+e.padding,l=s.height+e.padding,c=[{x:-3*l/6,y:0},{x:i+3*l/6,y:0},{x:i,y:-l},{x:0,y:-l}];let d;const{cssStyles:p}=e;if(e.look==="handDrawn"){const g=hr.svg(a),m=pr(e,{}),y=hn(c),x=g.path(y,m);d=a.insert(()=>x,":first-child").attr("transform",`translate(${-i/2}, ${l/2})`),p&&d.attr("style",p)}else d=Fc(a,i,l,c);return n&&d.attr("style",n),e.width=i,e.height=l,mr(e,d),e.intersect=function(g){return or.polygon(e,c,g)},a}L(Z6,"trapezoid");async function e5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=60,l=20,c=Math.max(i,s.width+(e.padding??0)*2,e?.width??0),d=Math.max(l,s.height+(e.padding??0)*2,e?.height??0),{cssStyles:p}=e,g=hr.svg(a),m=pr(e,{});e.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-c/2*.8,y:-d/2},{x:c/2*.8,y:-d/2},{x:c/2,y:-d/2*.6},{x:c/2,y:d/2},{x:-c/2,y:d/2},{x:-c/2,y:-d/2*.6}],x=hn(y),w=g.path(x,m),T=a.insert(()=>w,":first-child");return T.attr("class","basic label-container"),p&&e.look!=="handDrawn"&&T.selectChildren("path").attr("style",p),n&&e.look!=="handDrawn"&&T.selectChildren("path").attr("style",n),mr(e,T),e.intersect=function(k){return or.polygon(e,y,k)},a}L(e5,"trapezoidalPentagon");async function t5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Wa(In().flowchart?.htmlLabels),c=s.width+(e.padding??0),d=c+s.height,p=c+s.height,g=[{x:0,y:0},{x:p,y:0},{x:p/2,y:-d}],{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=hn(g),T=y.path(w,x),k=a.insert(()=>T,":first-child").attr("transform",`translate(${-d/2}, ${d/2})`);return m&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",m),n&&e.look!=="handDrawn"&&k.selectChildren("path").attr("style",n),e.width=c,e.height=d,mr(e,k),i.attr("transform",`translate(${-s.width/2-(s.x-(s.left??0))}, ${d/2-(s.height+(e.padding??0)/(l?2:1)-(s.y-(s.top??0)))})`),e.intersect=function(_){return wt.info("Triangle intersect",e,g,_),or.polygon(e,g,_)},a}L(t5,"triangle");async function r5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=c/8,p=c+d,{cssStyles:g}=e,y=70-l,x=y>0?y/2:0,w=hr.svg(a),T=pr(e,{});e.look!=="handDrawn"&&(T.roughness=0,T.fillStyle="solid");const k=[{x:-l/2-x,y:p/2},...Rc(-l/2-x,p/2,l/2+x,p/2,d,.8),{x:l/2+x,y:-p/2},{x:-l/2-x,y:-p/2}],_=hn(k),P=w.path(_,T),F=a.insert(()=>P,":first-child");return F.attr("class","basic label-container"),g&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",g),n&&e.look!=="handDrawn"&&F.selectAll("path").attr("style",n),F.attr("transform",`translate(0,${-d/2})`),i.attr("transform",`translate(${-l/2+(e.padding??0)-(s.x-(s.left??0))},${-c/2+(e.padding??0)-d-(s.y-(s.top??0))})`),mr(e,F),e.intersect=function(D){return or.polygon(e,k,D)},a}L(r5,"waveEdgedRectangle");async function n5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s}=await Dr(t,e,Nr(e)),i=100,l=50,c=Math.max(s.width+(e.padding??0)*2,e?.width??0),d=Math.max(s.height+(e.padding??0)*2,e?.height??0),p=c/d;let g=c,m=d;g>m*p?m=g/p:g=m*p,g=Math.max(g,i),m=Math.max(m,l);const y=Math.min(m*.2,m/4),x=m+y*2,{cssStyles:w}=e,T=hr.svg(a),k=pr(e,{});e.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const _=[{x:-g/2,y:x/2},...Rc(-g/2,x/2,g/2,x/2,y,1),{x:g/2,y:-x/2},...Rc(g/2,-x/2,-g/2,-x/2,y,-1)],P=hn(_),F=T.path(P,k),D=a.insert(()=>F,":first-child");return D.attr("class","basic label-container"),w&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",w),n&&e.look!=="handDrawn"&&D.selectAll("path").attr("style",n),mr(e,D),e.intersect=function(B){return or.polygon(e,_,B)},a}L(n5,"waveRectangle");async function a5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,label:i}=await Dr(t,e,Nr(e)),l=Math.max(s.width+(e.padding??0)*2,e?.width??0),c=Math.max(s.height+(e.padding??0)*2,e?.height??0),d=5,p=-l/2,g=-c/2,{cssStyles:m}=e,y=hr.svg(a),x=pr(e,{}),w=[{x:p-d,y:g-d},{x:p-d,y:g+c},{x:p+l,y:g+c},{x:p+l,y:g-d}],T=`M${p-d},${g-d} L${p+l},${g-d} L${p+l},${g+c} L${p-d},${g+c} L${p-d},${g-d}
                M${p-d},${g} L${p+l},${g}
                M${p},${g-d} L${p},${g+c}`;e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const k=y.path(T,x),_=a.insert(()=>k,":first-child");return _.attr("transform",`translate(${d/2}, ${d/2})`),_.attr("class","basic label-container"),m&&e.look!=="handDrawn"&&_.selectAll("path").attr("style",m),n&&e.look!=="handDrawn"&&_.selectAll("path").attr("style",n),i.attr("transform",`translate(${-(s.width/2)+d/2-(s.x-(s.left??0))}, ${-(s.height/2)+d/2-(s.y-(s.top??0))})`),mr(e,_),e.intersect=function(P){return or.polygon(e,w,P)},a}L(a5,"windowPane");async function Xk(t,e){const r=e;if(r.alias&&(e.label=r.alias),e.look==="handDrawn"){const{themeVariables:K}=bs(),{background:U}=K,ce={...e,id:e.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${U}`]};await Xk(t,ce)}const n=bs();e.useHtmlLabels=n.htmlLabels;let a=n.er?.diagramPadding??10,s=n.er?.entityPadding??6;const{cssStyles:i}=e,{labelStyles:l,nodeStyles:c}=gr(e);if(r.attributes.length===0&&e.label){const K={rx:0,ry:0,labelPaddingX:a,labelPaddingY:a*1.5};Ml(e.label,n)+K.labelPaddingX*2<n.er.minEntityWidth&&(e.width=n.er.minEntityWidth);const U=await mb(t,e,K);if(!Wa(n.htmlLabels)){const ce=U.select("text"),ye=ce.node()?.getBBox();ce.attr("transform",`translate(${-ye.width/2}, 0)`)}return U}n.htmlLabels||(a*=1.25,s*=1.25);let d=Nr(e);d||(d="node default");const p=t.insert("g").attr("class",d).attr("id",e.domId||e.id),g=await Gd(p,e.label??"",n,0,0,["name"],l);g.height+=s;let m=0;const y=[],x=[];let w=0,T=0,k=0,_=0,P=!0,F=!0;for(const K of r.attributes){const U=await Gd(p,K.type,n,0,m,["attribute-type"],l);w=Math.max(w,U.width+a);const ce=await Gd(p,K.name,n,0,m,["attribute-name"],l);T=Math.max(T,ce.width+a);const ye=await Gd(p,K.keys.join(),n,0,m,["attribute-keys"],l);k=Math.max(k,ye.width+a);const Ae=await Gd(p,K.comment,n,0,m,["attribute-comment"],l);_=Math.max(_,Ae.width+a);const fe=Math.max(U.height,ce.height,ye.height,Ae.height)+s;x.push({yOffset:m,rowHeight:fe}),m+=fe}let D=4;k<=a&&(P=!1,k=0,D--),_<=a&&(F=!1,_=0,D--);const B=p.node().getBBox();if(g.width+a*2-(w+T+k+_)>0){const K=g.width+a*2-(w+T+k+_);w+=K/D,T+=K/D,k>0&&(k+=K/D),_>0&&(_+=K/D)}const M=w+T+k+_,$=hr.svg(p),Z=pr(e,{});e.look!=="handDrawn"&&(Z.roughness=0,Z.fillStyle="solid");let z=0;x.length>0&&(z=x.reduce((K,U)=>K+(U?.rowHeight??0),0));const ee=Math.max(B.width+a*2,e?.width||0,M),te=Math.max((z??0)+g.height,e?.height||0),X=-ee/2,Q=-te/2;p.selectAll("g:not(:first-child)").each((K,U,ce)=>{const ye=wn(ce[U]),Ae=ye.attr("transform");let fe=0,Ne=0;if(Ae){const se=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Ae);se&&(fe=parseFloat(se[1]),Ne=parseFloat(se[2]),ye.attr("class").includes("attribute-name")?fe+=w:ye.attr("class").includes("attribute-keys")?fe+=w+T:ye.attr("class").includes("attribute-comment")&&(fe+=w+T+k))}ye.attr("transform",`translate(${X+a/2+fe}, ${Ne+Q+g.height+s/2})`)}),p.select(".name").attr("transform","translate("+-g.width/2+", "+(Q+s/2)+")");const W=$.rectangle(X,Q,ee,te,Z),H=p.insert(()=>W,":first-child").attr("style",i.join("")),{themeVariables:re}=bs(),{rowEven:ne,rowOdd:ve,nodeBorder:O}=re;y.push(0);for(const[K,U]of x.entries()){const ye=(K+1)%2===0&&U.yOffset!==0,Ae=$.rectangle(X,g.height+Q+U?.yOffset,ee,U?.rowHeight,{...Z,fill:ye?ne:ve,stroke:O});p.insert(()=>Ae,"g.label").attr("style",i.join("")).attr("class",`row-rect-${ye?"even":"odd"}`)}let I=$.line(X,g.height+Q,ee+X,g.height+Q,Z);p.insert(()=>I).attr("class","divider"),I=$.line(w+X,g.height+Q,w+X,te+Q,Z),p.insert(()=>I).attr("class","divider"),P&&(I=$.line(w+T+X,g.height+Q,w+T+X,te+Q,Z),p.insert(()=>I).attr("class","divider")),F&&(I=$.line(w+T+k+X,g.height+Q,w+T+k+X,te+Q,Z),p.insert(()=>I).attr("class","divider"));for(const K of y)I=$.line(X,g.height+Q+K,ee+X,g.height+Q+K,Z),p.insert(()=>I).attr("class","divider");if(mr(e,H),c&&e.look!=="handDrawn"){const U=c.split(";")?.filter(ce=>ce.includes("stroke"))?.map(ce=>`${ce}`).join("; ");p.selectAll("path").attr("style",U??""),p.selectAll(".row-rect-even path").attr("style",c)}return e.intersect=function(K){return or.rect(e,K)},p}L(Xk,"erBox");async function Gd(t,e,r,n=0,a=0,s=[],i=""){const l=t.insert("g").attr("class",`label ${s.join(" ")}`).attr("transform",`translate(${n}, ${a})`).attr("style",i);e!==lN(e)&&(e=lN(e),e=e.replaceAll("<","&lt;").replaceAll(">","&gt;"));const c=l.node().appendChild(await jc(l,e,{width:Ml(e,r)+100,style:i,useHtmlLabels:r.htmlLabels},r));if(e.includes("&lt;")||e.includes("&gt;")){let p=c.children[0];for(p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");p.childNodes[0];)p=p.childNodes[0],p.textContent=p.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let d=c.getBBox();if(Wa(r.htmlLabels)){const p=c.children[0];p.style.textAlign="start";const g=wn(c);d=p.getBoundingClientRect(),g.attr("width",d.width),g.attr("height",d.height)}return d}L(Gd,"addText");async function s5(t,e,r,n,a=r.class.padding??12){const s=n?0:3,i=t.insert("g").attr("class",Nr(e)).attr("id",e.domId||e.id);let l=null,c=null,d=null,p=null,g=0,m=0,y=0;if(l=i.insert("g").attr("class","annotation-group text"),e.annotations.length>0){const _=e.annotations[0];await ag(l,{text:`${_}`},0),g=l.node().getBBox().height}c=i.insert("g").attr("class","label-group text"),await ag(c,e,0,["font-weight: bolder"]);const x=c.node().getBBox();m=x.height,d=i.insert("g").attr("class","members-group text");let w=0;for(const _ of e.members){const P=await ag(d,_,w,[_.parseClassifier()]);w+=P+s}y=d.node().getBBox().height,y<=0&&(y=a/2),p=i.insert("g").attr("class","methods-group text");let T=0;for(const _ of e.methods){const P=await ag(p,_,T,[_.parseClassifier()]);T+=P+s}let k=i.node().getBBox();if(l!==null){const _=l.node().getBBox();l.attr("transform",`translate(${-_.width/2})`)}return c.attr("transform",`translate(${-x.width/2}, ${g})`),k=i.node().getBBox(),d.attr("transform",`translate(0, ${g+m+a*2})`),k=i.node().getBBox(),p.attr("transform",`translate(0, ${g+m+(y?y+a*4:a*2)})`),k=i.node().getBBox(),{shapeSvg:i,bbox:k}}L(s5,"textHelper");async function ag(t,e,r,n=[]){const a=t.insert("g").attr("class","label").attr("style",n.join("; ")),s=bs();let i="useHtmlLabels"in e?e.useHtmlLabels:Wa(s.htmlLabels)??!0,l="";"text"in e?l=e.text:l=e.label,!i&&l.startsWith("\\")&&(l=l.substring(1)),mh(l)&&(i=!0);const c=await jc(a,ok(Wu(l)),{width:Ml(l,s)+50,classes:"markdown-node-label",useHtmlLabels:i},s);let d,p=1;if(i){const g=c.children[0],m=wn(c);p=g.innerHTML.split("<br>").length,g.innerHTML.includes("</math>")&&(p+=g.innerHTML.split("<mrow>").length-1);const y=g.getElementsByTagName("img");if(y){const x=l.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...y].map(w=>new Promise(T=>{function k(){if(w.style.display="flex",w.style.flexDirection="column",x){const _=s.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,F=parseInt(_,10)*5+"px";w.style.minWidth=F,w.style.maxWidth=F}else w.style.width="100%";T(w)}L(k,"setupImage"),setTimeout(()=>{w.complete&&k()}),w.addEventListener("error",k),w.addEventListener("load",k)})))}d=g.getBoundingClientRect(),m.attr("width",d.width),m.attr("height",d.height)}else{n.includes("font-weight: bolder")&&wn(c).selectAll("tspan").attr("font-weight",""),p=c.children.length;const g=c.children[0];(c.textContent===""||c.textContent.includes("&gt"))&&(g.textContent=l[0]+l.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),l[1]===" "&&(g.textContent=g.textContent[0]+" "+g.textContent.substring(1))),g.textContent==="undefined"&&(g.textContent=""),d=c.getBBox()}return a.attr("transform","translate(0,"+(-d.height/(2*p)+r)+")"),d.height}L(ag,"addText");async function i5(t,e){const r=In(),n=r.class.padding??12,a=n,s=e.useHtmlLabels??Wa(r.htmlLabels)??!0,i=e;i.annotations=i.annotations??[],i.members=i.members??[],i.methods=i.methods??[];const{shapeSvg:l,bbox:c}=await s5(t,e,r,s,a),{labelStyles:d,nodeStyles:p}=gr(e);e.labelStyle=d,e.cssStyles=i.styles||"";const g=i.styles?.join(";")||p||"";e.cssStyles||(e.cssStyles=g.replaceAll("!important","").split(";"));const m=i.members.length===0&&i.methods.length===0&&!r.class?.hideEmptyMembersBox,y=hr.svg(l),x=pr(e,{});e.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=c.width;let T=c.height;i.members.length===0&&i.methods.length===0?T+=a:i.members.length>0&&i.methods.length===0&&(T+=a*2);const k=-w/2,_=-T/2,P=y.rectangle(k-n,_-n-(m?n:i.members.length===0&&i.methods.length===0?-n/2:0),w+2*n,T+2*n+(m?n*2:i.members.length===0&&i.methods.length===0?-n:0),x),F=l.insert(()=>P,":first-child");F.attr("class","basic label-container");const D=F.node().getBBox();l.selectAll(".text").each((Z,z,ee)=>{const te=wn(ee[z]),X=te.attr("transform");let Q=0;if(X){const ne=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(X);ne&&(Q=parseFloat(ne[2]))}let W=Q+_+n-(m?n:i.members.length===0&&i.methods.length===0?-n/2:0);s||(W-=4);let H=k;(te.attr("class").includes("label-group")||te.attr("class").includes("annotation-group"))&&(H=-te.node()?.getBBox().width/2||0,l.selectAll("text").each(function(re,ne,ve){window.getComputedStyle(ve[ne]).textAnchor==="middle"&&(H=0)})),te.attr("transform",`translate(${H}, ${W})`)});const B=l.select(".annotation-group").node().getBBox().height-(m?n/2:0)||0,M=l.select(".label-group").node().getBBox().height-(m?n/2:0)||0,$=l.select(".members-group").node().getBBox().height-(m?n/2:0)||0;if(i.members.length>0||i.methods.length>0||m){const Z=y.line(D.x,B+M+_+n,D.x+D.width,B+M+_+n,x);l.insert(()=>Z).attr("class","divider").attr("style",g)}if(m||i.members.length>0||i.methods.length>0){const Z=y.line(D.x,B+M+$+_+a*2+n,D.x+D.width,B+M+$+_+n+a*2,x);l.insert(()=>Z).attr("class","divider").attr("style",g)}if(i.look!=="handDrawn"&&l.selectAll("path").attr("style",g),F.select(":nth-child(2)").attr("style",g),l.selectAll(".divider").select("path").attr("style",g),e.labelStyle?l.selectAll("span").attr("style",e.labelStyle):l.selectAll("span").attr("style",g),!s){const Z=RegExp(/color\s*:\s*([^;]*)/),z=Z.exec(g);if(z){const ee=z[0].replace("color","fill");l.selectAll("tspan").attr("style",ee)}else if(d){const ee=Z.exec(d);if(ee){const te=ee[0].replace("color","fill");l.selectAll("tspan").attr("style",te)}}}return mr(e,F),e.intersect=function(Z){return or.rect(e,Z)},l}L(i5,"classBox");async function o5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const a=e,s=e,i=20,l=20,c="verifyMethod"in e,d=Nr(e),p=t.insert("g").attr("class",d).attr("id",e.domId??e.id);let g;c?g=await zo(p,`&lt;&lt;${a.type}&gt;&gt;`,0,e.labelStyle):g=await zo(p,"&lt;&lt;Element&gt;&gt;",0,e.labelStyle);let m=g;const y=await zo(p,a.name,m,e.labelStyle+"; font-weight: bold;");if(m+=y+l,c){const B=await zo(p,`${a.requirementId?`ID: ${a.requirementId}`:""}`,m,e.labelStyle);m+=B;const M=await zo(p,`${a.text?`Text: ${a.text}`:""}`,m,e.labelStyle);m+=M;const $=await zo(p,`${a.risk?`Risk: ${a.risk}`:""}`,m,e.labelStyle);m+=$,await zo(p,`${a.verifyMethod?`Verification: ${a.verifyMethod}`:""}`,m,e.labelStyle)}else{const B=await zo(p,`${s.type?`Type: ${s.type}`:""}`,m,e.labelStyle);m+=B,await zo(p,`${s.docRef?`Doc Ref: ${s.docRef}`:""}`,m,e.labelStyle)}const x=(p.node()?.getBBox().width??200)+i,w=(p.node()?.getBBox().height??200)+i,T=-x/2,k=-w/2,_=hr.svg(p),P=pr(e,{});e.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");const F=_.rectangle(T,k,x,w,P),D=p.insert(()=>F,":first-child");if(D.attr("class","basic label-container").attr("style",n),p.selectAll(".label").each((B,M,$)=>{const Z=wn($[M]),z=Z.attr("transform");let ee=0,te=0;if(z){const H=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(z);H&&(ee=parseFloat(H[1]),te=parseFloat(H[2]))}const X=te-w/2;let Q=T+i/2;(M===0||M===1)&&(Q=ee),Z.attr("transform",`translate(${Q}, ${X+i})`)}),m>g+y+l){const B=_.line(T,k+g+y+l,T+x,k+g+y+l,P);p.insert(()=>B).attr("style",n)}return mr(e,D),e.intersect=function(B){return or.rect(e,B)},p}L(o5,"requirementBox");async function zo(t,e,r,n=""){if(e==="")return 0;const a=t.insert("g").attr("class","label").attr("style",n),s=In(),i=s.htmlLabels??!0,l=await jc(a,ok(Wu(e)),{width:Ml(e,s)+50,classes:"markdown-node-label",useHtmlLabels:i,style:n},s);let c;if(i){const d=l.children[0],p=wn(l);c=d.getBoundingClientRect(),p.attr("width",c.width),p.attr("height",c.height)}else{const d=l.children[0];for(const p of d.children)p.textContent=p.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),n&&p.setAttribute("style",n);c=l.getBBox(),c.height+=6}return a.attr("transform",`translate(${-c.width/2},${-c.height/2+r})`),c.height}L(zo,"addText");var pge=L(t=>{switch(t){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function l5(t,e,{config:r}){const{labelStyles:n,nodeStyles:a}=gr(e);e.labelStyle=n||"";const s=10,i=e.width;e.width=(e.width??200)-10;const{shapeSvg:l,bbox:c,label:d}=await Dr(t,e,Nr(e)),p=e.padding||10;let g="",m;"ticket"in e&&e.ticket&&r?.kanban?.ticketBaseUrl&&(g=r?.kanban?.ticketBaseUrl.replace("#TICKET#",e.ticket),m=l.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",g).attr("target","_blank"));const y={useHtmlLabels:e.useHtmlLabels,labelStyle:e.labelStyle||"",width:e.width,img:e.img,padding:e.padding||8,centerLabel:!1};let x,w;m?{label:x,bbox:w}=await fw(m,"ticket"in e&&e.ticket||"",y):{label:x,bbox:w}=await fw(l,"ticket"in e&&e.ticket||"",y);const{label:T,bbox:k}=await fw(l,"assigned"in e&&e.assigned||"",y);e.width=i;const _=10,P=e?.width||0,F=Math.max(w.height,k.height)/2,D=Math.max(c.height+_*2,e?.height||0)+F,B=-P/2,M=-D/2;d.attr("transform","translate("+(p-P/2)+", "+(-F-c.height/2)+")"),x.attr("transform","translate("+(p-P/2)+", "+(-F+c.height/2)+")"),T.attr("transform","translate("+(p+P/2-k.width-2*s)+", "+(-F+c.height/2)+")");let $;const{rx:Z,ry:z}=e,{cssStyles:ee}=e;if(e.look==="handDrawn"){const te=hr.svg(l),X=pr(e,{}),Q=Z||z?te.path(Bc(B,M,P,D,Z||0),X):te.rectangle(B,M,P,D,X);$=l.insert(()=>Q,":first-child"),$.attr("class","basic label-container").attr("style",ee||null)}else{$=l.insert("rect",":first-child"),$.attr("class","basic label-container __APA__").attr("style",a).attr("rx",Z??5).attr("ry",z??5).attr("x",B).attr("y",M).attr("width",P).attr("height",D);const te="priority"in e&&e.priority;if(te){const X=l.append("line"),Q=B+2,W=M+Math.floor((Z??0)/2),H=M+D-Math.floor((Z??0)/2);X.attr("x1",Q).attr("y1",W).attr("x2",Q).attr("y2",H).attr("stroke-width","4").attr("stroke",pge(te))}}return mr(e,$),e.height=D,e.intersect=function(te){return or.rect(e,te)},l}L(l5,"kanbanItem");async function c5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,halfPadding:i,label:l}=await Dr(t,e,Nr(e)),c=s.width+10*i,d=s.height+8*i,p=.15*c,{cssStyles:g}=e,m=s.width+20,y=s.height+20,x=Math.max(c,m),w=Math.max(d,y);l.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`);let T;const k=`M0 0 
    a${p},${p} 1 0,0 ${x*.25},${-1*w*.1}
    a${p},${p} 1 0,0 ${x*.25},0
    a${p},${p} 1 0,0 ${x*.25},0
    a${p},${p} 1 0,0 ${x*.25},${w*.1}

    a${p},${p} 1 0,0 ${x*.15},${w*.33}
    a${p*.8},${p*.8} 1 0,0 0,${w*.34}
    a${p},${p} 1 0,0 ${-1*x*.15},${w*.33}

    a${p},${p} 1 0,0 ${-1*x*.25},${w*.15}
    a${p},${p} 1 0,0 ${-1*x*.25},0
    a${p},${p} 1 0,0 ${-1*x*.25},0
    a${p},${p} 1 0,0 ${-1*x*.25},${-1*w*.15}

    a${p},${p} 1 0,0 ${-1*x*.1},${-1*w*.33}
    a${p*.8},${p*.8} 1 0,0 0,${-1*w*.34}
    a${p},${p} 1 0,0 ${x*.1},${-1*w*.33}
  H0 V0 Z`;if(e.look==="handDrawn"){const _=hr.svg(a),P=pr(e,{}),F=_.path(k,P);T=a.insert(()=>F,":first-child"),T.attr("class","basic label-container").attr("style",vs(g))}else T=a.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",k);return T.attr("transform",`translate(${-x/2}, ${-w/2})`),mr(e,T),e.calcIntersect=function(_,P){return or.rect(_,P)},e.intersect=function(_){return wt.info("Bang intersect",e,_),or.rect(e,_)},a}L(c5,"bang");async function u5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,halfPadding:i,label:l}=await Dr(t,e,Nr(e)),c=s.width+2*i,d=s.height+2*i,p=.15*c,g=.25*c,m=.35*c,y=.2*c,{cssStyles:x}=e;let w;const T=`M0 0 
    a${p},${p} 0 0,1 ${c*.25},${-1*c*.1}
    a${m},${m} 1 0,1 ${c*.4},${-1*c*.1}
    a${g},${g} 1 0,1 ${c*.35},${c*.2}

    a${p},${p} 1 0,1 ${c*.15},${d*.35}
    a${y},${y} 1 0,1 ${-1*c*.15},${d*.65}

    a${g},${p} 1 0,1 ${-1*c*.25},${c*.15}
    a${m},${m} 1 0,1 ${-1*c*.5},0
    a${p},${p} 1 0,1 ${-1*c*.25},${-1*c*.15}

    a${p},${p} 1 0,1 ${-1*c*.1},${-1*d*.35}
    a${y},${y} 1 0,1 ${c*.1},${-1*d*.65}
  H0 V0 Z`;if(e.look==="handDrawn"){const k=hr.svg(a),_=pr(e,{}),P=k.path(T,_);w=a.insert(()=>P,":first-child"),w.attr("class","basic label-container").attr("style",vs(x))}else w=a.insert("path",":first-child").attr("class","basic label-container").attr("style",n).attr("d",T);return l.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`),w.attr("transform",`translate(${-c/2}, ${-d/2})`),mr(e,w),e.calcIntersect=function(k,_){return or.rect(k,_)},e.intersect=function(k){return wt.info("Cloud intersect",e,k),or.rect(e,k)},a}L(u5,"cloud");async function d5(t,e){const{labelStyles:r,nodeStyles:n}=gr(e);e.labelStyle=r;const{shapeSvg:a,bbox:s,halfPadding:i,label:l}=await Dr(t,e,Nr(e)),c=s.width+8*i,d=s.height+2*i,p=5,g=`
    M${-c/2} ${d/2-p}
    v${-d+2*p}
    q0,-${p} ${p},-${p}
    h${c-2*p}
    q${p},0 ${p},${p}
    v${d-2*p}
    q0,${p} -${p},${p}
    h${-c+2*p}
    q-${p},0 -${p},-${p}
    Z
  `,m=a.append("path").attr("id","node-"+e.id).attr("class","node-bkg node-"+e.type).attr("style",n).attr("d",g);return a.append("line").attr("class","node-line-").attr("x1",-c/2).attr("y1",d/2).attr("x2",c/2).attr("y2",d/2),l.attr("transform",`translate(${-s.width/2}, ${-s.height/2})`),a.append(()=>l.node()),mr(e,m),e.calcIntersect=function(y,x){return or.rect(y,x)},e.intersect=function(y){return or.rect(e,y)},a}L(d5,"defaultMindmapNode");async function h5(t,e){const r={padding:e.padding??0};return Kk(t,e,r)}L(h5,"mindmapCircle");var gge=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:q6},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:z6},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:H6},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Y6},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:p6},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Kk},{semanticName:"Bang",name:"Bang",shortName:"bang",description:"Bang",aliases:["bang"],handler:c5},{semanticName:"Cloud",name:"Cloud",shortName:"cloud",description:"cloud",aliases:["cloud"],handler:u5},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:j6},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:v6},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:P6},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:N6},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Z6},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:_6},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:f6},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:X6},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:s6},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:$6},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:W6},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:V6},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:b6},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:w6},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:c6},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:u6},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:d6},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:I6},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:r5},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:x6},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:J6},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:R6},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:h6},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:g6},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:t5},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:a5},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:m6},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:e5},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:y6},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:U6},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:M6},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:L6},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:a6},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:l6},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:K6},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Q6},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:n5},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:B6},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:D6}],fge=L(()=>{const e=[...Object.entries({state:G6,choice:i6,note:O6,rectWithTitle:F6,labelRect:A6,iconSquare:C6,iconCircle:k6,icon:S6,iconRounded:T6,imageSquare:E6,anchor:n6,kanbanItem:l5,mindmapCircle:h5,defaultMindmapNode:d5,classBox:i5,erBox:Xk,requirementBox:o5}),...gge.flatMap(r=>[r.shortName,..."aliases"in r?r.aliases:[],..."internalAliases"in r?r.internalAliases:[]].map(a=>[a,r.handler]))];return Object.fromEntries(e)},"generateShapeMap"),p5=fge();function mge(t){return t in p5}L(mge,"isValidShape");var yb=new Map;async function g5(t,e,r){let n,a;e.shape==="rect"&&(e.rx&&e.ry?e.shape="roundedRect":e.shape="squareRect");const s=e.shape?p5[e.shape]:void 0;if(!s)throw new Error(`No such shape: ${e.shape}. Please check your syntax.`);if(e.link){let i;r.config.securityLevel==="sandbox"?i="_top":e.linkTarget&&(i=e.linkTarget||"_blank"),n=t.insert("svg:a").attr("xlink:href",e.link).attr("target",i??null),a=await s(n,e,r)}else a=await s(t,e,r),n=a;return e.tooltip&&a.attr("title",e.tooltip),yb.set(e.id,n),e.haveCallback&&n.attr("class",n.attr("class")+" clickable"),n}L(g5,"insertNode");var dve=L((t,e)=>{yb.set(e.id,t)},"setNodeElem"),hve=L(()=>{yb.clear()},"clear"),pve=L(t=>{const e=yb.get(t.id);wt.trace("Transforming node",t.diff,t,"translate("+(t.x-t.width/2-5)+", "+t.width/2+")");const r=8,n=t.diff||0;return t.clusterNode?e.attr("transform","translate("+(t.x+n-t.width/2)+", "+(t.y-t.height/2-r)+")"):e.attr("transform","translate("+t.x+", "+t.y+")"),n},"positionNode"),yge=L((t,e,r,n,a,s)=>{e.arrowTypeStart&&m3(t,"start",e.arrowTypeStart,r,n,a,s),e.arrowTypeEnd&&m3(t,"end",e.arrowTypeEnd,r,n,a,s)},"addEdgeMarkers"),bge={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},m3=L((t,e,r,n,a,s,i)=>{const l=bge[r];if(!l){wt.warn(`Unknown arrow type: ${r}`);return}const c=l.type,p=`${a}_${s}-${c}${e==="start"?"Start":"End"}`;if(i&&i.trim()!==""){const g=i.replace(/[^\dA-Za-z]/g,"_"),m=`${p}_${g}`;if(!document.getElementById(m)){const y=document.getElementById(p);if(y){const x=y.cloneNode(!0);x.id=m,x.querySelectorAll("path, circle, line").forEach(T=>{T.setAttribute("stroke",i),l.fill&&T.setAttribute("fill",i)}),y.parentNode?.appendChild(x)}}t.attr(`marker-${e}`,`url(${n}#${m})`)}else t.attr(`marker-${e}`,`url(${n}#${p})`)},"addEdgeMarker"),Cy=new Map,os=new Map,gve=L(()=>{Cy.clear(),os.clear()},"clear"),Qm=L(t=>t?t.reduce((r,n)=>r+";"+n,""):"","getLabelStyles"),xge=L(async(t,e)=>{let r=Wa(In().flowchart.htmlLabels);const{labelStyles:n}=gr(e);e.labelStyle=n;const a=await jc(t,e.label,{style:e.labelStyle,useHtmlLabels:r,addSvgBackground:!0,isNode:!1});wt.info("abc82",e,e.labelType);const s=t.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label").attr("data-id",e.id);i.node().appendChild(a);let l=a.getBBox();if(r){const d=a.children[0],p=wn(a);l=d.getBoundingClientRect(),p.attr("width",l.width),p.attr("height",l.height)}i.attr("transform","translate("+-l.width/2+", "+-l.height/2+")"),Cy.set(e.id,s),e.width=l.width,e.height=l.height;let c;if(e.startLabelLeft){const d=await ku(e.startLabelLeft,Qm(e.labelStyle)),p=t.insert("g").attr("class","edgeTerminals"),g=p.insert("g").attr("class","inner");c=g.node().appendChild(d);const m=d.getBBox();g.attr("transform","translate("+-m.width/2+", "+-m.height/2+")"),os.get(e.id)||os.set(e.id,{}),os.get(e.id).startLeft=p,sg(c,e.startLabelLeft)}if(e.startLabelRight){const d=await ku(e.startLabelRight,Qm(e.labelStyle)),p=t.insert("g").attr("class","edgeTerminals"),g=p.insert("g").attr("class","inner");c=p.node().appendChild(d),g.node().appendChild(d);const m=d.getBBox();g.attr("transform","translate("+-m.width/2+", "+-m.height/2+")"),os.get(e.id)||os.set(e.id,{}),os.get(e.id).startRight=p,sg(c,e.startLabelRight)}if(e.endLabelLeft){const d=await ku(e.endLabelLeft,Qm(e.labelStyle)),p=t.insert("g").attr("class","edgeTerminals"),g=p.insert("g").attr("class","inner");c=g.node().appendChild(d);const m=d.getBBox();g.attr("transform","translate("+-m.width/2+", "+-m.height/2+")"),p.node().appendChild(d),os.get(e.id)||os.set(e.id,{}),os.get(e.id).endLeft=p,sg(c,e.endLabelLeft)}if(e.endLabelRight){const d=await ku(e.endLabelRight,Qm(e.labelStyle)),p=t.insert("g").attr("class","edgeTerminals"),g=p.insert("g").attr("class","inner");c=g.node().appendChild(d);const m=d.getBBox();g.attr("transform","translate("+-m.width/2+", "+-m.height/2+")"),p.node().appendChild(d),os.get(e.id)||os.set(e.id,{}),os.get(e.id).endRight=p,sg(c,e.endLabelRight)}return a},"insertEdgeLabel");function sg(t,e){In().flowchart.htmlLabels&&t&&(t.style.width=e.length*9+"px",t.style.height="12px")}L(sg,"setTerminalWidth");var vge=L((t,e)=>{wt.debug("Moving label abc88 ",t.id,t.label,Cy.get(t.id),e);let r=e.updatedPath?e.updatedPath:e.originalPath;const n=In(),{subGraphTitleTotalMargin:a}=_k(n);if(t.label){const s=Cy.get(t.id);let i=t.x,l=t.y;if(r){const c=ho.calcLabelPosition(r);wt.debug("Moving label "+t.label+" from (",i,",",l,") to (",c.x,",",c.y,") abc88"),e.updatedPath&&(i=c.x,l=c.y)}s.attr("transform",`translate(${i}, ${l+a/2})`)}if(t.startLabelLeft){const s=os.get(t.id).startLeft;let i=t.x,l=t.y;if(r){const c=ho.calcTerminalLabelPosition(t.arrowTypeStart?10:0,"start_left",r);i=c.x,l=c.y}s.attr("transform",`translate(${i}, ${l})`)}if(t.startLabelRight){const s=os.get(t.id).startRight;let i=t.x,l=t.y;if(r){const c=ho.calcTerminalLabelPosition(t.arrowTypeStart?10:0,"start_right",r);i=c.x,l=c.y}s.attr("transform",`translate(${i}, ${l})`)}if(t.endLabelLeft){const s=os.get(t.id).endLeft;let i=t.x,l=t.y;if(r){const c=ho.calcTerminalLabelPosition(t.arrowTypeEnd?10:0,"end_left",r);i=c.x,l=c.y}s.attr("transform",`translate(${i}, ${l})`)}if(t.endLabelRight){const s=os.get(t.id).endRight;let i=t.x,l=t.y;if(r){const c=ho.calcTerminalLabelPosition(t.arrowTypeEnd?10:0,"end_right",r);i=c.x,l=c.y}s.attr("transform",`translate(${i}, ${l})`)}},"positionEdgeLabel"),wge=L((t,e)=>{const r=t.x,n=t.y,a=Math.abs(e.x-r),s=Math.abs(e.y-n),i=t.width/2,l=t.height/2;return a>=i||s>=l},"outsideNode"),Sge=L((t,e,r)=>{wt.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(e)}
  insidePoint : ${JSON.stringify(r)}
  node        : x:${t.x} y:${t.y} w:${t.width} h:${t.height}`);const n=t.x,a=t.y,s=Math.abs(n-r.x),i=t.width/2;let l=r.x<e.x?i-s:i+s;const c=t.height/2,d=Math.abs(e.y-r.y),p=Math.abs(e.x-r.x);if(Math.abs(a-e.y)*i>Math.abs(n-e.x)*c){let g=r.y<e.y?e.y-c-a:a-c-e.y;l=p*g/d;const m={x:r.x<e.x?r.x+l:r.x-p+l,y:r.y<e.y?r.y+d-g:r.y-d+g};return l===0&&(m.x=e.x,m.y=e.y),p===0&&(m.x=e.x),d===0&&(m.y=e.y),wt.debug(`abc89 top/bottom calc, Q ${d}, q ${g}, R ${p}, r ${l}`,m),m}else{r.x<e.x?l=e.x-i-n:l=n-i-e.x;let g=d*l/p,m=r.x<e.x?r.x+p-l:r.x-p+l,y=r.y<e.y?r.y+g:r.y-g;return wt.debug(`sides calc abc89, Q ${d}, q ${g}, R ${p}, r ${l}`,{_x:m,_y:y}),l===0&&(m=e.x,y=e.y),p===0&&(m=e.x),d===0&&(y=e.y),{x:m,y}}},"intersection"),y3=L((t,e)=>{wt.warn("abc88 cutPathAtIntersect",t,e);let r=[],n=t[0],a=!1;return t.forEach(s=>{if(wt.info("abc88 checking point",s,e),!wge(e,s)&&!a){const i=Sge(e,n,s);wt.debug("abc88 inside",s,n,i),wt.debug("abc88 intersection",i,e);let l=!1;r.forEach(c=>{l=l||c.x===i.x&&c.y===i.y}),r.some(c=>c.x===i.x&&c.y===i.y)?wt.warn("abc88 no intersect",i,r):r.push(i),a=!0}else wt.warn("abc88 outside",s,n),n=s,a||r.push(s)}),wt.debug("returning points",r),r},"cutPathAtIntersect");function f5(t){const e=[],r=[];for(let n=1;n<t.length-1;n++){const a=t[n-1],s=t[n],i=t[n+1];(a.x===s.x&&s.y===i.y&&Math.abs(s.x-i.x)>5&&Math.abs(s.y-a.y)>5||a.y===s.y&&s.x===i.x&&Math.abs(s.x-a.x)>5&&Math.abs(s.y-i.y)>5)&&(e.push(s),r.push(n))}return{cornerPoints:e,cornerPointPositions:r}}L(f5,"extractCornerPoints");var b3=L(function(t,e,r){const n=e.x-t.x,a=e.y-t.y,s=Math.sqrt(n*n+a*a),i=r/s;return{x:e.x-i*n,y:e.y-i*a}},"findAdjacentPoint"),kge=L(function(t){const{cornerPointPositions:e}=f5(t),r=[];for(let n=0;n<t.length;n++)if(e.includes(n)){const a=t[n-1],s=t[n+1],i=t[n],l=b3(a,i,5),c=b3(s,i,5),d=c.x-l.x,p=c.y-l.y;r.push(l);const g=Math.sqrt(2)*2;let m={x:i.x,y:i.y};if(Math.abs(s.x-a.x)>10&&Math.abs(s.y-a.y)>=10){wt.debug("Corner point fixing",Math.abs(s.x-a.x),Math.abs(s.y-a.y));const y=5;i.x===l.x?m={x:d<0?l.x-y+g:l.x+y-g,y:p<0?l.y-g:l.y+g}:m={x:d<0?l.x-g:l.x+g,y:p<0?l.y-y+g:l.y+y-g}}else wt.debug("Corner point skipping fixing",Math.abs(s.x-a.x),Math.abs(s.y-a.y));r.push(m,c)}else r.push(t[n]);return r},"fixCorners"),Tge=L((t,e,r)=>{const n=t-e-r,a=2,s=2,i=a+s,l=Math.floor(n/i),c=Array(l).fill(`${a} ${s}`).join(" ");return`0 ${e} ${c} ${r}`},"generateDashArray"),Cge=L(function(t,e,r,n,a,s,i,l=!1){const{handDrawnSeed:c}=In();let d=e.points,p=!1;const g=a;var m=s;const y=[];for(const Q in e.cssCompiledStyles)V4(Q)||y.push(e.cssCompiledStyles[Q]);wt.debug("UIO intersect check",e.points,m.x,g.x),m.intersect&&g.intersect&&!l&&(d=d.slice(1,e.points.length-1),d.unshift(g.intersect(d[0])),wt.debug("Last point UIO",e.start,"-->",e.end,d[d.length-1],m,m.intersect(d[d.length-1])),d.push(m.intersect(d[d.length-1])));const x=btoa(JSON.stringify(d));e.toCluster&&(wt.info("to cluster abc88",r.get(e.toCluster)),d=y3(e.points,r.get(e.toCluster).node),p=!0),e.fromCluster&&(wt.debug("from cluster abc88",r.get(e.fromCluster),JSON.stringify(d,null,2)),d=y3(d.reverse(),r.get(e.fromCluster).node).reverse(),p=!0);let w=d.filter(Q=>!Number.isNaN(Q.y));w=kge(w);let T=f0;switch(T=ry,e.curve){case"linear":T=ry;break;case"basis":T=f0;break;case"cardinal":T=KL;break;case"bumpX":T=GL;break;case"bumpY":T=VL;break;case"catmullRom":T=JL;break;case"monotoneX":T=aM;break;case"monotoneY":T=sM;break;case"natural":T=oM;break;case"step":T=lM;break;case"stepAfter":T=uM;break;case"stepBefore":T=cM;break;default:T=f0}const{x:k,y:_}=Sce(e),P=sle().x(k).y(_).curve(T);let F;switch(e.thickness){case"normal":F="edge-thickness-normal";break;case"thick":F="edge-thickness-thick";break;case"invisible":F="edge-thickness-invisible";break;default:F="edge-thickness-normal"}switch(e.pattern){case"solid":F+=" edge-pattern-solid";break;case"dotted":F+=" edge-pattern-dotted";break;case"dashed":F+=" edge-pattern-dashed";break;default:F+=" edge-pattern-solid"}let D,B=e.curve==="rounded"?m5(y5(w,e),5):P(w);const M=Array.isArray(e.style)?e.style:[e.style];let $=M.find(Q=>Q?.startsWith("stroke:")),Z=!1;if(e.look==="handDrawn"){const Q=hr.svg(t);Object.assign([],w);const W=Q.path(B,{roughness:.3,seed:c});F+=" transition",D=wn(W).select("path").attr("id",e.id).attr("class"," "+F+(e.classes?" "+e.classes:"")).attr("style",M?M.reduce((re,ne)=>re+";"+ne,""):"");let H=D.attr("d");D.attr("d",H),t.node().appendChild(D.node())}else{const Q=y.join(";"),W=M?M.reduce((K,U)=>K+U+";",""):"";let H="";e.animate&&(H=" edge-animation-fast"),e.animation&&(H=" edge-animation-"+e.animation);const re=(Q?Q+";"+W+";":W)+";"+(M?M.reduce((K,U)=>K+";"+U,""):"");D=t.append("path").attr("d",B).attr("id",e.id).attr("class"," "+F+(e.classes?" "+e.classes:"")+(H??"")).attr("style",re),$=re.match(/stroke:([^;]+)/)?.[1],Z=e.animate===!0||!!e.animation||Q.includes("animation");const ne=D.node(),ve=typeof ne.getTotalLength=="function"?ne.getTotalLength():0,O=MN[e.arrowTypeStart]||0,I=MN[e.arrowTypeEnd]||0;if(e.look==="neo"&&!Z){const U=`stroke-dasharray: ${e.pattern==="dotted"||e.pattern==="dashed"?Tge(ve,O,I):`0 ${O} ${ve-O-I} ${I}`}; stroke-dashoffset: 0;`;D.attr("style",U+D.attr("style"))}}D.attr("data-edge",!0),D.attr("data-et","edge"),D.attr("data-id",e.id),D.attr("data-points",x),e.showPoints&&w.forEach(Q=>{t.append("circle").style("stroke","red").style("fill","red").attr("r",1).attr("cx",Q.x).attr("cy",Q.y)});let z="";(In().flowchart.arrowMarkerAbsolute||In().state.arrowMarkerAbsolute)&&(z=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,z=z.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),wt.info("arrowTypeStart",e.arrowTypeStart),wt.info("arrowTypeEnd",e.arrowTypeEnd),yge(D,e,z,i,n,$);const ee=Math.floor(d.length/2),te=d[ee];ho.isLabelCoordinateInPath(te,D.attr("d"))||(p=!0);let X={};return p&&(X.updatedPath=d),X.originalPath=e.points,X},"insertEdge");function m5(t,e){if(t.length<2)return"";let r="";const n=t.length,a=1e-5;for(let s=0;s<n;s++){const i=t[s],l=t[s-1],c=t[s+1];if(s===0)r+=`M${i.x},${i.y}`;else if(s===n-1)r+=`L${i.x},${i.y}`;else{const d=i.x-l.x,p=i.y-l.y,g=c.x-i.x,m=c.y-i.y,y=Math.hypot(d,p),x=Math.hypot(g,m);if(y<a||x<a){r+=`L${i.x},${i.y}`;continue}const w=d/y,T=p/y,k=g/x,_=m/x,P=w*k+T*_,F=Math.max(-1,Math.min(1,P)),D=Math.acos(F);if(D<a||Math.abs(Math.PI-D)<a){r+=`L${i.x},${i.y}`;continue}const B=Math.min(e/Math.sin(D/2),y/2,x/2),M=i.x-w*B,$=i.y-T*B,Z=i.x+k*B,z=i.y+_*B;r+=`L${M},${$}`,r+=`Q${i.x},${i.y} ${Z},${z}`}}return r}L(m5,"generateRoundedPath");function sS(t,e){if(!t||!e)return{angle:0,deltaX:0,deltaY:0};const r=e.x-t.x,n=e.y-t.y;return{angle:Math.atan2(n,r),deltaX:r,deltaY:n}}L(sS,"calculateDeltaAndAngle");function y5(t,e){const r=t.map(a=>({...a}));if(t.length>=2&&fs[e.arrowTypeStart]){const a=fs[e.arrowTypeStart],s=t[0],i=t[1],{angle:l}=sS(s,i),c=a*Math.cos(l),d=a*Math.sin(l);r[0].x=s.x+c,r[0].y=s.y+d}const n=t.length;if(n>=2&&fs[e.arrowTypeEnd]){const a=fs[e.arrowTypeEnd],s=t[n-1],i=t[n-2],{angle:l}=sS(i,s),c=a*Math.cos(l),d=a*Math.sin(l);r[n-1].x=s.x-c,r[n-1].y=s.y-d}return r}L(y5,"applyMarkerOffsetsToPoints");var Ege=L((t,e,r,n)=>{e.forEach(a=>{Uge[a](t,r,n)})},"insertMarkers"),_ge=L((t,e,r)=>{wt.trace("Making markers for ",r),t.append("defs").append("marker").attr("id",r+"_"+e+"-extensionStart").attr("class","marker extension "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),t.append("defs").append("marker").attr("id",r+"_"+e+"-extensionEnd").attr("class","marker extension "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),Age=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-compositionStart").attr("class","marker composition "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",r+"_"+e+"-compositionEnd").attr("class","marker composition "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),Nge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-aggregationStart").attr("class","marker aggregation "+e).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",r+"_"+e+"-aggregationEnd").attr("class","marker aggregation "+e).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),Pge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-dependencyStart").attr("class","marker dependency "+e).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),t.append("defs").append("marker").attr("id",r+"_"+e+"-dependencyEnd").attr("class","marker dependency "+e).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),Ige=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-lollipopStart").attr("class","marker lollipop "+e).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),t.append("defs").append("marker").attr("id",r+"_"+e+"-lollipopEnd").attr("class","marker lollipop "+e).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),Rge=L((t,e,r)=>{t.append("marker").attr("id",r+"_"+e+"-pointEnd").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),t.append("marker").attr("id",r+"_"+e+"-pointStart").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),Dge=L((t,e,r)=>{t.append("marker").attr("id",r+"_"+e+"-circleEnd").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),t.append("marker").attr("id",r+"_"+e+"-circleStart").attr("class","marker "+e).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),Lge=L((t,e,r)=>{t.append("marker").attr("id",r+"_"+e+"-crossEnd").attr("class","marker cross "+e).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),t.append("marker").attr("id",r+"_"+e+"-crossStart").attr("class","marker cross "+e).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),Mge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),Oge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-onlyOneStart").attr("class","marker onlyOne "+e).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),t.append("defs").append("marker").attr("id",r+"_"+e+"-onlyOneEnd").attr("class","marker onlyOne "+e).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),jge=L((t,e,r)=>{const n=t.append("defs").append("marker").attr("id",r+"_"+e+"-zeroOrOneStart").attr("class","marker zeroOrOne "+e).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");n.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),n.append("path").attr("d","M9,0 L9,18");const a=t.append("defs").append("marker").attr("id",r+"_"+e+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+e).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");a.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),a.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),Bge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-oneOrMoreStart").attr("class","marker oneOrMore "+e).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),t.append("defs").append("marker").attr("id",r+"_"+e+"-oneOrMoreEnd").attr("class","marker oneOrMore "+e).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),Fge=L((t,e,r)=>{const n=t.append("defs").append("marker").attr("id",r+"_"+e+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+e).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");n.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),n.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const a=t.append("defs").append("marker").attr("id",r+"_"+e+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+e).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");a.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),a.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),zge=L((t,e,r)=>{t.append("defs").append("marker").attr("id",r+"_"+e+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),$ge=L((t,e,r)=>{const n=t.append("defs").append("marker").attr("id",r+"_"+e+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");n.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),n.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),n.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),Uge={extension:_ge,composition:Age,aggregation:Nge,dependency:Pge,lollipop:Ige,point:Rge,circle:Dge,cross:Lge,barb:Mge,only_one:Oge,zero_or_one:jge,one_or_more:Bge,zero_or_more:Fge,requirement_arrow:zge,requirement_contains:$ge},qge=Ege,Hge={common:Dh,getConfig:bs,insertCluster:Jpe,insertEdge:Cge,insertEdgeLabel:xge,insertMarkers:qge,insertNode:g5,interpolateToCurve:Rk,labelHelper:Dr,log:wt,positionEdgeLabel:vge},Wg={},b5=L(t=>{for(const e of t)Wg[e.name]=e},"registerLayoutLoaders"),Gge=L(()=>{b5([{name:"dagre",loader:L(async()=>await Zt(()=>import("./dagre-6UL2VRFP-C8fUn5EQ.js"),__vite__mapDeps([5,6,7,8,9,10])),"loader")},{name:"cose-bilkent",loader:L(async()=>await Zt(()=>import("./cose-bilkent-S5V4N54A-BkfD0FQ4.js"),__vite__mapDeps([11,12])),"loader")}])},"registerDefaultLayoutLoaders");Gge();var fve=L(async(t,e)=>{if(!(t.layoutAlgorithm in Wg))throw new Error(`Unknown layout algorithm: ${t.layoutAlgorithm}`);const r=Wg[t.layoutAlgorithm];return(await r.loader()).render(t,e,Hge,{algorithm:r.algorithm})},"render"),mve=L((t="",{fallback:e="dagre"}={})=>{if(t in Wg)return t;if(e in Wg)return wt.warn(`Layout algorithm ${t} is not registered. Using ${e} as fallback.`),e;throw new Error(`Both layout algorithms ${t} and ${e} are not registered.`)},"getRegisteredLayoutAlgorithm"),x5="comm",v5="rule",w5="decl",Vge="@import",Wge="@namespace",Yge="@keyframes",Qge="@layer",S5=Math.abs,Jk=String.fromCharCode;function k5(t){return t.trim()}function v0(t,e,r){return t.replace(e,r)}function Kge(t,e,r){return t.indexOf(e,r)}function th(t,e){return t.charCodeAt(e)|0}function wh(t,e,r){return t.slice(e,r)}function qo(t){return t.length}function Xge(t){return t.length}function Km(t,e){return e.push(t),t}var bb=1,Sh=1,T5=0,Ki=0,Oa=0,Bh="";function Zk(t,e,r,n,a,s,i,l){return{value:t,root:e,parent:r,type:n,props:a,children:s,line:bb,column:Sh,length:i,return:"",siblings:l}}function Jge(){return Oa}function Zge(){return Oa=Ki>0?th(Bh,--Ki):0,Sh--,Oa===10&&(Sh=1,bb--),Oa}function yo(){return Oa=Ki<T5?th(Bh,Ki++):0,Sh++,Oa===10&&(Sh=1,bb++),Oa}function _c(){return th(Bh,Ki)}function w0(){return Ki}function xb(t,e){return wh(Bh,t,e)}function Yg(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function efe(t){return bb=Sh=1,T5=qo(Bh=t),Ki=0,[]}function tfe(t){return Bh="",t}function mw(t){return k5(xb(Ki-1,iS(t===91?t+2:t===40?t+1:t)))}function rfe(t){for(;(Oa=_c())&&Oa<33;)yo();return Yg(t)>2||Yg(Oa)>3?"":" "}function nfe(t,e){for(;--e&&yo()&&!(Oa<48||Oa>102||Oa>57&&Oa<65||Oa>70&&Oa<97););return xb(t,w0()+(e<6&&_c()==32&&yo()==32))}function iS(t){for(;yo();)switch(Oa){case t:return Ki;case 34:case 39:t!==34&&t!==39&&iS(Oa);break;case 40:t===41&&iS(t);break;case 92:yo();break}return Ki}function afe(t,e){for(;yo()&&t+Oa!==57;)if(t+Oa===84&&_c()===47)break;return"/*"+xb(e,Ki-1)+"*"+Jk(t===47?t:yo())}function sfe(t){for(;!Yg(_c());)yo();return xb(t,Ki)}function ife(t){return tfe(S0("",null,null,null,[""],t=efe(t),0,[0],t))}function S0(t,e,r,n,a,s,i,l,c){for(var d=0,p=0,g=i,m=0,y=0,x=0,w=1,T=1,k=1,_=0,P="",F=a,D=s,B=n,M=P;T;)switch(x=_,_=yo()){case 40:if(x!=108&&th(M,g-1)==58){Kge(M+=v0(mw(_),"&","&\f"),"&\f",S5(d?l[d-1]:0))!=-1&&(k=-1);break}case 34:case 39:case 91:M+=mw(_);break;case 9:case 10:case 13:case 32:M+=rfe(x);break;case 92:M+=nfe(w0()-1,7);continue;case 47:switch(_c()){case 42:case 47:Km(ofe(afe(yo(),w0()),e,r,c),c),(Yg(x||1)==5||Yg(_c()||1)==5)&&qo(M)&&wh(M,-1,void 0)!==" "&&(M+=" ");break;default:M+="/"}break;case 123*w:l[d++]=qo(M)*k;case 125*w:case 59:case 0:switch(_){case 0:case 125:T=0;case 59+p:k==-1&&(M=v0(M,/\f/g,"")),y>0&&(qo(M)-g||w===0&&x===47)&&Km(y>32?v3(M+";",n,r,g-1,c):v3(v0(M," ","")+";",n,r,g-2,c),c);break;case 59:M+=";";default:if(Km(B=x3(M,e,r,d,p,a,l,P,F=[],D=[],g,s),s),_===123)if(p===0)S0(M,e,B,B,F,s,g,l,D);else{switch(m){case 99:if(th(M,3)===110)break;case 108:if(th(M,2)===97)break;default:p=0;case 100:case 109:case 115:}p?S0(t,B,B,n&&Km(x3(t,B,B,0,0,a,l,P,a,F=[],g,D),D),a,D,g,l,n?F:D):S0(M,B,B,B,[""],D,0,l,D)}}d=p=y=0,w=k=1,P=M="",g=i;break;case 58:g=1+qo(M),y=x;default:if(w<1){if(_==123)--w;else if(_==125&&w++==0&&Zge()==125)continue}switch(M+=Jk(_),_*w){case 38:k=p>0?1:(M+="\f",-1);break;case 44:l[d++]=(qo(M)-1)*k,k=1;break;case 64:_c()===45&&(M+=mw(yo())),m=_c(),p=g=qo(P=M+=sfe(w0())),_++;break;case 45:x===45&&qo(M)==2&&(w=0)}}return s}function x3(t,e,r,n,a,s,i,l,c,d,p,g){for(var m=a-1,y=a===0?s:[""],x=Xge(y),w=0,T=0,k=0;w<n;++w)for(var _=0,P=wh(t,m+1,m=S5(T=i[w])),F=t;_<x;++_)(F=k5(T>0?y[_]+" "+P:v0(P,/&\f/g,y[_])))&&(c[k++]=F);return Zk(t,e,r,a===0?v5:l,c,d,p,g)}function ofe(t,e,r,n){return Zk(t,e,r,x5,Jk(Jge()),wh(t,2,-2),0,n)}function v3(t,e,r,n,a){return Zk(t,e,r,w5,wh(t,0,n),wh(t,n+1,-1),n,a)}function oS(t,e){for(var r="",n=0;n<t.length;n++)r+=e(t[n],n,t,e)||"";return r}function lfe(t,e,r,n){switch(t.type){case Qge:if(t.children.length)break;case Vge:case Wge:case w5:return t.return=t.return||t.value;case x5:return"";case Yge:return t.return=t.value+"{"+oS(t.children,n)+"}";case v5:if(!qo(t.value=t.props.join(",")))return""}return qo(r=oS(t.children,n))?t.return=t.value+"{"+r+"}":""}var cfe=K4(Object.keys,Object),ufe=Object.prototype,dfe=ufe.hasOwnProperty;function hfe(t){if(!lb(t))return cfe(t);var e=[];for(var r in Object(t))dfe.call(t,r)&&r!="constructor"&&e.push(r);return e}var lS=Vu(rl,"DataView"),cS=Vu(rl,"Promise"),uS=Vu(rl,"Set"),dS=Vu(rl,"WeakMap"),w3="[object Map]",pfe="[object Object]",S3="[object Promise]",k3="[object Set]",T3="[object WeakMap]",C3="[object DataView]",gfe=Gu(lS),ffe=Gu(Gg),mfe=Gu(cS),yfe=Gu(uS),bfe=Gu(dS),mu=Mh;(lS&&mu(new lS(new ArrayBuffer(1)))!=C3||Gg&&mu(new Gg)!=w3||cS&&mu(cS.resolve())!=S3||uS&&mu(new uS)!=k3||dS&&mu(new dS)!=T3)&&(mu=function(t){var e=Mh(t),r=e==pfe?t.constructor:void 0,n=r?Gu(r):"";if(n)switch(n){case gfe:return C3;case ffe:return w3;case mfe:return S3;case yfe:return k3;case bfe:return T3}return e});var xfe="[object Map]",vfe="[object Set]",wfe=Object.prototype,Sfe=wfe.hasOwnProperty;function E3(t){if(t==null)return!0;if(cb(t)&&(fy(t)||typeof t=="string"||typeof t.splice=="function"||Pk(t)||Ik(t)||gy(t)))return!t.length;var e=mu(t);if(e==xfe||e==vfe)return!t.size;if(lb(t))return!hfe(t).length;for(var r in t)if(Sfe.call(t,r))return!1;return!0}var C5="c4",kfe=L(t=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(t),"detector"),Tfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./c4Diagram-YG6GDRKO-DrSPZLYj.js");return{diagram:e}},__vite__mapDeps([13,14]));return{id:C5,diagram:t}},"loader"),Cfe={id:C5,detector:kfe,loader:Tfe},Efe=Cfe,E5="flowchart",_fe=L((t,e)=>e?.flowchart?.defaultRenderer==="dagre-wrapper"||e?.flowchart?.defaultRenderer==="elk"?!1:/^\s*graph/.test(t),"detector"),Afe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./flowDiagram-NV44I4VS-I8YGEdNz.js");return{diagram:e}},__vite__mapDeps([15,16,17,18,19]));return{id:E5,diagram:t}},"loader"),Nfe={id:E5,detector:_fe,loader:Afe},Pfe=Nfe,_5="flowchart-v2",Ife=L((t,e)=>e?.flowchart?.defaultRenderer==="dagre-d3"?!1:(e?.flowchart?.defaultRenderer==="elk"&&(e.layout="elk"),/^\s*graph/.test(t)&&e?.flowchart?.defaultRenderer==="dagre-wrapper"?!0:/^\s*flowchart/.test(t)),"detector"),Rfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./flowDiagram-NV44I4VS-I8YGEdNz.js");return{diagram:e}},__vite__mapDeps([15,16,17,18,19]));return{id:_5,diagram:t}},"loader"),Dfe={id:_5,detector:Ife,loader:Rfe},Lfe=Dfe,A5="er",Mfe=L(t=>/^\s*erDiagram/.test(t),"detector"),Ofe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./erDiagram-Q2GNP2WA-C0OwjZqH.js");return{diagram:e}},__vite__mapDeps([20,17,18,19]));return{id:A5,diagram:t}},"loader"),jfe={id:A5,detector:Mfe,loader:Ofe},Bfe=jfe,N5="gitGraph",Ffe=L(t=>/^\s*gitGraph/.test(t),"detector"),zfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./gitGraphDiagram-NY62KEGX-Bf8-7ukw.js");return{diagram:e}},__vite__mapDeps([21,22,23,24,7,9,10]));return{id:N5,diagram:t}},"loader"),$fe={id:N5,detector:Ffe,loader:zfe},Ufe=$fe,P5="gantt",qfe=L(t=>/^\s*gantt/.test(t),"detector"),Hfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./ganttDiagram-LVOFAZNH-lgv3C4vH.js");return{diagram:e}},__vite__mapDeps([25,26,27,28]));return{id:P5,diagram:t}},"loader"),Gfe={id:P5,detector:qfe,loader:Hfe},Vfe=Gfe,I5="info",Wfe=L(t=>/^\s*info/.test(t),"detector"),Yfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./infoDiagram-ER5ION4S-4Vvq_qi5.js");return{diagram:e}},__vite__mapDeps([29,24,7,9,10]));return{id:I5,diagram:t}},"loader"),Qfe={id:I5,detector:Wfe,loader:Yfe},R5="pie",Kfe=L(t=>/^\s*pie/.test(t),"detector"),Xfe=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./pieDiagram-ADFJNKIX-B9vZy7N4.js");return{diagram:e}},__vite__mapDeps([30,22,24,7,9,10,31,32,27]));return{id:R5,diagram:t}},"loader"),Jfe={id:R5,detector:Kfe,loader:Xfe},D5="quadrantChart",Zfe=L(t=>/^\s*quadrantChart/.test(t),"detector"),eme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./quadrantDiagram-AYHSOK5B-0pxOt2Y5.js");return{diagram:e}},__vite__mapDeps([33,26,27,28]));return{id:D5,diagram:t}},"loader"),tme={id:D5,detector:Zfe,loader:eme},rme=tme,L5="xychart",nme=L(t=>/^\s*xychart(-beta)?/.test(t),"detector"),ame=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./xychartDiagram-PRI3JC2R-DDGSKkFQ.js");return{diagram:e}},__vite__mapDeps([34,27,32,26,28]));return{id:L5,diagram:t}},"loader"),sme={id:L5,detector:nme,loader:ame},ime=sme,M5="requirement",ome=L(t=>/^\s*requirement(Diagram)?/.test(t),"detector"),lme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./requirementDiagram-UZGBJVZJ-BWU2n5RW.js");return{diagram:e}},__vite__mapDeps([35,17,18]));return{id:M5,diagram:t}},"loader"),cme={id:M5,detector:ome,loader:lme},ume=cme,O5="sequence",dme=L(t=>/^\s*sequenceDiagram/.test(t),"detector"),hme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./sequenceDiagram-WL72ISMW-BmpULOhB.js");return{diagram:e}},__vite__mapDeps([36,14,23]));return{id:O5,diagram:t}},"loader"),pme={id:O5,detector:dme,loader:hme},gme=pme,j5="class",fme=L((t,e)=>e?.class?.defaultRenderer==="dagre-wrapper"?!1:/^\s*classDiagram/.test(t),"detector"),mme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./classDiagram-2ON5EDUG-BGdlxuoR.js");return{diagram:e}},__vite__mapDeps([37,38,16,17,18]));return{id:j5,diagram:t}},"loader"),yme={id:j5,detector:fme,loader:mme},bme=yme,B5="classDiagram",xme=L((t,e)=>/^\s*classDiagram/.test(t)&&e?.class?.defaultRenderer==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(t),"detector"),vme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./classDiagram-v2-WZHVMYZB-BGdlxuoR.js");return{diagram:e}},__vite__mapDeps([39,38,16,17,18]));return{id:B5,diagram:t}},"loader"),wme={id:B5,detector:xme,loader:vme},Sme=wme,F5="state",kme=L((t,e)=>e?.state?.defaultRenderer==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(t),"detector"),Tme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./stateDiagram-FKZM4ZOC-DuWb9AjL.js");return{diagram:e}},__vite__mapDeps([40,41,17,18,6,7,8,9]));return{id:F5,diagram:t}},"loader"),Cme={id:F5,detector:kme,loader:Tme},Eme=Cme,z5="stateDiagram",_me=L((t,e)=>!!(/^\s*stateDiagram-v2/.test(t)||/^\s*stateDiagram/.test(t)&&e?.state?.defaultRenderer==="dagre-wrapper"),"detector"),Ame=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./stateDiagram-v2-4FDKWEC3-FMNcHS7x.js");return{diagram:e}},__vite__mapDeps([42,41,17,18]));return{id:z5,diagram:t}},"loader"),Nme={id:z5,detector:_me,loader:Ame},Pme=Nme,$5="journey",Ime=L(t=>/^\s*journey/.test(t),"detector"),Rme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./journeyDiagram-XKPGCS4Q-CQME5Dyx.js");return{diagram:e}},__vite__mapDeps([43,14,16,31]));return{id:$5,diagram:t}},"loader"),Dme={id:$5,detector:Ime,loader:Rme},Lme=Dme,Mme=L((t,e,r)=>{wt.debug(`rendering svg for syntax error
`);const n=gle(e),a=n.append("g");n.attr("viewBox","0 0 2412 512"),gL(n,100,512,!0),a.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),a.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),a.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),a.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),a.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),a.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),a.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),a.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${r}`)},"draw"),U5={draw:Mme},Ome=U5,jme={db:{},renderer:U5,parser:{parse:L(()=>{},"parse")}},Bme=jme,q5="flowchart-elk",Fme=L((t,e={})=>/^\s*flowchart-elk/.test(t)||/^\s*(flowchart|graph)/.test(t)&&e?.flowchart?.defaultRenderer==="elk"?(e.layout="elk",!0):!1,"detector"),zme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./flowDiagram-NV44I4VS-I8YGEdNz.js");return{diagram:e}},__vite__mapDeps([15,16,17,18,19]));return{id:q5,diagram:t}},"loader"),$me={id:q5,detector:Fme,loader:zme},Ume=$me,H5="timeline",qme=L(t=>/^\s*timeline/.test(t),"detector"),Hme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./timeline-definition-IT6M3QCI-DzkVFeOB.js");return{diagram:e}},__vite__mapDeps([44,31]));return{id:H5,diagram:t}},"loader"),Gme={id:H5,detector:qme,loader:Hme},Vme=Gme,G5="mindmap",Wme=L(t=>/^\s*mindmap/.test(t),"detector"),Yme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./mindmap-definition-VGOIOE7T-wwdUAZDS.js");return{diagram:e}},__vite__mapDeps([45,17,18]));return{id:G5,diagram:t}},"loader"),Qme={id:G5,detector:Wme,loader:Yme},Kme=Qme,V5="kanban",Xme=L(t=>/^\s*kanban/.test(t),"detector"),Jme=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./kanban-definition-3W4ZIXB7-DLKiBjLb.js");return{diagram:e}},__vite__mapDeps([46,16]));return{id:V5,diagram:t}},"loader"),Zme={id:V5,detector:Xme,loader:Jme},e0e=Zme,W5="sankey",t0e=L(t=>/^\s*sankey(-beta)?/.test(t),"detector"),r0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./sankeyDiagram-TZEHDZUN-7CsYBkdB.js");return{diagram:e}},__vite__mapDeps([47,32,27]));return{id:W5,diagram:t}},"loader"),n0e={id:W5,detector:t0e,loader:r0e},a0e=n0e,Y5="packet",s0e=L(t=>/^\s*packet(-beta)?/.test(t),"detector"),i0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./diagram-S2PKOQOG-Bee4dERD.js");return{diagram:e}},__vite__mapDeps([48,22,24,7,9,10]));return{id:Y5,diagram:t}},"loader"),o0e={id:Y5,detector:s0e,loader:i0e},Q5="radar",l0e=L(t=>/^\s*radar-beta/.test(t),"detector"),c0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./diagram-QEK2KX5R-CaOH9FFA.js");return{diagram:e}},__vite__mapDeps([49,22,24,7,9,10]));return{id:Q5,diagram:t}},"loader"),u0e={id:Q5,detector:l0e,loader:c0e},K5="block",d0e=L(t=>/^\s*block(-beta)?/.test(t),"detector"),h0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./blockDiagram-VD42YOAC-DJyg46GX.js");return{diagram:e}},__vite__mapDeps([50,16,10,7,6,19]));return{id:K5,diagram:t}},"loader"),p0e={id:K5,detector:d0e,loader:h0e},g0e=p0e,X5="architecture",f0e=L(t=>/^\s*architecture/.test(t),"detector"),m0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./architectureDiagram-VXUJARFQ-pnmSoS_n.js");return{diagram:e}},__vite__mapDeps([51,22,24,7,9,10,12]));return{id:X5,diagram:t}},"loader"),y0e={id:X5,detector:f0e,loader:m0e},b0e=y0e,J5="treemap",x0e=L(t=>/^\s*treemap/.test(t),"detector"),v0e=L(async()=>{const{diagram:t}=await Zt(async()=>{const{diagram:e}=await import("./diagram-PSM6KHXK-BFnEm6TM.js");return{diagram:e}},__vite__mapDeps([52,18,22,24,7,9,10,28,32,27]));return{id:J5,diagram:t}},"loader"),w0e={id:J5,detector:x0e,loader:v0e},_3=!1,vb=L(()=>{_3||(_3=!0,Q0("error",Bme,t=>t.toLowerCase().trim()==="error"),Q0("---",{db:{clear:L(()=>{},"clear")},styles:{},renderer:{draw:L(()=>{},"draw")},parser:{parse:L(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:L(()=>null,"init")},t=>t.toLowerCase().trimStart().startsWith("---")),b1(Ume,Kme,b0e),b1(Efe,e0e,Sme,bme,Bfe,Vfe,Qfe,Jfe,ume,gme,Lfe,Pfe,Vme,Ufe,Pme,Eme,Lme,rme,a0e,o0e,ime,g0e,u0e,w0e))},"addDiagrams"),S0e=L(async()=>{wt.debug("Loading registered diagrams");const e=(await Promise.allSettled(Object.entries(Ru).map(async([r,{detector:n,loader:a}])=>{if(a)try{S1(r)}catch{try{const{diagram:s,id:i}=await a();Q0(i,s,n)}catch(s){throw wt.error(`Failed to load external diagram with key ${r}. Removing from detectors.`),delete Ru[r],s}}}))).filter(r=>r.status==="rejected");if(e.length>0){wt.error(`Failed to load ${e.length} external diagrams`);for(const r of e)wt.error(r);throw new Error(`Failed to load ${e.length} external diagrams`)}},"loadRegisteredDiagrams"),k0e="graphics-document document";function Z5(t,e){t.attr("role",k0e),e!==""&&t.attr("aria-roledescription",e)}L(Z5,"setA11yDiagramInfo");function ej(t,e,r,n){if(t.insert!==void 0){if(r){const a=`chart-desc-${n}`;t.attr("aria-describedby",a),t.insert("desc",":first-child").attr("id",a).text(r)}if(e){const a=`chart-title-${n}`;t.attr("aria-labelledby",a),t.insert("title",":first-child").attr("id",a).text(e)}}}L(ej,"addSVGa11yTitleDescription");var Au,hS=(Au=class{constructor(e,r,n,a,s){this.type=e,this.text=r,this.db=n,this.parser=a,this.renderer=s}static async fromText(e,r={}){const n=bs(),a=tk(e,n);e=vhe(e)+`
`;try{S1(a)}catch{const d=Hne(a);if(!d)throw new rL(`Diagram ${a} not found.`);const{id:p,diagram:g}=await d();Q0(p,g)}const{db:s,parser:i,renderer:l,init:c}=S1(a);return i.parser&&(i.parser.yy=s),s.clear?.(),c?.(n),r.title&&s.setDiagramTitle?.(r.title),await i.parse(e),new Au(a,e,s,i,l)}async render(e,r){await this.renderer.draw(this.text,e,r,this)}getParser(){return this.parser}getType(){return this.type}},L(Au,"Diagram"),Au),A3=[],T0e=L(()=>{A3.forEach(t=>{t()}),A3=[]},"attachFunctions"),C0e=L(t=>t.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function tj(t){const e=t.match(tL);if(!e)return{text:t,metadata:{}};let r=wce(e[1],{schema:vce})??{};r=typeof r=="object"&&!Array.isArray(r)?r:{};const n={};return r.displayMode&&(n.displayMode=r.displayMode.toString()),r.title&&(n.title=r.title.toString()),r.config&&(n.config=r.config),{text:t.slice(e[0].length),metadata:n}}L(tj,"extractFrontMatter");var E0e=L(t=>t.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(e,r,n)=>"<"+r+n.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),_0e=L(t=>{const{text:e,metadata:r}=tj(t),{displayMode:n,title:a,config:s={}}=r;return n&&(s.gantt||(s.gantt={}),s.gantt.displayMode=n),{title:a,config:s,text:e}},"processFrontmatter"),A0e=L(t=>{const e=ho.detectInit(t)??{},r=ho.detectDirective(t,"wrap");return Array.isArray(r)?e.wrap=r.some(({type:n})=>n==="wrap"):r?.type==="wrap"&&(e.wrap=!0),{text:ohe(t),directive:e}},"processDirectives");function eT(t){const e=E0e(t),r=_0e(e),n=A0e(r.text),a=jk(r.config,n.directive);return t=C0e(n.text),{code:t,title:r.title,config:a}}L(eT,"preprocessDiagram");function rj(t){const e=new TextEncoder().encode(t),r=Array.from(e,n=>String.fromCodePoint(n)).join("");return btoa(r)}L(rj,"toBase64");var N0e=5e4,P0e="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",I0e="sandbox",R0e="loose",D0e="http://www.w3.org/2000/svg",L0e="http://www.w3.org/1999/xlink",M0e="http://www.w3.org/1999/xhtml",O0e="100%",j0e="100%",B0e="border:0;margin:0;",F0e="margin:0",z0e="allow-top-navigation-by-user-activation allow-popups",$0e='The "iframe" tag is not supported by your browser.',U0e=["foreignobject"],q0e=["dominant-baseline"];function tT(t){const e=eT(t);return W0(),iae(e.config??{}),e}L(tT,"processAndSetConfigs");async function nj(t,e){vb();try{const{code:r,config:n}=tT(t);return{diagramType:(await sj(r)).type,config:n}}catch(r){if(e?.suppressErrors)return!1;throw r}}L(nj,"parse");var N3=L((t,e,r=[])=>`
.${t} ${e} { ${r.join(" !important; ")} !important; }`,"cssImportantStyles"),H0e=L((t,e=new Map)=>{let r="";if(t.themeCSS!==void 0&&(r+=`
${t.themeCSS}`),t.fontFamily!==void 0&&(r+=`
:root { --mermaid-font-family: ${t.fontFamily}}`),t.altFontFamily!==void 0&&(r+=`
:root { --mermaid-alt-font-family: ${t.altFontFamily}}`),e instanceof Map){const i=t.htmlLabels??t.flowchart?.htmlLabels?["> *","span"]:["rect","polygon","ellipse","circle","path"];e.forEach(l=>{E3(l.styles)||i.forEach(c=>{r+=N3(l.id,c,l.styles)}),E3(l.textStyles)||(r+=N3(l.id,"tspan",(l?.textStyles||[]).map(c=>c.replace("color","fill"))))})}return r},"createCssStyles"),G0e=L((t,e,r,n)=>{const a=H0e(t,r),s=Eae(e,a,t.themeVariables);return oS(ife(`${n}{${s}}`),lfe)},"createUserStyles"),V0e=L((t="",e,r)=>{let n=t;return!r&&!e&&(n=n.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),n=Wu(n),n=n.replace(/<br>/g,"<br/>"),n},"cleanUpSvgCode"),W0e=L((t="",e)=>{const r=e?.viewBox?.baseVal?.height?e.viewBox.baseVal.height+"px":j0e,n=rj(`<body style="${F0e}">${t}</body>`);return`<iframe style="width:${O0e};height:${r};${B0e}" src="data:text/html;charset=UTF-8;base64,${n}" sandbox="${z0e}">
  ${$0e}
</iframe>`},"putIntoIFrame"),P3=L((t,e,r,n,a)=>{const s=t.append("div");s.attr("id",r),n&&s.attr("style",n);const i=s.append("svg").attr("id",e).attr("width","100%").attr("xmlns",D0e);return a&&i.attr("xmlns:xlink",a),i.append("g"),t},"appendDivSvgG");function pS(t,e){return t.append("iframe").attr("id",e).attr("style","width: 100%; height: 100%;").attr("sandbox","")}L(pS,"sandboxedIframe");var Y0e=L((t,e,r,n)=>{t.getElementById(e)?.remove(),t.getElementById(r)?.remove(),t.getElementById(n)?.remove()},"removeExistingElements"),Q0e=L(async function(t,e,r){vb();const n=tT(e);e=n.code;const a=bs();wt.debug(a),e.length>(a?.maxTextSize??N0e)&&(e=P0e);const s="#"+t,i="i"+t,l="#"+i,c="d"+t,d="#"+c,p=L(()=>{const X=wn(m?l:d).node();X&&"remove"in X&&X.remove()},"removeTempElements");let g=wn("body");const m=a.securityLevel===I0e,y=a.securityLevel===R0e,x=a.fontFamily;if(r!==void 0){if(r&&(r.innerHTML=""),m){const te=pS(wn(r),i);g=wn(te.nodes()[0].contentDocument.body),g.node().style.margin=0}else g=wn(r);P3(g,t,c,`font-family: ${x}`,L0e)}else{if(Y0e(document,t,c,i),m){const te=pS(wn("body"),i);g=wn(te.nodes()[0].contentDocument.body),g.node().style.margin=0}else g=wn("body");P3(g,t,c)}let w,T;try{w=await hS.fromText(e,{title:n.title})}catch(te){if(a.suppressErrorRendering)throw p(),te;w=await hS.fromText("error"),T=te}const k=g.select(d).node(),_=w.type,P=k.firstChild,F=P.firstChild,D=w.renderer.getClasses?.(e,w),B=G0e(a,_,D,s),M=document.createElement("style");M.innerHTML=B,P.insertBefore(M,F);try{await w.renderer.draw(e,t,KA.version,w)}catch(te){throw a.suppressErrorRendering?p():Ome.draw(e,t,KA.version),te}const $=g.select(`${d} svg`),Z=w.db.getAccTitle?.(),z=w.db.getAccDescription?.();ij(_,$,Z,z),g.select(`[id="${t}"]`).selectAll("foreignobject > *").attr("xmlns",M0e);let ee=g.select(d).node().innerHTML;if(wt.debug("config.arrowMarkerAbsolute",a.arrowMarkerAbsolute),ee=V0e(ee,m,Wa(a.arrowMarkerAbsolute)),m){const te=g.select(d+" svg").node();ee=W0e(ee,te)}else y||(ee=gh.sanitize(ee,{ADD_TAGS:U0e,ADD_ATTR:q0e,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(T0e(),T)throw T;return p(),{diagramType:_,svg:ee,bindFunctions:w.db.bindFunctions}},"render");function aj(t={}){const e=Ga({},t);e?.fontFamily&&!e.themeVariables?.fontFamily&&(e.themeVariables||(e.themeVariables={}),e.themeVariables.fontFamily=e.fontFamily),aae(e),e?.theme&&e.theme in Il?e.themeVariables=Il[e.theme].getThemeVariables(e.themeVariables):e&&(e.themeVariables=Il.default.getThemeVariables(e.themeVariables));const r=typeof e=="object"?nae(e):oL();ek(r.logLevel),vb()}L(aj,"initialize");var sj=L((t,e={})=>{const{code:r}=eT(t);return hS.fromText(r,e)},"getDiagramFromText");function ij(t,e,r,n){Z5(e,t),ej(e,r,n,e.attr("id"))}L(ij,"addA11yInfo");var Bu=Object.freeze({render:Q0e,parse:nj,getDiagramFromText:sj,initialize:aj,getConfig:bs,setConfig:lL,getSiteConfig:oL,updateSiteConfig:sae,reset:L(()=>{W0()},"reset"),globalReset:L(()=>{W0(fh)},"globalReset"),defaultConfig:fh});ek(bs().logLevel);W0(bs());var K0e=L((t,e,r)=>{wt.warn(t),Ok(t)?(r&&r(t.str,t.hash),e.push({...t,message:t.str,error:t})):(r&&r(t),t instanceof Error&&e.push({str:t.message,message:t.message,hash:t.name,error:t}))},"handleError"),oj=L(async function(t={querySelector:".mermaid"}){try{await X0e(t)}catch(e){if(Ok(e)&&wt.error(e.str),Ol.parseError&&Ol.parseError(e),!t.suppressErrors)throw wt.error("Use the suppressErrors option to suppress these errors"),e}},"run"),X0e=L(async function({postRenderCallback:t,querySelector:e,nodes:r}={querySelector:".mermaid"}){const n=Bu.getConfig();wt.debug(`${t?"":"No "}Callback function found`);let a;if(r)a=r;else if(e)a=document.querySelectorAll(e);else throw new Error("Nodes and querySelector are both undefined");wt.debug(`Found ${a.length} diagrams`),n?.startOnLoad!==void 0&&(wt.debug("Start On Load: "+n?.startOnLoad),Bu.updateSiteConfig({startOnLoad:n?.startOnLoad}));const s=new ho.InitIDGenerator(n.deterministicIds,n.deterministicIDSeed);let i;const l=[];for(const c of Array.from(a)){if(wt.info("Rendering diagram: "+c.id),c.getAttribute("data-processed"))continue;c.setAttribute("data-processed","true");const d=`mermaid-${s.next()}`;i=c.innerHTML,i=AO(ho.entityDecode(i)).trim().replace(/<br\s*\/?>/gi,"<br/>");const p=ho.detectInit(i);p&&wt.debug("Detected early reinit: ",p);try{const{svg:g,bindFunctions:m}=await dj(d,i,c);c.innerHTML=g,t&&await t(d),m&&m(c)}catch(g){K0e(g,l,Ol.parseError)}}if(l.length>0)throw l[0]},"runThrowsErrors"),lj=L(function(t){Bu.initialize(t)},"initialize"),J0e=L(async function(t,e,r){wt.warn("mermaid.init is deprecated. Please use run instead."),t&&lj(t);const n={postRenderCallback:r,querySelector:".mermaid"};typeof e=="string"?n.querySelector=e:e&&(e instanceof HTMLElement?n.nodes=[e]:n.nodes=e),await oj(n)},"init"),Z0e=L(async(t,{lazyLoad:e=!0}={})=>{vb(),b1(...t),e===!1&&await S0e()},"registerExternalDiagrams"),cj=L(function(){if(Ol.startOnLoad){const{startOnLoad:t}=Bu.getConfig();t&&Ol.run().catch(e=>wt.error("Mermaid failed to initialize",e))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",cj,!1);var eye=L(function(t){Ol.parseError=t},"setParseErrorHandler"),Ey=[],yw=!1,uj=L(async()=>{if(!yw){for(yw=!0;Ey.length>0;){const t=Ey.shift();if(t)try{await t()}catch(e){wt.error("Error executing queue",e)}}yw=!1}},"executeQueue"),tye=L(async(t,e)=>new Promise((r,n)=>{const a=L(()=>new Promise((s,i)=>{Bu.parse(t,e).then(l=>{s(l),r(l)},l=>{wt.error("Error parsing",l),Ol.parseError?.(l),i(l),n(l)})}),"performCall");Ey.push(a),uj().catch(n)}),"parse"),dj=L((t,e,r)=>new Promise((n,a)=>{const s=L(()=>new Promise((i,l)=>{Bu.render(t,e,r).then(c=>{i(c),n(c)},c=>{wt.error("Error parsing",c),Ol.parseError?.(c),l(c),a(c)})}),"performCall");Ey.push(s),uj().catch(a)}),"render"),rye=L(()=>Object.keys(Ru).map(t=>({id:t})),"getRegisteredDiagramsMetadata"),Ol={startOnLoad:!0,mermaidAPI:Bu,parse:tye,render:dj,init:J0e,run:oj,registerExternalDiagrams:Z0e,registerLayoutLoaders:b5,initialize:lj,parseError:void 0,contentLoaded:cj,setParseErrorHandler:eye,detectType:tk,registerIconPacks:Cpe,getRegisteredDiagramsMetadata:rye},I3=Ol;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const nye=({chart:t,description:e,onLlmApiCall:r})=>{const n=N.useRef(null),[a,s]=N.useState(null),[i,l]=N.useState(!1),[c,d]=N.useState([]),[p,g]=N.useState(t),[m,y]=N.useState(!1),[x,w]=N.useState(!1),[T,k]=N.useState(!1),{accessToken:_}=oi(),{settings:P}=vo(),{addCost:F}=My(),{addSnippet:D}=rf(),{showSuccess:B,showError:M}=jl(),$=async()=>{if(n.current)try{const te=n.current.querySelector("svg");if(!te){M("Chart not found");return}const X=document.createElement("canvas"),Q=new XMLSerializer().serializeToString(te),W=new Image,H=new Blob([Q],{type:"image/svg+xml;charset=utf-8"}),re=URL.createObjectURL(H);W.onload=async()=>{X.width=te.clientWidth||800,X.height=te.clientHeight||600;const ne=X.getContext("2d");ne&&(ne.fillStyle="white",ne.fillRect(0,0,X.width,X.height),ne.drawImage(W,0,0),X.toBlob(async ve=>{if(ve)try{await navigator.clipboard.write([new ClipboardItem({"image/png":ve})]),k(!0),setTimeout(()=>k(!1),2e3),B("Chart image copied to clipboard!")}catch(O){console.error("Failed to copy to clipboard:",O),M("Failed to copy image to clipboard")}})),URL.revokeObjectURL(re)},W.onerror=()=>{M("Failed to process chart image"),URL.revokeObjectURL(re)},W.src=re}catch(te){console.error("Failed to copy image:",te),M("Failed to copy chart image")}},Z=async()=>{if(n.current)try{const te=n.current.querySelector("svg");if(!te){M("Chart not found");return}const X=e||"Chart diagram",Q=document.createElement("canvas"),W=new XMLSerializer().serializeToString(te),H=new Image,re=new Blob([W],{type:"image/svg+xml;charset=utf-8"}),ne=URL.createObjectURL(re);H.onload=async()=>{try{Q.width=te.clientWidth||800,Q.height=te.clientHeight||600;const ve=Q.getContext("2d");if(ve){ve.fillStyle="white",ve.fillRect(0,0,Q.width,Q.height),ve.drawImage(H,0,0);const I=`<img src="${Q.toDataURL("image/png")}" alt="${X}" class="max-w-full h-auto rounded-lg" />`;await D(I,"tool",`Chart: ${X}`),B("Chart saved to Swag!")}URL.revokeObjectURL(ne)}catch(ve){console.error("Failed to convert to PNG:",ve),M("Failed to save chart to Swag"),URL.revokeObjectURL(ne)}},H.onerror=()=>{M("Failed to process chart image"),URL.revokeObjectURL(ne)},H.src=ne}catch(te){console.error("Failed to grab image:",te),M("Failed to save chart to Swag")}};N.useEffect(()=>{I3.initialize({startOnLoad:!1,theme:"default",securityLevel:"loose",fontFamily:"inherit",logLevel:"error"})},[]),N.useEffect(()=>{(async()=>{if(n.current)try{s(null),n.current.innerHTML="";const X=`mermaid-${Math.random().toString(36).substr(2,9)}`,{svg:Q}=await I3.render(X,p);if(!n.current){console.warn(" MermaidChart container ref is null - component may have unmounted");return}n.current.innerHTML=Q,document.querySelectorAll('div[id^="d"]').forEach(H=>{const re=H.textContent||"";(re.includes("Syntax error in text")||re.includes("mermaid version"))&&H.remove()}),console.log(" Mermaid chart rendered successfully")}catch(X){console.error(" Mermaid rendering error:",X);const Q=X.message||String(X);s(Q),document.querySelectorAll('div[id^="d"]').forEach(H=>{const re=H.textContent||"";(re.includes("Syntax error in text")||re.includes("mermaid version"))&&H.remove()}),c.length<3&&await z(Q)}})()},[p]);const z=async te=>{if(!_){console.warn("No access token available for chart fix");return}if(c.length>=3){console.log("Max fix attempts (3) reached");return}l(!0);const X=c.length+1;console.log(` Attempting to fix chart (attempt ${X}/3)`);try{const{getCachedApiBase:Q,resetApiBase:W}=await Zt(async()=>{const{getCachedApiBase:O,resetApiBase:I}=await Promise.resolve().then(()=>CS);return{getCachedApiBase:O,resetApiBase:I}},void 0);W();const H=await Q(),re=await fetch(`${H}/fix-mermaid-chart`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${_}`},body:JSON.stringify({chart:p,error:te,providers:P?.providers||[]})});if(!re.ok)throw new Error(`Fix request failed: ${re.statusText}`);const ne=await re.json();if(ne.error)throw new Error(ne.error);const ve={attemptNumber:X,error:te,fixedChart:ne.fixedChart,usage:ne.usage,llmApiCall:ne.llmApiCall};d(O=>[...O,ve]),ne.usage&&F&&F(ne.usage.cost||0),r&&ne.usage&&r({model:ne.usage.model,provider:ne.usage.provider,prompt_tokens:ne.usage.prompt_tokens,completion_tokens:ne.usage.completion_tokens,total_tokens:ne.usage.total_tokens,cost:ne.usage.cost,duration_ms:ne.usage.duration_ms,purpose:`chart-fix-attempt-${X}`}),console.log(` Chart fix attempt ${X} successful`),console.log(` Cost: $${ne.usage?.cost?.toFixed(6)||"0.000000"}`),console.log(` Tokens: ${ne.usage?.total_tokens||0}`),g(ne.fixedChart),s(null)}catch(Q){console.error(` Chart fix attempt ${X} failed:`,Q);const W={attemptNumber:X,error:te};d(H=>[...H,W]),X>=3&&s(`Failed to fix chart after 3 attempts. Last error: ${te}`)}finally{l(!1)}},ee=()=>{c.length<3&&a&&z(a)};return u.jsxs("div",{className:"my-4 border border-gray-300 dark:border-gray-700 rounded-lg overflow-hidden group",children:[u.jsxs("div",{className:"relative bg-white dark:bg-gray-900",children:[u.jsxs("div",{className:"absolute top-2 right-2 flex gap-1.5 z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[c.some(te=>te.llmApiCall)&&u.jsxs("button",{onClick:()=>w(!0),className:"p-1.5 bg-white/80 dark:bg-gray-800/80 hover:bg-white dark:hover:bg-gray-800 text-blue-600 dark:text-blue-400 text-xs rounded backdrop-blur-sm transition-all duration-200 shadow-sm hover:shadow flex items-center gap-1",title:"View LLM transparency info for chart fixes",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"text-[10px]",children:"LLM"})]}),u.jsx("button",{onClick:$,className:"p-1.5 bg-white/80 dark:bg-gray-800/80 hover:bg-white dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 text-xs rounded backdrop-blur-sm transition-all duration-200 shadow-sm hover:shadow flex items-center gap-1",title:"Copy chart image to clipboard",children:T?u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsx("span",{className:"text-[10px]",children:"Copied!"})]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),u.jsx("span",{className:"text-[10px]",children:"Copy"})]})}),u.jsxs("button",{onClick:Z,className:"p-1.5 bg-white/80 dark:bg-gray-800/80 hover:bg-white dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 text-xs rounded backdrop-blur-sm transition-all duration-200 shadow-sm hover:shadow flex items-center gap-1",title:"Grab chart as base64 markdown",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),u.jsx("span",{className:"text-[10px]",children:"Grab"})]})]}),u.jsx("div",{ref:n,className:"p-4 flex items-center justify-center min-h-[200px]",style:{fontSize:"14px",overflow:"auto"}})]}),a&&!i&&u.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border-t border-red-300 dark:border-red-700 p-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("svg",{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-red-800 dark:text-red-300 mb-1",children:"Chart Rendering Error"}),u.jsx("div",{className:"text-xs text-red-700 dark:text-red-400 font-mono break-all",children:a}),c.length<3&&u.jsxs("button",{onClick:ee,className:"mt-2 text-xs btn-secondary px-3 py-1",children:[" Try to Fix (",c.length,"/3 attempts)"]}),c.length>=3&&u.jsx("div",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:" Maximum fix attempts reached. The chart may have unsupported syntax."})]})]})}),i&&u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-t border-blue-300 dark:border-blue-700 p-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("svg",{className:"w-5 h-5 text-blue-500 animate-spin",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",strokeWidth:"3"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:["Attempting to fix chart (attempt ",c.length+1,"/3)..."]})]})}),c.length>0&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 border-t border-gray-300 dark:border-gray-700",children:[u.jsxs("button",{onClick:()=>y(!m),className:"w-full px-4 py-2 text-left text-xs font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-750 flex items-center justify-between",children:[u.jsxs("span",{children:[" Chart Auto-Fix Details (",c.length," attempt",c.length>1?"s":"",")"]}),u.jsx("svg",{className:`w-4 h-4 transition-transform ${m?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),m&&u.jsxs("div",{className:"px-4 pb-4 space-y-3",children:[c.map(te=>u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded p-3 text-xs",children:[u.jsxs("div",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-2",children:["Attempt ",te.attemptNumber]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Error:"}),u.jsx("div",{className:"text-red-600 dark:text-red-400 font-mono text-[10px] break-all mt-1",children:te.error})]}),te.usage&&u.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"LLM Usage:"}),u.jsxs("div",{className:"mt-1 grid grid-cols-2 gap-2",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Provider:"}),u.jsx("div",{className:"font-medium",children:te.usage.provider})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Model:"}),u.jsx("div",{className:"font-medium",children:te.usage.model})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Tokens:"}),u.jsx("div",{className:"font-medium",children:te.usage.total_tokens.toLocaleString()})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Cost:"}),u.jsxs("div",{className:"font-medium text-green-600 dark:text-green-400",children:["$",te.usage.cost.toFixed(6)]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Duration:"}),u.jsxs("div",{className:"font-medium",children:[te.usage.duration_ms,"ms"]})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-gray-500 dark:text-gray-500",children:"Result:"}),u.jsx("div",{className:"font-medium text-green-600 dark:text-green-400",children:te.fixedChart?" Fixed":" Failed"})]})]})]})]})]},te.attemptNumber)),c.some(te=>te.usage)&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded p-3 text-xs",children:[u.jsx("div",{className:"font-semibold text-blue-900 dark:text-blue-100 mb-1",children:" Total Cost"}),u.jsxs("div",{className:"text-blue-800 dark:text-blue-300",children:["$",c.reduce((te,X)=>te+(X.usage?.cost||0),0).toFixed(6)," ","(",c.reduce((te,X)=>te+(X.usage?.total_tokens||0),0).toLocaleString()," tokens)"]})]})]})]}),x&&u.jsx(AS,{apiCalls:c.filter(te=>te.llmApiCall).map(te=>te.llmApiCall),onClose:()=>w(!1)})]})};function aye(t){const e=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/shorts\/([^&\n?#]+)/];for(const r of e){const n=t.match(r);if(n&&n[1])return n[1]}return null}function sye({href:t,children:e}){const{addTracksToStart:r,playTrack:n}=Ch(),a=aye(t),s=i=>{if(i.preventDefault(),a){const l=typeof e=="string"?e:`YouTube Video ${a}`;r([{videoId:a,title:l,url:t}]),setTimeout(()=>{n(0)},0)}};return u.jsxs("span",{className:"inline-flex items-center gap-2",children:[u.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:e}),u.jsxs("button",{onClick:s,className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-white bg-green-600 hover:bg-green-700 rounded transition-colors",title:"Play now",children:[u.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 5v14l11-7z"})}),"Play"]})]})}function iye({images:t}){const[e,r]=N.useState(null);return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"image-gallery grid grid-cols-2 md:grid-cols-4 gap-4 my-6",children:t.map((n,a)=>u.jsxs("div",{className:"gallery-item cursor-pointer overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-all hover:shadow-lg",onClick:()=>r(n.src),children:[u.jsx("img",{src:n.src,alt:n.alt,className:"w-full h-48 object-cover hover:scale-105 transition-transform",loading:"lazy"}),n.alt&&u.jsx("div",{className:"p-2 text-xs text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-800 truncate",children:n.alt})]},a))}),e&&u.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4",onClick:()=>r(null),children:[u.jsx("button",{className:"absolute top-4 right-4 text-white text-4xl font-bold hover:text-gray-300",onClick:()=>r(null),"aria-label":"Close",children:""}),u.jsx("img",{src:e,alt:"Expanded view",className:"max-w-full max-h-full object-contain",onClick:n=>n.stopPropagation()})]})]})}function k0({content:t,className:e="",chartDescription:r,onLlmApiCall:n,snippetId:a,snippetTags:s=[],onImageEdit:i}){const l=N.useRef(0),[c,d]=N.useState(t),[p,g]=N.useState(!1),m=N.useRef(0);if(N.useEffect(()=>{m.current+=1,console.log(` MarkdownRenderer useEffect triggered (render #${m.current})`),console.log(` Content length: ${t.length}`),console.log(` Has swag-image refs: ${t.includes("swag-image://")}`),console.log(` Has data:image refs: ${t.includes("data:image")}`),(async()=>{if(!t.includes("swag-image://")){console.log(" No swag-image:// refs, setting content as-is"),d(t);return}console.log(" MarkdownRenderer: Found swag-image:// references, loading from IndexedDB..."),console.log(" Content preview:",t.substring(0,200)),g(!0);try{const Z=await po.processContentForDisplay(t);console.log(" MarkdownRenderer: Loaded images successfully"),console.log(" Loaded content preview:",Z.substring(0,200)),d(Z)}catch(Z){console.error(" MarkdownRenderer: Failed to load images:",Z),d(t)}finally{g(!1)}})()},[t]),/^<img\s+[^>]*src="data:image\/[^"]+"/i.test(c.trim()))return u.jsx("div",{className:`markdown-content ${e}`,dangerouslySetInnerHTML:{__html:c}});if(p)return u.jsx("div",{className:`markdown-content ${e} text-gray-500 dark:text-gray-400 italic`,children:"Loading images..."});let x=c.replace(/```html\n([\s\S]*?)\n```/g,($,Z)=>Z.includes("<table")?`

${Z.replace(/<table/g,'<table class="min-w-full divide-y divide-gray-300 dark:divide-gray-700 border border-gray-300 dark:border-gray-700 my-4"').replace(/<th/g,'<th class="px-4 py-2 bg-gray-100 dark:bg-gray-800 font-semibold text-left border border-gray-300 dark:border-gray-700"').replace(/<td/g,'<td class="px-4 py-2 border border-gray-300 dark:border-gray-700"')}

`:$);const w=[];let T=0;x=x.replace(/!\[([^\]]*)\]\((data:image\/[^)]+)\)/g,($,Z,z)=>{const ee=`DATA_URI_IMAGE_PLACEHOLDER_${T++}`;return w.push({placeholder:ee,src:z,alt:Z}),console.log(" Extracted data URI image:",{placeholder:ee,alt:Z,srcLength:z.length}),ee});const k=/<!-- GALLERY_START -->([\s\S]*?)<!-- GALLERY_END -->/g,_=k.exec(x);let P=x;const F=[];if(_){const $=_[1],Z=/!\[(.*?)\]\((.*?)\)/g;let z;for(;(z=Z.exec($))!==null;)F.push({alt:z[1],src:z[2]});P=c.replace(k,"").trim()}console.log(" MarkdownRenderer: Rendering with content length:",c.length),console.log(" Content preview:",c.substring(0,200)),console.log(" Has data: URIs?",c.includes("data:image")),console.log(" Extracted data URI images:",w.length),console.log(" onImageEdit prop:",i?"PROVIDED":"NOT PROVIDED"),console.log(" snippetId:",a);const D=c.includes("data:image")||c.includes("swag-image://"),B=c.includes("<img")||c.includes("<br")||c.includes("<strong>"),M=D&&B;return console.log(" Rendering strategy:",M?"RAW HTML (preserves long data URIs)":"MARKDOWN (ReactMarkdown)"),console.log(" hasImages:",D,"| looksLikeHtml:",B),console.log(" displayContent length:",c.length),console.log(" displayContent preview:",c.substring(0,500)),M?(console.log(" Using dangerouslySetInnerHTML for raw HTML rendering"),u.jsx("div",{className:`markdown-content ${e}`,dangerouslySetInnerHTML:{__html:c}})):u.jsxs("div",{className:`markdown-content ${e}`,children:[u.jsx(B0,{remarkPlugins:[JX],rehypePlugins:[vte,lne],components:{h1:({children:$})=>u.jsx("h1",{className:"text-2xl font-bold mt-6 mb-4 text-gray-900 dark:text-gray-100",children:$}),h2:({children:$})=>u.jsx("h2",{className:"text-xl font-bold mt-5 mb-3 text-gray-900 dark:text-gray-100",children:$}),h3:({children:$})=>u.jsx("h3",{className:"text-lg font-semibold mt-4 mb-2 text-gray-900 dark:text-gray-100",children:$}),h4:({children:$})=>u.jsx("h4",{className:"text-base font-semibold mt-3 mb-2 text-gray-900 dark:text-gray-100",children:$}),p:({children:$})=>{const z=(typeof $=="string"?$:"").match(/DATA_URI_IMAGE_PLACEHOLDER_(\d+)/);if(z){const ee=parseInt(z[1]),te=w[ee];if(te)return console.log(" Rendering data URI image:",{placeholder:te.placeholder,alt:te.alt}),u.jsx("div",{className:"my-4",children:u.jsx("img",{src:te.src,alt:te.alt,className:"max-w-full h-auto rounded-lg"})})}return u.jsx("p",{className:"mb-4 leading-relaxed text-gray-800 dark:text-gray-200",children:$})},ul:({children:$})=>u.jsx("ul",{className:"list-disc list-inside mb-4 space-y-1 text-gray-800 dark:text-gray-200",children:$}),ol:({children:$})=>u.jsx("ol",{className:"list-decimal list-inside mb-4 space-y-1 text-gray-800 dark:text-gray-200",children:$}),li:({children:$})=>u.jsx("li",{className:"ml-4",children:$}),code:({className:$,children:Z,...z})=>{const ee=!$,te=/language-(\w+)/.exec($||"");if((te?te[1]:"")==="mermaid"&&!ee){const Q=String(Z).replace(/\n$/,""),W=Q.split(`
`)[0].trim(),H=r||`${W} diagram`;return u.jsx(nye,{chart:Q,description:H,onLlmApiCall:n})}return ee?u.jsx("code",{className:"px-1.5 py-0.5 rounded bg-gray-100 dark:bg-gray-800 text-pink-600 dark:text-pink-400 text-sm font-mono",...z,children:Z}):u.jsx("code",{className:`${$} text-sm`,...z,children:Z})},pre:({children:$})=>$?.props?.className?.includes("language-mermaid")?$:u.jsx("pre",{className:"mb-4 p-4 rounded-lg bg-gray-900 dark:bg-gray-950 overflow-x-auto",children:$}),a:({href:$,children:Z})=>$&&($.includes("youtube.com/watch")||$.includes("youtu.be/")||$.includes("youtube.com/embed/")||$.includes("youtube.com/shorts/"))&&$?u.jsx(sye,{href:$,children:Z}):u.jsx("a",{href:$,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:Z}),blockquote:({children:$})=>u.jsx("blockquote",{className:"border-l-4 border-gray-300 dark:border-gray-600 pl-4 italic my-4 text-gray-700 dark:text-gray-300",children:$}),table:({children:$})=>u.jsx("div",{className:"overflow-x-auto mb-4",children:u.jsx("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:$})}),thead:({children:$})=>u.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:$}),tbody:({children:$})=>u.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700",children:$}),tr:({children:$})=>u.jsx("tr",{children:$}),th:({children:$})=>u.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:$}),td:({children:$})=>u.jsx("td",{className:"px-4 py-2 text-sm text-gray-800 dark:text-gray-200",children:$}),hr:()=>u.jsx("hr",{className:"my-6 border-gray-300 dark:border-gray-700"}),strong:({children:$})=>u.jsx("strong",{className:"font-bold text-gray-900 dark:text-gray-100",children:$}),em:({children:$})=>u.jsx("em",{className:"italic text-gray-800 dark:text-gray-200",children:$}),img:$=>{console.log(" img component called with ALL props:",$);const{src:Z,alt:z,node:ee,...te}=$,X=ee?.properties?.src;console.log(" Checking node.properties.src:",X),ee&&console.log(" Full node structure:",{type:ee.type,tagName:ee.tagName,properties:ee.properties,children:ee.children,position:ee.position}),console.log(" Destructured:",{srcType:typeof Z,srcValue:Z,srcFromNode:X,srcLength:typeof Z=="string"?Z.length:"N/A",srcPreview:typeof Z=="string"?Z.substring(0,100):Z,alt:z,hasOnImageEdit:!!i,restKeys:Object.keys(te),nodeKeys:ee?Object.keys(ee):[]});const Q=Z||X;console.log(" Actual src to use:",typeof Q=="string"?Q.substring(0,100):Q);const W=typeof Q=="string"&&Q.trim()!==""?Q:null;if(console.log(" After validation:",{imgSrc:W?"VALID":"NULL",imgSrcPreview:W?W.substring(0,100):"N/A"}),!W)return console.log(" img component: No valid src, returning null"),null;console.log(" img component: Valid src, rendering image");const H=l.current++,re=a?`${a}-img-${H}`:`img-${H}`,ne=O=>{if(O.startsWith("data:image/")){const K=O.match(/^data:image\/([^;,]+)/);return K?K[1].toUpperCase():"Unknown"}const I=O.split(".").pop()?.toLowerCase();return I==="jpg"||I==="jpeg"?"JPG":I==="png"?"PNG":I==="gif"?"GIF":I==="webp"?"WebP":I==="svg"?"SVG":"Unknown"},ve=O=>{O.preventDefault(),O.stopPropagation(),console.log(" Edit button clicked!",{imageId:re,imgSrc:W.substring(0,50),currentCounter:H}),i&&i({id:re,url:W,name:z||`Image ${H+1}`,tags:s,snippetId:a,imageIndex:H,format:ne(W)})};return i?(console.log(" Rendering edit button for image:",re),u.jsx("span",{className:"relative inline-block group my-4",style:{display:"inline-block",position:"relative",cursor:"pointer"},onClick:ve,role:"button",tabIndex:0,onKeyDown:O=>{(O.key==="Enter"||O.key===" ")&&(O.preventDefault(),i&&i({id:re,url:W,name:z||`Image ${H+1}`,tags:s,snippetId:a,imageIndex:H,format:ne(W)}))},children:u.jsx("img",{src:W,alt:z||"",className:"max-w-full h-auto rounded-lg border-2 border-orange-500 hover:border-orange-600 block transition-all hover:opacity-90",loading:"lazy",style:{borderRadius:"8px"},onError:O=>{console.error("Image failed to load:",{src:W,alt:z}),O.target.style.display="none"}})})):u.jsx("img",{src:W,alt:z||"",className:"max-w-full h-auto rounded-lg my-4 border border-gray-200 dark:border-gray-700",loading:"lazy",onError:O=>{console.error("Image failed to load:",{src:W,alt:z}),O.target.style.display="none"}})}},children:P}),F.length>0&&u.jsx(iye,{images:F})]})}const ti={YOUTUBE_DOWNLOAD_START:"youtube_download_start",YOUTUBE_DOWNLOAD_PROGRESS:"youtube_download_progress",YOUTUBE_DOWNLOAD_COMPLETE:"youtube_download_complete",DOWNLOAD_START:"download_start",DOWNLOAD_PROGRESS:"download_progress",DOWNLOAD_COMPLETE:"download_complete",METADATA:"metadata",CHUNKING_START:"chunking_start",CHUNK_READY:"chunk_ready",TRANSCRIBE_START:"transcribe_start",TRANSCRIBE_CHUNK_COMPLETE:"transcribe_chunk_complete",TRANSCRIBE_COMPLETE:"transcribe_complete",TRANSCRIPTION_STOPPED:"transcription_stopped",ERROR:"error"},$n={DOWNLOADING:"Downloading",CHUNKING:"Chunking",TRANSCRIBING:"Transcribing",COMPLETE:"Complete",STOPPED:"Stopped",ERROR:"Error"},oye=({toolCallId:t,url:e,events:r,onStop:n})=>{const[a,s]=N.useState(!1),[i,l]=N.useState(!1),c=N.useMemo(()=>{let x=$n.DOWNLOADING,w=0,T=null,k="",_=0,P=1,F=null;r.length>0&&console.log(`[TranscriptionProgress] Processing ${r.length} events for ${t}:`,r.map(D=>({type:D.progress_type||D.data?.type,data:D.data})));for(const D of r)switch(D.progress_type||D.data?.type||""){case ti.YOUTUBE_DOWNLOAD_START:case ti.DOWNLOAD_START:x=$n.DOWNLOADING,w=0;break;case ti.YOUTUBE_DOWNLOAD_PROGRESS:case ti.DOWNLOAD_PROGRESS:x=$n.DOWNLOADING,w=D.data?.percent||0;break;case ti.YOUTUBE_DOWNLOAD_COMPLETE:case ti.DOWNLOAD_COMPLETE:x=$n.DOWNLOADING,w=100;break;case ti.METADATA:T=D.data||null;break;case ti.CHUNKING_START:x=$n.CHUNKING,P=D.data?.chunks||1,w=0;break;case ti.CHUNK_READY:x=$n.CHUNKING,_=D.data?.chunkIndex||0,P=D.data?.totalChunks||1,w=_/P*100;break;case ti.TRANSCRIBE_START:x=$n.TRANSCRIBING,_=D.data?.chunkIndex||0;break;case ti.TRANSCRIBE_CHUNK_COMPLETE:x=$n.TRANSCRIBING,D.data?.text&&(k+=(k?`

`:"")+D.data.text),_=D.data?.chunkIndex||0,P=D.data?.totalChunks||1,w=_/P*100;break;case ti.TRANSCRIBE_COMPLETE:x=$n.COMPLETE,w=100;break;case ti.TRANSCRIPTION_STOPPED:x=$n.STOPPED,_=D.data?.completedChunks||0,P=D.data?.totalChunks||1,w=P>0?_/P*100:0;break;case ti.ERROR:x=$n.ERROR,F=D.data?.error||"Unknown error";break}return{stage:x,progress:Math.min(100,Math.max(0,w)),metadata:T,partialText:k,currentChunk:_,totalChunks:P,error:F}},[r]),d=async()=>{l(!0);try{await n(t)}catch(x){console.error("Failed to stop transcription:",x)}finally{setTimeout(()=>l(!1),5e3)}},p=x=>{const w=Math.floor(x/3600),T=Math.floor(x%3600/60),k=x%60;return w>0?`${w}:${T.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`:`${T}:${k.toString().padStart(2,"0")}`},g=x=>{switch(x){case $n.DOWNLOADING:return"text-blue-600 dark:text-blue-400";case $n.CHUNKING:return"text-purple-600 dark:text-purple-400";case $n.TRANSCRIBING:return"text-green-600 dark:text-green-400";case $n.COMPLETE:return"text-green-700 dark:text-green-300";case $n.STOPPED:return"text-yellow-600 dark:text-yellow-400";case $n.ERROR:return"text-red-600 dark:text-red-400";default:return"text-gray-600 dark:text-gray-400"}},m=x=>{switch(x){case $n.DOWNLOADING:return"bg-blue-500";case $n.CHUNKING:return"bg-purple-500";case $n.TRANSCRIBING:return"bg-green-500";case $n.COMPLETE:return"bg-green-600";case $n.STOPPED:return"bg-yellow-500";case $n.ERROR:return"bg-red-500";default:return"bg-gray-500"}},y=c.stage===$n.DOWNLOADING||c.stage===$n.CHUNKING||c.stage===$n.TRANSCRIBING;return u.jsxs("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4 mb-4 bg-white dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[c.metadata?.thumbnail&&u.jsx("img",{src:c.metadata.thumbnail,alt:"Video thumbnail",className:"w-24 h-16 object-cover rounded flex-shrink-0"}),u.jsx("div",{className:"flex-1 min-w-0",children:c.metadata?.title?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:c.metadata.title}),c.metadata.author&&u.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:c.metadata.author}),c.metadata.duration&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500",children:["Duration: ",p(c.metadata.duration)]})]}):u.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e})}),y&&!i&&u.jsx("button",{onClick:d,className:"px-3 py-1 text-sm bg-red-500 hover:bg-red-600 text-white rounded transition-colors flex-shrink-0",title:"Stop transcription",children:"Stop"}),i&&u.jsx("div",{className:"px-3 py-1 text-sm bg-gray-400 text-white rounded flex-shrink-0",children:"Stopping..."})]}),u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("span",{className:`text-sm font-medium ${g(c.stage)}`,children:c.stage}),c.totalChunks>1&&y&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(Chunk ",c.currentChunk," of ",c.totalChunks,")"]}),y&&u.jsx("div",{className:"ml-auto",children:u.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-300 border-t-blue-500 rounded-full"})})]}),u.jsx("div",{className:"relative w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden mb-3",children:u.jsx("div",{className:`absolute left-0 top-0 h-full ${m(c.stage)} transition-all duration-300 ease-out`,style:{width:`${c.progress}%`}})}),u.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:[c.progress.toFixed(0),"% complete"]}),c.error&&u.jsxs("div",{className:"mb-3 p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-sm text-red-700 dark:text-red-300",children:["Error: ",c.error]}),c.partialText&&u.jsxs("div",{className:"mt-3 border-t border-gray-200 dark:border-gray-700 pt-3",children:[u.jsxs("button",{onClick:()=>s(!a),className:"flex items-center gap-2 text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors mb-2",children:[u.jsx("svg",{className:`w-4 h-4 transition-transform ${a?"rotate-90":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),u.jsxs("span",{children:[a?"Hide":"Show"," Partial Transcript",c.totalChunks>1&&` (${c.currentChunk} of ${c.totalChunks} chunks)`]})]}),a&&u.jsx("div",{className:"max-h-60 overflow-y-auto bg-gray-50 dark:bg-gray-900 rounded p-3 text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap",children:c.partialText})]}),c.stage===$n.COMPLETE&&u.jsxs("div",{className:"mt-3 text-sm text-green-600 dark:text-green-400 flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Transcription complete!"]}),c.stage===$n.STOPPED&&u.jsxs("div",{className:"mt-3 text-sm text-yellow-600 dark:text-yellow-400 flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8 7a1 1 0 00-1 1v4a1 1 0 001 1h4a1 1 0 001-1V8a1 1 0 00-1-1H8z",clipRule:"evenodd"})}),"Transcription stopped (",c.currentChunk," of ",c.totalChunks," chunks completed)"]})]})},lye=({toolCallId:t,url:e,events:r})=>{if(!r||r.length===0)return null;const n=r[r.length-1],a=n.progress_type||n.data?.type||"",s=a==="scrape_complete"||a==="scrape_error",i=a==="scrape_error",l=[{type:"scrape_launching",icon:"",label:"Launching browser"},{type:"scrape_launched",icon:"",label:"Browser ready"},{type:"scrape_navigating",icon:"",label:"Loading page"},{type:"scrape_page_loaded",icon:"",label:"Page loaded"},{type:"scrape_extracting",icon:"",label:"Extracting content"},{type:"scrape_extracted",icon:"",label:"Content extracted"},{type:"scrape_complete",icon:"",label:"Complete"}],c=l.findIndex(k=>k.type===a),d=l[c]||l[0],p=r.find(k=>(k.progress_type||k.data?.type)==="scrape_extracted"),g=r.find(k=>(k.progress_type||k.data?.type)==="scrape_complete"),m=r.find(k=>(k.progress_type||k.data?.type)==="scrape_error"),y=p?.data?.textLength||g?.data?.textLength||0,x=p?.data?.linkCount||g?.data?.linkCount||0,w=p?.data?.imageCount||g?.data?.imageCount||0,T=g?.data?.totalTime||0;return u.jsxs("div",{className:`p-4 rounded-lg border ${i?"bg-red-50 dark:bg-red-900/20 border-red-300 dark:border-red-700":s?"bg-green-50 dark:bg-green-900/20 border-green-300 dark:border-green-700":"bg-blue-50 dark:bg-blue-900/20 border-blue-300 dark:border-blue-700"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-2xl",children:d.icon}),u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-sm text-gray-900 dark:text-gray-100",children:i?" Scraping Failed":s?" Scraping Complete":d.label}),u.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 truncate max-w-md",children:e})]})]}),T>0&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(T/1e3).toFixed(1),"s"]})]}),i&&m?.data?.error&&u.jsxs("div",{className:"mb-3 p-2 bg-red-100 dark:bg-red-900/30 rounded text-sm text-red-800 dark:text-red-200",children:[u.jsx("div",{className:"font-semibold mb-1",children:"Error:"}),u.jsx("div",{className:"text-xs font-mono",children:m.data.error})]}),!i&&u.jsx("div",{className:"mb-3",children:u.jsx("div",{className:"flex items-center gap-1",children:l.slice(0,-1).map((k,_)=>{const P=_<=c,F=_===c;return u.jsx(Ur.Fragment,{children:u.jsx("div",{className:`h-1 flex-1 rounded transition-all duration-300 ${P?F?"bg-blue-500 dark:bg-blue-400":"bg-green-500 dark:bg-green-400":"bg-gray-300 dark:bg-gray-600"}`})},k.type)})})}),(y>0||x>0||w>0)&&u.jsxs("div",{className:"flex gap-4 text-xs text-gray-700 dark:text-gray-300",children:[y>0&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{children:""}),u.jsxs("span",{children:[y," chars"]})]}),x>0&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{children:""}),u.jsxs("span",{children:[x," links"]})]}),w>0&&u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{children:""}),u.jsxs("span",{children:[w," images"]})]})]}),!s&&r.length>1&&u.jsxs("details",{className:"mt-3",children:[u.jsxs("summary",{className:"text-xs text-gray-600 dark:text-gray-400 cursor-pointer hover:text-gray-800 dark:hover:text-gray-200",children:["Show timeline (",r.length," events)"]}),u.jsx("div",{className:"mt-2 space-y-1 max-h-32 overflow-y-auto",children:r.map((k,_)=>{const P=k.progress_type||k.data?.type||"",F=l.find(B=>B.type===P),D=k.timestamp?new Date(k.timestamp).toLocaleTimeString():"";return u.jsxs("div",{className:"text-xs flex items-center gap-2 text-gray-600 dark:text-gray-400",children:[u.jsx("span",{children:F?.icon||""}),u.jsx("span",{className:"flex-1",children:F?.label||P}),D&&u.jsx("span",{className:"text-[10px]",children:D})]},_)})})]})]})},cye=({data:t})=>{switch(t.phase){case"searching":const r={brave:"Brave Search",tavily:"Tavily API",duckduckgo:"DuckDuckGo",wikipedia:"Wikipedia",cascade:"intelligent search"}[t.service||""]||t.service||"the web";return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:["Searching ",r,"..."]})]});case"search_complete":const a={brave:"Brave Search",tavily:"Tavily API",duckduckgo:"DuckDuckGo",wikipedia:"Wikipedia",cascade:"intelligent search",unknown:"web search"}[t.service||"unknown"]||t.service||"web search";return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:["Search complete using ",a," - ",t.searchResults," results found"]})]});case"results_found":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:["Found results for: ",t.query]})]});case"loading_content":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:["Loading content from ",t.result_count," results..."]})]});case"fetching_result":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsxs("div",{className:"font-medium",children:["[",t.result_index,"/",t.result_total,"] ",t.title]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:t.url})]})]});case"result_loaded":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsxs("div",{className:"font-medium",children:["[",t.result_index,"/",t.result_total,"] ",t.title]}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Loaded ",Math.round((t.content_size||0)/1024),"KB in ",t.fetch_time_ms,"ms"]})]})]});case"result_failed":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-red-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsxs("div",{className:"font-medium",children:["[",t.result_index,"/",t.result_total,"] Failed: ",t.title]}),u.jsx("div",{className:"text-xs text-red-600 dark:text-red-400",children:t.error})]})]});default:return null}},uye=({data:t})=>{switch(t.phase){case"searching":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" Searching YouTube for: ",u.jsx("span",{className:"font-medium",children:t.query})]})]});case"results_found":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" Found ",u.jsxs("span",{className:"font-medium",children:[t.totalVideos," videos"]})," for: ",t.query]})]});case"complete":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" YouTube search complete - ",u.jsxs("span",{className:"font-medium",children:[t.totalVideos," videos"]})," added to playlist"]})]});case"fetching_transcripts":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" ",t.message||`Found ${t.totalVideos} videos, fetching transcripts...`]})]});case"fetching_transcript":const e=t.totalVideos&&t.currentVideo?Math.round(t.currentVideo/t.totalVideos*100):0;return u.jsxs("div",{className:"p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsxs("div",{className:"font-medium",children:[" ",t.message||`Fetching transcript ${t.currentVideo}/${t.totalVideos}`]}),t.videoId&&u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:["Video ID: ",t.videoId]})]})]}),u.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:u.jsx("div",{className:"bg-red-500 h-2 rounded-full transition-all duration-300",style:{width:`${e}%`}})}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-right",children:[e,"% complete"]})]});case"transcript_fetched":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsx("span",{className:"font-medium",children:t.message||"Transcript fetched"}),t.transcriptLength&&u.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:["(",t.transcriptLength.toLocaleString()," characters)"]})]})]});case"transcript_failed":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-yellow-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),u.jsxs("div",{className:"flex-1 text-gray-700 dark:text-gray-300",children:[u.jsx("span",{className:"font-medium",children:t.message||"Transcript unavailable"}),t.error&&u.jsx("div",{className:"text-xs text-yellow-600 dark:text-yellow-400",children:t.error})]})]});default:return null}},dye=({data:t})=>{switch(t.phase){case"starting":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 dark:bg-purple-900/20 rounded text-sm",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse"}),u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" Starting JavaScript execution (",t.code_length," characters, ",(t.timeout_ms||0)/1e3,"s timeout)..."]})]});case"executing":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-purple-50 dark:bg-purple-900/20 rounded text-sm",children:[u.jsx("div",{className:"w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}),u.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:" Executing JavaScript code..."})]});case"console_output":return u.jsxs("div",{className:"p-2 bg-gray-50 dark:bg-gray-900/50 rounded text-sm font-mono border-l-4 border-purple-500",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 mb-1",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),u.jsxs("span",{children:["Console Output #",t.output_number,":"]})]}),u.jsx("div",{className:"text-gray-800 dark:text-gray-200 whitespace-pre-wrap",children:t.output})]});case"completed":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 dark:bg-green-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),u.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[" Execution completed",t.output_lines!==void 0&&t.output_lines>0&&u.jsxs("span",{className:"ml-1",children:["(",t.output_lines," console output",t.output_lines!==1?"s":"",")"]}),t.has_result&&!t.output_lines&&u.jsx("span",{className:"ml-1",children:"(returned value)"})]})]});case"error":return u.jsxs("div",{className:"flex items-center gap-2 p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm",children:[u.jsx("svg",{className:"w-4 h-4 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-red-700 dark:text-red-300",children:" Execution Error"}),u.jsx("div",{className:"text-xs text-red-600 dark:text-red-400 font-mono mt-1",children:t.error})]})]});default:return null}},hye=({data:t})=>{const r=(()=>{switch(t.phase){case"analyzing_prompt":return{icon:u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-pink-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),label:"Analyzing prompt",description:t.prompt?`"${t.prompt.substring(0,60)}${t.prompt.length>60?"...":""}"`:"",bgColor:"bg-pink-50 dark:bg-pink-900/20",textColor:"text-pink-700 dark:text-pink-300"};case"quality_selected":return{icon:u.jsx("span",{className:"text-purple-500",children:""}),label:`Quality tier: ${t.quality||"standard"}`,description:t.quality==="ultra"?"Highest quality, slower generation":t.quality==="high"?"High quality output":t.quality==="standard"?"Balanced quality and speed":"Fast generation",bgColor:"bg-purple-50 dark:bg-purple-900/20",textColor:"text-purple-700 dark:text-purple-300"};case"selecting_provider":return{icon:u.jsx("span",{className:"text-indigo-500",children:""}),label:`Selected: ${t.provider||"provider"} ${t.model||""}`,description:`Size: ${t.size||"1024x1024"}  ${t.estimated_cost?`~$${t.estimated_cost.toFixed(4)}`:"Calculating cost..."}`,bgColor:"bg-indigo-50 dark:bg-indigo-900/20",textColor:"text-indigo-700 dark:text-indigo-300"};case"generating":const n=t.remaining_seconds??t.estimated_seconds??15,a=t.estimated_seconds&&t.remaining_seconds!==void 0?Math.min(100,Math.max(0,(t.estimated_seconds-t.remaining_seconds)/t.estimated_seconds*100)):0;return{icon:u.jsx("div",{className:"w-4 h-4 border-2 border-pink-500 border-t-transparent rounded-full animate-spin"}),label:"Generating image...",description:u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[u.jsx("span",{children:""}),u.jsx("span",{children:n>0?`~${n}s remaining`:"Finishing up..."})]}),t.estimated_seconds&&u.jsx("div",{className:"w-full bg-pink-200 dark:bg-pink-800 rounded-full h-1.5",children:u.jsx("div",{className:"bg-gradient-to-r from-pink-500 to-purple-500 h-1.5 rounded-full transition-all duration-1000 ease-linear",style:{width:`${a}%`}})}),u.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:[t.provider,"  ",t.quality," quality  ",t.size]})]}),bgColor:"bg-gradient-to-r from-pink-50 to-purple-50 dark:from-pink-900/20 dark:to-purple-900/20",textColor:"text-pink-700 dark:text-pink-300"};case"completed":return{icon:u.jsx("span",{className:"text-green-500",children:""}),label:"Image generated successfully",description:`${t.provider}  ${t.quality} quality  ${t.size}${t.estimated_cost?`  $${t.estimated_cost.toFixed(4)}`:""}`,bgColor:"bg-green-50 dark:bg-green-900/20",textColor:"text-green-700 dark:text-green-300"};case"error":return{icon:u.jsx("span",{className:"text-red-500",children:""}),label:"Image generation failed",description:t.error||"Unknown error occurred",bgColor:"bg-red-50 dark:bg-red-900/20",textColor:"text-red-700 dark:text-red-300"};default:return{icon:u.jsx("div",{className:"w-4 h-4 border-2 border-gray-500 border-t-transparent rounded-full animate-spin"}),label:"Processing...",description:"",bgColor:"bg-gray-50 dark:bg-gray-900/20",textColor:"text-gray-700 dark:text-gray-300"}}})();return u.jsx("div",{className:`rounded-lg ${r.bgColor} p-3 shadow-sm`,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("div",{className:"flex-shrink-0 mt-0.5",children:r.icon}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:`font-medium text-sm ${r.textColor}`,children:r.label}),r.description&&u.jsx("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:typeof r.description=="string"?u.jsx("span",{children:r.description}):r.description})]})]})})},pye=({data:t})=>t.phase==="preparing"?u.jsx("div",{className:"rounded-lg bg-blue-50 dark:bg-blue-900/20 p-3 shadow-sm",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"font-medium text-sm text-blue-700 dark:text-blue-300",children:["Preparing ",t.chart_type||"chart"," diagram"]}),t.description&&u.jsx("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:t.description})]})]})}):t.phase==="completed"?u.jsx("div",{className:"rounded-lg bg-green-50 dark:bg-green-900/20 p-3 shadow-sm",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("span",{className:"text-green-500",children:""}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"font-medium text-sm text-green-700 dark:text-green-300",children:[t.chart_type||"Chart"," diagram ready"]}),u.jsx("div",{className:"mt-1 text-xs text-gray-600 dark:text-gray-400",children:"Diagram will appear below"})]})]})}):null,gye=({data:t})=>u.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3 text-sm space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"font-medium text-green-700 dark:text-green-300",children:"Content Extracted"})]}),t.title&&u.jsx("div",{className:"text-gray-700 dark:text-gray-300 font-medium truncate",children:t.title}),u.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[t.format&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Format:"})," ",u.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:t.format==="markdown"?" Markdown":" Plain Text"})]}),t.compressionRatio!=null&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Compression:"})," ",u.jsxs("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:[Number(t.compressionRatio).toFixed(1),"x"]})]}),t.originalLength!==void 0&&t.extractedLength!==void 0&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Size:"})," ",u.jsxs("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:[(t.originalLength/1024).toFixed(1),"KB  ",(t.extractedLength/1024).toFixed(1),"KB"]})]}),t.wordCount!==void 0&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Words:"})," ",u.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:t.wordCount.toLocaleString()})]}),t.language&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Language:"})," ",u.jsx("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:t.language})]}),t.duration!==void 0&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Duration:"})," ",u.jsxs("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:[Math.floor(t.duration/60),":",(t.duration%60).toString().padStart(2,"0")]})]})]}),(t.images||t.videos||t.youtube||t.links)&&u.jsxs("div",{className:"flex flex-wrap gap-3 text-xs",children:[(t.images??0)>0&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[" ",t.images," ",t.images===1?"image":"images"]}),(t.videos??0)>0&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[" ",t.videos," ",t.videos===1?"video":"videos"]}),(t.youtube??0)>0&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[" ",t.youtube," YouTube ",t.youtube===1?"video":"videos"]}),(t.links??0)>0&&u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[" ",t.links," ",t.links===1?"link":"links"]})]}),t.warning&&u.jsxs("div",{className:"text-yellow-600 dark:text-yellow-400 text-xs",children:[" ",t.warning]})]}),ig=({data:t,level:e=0})=>{const[r,n]=Ur.useState(e<2);if(t===null)return u.jsx("span",{className:"text-gray-500",children:"null"});if(t===void 0)return u.jsx("span",{className:"text-gray-500",children:"undefined"});if(typeof t!="object")return typeof t=="string"?u.jsxs("span",{className:"text-green-600 dark:text-green-400",children:['"',t,'"']}):typeof t=="number"?u.jsx("span",{className:"text-blue-600 dark:text-blue-400",children:t}):typeof t=="boolean"?u.jsx("span",{className:"text-purple-600 dark:text-purple-400",children:String(t)}):u.jsx("span",{children:String(t)});const a=Array.isArray(t),s=a?t.map((i,l)=>l):Object.keys(t);return s.length===0?u.jsx("span",{className:"text-gray-500",children:a?"[]":"{}"}):u.jsxs("div",{className:"ml-4",children:[u.jsxs("button",{onClick:()=>n(!r),className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100",children:[r?"":""," ",a?`Array[${s.length}]`:`Object{${s.length}}`]}),r&&u.jsx("div",{className:"ml-4 border-l border-gray-300 dark:border-gray-600 pl-2",children:s.map(i=>u.jsxs("div",{className:"my-1",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-mono",children:String(i)}),u.jsx("span",{className:"text-gray-500",children:": "}),u.jsx(ig,{data:t[i],level:e+1})]},String(i)))})]})},fye=({errorData:t,llmApiCalls:e,onClose:r})=>{const n=jy(!0,r),{showSuccess:a,showError:s}=jl();return u.jsx("div",{ref:n,className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 flex items-center gap-2",children:[u.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Details"]}),u.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsxs("div",{className:"space-y-4",children:[t?.message&&u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border-2 border-red-300 dark:border-red-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-red-800 dark:text-red-200 mb-2",children:"Error Message"}),u.jsx("p",{className:"text-red-700 dark:text-red-300 font-mono text-sm whitespace-pre-wrap",children:t.message})]}),(t?.type||t?.code||t?.statusCode)&&u.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-300 dark:border-orange-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-orange-800 dark:text-orange-200 mb-2",children:"Error Classification"}),u.jsxs("div",{className:"space-y-1 text-sm",children:[t.type&&u.jsxs("div",{children:[u.jsx("span",{className:"text-orange-700 dark:text-orange-300 font-semibold",children:"Type:"})," ",u.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-mono",children:t.type})]}),t.code&&u.jsxs("div",{children:[u.jsx("span",{className:"text-orange-700 dark:text-orange-300 font-semibold",children:"Code:"})," ",u.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-mono",children:t.code})]}),t.statusCode&&u.jsxs("div",{children:[u.jsx("span",{className:"text-orange-700 dark:text-orange-300 font-semibold",children:"Status Code:"})," ",u.jsx("span",{className:"text-orange-600 dark:text-orange-400 font-mono",children:t.statusCode})]})]})]}),t?.stack&&u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"Stack Trace"}),u.jsx("pre",{className:"text-xs text-gray-700 dark:text-gray-300 font-mono whitespace-pre-wrap overflow-x-auto",children:t.stack})]}),(t?.errorType||t?.errorMessage)&&u.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 border border-purple-300 dark:border-purple-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-purple-800 dark:text-purple-200 mb-2",children:"Lambda Error"}),u.jsxs("div",{className:"space-y-1 text-sm",children:[t.errorType&&u.jsxs("div",{children:[u.jsx("span",{className:"text-purple-700 dark:text-purple-300 font-semibold",children:"Error Type:"})," ",u.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-mono",children:t.errorType})]}),t.errorMessage&&u.jsxs("div",{children:[u.jsx("span",{className:"text-purple-700 dark:text-purple-300 font-semibold",children:"Error Message:"})," ",u.jsx("span",{className:"text-purple-600 dark:text-purple-400 font-mono",children:t.errorMessage})]})]})]}),(t?.error?.message||t?.error?.type||t?.error?.code)&&u.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-300 dark:border-yellow-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-yellow-800 dark:text-yellow-200 mb-2",children:"Upstream LLM Provider Error"}),u.jsxs("div",{className:"space-y-1 text-sm",children:[t.error.message&&u.jsxs("div",{children:[u.jsx("span",{className:"text-yellow-700 dark:text-yellow-300 font-semibold",children:"Message:"})," ",u.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-mono",children:t.error.message})]}),t.error.type&&u.jsxs("div",{children:[u.jsx("span",{className:"text-yellow-700 dark:text-yellow-300 font-semibold",children:"Type:"})," ",u.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-mono",children:t.error.type})]}),t.error.code&&u.jsxs("div",{children:[u.jsx("span",{className:"text-yellow-700 dark:text-yellow-300 font-semibold",children:"Code:"})," ",u.jsx("span",{className:"text-yellow-600 dark:text-yellow-400 font-mono",children:t.error.code})]})]})]}),(t?.request||t?.requestId||t?.timestamp)&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700 rounded-lg p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-blue-800 dark:text-blue-200 mb-2",children:"Request Context"}),u.jsxs("div",{className:"space-y-1 text-sm",children:[t.requestId&&u.jsxs("div",{children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Request ID:"})," ",u.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-mono",children:t.requestId})]}),t.timestamp&&u.jsxs("div",{children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Timestamp:"})," ",u.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-mono",children:new Date(t.timestamp).toLocaleString()})]}),t.request&&u.jsxs("div",{className:"mt-2",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Request Data:"}),u.jsx("div",{className:"mt-1 bg-white dark:bg-gray-800 rounded p-2 max-h-48 overflow-auto",children:u.jsx(ig,{data:t.request})})]})]})]}),e&&e.length>0&&u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-300 dark:border-blue-700 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-sm font-semibold text-blue-800 dark:text-blue-200 mb-3 flex items-center gap-2",children:[u.jsx("span",{children:" LLM Request Details"}),u.jsxs("span",{className:"text-xs font-normal text-blue-600 dark:text-blue-400",children:["(",e.length," call",e.length!==1?"s":"",")"]})]}),u.jsx("div",{className:"space-y-3",children:e.map((i,l)=>{const c=i.response?.usage?.prompt_tokens||0,d=i.response?.usage?.completion_tokens||0,p=c+d;return u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-blue-200 dark:border-blue-700",children:u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u.jsx("span",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300",children:"Model:"}),u.jsx("span",{className:"text-xs px-2 py-0.5 bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 rounded font-mono",children:i.model}),i.provider&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-gray-400",children:""}),u.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:i.provider})]}),i.phase&&u.jsxs(u.Fragment,{children:[u.jsx("span",{className:"text-gray-400",children:""}),u.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400",children:i.phase})]})]}),p>0&&u.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Tokens:"}),u.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-mono",children:[p.toLocaleString()," total"]}),u.jsxs("span",{className:"text-gray-400",children:["(",c.toLocaleString()," in, ",d.toLocaleString()," out)"]})]}),i.cost!==void 0&&u.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Cost:"}),u.jsxs("span",{className:"text-green-600 dark:text-green-400 font-mono",children:["$",i.cost.toFixed(6)]})]}),i.timestamp&&u.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"Time:"}),u.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-mono",children:new Date(i.timestamp).toLocaleTimeString()})]}),i.httpStatus&&u.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[u.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-semibold",children:"HTTP Status:"}),u.jsx("span",{className:`font-mono ${i.httpStatus>=400?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:i.httpStatus})]}),i.request&&u.jsxs("details",{className:"mt-2",children:[u.jsx("summary",{className:"text-xs text-blue-700 dark:text-blue-300 font-semibold cursor-pointer hover:text-blue-900 dark:hover:text-blue-100",children:"Request Details "}),u.jsx("div",{className:"mt-2 bg-gray-50 dark:bg-gray-900 rounded p-2 max-h-48 overflow-auto",children:u.jsx(ig,{data:i.request})})]}),i.response&&u.jsxs("details",{className:"mt-2",children:[u.jsx("summary",{className:"text-xs text-blue-700 dark:text-blue-300 font-semibold cursor-pointer hover:text-blue-900 dark:hover:text-blue-100",children:"Response Details "}),u.jsx("div",{className:"mt-2 bg-gray-50 dark:bg-gray-900 rounded p-2 max-h-48 overflow-auto",children:u.jsx(ig,{data:i.response})})]})]})},l)})})]}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 border border-gray-300 dark:border-gray-700 rounded-lg p-4",children:[u.jsxs("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:"Complete Error Object (Expandable Tree)"}),u.jsxs("button",{onClick:()=>{const i=JSON.stringify(t,null,2);navigator.clipboard.writeText(i).then(()=>a("Copied to clipboard!")).catch(()=>s("Failed to copy"))},className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 flex items-center gap-1",title:"Copy full JSON to clipboard",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy JSON"]})]}),u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3 max-h-96 overflow-auto font-mono text-xs",children:u.jsx(ig,{data:t})})]})]})}),u.jsxs("div",{className:"flex items-center justify-end gap-2 p-4 border-t border-gray-200 dark:border-gray-700",children:[u.jsx("button",{onClick:()=>{const i=JSON.stringify(t,null,2);navigator.clipboard.writeText(i).then(()=>a("Copied to clipboard!")).catch(()=>s("Failed to copy"))},className:"btn-secondary",children:"Copy Full JSON"}),u.jsx("button",{onClick:r,className:"btn-primary",children:"Close"})]})]})})};function mye({onVoiceRequest:t,accessToken:e,apiEndpoint:r,isProcessing:n=!1,isSpeaking:a=!1,enabled:s=!1,onEnabledChange:i,onStopTTS:l}){N.useEffect(()=>{console.log(` ContinuousVoiceMode: isSpeaking prop changed to ${a}`)},[a]),N.useEffect(()=>{console.log(` ContinuousVoiceMode: isProcessing prop changed to ${n}`)},[n]);const{showPersistentToast:c,removeToast:d,updateToast:p}=jl(),g=N.useRef(null),{settings:m,updateSettings:y}=vo(),[x,w]=N.useState(s);N.useEffect(()=>{w(s)},[s]);const T=N.useCallback(me=>{console.log(` handleSetEnabled called: ${me}`),w(me),i?.(me)},[i]),[k,_]=N.useState(null),P=N.useRef(null),F=N.useRef(0),[D,B]=N.useState(!1);N.useEffect(()=>{P.current=k,console.log(` State ref updated to: ${k}`)},[k]);const M=m?.voice?.speechTimeout??3.5,$=m?.voice?.silenceThreshold??1,Z=N.useRef(null),z=N.useRef(null),ee=N.useRef(null),te=N.useRef([]),X=N.useRef(null),Q=N.useRef(null),W=N.useRef(!1),H=N.useRef(null),re=N.useRef(!1),ne=N.useRef(x),ve=N.useRef(null);N.useEffect(()=>{ne.current=x,console.log(` isEnabled ref updated to: ${x}`)},[x]);const O=N.useRef(l),I=N.useRef(T);N.useEffect(()=>{O.current=l},[l]),N.useEffect(()=>{I.current=T},[T]);const K=N.useRef(null),U=N.useMemo(()=>{let me=null;return(de,he,Ie=!1)=>{me&&clearTimeout(me),me=window.setTimeout(()=>{if(!ne.current){console.log(" updateToastMessage: Skipping because isEnabledRef is false (debounced call after disable)");return}const ze=de==="SPEAKING"?{label:"Stop TTS",onClick:()=>{console.log(" Stop TTS clicked - comprehensive stop"),O.current?.()}}:{label:"Stop",onClick:()=>{console.log(" Stop clicked - comprehensive stop"),O.current?.()}},nt=K.current!==de,mt=Ie||nt;g.current&&!mt?(console.log(` Updating existing toast message to: "${he}"`),p(g.current,he)):(g.current&&(console.log(` Removing old toast (state changed: ${K.current}  ${de})`),d(g.current)),console.log(` Creating new toast with message: "${he}", action: ${ze.label}`),g.current=c(he,"info",ze)),K.current=de},100)}},[c,d,p]),ce=N.useCallback((me,de,he=!1)=>{const Ie=W.current;if(console.log(` setStateWithToast: ${k}  ${me}, speechDetected: ${Ie}, customMessage: ${de||"none"}, forceNew: ${he}, isEnabled: ${ne.current}`),!ne.current){console.log(" setStateWithToast: Skipping because isEnabledRef is false"),_(null);return}if(_(me),me){let ze;de?ze=de:me==="RECORDING"?ze=Ie?" Listening... (speaking detected )":" Listening... (waiting for speech)":me==="PROCESSING"?ze=" Processing...":ze=" Speaking...",console.log(` Toast message will be: "${ze}"`),U(me,ze,he)}},[U,k]);async function ye(){return e?(console.log(" Using Google OAuth access token for transcription"),e):(console.error(" No Google OAuth access token available"),null)}N.useEffect(()=>{const me=new Date().toISOString();if(console.log(`[${me}]  Auto-restart useEffect triggered:`),console.log(`  - state: ${k}`),console.log(`  - isSpeaking: ${a}`),console.log(`  - isEnabled: ${x}`),console.log(`  - isEnabledRef.current: ${ne.current}`),!ne.current){console.log(" Auto-restart: isEnabledRef is false, skipping auto-restart");return}k==="SPEAKING"&&!a&&x&&(console.log(" TTS finished - immediately transitioning to RECORDING"),W.current=!1,B(!1),ce("RECORDING"," Listening... (waiting for speech)",!0),ve.current&&(clearTimeout(ve.current),ve.current=null),ve.current=setTimeout(()=>{console.log(" Starting recording after buffer clear delay"),console.log(` isEnabled: ${x}, isEnabledRef.current: ${ne.current}`),ne.current?Ae():console.log(" Auto-restart cancelled: isEnabledRef is false"),ve.current=null},300))},[a,k,x,ce]),N.useEffect(()=>{console.log(` Enabled state changed to: ${x}, current state: ${k}`),x?(console.log(" Starting continuous voice mode"),re.current=!1,F.current=0,W.current=!1,B(!1),ce("RECORDING"," Listening... (waiting for speech)",!0),Ae()):(console.log(" Stopping continuous voice mode - beginning cleanup sequence"),console.log(`   Current state: ${k}, toastId: ${g.current}`),_(null),console.log("    State cleared to null"),B(!1),K.current=null,console.log("    Cleared previous state ref"),g.current&&(console.log(`    Removing toast: ${g.current}`),d(g.current),g.current=null),console.log("    Starting cleanup()"),be(),console.log("    Cleanup complete"))},[x]),N.useEffect(()=>()=>{be(),_(null),g.current&&(d(g.current),g.current=null)},[]),N.useEffect(()=>{a&&(k==="RECORDING"||k==="PROCESSING")?(console.log(" TTS started - transitioning to SPEAKING state"),Z.current?.state==="recording"&&(console.log(" Stopping microphone"),Ne()),ce("SPEAKING",void 0,!0)):n&&k==="RECORDING"?(console.log(" LLM processing started"),ce("PROCESSING",void 0,!0)):!a&&!n&&k==="SPEAKING"?console.log(" TTS finished and LLM done - will auto-restart recording"):!a&&k==="SPEAKING"&&console.log(" TTS finished - will auto-restart recording (LLM may still be processing)")},[a,n,k,x]);async function Ae(){try{if(console.log(" startRecording() called"),!ne.current){console.log(" startRecording: Skipping because isEnabledRef is false");return}te.current=[];const me=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}});X.current=me,console.log(" Got media stream");const he=me.getAudioTracks()[0].getSettings();console.log(" Microphone settings:",he);const Ie=new(window.AudioContext||window.webkitAudioContext);z.current=Ie;const ze=Ie.createMediaStreamSource(me),nt=Ie.createAnalyser();nt.fftSize=2048,nt.smoothingTimeConstant=.8,nt.minDecibels=-90,nt.maxDecibels=-10,ee.current=nt,ze.connect(nt),console.log(" Analyser configured:",{fftSize:nt.fftSize,frequencyBinCount:nt.frequencyBinCount,smoothingTimeConstant:nt.smoothingTimeConstant});const mt=new MediaRecorder(me);Z.current=mt,mt.ondataavailable=ht=>{ht.data.size>0&&te.current.push(ht.data)},mt.onstop=async()=>{const ht=new Blob(te.current,{type:"audio/webm"});await Te(ht)},mt.start(),fe(),console.log(" Recording started")}catch(me){console.error(" Error starting recording:",me),c(` Failed to start recording: ${me instanceof Error?me.message:"Unknown error"}`,"error"),T(!1)}}function fe(){if(re.current||!ne.current){console.log(` detectSilence stopped: cleaning=${re.current}, enabled=${ne.current}`);return}if(console.log(` detectSilence check: state=${P.current}, enabled=${ne.current}, mediaRecorder.state=${Z.current?.state}`),!ee.current||!Z.current||Z.current.state!=="recording"&&Z.current.state!=="paused"){console.log(` detectSilence stopped: no analyser or recorder not recording (state: ${Z.current?.state})`),console.log(`   analyserRef.current: ${!!ee.current}, mediaRecorderRef.current: ${!!Z.current}`);return}const me=new Uint8Array(ee.current.frequencyBinCount);ee.current.getByteTimeDomainData(me);let de=0,he=255,Ie=0;for(let ht=0;ht<me.length;ht++){const er=me[ht];he=Math.min(he,er),Ie=Math.max(Ie,er);const ct=(er-128)/128;de+=ct*ct}const nt=Math.sqrt(de/me.length)*100,mt=M*1e3;Math.random()<.05&&console.log(` Volume: ${nt.toFixed(1)} | Min: ${he} | Max: ${Ie} | Range: ${Ie-he} (threshold: ${$})`),nt<$?(!H.current&&W.current&&(console.log(` Silence started - will auto-submit in ${M}s`),H.current=window.setTimeout(()=>{console.log(` Silence timeout reached after ${M}s, stopping recording...`),Ne()},mt)),D&&(B(!1),P.current==="RECORDING"?(console.log(' UI update: Silence detected, showing "will auto-submit" message'),ce("RECORDING"," Listening... (silence - will auto-submit)",!1)):console.log(` State mismatch during silence: expected RECORDING, got ${P.current}`))):(W.current?D||(console.log(" Speaking resumed after silence"),B(!0),P.current==="RECORDING"?(console.log(' UI update: Speech resumed, showing "speaking detected " message'),ce("RECORDING"," Listening... (speaking detected )",!1)):console.log(` State mismatch during speech resume: expected RECORDING, got ${P.current}`)):(console.log(" Speech detected for the first time"),W.current=!0,B(!0),P.current==="RECORDING"?(console.log(' UI update: First speech detected, showing "speaking detected " message'),ce("RECORDING"," Listening... (speaking detected )",!1)):console.log(` State mismatch during first speech: expected RECORDING, got ${P.current}`)),H.current&&(console.log(" Silence timeout cleared - speaking again"),clearTimeout(H.current),H.current=null)),!re.current&&Z.current&&(Z.current.state==="recording"||Z.current.state==="paused")?(Math.random()<.05&&console.log(` detectSilence: Continuing loop (state=${Z.current.state}, cleaning=${re.current})`),setTimeout(fe,100)):console.log(` detectSilence: Loop stopped (cleaning=${re.current}, recorder=${!!Z.current}, state=${Z.current?.state})`)}function Ne(){Q.current&&(clearTimeout(Q.current),Q.current=null),Z.current&&(Z.current.state==="recording"||Z.current.state==="paused")&&Z.current.stop(),X.current&&(X.current.getTracks().forEach(me=>me.stop()),X.current=null),z.current&&z.current.state!=="closed"&&(z.current.close().catch(me=>{console.warn("Failed to close AudioContext:",me)}),z.current=null)}async function Te(me){if(re.current||!x){console.log(" Ignoring recording completion - mode was stopped");return}if(!W.current){console.warn(" No speech detected during recording - skipping transcription"),console.log(" Restarting recording to wait for speech..."),W.current=!1,B(!1),ce("RECORDING"," Listening... (waiting for speech)",!1),Ae();return}if(me.size===0){console.warn(" No audio data recorded"),W.current=!1,B(!1),ce("RECORDING"," Listening... (waiting for speech)",!0),Ae();return}ce("PROCESSING",void 0,!0);try{const de=await se(me);if(!(de.replace(/[\s.,!?;:'"()-]/g,"").length>0)){if(F.current++,console.warn(`Empty transcript (attempt ${F.current}/3)`),F.current>=3){console.error("3 consecutive empty transcripts - stopping continuous mode"),c(" No speech detected after 3 attempts. Stopping continuous mode.","error"),T(!1);return}console.log("Empty transcript - retrying"),W.current=!1,B(!1),ce("RECORDING"," Listening... (waiting for speech)",!0),Ae();return}F.current=0,console.log(" Transcript:",de),t?.(de)}catch(de){console.error(" Error processing speech:",de);const he=de instanceof Error?de.message:String(de);if(he.includes("Authentication")||he.includes("Unauthorized")){console.log(" Authentication failed - disabling voice mode"),T(!1);return}(he.includes("Failed to fetch")||he.includes("ERR_CONNECTION_REFUSED"))&&c(" Backend server not running. Start with: make dev","error"),ce("RECORDING",void 0,!0),W.current=!1,Ae()}}async function se(me){console.log(" Getting fresh auth token for transcription");const de=await ye();if(!de)throw console.error(" Failed to obtain auth token after retries"),c(" Session expired. Please refresh the page to log in again.","error"),T(!1),new Error("Authentication token unavailable");const he=new FormData;he.append("audio",me,"recording.webm");const ze=`${(await dn()).replace("/openai/v1","")}/transcribe`,nt=3;let mt=null;for(let ht=1;ht<=nt;ht++)try{const er=new AbortController,ct=setTimeout(()=>er.abort(),2e4),Dt=await fetch(ze,{method:"POST",headers:{Authorization:`Bearer ${de}`},body:he,signal:er.signal});clearTimeout(ct);const kt=await Dt.json().catch(()=>({}));if(!Dt.ok){if(Dt.status===401)throw console.error(" Authentication failed - token may have expired"),c(" Session expired. Please refresh the page to log in again.","error"),T(!1),new Error("Authentication expired");const fr=kt?.error||Dt.statusText||`HTTP ${Dt.status}`;throw new Error(fr)}return kt.text||kt.transcription||""}catch(er){mt=er;const ct=er instanceof TypeError&&er.message.includes("Failed to fetch"),Dt=er.name==="AbortError",kt=er.message?.includes("Authentication")||er.message?.includes("Unauthorized");if(console.warn(`Transcription attempt ${ht} failed:`,er?.message||er),kt)throw er;if(ht<nt&&(ct||Dt)){const fr=400*Math.pow(2,ht-1);await new Promise(qe=>setTimeout(qe,fr));continue}throw er}throw mt||new Error("Transcription failed")}async function be(){console.log(" Cleaning up continuous voice mode"),re.current=!0,ve.current&&(console.log(" Clearing pending auto-restart timeout"),clearTimeout(ve.current),ve.current=null),H.current&&(clearTimeout(H.current),H.current=null),Z.current&&(Z.current.state==="recording"||Z.current.state==="paused")&&Ne(),setTimeout(()=>{re.current=!1},100)}function xe(){T(!x)}return u.jsxs("div",{className:"continuous-voice-mode",children:[!i&&u.jsx("button",{onClick:xe,className:`toggle-btn ${x?"active":""}`,title:x?"Stop Continuous Mode":"Start Continuous Mode",children:x?" Stop":" Continuous Mode"}),x&&!i&&k&&u.jsxs("div",{className:`state-indicator state-${k.toLowerCase()}`,children:[u.jsxs("div",{className:"state-icon",children:[k==="RECORDING"&&"",k==="PROCESSING"&&"",k==="SPEAKING"&&""]}),u.jsxs("div",{className:"state-text",children:[k==="RECORDING"&&"Recording...",k==="PROCESSING"&&"Processing...",k==="SPEAKING"&&"Speaking..."]})]}),!x&&!i&&u.jsxs("details",{className:"settings-panel",children:[u.jsx("summary",{children:" Settings"}),u.jsxs("div",{className:"setting",children:[u.jsxs("label",{children:["Speech Timeout: ",M.toFixed(1),"s"]}),u.jsx("input",{type:"range",min:"0.2",max:"5",step:"0.1",value:M,onChange:async me=>{const de=parseFloat(me.target.value);m?.voice&&await y({voice:{...m.voice,speechTimeout:de}})}}),u.jsx("small",{children:"Auto-submit after this many seconds of silence"})]}),u.jsxs("div",{className:"info-box",children:[u.jsx("p",{children:u.jsx("strong",{children:"How it works:"})}),u.jsxs("ol",{children:[u.jsx("li",{children:'Click "Continuous Mode" button to start'}),u.jsxs("li",{children:["Speak your question (",M,"s silence auto-submits)"]}),u.jsx("li",{children:"Agent responds"}),u.jsx("li",{children:"Microphone auto-restarts for next turn"}),u.jsx("li",{children:'Click "Stop" button when done'})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Note:"})," Persistent mode - stays active until you manually stop it."]})]})]})]})}const R3=({data:t,title:e})=>{const[r,n]=N.useState(!1);return u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded",children:[u.jsxs("button",{onClick:()=>n(!r),className:"w-full px-3 py-2 flex items-center justify-between bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",children:[u.jsx("span",{className:"font-mono text-sm text-gray-700 dark:text-gray-300",children:e}),u.jsx("svg",{className:`w-4 h-4 transform transition-transform ${r?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),r&&u.jsx("pre",{className:"p-3 text-xs overflow-auto max-h-96 bg-white dark:bg-gray-900 font-mono text-gray-800 dark:text-gray-200",children:JSON.stringify(t,null,2)})]})},yye=({data:t,accessToken:e,providerApiKeys:r,onCopy:n,onGrab:a,onLlmInfo:s,onStatusChange:i})=>{console.log(" GeneratedImageBlock render:",{status:t.status,hasImageUrl:!!t.imageUrl,hasBase64:!!t.base64,data:t});const[l,c]=N.useState(!1),[d,p]=N.useState(null),[g,m]=N.useState(!1),[y,x]=N.useState(!1),[w,T]=N.useState(!1),k=M=>{switch(M.toLowerCase()){case"openai":return"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300";case"together":return"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300";case"replicate":return"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300";case"gemini":return"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300";default:return"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"}},_=M=>{switch(M.toLowerCase()){case"openai":return"OpenAI";case"together":return"Together AI";case"replicate":return"Replicate";case"gemini":return"Google Gemini";default:return M}},P=async()=>{if(!e){p("Authentication required");return}c(!0),p(null),i?.(t.id,"generating");try{const M=await WP(t.prompt,t.provider,t.model,t.modelKey||"",t.size||"",t.qualityTier||"",t.style||"",e,r);if(M.success&&M.imageUrl){let $=M.imageUrl;M.base64&&!M.base64.startsWith("data:")?$=`data:image/png;base64,${M.base64}`:M.base64&&($=M.base64),i?.(t.id,"complete",$,M.llmApiCall)}else{const $=M.error||"Image generation failed";p($),i?.(t.id,"error")}}catch(M){const $=M instanceof Error?M.message:"Image generation failed";p($),i?.(t.id,"error")}finally{c(!1)}},F=()=>{t.imageUrl&&n&&n(t.imageUrl)},D=()=>{if(t.imageUrl&&a){const M=`![${t.prompt.substring(0,100)}](${t.imageUrl})`;a(M)}},B=()=>{t.llmApiCall&&s&&s(t.llmApiCall)};return t.status==="pending"||!t.imageUrl&&!l&&!d?u.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 mb-4",children:u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{onClick:P,disabled:l,className:"btn-primary flex items-center justify-center gap-2 py-3",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),u.jsxs("span",{children:["Generate Image for $",t.cost.toFixed(4)]})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[u.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${k(t.provider)}`,children:_(t.provider)}),u.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300",children:t.model}),t.qualityTier&&u.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300",children:t.qualityTier}),t.size&&u.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300",children:t.size})]}),t.constraints&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:[u.jsxs("button",{onClick:()=>m(!g),className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:[u.jsx("svg",{className:`w-4 h-4 transform transition-transform ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),u.jsx("span",{children:"Model Constraints"})]}),g&&u.jsxs("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 space-y-1 pl-6",children:[t.constraints.maxSize&&u.jsxs("div",{children:[" Max size: ",t.constraints.maxSize]}),t.constraints.supportedSizes&&t.constraints.supportedSizes.length>0&&u.jsxs("div",{children:[" Supported sizes: ",t.constraints.supportedSizes.join(", ")]}),t.constraints.supportsStyle!==void 0&&u.jsxs("div",{children:[" Style support: ",t.constraints.supportsStyle?"Yes":"No"]})]})]}),t.availableAlternatives&&t.availableAlternatives.length>0&&u.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3",children:[u.jsxs("button",{onClick:()=>x(!y),className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:[u.jsx("svg",{className:`w-4 h-4 transform transition-transform ${y?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),u.jsxs("span",{children:["Available Alternatives (",t.availableAlternatives.length,")"]})]}),y&&u.jsx("div",{className:"mt-2 space-y-2 pl-6",children:t.availableAlternatives.map((M,$)=>u.jsxs("div",{className:"text-sm bg-gray-50 dark:bg-gray-700/50 rounded p-2 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${k(M.provider)}`,children:_(M.provider)}),u.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:M.model})]}),u.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:["$",M.cost.toFixed(4)]})]},$))})]})]})}):l||t.status==="generating"?u.jsx("div",{className:"bg-white dark:bg-gray-800 border border-blue-200 dark:border-blue-700 rounded-lg p-4 mb-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:["Generating image with ",_(t.provider),"..."]}),u.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This may take a few seconds"})]})]})}):d||t.status==="error"?u.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-4 mb-4",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("svg",{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-red-900 dark:text-red-200",children:"Image Generation Failed"}),u.jsx("div",{className:"text-sm text-red-700 dark:text-red-300 mt-1",children:d||t.error||"An unknown error occurred"}),u.jsxs("button",{onClick:P,className:"mt-3 btn-secondary text-sm flex items-center gap-2",children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),u.jsx("span",{children:"Retry"})]})]})]})}):t.status==="complete"&&t.imageUrl?u.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden mb-4",children:[t.fallbackUsed&&u.jsxs("div",{className:"mx-4 mt-4 mb-2 flex items-center gap-2 text-sm bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded px-3 py-2",children:[u.jsx("svg",{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),u.jsx("span",{className:"text-yellow-800 dark:text-yellow-200",children:"Primary provider unavailable, fallback provider used"})]}),w&&u.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900",children:[u.jsx("h3",{className:"text-lg font-bold text-blue-600 dark:text-blue-400 mb-3",children:" IMAGE GENERATION DETAILS"}),u.jsx("table",{className:"w-full text-sm mb-4",children:u.jsxs("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Title"}),u.jsx("td",{className:"py-2 text-gray-900 dark:text-gray-100",children:"Generated Image"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Final Prompt"}),u.jsx("td",{className:"py-2 text-gray-900 dark:text-gray-100 break-words",children:t.revisedPrompt||t.prompt})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Size"}),u.jsx("td",{className:"py-2 text-gray-900 dark:text-gray-100",children:t.size||"1024x1024"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Model"}),u.jsx("td",{className:"py-2 text-gray-900 dark:text-gray-100",children:t.model})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Provider"}),u.jsx("td",{className:"py-2",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${k(t.provider)}`,children:_(t.provider)})})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Quality"}),u.jsx("td",{className:"py-2 text-gray-900 dark:text-gray-100",children:t.qualityTier||"standard"})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Cost"}),u.jsxs("td",{className:"py-2 text-gray-900 dark:text-gray-100",children:["$",t.cost.toFixed(4)]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 pr-4 font-semibold text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"Status"}),u.jsx("td",{className:"py-2",children:u.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",children:" Success"})})]})]})}),t.llmApiCall&&u.jsxs("div",{className:"space-y-3",children:[t.llmApiCall.request&&u.jsx(R3,{data:t.llmApiCall.request,title:"Request Data"}),t.llmApiCall.response&&u.jsx(R3,{data:t.llmApiCall.response,title:"Response Data"})]})]}),u.jsxs("div",{className:"relative group",children:[u.jsx("img",{src:t.imageUrl,alt:t.prompt,className:"w-full"}),u.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[n&&u.jsx("button",{onClick:F,className:"p-1.5 bg-white/90 dark:bg-gray-800/90 hover:bg-white dark:hover:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded shadow-sm transition-colors",title:"Copy image URL",children:u.jsx("svg",{className:"w-3.5 h-3.5 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),a&&u.jsx("button",{onClick:D,className:"p-1.5 bg-white/90 dark:bg-gray-800/90 hover:bg-white dark:hover:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded shadow-sm transition-colors",title:"Copy as markdown",children:u.jsx("svg",{className:"w-3.5 h-3.5 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})})]})]}),u.jsxs("div",{className:"px-4 py-3 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex items-center justify-between",children:[u.jsxs("button",{onClick:()=>T(!w),className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:[u.jsx("svg",{className:`w-4 h-4 transform transition-transform ${w?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),u.jsxs("span",{className:"font-medium",children:[w?"Hide":"Show"," Details"]})]}),s&&t.llmApiCall&&u.jsxs("button",{onClick:B,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs bg-white dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-750 border border-gray-300 dark:border-gray-600 rounded transition-colors",title:"View LLM call details",children:[u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{children:"LLM Info"})]})]})]}):null},Qg=({data:t,level:e=0,expanded:r=!1,expandPaths:n=[],currentPath:a="",expandAll:s=!1})=>{const i=s||r||n.some(x=>a===x||a.startsWith(x+".")),[l,c]=N.useState(i),p=(x=>x===null?"null":Array.isArray(x)?"array":typeof x)(t);if(p!=="object"&&p!=="array")return u.jsx("span",{className:`json-value json-${p}`,children:p==="string"?`"${t}"`:String(t)});const g=Array.isArray(t)?t.map((x,w)=>[w,x]):Object.entries(t),m=g.length===0,y=Array.isArray(t)?`Array(${t.length})`:`Object{${g.length}}`;return u.jsxs("div",{className:"json-tree",children:[u.jsxs("div",{className:"json-line",children:[!m&&u.jsx("button",{onClick:()=>c(!l),className:"json-toggle","aria-label":l?"Collapse":"Expand",children:l?"":""}),u.jsx("span",{className:"json-bracket",children:Array.isArray(t)?"[":"{"}),!l&&!m&&u.jsxs("span",{className:"json-preview",children:[" ",y," "]}),!l&&u.jsx("span",{className:"json-bracket",children:Array.isArray(t)?"]":"}"})]}),l&&u.jsxs("div",{className:"json-content",style:{marginLeft:`${e*20+20}px`},children:[g.map(([x,w],T)=>{const k=a?`${a}.${x}`:String(x);return u.jsxs("div",{className:"json-item",children:[!Array.isArray(t)&&u.jsxs(u.Fragment,{children:[u.jsxs("span",{className:"json-key",children:['"',x,'"']}),u.jsx("span",{className:"json-colon",children:": "})]}),u.jsx(Qg,{data:w,level:e+1,expanded:!1,expandPaths:n,currentPath:k,expandAll:s}),T<g.length-1&&u.jsx("span",{className:"json-comma",children:","})]},x)}),u.jsx("div",{style:{marginLeft:"-20px"},className:"json-bracket",children:Array.isArray(t)?"]":"}"})]})]})},bye=t=>{if(typeof t!="string")return!1;const e=t.trim();if(!e||!(e.startsWith("{")||e.startsWith("[")))return!1;try{const r=JSON.parse(e);return typeof r=="object"&&r!==null}catch{return!1}},xye=t=>{try{return JSON.parse(t.trim())}catch{return null}},yve=({content:t,className:e=""})=>{if(bye(t)){const r=xye(t);if(r!==null)return u.jsx("div",{className:`json-container ${e}`,children:u.jsx(Qg,{data:r,expanded:!1})})}return u.jsx("div",{className:e,children:t})},vye=({images:t,maxDisplay:e=3,onImageClick:r,onGrabImage:n})=>{const[a,s]=N.useState(new Set),l=t.map(d=>typeof d=="string"?{src:d,alt:void 0}:d).slice(0,e);if(!t||t.length===0)return null;const c=(d,p,g)=>{d.stopPropagation(),n?.(p,g)};return u.jsx("div",{className:"my-4 flex gap-2 flex-wrap",children:l.map((d,p)=>a.has(p)?null:u.jsxs("div",{className:"relative group rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 transition-colors w-32 h-32",children:[u.jsx("img",{src:d.src,alt:d.alt||`Search result ${p+1}`,className:"w-full h-full object-cover cursor-pointer",loading:"lazy",onError:()=>s(g=>new Set(g).add(p)),onClick:()=>r?.(d.src)}),n&&u.jsx("button",{onClick:g=>c(g,d.src,d.alt||`Search result ${p+1}`),className:"absolute bottom-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity bg-blue-600 hover:bg-blue-700 text-white text-xs px-2 py-1 rounded shadow-lg z-10",title:"Add to SWAG",children:" Grab"})]},`${d.src}-${p}`))})};var wye=Object.defineProperty,_y=Object.getOwnPropertySymbols,hj=Object.prototype.hasOwnProperty,pj=Object.prototype.propertyIsEnumerable,D3=(t,e,r)=>e in t?wye(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gS=(t,e)=>{for(var r in e||(e={}))hj.call(e,r)&&D3(t,r,e[r]);if(_y)for(var r of _y(e))pj.call(e,r)&&D3(t,r,e[r]);return t},fS=(t,e)=>{var r={};for(var n in t)hj.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&_y)for(var n of _y(t))e.indexOf(n)<0&&pj.call(t,n)&&(r[n]=t[n]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var Fu;(t=>{const e=class cn{constructor(c,d,p,g){if(this.version=c,this.errorCorrectionLevel=d,this.modules=[],this.isFunction=[],c<cn.MIN_VERSION||c>cn.MAX_VERSION)throw new RangeError("Version value out of range");if(g<-1||g>7)throw new RangeError("Mask value out of range");this.size=c*4+17;let m=[];for(let x=0;x<this.size;x++)m.push(!1);for(let x=0;x<this.size;x++)this.modules.push(m.slice()),this.isFunction.push(m.slice());this.drawFunctionPatterns();const y=this.addEccAndInterleave(p);if(this.drawCodewords(y),g==-1){let x=1e9;for(let w=0;w<8;w++){this.applyMask(w),this.drawFormatBits(w);const T=this.getPenaltyScore();T<x&&(g=w,x=T),this.applyMask(w)}}a(0<=g&&g<=7),this.mask=g,this.applyMask(g),this.drawFormatBits(g),this.isFunction=[]}static encodeText(c,d){const p=t.QrSegment.makeSegments(c);return cn.encodeSegments(p,d)}static encodeBinary(c,d){const p=t.QrSegment.makeBytes(c);return cn.encodeSegments([p],d)}static encodeSegments(c,d,p=1,g=40,m=-1,y=!0){if(!(cn.MIN_VERSION<=p&&p<=g&&g<=cn.MAX_VERSION)||m<-1||m>7)throw new RangeError("Invalid value");let x,w;for(x=p;;x++){const P=cn.getNumDataCodewords(x,d)*8,F=i.getTotalBits(c,x);if(F<=P){w=F;break}if(x>=g)throw new RangeError("Data too long")}for(const P of[cn.Ecc.MEDIUM,cn.Ecc.QUARTILE,cn.Ecc.HIGH])y&&w<=cn.getNumDataCodewords(x,P)*8&&(d=P);let T=[];for(const P of c){r(P.mode.modeBits,4,T),r(P.numChars,P.mode.numCharCountBits(x),T);for(const F of P.getData())T.push(F)}a(T.length==w);const k=cn.getNumDataCodewords(x,d)*8;a(T.length<=k),r(0,Math.min(4,k-T.length),T),r(0,(8-T.length%8)%8,T),a(T.length%8==0);for(let P=236;T.length<k;P^=253)r(P,8,T);let _=[];for(;_.length*8<T.length;)_.push(0);return T.forEach((P,F)=>_[F>>>3]|=P<<7-(F&7)),new cn(x,d,_,m)}getModule(c,d){return 0<=c&&c<this.size&&0<=d&&d<this.size&&this.modules[d][c]}getModules(){return this.modules}drawFunctionPatterns(){for(let p=0;p<this.size;p++)this.setFunctionModule(6,p,p%2==0),this.setFunctionModule(p,6,p%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const c=this.getAlignmentPatternPositions(),d=c.length;for(let p=0;p<d;p++)for(let g=0;g<d;g++)p==0&&g==0||p==0&&g==d-1||p==d-1&&g==0||this.drawAlignmentPattern(c[p],c[g]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(c){const d=this.errorCorrectionLevel.formatBits<<3|c;let p=d;for(let m=0;m<10;m++)p=p<<1^(p>>>9)*1335;const g=(d<<10|p)^21522;a(g>>>15==0);for(let m=0;m<=5;m++)this.setFunctionModule(8,m,n(g,m));this.setFunctionModule(8,7,n(g,6)),this.setFunctionModule(8,8,n(g,7)),this.setFunctionModule(7,8,n(g,8));for(let m=9;m<15;m++)this.setFunctionModule(14-m,8,n(g,m));for(let m=0;m<8;m++)this.setFunctionModule(this.size-1-m,8,n(g,m));for(let m=8;m<15;m++)this.setFunctionModule(8,this.size-15+m,n(g,m));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let c=this.version;for(let p=0;p<12;p++)c=c<<1^(c>>>11)*7973;const d=this.version<<12|c;a(d>>>18==0);for(let p=0;p<18;p++){const g=n(d,p),m=this.size-11+p%3,y=Math.floor(p/3);this.setFunctionModule(m,y,g),this.setFunctionModule(y,m,g)}}drawFinderPattern(c,d){for(let p=-4;p<=4;p++)for(let g=-4;g<=4;g++){const m=Math.max(Math.abs(g),Math.abs(p)),y=c+g,x=d+p;0<=y&&y<this.size&&0<=x&&x<this.size&&this.setFunctionModule(y,x,m!=2&&m!=4)}}drawAlignmentPattern(c,d){for(let p=-2;p<=2;p++)for(let g=-2;g<=2;g++)this.setFunctionModule(c+g,d+p,Math.max(Math.abs(g),Math.abs(p))!=1)}setFunctionModule(c,d,p){this.modules[d][c]=p,this.isFunction[d][c]=!0}addEccAndInterleave(c){const d=this.version,p=this.errorCorrectionLevel;if(c.length!=cn.getNumDataCodewords(d,p))throw new RangeError("Invalid argument");const g=cn.NUM_ERROR_CORRECTION_BLOCKS[p.ordinal][d],m=cn.ECC_CODEWORDS_PER_BLOCK[p.ordinal][d],y=Math.floor(cn.getNumRawDataModules(d)/8),x=g-y%g,w=Math.floor(y/g);let T=[];const k=cn.reedSolomonComputeDivisor(m);for(let P=0,F=0;P<g;P++){let D=c.slice(F,F+w-m+(P<x?0:1));F+=D.length;const B=cn.reedSolomonComputeRemainder(D,k);P<x&&D.push(0),T.push(D.concat(B))}let _=[];for(let P=0;P<T[0].length;P++)T.forEach((F,D)=>{(P!=w-m||D>=x)&&_.push(F[P])});return a(_.length==y),_}drawCodewords(c){if(c.length!=Math.floor(cn.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let d=0;for(let p=this.size-1;p>=1;p-=2){p==6&&(p=5);for(let g=0;g<this.size;g++)for(let m=0;m<2;m++){const y=p-m,w=(p+1&2)==0?this.size-1-g:g;!this.isFunction[w][y]&&d<c.length*8&&(this.modules[w][y]=n(c[d>>>3],7-(d&7)),d++)}}a(d==c.length*8)}applyMask(c){if(c<0||c>7)throw new RangeError("Mask value out of range");for(let d=0;d<this.size;d++)for(let p=0;p<this.size;p++){let g;switch(c){case 0:g=(p+d)%2==0;break;case 1:g=d%2==0;break;case 2:g=p%3==0;break;case 3:g=(p+d)%3==0;break;case 4:g=(Math.floor(p/3)+Math.floor(d/2))%2==0;break;case 5:g=p*d%2+p*d%3==0;break;case 6:g=(p*d%2+p*d%3)%2==0;break;case 7:g=((p+d)%2+p*d%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[d][p]&&g&&(this.modules[d][p]=!this.modules[d][p])}}getPenaltyScore(){let c=0;for(let m=0;m<this.size;m++){let y=!1,x=0,w=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[m][T]==y?(x++,x==5?c+=cn.PENALTY_N1:x>5&&c++):(this.finderPenaltyAddHistory(x,w),y||(c+=this.finderPenaltyCountPatterns(w)*cn.PENALTY_N3),y=this.modules[m][T],x=1);c+=this.finderPenaltyTerminateAndCount(y,x,w)*cn.PENALTY_N3}for(let m=0;m<this.size;m++){let y=!1,x=0,w=[0,0,0,0,0,0,0];for(let T=0;T<this.size;T++)this.modules[T][m]==y?(x++,x==5?c+=cn.PENALTY_N1:x>5&&c++):(this.finderPenaltyAddHistory(x,w),y||(c+=this.finderPenaltyCountPatterns(w)*cn.PENALTY_N3),y=this.modules[T][m],x=1);c+=this.finderPenaltyTerminateAndCount(y,x,w)*cn.PENALTY_N3}for(let m=0;m<this.size-1;m++)for(let y=0;y<this.size-1;y++){const x=this.modules[m][y];x==this.modules[m][y+1]&&x==this.modules[m+1][y]&&x==this.modules[m+1][y+1]&&(c+=cn.PENALTY_N2)}let d=0;for(const m of this.modules)d=m.reduce((y,x)=>y+(x?1:0),d);const p=this.size*this.size,g=Math.ceil(Math.abs(d*20-p*10)/p)-1;return a(0<=g&&g<=9),c+=g*cn.PENALTY_N4,a(0<=c&&c<=2568888),c}getAlignmentPatternPositions(){if(this.version==1)return[];{const c=Math.floor(this.version/7)+2,d=this.version==32?26:Math.ceil((this.version*4+4)/(c*2-2))*2;let p=[6];for(let g=this.size-7;p.length<c;g-=d)p.splice(1,0,g);return p}}static getNumRawDataModules(c){if(c<cn.MIN_VERSION||c>cn.MAX_VERSION)throw new RangeError("Version number out of range");let d=(16*c+128)*c+64;if(c>=2){const p=Math.floor(c/7)+2;d-=(25*p-10)*p-55,c>=7&&(d-=36)}return a(208<=d&&d<=29648),d}static getNumDataCodewords(c,d){return Math.floor(cn.getNumRawDataModules(c)/8)-cn.ECC_CODEWORDS_PER_BLOCK[d.ordinal][c]*cn.NUM_ERROR_CORRECTION_BLOCKS[d.ordinal][c]}static reedSolomonComputeDivisor(c){if(c<1||c>255)throw new RangeError("Degree out of range");let d=[];for(let g=0;g<c-1;g++)d.push(0);d.push(1);let p=1;for(let g=0;g<c;g++){for(let m=0;m<d.length;m++)d[m]=cn.reedSolomonMultiply(d[m],p),m+1<d.length&&(d[m]^=d[m+1]);p=cn.reedSolomonMultiply(p,2)}return d}static reedSolomonComputeRemainder(c,d){let p=d.map(g=>0);for(const g of c){const m=g^p.shift();p.push(0),d.forEach((y,x)=>p[x]^=cn.reedSolomonMultiply(y,m))}return p}static reedSolomonMultiply(c,d){if(c>>>8||d>>>8)throw new RangeError("Byte out of range");let p=0;for(let g=7;g>=0;g--)p=p<<1^(p>>>7)*285,p^=(d>>>g&1)*c;return a(p>>>8==0),p}finderPenaltyCountPatterns(c){const d=c[1];a(d<=this.size*3);const p=d>0&&c[2]==d&&c[3]==d*3&&c[4]==d&&c[5]==d;return(p&&c[0]>=d*4&&c[6]>=d?1:0)+(p&&c[6]>=d*4&&c[0]>=d?1:0)}finderPenaltyTerminateAndCount(c,d,p){return c&&(this.finderPenaltyAddHistory(d,p),d=0),d+=this.size,this.finderPenaltyAddHistory(d,p),this.finderPenaltyCountPatterns(p)}finderPenaltyAddHistory(c,d){d[0]==0&&(c+=this.size),d.pop(),d.unshift(c)}};e.MIN_VERSION=1,e.MAX_VERSION=40,e.PENALTY_N1=3,e.PENALTY_N2=3,e.PENALTY_N3=40,e.PENALTY_N4=10,e.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],e.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],t.QrCode=e;function r(l,c,d){if(c<0||c>31||l>>>c)throw new RangeError("Value out of range");for(let p=c-1;p>=0;p--)d.push(l>>>p&1)}function n(l,c){return(l>>>c&1)!=0}function a(l){if(!l)throw new Error("Assertion error")}const s=class ba{constructor(c,d,p){if(this.mode=c,this.numChars=d,this.bitData=p,d<0)throw new RangeError("Invalid argument");this.bitData=p.slice()}static makeBytes(c){let d=[];for(const p of c)r(p,8,d);return new ba(ba.Mode.BYTE,c.length,d)}static makeNumeric(c){if(!ba.isNumeric(c))throw new RangeError("String contains non-numeric characters");let d=[];for(let p=0;p<c.length;){const g=Math.min(c.length-p,3);r(parseInt(c.substring(p,p+g),10),g*3+1,d),p+=g}return new ba(ba.Mode.NUMERIC,c.length,d)}static makeAlphanumeric(c){if(!ba.isAlphanumeric(c))throw new RangeError("String contains unencodable characters in alphanumeric mode");let d=[],p;for(p=0;p+2<=c.length;p+=2){let g=ba.ALPHANUMERIC_CHARSET.indexOf(c.charAt(p))*45;g+=ba.ALPHANUMERIC_CHARSET.indexOf(c.charAt(p+1)),r(g,11,d)}return p<c.length&&r(ba.ALPHANUMERIC_CHARSET.indexOf(c.charAt(p)),6,d),new ba(ba.Mode.ALPHANUMERIC,c.length,d)}static makeSegments(c){return c==""?[]:ba.isNumeric(c)?[ba.makeNumeric(c)]:ba.isAlphanumeric(c)?[ba.makeAlphanumeric(c)]:[ba.makeBytes(ba.toUtf8ByteArray(c))]}static makeEci(c){let d=[];if(c<0)throw new RangeError("ECI assignment value out of range");if(c<128)r(c,8,d);else if(c<16384)r(2,2,d),r(c,14,d);else if(c<1e6)r(6,3,d),r(c,21,d);else throw new RangeError("ECI assignment value out of range");return new ba(ba.Mode.ECI,0,d)}static isNumeric(c){return ba.NUMERIC_REGEX.test(c)}static isAlphanumeric(c){return ba.ALPHANUMERIC_REGEX.test(c)}getData(){return this.bitData.slice()}static getTotalBits(c,d){let p=0;for(const g of c){const m=g.mode.numCharCountBits(d);if(g.numChars>=1<<m)return 1/0;p+=4+m+g.bitData.length}return p}static toUtf8ByteArray(c){c=encodeURI(c);let d=[];for(let p=0;p<c.length;p++)c.charAt(p)!="%"?d.push(c.charCodeAt(p)):(d.push(parseInt(c.substring(p+1,p+3),16)),p+=2);return d}};s.NUMERIC_REGEX=/^[0-9]*$/,s.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,s.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let i=s;t.QrSegment=s})(Fu||(Fu={}));(t=>{(e=>{const r=class{constructor(a,s){this.ordinal=a,this.formatBits=s}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),e.Ecc=r})(t.QrCode||(t.QrCode={}))})(Fu||(Fu={}));(t=>{(e=>{const r=class{constructor(a,s){this.modeBits=a,this.numBitsCharCount=s}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),e.Mode=r})(t.QrSegment||(t.QrSegment={}))})(Fu||(Fu={}));var Kd=Fu;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Sye={L:Kd.QrCode.Ecc.LOW,M:Kd.QrCode.Ecc.MEDIUM,Q:Kd.QrCode.Ecc.QUARTILE,H:Kd.QrCode.Ecc.HIGH},gj=128,fj="L",mj="#FFFFFF",yj="#000000",bj=!1,xj=1,kye=4,Tye=0,Cye=.1;function vj(t,e=0){const r=[];return t.forEach(function(n,a){let s=null;n.forEach(function(i,l){if(!i&&s!==null){r.push(`M${s+e} ${a+e}h${l-s}v1H${s+e}z`),s=null;return}if(l===n.length-1){if(!i)return;s===null?r.push(`M${l+e},${a+e} h1v1H${l+e}z`):r.push(`M${s+e},${a+e} h${l+1-s}v1H${s+e}z`);return}i&&s===null&&(s=l)})}),r.join("")}function wj(t,e){return t.slice().map((r,n)=>n<e.y||n>=e.y+e.h?r:r.map((a,s)=>s<e.x||s>=e.x+e.w?a:!1))}function Eye(t,e,r,n){if(n==null)return null;const a=t.length+r*2,s=Math.floor(e*Cye),i=a/e,l=(n.width||s)*i,c=(n.height||s)*i,d=n.x==null?t.length/2-l/2:n.x*i,p=n.y==null?t.length/2-c/2:n.y*i,g=n.opacity==null?1:n.opacity;let m=null;if(n.excavate){let x=Math.floor(d),w=Math.floor(p),T=Math.ceil(l+d-x),k=Math.ceil(c+p-w);m={x,y:w,w:T,h:k}}const y=n.crossOrigin;return{x:d,y:p,h:c,w:l,excavation:m,opacity:g,crossOrigin:y}}function _ye(t,e){return e!=null?Math.max(Math.floor(e),0):t?kye:Tye}function Sj({value:t,level:e,minVersion:r,includeMargin:n,marginSize:a,imageSettings:s,size:i,boostLevel:l}){let c=Ur.useMemo(()=>{const x=(Array.isArray(t)?t:[t]).reduce((w,T)=>(w.push(...Kd.QrSegment.makeSegments(T)),w),[]);return Kd.QrCode.encodeSegments(x,Sye[e],r,void 0,void 0,l)},[t,e,r,l]);const{cells:d,margin:p,numCells:g,calculatedImageSettings:m}=Ur.useMemo(()=>{let y=c.getModules();const x=_ye(n,a),w=y.length+x*2,T=Eye(y,i,x,s);return{cells:y,margin:x,numCells:w,calculatedImageSettings:T}},[c,i,s,n,a]);return{qrcode:c,margin:p,cells:d,numCells:g,calculatedImageSettings:m}}var Aye=(function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0})(),Nye=Ur.forwardRef(function(e,r){const n=e,{value:a,size:s=gj,level:i=fj,bgColor:l=mj,fgColor:c=yj,includeMargin:d=bj,minVersion:p=xj,boostLevel:g,marginSize:m,imageSettings:y}=n,w=fS(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:T}=w,k=fS(w,["style"]),_=y?.src,P=Ur.useRef(null),F=Ur.useRef(null),D=Ur.useCallback(Q=>{P.current=Q,typeof r=="function"?r(Q):r&&(r.current=Q)},[r]),[B,M]=Ur.useState(!1),{margin:$,cells:Z,numCells:z,calculatedImageSettings:ee}=Sj({value:a,level:i,minVersion:p,boostLevel:g,includeMargin:d,marginSize:m,imageSettings:y,size:s});Ur.useEffect(()=>{if(P.current!=null){const Q=P.current,W=Q.getContext("2d");if(!W)return;let H=Z;const re=F.current,ne=ee!=null&&re!==null&&re.complete&&re.naturalHeight!==0&&re.naturalWidth!==0;ne&&ee.excavation!=null&&(H=wj(Z,ee.excavation));const ve=window.devicePixelRatio||1;Q.height=Q.width=s*ve;const O=s/z*ve;W.scale(O,O),W.fillStyle=l,W.fillRect(0,0,z,z),W.fillStyle=c,Aye?W.fill(new Path2D(vj(H,$))):Z.forEach(function(I,K){I.forEach(function(U,ce){U&&W.fillRect(ce+$,K+$,1,1)})}),ee&&(W.globalAlpha=ee.opacity),ne&&W.drawImage(re,ee.x+$,ee.y+$,ee.w,ee.h)}}),Ur.useEffect(()=>{M(!1)},[_]);const te=gS({height:s,width:s},T);let X=null;return _!=null&&(X=Ur.createElement("img",{src:_,key:_,style:{display:"none"},onLoad:()=>{M(!0)},ref:F,crossOrigin:ee?.crossOrigin})),Ur.createElement(Ur.Fragment,null,Ur.createElement("canvas",gS({style:te,height:s,width:s,ref:D,role:"img"},k)),X)});Nye.displayName="QRCodeCanvas";var rT=Ur.forwardRef(function(e,r){const n=e,{value:a,size:s=gj,level:i=fj,bgColor:l=mj,fgColor:c=yj,includeMargin:d=bj,minVersion:p=xj,boostLevel:g,title:m,marginSize:y,imageSettings:x}=n,w=fS(n,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:T,cells:k,numCells:_,calculatedImageSettings:P}=Sj({value:a,level:i,minVersion:p,boostLevel:g,includeMargin:d,marginSize:y,imageSettings:x,size:s});let F=k,D=null;x!=null&&P!=null&&(P.excavation!=null&&(F=wj(k,P.excavation)),D=Ur.createElement("image",{href:x.src,height:P.h,width:P.w,x:P.x+T,y:P.y+T,preserveAspectRatio:"none",opacity:P.opacity,crossOrigin:P.crossOrigin}));const B=vj(F,T);return Ur.createElement("svg",gS({height:s,width:s,viewBox:`0 0 ${_} ${_}`,ref:r,role:"img"},w),!!m&&Ur.createElement("title",null,m),Ur.createElement("path",{fill:l,d:`M0,0 h${_}v${_}H0z`,shapeRendering:"crispEdges"}),Ur.createElement("path",{fill:c,d:B,shapeRendering:"crispEdges"}),D)});rT.displayName="QRCodeSVG";var bw={exports:{}},L3;function Pye(){return L3||(L3=1,(function(t){var e=(function(){var r=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function i(c,d){if(!s[c]){s[c]={};for(var p=0;p<c.length;p++)s[c][c.charAt(p)]=p}return s[c][d]}var l={compressToBase64:function(c){if(c==null)return"";var d=l._compress(c,6,function(p){return n.charAt(p)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:l._decompress(c.length,32,function(d){return i(n,c.charAt(d))})},compressToUTF16:function(c){return c==null?"":l._compress(c,15,function(d){return r(d+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:l._decompress(c.length,16384,function(d){return c.charCodeAt(d)-32})},compressToUint8Array:function(c){for(var d=l.compress(c),p=new Uint8Array(d.length*2),g=0,m=d.length;g<m;g++){var y=d.charCodeAt(g);p[g*2]=y>>>8,p[g*2+1]=y%256}return p},decompressFromUint8Array:function(c){if(c==null)return l.decompress(c);for(var d=new Array(c.length/2),p=0,g=d.length;p<g;p++)d[p]=c[p*2]*256+c[p*2+1];var m=[];return d.forEach(function(y){m.push(r(y))}),l.decompress(m.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":l._compress(c,6,function(d){return a.charAt(d)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),l._decompress(c.length,32,function(d){return i(a,c.charAt(d))}))},compress:function(c){return l._compress(c,16,function(d){return r(d)})},_compress:function(c,d,p){if(c==null)return"";var g,m,y={},x={},w="",T="",k="",_=2,P=3,F=2,D=[],B=0,M=0,$;for($=0;$<c.length;$+=1)if(w=c.charAt($),Object.prototype.hasOwnProperty.call(y,w)||(y[w]=P++,x[w]=!0),T=k+w,Object.prototype.hasOwnProperty.call(y,T))k=T;else{if(Object.prototype.hasOwnProperty.call(x,k)){if(k.charCodeAt(0)<256){for(g=0;g<F;g++)B=B<<1,M==d-1?(M=0,D.push(p(B)),B=0):M++;for(m=k.charCodeAt(0),g=0;g<8;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1}else{for(m=1,g=0;g<F;g++)B=B<<1|m,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=0;for(m=k.charCodeAt(0),g=0;g<16;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1}_--,_==0&&(_=Math.pow(2,F),F++),delete x[k]}else for(m=y[k],g=0;g<F;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1;_--,_==0&&(_=Math.pow(2,F),F++),y[T]=P++,k=String(w)}if(k!==""){if(Object.prototype.hasOwnProperty.call(x,k)){if(k.charCodeAt(0)<256){for(g=0;g<F;g++)B=B<<1,M==d-1?(M=0,D.push(p(B)),B=0):M++;for(m=k.charCodeAt(0),g=0;g<8;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1}else{for(m=1,g=0;g<F;g++)B=B<<1|m,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=0;for(m=k.charCodeAt(0),g=0;g<16;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1}_--,_==0&&(_=Math.pow(2,F),F++),delete x[k]}else for(m=y[k],g=0;g<F;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1;_--,_==0&&(_=Math.pow(2,F),F++)}for(m=2,g=0;g<F;g++)B=B<<1|m&1,M==d-1?(M=0,D.push(p(B)),B=0):M++,m=m>>1;for(;;)if(B=B<<1,M==d-1){D.push(p(B));break}else M++;return D.join("")},decompress:function(c){return c==null?"":c==""?null:l._decompress(c.length,32768,function(d){return c.charCodeAt(d)})},_decompress:function(c,d,p){var g=[],m=4,y=4,x=3,w="",T=[],k,_,P,F,D,B,M,$={val:p(0),position:d,index:1};for(k=0;k<3;k+=1)g[k]=k;for(P=0,D=Math.pow(2,2),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;switch(P){case 0:for(P=0,D=Math.pow(2,8),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;M=r(P);break;case 1:for(P=0,D=Math.pow(2,16),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;M=r(P);break;case 2:return""}for(g[3]=M,_=M,T.push(M);;){if($.index>c)return"";for(P=0,D=Math.pow(2,x),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;switch(M=P){case 0:for(P=0,D=Math.pow(2,8),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;g[y++]=r(P),M=y-1,m--;break;case 1:for(P=0,D=Math.pow(2,16),B=1;B!=D;)F=$.val&$.position,$.position>>=1,$.position==0&&($.position=d,$.val=p($.index++)),P|=(F>0?1:0)*B,B<<=1;g[y++]=r(P),M=y-1,m--;break;case 2:return T.join("")}if(m==0&&(m=Math.pow(2,x),x++),g[M])w=g[M];else if(M===y)w=_+_.charAt(0);else return null;T.push(w),g[y++]=_+w.charAt(0),m--,_=w,m==0&&(m=Math.pow(2,x),x++)}}};return l})();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(bw)),bw.exports}var Iye=Pye();const kf=Dc(Iye),M3=32e3,Rye=1;function Dye(t){const e=JSON.stringify(t);return kf.compressToEncodedURIComponent(e)}function O3(t){try{const e=kf.decompressFromEncodedURIComponent(t);if(!e)return null;const r=JSON.parse(e);return!r.version||r.shareType!=="snippet"||!r.content?(console.error("Invalid snippet share data structure"),null):r}catch(e){return console.error("Failed to decode snippet share data:",e),null}}async function Lye(t){try{const e=await fetch(t);if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);const r=await e.blob();return await new Promise((a,s)=>{const i=new FileReader;i.onloadend=()=>a(i.result),i.onerror=s,i.readAsDataURL(r)})}catch(e){throw console.error(`Failed to fetch image from ${t}:`,e),e}}async function Mye(t,e,r,n,a,s=!0){let i=e;if(s){try{i=await po.processContentForDisplay(i),console.log(" Embedded swag-image references in snippet share data")}catch(g){console.error("Failed to embed swag-image references:",g)}const d=/!\[([^\]]*)\]\((https?:\/\/[^)]+)\)/g,p=[...i.matchAll(d)];if(p.length>0){console.log(` Found ${p.length} HTTP image URLs, converting to base64...`);const g=new Map;for(const m of p){const[,,y]=m;if(!g.has(y))try{const x=await Lye(y);g.set(y,x),console.log(` Converted HTTP image to base64: ${y.substring(0,50)}...`)}catch{console.warn(` Could not convert image, keeping URL: ${y}`),g.set(y,y)}}g.forEach((m,y)=>{const x=new RegExp(`!\\[([^\\]]*)\\]\\(${y.replace(/[.*+?^${}()|[\\]\\]/g,"\\\\$&")}\\)`,"g");i=i.replace(x,`![$1](${m})`)}),console.log(` Converted ${g.size} HTTP image URLs to base64 for sharing`)}}else i=i.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,"[$1] (image)");const l={version:Rye,timestamp:Date.now(),shareType:"snippet",id:t,content:i,title:r,tags:n,sourceType:a,metadata:{compressed:!0,originalSize:i.length}},c=Dye(l);return l.metadata.compressedSize=c.length,c.length>M3&&console.warn(`Snippet share data exceeds ${M3} chars (${c.length})`),c}function Oye(t){return`${"https://ai.syntithenai.com"+window.location.pathname}#/snippet/shared?data=${t}`}function vve(){const t=window.location.hash;if(t.includes("/snippet/shared?data=")){const n=t.match(/data=([^&]+)/);if(n)return O3(n[1])}const r=new URLSearchParams(window.location.search).get("snippet");return r?O3(r):null}const Ay=32e3,jye=1;function T0(t){const e=JSON.stringify(t);return kf.compressToEncodedURIComponent(e)}function mS(t){try{const e=kf.decompressFromEncodedURIComponent(t);if(!e)return null;const r=JSON.parse(e);return!r.version||!r.messages||!Array.isArray(r.messages)?(console.error("Invalid share data structure"),null):r}catch(e){return console.error("Failed to decode share data:",e),null}}function Bye(t){const e=t.messages;if(e.length<=2)return T0(t);const r=e[0],n=e[e.length-1];let s={...t,messages:[r,n],metadata:{...t.metadata,truncated:!0,originalMessageCount:e.length,includedMessageCount:2,truncationNotice:"Conversation truncated to fit URL limits. Showing first and last messages."}},i=T0(s);for(let l=e.length-2;l>0;l--){const c=[r,...e.slice(l,e.length-1),n],d={...t,messages:c,metadata:{...t.metadata,truncated:!0,originalMessageCount:e.length,includedMessageCount:c.length,truncationNotice:`Conversation truncated to fit URL limits. Showing ${c.length} of ${e.length} messages.`}},p=T0(d);if(p.length>Ay)break;i=p,s=d}return i}function Fye(t,e={}){const r={version:jye,timestamp:Date.now(),shareType:e.shareType||"conversation",metadata:{title:e.title,truncated:!1,originalMessageCount:t.length,includedMessageCount:t.length},messages:t,plan:e.plan},n=T0(r);return n.length<=Ay?n:(console.warn(`Share data exceeds ${Ay} chars (${n.length}), applying smart truncation`),Bye(r))}function zye(t){return`https://ai.syntithenai.com#/chat/shared?data=${t}`}function $ye(){return window.location.hash.includes("/chat/shared")?new URLSearchParams(window.location.hash.split("?")[1]).has("data"):new URLSearchParams(window.location.search).has("share")}function Uye(){if(window.location.hash.includes("/chat/shared")){const n=new URLSearchParams(window.location.hash.split("?")[1]).get("data");if(n)return mS(n)}const e=new URLSearchParams(window.location.search).get("share");return e?mS(e):null}function qye(){if(window.location.hash.includes("/chat/shared"))window.history.replaceState({},"",window.location.origin+window.location.pathname);else{const t=new URL(window.location.href);t.searchParams.delete("share"),window.history.replaceState({},"",t.toString())}}const Hye=.8,Gye=t=>{const e=t.length,n=kf.compressToEncodedURIComponent(t).length,a=n/Ay,s=a>=Hye,i=a>=1;let l;return i?l="google-docs":s?l="both":l="url",{originalSize:e,compressedSize:n,percentOfLimit:a,shouldWarn:s,shouldForceGoogleDocs:i,recommendation:l}},Vye="shared_doc_",nT=(t,e)=>`${Vye}${t}_${e}`,Wye=(t,e,r,n)=>{const a={documentId:r,webViewLink:n,sharedAt:new Date().toISOString(),contentType:t},s=nT(t,e);localStorage.setItem(s,JSON.stringify(a)),console.log(` Saved shared document for ${t} ${e}:`,a)},Yye=(t,e)=>{const r=nT(t,e),n=localStorage.getItem(r);if(!n)return null;try{return JSON.parse(n)}catch(a){return console.error(` Failed to parse shared document for ${t} ${e}:`,a),null}},Qye=(t,e)=>{const r=nT(t,e);localStorage.removeItem(r),console.log(` Removed shared document for ${t} ${e}`)};class wve extends Ur.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,r){console.error("An error occurred in the <QRCodeSVG> component.",e,r)}render(){return this.state.hasError?this.props.fallback||u.jsx("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"QR code cannot be generated for this content."})}):this.props.children}}const Kye=({snippetId:t,content:e,title:r,tags:n,sourceType:a,timestamp:s,sharedGoogleDocId:i,sharedGoogleDocUrl:l,onClose:c})=>{const[d,p]=N.useState(""),[g,m]=N.useState(l||""),[y,x]=N.useState(""),[w,T]=N.useState(!1),[k,_]=N.useState(!0),[P,F]=N.useState(!1),[D,B]=N.useState(null),[M,$]=N.useState("url"),[Z,z]=N.useState(null),[ee,te]=N.useState(!1),{updateSnippet:X}=rf(),{showSuccess:Q,showError:W}=jl();class H extends Ur.Component{constructor(Te){super(Te),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(Te,se){console.error("An error occurred in the <QRCodeSVG> component.",Te,se)}render(){return this.state.hasError?this.props.fallback||u.jsx("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"QR code cannot be generated for this content."})}):this.props.children}}N.useEffect(()=>{const Ne=Yye("snippet",t);Ne&&(z(Ne),m(Ne.webViewLink),Ne.documentId&&x(`https://drive.google.com/file/d/${Ne.documentId}/view`))},[t]),N.useEffect(()=>{(async()=>{try{const{imageStorage:Te}=await Zt(async()=>{const{imageStorage:de}=await Promise.resolve().then(()=>Ow);return{imageStorage:de}},void 0),se=await Te.processContentForDisplay(e),be=await Mye(t,e,r,n,a,!0),xe=Oye(be);p(xe);const me=Gye(se);B(me),(me.shouldForceGoogleDocs||me.compressedSize>8200)&&$("google-docs")}catch(Te){console.error("Failed to generate snippet share URL:",Te)}finally{_(!1)}})()},[t,e,r,n,a]);const ne=(Ne=>{if(!Ne)return!1;try{const Te=Ne.toLowerCase();return Te.includes("data:image")||Te.includes("base64,")||Te.includes("/samples/")||Te.includes("swag-image")?!1:new Blob([Ne]).size<=1200}catch{return!1}})(d),ve=async()=>{if(!(g||P)){F(!0);try{const Ne=await ms();if(!Ne)throw new Error("Please sign in to create Google Docs");const{imageStorage:Te}=await Zt(async()=>{const{imageStorage:Ie}=await Promise.resolve().then(()=>Ow);return{imageStorage:Ie}},void 0),se=await Te.processContentForDisplay(e),be={title:r||"Untitled Snippet",content:se,swags:n,timestamp:s||Date.now()},{documentId:xe}=await J$(r||"Shared Snippet",be,"snippet",Ne),de=`${window.location.hostname==="localhost"?window.location.origin:"https://ai.syntithenai.com"}/#/snippet/shared?docId=${xe}`,he=`https://drive.google.com/file/d/${xe}/view`;m(de),x(he),$("google-docs"),Wye("snippet",t,xe,de),z({documentId:xe,webViewLink:de,sharedAt:new Date().toISOString(),contentType:"snippet"}),await X(t,{sharedGoogleDocId:xe,sharedGoogleDocUrl:de}),console.log(` Saved Google Doc ID to snippet: ${xe}`),console.log(` Preview URL: ${de}`),console.log(` Google Docs URL: ${he}`),Q("Snippet shared via Google Docs!")}catch(Ne){console.error("Failed to create Google Doc:",Ne),W("Failed to create Google Doc. Please try again.")}finally{F(!1)}}},O=async()=>{if(Z){te(!0);try{const Ne=await ms();if(!Ne)throw new Error("Please sign in to stop sharing");await Z$(Z.documentId,Ne),Qye("snippet",t),z(null),m(""),await X(t,{sharedGoogleDocId:void 0,sharedGoogleDocUrl:void 0}),console.log(` Stopped sharing snippet: ${t}`),Q("Document sharing stopped successfully")}catch(Ne){console.error("Failed to stop sharing:",Ne),W("Failed to stop sharing. Please try again.")}finally{te(!1)}}},I=async()=>{const Ne=M==="google-docs"?g:d;try{await navigator.clipboard.writeText(Ne),T(!0),setTimeout(()=>T(!1),2e3)}catch(Te){console.error("Failed to copy to clipboard:",Te)}},K=()=>{const Ne=M==="google-docs"?g:d,Te=r?`Check out this snippet: ${r}`:"Check out this snippet",se=`https://twitter.com/intent/tweet?text=${encodeURIComponent(Te)}&url=${encodeURIComponent(Ne)}`;window.open(se,"_blank","width=550,height=420")},U=()=>{const Ne=M==="google-docs"?g:d,Te=r||"Shared Snippet",se=`https://reddit.com/submit?url=${encodeURIComponent(Ne)}&title=${encodeURIComponent(Te)}`;window.open(se,"_blank")},ce=()=>{const Ne=M==="google-docs"?g:d,Te=r?`Shared Snippet: ${r}`:"Shared Snippet",se=`Check out this snippet:

${Ne}`;window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${encodeURIComponent(Te)}&body=${encodeURIComponent(se)}`,"_blank")},ye=()=>{const Te=encodeURIComponent(M==="google-docs"?g:d);window.open(`https://www.facebook.com/sharer/sharer.php?u=${Te}`,"_blank")},Ae=()=>{const Ne=M==="google-docs"?g:d,Te=encodeURIComponent(`Check out this snippet${r?`: ${r}`:""}

${Ne}`);window.open(`https://bsky.app/intent/compose?text=${Te}`,"_blank")},fe=()=>{const Te=encodeURIComponent(M==="google-docs"?g:d);window.open(`https://www.quora.com/share?url=${Te}`,"_blank")};return k?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-3",children:"Generating share link..."})]})})}):u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:c,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:Ne=>Ne.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Share Snippet"}),D&&D.compressedSize>8200&&u.jsx("p",{className:"text-sm text-yellow-600 dark:text-yellow-400 mt-1",children:" Too large for URL sharing."})]}),u.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"p-6 space-y-6",children:[D&&!D.shouldForceGoogleDocs&&D.compressedSize<=8200&&u.jsxs("div",{className:"flex gap-2 p-1 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[u.jsxs("button",{onClick:()=>$("url"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-colors ${M==="url"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[u.jsx(vH,{className:"w-4 h-4"}),"URL Share"]}),u.jsxs("button",{onClick:()=>$("google-docs"),className:`flex-1 flex items-center justify-center gap-2 px-4 py-2 rounded-md transition-colors ${M==="google-docs"?"bg-white dark:bg-gray-800 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:[u.jsx(b_,{className:"w-4 h-4"}),"Google Docs"]})]}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:r||"Untitled Snippet"}),n&&n.length>0&&u.jsx("div",{className:"flex gap-1 mb-2 flex-wrap",children:n.map((Ne,Te)=>u.jsx("span",{className:"px-2 py-0.5 text-xs bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 rounded-full",children:Ne},Te))}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-3",children:e})]}),M==="url"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Shareable URL"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:d,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:Ne=>Ne.target.select()}),u.jsx("button",{onClick:I,className:`px-4 py-2 rounded-md font-medium transition-colors ${w?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:w?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),u.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["URL length: ",d.length.toLocaleString()," characters"]})]}),d&&d.length>0&&(ne?u.jsx(H,{fallback:u.jsx("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"QR code could not be generated for this content."})}),children:u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Scan with Mobile Device"}),u.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:u.jsx(rT,{value:d,size:200,level:"M"})})]})}):u.jsx("div",{className:"text-center p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:u.jsxs("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:["URL is too long or contains embedded images and cannot be represented as a QR code (",d.length.toLocaleString()," characters). Use the copy button or social sharing instead."]})}))]}),M==="google-docs"&&u.jsx("div",{children:g?u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i?"Previously Shared Document":"Google Docs Link"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:g,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:Ne=>Ne.target.select()}),u.jsx("button",{onClick:I,className:`px-4 py-2 rounded-md font-medium transition-colors ${w?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:w?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),i&&u.jsx("div",{className:"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-200 dark:border-blue-800",children:u.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:" This snippet was previously shared. The document may contain older content."})}),u.jsxs("div",{className:"mt-3 flex gap-2",children:[u.jsxs("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-center inline-flex items-center justify-center gap-2",children:[u.jsx(mH,{className:"w-4 h-4"}),"Open in Google Docs"]}),Z&&u.jsx("button",{onClick:O,disabled:ee,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors inline-flex items-center justify-center gap-2",children:ee?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Stopping..."]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Stop Sharing"]})})]}),u.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:" Document is publicly accessible (anyone with link can view)"}),y&&u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-3",children:[u.jsxs("button",{onClick:K,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),u.jsxs("button",{onClick:U,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),u.jsxs("button",{onClick:ye,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),u.jsxs("button",{onClick:Ae,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085ff] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),u.jsxs("button",{onClick:fe,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02522] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),u.jsxs("button",{onClick:ce,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]})]}):u.jsxs("div",{className:"text-center p-6 bg-gray-50 dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700",children:[u.jsx(b_,{className:"w-12 h-12 mx-auto mb-3 text-blue-600"}),u.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Create Google Doc"}),u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Create a publicly accessible Google Document with rich text formatting"}),u.jsx("button",{onClick:ve,disabled:P,className:"px-6 py-3 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:P?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Creating Document..."]}):"Create Google Doc"})]})}),M==="url"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-3",children:[u.jsxs("button",{onClick:K,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),u.jsxs("button",{onClick:U,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),u.jsxs("button",{onClick:ye,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),u.jsxs("button",{onClick:Ae,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085ff] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),u.jsxs("button",{onClick:fe,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02522] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),u.jsxs("button",{onClick:ce,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:M==="url"?u.jsxs(u.Fragment,{children:[u.jsx("p",{children:" Anyone with this URL can view the snippet"}),u.jsx("p",{children:" Snippet data is compressed and encoded in the URL itself (no server storage)"}),u.jsx("p",{children:" Links never expire and work offline once loaded"}),u.jsx("p",{children:" No login required to view shared snippets"})]}):u.jsxs(u.Fragment,{children:[u.jsx("p",{children:" Document created in Research Agent/shares folder"}),u.jsx("p",{children:" Publicly accessible - anyone with the link can view"}),u.jsx("p",{children:" Rich text formatting preserved"}),u.jsx("p",{children:" Permanent link - won't expire"})]})})]}),u.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:u.jsx("button",{onClick:c,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Close"})})]})})},Xye=t=>{const e=t.match(/<img[^>]+>/i);if(e){const r=e[0],n=r.match(/src=["']([^"']+)["']/i),a=n?n[1]:null,s=r.match(/alt=["']([^"']*)["']/i),i=s?s[1]:"Image",l=t.replace(/<img[^>]+>/gi,"").trim();return{hasImage:!!a,imageSrc:a,altText:i,textContent:l.length>200?l.substring(0,200)+"...":l}}return{hasImage:!1,imageSrc:null,altText:null,textContent:t.length>300?t.substring(0,300)+"...":t}},Jye=({selectedSnippetIds:t,onSelectionChange:e,userEmail:r})=>{const{getToken:n}=oi(),{snippets:a,getAllTags:s}=rf(),{settings:i}=vo(),[l,c]=N.useState("text"),[d,p]=N.useState(""),[g,m]=N.useState(""),[y,x]=N.useState([]),[w,T]=N.useState(!1),[k,_]=N.useState(!1),[P,F]=N.useState([]),[D,B]=N.useState(.5);N.useEffect(()=>{const W=()=>{const re=localStorage.getItem("rag_config");if(re)try{const ne=JSON.parse(re);ne.similarityThreshold!==void 0&&B(ne.similarityThreshold)}catch(ne){console.error("Failed to parse RAG config:",ne)}};W();const H=()=>W();return window.addEventListener("rag_config_updated",H),()=>{window.removeEventListener("rag_config_updated",H)}},[]);const M=async()=>{if(g.trim()){T(!0),_(!0);try{const W=await dn(),H=await n(),re=await fetch(`${W}/rag/embed-query`,{method:"POST",headers:{"Content-Type":"application/json",...H?{Authorization:`Bearer ${H}`}:{}},body:JSON.stringify({query:g,embeddingModel:i?.embeddingModel,providers:i?.providers||[]})});if(!re.ok)throw new Error("Failed to get query embedding");const{embedding:ne}=await re.json(),ve=await Is.vectorSearch(ne,20,D);console.log(` Vector search found ${ve.length} results with threshold ${D}`),x(ve)}catch(W){console.error("Vector search error:",W),alert("Vector search failed. Make sure snippets have embeddings generated.")}finally{T(!1)}}},$=()=>{let W=a;if(P.length>0&&(W=W.filter(H=>P.every(re=>H.tags?.includes(re)))),l==="text"&&d.trim()){const H=d.toLowerCase();W=W.filter(re=>re.title?.toLowerCase().includes(H)||re.content.toLowerCase().includes(H))}else if(l==="vector"&&k){const H=new Set(y.map(re=>String(re.snippet_id)));W=W.filter(re=>H.has(re.id))}return W},Z=W=>{if(l!=="vector"||!k)return null;const H=y.find(re=>String(re.snippet_id)===W);return H?H.score:null},z=W=>{const H=new Set(t);H.has(W)?H.delete(W):H.add(W),e(H)},ee=()=>{const W=$(),H=new Set;W.forEach(re=>H.add(re.id)),e(H)},te=()=>{e(new Set)},X=$(),Q=s();return u.jsxs("div",{className:"snippet-selector flex flex-col h-full bg-gray-50 dark:bg-gray-800",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:" Attach Context"}),u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.size>0&&`${t.size} selected`})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:ee,disabled:X.length===0,className:"px-2 py-1 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Select All"}),u.jsx("button",{onClick:te,disabled:t.size===0,className:"px-2 py-1 text-xs text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Clear"})]})]}),u.jsx("div",{className:"p-2 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-200 dark:border-blue-800",children:u.jsxs("p",{className:"text-xs text-blue-800 dark:text-blue-200",children:[" Select snippets to include as ",u.jsx("strong",{children:"full context"})," in your message. Unlike automatic RAG which finds relevant fragments, selected snippets are included in their entirety."]})}),u.jsx("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{c("text"),_(!1),x([])},className:`flex-1 px-3 py-2 text-sm font-medium rounded transition-colors ${l==="text"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:" Text Search"}),u.jsx("button",{onClick:()=>c("vector"),className:`flex-1 px-3 py-2 text-sm font-medium rounded transition-colors ${l==="vector"?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:" Semantic Search"})]})}),u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900 space-y-2",children:[l==="text"?u.jsx("input",{type:"text",placeholder:"Search by title or content...",value:d,onChange:W=>p(W.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}):u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",placeholder:"Enter semantic search query...",value:g,onChange:W=>m(W.target.value),onKeyDown:W=>W.key==="Enter"&&M(),className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"}),u.jsx("button",{onClick:M,disabled:w||!g.trim(),className:"px-4 py-2 text-sm bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w?"":""})]}),l==="vector"&&k&&u.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Found ",y.length," results with similarity  ",D.toFixed(2)]})]}),Q.length>0&&u.jsxs("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-900",children:[u.jsx("div",{className:"flex flex-wrap gap-1.5",children:Q.map(W=>u.jsx("button",{onClick:()=>{F(H=>H.includes(W)?H.filter(re=>re!==W):[...H,W])},className:`px-2 py-1 text-xs rounded transition-colors ${P.includes(W)?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"}`,children:W},W))}),P.length>0&&u.jsx("button",{onClick:()=>F([]),className:"mt-2 text-xs text-blue-600 dark:text-blue-400 hover:underline",children:"Clear tag filters"})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:X.length===0?u.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:a.length===0?u.jsxs(u.Fragment,{children:[u.jsx("p",{className:"text-sm font-medium",children:"No snippets in knowledge base"}),u.jsx("p",{className:"text-xs mt-2",children:"Visit the Swag page to add snippets"})]}):l==="vector"&&!k?u.jsx("p",{className:"text-sm",children:"Enter a query and click Search to find semantically similar snippets"}):u.jsx("p",{className:"text-sm",children:"No snippets match your filters"})}):X.map(W=>{const H=t.has(W.id),re=Z(W.id);return u.jsx("div",{onClick:()=>z(W.id),className:`border rounded p-3 cursor-pointer transition-all ${H?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 hover:border-blue-300 dark:hover:border-blue-700 hover:shadow-md"}`,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",checked:H,onChange:()=>{},className:"mt-1 w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm",children:W.title||"Untitled"}),re!==null&&u.jsxs("span",{className:"text-xs font-mono text-blue-600 dark:text-blue-400 whitespace-nowrap",children:[(re*100).toFixed(1),"%"]})]}),u.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 overflow-hidden snippet-preview",children:(()=>{const ne=Xye(W.content);return ne.hasImage&&ne.imageSrc?u.jsxs("div",{className:"space-y-2",children:[u.jsx("img",{src:ne.imageSrc,alt:ne.altText||"Image",className:"max-w-full h-auto max-h-32 rounded border border-gray-300 dark:border-gray-600 block",loading:"lazy"}),ne.textContent&&u.jsx(B0,{components:{p:({node:ve,...O})=>u.jsx("p",{...O,className:"my-1"}),code:({node:ve,...O})=>u.jsx("code",{...O,className:"bg-gray-200 dark:bg-gray-700 px-1 rounded text-xs"})},children:ne.textContent})]}):u.jsx(B0,{components:{p:({node:ve,...O})=>u.jsx("p",{...O,className:"my-1"}),code:({node:ve,...O})=>u.jsx("code",{...O,className:"bg-gray-200 dark:bg-gray-700 px-1 rounded text-xs"})},children:ne.textContent})})()}),W.tags&&W.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:W.tags.map(ne=>u.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded",children:ne},ne))}),u.jsxs("div",{className:"flex items-center gap-2 mt-2 text-xs text-gray-500 dark:text-gray-400",children:[u.jsx("span",{className:"capitalize",children:W.sourceType}),W.hasEmbedding&&u.jsx("span",{title:"Has embeddings",children:""})]})]})]})},W.id)})}),u.jsx("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700 bg-gray-100 dark:bg-gray-900",children:u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 text-center",children:" Tip: Click a snippet to toggle selection. Selected snippets will be included as context when you send your message."})})]})},Zye=({isOpen:t,onClose:e})=>{const{state:r,setRate:n,setVolume:a}=nf();if(!t)return null;const s=r.isPlaying&&r.activeProvider?r.activeProvider:r.currentProvider;return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 backdrop-blur-sm",onClick:e}),u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full pointer-events-auto",onClick:i=>i.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Playback Settings"}),u.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors","aria-label":"Close dialog",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("div",{className:"px-6 py-6 space-y-6",children:[u.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:u.jsx("p",{className:"text-sm text-green-800 dark:text-green-200",children:" Rate and volume adjust in real-time during playback!"})}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Speed: ",r.rate.toFixed(1),"x"]}),u.jsx("input",{type:"range",min:"0.5",max:"2.0",step:"0.1",value:r.rate,onChange:i=>n(parseFloat(i.target.value)),disabled:!1,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"}),u.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[u.jsx("span",{children:"0.5x Slower"}),u.jsx("span",{children:"1.0x Normal"}),u.jsx("span",{children:"2.0x Faster"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Volume: ",Math.round(r.volume*100),"%"]}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:r.volume,onChange:i=>a(parseFloat(i.target.value)),disabled:!1,className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"}),u.jsxs("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[u.jsx("span",{children:"0% Muted"}),u.jsx("span",{children:"50%"}),u.jsx("span",{children:"100% Max"})]})]}),u.jsx("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:u.jsx("div",{className:"settings-group",children:u.jsxs("label",{className:"settings-label",children:[r.isPlaying?"Playing with: ":"Selected provider: ",u.jsx("span",{className:"settings-value",children:s})]})})})]}),u.jsx("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-900 rounded-b-lg flex justify-end",children:u.jsx("button",{onClick:e,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors",children:"Done"})})]})})]})},ebe=({className:t="",showLabel:e=!0,variant:r="inline"})=>{const{state:n,stop:a}=nf(),[s,i]=N.useState(!1),l=Xi();if(!n.isPlaying)return null;const c=()=>{console.log(" TTSStopButton: Stop button clicked"),console.log("   - state.isPlaying:",n.isPlaying),a(),console.log(" TTSStopButton: stop() function called")},d=n.activeProvider?.toLowerCase()||"",p=n.currentProvider?.toLowerCase()||"",g=d.includes("browser")||d.includes("speech")||p==="browser",m=()=>{g?(a(),l("/settings?tab=tts"),setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},100)):i(!0)},y=r==="fixed"?"fixed top-4 right-20 z-[60] shadow-lg":"shadow-md";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${y} ${t}`,children:u.jsxs("div",{className:"flex items-center bg-red-600 hover:bg-red-700 transition-colors animate-pulse rounded-lg",children:[u.jsxs("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 text-white",title:"Stop reading aloud","aria-label":"Stop Reading",children:[n.isLoadingAudio?u.jsxs("svg",{className:"w-4 h-4 md:w-5 md:h-5 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):u.jsx("svg",{className:"w-4 h-4 md:w-5 md:h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})}),e&&u.jsx("span",{className:"hidden md:inline",children:n.isLoadingAudio?"Loading...":"Stop Reading"})]}),u.jsx("button",{onClick:m,className:"px-2 py-2 text-white border-l border-red-700 hover:bg-red-700",title:g?"TTS settings":"Voice settings","aria-label":g?"Open TTS settings":"Open voice settings",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})})]})}),u.jsx(Zye,{isOpen:s,onClose:()=>i(!1)})]})},tbe=()=>u.jsx(ebe,{variant:"fixed",showLabel:!0}),rbe=({text:t,variant:e="icon",size:r="md",onStart:n,onEnd:a,className:s=""})=>{const{state:i,speak:l,stop:c}=nf(),[d,p]=N.useState(!1),g=i.isPlaying||d,[m,y]=Ur.useState(!1);console.log("ReadButton render - isReading:",g,"state.isPlaying:",i.isPlaying,"localIsReading:",d,"isTransitioning:",m),N.useEffect(()=>{p(i.isPlaying)},[i.isPlaying]),N.useEffect(()=>{d&&!i.isPlaying&&(console.log("ReadButton: Syncing local state with global state"),p(!1))},[d,i.isPlaying]);const x=N.useCallback(async()=>{if(m){console.log("ReadButton: Ignoring click during transition");return}if(g)console.log("ReadButton: Stop clicked"),y(!0),p(!1),c(),setTimeout(()=>y(!1),500);else{console.log("ReadButton: Start clicked, text length:",t.length),y(!0),p(!0),n?.();try{console.log("ReadButton: Calling speak()..."),await l(t,{onStart:()=>{console.log("TTS started - setting localIsReading to true"),p(!0),y(!1)},onEnd:()=>{console.log("TTS ended - setting localIsReading to false"),p(!1),y(!1),a?.()},onError:P=>{console.error("TTS error in callback:",P),p(!1),y(!1)}}),console.log("ReadButton: speak() promise resolved"),y(!1)}catch(P){console.error("TTS error:",P),p(!1),y(!1)}}},[g,m,t,l,c,n,a]);if(!i.isEnabled)return null;const w={sm:{icon:"w-4 h-4",button:"px-2 py-1 text-xs",fab:"w-10 h-10"},md:{icon:"w-5 h-5",button:"px-3 py-1.5 text-sm",fab:"w-12 h-12"},lg:{icon:"w-6 h-6",button:"px-4 py-2 text-base",fab:"w-16 h-16"}},T=w[r].icon,k=()=>u.jsx("svg",{className:T,fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"})}),_=()=>u.jsx("svg",{className:T,fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("rect",{x:"6",y:"6",width:"12",height:"12"})});return e==="icon"?u.jsx("button",{onClick:x,className:`p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors ${s}`,title:g?"Stop reading (If stuck, wait 30s or refresh page)":"Read aloud",disabled:m||i.isPlaying&&!g,children:g?u.jsx(_,{}):u.jsx(k,{})}):e==="button"?u.jsx("button",{onClick:x,className:`${w[r].button} rounded-lg flex items-center gap-2 transition-colors ${g?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"} ${s}`,title:g?"Stop reading (If stuck, wait 30s or refresh page)":"Read aloud",disabled:m||i.isPlaying&&!g,children:g?u.jsxs(u.Fragment,{children:[u.jsx(_,{}),"Stop"]}):u.jsxs(u.Fragment,{children:[u.jsx(k,{}),"Read"]})}):e==="fab"?u.jsx("button",{onClick:x,className:`${w[r].fab} fixed bottom-20 right-6 rounded-full shadow-lg flex items-center justify-center z-40 transition-colors ${g?"bg-red-600 hover:bg-red-700":"bg-blue-600 hover:bg-blue-700"} text-white ${s}`,title:g?"Stop reading":"Read aloud",disabled:m||i.isPlaying&&!g,children:g?u.jsx(_,{}):u.jsx(k,{})}):null},j3=({rawResponse:t,extractionMetadata:e})=>{const[r,n]=N.useState(null);let a=null,s=[];try{t&&(a=JSON.parse(t),a.results&&Array.isArray(a.results)&&(s=a.results))}catch(i){console.log("Failed to parse rawResponse:",i)}return console.log(" ToolTransparency received:",{hasRawResponse:!!t,rawResponseLength:t?.length,hasExtraction:!!e,parsedResults:s.length,rawResponsePreview:t?t.substring(0,100)+"...":"none"}),!t&&!e?(console.log(" ToolTransparency: No data, returning null"),null):(console.log(" ToolTransparency: Rendering with",s.length,"results"),u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mt-3 pt-3 border-t-4 border-purple-400 dark:border-purple-600 bg-purple-50 dark:bg-purple-950 p-3 rounded",children:[u.jsxs("div",{className:"text-sm font-bold text-purple-700 dark:text-purple-300 mb-3 flex items-center gap-2",children:[" Search Results Transparency",u.jsxs("span",{className:"text-xs font-normal opacity-75",children:["(",s.length," results)"]})]}),u.jsxs("div",{className:"space-y-4",children:[s.map((i,l)=>{const c=i.rawHtml||i.rawContent||"",d=i.content||"";return u.jsxs("div",{className:"border border-purple-300 dark:border-purple-700 rounded p-3 bg-white dark:bg-gray-900",children:[u.jsxs("div",{className:"text-sm font-semibold text-purple-800 dark:text-purple-200 mb-2",children:["Result ",l+1,": ",i.title||i.url]}),c&&u.jsx("div",{className:"mb-3",children:u.jsxs("button",{onClick:()=>n({content:c,title:`Raw Content: ${i.title||i.url}`}),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white text-xs rounded flex items-center gap-2",children:[" View Full Raw Scraped Content",u.jsxs("span",{className:"opacity-75",children:["(",c.length.toLocaleString()," chars)"]})]})}),d&&u.jsxs("div",{className:"mb-3",children:[u.jsxs("div",{className:"text-xs font-semibold text-green-700 dark:text-green-400 mb-1 flex items-center gap-2",children:[" Content Sent to LLM",u.jsxs("span",{className:"opacity-75",children:["(",d.length.toLocaleString()," chars)"]})]}),u.jsx("div",{className:"bg-green-50 dark:bg-green-950 border border-green-300 dark:border-green-700 rounded p-3 max-h-96 overflow-y-auto",children:u.jsx("div",{className:"prose prose-sm dark:prose-invert max-w-none",children:u.jsx(B0,{children:d})})})]}),u.jsxs("div",{className:"mb-2",children:[u.jsx("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-400 mb-1",children:" Parsed Page Structure & Metadata"}),u.jsx("div",{className:"bg-purple-50 dark:bg-purple-950 border border-purple-300 dark:border-purple-700 rounded p-2 max-h-96 overflow-y-auto",children:u.jsx(uh,{data:{url:i.url,title:i.title,snippet:i.snippet,images:i.page_content?.images||i.images||[],youtube:i.youtube||[],media:i.media||[],links:i.links||[],page_content:i.page_content,summary:i.page_content?.summary,structure:i.page_content?.structure,metadata:{contentLength:d.length,rawContentLength:c.length,hasImages:!!(i.page_content?.images?.length||i.images?.length),hasYouTube:!!i.youtube?.length,hasMedia:!!i.media?.length,hasLinks:!!i.links?.length}}})})]})]},l)}),e&&u.jsxs("div",{className:"border border-purple-300 dark:border-purple-700 rounded p-3 bg-white dark:bg-gray-900",children:[u.jsx("div",{className:"text-sm font-semibold text-purple-800 dark:text-purple-200 mb-2",children:" Overall Extraction Metadata"}),u.jsx("div",{className:"bg-purple-50 dark:bg-purple-950 border border-purple-300 dark:border-purple-700 rounded p-2 max-h-96 overflow-y-auto",children:u.jsx(uh,{data:e})})]})]})]}),r&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-300 dark:border-gray-700",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100",children:r.title}),u.jsx("button",{onClick:()=>n(null),className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm",children:" Close"})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-800 dark:text-gray-200 font-mono",children:r.content})}),u.jsxs("div",{className:"p-4 border-t border-gray-300 dark:border-gray-700 flex gap-2",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(r.content),alert("Copied to clipboard!")},className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm",children:" Copy to Clipboard"}),u.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center",children:[r.content.length.toLocaleString()," characters"]})]})]})})]}))},B3=({text:t,renderAsMarkdown:e=!1,chartDescription:r})=>{const{state:n,seekToChunk:a}=nf(),s=n.isPlaying&&n.chunks.length>0,i=Gw(t),l=n.currentText?.trim()||"",c=l===i.trim(),d=i.trim().startsWith(l)&&l.length>0;if(!s||!(c||d))return e?u.jsx(k0,{content:t,chartDescription:r}):u.jsx("span",{className:"whitespace-pre-wrap",children:t});const g=m=>{a(m)};return u.jsx("div",{className:"whitespace-pre-wrap",children:n.chunks.map((m,y)=>{const x=y===n.currentChunkIndex,w=y<n.currentChunkIndex;return u.jsx("span",{onClick:()=>g(y),className:`
              cursor-pointer transition-colors duration-200 rounded px-0.5
              ${x?"bg-yellow-300 dark:bg-yellow-500/60 font-medium shadow-sm":""}
              ${w?"bg-gray-200 dark:bg-gray-700/40 opacity-70":""}
              ${!x&&!w?"bg-blue-100 dark:bg-blue-900/30":""}
              hover:bg-blue-300 dark:hover:bg-blue-700/50
            `,title:`Sentence ${y+1}/${n.totalChunks} - Click to play from here`,children:m},y)})})},F3=({content:t,chartCode:e})=>{const[r,n]=Ur.useState(!1),[a,s]=Ur.useState(!1);try{const i=typeof t=="string"?JSON.parse(t):t,c=e||(g=>{if(!g)return null;const m=g.match(/```mermaid\s*([\s\S]*?)```/);if(m&&m[1]){const y=m[1].trim();return y.includes("[Your Mermaid diagram code here]")||y.includes("Your Mermaid diagram code here")?null:y}return null})(i.instructions||""),d=()=>{i.instructions&&navigator.clipboard.writeText(i.instructions).then(()=>{n(!0),setTimeout(()=>n(!1),2e3)})},p=()=>{c&&navigator.clipboard.writeText(c).then(()=>{s(!0),setTimeout(()=>s(!1),2e3)})};return u.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-purple-950/30 dark:to-indigo-950/30 rounded-lg border border-purple-200 dark:border-purple-700 overflow-hidden",children:u.jsx("table",{className:"w-full text-sm",children:u.jsxs("tbody",{children:[u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-700",children:[u.jsx("td",{className:"font-semibold text-purple-700 dark:text-purple-300 p-3 w-32 bg-purple-100/50 dark:bg-purple-900/30",children:" Chart Type"}),u.jsx("td",{className:"p-3 text-gray-800 dark:text-gray-200",children:u.jsx("span",{className:"inline-flex items-center px-2.5 py-1 bg-purple-100 dark:bg-purple-900/50 text-purple-800 dark:text-purple-200 rounded-full text-xs font-medium border border-purple-300 dark:border-purple-600",children:i.chart_type||"N/A"})})]}),u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-700",children:[u.jsx("td",{className:"font-semibold text-purple-700 dark:text-purple-300 p-3 bg-purple-100/50 dark:bg-purple-900/30",children:" Description"}),u.jsx("td",{className:"p-3 text-gray-800 dark:text-gray-200",children:i.description||"N/A"})]}),c&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-700",children:[u.jsx("td",{className:"font-semibold text-purple-700 dark:text-purple-300 p-3 bg-purple-100/50 dark:bg-purple-900/30 align-top",children:" Chart Code"}),u.jsxs("td",{className:"p-3 text-gray-800 dark:text-gray-200 relative",children:[u.jsx("button",{onClick:p,className:"absolute top-2 right-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-md transition-colors duration-200 shadow-sm hover:shadow flex items-center gap-1.5 z-10",title:"Copy Mermaid code to clipboard",children:a?u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy Code"]})}),u.jsx("pre",{className:"whitespace-pre-wrap font-mono text-xs bg-gray-900 dark:bg-gray-950 text-green-400 dark:text-green-300 p-3 rounded border border-purple-200 dark:border-purple-700 max-h-96 overflow-y-auto pr-28",children:c})]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"font-semibold text-purple-700 dark:text-purple-300 p-3 bg-purple-100/50 dark:bg-purple-900/30 align-top",children:" Full Instructions"}),u.jsxs("td",{className:"p-3 text-gray-800 dark:text-gray-200 relative",children:[u.jsx("button",{onClick:d,className:"absolute top-2 right-2 px-3 py-1.5 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded-md transition-colors duration-200 shadow-sm hover:shadow flex items-center gap-1.5 z-10",title:"Copy full instructions to clipboard",children:r?u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy All"]})}),u.jsx("pre",{className:"whitespace-pre-wrap font-mono text-xs bg-white dark:bg-gray-900 p-3 rounded border border-purple-200 dark:border-purple-700 max-h-96 overflow-y-auto pr-28",children:i.instructions||"No instructions available"})]})]})]})})})}catch(i){return console.error("Error parsing generate_chart result:",i),u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-800 dark:text-gray-200",children:typeof t=="string"?t:JSON.stringify(t,null,2)})}},nbe=({videos:t,onOpenPlayer:e})=>{const{playTrack:r,addTracksToStart:n}=Ch(),a=s=>{n([{videoId:s.videoId,title:s.title,url:s.url,thumbnail:s.thumbnail,channel:s.channel,duration:s.duration}]),setTimeout(()=>{r(0),e&&e()},0)};return t.length===0?null:u.jsxs("div",{className:"youtube-video-results my-4 space-y-3",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 mb-3",children:[" YouTube Videos (",t.length,")"]}),t.map((s,i)=>u.jsxs("div",{onClick:()=>a(s),className:"flex gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors cursor-pointer",children:[s.thumbnail&&u.jsxs("div",{className:"flex-shrink-0 relative",children:[u.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-32 h-20 object-cover rounded"}),u.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("div",{className:"bg-black bg-opacity-60 rounded-full p-2",children:u.jsx("span",{className:"text-white text-2xl",children:""})})})]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"font-medium text-gray-900 dark:text-gray-100 truncate mb-1",children:s.title}),s.channel&&u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:s.channel}),s.description&&u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:s.description}),s.duration&&u.jsxs("span",{className:"inline-block text-xs text-gray-500 dark:text-gray-500 mt-1",children:[" ",s.duration]})]}),u.jsx("div",{className:"flex-shrink-0 flex items-center",children:u.jsxs("button",{onClick:l=>{l.stopPropagation(),a(s)},className:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",title:"Play video",children:[u.jsx("span",{className:"text-lg",children:""}),u.jsx("span",{className:"text-sm font-medium",children:"Play"})]})})]},s.videoId||i)),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:" All videos have been added to your playlist"})]})},abe=({results:t})=>{const[e,r]=N.useState(new Set),[n,a]=N.useState(new Set),s=l=>{r(c=>{const d=new Set(c);return d.has(l)?d.delete(l):d.add(l),d})},i=l=>{a(c=>{const d=new Set(c);return d.has(l)?d.delete(l):d.add(l),d})};return!t||t.length===0?null:u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-purple-800 dark:text-purple-200",children:[" Search Results (",t.length,")"]}),t.map((l,c)=>{const d=e.has(c),p=n.has(c),g={url:l.url,title:l.title,description:l.description,score:l.score,duckduckgoScore:l.duckduckgoScore,state:l.state,contentLength:l.contentLength,fetchTimeMs:l.fetchTimeMs,originalLength:l.originalLength,intelligentlyExtracted:l.intelligentlyExtracted,truncated:l.truncated,images_count:l.images?.length||0,youtube_count:l.youtube?.length||0,media_count:l.media?.length||0,links_count:l.links?.length||0,contentError:l.contentError};return u.jsxs("div",{className:"border border-purple-200 dark:border-purple-700 rounded-lg p-3 bg-purple-50/30 dark:bg-purple-900/10",children:[u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsxs("span",{className:"flex-shrink-0 text-purple-600 dark:text-purple-400 font-bold text-sm",children:["#",c+1]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"font-semibold text-purple-900 dark:text-purple-100 text-sm mb-1",children:l.title||`Result ${c+1}`}),l.url&&u.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-xs break-all block",children:l.url})]})]}),(l.description||l.snippet)&&u.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-xs mb-2 italic",children:l.description||l.snippet}),l.contentError&&u.jsx("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded p-2 mb-2",children:u.jsxs("span",{className:"text-xs text-red-700 dark:text-red-300",children:[" ",l.contentError]})}),u.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[l.contentLength!==void 0&&u.jsxs("span",{className:"text-[10px] px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 rounded",children:[(l.contentLength/1024).toFixed(1)," KB"]}),l.fetchTimeMs!==void 0&&u.jsxs("span",{className:"text-[10px] px-2 py-0.5 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 rounded",children:[l.fetchTimeMs,"ms"]}),l.images&&l.images.length>0&&u.jsxs("span",{className:"text-[10px] px-2 py-0.5 bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200 rounded",children:[" ",l.images.length]}),l.links&&l.links.length>0&&u.jsxs("span",{className:"text-[10px] px-2 py-0.5 bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200 rounded",children:[" ",l.links.length]}),l.truncated&&u.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 rounded",children:" Truncated"})]}),u.jsxs("div",{className:"flex gap-2",children:[l.content&&u.jsxs("button",{onClick:()=>s(c),className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors font-medium",children:[u.jsx("span",{children:d?"":""}),u.jsx("span",{children:"Content Sent to LLM"}),l.originalLength&&u.jsxs("span",{className:"opacity-75",children:["(",(l.originalLength/1024).toFixed(1)," KB)"]})]}),u.jsxs("button",{onClick:()=>i(c),className:"flex items-center gap-1 px-3 py-1.5 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors font-medium",children:[u.jsx("span",{children:p?"":""}),u.jsx("span",{children:"Metadata JSON"})]})]}),d&&l.content&&u.jsxs("div",{className:"mt-3 pt-3 border-t border-purple-200 dark:border-purple-700",children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-800 dark:text-purple-200 mb-2",children:[" Content Sent to LLM:",l.intelligentlyExtracted&&u.jsx("span",{className:"ml-2 text-green-600 dark:text-green-400",children:" Intelligently Extracted"})]}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded border border-purple-200 dark:border-purple-700 p-3 max-h-96 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-800 dark:text-gray-200 leading-relaxed font-mono",children:l.content})})]}),p&&u.jsxs("div",{className:"mt-3 pt-3 border-t border-purple-200 dark:border-purple-700",children:[u.jsx("div",{className:"text-xs font-semibold text-blue-800 dark:text-blue-200 mb-2",children:" Scrape Metadata:"}),u.jsx("div",{className:"bg-white dark:bg-gray-900 rounded border border-blue-200 dark:border-blue-700 p-3 max-h-96 overflow-y-auto",children:u.jsx(Qg,{data:g})})]})]},c)})]})},sbe=({isOpen:t,onClose:e,onExampleClick:r,location:n,locationLoading:a,requestLocation:s,clearLocation:i})=>{if(!t)return null;const l=c=>{r(c),e()};return Ur.useEffect(()=>{const c=d=>{d.key==="Escape"&&e()};if(t)return document.addEventListener("keydown",c),()=>document.removeEventListener("keydown",c)},[t,e]),u.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/70 backdrop-blur-sm p-4",onClick:e,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-7xl max-h-[90vh] overflow-hidden flex flex-col",onClick:c=>c.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:" Example Prompts"}),u.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors","aria-label":"Close",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"overflow-y-auto p-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Web Search & Research"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("What are the latest developments in artificial intelligence this week?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Latest AI developments"}),u.jsx("button",{onClick:()=>l("Find current news about climate change policy updates"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Climate change policy news"}),u.jsx("button",{onClick:()=>l("What is the current stock price of Tesla and recent news about the company?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Stock price lookup with news"}),u.jsx("button",{onClick:()=>l("Search for recent scientific breakthroughs in quantum computing"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Scientific research updates"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" YouTube Search & Transcripts"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Find YouTube videos about TypeScript best practices"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search YouTube videos"}),u.jsx("button",{onClick:()=>l("Get transcript with timestamps from https://www.youtube.com/watch?v=dQw4w9WgXcQ"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Get YouTube transcript (with timestamps)"}),u.jsx("button",{onClick:()=>l("Find the top 5 Python tutorial videos and summarize their content"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search + batch summarize videos"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" 3 YouTube tools available"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Audio/Video Transcription (Whisper AI)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Transcribe this: http://localhost:3000/samples/long-form-ai-speech.mp3"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:" Local Dev: AI & ML discussion (~4min)"}),u.jsx("button",{onClick:()=>l("Transcribe this: https://llmproxy-media-samples.s3.amazonaws.com/audio/long-form-ai-speech.mp3"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Transcribe: AI & ML discussion (~4min)"}),u.jsx("button",{onClick:()=>l("Transcribe this YouTube video: https://www.youtube.com/watch?v=dQw4w9WgXcQ"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Transcribe YouTube video"}),u.jsx("button",{onClick:()=>l("Transcribe this audio file: https://llmproxy-media-samples.s3.amazonaws.com/audio/hello-test.wav and summarize it"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Transcribe + auto-summarize"}),u.jsxs("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:[" OpenAI Whisper with progress tracking",u.jsx("br",{})," Local dev example only works with localhost backend"]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Math & Calculations (JavaScript Sandbox)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Calculate compound interest on $10,000 at 7% annual rate for 15 years"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Compound interest calculator"}),u.jsx("button",{onClick:()=>l("Generate a multiplication table for numbers 1-12"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Multiplication table"}),u.jsx("button",{onClick:()=>l("Calculate the Fibonacci sequence up to the 20th number"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Fibonacci sequence"}),u.jsx("button",{onClick:()=>l("Convert 100 USD to EUR, GBP, and JPY at current exchange rates"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Currency conversion"}),u.jsx("button",{onClick:()=>l("Calculate my BMI if I weigh 70kg and am 175cm tall"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"BMI calculator"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Secure sandbox execution"})]})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Charts & Diagrams (Mermaid.js)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Create a flowchart showing the software development lifecycle from planning to deployment"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Flowchart: Dev lifecycle"}),u.jsx("button",{onClick:()=>l("Show a sequence diagram for user authentication with OAuth 2.0"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Sequence: OAuth flow"}),u.jsx("button",{onClick:()=>l("Generate a Gantt chart for a 3-month web app project"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Gantt: Project timeline"}),u.jsx("button",{onClick:()=>l("Create a class diagram for an e-commerce system with User, Order, and Product"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Class diagram: E-commerce"}),u.jsx("button",{onClick:()=>l("Show a state diagram for an order processing system"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"State diagram: Order processing"}),u.jsx("button",{onClick:()=>l("Create an ER diagram for a blog database with Users, Posts, Comments"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"ER diagram: Blog schema"}),u.jsx("button",{onClick:()=>l("Show a pie chart of renewable energy distribution: Solar 30%, Wind 35%, Hydro 25%, Geo 10%"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Pie chart: Energy sources"}),u.jsx("button",{onClick:()=>l("Create a mindmap for planning a mobile app development project"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Mindmap: App planning"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" 9 chart types with auto-fix"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Web Scraping & Content Extraction"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Scrape and summarize https://news.ycombinator.com"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Scrape: Hacker News"}),u.jsx("button",{onClick:()=>l("Extract key points from https://en.wikipedia.org/wiki/Artificial_intelligence"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Extract: Wikipedia article"}),u.jsx("button",{onClick:()=>l("Get the full documentation from https://react.dev/learn"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Scrape: React docs"}),u.jsx("button",{onClick:()=>l("Analyze this GitHub repo: https://github.com/microsoft/TypeScript"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Scrape: GitHub repository"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Universal scraper"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Browser Automation (Selenium)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Scrape https://www.linkedin.com/login and tell me what you see - this requires login"),className:"w-full text-left px-3 py-2 text-sm rounded bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-800 dark:text-amber-300 transition-colors border border-amber-200 dark:border-amber-800",children:" Login Required: LinkedIn"}),u.jsx("button",{onClick:()=>l("Access https://twitter.com/home and get the latest tweets - requires authentication"),className:"w-full text-left px-3 py-2 text-sm rounded bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-800 dark:text-amber-300 transition-colors border border-amber-200 dark:border-amber-800",children:" Login Required: Twitter/X"}),u.jsx("button",{onClick:()=>l("Get content from https://www.instagram.com/instagram/ - login needed to view posts"),className:"w-full text-left px-3 py-2 text-sm rounded bg-amber-50 dark:bg-amber-900/20 hover:bg-amber-100 dark:hover:bg-amber-900/30 text-amber-800 dark:text-amber-300 transition-colors border border-amber-200 dark:border-amber-800",children:" Login Required: Instagram"}),u.jsx("button",{onClick:()=>l("Scrape https://www.google.com/recaptcha/api2/demo and complete the captcha challenge"),className:"w-full text-left px-3 py-2 text-sm rounded bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 text-red-800 dark:text-red-300 transition-colors border border-red-200 dark:border-red-800",children:" CAPTCHA: Google reCAPTCHA v2"}),u.jsx("button",{onClick:()=>l("Access https://2captcha.com/demo/recaptcha-v2 and solve the captcha"),className:"w-full text-left px-3 py-2 text-sm rounded bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/30 text-red-800 dark:text-red-300 transition-colors border border-red-200 dark:border-red-800",children:" CAPTCHA: reCAPTCHA Demo Site"}),u.jsx("p",{className:"px-3 py-2 text-xs text-amber-600 dark:text-amber-400 italic",children:" Opens browser for manual login/CAPTCHA solving"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Tier 3/4: Selenium with interactive mode (local only)"})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400",children:" Location-Based Services"}),u.jsx("button",{onClick:async()=>{n?i():await s()},className:`px-2 py-1 text-xs rounded transition-colors ${n?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/50":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,title:n?"Location enabled - Click to disable":"Location disabled - Click to enable",children:a?"":n?" Enabled":" Disabled"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Find the top 5 restaurants near my current location"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Find nearby restaurants"}),u.jsx("button",{onClick:()=>l("Search for coffee shops within 2 miles that are open now"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Find open coffee shops"}),u.jsx("button",{onClick:()=>l("What is the weather forecast for my location for the next 3 days?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Local weather forecast"}),u.jsx("button",{onClick:()=>l("Find the nearest hospital or emergency room"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Find nearest hospital"}),u.jsx("button",{onClick:()=>l("What tourist attractions are in my area?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Find local attractions"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Privacy-first location"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" AI Image Generation"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Generate an image of a serene mountain landscape at sunset with golden light"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Landscape: Mountain sunset"}),u.jsx("button",{onClick:()=>l("Create a photorealistic portrait of a professional business woman smiling"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Portrait: Business professional"}),u.jsx("button",{onClick:()=>l("Generate a cartoon-style illustration of a friendly robot helping humans"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Cartoon: Friendly robot"}),u.jsx("button",{onClick:()=>l("Create a fast sketch of a coffee cup on a desk"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Quick sketch: Coffee cup"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Smart model selection"})]})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Internal Knowledge Base (RAG)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("How do I configure OpenAI embeddings in this project?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search: OpenAI config"}),u.jsx("button",{onClick:()=>l("What is the RAG implementation in this codebase?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search: RAG system"}),u.jsx("button",{onClick:()=>l("How do I deploy Lambda functions in this project?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search: Lambda deployment"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Semantic search with RAG"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Data Analysis & Comparison"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Compare population growth rates of the top 5 most populous countries"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Compare: Population growth"}),u.jsx("button",{onClick:()=>l("What are the key differences between Python and JavaScript?"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Compare: Python vs JavaScript"}),u.jsx("button",{onClick:()=>l("Analyze pros and cons of renewable energy sources"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Analyze: Renewable energy"}),u.jsx("button",{onClick:()=>l("Compare the performance benchmarks of React, Vue, and Angular"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Compare: JS frameworks"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Multi-Step Workflows (Backend Todos)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Create a complete React blog application with authentication, post creation, and comments. Break this down into steps and implement each one."),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Build: React blog app"}),u.jsx("button",{onClick:()=>l("Help me set up a full CI/CD pipeline for my Node.js app. Plan out all the steps needed and execute them in order."),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Setup: CI/CD pipeline"}),u.jsx("button",{onClick:()=>l("Migrate my Express server from JavaScript to TypeScript. Create a step-by-step plan and execute each phase."),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Migrate: JS to TypeScript"}),u.jsx("button",{onClick:()=>l("Set up a complete AWS deployment for my application including VPC, RDS database, Lambda functions, and API Gateway. Plan and implement this step by step."),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Deploy: AWS infrastructure"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Auto-progresses through steps (max 5 iterations)"})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-bold text-gray-500 dark:text-gray-400 mb-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:" Knowledge Snippets (Google Sheets)"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l('Save this code example to my snippets with tags "javascript" and "async": async function fetchData() { const response = await fetch(url); return response.json(); }'),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Save: Code snippet"}),u.jsx("button",{onClick:()=>l("Remember this information: TypeScript 5.0 introduced const type parameters for generic functions"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Save: Quick note"}),u.jsx("button",{onClick:()=>l('Search my snippets for "react hooks"'),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search: Saved snippets"}),u.jsx("button",{onClick:()=>l('Find all my snippets tagged with "python"'),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 transition-colors",children:"Search: By tag"}),u.jsx("p",{className:"px-3 py-2 text-xs text-gray-500 dark:text-gray-500 italic",children:" Stored in your personal Google Sheet"})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center mb-2 pb-2 border-b border-amber-300 dark:border-amber-600",children:[u.jsx("h3",{className:"text-sm font-bold text-amber-600 dark:text-amber-400",children:" Recursive Agent (ask_llm)"}),u.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 bg-amber-200 dark:bg-amber-900/50 text-amber-800 dark:text-amber-300 rounded font-semibold",children:" HIGH TOKENS"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Search for recent quantum computing research papers, scrape the top 3, analyze their methodologies, and create a comprehensive comparison table"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-amber-50 dark:hover:bg-amber-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-amber-300",children:"Multi-step research + analysis"}),u.jsx("button",{onClick:()=>l("Find Python async/await tutorials, analyze the best one, extract code examples, and generate a beginner-friendly explanation with working examples"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-amber-50 dark:hover:bg-amber-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-amber-300",children:"Tutorial extraction + synthesis"}),u.jsx("button",{onClick:()=>l("Search for the latest TypeScript features, create a detailed summary, generate code examples, and save the best practices to my snippets"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-amber-50 dark:hover:bg-amber-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-amber-300",children:"Research + documentation + save"}),u.jsxs("p",{className:"px-3 py-2 text-xs text-amber-600 dark:text-amber-500 italic bg-amber-50 dark:bg-amber-900/20 rounded border border-amber-200 dark:border-amber-800",children:[" Spawns sub-agent with full tool access",u.jsx("br",{})," Uses 5-10x more tokens",u.jsx("br",{})," Enable in Settings first"]})]})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center mb-2 pb-2 border-b border-red-400 dark:border-red-600",children:[u.jsx("h3",{className:"text-sm font-bold text-red-600 dark:text-red-400",children:" Advanced Reasoning (o1/DeepSeek-R1)"}),u.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 bg-red-300 dark:bg-red-900/50 text-red-900 dark:text-red-300 rounded font-bold animate-pulse",children:" EXTREME"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("button",{onClick:()=>l("Prove that the square root of 2 is irrational using a step-by-step logical proof with explicit reasoning"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-red-300",children:"Mathematical proof (irrationality)"}),u.jsx("button",{onClick:()=>l("Analyze the time complexity of quicksort and prove why it is O(n log n) on average with detailed step-by-step reasoning"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-red-300",children:"Algorithm complexity proof"}),u.jsx("button",{onClick:()=>l("Design a normalized database schema for an e-commerce platform with explicit reasoning about normalization tradeoffs, performance implications, and scalability considerations"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-red-300",children:"Architecture design + reasoning"}),u.jsx("button",{onClick:()=>l("Debug this code and explain the logical steps to identify the bug: function fibonacci(n) { if (n <= 1) return n; return fibonacci(n-1) + fibonacci(n-3); }"),className:"w-full text-left px-3 py-2 text-sm rounded hover:bg-red-50 dark:hover:bg-red-900/20 text-gray-700 dark:text-gray-300 transition-colors border border-transparent hover:border-red-300",children:"Logical debugging analysis"}),u.jsxs("p",{className:"px-3 py-2 text-xs text-red-700 dark:text-red-500 italic bg-red-50 dark:bg-red-900/20 rounded border border-red-300 dark:border-red-800 font-semibold",children:[" Uses OpenAI o1 or DeepSeek-R1",u.jsx("br",{})," Maximum reasoning depth",u.jsx("br",{})," Uses 10-50x MORE tokens",u.jsx("br",{})," Enable in Settings first"]})]})]})]})]})})]})})},ibe=({systemPrompt:t,setSystemPrompt:e})=>{const[r,n]=N.useState(!1),[a,s]=N.useState(!1),[i,l]=N.useState("");return t?u.jsx("div",{className:"p-2 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800",children:u.jsx("div",{className:"flex items-start gap-2 max-w-screen-2xl mx-auto",children:a?u.jsxs(u.Fragment,{children:[u.jsx("textarea",{value:i,onChange:c=>l(c.target.value),className:"flex-1 text-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-900 border border-gray-300 dark:border-gray-600 rounded p-2 min-h-[80px] resize-y focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter system prompt..."}),u.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[u.jsx("button",{onClick:()=>{e(i),s(!1)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",title:"Save system prompt",children:"Save"}),u.jsx("button",{onClick:()=>{l(t),s(!1)},className:"px-3 py-1.5 bg-gray-400 hover:bg-gray-500 text-white text-xs rounded transition-colors",title:"Cancel editing",children:"Cancel"})]})]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex-1 text-sm text-gray-700 dark:text-gray-300 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700 p-1 rounded transition-colors",onClick:()=>n(!r),title:r?"Click to collapse":"Click to expand",children:r?t:t.length>200?t.substring(0,200)+"...":t}),u.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[u.jsx("button",{onClick:()=>{l(t),s(!0),n(!0)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs rounded transition-colors",title:"Edit system prompt",children:"Edit"}),u.jsx("button",{onClick:()=>{confirm("Clear the system prompt?")&&(e(""),s(!1))},className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 text-white text-xs rounded transition-colors",title:"Clear system prompt",children:"Clear"})]})]})})}):null},obe=({systemPrompt:t,selectedSnippetIds:e,showSnippetsPanel:r,messageCount:n,onNewChat:a,onShowLoadDialog:s,onToggleSnippetsPanel:i,onShowExamplesModal:l,onShowShareDialog:c,onGenerateQuiz:d,onGenerateFeed:p})=>{const{t:g}=Lc(),m=Xi();return u.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 md:px-4 py-2 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex flex-wrap gap-2 flex-1",children:[u.jsxs("button",{onClick:a,className:"bg-green-600 hover:bg-green-700 text-white p-2 md:px-3 md:py-1.5 rounded font-medium text-sm transition-colors flex items-center gap-1.5",title:g("chat.newChat"),"aria-label":g("chat.newChat"),children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:g("chat.newChat")})]}),u.jsxs("button",{onClick:s,className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5",title:g("chat.chatHistory"),"aria-label":g("chat.chatHistory"),children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:g("chat.history")})]}),u.jsxs("button",{onClick:()=>m("/planning"),className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5",title:t?"Edit system prompt and planning":"Create a plan","aria-label":g(t?"chat.editPlan":"chat.makeAPlan"),children:[u.jsx("span",{children:t?"":""}),u.jsx("span",{className:"hidden md:inline",children:g(t?"chat.editPlan":"chat.makeAPlan")})]}),u.jsxs("button",{onClick:l,className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5",title:g("chat.examples"),"aria-label":g("chat.examples"),children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:g("chat.examples")})]}),u.jsxs("button",{onClick:c,className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5",title:"Share this conversation","aria-label":"Share conversation",disabled:n===0,children:[u.jsx(xI,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden md:inline",children:"Share"})]}),u.jsxs("button",{onClick:i,className:`text-sm p-2 md:px-3 md:py-1.5 rounded font-medium transition-colors flex items-center gap-1.5 ${r?"bg-blue-600 hover:bg-blue-700 text-white":"btn-secondary"}`,title:g("chat.attachContextTooltip"),"aria-label":g("chat.attachContext"),children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:g("chat.attachContext")}),e.size>0&&u.jsx("span",{className:"ml-1 px-1.5 py-0.5 text-xs bg-white text-blue-600 rounded-full font-bold",children:e.size})]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:d,disabled:n===0,className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate quiz from conversation","aria-label":"Generate quiz",children:[u.jsx(I0,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden md:inline",children:"Quiz"})]}),u.jsxs("button",{onClick:p,disabled:n===0,className:"btn-secondary text-sm p-2 md:px-3 md:py-1.5 flex items-center gap-1.5 disabled:opacity-50 disabled:cursor-not-allowed",title:"Generate feed from conversation","aria-label":"Generate feed",children:[u.jsx(bI,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden md:inline",children:"Feed"})]})]})]})},lbe=({attachedFiles:t,onRemoveAttachment:e})=>t.length===0?null:u.jsx("div",{className:"flex flex-wrap gap-2 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:t.map((r,n)=>u.jsxs("div",{className:"relative group bg-white dark:bg-gray-700 rounded-lg border border-gray-300 dark:border-gray-600 p-2 flex items-center gap-2",children:[r.preview?u.jsx("img",{src:r.preview,alt:r.name,className:"w-12 h-12 object-cover rounded"}):u.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-red-100 dark:bg-red-900/30 rounded",children:u.jsx("svg",{className:"w-6 h-6 text-red-600 dark:text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-xs font-medium text-gray-900 dark:text-gray-100 truncate max-w-[150px]",children:r.name}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(r.size/1024).toFixed(1)," KB"]})]}),u.jsx("button",{onClick:()=>e(n),className:"opacity-0 group-hover:opacity-100 transition-opacity absolute -top-2 -right-2 bg-red-500 hover:bg-red-600 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",title:"Remove file",children:""})]},n))}),cbe=({isDragging:t})=>t?u.jsx("div",{className:"absolute inset-0 z-50 bg-blue-500/20 dark:bg-blue-400/20 backdrop-blur-sm flex items-center justify-center border-4 border-dashed border-blue-500 dark:border-blue-400",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 shadow-2xl",children:u.jsxs("div",{className:"text-center",children:[u.jsx("svg",{className:"w-16 h-16 mx-auto mb-4 text-blue-500 dark:text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),u.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Drop files here"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Images (JPEG, PNG, GIF, WebP) and PDFs supported"}),u.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:"Max: 5MB for images, 10MB for PDFs"})]})})}):null,ube=({messages:t,onClose:e,title:r,plan:n})=>{const[a,s]=N.useState(""),[i,l]=N.useState(!1),[c,d]=N.useState(!1),[p,g]=N.useState({original:0,included:0}),[m,y]=N.useState(!0);N.useEffect(()=>{try{const D=Fye(t,{title:r,plan:n});let B=zye(D);B=B.replace(window.location.origin,"https://ai.syntithenai.com"),s(B);const $=mS(D);$?.metadata.truncated&&(d(!0),g({original:$.metadata.originalMessageCount,included:$.metadata.includedMessageCount}))}catch(D){console.error("Failed to generate share URL:",D)}finally{y(!1)}},[t,r,n]);const x=async()=>{try{await navigator.clipboard.writeText(a),l(!0),setTimeout(()=>l(!1),2e3)}catch(D){console.error("Failed to copy to clipboard:",D)}},w=()=>{const D=encodeURIComponent(`Check out this AI conversation: ${r||"Untitled Chat"}`),B=encodeURIComponent(a);window.open(`https://twitter.com/intent/tweet?text=${D}&url=${B}`,"_blank")},T=()=>{const D=encodeURIComponent(a);window.open(`https://www.reddit.com/submit?url=${D}`,"_blank")},k=()=>{const D=encodeURIComponent(`AI Conversation: ${r||"Untitled Chat"}`),B=encodeURIComponent(`Check out this AI conversation:

${a}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&su=${D}&body=${B}`,"_blank")},_=()=>{const D=encodeURIComponent(a);window.open(`https://www.facebook.com/sharer/sharer.php?u=${D}`,"_blank")},P=()=>{const D=encodeURIComponent(`Check out this AI conversation: ${r||"Untitled Chat"}

${a}`);window.open(`https://bsky.app/intent/compose?text=${D}`,"_blank")},F=()=>{const D=encodeURIComponent(a);window.open(`https://www.quora.com/share?url=${D}`,"_blank")};return m?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),u.jsx("span",{className:"ml-3",children:"Generating share link..."})]})})}):u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",onClick:e,children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",onClick:D=>D.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Share Conversation"}),u.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c&&u.jsx("div",{className:"m-6 p-4 bg-yellow-50 dark:bg-yellow-900 border-l-4 border-yellow-400 dark:border-yellow-600",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),u.jsxs("div",{className:"ml-3",children:[u.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"Conversation Truncated"}),u.jsx("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:u.jsxs("p",{children:["Due to URL length limits, this share link includes ",p.included," of ",p.original," messages. The first and last messages are always preserved."]})})]})]})}),u.jsxs("div",{className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Shareable URL"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:a,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white font-mono text-sm",onClick:D=>D.target.select()}),u.jsx("button",{onClick:x,className:`px-4 py-2 rounded-md font-medium transition-colors ${i?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:i?u.jsxs("span",{className:"flex items-center gap-2",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):"Copy"})]}),u.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["URL length: ",a.length.toLocaleString()," characters"]})]}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Scan with Mobile Device"}),a.length>2953?u.jsxs("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900 border border-yellow-200 dark:border-yellow-700 rounded-lg text-center",children:[u.jsx("svg",{className:"w-12 h-12 mx-auto mb-2 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),u.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium",children:"URL too long for QR code"}),u.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 mt-1",children:'Use the "Copy" button above to share the link'})]}):u.jsx("div",{className:"p-4 bg-white rounded-lg border border-gray-200",children:u.jsx(rT,{value:a,size:200,level:"M"})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"Share On"}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-3 gap-3",children:[u.jsxs("button",{onClick:w,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1DA1F2] text-white rounded-md hover:bg-[#1a8cd8] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X"]}),u.jsxs("button",{onClick:T,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#FF4500] text-white rounded-md hover:bg-[#e03d00] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),u.jsxs("button",{onClick:_,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#1877F2] text-white rounded-md hover:bg-[#166fe5] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),u.jsxs("button",{onClick:P,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#0085ff] text-white rounded-md hover:bg-[#0073e6] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 10.8c-1.087-2.114-4.046-6.053-6.798-7.995C2.566.944 1.561 1.266.902 1.565.139 1.908 0 3.08 0 3.768c0 .69.378 5.65.624 6.479.815 2.736 3.713 3.66 6.383 3.364.136-.02.275-.039.415-.056-.138.022-.276.04-.415.056-3.912.58-7.387 2.005-2.83 7.078 5.013 5.19 6.87-1.113 7.823-4.308.953 3.195 2.05 9.271 7.733 4.308 4.267-4.308 1.172-6.498-2.74-7.078a8.741 8.741 0 0 1-.415-.056c.14.017.279.036.415.056 2.67.297 5.568-.628 6.383-3.364.246-.828.624-5.79.624-6.478 0-.69-.139-1.861-.902-2.206-.659-.298-1.664-.62-4.3 1.24C16.046 4.748 13.087 8.687 12 10.8z"})}),"Bluesky"]}),u.jsxs("button",{onClick:F,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#B92B27] text-white rounded-md hover:bg-[#a02522] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12.738 18.701c-.831-1.635-1.805-3.287-3.708-3.287-.362 0-.727.061-1.059.209l-.704-1.403c.498-.166 1.023-.25 1.561-.25 2.944 0 4.424 2.587 5.429 4.734l1.904-.003c.271-.928.406-1.895.406-2.888C16.567 8.283 14.284 6 11.754 6c-2.529 0-4.812 2.283-4.812 5.813s2.283 5.813 4.812 5.813c.367 0 .724-.043 1.076-.126.035-.009.068-.021.102-.031l.806 1.585c-.413.116-.843.177-1.284.177C8.704 19.231 6 16.529 6 12.779 6 9.03 8.704 6.328 12.454 6.328c3.75 0 6.451 2.702 6.451 6.451 0 1.488-.403 2.884-1.106 4.086l.03.062-1.599.003c.377-.641.661-1.334.842-2.054h-1.334c-.271.771-.659 1.479-1.137 2.102l-1.863.003c.377-.641.661-1.334.842-2.054z"})}),"Quora"]}),u.jsxs("button",{onClick:k,className:"flex items-center justify-center gap-2 px-4 py-3 bg-[#EA4335] text-white rounded-md hover:bg-[#d33426] transition-colors",children:[u.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M24 5.457v13.909c0 .904-.732 1.636-1.636 1.636h-3.819V11.73L12 16.64l-6.545-4.91v9.273H1.636A1.636 1.636 0 0 1 0 19.366V5.457c0-2.023 2.309-3.178 3.927-1.964L5.455 4.64 12 9.548l6.545-4.91 1.528-1.145C21.69 2.28 24 3.434 24 5.457z"})}),"Gmail"]})]})]}),u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[u.jsx("p",{children:" Anyone with this URL can view the conversation"}),u.jsx("p",{children:" Share data is compressed and encoded in the URL itself (no server storage)"}),u.jsx("p",{children:" Links never expire and work offline once loaded"})]})]}),u.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:u.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:"Close"})})]})})};var aT={};(function t(e,r,n,a){var s=!!(e.Worker&&e.Blob&&e.Promise&&e.OffscreenCanvas&&e.OffscreenCanvasRenderingContext2D&&e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype.transferControlToOffscreen&&e.URL&&e.URL.createObjectURL),i=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=(function(){if(!e.OffscreenCanvas)return!1;try{var O=new OffscreenCanvas(1,1),I=O.getContext("2d");I.fillRect(0,0,1,1);var K=O.transferToImageBitmap();I.createPattern(K,"no-repeat")}catch{return!1}return!0})();function c(){}function d(O){var I=r.exports.Promise,K=I!==void 0?I:e.Promise;return typeof K=="function"?new K(O):(O(c,c),null)}var p=(function(O,I){return{transform:function(K){if(O)return K;if(I.has(K))return I.get(K);var U=new OffscreenCanvas(K.width,K.height),ce=U.getContext("2d");return ce.drawImage(K,0,0),I.set(K,U),U},clear:function(){I.clear()}}})(l,new Map),g=(function(){var O=Math.floor(16.666666666666668),I,K,U={},ce=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(I=function(ye){var Ae=Math.random();return U[Ae]=requestAnimationFrame(function fe(Ne){ce===Ne||ce+O-1<Ne?(ce=Ne,delete U[Ae],ye()):U[Ae]=requestAnimationFrame(fe)}),Ae},K=function(ye){U[ye]&&cancelAnimationFrame(U[ye])}):(I=function(ye){return setTimeout(ye,O)},K=function(ye){return clearTimeout(ye)}),{frame:I,cancel:K}})(),m=(function(){var O,I,K={};function U(ce){function ye(Ae,fe){ce.postMessage({options:Ae||{},callback:fe})}ce.init=function(fe){var Ne=fe.transferControlToOffscreen();ce.postMessage({canvas:Ne},[Ne])},ce.fire=function(fe,Ne,Te){if(I)return ye(fe,null),I;var se=Math.random().toString(36).slice(2);return I=d(function(be){function xe(me){me.data.callback===se&&(delete K[se],ce.removeEventListener("message",xe),I=null,p.clear(),Te(),be())}ce.addEventListener("message",xe),ye(fe,se),K[se]=xe.bind(null,{data:{callback:se}})}),I},ce.reset=function(){ce.postMessage({reset:!0});for(var fe in K)K[fe](),delete K[fe]}}return function(){if(O)return O;if(!n&&s){var ce=["var CONFETTI, SIZE = {}, module = {};","("+t.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{O=new Worker(URL.createObjectURL(new Blob([ce])))}catch(ye){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",ye),null}U(O)}return O}})(),y={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function x(O,I){return I?I(O):O}function w(O){return O!=null}function T(O,I,K){return x(O&&w(O[I])?O[I]:y[I],K)}function k(O){return O<0?0:Math.floor(O)}function _(O,I){return Math.floor(Math.random()*(I-O))+O}function P(O){return parseInt(O,16)}function F(O){return O.map(D)}function D(O){var I=String(O).replace(/[^0-9a-f]/gi,"");return I.length<6&&(I=I[0]+I[0]+I[1]+I[1]+I[2]+I[2]),{r:P(I.substring(0,2)),g:P(I.substring(2,4)),b:P(I.substring(4,6))}}function B(O){var I=T(O,"origin",Object);return I.x=T(I,"x",Number),I.y=T(I,"y",Number),I}function M(O){O.width=document.documentElement.clientWidth,O.height=document.documentElement.clientHeight}function $(O){var I=O.getBoundingClientRect();O.width=I.width,O.height=I.height}function Z(O){var I=document.createElement("canvas");return I.style.position="fixed",I.style.top="0px",I.style.left="0px",I.style.pointerEvents="none",I.style.zIndex=O,I}function z(O,I,K,U,ce,ye,Ae,fe,Ne){O.save(),O.translate(I,K),O.rotate(ye),O.scale(U,ce),O.arc(0,0,1,Ae,fe,Ne),O.restore()}function ee(O){var I=O.angle*(Math.PI/180),K=O.spread*(Math.PI/180);return{x:O.x,y:O.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:O.startVelocity*.5+Math.random()*O.startVelocity,angle2D:-I+(.5*K-Math.random()*K),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:O.color,shape:O.shape,tick:0,totalTicks:O.ticks,decay:O.decay,drift:O.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:O.gravity*3,ovalScalar:.6,scalar:O.scalar,flat:O.flat}}function te(O,I){I.x+=Math.cos(I.angle2D)*I.velocity+I.drift,I.y+=Math.sin(I.angle2D)*I.velocity+I.gravity,I.velocity*=I.decay,I.flat?(I.wobble=0,I.wobbleX=I.x+10*I.scalar,I.wobbleY=I.y+10*I.scalar,I.tiltSin=0,I.tiltCos=0,I.random=1):(I.wobble+=I.wobbleSpeed,I.wobbleX=I.x+10*I.scalar*Math.cos(I.wobble),I.wobbleY=I.y+10*I.scalar*Math.sin(I.wobble),I.tiltAngle+=.1,I.tiltSin=Math.sin(I.tiltAngle),I.tiltCos=Math.cos(I.tiltAngle),I.random=Math.random()+2);var K=I.tick++/I.totalTicks,U=I.x+I.random*I.tiltCos,ce=I.y+I.random*I.tiltSin,ye=I.wobbleX+I.random*I.tiltCos,Ae=I.wobbleY+I.random*I.tiltSin;if(O.fillStyle="rgba("+I.color.r+", "+I.color.g+", "+I.color.b+", "+(1-K)+")",O.beginPath(),i&&I.shape.type==="path"&&typeof I.shape.path=="string"&&Array.isArray(I.shape.matrix))O.fill(re(I.shape.path,I.shape.matrix,I.x,I.y,Math.abs(ye-U)*.1,Math.abs(Ae-ce)*.1,Math.PI/10*I.wobble));else if(I.shape.type==="bitmap"){var fe=Math.PI/10*I.wobble,Ne=Math.abs(ye-U)*.1,Te=Math.abs(Ae-ce)*.1,se=I.shape.bitmap.width*I.scalar,be=I.shape.bitmap.height*I.scalar,xe=new DOMMatrix([Math.cos(fe)*Ne,Math.sin(fe)*Ne,-Math.sin(fe)*Te,Math.cos(fe)*Te,I.x,I.y]);xe.multiplySelf(new DOMMatrix(I.shape.matrix));var me=O.createPattern(p.transform(I.shape.bitmap),"no-repeat");me.setTransform(xe),O.globalAlpha=1-K,O.fillStyle=me,O.fillRect(I.x-se/2,I.y-be/2,se,be),O.globalAlpha=1}else if(I.shape==="circle")O.ellipse?O.ellipse(I.x,I.y,Math.abs(ye-U)*I.ovalScalar,Math.abs(Ae-ce)*I.ovalScalar,Math.PI/10*I.wobble,0,2*Math.PI):z(O,I.x,I.y,Math.abs(ye-U)*I.ovalScalar,Math.abs(Ae-ce)*I.ovalScalar,Math.PI/10*I.wobble,0,2*Math.PI);else if(I.shape==="star")for(var de=Math.PI/2*3,he=4*I.scalar,Ie=8*I.scalar,ze=I.x,nt=I.y,mt=5,ht=Math.PI/mt;mt--;)ze=I.x+Math.cos(de)*Ie,nt=I.y+Math.sin(de)*Ie,O.lineTo(ze,nt),de+=ht,ze=I.x+Math.cos(de)*he,nt=I.y+Math.sin(de)*he,O.lineTo(ze,nt),de+=ht;else O.moveTo(Math.floor(I.x),Math.floor(I.y)),O.lineTo(Math.floor(I.wobbleX),Math.floor(ce)),O.lineTo(Math.floor(ye),Math.floor(Ae)),O.lineTo(Math.floor(U),Math.floor(I.wobbleY));return O.closePath(),O.fill(),I.tick<I.totalTicks}function X(O,I,K,U,ce){var ye=I.slice(),Ae=O.getContext("2d"),fe,Ne,Te=d(function(se){function be(){fe=Ne=null,Ae.clearRect(0,0,U.width,U.height),p.clear(),ce(),se()}function xe(){n&&!(U.width===a.width&&U.height===a.height)&&(U.width=O.width=a.width,U.height=O.height=a.height),!U.width&&!U.height&&(K(O),U.width=O.width,U.height=O.height),Ae.clearRect(0,0,U.width,U.height),ye=ye.filter(function(me){return te(Ae,me)}),ye.length?fe=g.frame(xe):be()}fe=g.frame(xe),Ne=be});return{addFettis:function(se){return ye=ye.concat(se),Te},canvas:O,promise:Te,reset:function(){fe&&g.cancel(fe),Ne&&Ne()}}}function Q(O,I){var K=!O,U=!!T(I||{},"resize"),ce=!1,ye=T(I,"disableForReducedMotion",Boolean),Ae=s&&!!T(I||{},"useWorker"),fe=Ae?m():null,Ne=K?M:$,Te=O&&fe?!!O.__confetti_initialized:!1,se=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,be;function xe(de,he,Ie){for(var ze=T(de,"particleCount",k),nt=T(de,"angle",Number),mt=T(de,"spread",Number),ht=T(de,"startVelocity",Number),er=T(de,"decay",Number),ct=T(de,"gravity",Number),Dt=T(de,"drift",Number),kt=T(de,"colors",F),fr=T(de,"ticks",Number),qe=T(de,"shapes"),st=T(de,"scalar"),Gt=!!T(de,"flat"),Kt=B(de),lr=ze,Qe=[],Yt=O.width*Kt.x,ur=O.height*Kt.y;lr--;)Qe.push(ee({x:Yt,y:ur,angle:nt,spread:mt,startVelocity:ht,color:kt[lr%kt.length],shape:qe[_(0,qe.length)],ticks:fr,decay:er,gravity:ct,drift:Dt,scalar:st,flat:Gt}));return be?be.addFettis(Qe):(be=X(O,Qe,Ne,he,Ie),be.promise)}function me(de){var he=ye||T(de,"disableForReducedMotion",Boolean),Ie=T(de,"zIndex",Number);if(he&&se)return d(function(ht){ht()});K&&be?O=be.canvas:K&&!O&&(O=Z(Ie),document.body.appendChild(O)),U&&!Te&&Ne(O);var ze={width:O.width,height:O.height};fe&&!Te&&fe.init(O),Te=!0,fe&&(O.__confetti_initialized=!0);function nt(){if(fe){var ht={getBoundingClientRect:function(){if(!K)return O.getBoundingClientRect()}};Ne(ht),fe.postMessage({resize:{width:ht.width,height:ht.height}});return}ze.width=ze.height=null}function mt(){be=null,U&&(ce=!1,e.removeEventListener("resize",nt)),K&&O&&(document.body.contains(O)&&document.body.removeChild(O),O=null,Te=!1)}return U&&!ce&&(ce=!0,e.addEventListener("resize",nt,!1)),fe?fe.fire(de,ze,mt):xe(de,ze,mt)}return me.reset=function(){fe&&fe.reset(),be&&be.reset()},me}var W;function H(){return W||(W=Q(null,{useWorker:!0,resize:!0})),W}function re(O,I,K,U,ce,ye,Ae){var fe=new Path2D(O),Ne=new Path2D;Ne.addPath(fe,new DOMMatrix(I));var Te=new Path2D;return Te.addPath(Ne,new DOMMatrix([Math.cos(Ae)*ce,Math.sin(Ae)*ce,-Math.sin(Ae)*ye,Math.cos(Ae)*ye,K,U])),Te}function ne(O){if(!i)throw new Error("path confetti are not supported in this browser");var I,K;typeof O=="string"?I=O:(I=O.path,K=O.matrix);var U=new Path2D(I),ce=document.createElement("canvas"),ye=ce.getContext("2d");if(!K){for(var Ae=1e3,fe=Ae,Ne=Ae,Te=0,se=0,be,xe,me=0;me<Ae;me+=2)for(var de=0;de<Ae;de+=2)ye.isPointInPath(U,me,de,"nonzero")&&(fe=Math.min(fe,me),Ne=Math.min(Ne,de),Te=Math.max(Te,me),se=Math.max(se,de));be=Te-fe,xe=se-Ne;var he=10,Ie=Math.min(he/be,he/xe);K=[Ie,0,0,Ie,-Math.round(be/2+fe)*Ie,-Math.round(xe/2+Ne)*Ie]}return{type:"path",path:I,matrix:K}}function ve(O){var I,K=1,U="#000000",ce='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof O=="string"?I=O:(I=O.text,K="scalar"in O?O.scalar:K,ce="fontFamily"in O?O.fontFamily:ce,U="color"in O?O.color:U);var ye=10*K,Ae=""+ye+"px "+ce,fe=new OffscreenCanvas(ye,ye),Ne=fe.getContext("2d");Ne.font=Ae;var Te=Ne.measureText(I),se=Math.ceil(Te.actualBoundingBoxRight+Te.actualBoundingBoxLeft),be=Math.ceil(Te.actualBoundingBoxAscent+Te.actualBoundingBoxDescent),xe=2,me=Te.actualBoundingBoxLeft+xe,de=Te.actualBoundingBoxAscent+xe;se+=xe+xe,be+=xe+xe,fe=new OffscreenCanvas(se,be),Ne=fe.getContext("2d"),Ne.font=Ae,Ne.fillStyle=U,Ne.fillText(I,me,de);var he=1/K;return{type:"bitmap",bitmap:fe.transferToImageBitmap(),matrix:[he,0,0,he,-se*he/2,-be*he/2]}}r.exports=function(){return H().apply(this,arguments)},r.exports.reset=function(){H().reset()},r.exports.create=Q,r.exports.shapeFromPath=ne,r.exports.shapeFromText=ve})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),aT,!1);const dbe=aT.exports;aT.exports.create;const hbe="quiz_analytics",pbe=1,cu="quizResults",uu="topicPerformance",du="achievements",hu="studyStreak";class gbe{db=null;initPromise=null;async init(){return this.initPromise?this.initPromise:(this.initPromise=new Promise((e,r)=>{if(!window.indexedDB){console.warn("IndexedDB not supported"),r(new Error("IndexedDB not supported"));return}const n=indexedDB.open(hbe,pbe);n.onerror=()=>{console.error("Failed to open quiz analytics database:",n.error),r(n.error)},n.onsuccess=()=>{this.db=n.result,console.log(" Quiz analytics database initialized"),e()},n.onupgradeneeded=a=>{const s=a.target.result;if(!s.objectStoreNames.contains(cu)){const i=s.createObjectStore(cu,{keyPath:"id"});i.createIndex("timestamp","timestamp",{unique:!1}),i.createIndex("sourceSnippetId","sourceSnippetId",{unique:!1}),i.createIndex("sourceFeedItemId","sourceFeedItemId",{unique:!1}),i.createIndex("topics","topics",{unique:!1,multiEntry:!0}),i.createIndex("synced","synced",{unique:!1}),console.log(" Quiz results store created")}if(!s.objectStoreNames.contains(uu)){const i=s.createObjectStore(uu,{keyPath:"topic"});i.createIndex("lastQuizDate","lastQuizDate",{unique:!1}),i.createIndex("averageScore","averageScore",{unique:!1}),console.log(" Topic performance store created")}s.objectStoreNames.contains(du)||(s.createObjectStore(du,{keyPath:"id"}).createIndex("unlocked","unlocked",{unique:!1}),console.log(" Achievements store created")),s.objectStoreNames.contains(hu)||(s.createObjectStore(hu,{keyPath:"id"}),console.log(" Study streak store created"))}}),this.initPromise)}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}getMidnightUTC(e){const r=new Date(e);return r.setUTCHours(0,0,0,0),r.getTime()}extractTopics(e,r){const n=new Set,a=["machine learning","ai","artificial intelligence","deep learning","python","javascript","typescript","java","c++","sql","react","angular","vue","node","express","aws","azure","cloud","docker","kubernetes","database","api","rest","graphql","algorithms","data structures","security","testing","frontend","backend","fullstack","devops"],s=(e+" "+r.map(i=>i.questionText).join(" ")).toLowerCase();for(const i of a)if(s.includes(i)){const l=i.split(" ").map(c=>c.charAt(0).toUpperCase()+c.slice(1)).join(" ");n.add(l)}return n.size===0&&n.add("General Knowledge"),Array.from(n)}calculateTrend(e,r){const n=e.filter(p=>p.topics.includes(r)).sort((p,g)=>p.timestamp-g.timestamp);if(n.length<3)return"stable";const a=Math.floor(n.length*2/3),s=n.slice(0,a),i=n.slice(a),l=s.reduce((p,g)=>p+g.score,0)/s.length,d=i.reduce((p,g)=>p+g.score,0)/i.length-l;return d>5?"improving":d<-5?"declining":"stable"}async updateStreak(e){if(await this.init(),!this.db)throw new Error("Database not initialized");const r=this.getMidnightUTC(e);return new Promise((n,a)=>{const i=this.db.transaction([hu],"readwrite").objectStore(hu),l=i.get(1);l.onsuccess=()=>{const c=l.result||{id:1,currentStreak:0,longestStreak:0,lastQuizDate:0,streakDates:[]};c.streakDates.includes(r)||(c.streakDates.push(r),c.streakDates.sort((m,y)=>m-y));let d=0;const p=[...c.streakDates].sort((m,y)=>y-m);for(let m=0;m<p.length;m++){const y=r-m*24*60*60*1e3;if(p[m]===y)d++;else break}c.currentStreak=d,c.longestStreak=Math.max(c.longestStreak,d),c.lastQuizDate=r;const g=i.put(c);g.onsuccess=()=>{console.log(` Streak updated: ${d} days`),n()},g.onerror=()=>a(g.error)},l.onerror=()=>a(l.error)})}async updateTopicPerformance(e){if(await this.init(),!this.db)throw new Error("Database not initialized");const r=await this.getQuizResults();return new Promise((n,a)=>{const i=this.db.transaction([uu],"readwrite").objectStore(uu);let l=0,c=!1;for(const d of e.topics){const p=i.get(d);p.onsuccess=()=>{const g=r.filter(w=>w.topics.includes(d)),m=g.flatMap(w=>w.questionStats.filter(T=>T.topic===d||w.topics.includes(d))),y={topic:d,quizzesTaken:g.length,questionsSeen:m.length,questionsCorrect:m.filter(w=>w.correct).length,averageScore:g.length>0?g.reduce((w,T)=>w+T.score,0)/g.length:0,bestScore:g.length>0?Math.max(...g.map(w=>w.score)):0,worstScore:g.length>0?Math.min(...g.map(w=>w.score)):0,lastQuizDate:e.timestamp,totalTimeSpent:g.reduce((w,T)=>w+T.timeSpent,0),trend:this.calculateTrend(r,d)},x=i.put(y);x.onsuccess=()=>{l++,l===e.topics.length&&!c&&n()},x.onerror=()=>{c||(c=!0,a(x.error))}},p.onerror=()=>{c||(c=!0,a(p.error))}}})}async saveQuizResult(e){if(await this.init(),!this.db)throw new Error("Database not initialized");const r=this.generateUUID(),n=this.extractTopics(e.title,e.questionStats),a=e.questionStats.map(i=>({...i,topic:n[0]})),s={...e,id:r,topics:n,questionStats:a,synced:!1};return new Promise((i,l)=>{const p=this.db.transaction([cu],"readwrite").objectStore(cu).add(s);p.onsuccess=async()=>{console.log(" Quiz analytics saved:",r),await this.updateTopicPerformance(s),await this.updateStreak(s.timestamp),i(r)},p.onerror=()=>{console.error("Failed to save quiz analytics:",p.error),l(p.error)}})}async getQuizResults(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const l=this.db.transaction([cu],"readonly").objectStore(cu).index("timestamp").openCursor(null,"prev"),c=[];l.onsuccess=()=>{const d=l.result;d&&(!e||c.length<e)?(c.push(d.value),d.continue()):r(c)},l.onerror=()=>n(l.error)})}async getTopicPerformance(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction([uu],"readonly").objectStore(uu).getAll();s.onsuccess=()=>e(s.result),s.onerror=()=>r(s.error)})}async getStudyStreak(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction([hu],"readonly").objectStore(hu).get(1);s.onsuccess=()=>e(s.result||null),s.onerror=()=>r(s.error)})}async getAchievements(){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((e,r)=>{const s=this.db.transaction([du],"readonly").objectStore(du).getAll();s.onsuccess=()=>e(s.result),s.onerror=()=>r(s.error)})}async saveAchievements(e){if(await this.init(),!this.db)throw new Error("Database not initialized");return new Promise((r,n)=>{const s=this.db.transaction([du],"readwrite").objectStore(du);let i=0,l=!1;for(const c of e){const d=s.put(c);d.onsuccess=()=>{i++,i===e.length&&!l&&r()},d.onerror=()=>{l||(l=!0,n(d.error))}}e.length===0&&r()})}async clearAllData(){if(await this.init(),!this.db)throw new Error("Database not initialized");const e=[cu,uu,du,hu];for(const r of e)await new Promise((n,a)=>{const l=this.db.transaction([r],"readwrite").objectStore(r).clear();l.onsuccess=()=>n(),l.onerror=()=>a(l.error)});console.log(" All quiz analytics data cleared")}async exportToCSV(){const e=await this.getQuizResults(),r=["Quiz ID","Timestamp","Title","Topics","Total Questions","Correct Answers","Score (%)","Time Spent (s)","Start Time","End Time"],n=e.map(s=>[s.id,new Date(s.timestamp).toISOString(),s.title,s.topics.join("; "),s.totalQuestions.toString(),s.correctAnswers.toString(),s.score.toString(),Math.round(s.timeSpent/1e3).toString(),new Date(s.startTime).toISOString(),new Date(s.endTime).toISOString()]);return[r,...n].map(s=>s.map(i=>`"${i}"`).join(",")).join(`
`)}}const fbe=new gbe,mbe=({quiz:t,onClose:e,onComplete:r})=>{const[n,a]=N.useState(0),[s,i]=N.useState(null),[l,c]=N.useState("question"),[d,p]=N.useState(0),[g,m]=N.useState([]),y=N.useRef(Date.now()),x=N.useRef(Date.now()),w=N.useRef([]),T=t.questions[n],k=n+1,_=t.questions.length;if(N.useEffect(()=>{T&&console.log(" QuizCard - Current Question:",{index:n,questionId:T.id,answerId:T.answerId,choices:T.choices.map($=>({id:$.id,text:$.text.substring(0,30),isCorrect:$.id===T.answerId}))})},[n,T]),N.useEffect(()=>{x.current=Date.now()},[n]),!T||!t.questions||t.questions.length===0)return u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-start mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(I0,{className:"w-6 h-6 text-blue-600 animate-pulse"}),u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.title})]}),u.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:u.jsx(n0,{className:"w-5 h-5 text-gray-600"})})]}),u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Generating quiz questions..."})]})]});const P=$=>{if(l!=="question")return;i($);const Z=$===T.answerId;console.log(" Answer selected:",{questionId:T.id,selectedChoiceId:$,correctAnswerId:T.answerId,isCorrect:Z}),Z&&p(d+1);const z={questionId:T.id,questionPrompt:T.prompt,selectedChoiceId:$,correctChoiceId:T.answerId,correct:Z,explanation:T.explanation||""};m([...g,z]);const ee=Date.now()-x.current,te=T.choices.find(Q=>Q.id===$),X=T.choices.find(Q=>Q.id===T.answerId);w.current.push({questionId:T.id,questionText:T.prompt,correct:Z,timeSpent:ee,attempts:1,selectedAnswer:te?.text||"",correctAnswer:X?.text||""}),c("answered")},F=async()=>{if(n<t.questions.length-1)a(n+1),i(null),c("question");else{c("completed");const $=Date.now(),Z=$-y.current;try{await fbe.saveQuizResult({timestamp:$,title:t.title,totalQuestions:t.questions.length,correctAnswers:d,score:Math.round(d/t.questions.length*100),timeSpent:Z,startTime:y.current,endTime:$,questionStats:w.current}),console.log(" Quiz analytics saved")}catch(ee){console.error("Failed to save quiz analytics:",ee)}d/t.questions.length*100>=70&&dbe({particleCount:100,spread:70,origin:{y:.6}}),r&&r(d,t.questions.length,g)}},D=()=>{a(0),i(null),c("question"),p(0),m([]),y.current=Date.now(),x.current=Date.now(),w.current=[]},B=$=>{const Z="w-full p-4 text-left rounded-lg border-2 transition-all duration-200";if(l==="question")return`${Z} border-gray-300 hover:border-blue-400 hover:bg-blue-50 cursor-pointer`;const z=s===$.id,ee=$.id===T.answerId;return ee?`${Z} border-green-500 bg-green-50 text-green-900`:z&&!ee?`${Z} border-red-500 bg-red-50 text-red-900`:`${Z} border-gray-300 bg-gray-50 text-gray-500 cursor-not-allowed`},M=$=>{if(l==="question")return null;const Z=s===$.id,z=$.id===T.answerId;return z?u.jsx(m_,{className:"w-5 h-5 text-green-600"}):Z&&!z?u.jsx(y_,{className:"w-5 h-5 text-red-600"}):null};if(l==="completed"){const $=Math.round(d/t.questions.length*100),Z=$>=70;return u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-start mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(BH,{className:`w-8 h-8 ${Z?"text-yellow-500":"text-gray-400"}`}),u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Quiz Complete!"})]}),u.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:u.jsx(n0,{className:"w-5 h-5 text-gray-600"})})]}),u.jsxs("div",{className:"text-center mb-8",children:[u.jsxs("div",{className:`text-6xl font-bold mb-2 ${Z?"text-green-600":"text-orange-600"}`,children:[$,"%"]}),u.jsxs("div",{className:"text-xl text-gray-600 mb-4",children:[d," out of ",t.questions.length," correct"]}),u.jsx("div",{className:`text-lg font-semibold ${Z?"text-green-600":"text-orange-600"}`,children:Z?" Great job!":" Keep practicing!"})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Review"}),u.jsx("div",{className:"space-y-2",children:g.map((z,ee)=>u.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg ${z.correct?"bg-green-50":"bg-red-50"}`,children:[z.correct?u.jsx(m_,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):u.jsx(y_,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),u.jsxs("span",{className:"text-sm text-gray-700",children:["Question ",ee+1]})]},z.questionId))})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:D,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:[u.jsx(PH,{className:"w-4 h-4"}),"Retake Quiz"]}),u.jsx("button",{onClick:e,className:"flex-1 py-3 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Close"})]})]})}return u.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-2xl mx-auto",children:[u.jsxs("div",{className:"flex justify-between items-start mb-6",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx(I0,{className:"w-6 h-6 text-blue-600"}),u.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.title})]}),u.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[u.jsxs("span",{className:"font-medium",children:["Question ",k," of ",_]}),u.jsxs("span",{children:["Score: ",d,"/",_]})]})]}),u.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Close quiz",children:u.jsx(n0,{className:"w-5 h-5 text-gray-600"})})]}),u.jsx("div",{className:"mb-6",children:u.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${k/_*100}%`}})})}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:T.prompt}),u.jsx("div",{className:"space-y-3",children:T.choices.map($=>u.jsx("button",{onClick:()=>P($.id),disabled:l!=="question",className:B($),children:u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsx("span",{className:"flex-1 text-left",children:$.text}),M($)]})},$.id))})]}),l==="answered"&&T.explanation&&u.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border-l-4 border-blue-500 rounded",children:[u.jsx("h4",{className:"font-semibold text-blue-900 mb-1",children:"Explanation"}),u.jsx("p",{className:"text-blue-800 text-sm",children:T.explanation})]}),u.jsxs("div",{className:"flex gap-3",children:[l==="answered"&&u.jsx("button",{onClick:F,className:"flex-1 py-3 px-4 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:n<t.questions.length-1?"Next Question ":"Finish Quiz"}),u.jsx("button",{onClick:e,className:"py-3 px-4 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Quit"})]})]})};function ybe(t){return{title:t.title,questions:t.questions.map(e=>({id:e.id,prompt:e.prompt,choices:e.choices,answerId:e.correctChoiceId,explanation:e.explanation}))}}function bbe({quiz:t,onClose:e}){const r=ybe(t);return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsx("div",{className:"w-full max-w-2xl",children:u.jsx(mbe,{quiz:r,onClose:e,onComplete:(n,a)=>{console.log(`Feed quiz completed: ${n}/${a}`)}})})})}function xbe(t){return typeof t=="string"?t:Array.isArray(t)?t.filter(e=>e.type==="text"&&e.text).map(e=>e.text).join(`
`):""}function z3(){return`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async function xw(){try{return(await _i.getAllChats()).sort((e,r)=>r.timestamp-e.timestamp).map(e=>({id:e.id,timestamp:e.timestamp,firstUserPrompt:e.title||"New chat",messages:e.messages}))}catch(t){return console.error("Error loading chat history from IndexedDB:",t),[]}}async function vbe(t,e,r){try{const n=t.find(i=>i.role==="user"),a=n?xbe(n.content):"",s=a?a.substring(0,100):"New chat";return e||(e=z3()),await _i.saveChat(e,t,s,r),e}catch(n){return console.error("Error saving chat to history:",n),e||z3()}}async function $3(t){try{const e=await _i.getChatWithMetadata(t);return e?{messages:e.messages,systemPrompt:e.systemPrompt,planningQuery:e.planningQuery,generatedSystemPrompt:e.generatedSystemPrompt,generatedUserQuery:e.generatedUserQuery,selectedSnippetIds:e.selectedSnippetIds,todosState:e.todosState}:null}catch(e){return console.error("Error loading chat with metadata from IndexedDB:",e),null}}async function U3(t){try{await _i.deleteChat(t)}catch(e){console.error("Error deleting chat from IndexedDB:",e)}}async function wbe(){try{await _i.clearAllChats()}catch(t){console.error("Error clearing chat history from IndexedDB:",t)}}const q3=({transferData:t,enabledTools:e,showMCPDialog:r,setShowMCPDialog:n,onLoadingChange:a})=>{const{t:s}=Lc(),{accessToken:i,user:l,getToken:c}=oi(),{getAccessToken:d}=vq(),{addSearchResult:p,clearSearchResults:g}=L$(),{addTracksToStart:m}=Ch(),{addSnippet:y,snippets:x,syncSnippetFromGoogleSheets:w}=rf(),{showToast:T,showError:k,showWarning:_,showSuccess:P,clearAllToasts:F}=jl(),{settings:D}=vo(),{addCost:B,usage:M}=My(),{state:$,speak:Z,stop:z,updateCurrentText:ee}=nf(),{isConnected:te,sendMessages:X,sendScrollPosition:Q}=_S(),{location:W,isLoading:H,requestLocation:re,clearLocation:ne}=kq(),{getCurrentProjectId:ve}=ef(),O=Xi(),[I,K]=N.useState([]),[U,ce]=N.useState(!1),[ye,Ae]=go("chat_input",""),[fe,Ne]=go("chat_system_prompt",""),[Te,se]=N.useState(!1),[be,xe]=N.useState(!1),[me,de]=N.useState(!1),[he,Ie]=N.useState(!1),[ze,nt]=N.useState(new Set),[mt,ht]=N.useState(""),[er,ct]=N.useState(""),[Dt,kt]=N.useState(""),[fr,qe]=go("chat_mcp_servers",[]),[st,Gt]=N.useState({name:"",url:""}),[Kt,lr]=N.useState(!1),Qe=[{id:"joke-server",name:"Joke Server",url:"http://localhost:3100",description:"Get programming, dad, science, animal, and food jokes",category:"Sample",instructions:`1. Run: make mcp-install-jokes
2. Run: make mcp-sample-jokes
3. Server starts on port 3100`,tools:["get_random_joke","get_joke_by_id","search_jokes","get_categories"]},{id:"filesystem",name:"@modelcontextprotocol/server-filesystem",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/filesystem",description:"Secure file operations with configurable access controls",category:"Official",instructions:"Install: npx -y @modelcontextprotocol/server-filesystem /path/to/allowed/files",tools:["read_file","write_file","list_directory","search_files"]},{id:"github",name:"@modelcontextprotocol/server-github",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/github",description:"Repository management, file operations, commits, issues, PRs",category:"Official",instructions:`Install: npx -y @modelcontextprotocol/server-github
Requires: GITHUB_PERSONAL_ACCESS_TOKEN`,tools:["create_or_update_file","search_repositories","create_issue","create_pull_request"]},{id:"postgres",name:"@modelcontextprotocol/server-postgres",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/postgres",description:"Read-only database access for PostgreSQL",category:"Official",instructions:"Install: npx -y @modelcontextprotocol/server-postgres postgresql://user:pass@localhost/db",tools:["query","list_tables","describe_table","append_insight"]},{id:"sqlite",name:"@modelcontextprotocol/server-sqlite",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/sqlite",description:"Database interaction, schema inspection, query execution",category:"Official",instructions:"Install: npx -y @modelcontextprotocol/server-sqlite /path/to/database.db",tools:["query","list_tables","describe_table","append_insight"]},{id:"slack",name:"@modelcontextprotocol/server-slack",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/slack",description:"Channel management and messaging for Slack",category:"Official",instructions:`Install: npx -y @modelcontextprotocol/server-slack
Requires: SLACK_BOT_TOKEN`,tools:["post_message","reply_to_thread","add_reaction","get_channel_history"]},{id:"brave-search",name:"@modelcontextprotocol/server-brave-search",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/brave-search",description:"Web and local search using Brave Search API",category:"Official",instructions:`Install: npx -y @modelcontextprotocol/server-brave-search
Requires: BRAVE_API_KEY`,tools:["brave_web_search","brave_local_search"]},{id:"gdrive",name:"@modelcontextprotocol/server-gdrive",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/gdrive",description:"File access and search for Google Drive",category:"Official",instructions:`Install: npx -y @modelcontextprotocol/server-gdrive
Requires: OAuth credentials`,tools:["search_files","read_file","list_files"]},{id:"git",name:"@modelcontextprotocol/server-git",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/git",description:"Read, search, and analyze Git repositories",category:"Official",instructions:"Install: npx -y @modelcontextprotocol/server-git",tools:["git_status","git_diff","git_log","git_commit"]},{id:"memory",name:"@modelcontextprotocol/server-memory",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/memory",description:"Knowledge graph-based persistent memory system",category:"Official",instructions:"Install: npx -y @modelcontextprotocol/server-memory",tools:["create_entities","create_relations","search_nodes","open_nodes"]},{id:"fetch",name:"@modelcontextprotocol/server-fetch",url:"https://github.com/modelcontextprotocol/servers/tree/main/src/fetch",description:"Efficient web content fetching and conversion",category:"Official",instructions:`Install: npx -y @modelcontextprotocol/server-fetch
Optional: USER_AGENT, IGNORE_ROBOTS_TXT`,tools:["fetch"]}];N.useEffect(()=>{a?.(Te)},[Te,a]);const[Yt,ur]=N.useState([]),[_t,sr]=N.useState(""),[vt,pn]=N.useState(new Set),[Ar,Ja]=N.useState(null),[zt,Ca]=N.useState(!1),[Bs,qn]=N.useState(!1),[Se,ut]=N.useState(null),[Nt,xr]=N.useState(null),Kr=N.useRef(!1),Xr=N.useRef(""),[tr,Vt]=N.useState(null),[Qt,Or]=N.useState([]),Hr=N.useMemo(()=>{const Y=ve();return Y?Qt.filter(oe=>oe.projectId===Y):Qt.filter(oe=>!oe.projectId)},[Qt,ve]),[Dn,Ba]=N.useState(new Map),[Za,Ea]=N.useState(new Map),[an,tn]=N.useState(new Map),[ca,_a]=N.useState(new Map),[Zi,Zn]=N.useState(""),[Pi,rr]=N.useState(new Map),[De,bt]=N.useState(new Map),[Mt,zr]=N.useState(new Map),[rn,jr]=N.useState(new Map),[ir,Kn]=N.useState(null),[Hn,Tt]=N.useState(null),[qt,Lr]=N.useState(null),[Gr,Gn]=N.useState(null),[vr,Fa]=N.useState(null),[ua,yn]=N.useState(null),[xa,ko]=N.useState(!1),[ci,Ii]=N.useState(!1),[_r,Cs]=N.useState(!1),[da,Fs]=N.useState(""),[ui,cs]=N.useState(!1),[An,To]=N.useState(null),[zs,kr]=N.useState(0),[di,wr]=N.useState([]),[xn,$s]=N.useState(!1),Us=N.useRef(null),ha=N.useRef(null),Nn=N.useRef(null),Bt=N.useRef(!1),ar=N.useRef(null),Pr=N.useRef(null),Vr=N.useRef(null),$r=N.useRef(""),[jn,hi]=go("chat_prompt_history",[]),[Es,_s]=N.useState(-1),Aa=D?.rag?.enabled??!1,[,$l]=N.useState(!1),[za,qs]=N.useState(.3),[pi,gi]=N.useState(null),[eo,Co]=N.useState(!1),[fi,Qu]=N.useState(!1),[pa,Hs]=N.useState(null),[Eo,mi]=N.useState(!1),[Ya,es]=N.useState(new Set);N.useEffect(()=>{D?.rag?.scoreThreshold!==void 0&&qs(D.rag.scoreThreshold)},[D?.rag?.scoreThreshold]);const Gs=xo();N.useEffect(()=>{if(Gs.state?.initialQuery){const Y=Gs.state.initialQuery,oe=Gs.state?.systemMessage;if(Gs.state?.clearChat){console.log(" Clearing chat thread as requested from feed item"),K([]);const Ge=`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;Vt(Ge),localStorage.setItem("last_active_chat_id",Ge),console.log(" Created new chat session:",Ge)}oe&&(console.log(" Setting system prompt from navigation state:",oe),Ne(oe)),Ae(Y),Gs.state?.autoSubmit&&!Te&&setTimeout(()=>{oe?ds(Y,oe):ds(Y)},100),window.history.replaceState({},document.title)}},[Gs.state]),N.useEffect(()=>{const Y=Array.from(De.values()).find(Ge=>Ge.phase==="generating"&&Ge.estimated_seconds);if(!Y||Y.remaining_seconds===0)return;const oe=setInterval(()=>{bt(Ge=>{const yt=new Map(Ge),tt="img_generating",ie=yt.get(tt);if(ie&&ie.phase==="generating"){const dt=ie.remaining_seconds??ie.estimated_seconds??0;dt>0&&yt.set(tt,{...ie,remaining_seconds:dt-1})}return yt})},1e3);return()=>clearInterval(oe)},[De]);const nl=Ur.useMemo(()=>{const Y={};return D&&D.providers.forEach(oe=>{if(oe.enabled&&oe.apiKey)switch(oe.type){case"openai":Y.openaiApiKey||(Y.openaiApiKey=oe.apiKey);break;case"together":Y.togetherApiKey||(Y.togetherApiKey=oe.apiKey);break;case"gemini":Y.geminiApiKey||(Y.geminiApiKey=oe.apiKey);break;case"replicate":Y.replicateApiKey||(Y.replicateApiKey=oe.apiKey);break}}),Y},[D]),Ul=()=>{Us.current?.scrollIntoView({behavior:"smooth"})},al=(Y,oe)=>{let Ge=Y;const yt=[],tt=[],ie=[],dt=/!\[([^\]]*)\]\(([^\)]+)\)/g;let We;for(;(We=dt.exec(Y))!==null;)yt.includes(We[2])||yt.push(We[2]);const Ct=/\[([^\]]+)\]\(([^\)]+)\)/g;for(;(We=Ct.exec(Y))!==null;){const It=We[2];It.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)/)?ie.includes(It)||ie.push(It):tt.includes(It)||tt.push(It)}const Oe=/<img[^>]+src=["']([^"']+)["'][^>]*>/g;for(;(We=Oe.exec(Y))!==null;)yt.includes(We[1])||yt.push(We[1]);const gt=/<a[^>]+href=["']([^"']+)["'][^>]*>([^<]+)<\/a>/g;for(;(We=gt.exec(Y))!==null;){const It=We[1];It.match(/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)/)?ie.includes(It)||ie.push(It):tt.includes(It)||tt.push(It)}return oe?(Ge+=`

---
`,oe.images&&oe.images.length>0&&(Ge+=`

## Extracted Images

`,oe.images.forEach(It=>{Ge+=`![${It.alt||"Image"}](${It.src})
`,Ge+=`<img src="${It.src}" alt="${It.alt||"Image"}" style="max-width:100%;height:auto;" />
`,It.source&&(Ge+=`*Source: [${It.source}](${It.source})*

`)})),oe.youtubeVideos&&oe.youtubeVideos.length>0&&(Ge+=`

## YouTube Videos

`,oe.youtubeVideos.forEach(It=>{Ge+=`### ${It.title||"YouTube Video"}

`,Ge+=`[Watch on YouTube](${It.src})

`;const Ke=It.src.replace("watch?v=","embed/").replace("youtu.be/","youtube.com/embed/");Ge+=`<iframe width="560" height="315" src="${Ke}" frameborder="0" allowfullscreen></iframe>

`,It.source&&(Ge+=`*Source: [${It.source}](${It.source})*

`)})),oe.otherVideos&&oe.otherVideos.length>0&&(Ge+=`

## Videos

`,oe.otherVideos.forEach(It=>{Ge+=`### ${It.title||"Video"}

`,Ge+=`[Download Video](${It.src})

`,Ge+=`<video controls style="max-width:100%;height:auto;">
`,Ge+=`  <source src="${It.src}" type="video/mp4">
`,Ge+=`  Your browser does not support the video tag.
`,Ge+=`</video>

`,It.source&&(Ge+=`*Source: [${It.source}](${It.source})*

`)})),oe.media&&oe.media.length>0&&(Ge+=`

## Media

`,oe.media.forEach(It=>{Ge+=`### ${It.type}

`,Ge+=`[Download Media](${It.src})

`,It.type.toLowerCase().includes("audio")?(Ge+=`<audio controls style="width:100%;">
`,Ge+=`  <source src="${It.src}">
`,Ge+=`  Your browser does not support the audio tag.
`,Ge+=`</audio>

`):It.type.toLowerCase().includes("video")&&(Ge+=`<video controls style="max-width:100%;height:auto;">
`,Ge+=`  <source src="${It.src}">
`,Ge+=`  Your browser does not support the video tag.
`,Ge+=`</video>

`),It.source&&(Ge+=`*Source: [${It.source}](${It.source})*

`)})),oe.sources&&oe.sources.length>0&&(Ge+=`

## Sources & References

`,oe.sources.forEach((It,Ke)=>{Ge+=`${Ke+1}. **[${It.title}](${It.url})**
`,It.snippet&&(Ge+=`   > ${It.snippet}
`),Ge+=`   - URL: [${It.url}](${It.url})

`})),Ge):(yt.length>0&&(Ge+=`

---

## Inline Images

`,yt.forEach(It=>{Ge+=`![Image](${It})
`})),ie.length>0&&(Ge+=`

## Inline YouTube Videos

`,ie.forEach(It=>{Ge+=`- [YouTube Video](${It})
`,Ge+=`  <iframe width="560" height="315" src="${It.replace("watch?v=","embed/")}" frameborder="0" allowfullscreen></iframe>

`})),tt.length>0&&(Ge+=`

## Inline Links

`,tt.forEach(It=>{Ge+=`- [${It}](${It})
`})),Ge)},ql=async(Y,oe)=>{try{const{imageUrlToBase64:Ge}=await Zt(async()=>{const{imageUrlToBase64:dt}=await import("./imageUtils-DosmAaVd.js");return{imageUrlToBase64:dt}},[]),yt=await Ge(Y),tt=oe||"Image",ie=`<img src="${yt}" alt="${tt}" style="max-width: 100%; height: auto;" />`;await y(ie,"assistant",tt),P(s("chat.imageAddedToSwag"))}catch(Ge){console.error("Failed to grab image:",Ge);const yt=oe||"Image",tt=`<img src="${Y}" alt="${yt}" style="max-width: 100%; height: auto;" />`;await y(tt,"assistant",yt),P(s("chat.imageAddedWithoutConversion"))}},to=async(Y,oe,Ge,yt,tt)=>{try{let ie=yt;if(tt&&tt.length>0){const Oe=$c({toolResults:tt});(Oe.images.length>0||Oe.links.length>0||Oe.youtubeLinks.length>0||Oe.otherMedia.length>0)&&(ie={...yt,images:[...yt?.images||[],...Oe.images.map(gt=>({src:gt,alt:"",source:""}))],youtubeVideos:[...yt?.youtubeVideos||[],...Oe.youtubeLinks.map(gt=>({src:gt.url,title:gt.title||"",source:gt.url}))],otherVideos:[...yt?.otherVideos||[],...Oe.otherMedia.filter(gt=>gt.type.includes("video")).map(gt=>({src:gt.url,title:"",source:gt.url}))],media:[...yt?.media||[],...Oe.otherMedia.filter(gt=>gt.type.includes("audio")).map(gt=>({src:gt.url,type:gt.type,source:gt.url}))],sources:[...yt?.sources||[],...Oe.links.map(gt=>({url:gt.url,title:gt.title||gt.url,snippet:""}))]})}const dt=al(Y,ie),{convertHtmlImagesToBase64:We}=await Zt(async()=>{const{convertHtmlImagesToBase64:Oe}=await import("./imageUtils-DosmAaVd.js");return{convertHtmlImagesToBase64:Oe}},[]),Ct=await We(dt);await y(Ct,oe,Ge),P(s("chat.contentCapturedToSwag"))}catch(ie){console.error("Failed to capture content with base64 conversion:",ie);const dt=al(Y,yt);await y(dt,oe,Ge),P(s("chat.contentCapturedWithoutConversion"))}},_o=N.useRef(null),yi=N.useRef(null),Hl=(Y,oe,Ge)=>{console.log(" Voice transcription received:",{text:Y,requestId:oe,textLength:Y.length,hasLlmApiCall:!!Ge}),Ae(Y),_o.current=oe,yi.current=Ge||null,console.log(" Voice transcription complete, stored request ID:",oe),setTimeout(()=>{console.log(" Auto-submitting with transcribed text:",Y.substring(0,50)),ds(Y)},150)};N.useEffect(()=>{Ul()},[I]),N.useEffect(()=>{dn().then(Y=>{Fs(Y),console.log(" API endpoint for voice input:",Y)})},[]),N.useEffect(()=>{te&&I.length>0&&(console.log("Syncing messages to Chromecast:",I.length),X(I))},[I,te,X]),N.useEffect(()=>{if(!te||!ha.current)return;const Y=ha.current;let oe;const Ge=()=>{clearTimeout(oe),oe=setTimeout(()=>{Y&&Q&&Q(Y.scrollTop)},100)};return Y.addEventListener("scroll",Ge),()=>{Y.removeEventListener("scroll",Ge),clearTimeout(oe)}},[te,Q]),N.useEffect(()=>{const Y=oe=>{ar.current&&!ar.current.contains(oe.target)&&Ca(!1)};if(zt)return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[zt]),N.useEffect(()=>{Bt.current&&ye.trim()&&!Te&&i&&(Bt.current=!1,ds())},[ye]);const Ku=Y=>{Nn.current&&(Nn.current.abort(),Nn.current=null),K([]),Ne(""),Ae(Y),Ca(!1),ur([]),sr(""),Ja(null),Ba(new Map),Ea(new Map),tn(new Map),_a(new Map),Kn(null),Vt(null),localStorage.removeItem("last_active_chat_id"),F(),setTimeout(()=>{ds(Y)},0)},ea=Y=>typeof Y=="string"?Y:Array.isArray(Y)?Y.filter(oe=>oe.type==="text"&&oe.text).map(oe=>oe.text).join(`
`):"",Ao=async Y=>{try{const oe=I[Y];if(!oe){console.warn(" Tried to submit feedback for missing message index:",Y),k("Message not found for feedback");return}const Ge=await c();if(!Ge){k("Please sign in to submit feedback");return}const yt=await ms(),tt=await dn();if(!(await fetch(`${tt}/report-error`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ge}`,"X-Google-Access-Token":yt},body:JSON.stringify({userEmail:l?.email,feedbackType:"positive",explanation:"",messageData:{messageId:oe?.messageId||oe?.id||"",messageContent:ea(oe.content),llmApiCalls:oe.llmApiCalls||[],evaluations:oe.evaluations||[],conversationThread:I},timestamp:new Date().toISOString()})})).ok)throw new Error("Failed to submit feedback");P(" Thank you for the feedback!")}catch(oe){console.error("Error submitting positive feedback:",oe),k("Failed to submit feedback")}},zc=Y=>{Fa(Y)},sl=Y=>{const oe=ea(Y);if(!oe)return null;const Ge=oe.match(/```mermaid\s*([\s\S]*?)```/);return Ge&&Ge[1]?Ge[1].trim():null},$c=Y=>{const oe={images:[],links:[],youtubeLinks:[],otherMedia:[]};return Y.toolResults&&Y.toolResults.forEach(Ge=>{try{const yt=typeof Ge.content=="string"?JSON.parse(Ge.content):Ge.content;yt.results&&Array.isArray(yt.results)&&yt.results.forEach(tt=>{tt.images&&Array.isArray(tt.images)&&tt.images.forEach(ie=>{typeof ie=="string"?oe.images.push(ie):ie&&ie.src?oe.images.push(ie.src):ie&&ie.url&&oe.images.push(ie.url)}),tt.url&&oe.links.push({url:tt.url,title:tt.title}),tt.links&&Array.isArray(tt.links)&&tt.links.forEach(ie=>{typeof ie=="string"?oe.links.push({url:ie}):ie&&ie.href?oe.links.push({url:ie.href,title:ie.text}):ie&&ie.url&&oe.links.push({url:ie.url,title:ie.text||ie.title})})}),yt.videos&&Array.isArray(yt.videos)&&yt.videos.forEach(tt=>{tt.url&&oe.youtubeLinks.push({url:tt.url,title:tt.title})}),yt.images&&Array.isArray(yt.images)&&yt.images.forEach(tt=>{typeof tt=="string"?oe.images.push(tt):tt&&tt.src?oe.images.push(tt.src):tt&&tt.url&&oe.images.push(tt.url)}),yt.page_content?.images&&Array.isArray(yt.page_content.images)&&yt.page_content.images.forEach(tt=>{typeof tt=="string"?oe.images.push(tt):tt&&tt.src?oe.images.push(tt.src):tt&&tt.url&&oe.images.push(tt.url)}),yt.results&&Array.isArray(yt.results)&&yt.results.forEach(tt=>{tt.page_content?.images&&Array.isArray(tt.page_content.images)&&tt.page_content.images.forEach(ie=>{typeof ie=="string"?oe.images.push(ie):ie&&ie.src?oe.images.push(ie.src):ie&&ie.url&&oe.images.push(ie.url)})})}catch{}}),oe.images=[...new Set(oe.images)].filter(Boolean),oe.links=Array.from(new Map(oe.links.filter(Ge=>Ge.url).map(Ge=>[Ge.url,Ge])).values()),oe.youtubeLinks=Array.from(new Map(oe.youtubeLinks.filter(Ge=>Ge.url).map(Ge=>[Ge.url,Ge])).values()),oe},Gl=Y=>Y<1e-4?"<$0.0001":Y<.01?`$${Y.toFixed(4)}`:`$${Y.toFixed(3)}`,va=Y=>{if(!Y||Y.length===0)return 0;const oe={"gemini-2.0-flash":{input:0,output:0},"gemini-2.5-flash":{input:0,output:0},"gemini-2.5-pro":{input:0,output:0},"gemini-1.5-flash":{input:0,output:0},"gemini-1.5-pro":{input:0,output:0},"gpt-4o":{input:2.5,output:10},"gpt-4o-mini":{input:.15,output:.6},"gpt-4-turbo":{input:10,output:30},"gpt-4":{input:30,output:60},"gpt-3.5-turbo":{input:.5,output:1.5},"o1-preview":{input:15,output:60},"o1-mini":{input:3,output:12},"llama-3.1-8b-instant":{input:0,output:0},"llama-3.3-70b-versatile":{input:0,output:0},"llama-3.1-70b-versatile":{input:0,output:0},"mixtral-8x7b-32768":{input:0,output:0}};let Ge=0;for(const yt of Y){const tt=yt.model,ie=yt.response?.usage;if(!tt||!ie)continue;const dt=oe[tt]||{input:0,output:0},We=ie.prompt_tokens||0,Ct=ie.completion_tokens||0,Oe=We/1e6*dt.input,gt=Ct/1e6*dt.output;Ge+=Oe+gt}return Ge},Vs=Y=>!Y.llmApiCalls||Y.llmApiCalls.length===0?0:va(Y.llmApiCalls),us=Y=>Y===0?"$0":Y<1e-4?"<$0.0001":Y<.01?`$${Y.toFixed(4)}`:Y<1?`$${Y.toFixed(3)}`:`$${Y.toFixed(2)}`,Xu=Y=>{Y.preventDefault(),Y.stopPropagation(),Y.dataTransfer.types.includes("Files")&&$s(!0)},Vl=Y=>{Y.preventDefault(),Y.stopPropagation(),Y.currentTarget===Y.target&&$s(!1)},Ju=Y=>{Y.preventDefault(),Y.stopPropagation()},Uc=Y=>{Y.preventDefault(),Y.stopPropagation(),$s(!1);const oe=Y.dataTransfer.files;Gc(oe)},Wl=Y=>{if(Y){Y.style.height="auto";const Ge=Math.min(Y.scrollHeight,300);Y.style.height=Ge+"px"}};N.useEffect(()=>{Wl(Pr.current)},[ye]),N.useEffect(()=>{t&&(Ae(t.prompt),t.persona&&Ne(t.persona))},[t]),N.useEffect(()=>{const Y=sessionStorage.getItem("planning_transfer_data");if(console.log(" useEffect checking sessionStorage - planningData:",Y?.substring(0,100)),Y){console.log(" Found planning transfer data in sessionStorage");try{const oe=JSON.parse(Y);if(console.log(" Planning transfer data received:",oe),K([]),Vt(null),localStorage.removeItem("last_active_chat_id"),g(),pn(new Set),es(new Set),oe.persona||oe.generatedSystemPrompt){const Ge=oe.persona||oe.generatedSystemPrompt;Ne(Ge),console.log(" Set system prompt from planning:",Ge.substring(0,50)+"...")}if(oe.prompt||oe.generatedUserQuery){const Ge=oe.prompt||oe.generatedUserQuery;Ae(Ge),console.log(" Set user input from planning:",Ge.substring(0,50)+"...")}oe.planningQuery&&ht(oe.planningQuery),oe.generatedSystemPrompt&&ct(oe.generatedSystemPrompt),oe.generatedUserQuery&&kt(oe.generatedUserQuery),sessionStorage.removeItem("planning_transfer_data"),setTimeout(()=>{Pr.current?.focus(),P(s("chat.planningTransferred"))},100)}catch(oe){console.error("Failed to parse planning transfer data:",oe),k(s("chat.failedToTransfer")),sessionStorage.removeItem("planning_transfer_data")}}},[]),N.useEffect(()=>{if($ye()){const Y=Uye();if(Y){console.log(" Restoring shared conversation from URL"),K([]),Vt(null),localStorage.removeItem("last_active_chat_id"),g(),pn(new Set),es(new Set);const oe=Y.messages.map(Ge=>({role:Ge.role,content:Ge.content,timestamp:Ge.timestamp}));K(oe),Y.metadata.title&&Ne(Y.metadata.title),Y.metadata.truncated&&_(`This conversation was truncated to fit URL limits. Showing ${Y.metadata.includedMessageCount} of ${Y.metadata.originalMessageCount} messages.`),qye(),P("Shared conversation loaded!"),console.log(` Restored ${oe.length} messages from share URL`)}}},[]),N.useEffect(()=>{if(!U){if(Gs.state?.clearChat){console.log(" Skipping chat restore due to clearChat flag from navigation"),ce(!0);return}(async()=>{try{const Y=localStorage.getItem("last_active_chat_id");if(Y){console.log(" Attempting to restore last chat:",Y);const oe=await $3(Y);if(oe&&oe.messages&&oe.messages.length>0){oe.systemPrompt&&Ne(oe.systemPrompt),oe.planningQuery&&ht(oe.planningQuery),oe.generatedSystemPrompt&&ct(oe.generatedSystemPrompt),oe.generatedUserQuery&&kt(oe.generatedUserQuery),oe.selectedSnippetIds&&Array.isArray(oe.selectedSnippetIds)&&(es(new Set(oe.selectedSnippetIds)),console.log(` Restored ${oe.selectedSnippetIds.length} attached snippets`));const yt=oe.messages.map(tt=>(tt._attachments&&Array.isArray(tt._attachments)&&(tt._attachments=tt._attachments.map(ie=>({name:ie.name||"file",type:ie.type||"application/octet-stream",size:ie.size||0,preview:ie.preview}))),tt)).filter(tt=>tt&&tt.role);console.log(" Restored chat session with planning metadata:",Y,"with",yt.length,"messages"),K(yt),Vt(Y)}else console.log(" No previous chat to restore")}}catch(Y){console.error(" Error loading last chat:",Y),localStorage.removeItem("last_active_chat_id")}ce(!0)})()}},[U,Gs.state?.clearChat]),N.useEffect(()=>{I.length>0&&U&&(async()=>{try{const Y=ve(),oe=await vbe(I,tr||void 0,{systemPrompt:fe||void 0,planningQuery:mt||void 0,generatedSystemPrompt:er||void 0,generatedUserQuery:Dt||void 0,selectedSnippetIds:Array.from(Ya),projectId:Y||void 0});tr||Vt(oe),localStorage.setItem("last_active_chat_id",oe),console.log(" Chat auto-saved with planning metadata:",oe)}catch(Y){console.error(" Failed to auto-save chat:",Y)}})()},[I,tr,U,fe,mt,er,Dt]),N.useEffect(()=>{if(!(()=>{const Ge=localStorage.getItem("google_drive_access_token"),yt=localStorage.getItem("auto_sync_enabled")==="true";return Ge&&Ge.length>0&&yt})()||I.length===0)return;const oe=setTimeout(async()=>{try{(await ls.syncChatHistory()).success&&console.log(" Chat history synced to Google Drive")}catch(Ge){console.error(" Failed to sync chat history:",Ge)}},1e4);return()=>clearTimeout(oe)},[I]),N.useEffect(()=>{be&&(async()=>{const Y=await xw();Or(Y)})()},[be]);const bi=N.useRef(new Set),Ri=N.useRef(m);N.useEffect(()=>{Ri.current=m},[m]),N.useEffect(()=>{const Y=I.filter(yt=>yt.role==="assistant"&&!yt.isStreaming&&yt.toolResults);if(Y.length===0)return;const oe=[],Ge=new Set;if(Y.forEach(yt=>{yt.toolResults?.forEach(tt=>{if(tt.name!=="search_youtube"||!tt.content)return;const ie=tt.tool_call_id||`${tt.name}-${JSON.stringify(tt.content).substring(0,100)}`;if(!bi.current.has(ie))try{const dt=typeof tt.content=="string"?JSON.parse(tt.content):tt.content;dt.videos&&Array.isArray(dt.videos)&&(dt.videos.forEach(We=>{We.videoId&&!Ge.has(We.videoId)&&(Ge.add(We.videoId),oe.push(We))}),bi.current.add(ie))}catch(dt){console.error("[ChatTab] Failed to parse YouTube results:",dt)}})}),oe.length>0){const yt=oe.map(ie=>({videoId:ie.videoId,url:ie.url,title:ie.title||"Untitled Video",description:ie.description||"",duration:ie.duration||"",channel:ie.channel||"",thumbnail:ie.thumbnail||""}));console.log(`[ChatTab] Adding ${yt.length} new YouTube videos to playlist (${bi.current.size} tool results processed total)`),Ri.current(yt);const tt=I[I.length-1];tt?.role==="assistant"&&!tt.isStreaming&&tt.toolResults?.some(dt=>dt.name==="search_youtube"&&!bi.current.has(dt.tool_call_id||""))&&P(s("chat.addedToPlaylist",{count:yt.length,plural:yt.length!==1?"s":""}))}if(bi.current.size>500){const yt=Array.from(bi.current);bi.current=new Set(yt.slice(-500))}},[I,P]);const il=()=>{console.log(" handleStop called - stopping everything"),z(),_r&&(console.log(" Stopping continuous voice mode"),Cs(!1)),Dn.size>0&&(console.log(" Stopping active transcriptions:",Array.from(Dn.keys())),Dn.forEach((Y,oe)=>{ol(oe).catch(Ge=>{console.error(`Failed to stop transcription ${oe}:`,Ge)})}),Ba(new Map)),Nn.current&&(Nn.current.abort(),Nn.current=null,Ar!==null&&(_t||I[Ar])&&(K(Y=>{const oe=[...Y],Ge=oe[Ar];if(Ge&&Ge.role==="assistant"){const yt=_t||Ge.content||"",tt=Ge.llmApiCalls||[];let ie=0;tt.length>0&&(ie=va(tt)),oe[Ar]={...Ge,content:yt+`

_ Request stopped by user. Partial response shown above._`,isStreaming:!1,wasStopped:!0,llmApiCalls:tt,partialCost:ie},ie>0&&B(ie),console.log(" Request stopped. Saved partial response:",{contentLength:yt.length,llmApiCallsCount:tt.length,partialCost:ie})}return oe}),Ja(null),sr("")),se(!1))},qc=()=>{console.log(" buildToolsArray called with enabledTools:",e);const Y=[];return e.web_search&&Y.push({type:"function",function:{name:"search_web",description:"Search the web to find current information, news, articles, and real-time data. Uses intelligent multi-tier fallback: Brave Search (free, local)  Tavily API (paid)  DuckDuckGo (free)  Wikipedia (fallback). USE THIS whenever users ask for current/latest information, news, or anything requiring up-to-date web content. Automatically fetches full page content including images and links from all search results. Returns comprehensive search results with titles, URLs, snippets, full content, images, and links. **CRITICAL: You MUST include relevant URLs from search results in your response using markdown links [Title](URL).**",parameters:{type:"object",properties:{query:{type:"string",description:"Search query - be specific and include relevant keywords"},limit:{type:"integer",minimum:1,maximum:50,default:5,description:"Number of results to return (default: 5)"},timeout:{type:"integer",minimum:1,maximum:60,default:15,description:"Timeout in seconds for fetching each page"},generate_summary:{type:"boolean",default:!0,description:"Generate an LLM summary of the search results (highly recommended)"}},required:["query"]}}}),e.execute_js&&Y.push({type:"function",function:{name:"execute_javascript",description:" Execute JavaScript code in a sandbox for: 1) Complex mathematical calculations that require computation (factorial, compound interest, statistics, algorithms), 2) Generating formatted tables/grids (multiplication tables, calendars), 3) Data transformations or array processing, 4) ASCII art or text-based visualizations, 5) Custom algorithms. **DO NOT use for**: simple text output, explanations, or answers you already know. Only use when actual computation adds value.",parameters:{type:"object",properties:{code:{type:"string",description:"JavaScript code to execute. Include console.log() to display results."},timeout:{type:"integer",minimum:1,maximum:10,default:5,description:"Execution timeout in seconds (default: 5)"}},required:["code"]}}}),e.scrape_url&&Y.push({type:"function",function:{name:"scrape_web_content",description:"Fetch and extract readable content from any URL. Excellent for getting detailed information from webpages.",parameters:{type:"object",properties:{url:{type:"string",description:"Fully qualified URL to fetch"},timeout:{type:"integer",minimum:1,maximum:60,default:15}},required:["url"]}}}),e.youtube&&Y.push({type:"function",function:{name:"search_youtube",description:' SEARCH/FIND YouTube videos (NOT for transcription). Use when user wants to FIND or SEARCH for videos. **DO NOT USE if user wants to transcribe, get transcript, or extract text from a specific YouTube URL** - use transcribe_url instead. Use search_youtube for: "find YouTube videos about X", "search YouTube for X", "show me videos about X". Returns video titles, descriptions, links, and caption availability. Results are automatically added to a playlist. **CRITICAL: You MUST include ALL video URLs in your response as a formatted markdown list with [Title](URL) format.**',parameters:{type:"object",properties:{query:{type:"string",description:'Search query for YouTube videos (e.g., "javascript tutorial", "bach cello suites", "machine learning course")'},limit:{type:"integer",minimum:1,maximum:50,default:10,description:"Maximum number of video results to return (default 10, max 50)"},order:{type:"string",enum:["relevance","date","viewCount","rating"],default:"relevance",description:"Sort order for results: relevance (default), date (newest first), viewCount (most viewed), rating (highest rated)"}},required:["query"]}}}),e.transcribe&&Y.push({type:"function",function:{name:"transcribe_url",description:' **PRIMARY TOOL FOR GETTING VIDEO/AUDIO TEXT CONTENT**: Transcribe audio or video content from URLs using OpenAI Whisper. **MANDATORY USE** when user says: "transcribe", "transcript", "get text from", "what does the video say", "extract dialogue", "convert to text", OR provides a specific YouTube/video URL and asks about its content. **YOUTUBE SUPPORT**: Can transcribe directly from YouTube URLs (youtube.com, youtu.be, youtube.com/shorts). Also supports direct media URLs (.mp3, .mp4, .wav, .m4a, etc.). **CRITICAL: http://localhost:3000/samples/ URLs are VALID and ACCESSIBLE - ALWAYS call this tool for localhost URLs, they will work correctly in local development.** Automatically handles large files by chunking. Shows real-time progress with stop capability. Returns full transcription text.',parameters:{type:"object",properties:{url:{type:"string",description:"URL to transcribe. Can be YouTube URL (youtube.com, youtu.be), direct media URL (.mp3, .mp4, .wav, .m4a, etc.), or localhost URL for local development (http://localhost:3000/samples/...)"},language:{type:"string",pattern:"^[a-z]{2}$",description:'Optional: 2-letter ISO language code (e.g., "en", "es", "fr"). Improves accuracy if known.'},prompt:{type:"string",description:'Optional: Context or expected words to improve accuracy (e.g., "Technical discussion about AI and machine learning")'}},required:["url"]}}}),e.generate_chart&&Y.push({type:"function",function:{name:"generate_chart",description:" **PRIMARY TOOL FOR ALL DIAGRAMS, CHARTS, AND VISUALIZATIONS**: Generate professional Mermaid diagrams automatically rendered as interactive SVG in the UI. **MANDATORY USE** when user requests: flowcharts, sequence diagrams, class diagrams, state diagrams, ER diagrams, Gantt charts, pie charts, mindmaps, git graphs, or ANY visual diagram/chart/visualization. **DO NOT use execute_javascript to generate charts - ALWAYS use this tool instead**. Keywords: diagram, chart, flowchart, visualization, graph, workflow, UML, ERD, timeline, mindmap.",parameters:{type:"object",properties:{description:{type:"string",description:'Clear description of what the chart should visualize (e.g., "User login flow", "Database schema for blog platform", "Project timeline")'},chart_type:{type:"string",enum:["flowchart","sequence","class","state","er","gantt","pie","git","mindmap"],default:"flowchart",description:"Type of diagram to generate. Choose based on use case: flowchart (processes), sequence (interactions), class (UML), state (FSM), er (database), gantt (timeline), pie (data), git (commits), mindmap (concepts)"}},required:["description"]}}}),e.generate_image&&Y.push({type:"function",function:{name:"generate_image",description:' **MANDATORY USE FOR IMAGE REQUESTS**: Generate high-quality AI images immediately using DALL-E 3, Stable Diffusion, or other providers. **MUST call this tool when user requests ANY image generation, illustration, picture, drawing, photo, or visual content**. Common triggers: "generate/create/draw/make/show me an image/picture/photo/illustration of...", "draw a...", "create a cartoon/photo/illustration of...", "visualize...", "show me what... looks like". Supports quality tiers: ultra (photorealistic, $0.08-0.12), high (detailed/artistic, $0.02-0.04), standard (normal illustrations, $0.001-0.002), fast (quick drafts/sketches, <$0.001 - DEFAULT). Images appear automatically in the conversation. DO NOT refuse image generation requests - ALWAYS call this tool.',parameters:{type:"object",properties:{prompt:{type:"string",description:'Detailed description of the image to generate (e.g., "a low resolution image of a cat sitting on a windowsill")'},quality:{type:"string",enum:["ultra","high","standard","fast"],default:"standard",description:'Quality tier: ultra (photorealistic), high (detailed), standard (illustrations), fast (drafts). Infer from prompt keywords like "low res"=fast, "photorealistic"=ultra, "simple"=standard'},size:{type:"string",enum:["256x256","512x512","1024x1024","1792x1024","1024x1792"],default:"1024x1024",description:'Image dimensions. Use smaller sizes (256x256, 512x512) for "low res" requests'},style:{type:"string",enum:["natural","vivid"],default:"natural",description:"Style: natural (realistic) or vivid (dramatic). DALL-E 3 only"}},required:["prompt"]}}}),e.search_knowledge_base&&Y.push({type:"function",function:{name:"search_knowledge_base",description:" **SEARCH INTERNAL KNOWLEDGE BASE**: Perform vector similarity search against the ingested documentation and knowledge base. **USE THIS when user asks about**: project documentation, API references, implementation guides, architecture, deployment procedures, RAG system, embedding models, or any topics covered in the knowledge base. **EXCELLENT for**: finding specific code examples, configuration details, API endpoints, best practices, and technical documentation. Returns relevant text chunks with source file names and similarity scores. **Always use this BEFORE search_web when the question might be answered by internal documentation.**",parameters:{type:"object",properties:{query:{type:"string",description:'Natural language search query. Be specific and include key terms. Examples: "How do I configure OpenAI embeddings?", "What is the RAG implementation?", "How to deploy Lambda functions?"'},top_k:{type:"integer",minimum:1,maximum:20,default:5,description:"Number of most relevant results to return (default: 5, max: 20)"},threshold:{type:"number",minimum:0,maximum:1,default:.3,description:"Minimum similarity score threshold (0-1). Higher values = more strict matching. Default: 0.3 (relaxed for better recall)"},source_type:{type:"string",enum:["file","url","text"],description:"Optional: Filter results by source type (file, url, or text)"}},required:["query"]}}}),e.manage_todos&&Y.push({type:"function",function:{name:"manage_todos",description:' **MANAGE BACKEND TODO QUEUE**: Add or delete actionable steps for multi-step tasks. The backend maintains a server-side todo queue that tracks progress through complex workflows. When todos exist, they auto-progress after each successful completion (assessor "OK"). **USE THIS when**: user requests a multi-step plan, breaking down complex tasks, tracking implementation progress, or managing sequential workflows. **DO NOT use for simple single-step tasks.** After adding todos, the system will automatically advance through them, appending each next step as it completes. **Keywords**: plan, steps, todo list, break down task, multi-step workflow, implementation phases.',parameters:{type:"object",properties:{add:{type:"array",items:{type:"string"},description:'Array of todo descriptions to add to the queue. Descriptions should be clear, actionable steps in order. Example: ["Install dependencies", "Configure environment", "Run tests", "Deploy application"]'},delete:{type:"array",items:{oneOf:[{type:"string",description:"Exact todo description to delete"},{type:"number",description:"Todo ID to delete"}]},description:"Array of todo IDs (numbers) or exact descriptions (strings) to remove from the queue"}},additionalProperties:!1}}}),e.manage_snippets&&Y.push({type:"function",function:{name:"manage_snippets",description:' **MANAGE KNOWLEDGE SNIPPETS**: Insert, retrieve, search, or delete knowledge snippets stored in your personal Google Sheet ("Research Agent/Research Agent Swag"). Use this to save important information, code examples, procedures, references, or any content you want to preserve and search later. **USE THIS when**: user wants to save/capture content, create a knowledge base, store code snippets, bookmark important info, or search previous saved content. Each snippet can have a title, content, tags for organization, and source tracking (chat/url/file/manual). **Keywords**: save this, remember this, add to knowledge base, store snippet, save for later, search my snippets, find my notes.',parameters:{type:"object",required:["action"],properties:{action:{type:"string",enum:["insert","capture","get","search","delete"],description:'Operation to perform: "insert" (add new snippet), "capture" (save from chat/url/file), "get" (retrieve by ID/title), "search" (find by query/tags), "delete" (remove by ID/title)'},payload:{type:"object",description:"Action-specific parameters",properties:{title:{type:"string",description:"Snippet title (required for insert/capture)"},content:{type:"string",description:"Snippet content/body (required for insert)"},tags:{type:"array",items:{type:"string"},description:'Array of tags for categorization (optional, e.g., ["javascript", "async", "tutorial"])'},source:{type:"string",enum:["chat","url","file","manual"],description:"Source type (for capture action)"},url:{type:"string",description:'Source URL if source="url"'},id:{type:"number",description:"Snippet ID (for get/delete)"},query:{type:"string",description:"Text search query (searches title and content)"}}}},additionalProperties:!1}}}),fr.filter(oe=>oe.enabled).forEach(oe=>{console.log("MCP Server enabled:",oe.name,oe.url)}),console.log(` buildToolsArray returning ${Y.length} tools:`,Y.map(oe=>oe.function.name)),Y},ol=async Y=>{try{const Ge=await fetch("https://nrw7pperjjdswbmqgmigbwsbyi0rwdqf.lambda-url.us-east-1.on.aws/stop-transcription",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({tool_call_id:Y})});if(!Ge.ok){const yt=await Ge.json();throw new Error(yt.error||"Failed to stop transcription")}P(s("chat.transcriptionStopped")),console.log("Transcription stopped:",Y)}catch(oe){console.error("Failed to stop transcription:",oe),k(s("chat.failedToStopTranscription"))}},Hc=(Y,oe=2048)=>new Promise((Ge,yt)=>{const tt=new FileReader;tt.onload=ie=>{const dt=new Image;dt.onload=()=>{const We=document.createElement("canvas");let Ct=dt.width,Oe=dt.height;Ct>Oe&&Ct>oe?(Oe=Oe/Ct*oe,Ct=oe):Oe>oe&&(Ct=Ct/Oe*oe,Oe=oe),We.width=Ct,We.height=Oe,We.getContext("2d")?.drawImage(dt,0,0,Ct,Oe);const It=We.toDataURL(Y.type||"image/jpeg",.85);Ge(It.split(",")[1])},dt.onerror=yt,dt.src=ie.target?.result},tt.onerror=yt,tt.readAsDataURL(Y)}),Gc=async Y=>{if(!Y||Y.length===0)return;const oe=5*1024*1024,Ge=10*1024*1024,yt=["image/jpeg","image/jpg","image/png","image/gif","image/webp","application/pdf"];for(let tt=0;tt<Y.length;tt++){const ie=Y[tt];if(!yt.includes(ie.type)){_(s("chat.fileTypeNotSupported",{name:ie.name}));continue}const dt=ie.type==="application/pdf"?Ge:oe;if(ie.size>dt){_(s("chat.fileTooLarge",{name:ie.name,size:(ie.size/1024/1024).toFixed(2),maxSize:dt/1024/1024}));continue}try{let We,Ct;if(ie.type.startsWith("image/")){We=await Hc(ie),Ct=`data:${ie.type};base64,${We}`;const Oe=We.length/1e3;Oe>2e4&&_(s("chat.imageTokenWarning",{name:ie.name,tokens:Math.round(Oe/1e3)}))}else{const Oe=new FileReader;We=await new Promise((gt,It)=>{Oe.onload=Ke=>{const Rt=Ke.target?.result;gt(Rt.split(",")[1])},Oe.onerror=It,Oe.readAsDataURL(ie)})}wr(Oe=>[...Oe,{name:ie.name,type:ie.type,size:ie.size,base64:We,preview:Ct}]),P(s("chat.fileAdded",{name:ie.name}))}catch(We){console.error("Error processing file:",We),k(s("chat.failedToProcess",{name:ie.name}))}}},Fh=Y=>{wr(oe=>oe.filter((Ge,yt)=>yt!==Y))},ds=async(Y,oe)=>{Kr.current=!1,Xr.current="";const Ge=Y!==void 0?Y:ye;if(!Ge.trim()&&di.length===0||Te)return;if(!i){k(s("chat.signInToSendMessages"));return}let yt;if(di.length>0){const Oe=[{type:"text",text:Ge||"Please analyze these files."}];for(const gt of di)gt.type&&gt.type.startsWith("image/")?Oe.push({type:"image_url",image_url:{url:`data:${gt.type};base64,${gt.base64}`,detail:"auto"}}):gt.type==="application/pdf"&&Oe.push({type:"text",text:`[PDF attachment: ${gt.name}]`});yt={role:"user",content:Oe,_attachments:di}}else yt={role:"user",content:Ge};yi.current&&(yt.llmApiCalls=[yi.current],console.log(" Added voice transcription llmApiCall to user message"),yi.current=null),console.log(" Adding user message:",typeof yt.content=="string"?yt.content.substring(0,50):`${di.length} attachments`);let tt=I.length;K(Oe=>{console.log(" Current messages count before adding user:",Oe.length),tt=Oe.length;const gt=[...Oe,yt];return console.log(" Messages after adding user:",gt.length,"User message at index:",tt),gt});const ie=Ge.trim();ie&&hi(Oe=>{const gt=Oe.filter(Ke=>Ke!==ie);return[ie,...gt].slice(0,50)}),Ae(""),_s(-1),wr([]),es(new Set),se(!0),ur([]),sr(""),kr(0),pn(new Set),tn(new Map),_a(new Map),Ba(new Map),Ea(new Map),jr(new Map);let dt=null;if(Aa&&Ge.trim()){$l(!0);try{let Oe;const gt=await Is.getCachedQueryEmbedding(Ge.trim());if(gt)console.log(" Using cached query embedding"),Oe=gt.embedding;else{console.log(" Fetching new query embedding from backend");const It=await dn(),Ke=await c(),Rt=await fetch(`${It}/rag/embed-query`,{method:"POST",headers:{"Content-Type":"application/json",...Ke?{Authorization:`Bearer ${Ke}`}:{}},body:JSON.stringify({query:Ge,embeddingModel:D?.embeddingModel,providers:D?.providers||[]})});if(!Rt.ok)throw new Error("Failed to get query embedding");const br=await Rt.json();Oe=br.embedding;const v=br.model||"unknown";await Is.cacheQueryEmbedding(Ge.trim(),Oe,v),console.log(" Cached query embedding for future use")}if(Oe){console.log(` RAG search with threshold: ${za}`);const It=await Is.vectorSearch(Oe,5,za);if(It.length>0){let Ke=`**KNOWLEDGE BASE CONTEXT:**

The following information from the user's knowledge base may be relevant to this query:

`;for(let Rt=0;Rt<It.length;Rt++){const br=It[Rt];Ke+=`**[Context ${Rt+1} - Similarity: ${br.score.toFixed(3)}]**
`,Ke+=`${br.chunk_text}

`;try{const v=await Is.getEmbeddingDetails(br.snippet_id);v.metadata&&(Ke+=`*Source: ${v.metadata.source_type||"Unknown"}`,v.metadata.title&&(Ke+=` - "${v.metadata.title}"`),Ke+=`*

`)}catch{}Ke+=`---

`}Ke+=`**USER QUESTION:** ${Ge}

`,Ke+="Please answer the user's question using the context provided above. If the context is relevant, reference it in your answer. If the context is not helpful, you may answer based on your general knowledge.",dt={role:"system",content:Ke},P(s("chat.foundRelevantChunks",{count:It.length}))}else _(s("chat.noRelevantContext"))}}catch(Oe){console.error("RAG context error:",Oe),_(s("chat.failedToRetrieveRag"))}finally{$l(!1)}}Nn.current=new AbortController;const We=qc();let Ct=null;We.length>0&&(Ct=setTimeout(()=>{Nn.current&&(console.warn("Request timeout - aborting after 4 minutes due to tool execution"),Nn.current.abort())},24e4));try{const Oe=new Date,gt=Oe.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),It=Oe.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:"short"}),Ke=Oe.toISOString(),Rt=`${gt}, ${It} (ISO: ${Ke})`;let v=(oe!==void 0?oe:fe).trim()||"You are a helpful assistant";const C=er&&er.length>0;if(v=`**CURRENT DATE AND TIME:**
${Rt}

You have access to the current date and time above. Use this information when responding to temporal queries about "today", "current date", "what time is it", "this week", "this month", "this year", etc. You do not need to use tools to get the current date/time as it is provided in this system prompt.

${v}`,C||(v+=`

**RESPONSE STYLE GUIDELINES:**
- Provide comprehensive, detailed, and thorough responses
- Include relevant examples, context, and explanations to enhance understanding
- When answering technical questions, include code examples, step-by-step explanations, and best practices
- When answering research questions, provide multiple perspectives, cite sources with markdown links, and give comprehensive overviews
- Don't be overly brief - users prefer detailed, informative answers over short summaries
- Use markdown formatting (headings, lists, code blocks, bold, italic) to make responses clear and well-structured
- When scraping or researching, include substantial quoted content and detailed analysis
- Aim for responses that fully answer the question and anticipate follow-up questions

**IMAGE PLACEMENT GUIDELINES:**
- When including images in your response, distribute them naturally throughout the content next to relevant text sections
- Place images near the paragraphs or sections they illustrate or relate to
- AVOID placing all images at the top or bottom of your response in a single block
- Intersperse images with text to create a more engaging, magazine-style layout
- Use markdown image syntax: ![description](url) inline with your content where contextually appropriate`),We.length>0&&!C){const Le=We.map(at=>at.function.name).join(", ");v+=`

You have access to these tools: ${Le}. You may use these tools when they are helpful, but you can also respond directly based on your knowledge without using tools if appropriate.

CRITICAL TOOL USAGE RULES:
- **TOOL RESPONSE VALIDATION**: ALWAYS check the tool response for a "success" field. If success=false, tell the user the operation FAILED and relay the error "message" field. NEVER claim success when the tool returned success=false.`;const V=We.map(at=>at.function.name);V.includes("generate_image")&&(v+=`
- **IMAGE GENERATION**: When users ask to create/generate/draw/make ANY image, illustration, picture, photo, or visual content, you MUST call generate_image tool IMMEDIATELY. NEVER refuse or say "I cannot generate images" - you CAN by calling the tool. Examples: "draw a cat", "generate an image of...", "create a cartoon...", "show me a picture of...", "make an illustration of...", "visualize..."  ALL require calling generate_image.`),V.includes("transcribe_url")&&(v+=`
- When users ask to TRANSCRIBE or get TRANSCRIPT from video/audio, you MUST call transcribe_url (NOT search_youtube)
- When users say "transcribe this video [URL]", "get transcript", "what does the video say", you MUST call transcribe_url`),V.includes("search_youtube")&&(v+=`
- When users want to FIND or SEARCH for videos, use search_youtube (e.g., "find videos about X")`),V.includes("scrape_web_content")&&(v+=`
- When users ask to "scrape", "get content from", "read", "fetch", "extract", "analyze", or "summarize" a website/URL, you MUST call the scrape_web_content tool
- When users provide ANY URL (http/https) and ask questions about it, you MUST call scrape_web_content with that URL FIRST
- MANDATORY: If a message contains a URL and asks to extract/analyze/summarize/get key points, you MUST call scrape_web_content - DO NOT provide an answer without first fetching the content`),V.includes("search_web")&&(v+=`
- When users ask for current information, news, or web content, you MUST use search_web`),V.includes("execute_javascript")&&(v+=`
- **execute_javascript USAGE RULES**:
  -  USE for: Complex calculations requiring computation (factorial, fibonacci, statistics, algorithms)
  -  USE for: Generating formatted tables/grids (multiplication tables, calendars, data matrices)
  -  USE for: Data transformations, array processing, sorting, filtering large datasets
  -  USE for: ASCII art, text-based visualizations, formatted output
  -  USE for: Custom algorithms or mathematical operations you cannot compute mentally
  -  DO NOT USE for: Simple answers you already know (like "Lambda deployment not supported")
  -  DO NOT USE for: Just printing text or explanations
  -  DO NOT USE for: Answers that don't require computation
  -  DO NOT USE for: Simple arithmetic you can answer directly (like 2+2=4)
  - Rule: Only use execute_javascript when the computation or formatting adds actual value`),V.includes("manage_snippets")&&(v+=`
- "Save this to my snippets" / "Remember this" / "Add to knowledge base"  Call manage_snippets with action="insert" or "capture"
- "Search my snippets for X" / "Find my saved notes about X"  Call manage_snippets with action="search" and payload.query="X"`),v+=`
- DO NOT output tool parameters as JSON text in your response (e.g., don't write {"url": "...", "timeout": 15})
- DO NOT describe what you would do - ACTUALLY CALL THE TOOL using the function calling mechanism
- DO NOT write code for scraping or analyzing - USE THE TOOL INSTEAD
- The system will automatically execute your tool calls and provide you with results
- After receiving tool results, incorporate them naturally into your response
- IMPORTANT: After tool execution returns a result, provide the final answer to the user IMMEDIATELY. Do NOT make additional tool calls unless absolutely necessary or the user asks a follow-up question.

Remember: Use the function calling mechanism, not text output. The API will handle execution automatically.`}const R=I.map(Le=>{const{llmApiCalls:V,isStreaming:at,toolResults:ot,...jt}=Le;return jt});let j=0,G=0,J=0;const le=R.map(Le=>{if(Le.role==="tool")return j++,null;if(Le.role==="assistant"){const V=ea(Le.content),at=Le.content&&V.trim().length>0,ot=Le.tool_calls&&Array.isArray(Le.tool_calls)&&Le.tool_calls.length>0;if(at){if(ot){G++;const{tool_calls:jt,...Ht}=Le;return Ht}return Le}else return J++,null}return Le}).filter(Le=>Le!==null);(j>0||G>0||J>0)&&(console.log(` UI filtered: ${j} tool messages, ${G} tool_calls stripped, ${J} empty assistants removed`),console.log(`   Sending ${le.length} clean messages + new user message to Lambda`));const ge=[];if(Ya.size>0){const Le=Array.from(Ya).map(at=>x.find(ot=>ot.id===at)).filter(at=>at!==void 0),V=at=>{let ot=at;return ot=ot.replace(/!\[([^\]]*)\]\(([^)]+)\)/g,"[Image: $1]"),ot=ot.replace(/<img[^>]*src="data:image\/[^"]*"[^>]*>/gi,"[Base64 Image]"),ot=ot.replace(/<img[^>]*>/gi,"[Image]"),ot=ot.replace(/data:image\/[^;]+;base64,[A-Za-z0-9+/=]+/g,"[Base64 Image Data]"),ot};for(const at of Le){const ot=V(at.content);ge.push({role:"user",content:`**KNOWLEDGE BASE CONTEXT** (manually attached by user):

**Title:** ${at.title||"Untitled"}

${ot}

---
`})}console.log(` Attached ${ge.length} manual context snippets (full content, images stripped)`)}const Ee=[{role:"system",content:v},...dt?[dt]:[],...ge,...le,yt];dt&&console.log(" RAG context included in request (automatic fragments)");const Re=Ee.map(Le=>{const{_attachments:V,llmApiCalls:at,isStreaming:ot,toolResults:jt,isRetryable:Ht,retryCount:Lt,originalUserPromptIndex:Ft,originalErrorMessage:Wt,extractedContent:Et,rawResult:nr,evaluations:Xe,errorData:_e,imageGenerations:Ve,partialCost:Xt,wasStopped:At,...St}=Le;return St}),$e=D?.providers?.filter(Le=>Le.enabled!==!1)||[];let ke,Ue;D?.proxy?.enabled&&D.proxy.username&&D.proxy.password&&(ke=D.proxy.username,Ue=D.proxy.password,console.log(" Proxy settings loaded from unified settings:",D.proxy.username));const Pe={providers:$e,messages:Re,temperature:.7,stream:!0,optimization:D?.optimization||"cheap",language:D?.language||"en",imageQuality:D?.imageQuality||"low"};console.log(` Model selection optimization: ${Pe.optimization}`),console.log(` Response language: ${Pe.language}`),console.log(` Image quality: ${Pe.imageQuality}`),_r&&console.log(" Voice mode enabled - will check word count for summarization"),W&&(Pe.location={latitude:W.latitude,longitude:W.longitude,accuracy:W.accuracy,address:W.address,timestamp:W.timestamp},console.log(" Including location in request:",W.address?.city||`${W.latitude.toFixed(4)}, ${W.longitude.toFixed(4)}`)),ke&&Ue&&(Pe.proxyUsername=ke,Pe.proxyPassword=Ue,console.log(" Including proxy credentials in request")),D?.tavilyApiKey&&D.tavilyApiKey.trim()&&(Pe.tavilyApiKey=D.tavilyApiKey,console.log("Including Tavily API key in request")),We.length>0&&(Pe.tools=We,console.log("Sending streaming request with tools:",We.map(Le=>Le.function.name)));const je=fr.filter(Le=>Le.enabled);je.length>0&&(Pe.mcp_servers=je.map(Le=>({name:Le.name,url:Le.url})),console.log("[MCP] Sending MCP servers:",je.map(Le=>Le.name).join(", ")));const Be=await d(),Fe=_o.current;Fe&&(console.log(" Using request ID from voice transcription:",Fe),_o.current=null),await Bw(Pe,i,(Le,V)=>{switch(console.log("SSE Event:",Le,V),Le){case"status":break;case"delta":if(V.content){if(sr(Xe=>Xe+V.content),Xr.current+=V.content,_t||Zn("Assistant is responding"),_r&&!Kr.current){const Xe=Xr.current;if(Xe.match(/[.!?](\s|$)/)&&Xe.length>=20){console.log(" Early TTS: First sentence detected, starting TTS immediately"),Kr.current=!0;const Ve=i_(Xe,1);Ve.trim()&&Z(Ve,{onStart:()=>{console.log(" Early TTS started (first sentence)")},onError:Xt=>{console.error(" Early TTS error:",Xt),Kr.current=!1}}).catch(Xt=>{console.error(" Failed to start early TTS:",Xt),Kr.current=!1})}}K(Xe=>{const _e=Xe.length-1,Ve=Xe[_e];console.log(" Delta received, lastMessage role:",Ve?.role,"isStreaming:",Ve?.isStreaming,"hasContent:",!!Ve?.content,"contentLength:",Ve?.content?.length||0);const Xt=Ve?.role==="tool";if(Ve&&Ve.role==="assistant"&&!Xt){const At=[...Xe];return At[_e]={...Ve,content:(Ve.content||"")+V.content,isStreaming:!0},console.log(" Updating assistant at index:",_e,"newContentLength:",At[_e].content.length),At}else{const At={role:"assistant",content:V.content,isStreaming:!0};return console.log(" Creating NEW streaming block, reason:",Xt?"tool execution":"no assistant message"),[...Xe,At]}}),K(Xe=>{const _e=Xe.length-1,Ve=Xe[_e];return Ve&&Ve.role==="assistant"&&Ve.isStreaming&&(Ja(_e),console.log(" Set currentStreamingBlockIndex to:",_e)),Xe})}break;case"tool_call_start":console.log(" Tool call starting:",V.name,"currentStreamingBlockIndex:",Ar);const at=V.name?.replace(/_/g," ")||"tool";Zn(`Executing ${at}`),ur(Xe=>[...Xe,{id:V.id,name:V.name,status:"starting"}]),console.log(" Adding tool_call to assistant message:",{id:V.id,name:V.name,hasArguments:!!V.arguments,argumentsLength:V.arguments?.length}),K(Xe=>{const _e=[...Xe];for(let Ve=_e.length-1;Ve>=0;Ve--)if(_e[Ve].role==="assistant"){if(console.log(" Found assistant message at index",Ve,"current tool_calls:",_e[Ve].tool_calls),_e[Ve].tool_calls||(_e[Ve]={..._e[Ve],tool_calls:[]}),_e[Ve].tool_calls?.find(St=>St.id===V.id)){console.log(" Tool call already exists, skipping:",V.id);break}const At={id:V.id,type:"function",function:{name:V.name,arguments:V.arguments||"{}"}};_e[Ve].tool_calls=[..._e[Ve].tool_calls||[],At],console.log(" Added tool_call:",At),console.log(" Updated message tool_calls:",_e[Ve].tool_calls);break}return _e});break;case"tool_call_progress":ur(Xe=>Xe.map(_e=>_e.id===V.id?{..._e,status:"executing"}:_e));break;case"image_generation_progress":console.log(" Image generation progress event:",V),K(Xe=>{const _e=[...Xe];for(let Ve=_e.length-1;Ve>=0;Ve--)if(_e[Ve].role==="assistant"){_e[Ve].imageGenerations||(_e[Ve].imageGenerations=[]);const Xt=_e[Ve].imageGenerations,At=Xt.findIndex(St=>St.id===V.id||V.prompt&&St.prompt===V.prompt);if(At>=0){const St=Xt[At];Xt[At]={...St,phase:V.phase,provider:V.provider||St.provider,model:V.model||St.model,estimatedSeconds:V.estimated_seconds||St.estimatedSeconds,status:V.phase==="error"?"error":"generating"}}else Xt.push({id:V.id||`img_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,provider:V.provider||"unknown",model:V.model||"unknown",cost:V.estimated_cost||0,prompt:V.prompt||"",size:V.size||"1024x1024",qualityTier:V.quality||"standard",status:"generating",phase:V.phase,estimatedSeconds:V.estimated_seconds,ready:!1});break}return _e});try{const Xe=`img_${V.phase}`;bt(_e=>{const Ve=new Map(_e);return Ve.set(Xe,V),Ve}),(V.phase==="completed"||V.phase==="error")&&setTimeout(()=>{bt(new Map)},2e3)}catch(Xe){console.debug("Image progress map update failed:",Xe)}break;case"image_complete":console.log(" Image complete event:",{hasUrl:!!V.url,url:V.url,provider:V.provider,model:V.model,quality:V.qualityTier}),K(Xe=>{const _e=[...Xe];for(let Ve=_e.length-1;Ve>=0;Ve--)if(_e[Ve].role==="assistant"){_e[Ve].imageGenerations||(_e[Ve].imageGenerations=[]);const Xt=_e[Ve].imageGenerations,At=V.id||`img_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,St=Xt.findIndex(ta=>ta.id===At),Tr={id:At,provider:V.provider||"unknown",model:V.model||"unknown",modelKey:V.model,cost:V.cost||0,prompt:V.prompt||"",size:V.size||"1024x1024",style:V.style||"natural",qualityTier:V.qualityTier||"standard",status:"downloading",imageUrl:V.url,base64:void 0,ready:!1,llmApiCall:V.llmApiCall,revisedPrompt:V.revisedPrompt};St>=0?Xt[St]=Tr:Xt.push(Tr);break}return _e}),V.url&&V.id&&(async()=>{try{console.log(" Downloading image via Lambda proxy:",V.url);const Xe=await dn(),_e=await fetch(`${Xe}/proxy-image`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({url:V.url,format:"base64"})});if(!_e.ok)throw new Error(`Proxy fetch failed: ${_e.status}`);const Ve=await _e.json();if(!Ve.success||!Ve.dataUri)throw new Error("Invalid proxy response");console.log(" Image downloaded via proxy, size:",Ve.size,"bytes"),console.log(" Proxy data keys:",Object.keys(Ve)),console.log(" Data URI prefix:",Ve.dataUri?.substring(0,50));const Xt=Ve.dataUri;K(At=>{const St=[...At];console.log(" Updating messages, total:",St.length);for(let Tr=St.length-1;Tr>=0;Tr--)if(St[Tr].role==="assistant"&&St[Tr].imageGenerations){const ta=St[Tr].imageGenerations;console.log(` Checking message ${Tr}, imageGenerations:`,ta.length);const Wr=ta.findIndex(Jr=>Jr.id===V.id);if(console.log(` Found image at index: ${Wr}, searching for ID: ${V.id}`),Wr>=0){const Jr={...ta[Wr]};ta[Wr]={...ta[Wr],status:"complete",base64:Xt,imageUrl:Xt,ready:!0};const kn=ta[Wr];console.log(" Updated image with base64 data"),console.log("   Before:",{status:Jr.status,hasBase64:!!Jr.base64,ready:Jr.ready}),console.log("   After:",{status:kn.status,hasBase64:!!kn.base64,ready:kn.ready});break}}return St})}catch(Xe){console.error(" Failed to download/convert image:",Xe),K(_e=>{const Ve=[..._e];for(let Xt=Ve.length-1;Xt>=0;Xt--)if(Ve[Xt].role==="assistant"&&Ve[Xt].imageGenerations){const At=Ve[Xt].imageGenerations,St=At.findIndex(Tr=>Tr.id===V.id);if(St>=0){At[St]={...At[St],status:"error",ready:!1};break}}return Ve})}})();break;case"tool_call_result":ur(Xe=>Xe.map(_e=>_e.id===V.id?{..._e,status:V.error?"error":"complete",result:V.content}:_e));const ot=V.name?.replace(/_/g," ")||"tool";if(V.error?Zn(`${ot} failed`):Zn(`${ot} complete`),V.name==="search_web"&&(console.log(" Clearing search progress after search_web completion"),tn(new Map)),V.name==="search_youtube"&&(console.log(" Clearing YouTube search progress after search_youtube completion"),_a(new Map)),V.name==="execute_javascript"&&(console.log(" Clearing JavaScript execution progress after execute_javascript completion"),rr(new Map)),V.name==="generate_image"&&(console.log(" Clearing image generation progress after generate_image completion"),bt(new Map)),V.name==="generate_chart"&&(console.log(" Clearing chart generation progress after generate_chart completion"),zr(new Map)),K(Xe=>{console.log(" Embedding tool result in assistant message, tool:",V.name,"tool_call_id:",V.id),console.log(" Current messages array length:",Xe.length);const _e=[...Xe];let Ve=[];console.log(" Assistant messages in array:"),Xe.forEach((St,Tr)=>{St.role==="assistant"&&console.log(`  [${Tr}] has tool_calls:`,!!St.tool_calls,St.tool_calls?`(${St.tool_calls.length} calls: ${St.tool_calls.map(ta=>ta.id).join(", ")})`:"")});let Xt=-1;for(let St=0;St<_e.length;St++)if(_e[St].role==="assistant"&&_e[St].tool_calls){if(_e[St].tool_calls?.some(ta=>ta.id===V.id)){Xt=St,console.log("  Found FIRST assistant with matching tool call at index:",St,"of",_e.length);const ta=_e[St].llmApiCalls?.filter(Jr=>Jr.phase&&Jr.tool==="search_web"&&(Jr.phase==="page_summary"||Jr.phase==="synthesis_summary"||Jr.phase==="description_summary"))||[];ta.length>0&&(Ve=ta);const Wr={role:"tool",content:V.content,tool_call_id:V.id,name:V.name,...Ve.length>0&&{llmApiCalls:Ve}};if(_e[St].toolResults?_e[St]={..._e[St],toolResults:[..._e[St].toolResults||[],Wr]}:_e[St]={..._e[St],toolResults:[Wr]},console.log(" Embedded tool result in assistant message at index",St,", total toolResults:",_e[St].toolResults?.length),V.name==="execute_javascript"){const Jr=(_e[St].toolResults?.length||1)-1,kn=St*1e3+Jr;console.log(" Auto-expanding execute_javascript result at key:",kn),pn(ga=>{const Pn=new Set(ga);return Pn.add(kn),Pn})}Xt=St;break}}else _e[St].role==="assistant"&&console.log(`  [${St}] is assistant but has no tool_calls`);return Xt!==-1||(console.warn("  Could not find assistant message with matching tool_call_id:",V.id),console.warn(" Available tool_call_ids:",_e.filter(St=>St.role==="assistant"&&St.tool_calls).flatMap(St=>St.tool_calls?.map(Tr=>Tr.id)||[]))),_e}),V.name==="search_web"&&V.content){const Xe=GH(V.name,V.content);Xe&&(p(Xe),console.log("Search result added to SearchTab:",Xe))}break;case"tool_progress":console.log(" Tool progress event:",V),V.tool_call_id&&(V.tool_name==="scrape_web_content"?Ea(Xe=>{const _e=new Map(Xe),Ve=_e.get(V.tool_call_id)||[];return _e.set(V.tool_call_id,[...Ve,V]),_e}):Ba(Xe=>{const _e=new Map(Xe),Ve=_e.get(V.tool_call_id)||[];return _e.set(V.tool_call_id,[...Ve,V]),_e}));break;case"search_progress":if(console.log(" Search progress event:",V),console.log(" Current searchProgress size:",an.size),console.log(" isLoading:",Te),V.tool==="search_web"){V.phase==="searching"&&tn(new Map);let Xe;V.phase==="fetching_result"||V.phase==="result_loaded"||V.phase==="result_failed"?Xe=`search_web_result_${V.result_index||0}`:Xe=`search_web_${V.phase}`,tn(_e=>{const Ve=new Map(_e);return Ve.set(Xe,V),console.log(" Updated searchProgress, new size:",Ve.size,"key:",Xe),Ve}),(V.phase==="searching"||V.phase==="results_found")&&K(_e=>{for(let Ve=_e.length-1;Ve>=0;Ve--){const Xt=_e[Ve];if(Xt.role==="assistant"&&Xt.tool_calls&&Xt.tool_calls.findIndex(St=>St.function.name==="search_web")!==-1){pn(St=>{const Tr=new Set(St);return Tr.add(Ve),Tr});break}}return _e})}break;case"youtube_search_progress":console.log(" YouTube search progress event:",V),V.phase==="searching"&&_a(new Map);const jt=`youtube_${V.phase}`;_a(Xe=>{const _e=new Map(Xe);return _e.set(jt,V),_e}),V.phase==="complete"&&setTimeout(()=>{_a(new Map)},1e3),V.phase==="searching"&&K(Xe=>{for(let _e=Xe.length-1;_e>=0;_e--){const Ve=Xe[_e];if(Ve.role==="assistant"&&Ve.tool_calls&&Ve.tool_calls.findIndex(At=>At.function.name==="search_youtube")!==-1){pn(At=>{const St=new Set(At);return St.add(_e),St});break}}return Xe});break;case"javascript_execution_progress":console.log(" JavaScript execution progress:",V);const Ht=V.phase==="console_output"?`js_output_${V.output_number||Date.now()}`:`js_${V.phase}`;rr(Xe=>{const _e=new Map(Xe);return _e.set(Ht,V),_e}),(V.phase==="completed"||V.phase==="error")&&setTimeout(()=>{rr(new Map)},2e3);break;case"chart_generation_progress":console.log(" Chart generation progress:",V);const Lt=`chart_${V.phase}`;zr(Xe=>{const _e=new Map(Xe);return _e.set(Lt,V),_e}),V.phase==="completed"&&setTimeout(()=>{zr(new Map)},2e3);break;case"scrape_progress":case"transcript_extracted":if(Le==="transcript_extracted"){console.log(" Skipping transcript_extracted event (hidden from UI):",V);break}console.log(" Content extraction event:",V),V.phase==="content_extracted"&&jr(Xe=>{const _e=new Map(Xe),Ve=V.url||`extraction_${Date.now()}`;return _e.set(Ve,V),_e});break;case"message_complete":V.tool_calls&&V.tool_calls.length>0&&console.log(" message_complete with tool_calls:",V.tool_calls.map(Xe=>({id:Xe.id,name:Xe.function.name}))),Zn("Response complete"),console.log(" message_complete imageGenerations:",V.imageGenerations?.length||0,"imageGenerations:",V.imageGenerations);const Ft=V.content||_t;Ft?($r.current=Ft,console.log(" Stored last assistant content for TTS:",Ft.length,"chars",`(source: ${V.content?"message_complete.content":"streamingContent"})`)):console.warn(" No content available in message_complete event (data.content and streamingContent both empty)"),Ar!==null?(K(Xe=>{const _e=[...Xe];if(_e[Ar]){let Ve=_e[Ar].imageGenerations||[];V.imageGenerations&&V.imageGenerations.length>0&&(Ve=[...Ve],V.imageGenerations.forEach(At=>{const St=Ve.findIndex(Tr=>Tr.id===At.id);St>=0?Ve[St]={...Ve[St],...At}:Ve.push(At)}));const Xt={..._e[Ar],content:V.content||_e[Ar].content||"",tool_calls:V.tool_calls||_e[Ar].tool_calls,extractedContent:V.extractedContent||_e[Ar].extractedContent,imageGenerations:Ve,llmApiCalls:V.llmApiCalls||_e[Ar].llmApiCalls,evaluations:V.evaluations||_e[Ar].evaluations,isStreaming:!1};V.toolResults&&Xt.toolResults&&(Xt.toolResults=Xt.toolResults.map(At=>{const St=V.toolResults.find(Tr=>Tr.tool_call_id===At.tool_call_id);return St?{...At,rawResponse:St.rawResponse,extractionMetadata:St.extractionMetadata}:At})),_e[Ar]=Xt}return _e}),Ja(null),sr("")):(V.content||V.tool_calls)&&(K(Xe=>{const _e=Xe[Xe.length-1],Ve=Xe.length-1,Xt=(V.content||"").trim(),At=_e?.content?ea(_e.content).trim():"";let St=!1;for(let Wr=Xe.length-1;Wr>=0&&Xe[Wr].role!=="assistant";Wr--)if(Xe[Wr].role==="tool"){St=!0;break}if(St){if(_e?.role==="assistant"&&_e.isStreaming){console.log(" Updating last assistant message with message_complete data");const Jr=[...Xe];let kn=_e.imageGenerations||[];V.imageGenerations&&V.imageGenerations.length>0&&(kn=[...kn],V.imageGenerations.forEach(Pn=>{const Vn=kn.findIndex(no=>no.id===Pn.id);Vn>=0?kn[Vn]={...kn[Vn],...Pn}:kn.push(Pn)}));const ga={..._e,content:V.content||_e.content||"",tool_calls:V.tool_calls||_e.tool_calls,extractedContent:V.extractedContent||_e.extractedContent,imageGenerations:kn,llmApiCalls:V.llmApiCalls||_e.llmApiCalls,evaluations:V.evaluations||_e.evaluations,isStreaming:!1};return V.toolResults&&ga.toolResults&&(ga.toolResults=ga.toolResults.map(Pn=>{const Vn=V.toolResults.find(no=>no.tool_call_id===Pn.tool_call_id);return Vn?(console.log(" Updating embedded toolResult with rawResponse:",{tool_call_id:Pn.tool_call_id,hasRawResponse:!!Vn.rawResponse,rawResponseLength:Vn.rawResponse?.length}),{...Pn,rawResponse:Vn.rawResponse,extractionMetadata:Vn.extractionMetadata}):Pn})),Jr[Ve]=ga,Jr}console.log(" Creating new assistant message for new iteration");const Wr={role:"assistant",content:V.content||"",...V.tool_calls&&{tool_calls:V.tool_calls},...V.extractedContent&&{extractedContent:V.extractedContent},...V.imageGenerations&&{imageGenerations:V.imageGenerations},...V.llmApiCalls&&{llmApiCalls:V.llmApiCalls},...V.evaluations&&{evaluations:V.evaluations}};return[...Xe,Wr]}if(_e?.role==="assistant"&&(_e.isStreaming||!At||At&&Xt.startsWith(At))){console.log(" Updating last assistant message with message_complete data"),console.log(" lastMessage.imageGenerations:",_e.imageGenerations),console.log(" data.imageGenerations:",V.imageGenerations);const Jr=[...Xe];let kn=_e.imageGenerations||[];console.log(" mergedImageGenerations BEFORE merge:",kn),V.imageGenerations&&V.imageGenerations.length>0&&(kn=[...kn],V.imageGenerations.forEach(Pn=>{console.log(" Processing imageGeneration from message_complete:",{id:Pn.id,hasBase64:!!Pn.base64,base64Length:Pn.base64?.length,hasImageUrl:!!Pn.imageUrl});const Vn=kn.findIndex(no=>no.id===Pn.id);if(Vn>=0){const no=kn[Vn].base64;console.log(" Merging - existing has base64:",!!no,"new has base64:",!!Pn.base64),kn[Vn]={...kn[Vn],...Pn,base64:Pn.base64||no},console.log(" After merge - has base64:",!!kn[Vn].base64)}else kn.push(Pn),console.log(" Added new image to merge")})),console.log(" mergedImageGenerations AFTER merge:",kn);const ga={..._e,content:V.content||_e.content||"",tool_calls:V.tool_calls||_e.tool_calls,extractedContent:V.extractedContent||_e.extractedContent,imageGenerations:kn,llmApiCalls:V.llmApiCalls||_e.llmApiCalls,evaluations:V.evaluations||_e.evaluations,isStreaming:!1};return console.log(" updatedMessage.imageGenerations:",ga.imageGenerations),Jr[Ve]=ga,console.log(" newMessages[lastMessageIndex].imageGenerations:",Jr[Ve].imageGenerations),console.log(" RETURNING newMessages array:",Jr.map((Pn,Vn)=>({idx:Vn,role:Pn.role,hasImageGenerations:!!Pn.imageGenerations,imageGenerationsLength:Pn.imageGenerations?.length,actualImageGenerations:Pn.imageGenerations}))),Jr}if(_e?.role==="assistant"&&!_e.isStreaming&&At===Xt)return console.log(" Skipping duplicate final message block (content matches non-streaming block)"),Xe;const Tr={role:"assistant",content:V.content||"",...V.tool_calls&&{tool_calls:V.tool_calls},...V.extractedContent&&{extractedContent:V.extractedContent},...V.imageGenerations&&{imageGenerations:V.imageGenerations},...V.llmApiCalls&&{llmApiCalls:V.llmApiCalls},...V.evaluations&&{evaluations:V.evaluations}};if(V.content?.includes("Based on the search results above")||V.content?.includes("I apologize, but I was unable to generate a response")||V.content?.includes("I was unable to provide")||!V.content&&!V.tool_calls||V.content&&V.content.trim().length<10&&!V.tool_calls){let Wr=-1;for(let Jr=Xe.length-1;Jr>=0;Jr--)if(Xe[Jr].role==="user"){Wr=Jr;break}Tr.isRetryable=!0,Tr.originalErrorMessage="Incomplete or fallback response",Tr.originalUserPromptIndex=Wr>=0?Wr:void 0,Tr.retryCount=0}return[...Xe,Tr]}),sr(""));break;case"provider_fallback":console.log(" Provider fallback:",V);const Wt=` ${V.originalModel} hit rate limit, switching to ${V.fallbackModel} (attempt ${V.attempt})`;K(Xe=>[...Xe,{role:"system",content:Wt,timestamp:new Date().toISOString(),metadata:{type:"provider_fallback",originalModel:V.originalModel,fallbackModel:V.fallbackModel,fallbackProvider:V.fallbackProvider,reason:V.reason,attempt:V.attempt,phase:V.phase,iteration:V.iteration}}]);break;case"complete":if(console.log("Stream complete:",V),_r){const Xe=$r.current;if(Xe&&Xe.trim()){Kr.current&&(console.log(" Stopping early TTS and restarting with full response (first 3 sentences)"),z());const _e=i_(Xe,3);console.log(` Speaking first 3 sentences (${_e.length} chars of ${Xe.length} total)`),Z(_e,{onStart:()=>{console.log(" TTS started speaking first 3 sentences")},onEnd:()=>{console.log(" TTS finished - ContinuousVoiceMode should auto-restart microphone")},onError:Ve=>{console.error(" TTS error:",Ve),k("TTS playback failed")}}).catch(Ve=>{console.error(" Failed to start TTS:",Ve),k("Failed to speak response")})}else console.warn(" No response text available for TTS (ref content empty)")}V.extractedContent&&(console.log(" Attaching extractedContent from complete event:",{hasAllImages:!!V.extractedContent.allImages,allImagesCount:V.extractedContent.allImages?.length||0,hasImages:!!V.extractedContent.images,imagesCount:V.extractedContent.images?.length||0}),K(Xe=>{const _e=[...Xe];for(let Ve=_e.length-1;Ve>=0;Ve--)if(_e[Ve].role==="assistant"){_e[Ve]={..._e[Ve],extractedContent:V.extractedContent},console.log(` Attached extractedContent to assistant message at index ${Ve}`);break}return _e})),V.cost&&typeof V.cost=="number"&&(B(V.cost),kr(V.cost),console.log(` Request cost: $${V.cost.toFixed(4)}`)),se(!1),console.log(" Stream complete - cleared loading state");break;case"error":const Et=V.error;if(V.type==="input_moderation_error"){console.warn(" Input moderation error:",V.reason);const _e={role:"assistant",content:` **Content Moderation Alert**

${Et}

**Reason**: ${V.reason}

**Violations**: ${V.violations?.join(", ")||"Unknown"}`,llmApiCalls:V.llmApiCalls||[]};if(K(Ve=>[...Ve,_e]),V.suggestedRevision){Ae(V.suggestedRevision);const Ve={role:"assistant",content:` **Suggested Revision**

We've updated your message to comply with content policies. You can edit and send it again.`};K(Xt=>[...Xt,Ve])}else Ae("");break}if(V.type==="output_moderation_error"){console.warn(" Output moderation error:",V.reason);const Xe=` **Content Moderation Alert**

The generated response was flagged by our content moderation system and cannot be displayed.

**Reason**: ${V.reason}

Please try rephrasing your question.`;K(_e=>{const Ve=[..._e];for(let Xt=Ve.length-1;Xt>=0;Xt--)if(Ve[Xt].role==="assistant"){Ve[Xt]={...Ve[Xt],content:Xe,guardrailFailed:!0,guardrailReason:V.reason,guardrailViolations:V.violations,llmApiCalls:V.llmApiCalls||Ve[Xt].llmApiCalls||[],isStreaming:!1},console.log(` Replaced assistant message content at index ${Xt} with guardrail error`);break}return Ve});break}if(V.type==="guardrail_configuration_error"||V.type==="guardrail_system_error"){console.error(" Guardrail system error:",V.error);const _e={role:"assistant",content:` **System Error**

${Et}

The content moderation system is experiencing issues. Please contact support if this persists.`};K(Ve=>[...Ve,_e]),k(Et);break}k(Et),(Et.includes("Authentication")||Et.includes("UNAUTHORIZED")||V.code==="UNAUTHORIZED")&&(console.warn(" Authentication error detected, logging out..."),_(s("chat.sessionExpired"))),V.code==="MAX_ITERATIONS"&&V.showContinueButton&&V.continueContext&&(console.log(" Continue button enabled for MAX_ITERATIONS error:",Et),cs(!0),To(V.continueContext));const nr={role:"assistant",content:` Error: ${Et}`,errorData:V,isRetryable:!0,originalErrorMessage:Et,originalUserPromptIndex:tt,retryCount:0};K(Xe=>[...Xe,nr]);break;case"llm_request":console.log(" LLM API Request:",V),K(Xe=>{const _e=[...Xe],Xt=_e[_e.length-1]?.role==="tool";let At=!1;if(!Xt){for(let St=_e.length-1;St>=0;St--)if(_e[St].role==="assistant"){const Tr=ea(_e[St].content);_e[St].isStreaming||!_e[St].content||Tr.trim().length===0?(console.log(" Attaching llmApiCalls to active assistant at index:",St,"phase:",V.phase,"provider:",V.provider,"model:",V.model),_e[St]={..._e[St],llmApiCalls:[..._e[St].llmApiCalls||[],{phase:V.phase,provider:V.provider||"Unknown",model:V.model||"Unknown",request:V.request,timestamp:V.timestamp}]},At=!0):console.log(" Skipping completed assistant at index:",St,"(from previous query)");break}}return At||(console.log(" Creating new placeholder for llm_request, reason:",Xt?"tools executed":"no active assistant","provider:",V.provider,"model:",V.model),_e.push({role:"assistant",content:"",isStreaming:!0,llmApiCalls:[{phase:V.phase,provider:V.provider||"Unknown",model:V.model||"Unknown",request:V.request,timestamp:V.timestamp}]})),_e});break;case"llm_response":console.log(" LLM API Response:",V),K(Xe=>{const _e=[...Xe];for(let Ve=_e.length-1;Ve>=0;Ve--)if(_e[Ve].role==="assistant"&&_e[Ve].llmApiCalls){const Xt=_e[Ve].llmApiCalls,At=Xt[Xt.length-1];At&&At.phase===V.phase&&!At.response&&(At.response=V.response,At.httpHeaders=V.httpHeaders,At.httpStatus=V.httpStatus,V.provider&&(At.provider=V.provider),V.model&&(At.model=V.model),console.log(" Updated llmApiCall response for phase:",V.phase,"provider:",At.provider,"model:",At.model),_e[Ve]={..._e[Ve],llmApiCalls:[...Xt]});break}return _e});break;case"todos_updated":console.log(" Todos updated:",V),gi({total:V.total??0,remaining:V.remaining??0,current:V.current??null,items:Array.isArray(V.items)?V.items:[]});break;case"todos_current":console.log(" Todos current update:",V),gi(Xe=>({total:V.total??Xe?.total??0,remaining:V.remaining??Xe?.remaining??0,current:V.current??Xe?.current??null,items:Xe?.items??[]}));break;case"todos_resubmitting":console.log(" Todos resubmitting:",V),Hs(V?.next||V?.state?.current?.description||null),setTimeout(()=>Hs(null),2e3);break;case"todos_limit_reached":console.log(" Todos limit reached:",V),_(V.message||"Todo auto-progression limit reached. Please continue manually.");break;case"snippet_inserted":console.log(" Snippet inserted:",V),window.dispatchEvent(new CustomEvent("snippet_inserted",{detail:V})),P(s("chat.snippetSaved",{title:V.title})),V.id&&(console.log(" Triggering snippet sync from Google Sheets for ID:",V.id),setTimeout(async()=>{try{await w(V.id)}catch(Xe){console.error(" Failed to sync snippet:",Xe)}},500));break;case"snippet_deleted":console.log(" Snippet deleted:",V),window.dispatchEvent(new CustomEvent("snippet_deleted",{detail:V})),P(s("chat.snippetDeleted",{title:V.title}));break;case"snippet_updated":console.log(" Snippet updated:",V),window.dispatchEvent(new CustomEvent("snippet_updated",{detail:V})),P(`Updated snippet: ${V.title}`);break;case"token_refreshed":console.log(" Google OAuth token refreshed"),V.accessToken&&(localStorage.setItem("google_access_token",V.accessToken),console.log(" Updated google_access_token in localStorage"));break}},()=>{Ct&&clearTimeout(Ct),se(!1),ur([]),sr(""),Ja(null),Nn.current=null},Le=>{Ct&&clearTimeout(Ct),console.error("Streaming error:",Le),Le.name==="AbortError"||Le.message?.includes("aborted")||Le.message?.includes("BodyStreamBuffer")?T("Request cancelled","info"):k(`Streaming error: ${Le.message}`),se(!1),ur([]),Nn.current=null},Nn.current.signal,Be,Fe)}catch(Oe){if(console.error("Chat error:",Oe),Ct&&clearTimeout(Ct),Oe instanceof Error&&Oe.name==="AbortError"){const gt={role:"assistant",content:" Request timed out after 4 minutes. This may happen when tools take too long to execute. Try simplifying your request or disabling some tools.",isRetryable:!0,originalErrorMessage:"Request timed out",originalUserPromptIndex:tt,retryCount:0};K(It=>[...It,gt]),_("Request timed out after 4 minutes. Try disabling some tools or simplifying your request.")}else{const gt=Oe instanceof Error?Oe.message:"Unknown error",It={role:"assistant",content:` Error: ${gt}`,errorData:Oe instanceof Error?{...Oe,message:Oe.message,name:Oe.name,stack:Oe.stack}:{message:String(Oe)},isRetryable:!0,originalErrorMessage:gt,originalUserPromptIndex:tt,retryCount:0};K(Ke=>[...Ke,It]),k(`Chat error: ${gt}`)}se(!1),ur([]),Nn.current=null}},Di=async Y=>{const oe=I[Y];if(!oe||!oe.isRetryable){k("This message cannot be retried");return}const Ge=oe.retryCount||0;if(Ge>=3){k("Maximum retry attempts (3) reached");return}const yt=oe.originalUserPromptIndex;if(yt===void 0||yt<0){k("Cannot find original user prompt for retry");return}const tt=I[yt];if(!tt||tt.role!=="user"){k("Invalid user prompt for retry");return}const ie=I.slice(yt+1,Y),dt=ie.filter(Ct=>Ct.role==="tool"),We=ie.filter(Ct=>Ct.role==="assistant"||Ct.role==="tool");if(console.log(" Retrying request:",{userPromptIndex:yt,messageIndex:Y,retryCount:Ge+1,previousToolResults:dt.length,intermediateMessages:We.length,failureReason:oe.originalErrorMessage}),P(`Retrying request (attempt ${Ge+2}) with full context...`),K(Ct=>Ct.slice(0,Y)),typeof tt.content=="string")Ae(tt.content);else if(Array.isArray(tt.content)){const Ct=tt.content.find(gt=>gt.type==="text");Ae(Ct?.text||"");const Oe=tt.content.filter(gt=>gt.type==="image_url");if(Oe.length>0){const gt=Oe.map((It,Ke)=>{const br=(It.image_url?.url||"").match(/^data:([^;]+);base64,(.+)$/);return br?{name:`restored_image_${Ke+1}.png`,type:br[1],base64:br[2]}:null}).filter(Boolean);gt.length>0&&(wr(gt),console.log(` Restored ${gt.length} image(s) for retry`))}}Bt.current=!0},zh=async Y=>{const oe=await $3(Y.id);oe&&oe.messages?(K(oe.messages),Vt(Y.id),localStorage.setItem("last_active_chat_id",Y.id),oe.systemPrompt&&Ne(oe.systemPrompt),oe.planningQuery&&ht(oe.planningQuery),oe.generatedSystemPrompt&&ct(oe.generatedSystemPrompt),oe.generatedUserQuery&&kt(oe.generatedUserQuery),oe.selectedSnippetIds&&Array.isArray(oe.selectedSnippetIds)?(es(new Set(oe.selectedSnippetIds)),console.log(` Restored ${oe.selectedSnippetIds.length} attached snippets`)):es(new Set),xe(!1),P(s("chat.loadChatSuccess"))):k(s("chat.failedToLoadChat"))},Yl=async Y=>{await U3(Y);const oe=await xw();Or(oe),P("Chat deleted")},Ql=async()=>{if(ze.size===0)return;const Y=ze.size;for(const Ge of ze)await U3(Ge);const oe=await xw();Or(oe),nt(new Set),P(`${Y} chat${Y>1?"s":""} deleted`)},Zu=()=>{const Y=new Set(Hr.map(oe=>oe.id));nt(Y)},Vc=()=>{nt(new Set)},ed=Y=>{const oe=new Set(ze);oe.has(Y)?oe.delete(Y):oe.add(Y),nt(oe)},ro=async()=>{await wbe(),Or([]),nt(new Set),de(!1),xe(!1),P(s("chat.allChatHistoryCleared"))},td=async()=>{if(!An){k("No continuation context available");return}console.log(" Continuing from error/limit with context:",An),cs(!1),F();const Y=[];e.web_search&&Y.push({type:"function",function:{name:"web_search",description:"Search the web for information",parameters:{type:"object",properties:{query:{type:"string",description:"Search query"}},required:["query"]}}}),e.execute_js&&Y.push({type:"function",function:{name:"execute_js",description:"Execute JavaScript code",parameters:{type:"object",properties:{code:{type:"string",description:"JavaScript code to execute"}},required:["code"]}}}),e.scrape_url&&Y.push({type:"function",function:{name:"scrape_web_content",description:"Scrape content from a URL",parameters:{type:"object",properties:{url:{type:"string",description:"URL to scrape"}},required:["url"]}}});const Ge={providers:D?.providers.filter(tt=>tt.enabled===!0)||[],messages:An.messages,temperature:.7,stream:!0,isContinuation:!0,optimization:D?.optimization||"cheap",language:D?.language||"en",imageQuality:D?.imageQuality||"low"};console.log(` Continuation request with optimization: ${Ge.optimization}`),console.log(` Response language: ${Ge.language}`),console.log(` Image quality: ${Ge.imageQuality}`),W&&(Ge.location={latitude:W.latitude,longitude:W.longitude,accuracy:W.accuracy,address:W.address,timestamp:W.timestamp},console.log(" Including location in continuation request:",W.address?.city||`${W.latitude.toFixed(4)}, ${W.longitude.toFixed(4)}`)),Y.length>0&&(Ge.tools=Y),An.extractedContent&&(Ge.extractedContent=An.extractedContent);const yt=fr.filter(tt=>tt.enabled);if(yt.length>0&&(Ge.mcp_servers=yt.map(tt=>({name:tt.name,url:tt.url}))),se(!0),!i){k("Please sign in to continue"),cs(!0),se(!1);return}try{await Bw(Ge,i,(tt,ie)=>{switch(console.log("SSE Event (continuation):",tt,ie),tt){case"delta":ie.content&&(sr(dt=>dt+ie.content),K(dt=>{const We=dt.length-1,Ct=dt[We],Oe=Ct?.role==="tool";if(Ct&&Ct.role==="assistant"&&!Oe){const gt=[...dt];return gt[We]={...Ct,content:(Ct.content||"")+ie.content,isStreaming:!0},gt}else{const gt={role:"assistant",content:ie.content,isStreaming:!0};return[...dt,gt]}}));break;case"error":{const dt=ie.error;k(dt),Zn(`Error: ${dt.substring(0,100)}`),ie.showContinueButton&&ie.continueContext&&(cs(!0),To(ie.continueContext));const We={role:"assistant",content:` Error: ${dt}`,errorData:ie,isRetryable:!0,originalErrorMessage:dt,retryCount:0};K(Ct=>[...Ct,We]);break}case"complete":console.log("Continuation complete:",ie),ie.cost&&typeof ie.cost=="number"&&B(ie.cost);break;case"todos_updated":console.log(" Todos updated:",ie),gi({total:ie.total??0,remaining:ie.remaining??0,current:ie.current??null,items:Array.isArray(ie.items)?ie.items:[]});break;case"todos_current":console.log(" Todos current update:",ie),gi(dt=>({total:ie.total??dt?.total??0,remaining:ie.remaining??dt?.remaining??0,current:ie.current??dt?.current??null,items:dt?.items??[]}));break;case"todos_resubmitting":console.log(" Todos resubmitting:",ie),Hs(ie?.next||ie?.state?.current?.description||null),setTimeout(()=>Hs(null),2e3);break;case"todos_limit_reached":console.log(" Todos limit reached:",ie),_(ie.message||"Todo auto-progression limit reached. Please continue manually.");break;default:console.log("Unhandled event in continuation:",tt,ie)}},void 0,void 0,Nn.current?.signal)}catch(tt){console.error("Error during continuation:",tt),k(tt instanceof Error?tt.message:"Failed to continue"),cs(!0)}finally{se(!1)}},rd=()=>{K([]),Ae(""),Ne(""),ht(""),ct(""),kt(""),es(new Set),g(),pn(new Set),Vt(null),localStorage.removeItem("last_active_chat_id"),setTimeout(()=>{Pr.current?.focus()},0),console.log("Started new chat - all prompts cleared")},nd=async()=>{if(I.length!==0)try{P("Generating quiz from conversation...");const Y=I.filter(We=>We.role==="assistant"&&We.content).map(We=>ea(We.content)).join(`

---

`);if(!Y.trim()){k("No assistant responses to generate quiz from");return}const oe=await c();if(!oe){k("Authentication required");return}const{generateFeedQuiz:Ge}=await Zt(async()=>{const{generateFeedQuiz:We}=await Promise.resolve().then(()=>fq);return{generateFeedQuiz:We}},void 0),yt={id:`chat-quiz-${Date.now()}`,title:"Chat Conversation",content:Y,expandedContent:Y,topics:["chat"],sources:[],timestamp:Date.now()},tt=await Ge(oe,yt),{quizDB:ie}=await Zt(async()=>{const{quizDB:We}=await Promise.resolve().then(()=>fU);return{quizDB:We}},void 0),dt=await ie.saveGeneratedQuiz(tt.title,[yt.id],tt.questions.length,!1,tt,void 0,void 0);if(!dt){_("Quiz already exists");return}console.log(" Quiz generated and saved with ID:",dt),P("Quiz generated! Opening..."),xr(tt)}catch(Y){console.error("Failed to generate quiz:",Y),k("Failed to generate quiz from conversation")}},Kl=()=>{if(I.length!==0)try{const Y=I.filter(yt=>yt.role==="assistant"&&yt.content).map(yt=>ea(yt.content)).join(" ");if(!Y.trim()){k("No assistant responses to generate feed from");return}const Ge={searchTerms:[Y.substring(0,300).trim()],clearExisting:!0,fromChat:tr||"current"};localStorage.setItem("feed_generation_request",JSON.stringify(Ge)),O("/feed"),P("Generating feed from conversation...")}catch(Y){console.error("Failed to generate feed from chat:",Y),k("Failed to generate feed from conversation")}},Wc=()=>{!st.name.trim()||!st.url.trim()||(qe([...fr,{id:`mcp_${Date.now()}`,name:st.name,url:st.url,enabled:!0}]),Gt({name:"",url:""}))},No=Y=>{qe(fr.map(oe=>oe.id===Y?{...oe,enabled:!oe.enabled}:oe))},ll=Y=>{qe(fr.filter(oe=>oe.id!==Y))};return u.jsxs("div",{className:"flex flex-col h-full relative",onDragEnter:Xu,onDragOver:Ju,onDragLeave:Vl,onDrop:Uc,children:[u.jsx(cbe,{isDragging:xn}),u.jsx(ibe,{systemPrompt:fe,setSystemPrompt:Ne}),u.jsx(obe,{systemPrompt:fe,selectedSnippetIds:Ya,showSnippetsPanel:Eo,messageCount:I.length,onNewChat:rd,onShowLoadDialog:()=>xe(!0),onToggleSnippetsPanel:()=>mi(!Eo),onShowExamplesModal:()=>Ca(!0),onShowShareDialog:()=>qn(!0),onGenerateQuiz:nd,onGenerateFeed:Kl}),u.jsxs("div",{ref:ha,className:"flex-1 overflow-y-auto px-0 md:px-4 py-4 space-y-4","aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text",children:[u.jsx("div",{className:"sr-only",role:"status","aria-live":"polite","aria-atomic":"true",children:Zi}),I.length===0&&u.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 mt-8",children:"No messages yet. Start a conversation!"}),(console.log(" RENDER: messages array:",I.map((Y,oe)=>({idx:oe,role:Y.role,hasImageGenerations:!!Y.imageGenerations,imageGenerationsLength:Y.imageGenerations?.length,actualImageGenerations:Y.imageGenerations}))),null),I.map((Y,oe)=>{const Ge=vt.has(oe),yt=Y.content?ea(Y.content):"";console.log(`Rendering message ${oe}:`,Y.role,yt.substring(0,50)),console.log(` Message ${oe} imageGenerations:`,Y.imageGenerations),Y.role==="assistant"&&Y.tool_calls&&console.log(`  Message ${oe} has ${Y.tool_calls.length} tool_calls:`,Y.tool_calls.map(ie=>({id:ie.id,name:ie.function?.name})));const tt=Y.role==="assistant"&&Y.tool_calls?.some(ie=>{if(ie.function.name!=="transcribe_url")return!1;const dt=Dn.get(ie.id);if(!dt||dt.length===0)return!1;const We=dt[dt.length-1],Ct=We.progress_type||We.data?.type||"";return!(Ct==="transcribe_complete"||Ct==="transcription_stopped"||Ct==="error")});return Y.role==="assistant"&&!Y.content&&!tt&&!Y.tool_calls&&!Y.isStreaming?null:u.jsx("div",{className:`flex gap-2 ${Y.role==="user"?"flex-row-reverse":(Y.role==="tool","")}`,children:u.jsxs("div",{className:`rounded-lg p-3 ${Y.role==="user"?"max-w-[80%] bg-blue-500 text-white":Y.role==="tool"?"max-w-[80%] bg-purple-100 dark:bg-purple-900/30 border border-purple-300 dark:border-purple-700":Y.content&&ea(Y.content).startsWith(" Error:")?"max-w-[80%] bg-pink-100 dark:bg-pink-900/30 border-2 border-pink-400 dark:border-pink-600 text-gray-900 dark:text-gray-100":"w-full bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 border border-white dark:border-gray-600"}`,children:[Y.role==="tool"&&(()=>{let ie=null;console.log(" Searching for tool_call_id:",Y.tool_call_id,"in",I.length,"messages");for(let Oe=oe-1;Oe>=0;Oe--)if(I[Oe].tool_calls&&(console.log("  Found message at index",Oe,"with",I[Oe].tool_calls?.length,"tool_calls"),ie=I[Oe].tool_calls?.find(gt=>gt.id===Y.tool_call_id),ie)){console.log(" Found tool call for",Y.name,":",ie);break}ie||console.log(" No tool call found for",Y.tool_call_id);let dt=null;if(Y.name==="search_web"&&typeof Y.content=="string")try{const Oe=JSON.parse(Y.content);Oe.results&&Array.isArray(Oe.results)&&(dt=Oe.results)}catch{}let We=null;if(Y.name==="scrape_web_content"&&typeof Y.content=="string")try{const Oe=JSON.parse(Y.content);(Oe.url||Oe.content||Oe.error)&&(We=Oe)}catch{}let Ct=null;if(Y.name==="execute_javascript"&&typeof Y.content=="string")try{const Oe=JSON.parse(Y.content);(Oe.result!==void 0||Oe.error)&&(Ct=Oe)}catch{}return u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 flex items-center gap-2",children:[u.jsxs("span",{children:[" ",Y.name||"Tool Result"]}),ie&&(Y.name==="search_web"||Y.name==="search_youtube")&&(()=>{try{const Oe=JSON.parse(ie.function.arguments);if(Oe.query)return u.jsxs("span",{className:"font-normal text-purple-600 dark:text-purple-400 italic",children:['- "',Oe.query,'"']})}catch{}return null})()]}),u.jsx("button",{onClick:()=>{const Oe=new Set(vt);Ge?Oe.delete(oe):Oe.add(oe),pn(Oe)},className:"text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-200",title:Ge?"Collapse":"Expand",children:Ge?"":""})]}),Ge&&u.jsxs("div",{className:"text-xs space-y-2",children:[ie&&u.jsx("div",{className:"mb-3 bg-purple-50 dark:bg-purple-950/50 p-3 rounded border border-purple-200 dark:border-purple-800",children:ie.function.name==="search_web"?u.jsxs(u.Fragment,{children:[ie.function.arguments&&(()=>{try{const Oe=JSON.parse(ie.function.arguments);if(Oe.query)return u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-1",children:" Search Query:"}),u.jsxs("div",{className:"text-purple-900 dark:text-purple-100 italic",children:['"',Oe.query,'"']})]})}catch(Oe){console.error("Error parsing search arguments:",Oe)}return null})(),(()=>{try{if(!Y.content)return null;const gt=(typeof Y.content=="string"?JSON.parse(Y.content):Y.content)?.searchService;if(gt&&typeof gt=="string"&&gt!=="unknown"&&gt!=="none"){const Ke={brave:{emoji:"",name:"Brave Search",color:"orange"},tavily:{emoji:"",name:"Tavily API",color:"blue"},duckduckgo:{emoji:"",name:"DuckDuckGo",color:"green"},wikipedia:{emoji:"",name:"Wikipedia",color:"gray"}}[gt]||{emoji:"",name:gt,color:"purple"},Rt={orange:"bg-orange-100 dark:bg-orange-900/30 text-orange-800 dark:text-orange-200 border border-orange-300 dark:border-orange-700",blue:"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-200 border border-blue-300 dark:border-blue-700",green:"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200 border border-green-300 dark:border-green-700",gray:"bg-gray-100 dark:bg-gray-900/30 text-gray-800 dark:text-gray-200 border border-gray-300 dark:border-gray-700",purple:"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-200 border border-purple-300 dark:border-purple-700"};return u.jsxs("div",{className:"mt-2 pt-2 border-t border-purple-200 dark:border-purple-700",children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-1",children:s("chat.searchProvider")}),u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded text-xs font-medium ${Rt[Ke.color]}`,children:[Ke.emoji," ",Ke.name]})]})}}catch(Oe){console.error("Error parsing search provider:",Oe)}return null})()]}):u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-2",children:s("chat.functionCall")}),u.jsx("div",{className:"font-mono text-xs mb-2",children:u.jsx("span",{className:"text-purple-900 dark:text-purple-100",children:ie.function.name})}),ie.function.arguments&&(()=>{try{const Oe=JSON.parse(ie.function.arguments);return Oe.code?u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-1",children:s("chat.code")}),u.jsx("div",{className:"bg-gray-900 text-green-400 p-3 rounded font-mono text-xs overflow-x-auto max-h-64 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap leading-relaxed",children:Oe.code})})]}):u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-1",children:s("chat.arguments")}),u.jsx("div",{className:"bg-gray-900 dark:bg-gray-950 p-3 rounded font-mono text-xs overflow-x-auto max-h-96 overflow-y-auto",children:u.jsx(Qg,{data:Oe,expandAll:!0})})]})}catch(Oe){console.error("Error parsing tool arguments:",Oe)}return null})()]})}),Y.tool_call_id&&Y.name!=="search_web"&&u.jsxs("div",{children:[u.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-300",children:s("chat.callId")}),u.jsx("div",{className:"font-mono text-xs bg-purple-50 dark:bg-purple-950 p-1 rounded mt-1 break-all",children:Y.tool_call_id})]}),u.jsxs("div",{children:[u.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-300",children:s("chat.result")}),u.jsxs("div",{className:"bg-purple-50 dark:bg-purple-950 p-2 rounded mt-1 max-h-96 overflow-y-auto",children:[dt?u.jsx(abe,{results:dt}):We?u.jsxs("div",{className:"space-y-2",children:[We.url&&u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("span",{className:"font-semibold text-purple-800 dark:text-purple-200",children:s("chat.url")}),u.jsx("a",{href:We.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-xs break-all block mt-1",children:We.url})]}),We.rawHtml&&u.jsx("button",{onClick:()=>Tt({url:We.url,html:We.rawHtml}),className:"flex-shrink-0 px-3 py-1.5 text-xs bg-gray-600 hover:bg-gray-700 text-white rounded transition-colors font-medium",title:s("chat.viewRawHtml"),children:" Raw HTML"})]}),We.error&&u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded p-2",children:[u.jsx("span",{className:"font-semibold text-red-800 dark:text-red-200",children:s("chat.error")}),u.jsx("p",{className:"text-red-700 dark:text-red-300 text-xs mt-1",children:We.error})]}),We.content&&u.jsxs("div",{children:[u.jsxs("span",{className:"font-semibold text-purple-800 dark:text-purple-200",children:[" Page Content (",We.content.length.toLocaleString()," characters)",We.format&&u.jsxs("span",{className:"ml-2 text-xs text-purple-600 dark:text-purple-400",children:["[",We.format,"]"]})]}),u.jsx("div",{className:"mt-2 p-3 bg-white dark:bg-gray-900 rounded border border-purple-200 dark:border-purple-800 max-h-80 overflow-y-auto",children:We.format==="markdown"?u.jsx("div",{className:"text-xs",children:u.jsx(k0,{content:We.content})}):u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-700 dark:text-gray-300 leading-relaxed",children:We.content})})]}),(We.images||We.allImages||We.youtube||We.media||We.links)&&u.jsxs("div",{className:"mt-4 pt-4 border-t border-purple-200 dark:border-purple-700",children:[u.jsx("div",{className:"text-sm font-semibold text-purple-800 dark:text-purple-200 mb-3",children:" Extracted Content"}),u.jsxs("div",{className:"space-y-3",children:[We.images&&We.images.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[" Prioritized Images (sent to LLM): ",We.images.length]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:We.images.map((Oe,gt)=>u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded p-2",children:[u.jsx("img",{src:Oe.src,alt:Oe.alt||`Image ${gt+1}`,className:"w-full h-24 object-cover rounded mb-1",loading:"lazy"}),Oe.alt&&u.jsx("p",{className:"text-[10px] text-gray-600 dark:text-gray-400 truncate",children:Oe.alt})]},gt))})]}),We.allImages&&We.allImages.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[" All Images: ",We.allImages.length]}),u.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-2",children:We.allImages.slice(0,24).map((Oe,gt)=>u.jsx("div",{className:"border border-gray-200 dark:border-gray-700 rounded p-1",children:u.jsx("img",{src:Oe.src,alt:Oe.alt||`Image ${gt+1}`,className:"w-full h-16 object-cover rounded",loading:"lazy"})},gt))}),We.allImages.length>24&&u.jsxs("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:["...and ",We.allImages.length-24," more"]})]}),We.youtube&&We.youtube.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[" YouTube Videos: ",We.youtube.length]}),u.jsx("div",{className:"space-y-1",children:We.youtube.map((Oe,gt)=>u.jsx("a",{href:Oe.url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-600 dark:text-blue-400 hover:underline truncate",children:Oe.text||Oe.url},gt))})]}),We.media&&We.media.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[" Media (Audio/Video): ",We.media.length]}),u.jsx("div",{className:"space-y-1",children:We.media.map((Oe,gt)=>u.jsx("a",{href:Oe.url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-600 dark:text-blue-400 hover:underline truncate",children:Oe.text||Oe.url},gt))})]}),We.links&&We.links.length>0&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[" Links: ",We.links.length]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-1",children:We.links.slice(0,20).map((Oe,gt)=>u.jsx("a",{href:Oe.url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs text-blue-600 dark:text-blue-400 hover:underline truncate",children:Oe.text||Oe.url},gt))}),We.links.length>20&&u.jsxs("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 mt-1",children:["...and ",We.links.length-20," more links"]})]})]})]})]}):Ct?u.jsxs("div",{className:"space-y-3",children:[Ct.error&&u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded p-2",children:[u.jsx("span",{className:"font-semibold text-red-800 dark:text-red-200",children:" Error:"}),u.jsx("p",{className:"text-red-700 dark:text-red-300 text-xs mt-1 font-mono",children:Ct.error})]}),Ct.result!==void 0&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[u.jsx("span",{className:"font-semibold text-purple-800 dark:text-purple-200",children:" Output:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(String(Ct.result)),P(s("chat.outputCopied"))},className:"text-xs px-2 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors",title:s("chat.copyOutputToClipboard"),children:"Copy"}),u.jsx("button",{onClick:()=>{to(String(Ct.result),"tool","JavaScript Output")},className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded transition-colors",title:s("chat.captureOutputToSwag"),children:"Grab"})]})]}),ie?.executedAt&&u.jsxs("span",{className:"text-xs text-gray-600 dark:text-gray-400 block mb-2",children:["(",ie.runtime||"N/A",")"]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-950 p-3 rounded border border-green-300 dark:border-green-700",children:u.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-900 dark:text-gray-100 font-mono leading-relaxed",children:String(Ct.result)})})]})]}):Y.name==="generate_chart"?(()=>{let Oe=null;for(let gt=oe-1;gt>=0&&!(I[gt].role==="assistant"&&I[gt].content&&(Oe=sl(I[gt].content),Oe));gt--);return u.jsx(F3,{content:Y.content,chartCode:Oe||void 0})})():u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-800 dark:text-gray-200",children:ea(Y.content)}),u.jsx(j3,{rawResponse:Y.rawResponse,extractionMetadata:Y.extractionMetadata}),Y.content&&u.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-purple-200 dark:border-purple-700",children:[u.jsxs("button",{onClick:()=>to(ea(Y.content),"tool",Y.name),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-100 flex items-center gap-1",title:"Capture to Swag",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),"Grab"]}),Y.name==="search_web"&&u.jsx("button",{onClick:()=>Y.llmApiCalls&&Y.llmApiCalls.length>0?Lr(oe):null,className:`text-xs px-1.5 py-0.5 rounded flex items-center gap-1 transition-colors ${Y.llmApiCalls&&Y.llmApiCalls.length>0?"bg-purple-50 dark:bg-purple-900/30 hover:bg-purple-100 dark:hover:bg-purple-900/50 cursor-pointer":"text-gray-500 dark:text-gray-500 cursor-default"}`,title:Y.llmApiCalls&&Y.llmApiCalls.length>0?`View LLM summarization info  ${us(Vs(Y))}`:"No LLM summarization used",children:Y.llmApiCalls&&Y.llmApiCalls.length>0?u.jsxs(u.Fragment,{children:[u.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:[" ",us(Vs(Y))]}),u.jsx("span",{className:"ml-0.5",children:""})]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"text-[10px]",children:s("chat.noSummarization")})]})}),Y.name!=="search_web"&&Y.llmApiCalls&&Y.llmApiCalls.length>0&&u.jsxs("button",{onClick:()=>Lr(oe),className:"text-xs px-1.5 py-0.5 rounded bg-purple-50 dark:bg-purple-900/30 hover:bg-purple-100 dark:hover:bg-purple-900/50 flex items-center gap-1 transition-colors",title:`View LLM transparency info  ${us(Vs(Y))}`,children:[u.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:[" ",us(Vs(Y))]}),u.jsx("span",{className:"ml-0.5",children:""})]})]})]})]})]})]})})(),Y.role!=="tool"&&u.jsxs(u.Fragment,{children:[Y.role==="assistant"?u.jsxs("div",{children:[oe===I.length-1&&an.size>0&&u.jsx("div",{className:"mb-3 space-y-2",children:Array.from(an.values()).map((ie,dt)=>u.jsx(cye,{data:ie},dt))}),oe===I.length-1&&ca.size>0&&u.jsx("div",{className:"mb-3 space-y-2",children:Array.from(ca.values()).map((ie,dt)=>u.jsx(uye,{data:ie},dt))}),oe===I.length-1&&Pi.size>0&&u.jsx("div",{className:"mb-3 space-y-2",children:Array.from(Pi.values()).map((ie,dt)=>u.jsx(dye,{data:ie},dt))}),oe===I.length-1&&De.size>0&&u.jsx("div",{className:"mb-3 space-y-2",children:Array.from(De.values()).map((ie,dt)=>u.jsx(hye,{data:ie},dt))}),oe===I.length-1&&Mt.size>0&&u.jsx("div",{className:"mb-3 space-y-2",children:Array.from(Mt.values()).map((ie,dt)=>u.jsx(pye,{data:ie},dt))}),Y.tool_calls&&Y.tool_calls.map((ie,dt)=>{if(ie.function.name==="transcribe_url"&&Dn.has(ie.id)){console.log(`    Rendering TranscriptionProgress for tool_call ${dt}: ${ie.id}`);const We=Dn.get(ie.id);if(!We||We.length===0)return console.log(`      No events for ${ie.id}, skipping`),null;const Ct=We[We.length-1],Oe=Ct.progress_type||Ct.data?.type||"",gt=Oe==="transcribe_complete"||Oe==="transcription_stopped"||Oe==="error";if(console.log(`      Last event type: ${Oe}, isComplete: ${gt}`),gt)return console.log("      Transcription complete, skipping progress render"),null;console.log(`       Rendering progress component for ${ie.id}`);const It=JSON.parse(ie.function.arguments||"{}");return u.jsx("div",{className:"mb-3",children:u.jsx(oye,{toolCallId:ie.id,url:It.url||"",events:We||[],onStop:ol})},ie.id)}if(ie.function.name==="scrape_web_content"&&Za.has(ie.id)){console.log(`    Rendering ScrapingProgress for tool_call ${dt}: ${ie.id}`);const We=Za.get(ie.id);if(!We||We.length===0)return console.log(`      No events for ${ie.id}, skipping`),null;const Ct=We[We.length-1],Oe=Ct.progress_type||Ct.data?.type||"",gt=Oe==="scrape_complete"||Oe==="scrape_error";if(console.log(`      Last event type: ${Oe}, isComplete: ${gt}`),gt)return console.log("      Scraping complete, skipping progress render"),null;console.log(`       Rendering scraping progress component for ${ie.id}`);const It=JSON.parse(ie.function.arguments||"{}");return u.jsx("div",{className:"mb-3",children:u.jsx(lye,{toolCallId:ie.id,url:It.url||"",events:We||[]})},ie.id)}return null}),Y.tool_calls&&Y.tool_calls.length>0&&!Y.toolResults&&u.jsx("div",{className:"mb-3 space-y-2",children:Y.tool_calls.map((ie,dt)=>{let We={},Ct=null;try{We=JSON.parse(ie.function.arguments||"{}")}catch(Oe){Ct=`Invalid JSON: ${ie.function.arguments}`,console.error(`Failed to parse tool call arguments for ${ie.id}:`,Oe)}return u.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-300 dark:border-blue-700 rounded-lg p-3",children:[u.jsxs("div",{className:"text-xs font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-2 mb-2",children:[u.jsxs("span",{children:[" ",ie.function.name]}),Ct&&u.jsx("span",{className:"text-red-600 dark:text-red-400 font-normal",children:" Malformed arguments"})]}),u.jsx("div",{className:"text-xs text-gray-700 dark:text-gray-300 space-y-1",children:Ct?u.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700 rounded p-2 font-mono text-[10px]",children:Ct}):Object.entries(We).map(([Oe,gt])=>u.jsxs("div",{children:[u.jsxs("span",{className:"font-semibold",children:[Oe,":"]})," ",u.jsx("span",{className:"font-mono",children:typeof gt=="string"?gt:JSON.stringify(gt)})]},Oe))})]},dt)})}),Y.tool_calls&&!Y.toolResults&&!Y.isStreaming&&u.jsxs("div",{className:"mb-3 flex items-center gap-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[u.jsxs("div",{className:"flex gap-1",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse",style:{animationDelay:"300ms"}})]}),u.jsxs("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:[" Executing ",Y.tool_calls.length," tool",Y.tool_calls.length>1?"s":"","..."]})]}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("div",{className:"flex-1",children:Y.content&&(()=>{let ie;if(Y.toolResults){const dt=Y.toolResults.find(We=>We.name==="generate_chart");if(dt)try{const We=typeof dt.content=="string"?JSON.parse(dt.content):dt.content;ie=We.description||We.chart_type}catch{}}return u.jsx(B3,{text:ea(Y.content),renderAsMarkdown:!0,chartDescription:ie})})()}),Y.content&&!Y.isStreaming&&u.jsx(rbe,{text:ea(Y.content),variant:"icon"})]}),Y.isStreaming&&u.jsx("span",{className:"inline-block w-2 h-4 bg-gray-500 animate-pulse ml-1"}),(()=>{const ie=I[oe+1];if(ie&&ie.role==="tool"){const dt=[];if(Y.tool_calls&&Y.tool_calls.forEach(We=>{if(We.function?.name==="search_youtube"){const Ct=I.find((Oe,gt)=>gt>oe&&Oe.role==="tool"&&Oe.tool_call_id===We.id);if(Ct&&Ct.content)try{const Oe=typeof Ct.content=="string"?JSON.parse(Ct.content):Ct.content;Oe.videos&&Array.isArray(Oe.videos)&&dt.push(...Oe.videos)}catch(Oe){console.error("Failed to parse YouTube results:",Oe)}}}),dt.length>0)return u.jsx(nbe,{videos:dt})}return null})(),(()=>{if(!Y.extractedContent)return null;const ie=Y.extractedContent;return ie.prioritizedImages&&ie.prioritizedImages.length>0||ie.allLinks&&ie.allLinks.length>0||ie.allImages&&ie.allImages.length>0||ie.youtubeVideos&&ie.youtubeVideos.length>0||ie.otherVideos&&ie.otherVideos.length>0||ie.media&&ie.media.length>0?u.jsxs("div",{className:"mt-4 space-y-4",children:[ie.prioritizedImages&&ie.prioritizedImages.length>0&&u.jsx(vye,{images:ie.prioritizedImages.map(We=>We.src),maxDisplay:3,onImageClick:We=>window.open(We,"_blank"),onGrabImage:ql}),ie.allLinks&&ie.allLinks.length>0&&u.jsxs("details",{className:"border border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750",children:[" All Links (",ie.allLinks.length,")"]}),u.jsx("div",{className:"p-4 space-y-2",children:ie.allLinks.map((We,Ct)=>u.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-2 last:border-b-0",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-xs mt-0.5",children:[Ct+1,"."]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("a",{href:We.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline font-medium break-words",children:We.title}),We.snippet&&u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 italic",children:We.snippet})]})]})},Ct))})]}),ie.allImages&&ie.allImages.length>0&&u.jsxs("details",{className:"border border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750",children:[" All Images (",ie.allImages.length,")"]}),u.jsx("div",{className:"p-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:ie.allImages.map((We,Ct)=>u.jsxs("div",{className:"relative group",children:[u.jsx("img",{src:We.src,alt:We.alt||`Image ${Ct+1}`,className:"w-full h-32 object-cover rounded border border-gray-300 dark:border-gray-700 cursor-pointer hover:opacity-80",onClick:()=>window.open(We.src,"_blank"),loading:"lazy"}),u.jsx("button",{onClick:()=>ql(We.src,We.alt||`Image ${Ct+1}`),className:"absolute top-2 right-2 p-1.5 bg-white dark:bg-gray-800 rounded shadow-lg opacity-0 group-hover:opacity-100 transition-opacity",title:s("chat.grabImage"),children:u.jsx("svg",{className:"w-4 h-4 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]},Ct))})]}),ie.youtubeVideos&&ie.youtubeVideos.length>0&&u.jsxs("details",{className:"border border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750",children:[" YouTube Videos (",ie.youtubeVideos.length,")"]}),u.jsx("div",{className:"p-4 space-y-2",children:ie.youtubeVideos.map((We,Ct)=>u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-xs mt-0.5",children:[Ct+1,"."]}),u.jsx("a",{href:We.src,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:We.title})]},Ct))})]}),ie.otherVideos&&ie.otherVideos.length>0&&u.jsxs("details",{className:"border border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750",children:[" Other Videos (",ie.otherVideos.length,")"]}),u.jsx("div",{className:"p-4 space-y-2",children:ie.otherVideos.map((We,Ct)=>u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-xs mt-0.5",children:[Ct+1,"."]}),u.jsx("a",{href:We.src,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:We.title})]},Ct))})]}),ie.media&&ie.media.length>0&&u.jsxs("details",{className:"border border-gray-300 dark:border-gray-700 rounded-lg",children:[u.jsxs("summary",{className:"cursor-pointer font-semibold p-3 bg-gray-50 dark:bg-gray-800 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-750",children:[" Audio & Other Media (",ie.media.length,")"]}),u.jsx("div",{className:"p-4 space-y-2",children:ie.media.map((We,Ct)=>u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-xs mt-0.5",children:[Ct+1,"."]}),u.jsx("a",{href:We.src,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:We.type||"Media"})]},Ct))})]})]}):null})(),Y.toolResults&&Y.toolResults.length>0&&u.jsx("div",{className:"mt-4 space-y-3",children:Y.toolResults.filter(ie=>{if(ie.name==="generate_image")try{if(JSON.parse(ie.content).error)return!1}catch{}return!0}).map((ie,dt)=>{const We=vt.has(oe*1e3+dt);let Ct=null;if(ie.name==="search_web"&&typeof ie.content=="string")try{const Ke=JSON.parse(ie.content);Ke.results&&Array.isArray(Ke.results)&&(Ct=Ke.results)}catch{}let Oe=null;if(ie.name==="scrape_web_content"&&typeof ie.content=="string")try{const Ke=JSON.parse(ie.content);(Ke.content||Ke.url)&&(Oe=Ke)}catch{}let gt=null,It="";if(ie.name==="execute_javascript"&&typeof ie.content=="string")try{const Ke=JSON.parse(ie.content);if(Ke.result!==void 0||Ke.error){gt=Ke;const Rt=Y.tool_calls?.find(br=>br.id===ie.tool_call_id);if(Rt)try{It=JSON.parse(Rt.function.arguments).code||""}catch{}}}catch{}return u.jsxs("div",{className:"bg-purple-100 dark:bg-purple-900/30 border border-purple-300 dark:border-purple-700 rounded-lg p-3",children:[u.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 flex items-center gap-2",children:[u.jsxs("span",{children:[" ",ie.name||"Tool Result"]}),Y.tool_calls&&(ie.name==="search_web"||ie.name==="search_youtube")&&(()=>{const Ke=Y.tool_calls.find(Rt=>Rt.id===ie.tool_call_id);if(Ke)try{const Rt=JSON.parse(Ke.function.arguments);if(Rt.query)return u.jsxs("span",{className:"font-normal text-purple-600 dark:text-purple-400 italic",children:['- "',Rt.query,'"']})}catch{}return null})(),ie.name==="scrape_web_content"&&(()=>{try{const Ke=typeof ie.content=="string"?JSON.parse(ie.content):ie.content;if(Ke.url||Ke.scrapeService||Ke.proxyUsed!==void 0)return u.jsxs("span",{className:"font-normal text-purple-600 dark:text-purple-400 flex items-center gap-1",children:[Ke.url&&u.jsxs("a",{href:Ke.url,target:"_blank",rel:"noopener noreferrer",className:"hover:underline",children:["- ",new URL(Ke.url).hostname]}),Ke.scrapeService&&u.jsx("span",{className:"text-[10px] bg-purple-200 dark:bg-purple-800 px-1.5 py-0.5 rounded",children:Ke.scrapeService}),Ke.proxyUsed&&u.jsx("span",{className:"text-[10px] bg-green-200 dark:bg-green-800 text-green-700 dark:text-green-300 px-1.5 py-0.5 rounded",title:s("chat.usingProxy"),children:" proxy"})]})}catch{}return null})()]}),u.jsx("button",{onClick:()=>{const Ke=new Set(vt),Rt=oe*1e3+dt;We?Ke.delete(Rt):Ke.add(Rt),pn(Ke)},className:"text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-200",title:We?"Collapse":"Expand",children:We?"":""})]}),We&&u.jsxs("div",{className:"text-xs space-y-2",children:[rn.size>0&&Array.from(rn.values()).filter(()=>ie.name==="search_web"||ie.name==="scrape_web_content"||ie.name==="transcribe_url").map((Ke,Rt)=>u.jsx(gye,{data:Ke},Rt)),Ct&&Ct.length>0?u.jsx("div",{className:"space-y-3",children:Ct.map((Ke,Rt)=>{const br=oe*1e6+dt*1e3+Rt,v=vt.has(br),C=Ke.content||Ke.page_content,R=typeof Ke.content=="string"?Ke.content:typeof Ke.page_content=="string"?Ke.page_content:JSON.stringify(Ke.page_content||Ke.content,null,2);return u.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded border border-purple-200 dark:border-purple-800 overflow-hidden",children:[u.jsxs("div",{className:"p-3",children:[u.jsxs("div",{className:"flex items-start justify-between gap-2",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("a",{href:Ke.url,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-purple-700 dark:text-purple-300 hover:underline block mb-1",children:Ke.title}),(Ke.snippet||Ke.description)&&u.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-xs mb-2",children:Ke.snippet||Ke.description}),u.jsx("a",{href:Ke.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-[10px] break-all block",children:Ke.url})]}),C&&u.jsx("button",{onClick:()=>{const j=new Set(vt);v?j.delete(br):j.add(br),pn(j)},className:"flex-shrink-0 text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-200 text-xs",title:v?"Hide details":"Show details",children:v?"":""})]}),u.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[Ke.state&&u.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded ${Ke.state==="success"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300"}`,children:Ke.state}),Ke.fetchTimeMs!==void 0&&u.jsxs("span",{className:"text-[10px] bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400 px-1.5 py-0.5 rounded",children:[" ",Ke.fetchTimeMs,"ms"]}),Ke.contentFormat&&u.jsx("span",{className:"text-[10px] bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-1.5 py-0.5 rounded",children:Ke.contentFormat}),Ke.intelligentlyExtracted&&u.jsx("span",{className:"text-[10px] bg-indigo-100 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 px-1.5 py-0.5 rounded",title:s("chat.contentExtracted"),children:" smart"}),Ke.truncated&&u.jsx("span",{className:"text-[10px] bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-1.5 py-0.5 rounded",title:s("chat.truncatedToFit"),children:" truncated"})]})]}),v&&C&&u.jsxs("div",{className:"border-t border-purple-200 dark:border-purple-800 bg-purple-50/50 dark:bg-purple-900/10",children:[u.jsxs("div",{className:"px-3 py-2 border-b border-purple-200 dark:border-purple-800",children:[u.jsx("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 mb-2",children:" Scraping & Compression Details:"}),u.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 text-[10px]",children:[u.jsxs("div",{className:"col-span-2",children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.scrapeMethod")})," ",u.jsx("span",{className:"font-semibold text-purple-600 dark:text-purple-400",children:Ke.tier!==void 0?u.jsxs(u.Fragment,{children:[s("chat.tier")," ",Ke.tier," - ",Ke.scrapeMethod||Ke.scrapeService]}):"Direct HTTP Fetch"}),Ke.tier!==void 0&&u.jsxs("span",{className:"text-gray-500 dark:text-gray-400 text-[9px] block mt-0.5",children:[Ke.tier===0&&"(Simple HTTP GET - fast, no browser)",Ke.tier===1&&"(Puppeteer - browser automation with stealth)",Ke.tier===2&&"(Playwright - advanced browser automation)",Ke.tier===3&&"(Selenium - complex interactions)",Ke.tier===4&&"(Interactive - manual CAPTCHA/login)"]})]}),Ke.responseTime!==void 0&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.scrapeTime")})," ",u.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[Ke.responseTime,"ms"]})]}),Ke.fetchTimeMs!==void 0&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.totalTime")})," ",u.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[Ke.fetchTimeMs,"ms"]})]}),Ke.contentFormat&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.format")})," ",u.jsx("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:Ke.contentFormat})]}),(Ke.originalLength||Ke.originalContentLength)&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.originalSize")})," ",u.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[((Ke.originalLength||Ke.originalContentLength)/1024).toFixed(1),"KB"]})]}),R&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.compressedSize")})," ",u.jsxs("span",{className:"font-mono text-gray-700 dark:text-gray-300",children:[(R.length/1024).toFixed(1),"KB"]})]}),Ke.compressionRatio&&u.jsxs("div",{children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.compression")})," ",u.jsxs("span",{className:"font-mono text-green-600 dark:text-green-400",children:[Ke.compressionRatio.toFixed(2),"x"]})]}),u.jsxs("div",{className:"col-span-2",children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:s("chat.compressionStrategy")})," ",u.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Ke.intelligentlyExtracted?u.jsxs("span",{children:["Smart extraction",Ke.contentFormat==="markdown"?"  Markdown":"  Plain text",Ke.truncated&&"  Truncated to model limits"]}):u.jsx("span",{children:s("chat.basicExtraction")})})]}),u.jsx("div",{className:"col-span-2 mt-1 text-gray-500 dark:text-gray-400 italic",children:"Note: No LLM calls used for compression (rule-based extraction only)"})]})]}),u.jsxs("div",{className:"p-3 space-y-3",children:[Ke.rawHtml&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 mb-1 flex items-center justify-between",children:[u.jsx("span",{children:" Stage 1: Raw HTML from Scraper"}),u.jsxs("span",{className:"text-[10px] font-normal text-gray-500 dark:text-gray-400",children:[Ke.rawHtml.length.toLocaleString()," chars"]})]}),u.jsx("button",{onClick:()=>{const j=document.createElement("div");j.className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50";const G=document.createElement("div");G.className="bg-white dark:bg-gray-800 w-11/12 h-5/6 rounded-lg shadow-xl flex flex-col";const J=document.createElement("div");J.className="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700";const le=document.createElement("h3");le.className="text-lg font-semibold text-gray-900 dark:text-gray-100",le.textContent=s("chat.rawHtml",{count:Ke.rawHtml.length.toLocaleString()});const ge=document.createElement("button");ge.className="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",ge.innerHTML='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>',ge.onclick=()=>j.remove();const Ee=document.createElement("div");Ee.className="flex-1 overflow-auto p-4";const Re=document.createElement("pre");Re.className="text-xs text-gray-900 dark:text-gray-100 font-mono whitespace-pre-wrap",Re.textContent=Ke.rawHtml,Ee.appendChild(Re),J.appendChild(le),J.appendChild(ge),G.appendChild(J),G.appendChild(Ee),j.appendChild(G),document.body.appendChild(j)},className:"px-3 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:"Show Full HTML"})]}),Ke.rawText&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 mb-1 flex items-center justify-between",children:[u.jsx("span",{children:" Stage 2: Raw Text (innerText)"}),u.jsxs("span",{className:"text-[10px] font-normal text-gray-500 dark:text-gray-400",children:[Ke.rawText.length.toLocaleString()," chars"]})]}),u.jsx("button",{onClick:()=>{const j=document.createElement("div");j.className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50";const G=document.createElement("div");G.className="bg-white dark:bg-gray-800 w-11/12 h-5/6 rounded-lg shadow-xl flex flex-col";const J=document.createElement("div");J.className="flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700";const le=document.createElement("h3");le.className="text-lg font-semibold text-gray-900 dark:text-gray-100",le.textContent=s("chat.rawText",{count:Ke.rawText.length.toLocaleString()});const ge=document.createElement("button");ge.className="text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",ge.innerHTML='<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>',ge.onclick=()=>j.remove();const Ee=document.createElement("div");Ee.className="flex-1 overflow-auto p-4";const Re=document.createElement("pre");Re.className="text-xs text-gray-900 dark:text-gray-100 font-mono whitespace-pre-wrap",Re.textContent=Ke.rawText,Ee.appendChild(Re),J.appendChild(le),J.appendChild(ge),G.appendChild(J),G.appendChild(Ee),j.appendChild(G),document.body.appendChild(j)},className:"px-3 py-1 text-xs bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-200 dark:hover:bg-purple-800",children:"Show Full Text"})]}),Ke.afterSmartExtraction&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:" Stage 3: After Smart Extraction (Headers/Nav/Footers Removed)"}),u.jsxs("span",{className:"text-[10px] font-normal text-gray-500 dark:text-gray-400",children:[Ke.afterSmartExtraction.length.toLocaleString()," chars"]})]}),u.jsx("div",{className:"bg-white dark:bg-gray-900 p-3 rounded border border-purple-200 dark:border-purple-700 max-h-48 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap text-[11px] text-gray-900 dark:text-gray-100 font-mono leading-relaxed",children:Ke.afterSmartExtraction})})]}),Ke.afterSummarization&&Ke.beforeSummarization&&Ke.afterSummarization!==Ke.beforeSummarization&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-purple-700 dark:text-purple-300 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:" Stage 4: After AI Summarization"}),u.jsxs("span",{className:"text-[10px] font-normal text-gray-500 dark:text-gray-400",children:[Ke.afterSummarization.length.toLocaleString()," chars"]})]}),u.jsx("div",{className:"bg-white dark:bg-gray-900 p-3 rounded border border-amber-200 dark:border-amber-700 max-h-48 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap text-[11px] text-gray-900 dark:text-gray-100 font-mono leading-relaxed",children:Ke.afterSummarization})})]}),Ke.sentToLLM&&u.jsxs("div",{children:[u.jsxs("div",{className:"text-xs font-semibold text-green-700 dark:text-green-300 mb-2 flex items-center justify-between",children:[u.jsx("span",{children:" Stage 5: SENT TO LLM (Tool Result)"}),u.jsxs("span",{className:"text-[10px] font-normal text-gray-500 dark:text-gray-400",children:[Ke.sentToLLM.length.toLocaleString()," chars"]})]}),u.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded border-2 border-green-500 dark:border-green-600 max-h-64 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap text-[11px] text-gray-900 dark:text-gray-100 font-mono leading-relaxed",children:Ke.sentToLLM})})]}),u.jsx("div",{className:"pt-2 border-t border-purple-200 dark:border-purple-800",children:u.jsxs("div",{className:"text-[10px] text-gray-600 dark:text-gray-400 space-y-1",children:[u.jsx("div",{className:"font-semibold text-gray-700 dark:text-gray-300 mb-1",children:s("chat.contentProcessingPipeline")}),Ke.rawHtml&&u.jsxs("div",{children:[" Raw HTML: ",Ke.rawHtml.length.toLocaleString()," chars"]}),Ke.rawText&&u.jsxs("div",{children:[" Raw Text: ",Ke.rawText.length.toLocaleString()," chars"]}),Ke.afterSmartExtraction&&u.jsxs("div",{children:[" Smart Extraction: ",Ke.afterSmartExtraction.length.toLocaleString()," chars"]}),Ke.afterSummarization&&Ke.beforeSummarization&&Ke.afterSummarization!==Ke.beforeSummarization&&u.jsxs("div",{children:[" After Summarization: ",Ke.afterSummarization.length.toLocaleString()," chars"]}),Ke.sentToLLM&&u.jsxs("div",{className:"font-semibold text-green-600 dark:text-green-400",children:[" Sent to LLM: ",Ke.sentToLLM.length.toLocaleString()," chars"]})]})})]})]})]},Rt)})}):Oe?u.jsxs("div",{className:"space-y-3",children:[Oe.error&&u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded p-3",children:[u.jsx("span",{className:"font-semibold text-red-800 dark:text-red-200",children:" Scraping Error:"}),u.jsx("p",{className:"text-red-700 dark:text-red-300 text-xs mt-1 font-mono whitespace-pre-wrap",children:Oe.error})]}),Oe.warning&&u.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700 rounded p-2",children:[u.jsx("span",{className:"font-semibold text-yellow-800 dark:text-yellow-200",children:" Warning:"}),u.jsx("p",{className:"text-yellow-700 dark:text-yellow-300 text-xs mt-1",children:Oe.warning})]}),(Oe.format||Oe.compressionRatio||Oe.originalLength||Oe.extractedLength)&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300",children:" Metadata:"}),(()=>{const Rt=Array.from(rn.values()).find(br=>br.url===Oe.url)?.rawHtml;return Rt?u.jsx("button",{onClick:()=>yn({html:Rt,url:Oe.url}),className:"text-xs px-2 py-1 bg-purple-200 dark:bg-purple-800 text-purple-700 dark:text-purple-300 rounded hover:bg-purple-300 dark:hover:bg-purple-700",children:"View Raw HTML"}):null})()]}),u.jsx("table",{className:"w-full text-xs border-collapse",children:u.jsxs("tbody",{children:[Oe.format&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-1 pr-3 text-gray-600 dark:text-gray-400",children:s("chat.format")}),u.jsx("td",{className:"py-1 font-medium text-gray-900 dark:text-gray-100",children:Oe.format==="markdown"?" Markdown":" Plain Text"})]}),typeof Oe.originalLength=="number"&&typeof Oe.extractedLength=="number"&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-1 pr-3 text-gray-600 dark:text-gray-400",children:s("chat.size")}),u.jsxs("td",{className:"py-1 font-medium text-gray-900 dark:text-gray-100",children:[(Oe.originalLength/1024).toFixed(1),"KB  ",(Oe.extractedLength/1024).toFixed(1),"KB"]})]}),Oe.compressionRatio&&typeof Oe.compressionRatio=="number"&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-1 pr-3 text-gray-600 dark:text-gray-400",children:s("chat.compression")}),u.jsxs("td",{className:"py-1 font-medium text-gray-900 dark:text-gray-100",children:[Oe.compressionRatio.toFixed(1),"x"]})]})]})})]}),Oe.content&&u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-purple-700 dark:text-purple-300 mb-2",children:" Content:"}),u.jsx("div",{className:"bg-white dark:bg-gray-900 p-3 rounded border border-purple-200 dark:border-purple-800 max-h-96 overflow-y-auto",children:Oe.format==="markdown"?u.jsx(k0,{content:Oe.content}):u.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-900 dark:text-gray-100 leading-relaxed",children:Oe.content})})]})]}):gt?u.jsxs("div",{className:"space-y-3",children:[It&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[u.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-300",children:" Code:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(It),P(s("chat.codeCopied"))},className:"text-xs px-2 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors",title:s("chat.copyCodeToClipboard"),children:"Copy"}),u.jsx("button",{onClick:()=>{to(It,"tool","JavaScript Code")},className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded transition-colors",title:s("chat.captureCodeToSwag"),children:"Grab"})]})]}),u.jsx("div",{className:"bg-gray-900 text-green-400 p-3 rounded font-mono text-xs overflow-x-auto max-h-64 overflow-y-auto",children:u.jsx("pre",{className:"whitespace-pre-wrap leading-relaxed",children:It})})]}),gt.error&&u.jsxs("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded p-2",children:[u.jsx("span",{className:"font-semibold text-red-800 dark:text-red-200",children:" Error:"}),u.jsx("p",{className:"text-red-700 dark:text-red-300 text-xs mt-1 font-mono",children:gt.error})]}),gt.result!==void 0&&u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[u.jsx("span",{className:"font-semibold text-purple-700 dark:text-purple-300",children:" Output:"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(String(gt.result)),P(s("chat.outputCopied"))},className:"text-xs px-2 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors",title:"Copy output to clipboard",children:"Copy"}),u.jsx("button",{onClick:()=>{to(String(gt.result),"tool","JavaScript Output")},className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded transition-colors",title:"Capture output to Swag",children:"Grab"})]})]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-950 p-3 rounded border border-green-300 dark:border-green-700",children:u.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-900 dark:text-gray-100 font-mono leading-relaxed",children:String(gt.result)})})]})]}):ie.name==="generate_chart"?u.jsx(F3,{content:ie.content,chartCode:sl(Y.content)||void 0}):ie.name==="generate_image"?(()=>{const Ke=ie.tool_call_id||ie.id,Rt=Y.imageGenerations?.find(br=>br.id===Ke);if(Rt)return u.jsxs("div",{className:"space-y-3 mt-3",children:[u.jsx("div",{className:"overflow-x-auto",children:u.jsx("table",{className:"w-full text-sm border-collapse border border-purple-200 dark:border-purple-800 rounded",children:u.jsxs("tbody",{children:[Rt.prompt&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20 w-1/3",children:s("chat.titlePrompt")}),u.jsx("td",{className:"py-2 px-3",children:Rt.prompt})]}),Rt.revisedPrompt&&Rt.revisedPrompt!==Rt.prompt&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:s("chat.finalPrompt")}),u.jsx("td",{className:"py-2 px-3",children:Rt.revisedPrompt})]}),Rt.size&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:"Size"}),u.jsx("td",{className:"py-2 px-3",children:Rt.size})]}),Rt.model&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:"Model"}),u.jsxs("td",{className:"py-2 px-3",children:[Rt.provider,"/",Rt.model]})]}),Rt.qualityTier&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:"Quality"}),u.jsx("td",{className:"py-2 px-3 capitalize",children:Rt.qualityTier})]}),Rt.cost!==void 0&&u.jsxs("tr",{className:"border-b border-purple-200 dark:border-purple-800",children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:"Cost"}),u.jsxs("td",{className:"py-2 px-3",children:["$",Rt.cost.toFixed(4)]})]}),u.jsxs("tr",{children:[u.jsx("td",{className:"py-2 px-3 font-semibold bg-purple-50 dark:bg-purple-900/20",children:"Status"}),u.jsx("td",{className:"py-2 px-3",children:Rt.status==="complete"?u.jsx("span",{className:"text-green-600 dark:text-green-400 font-semibold",children:" Success"}):Rt.status==="error"?u.jsx("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:" Failed"}):u.jsx("span",{className:"text-yellow-600 dark:text-yellow-400",children:Rt.status})})]})]})})}),Rt.llmApiCall?.request&&u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded overflow-hidden",children:[u.jsxs("button",{onClick:()=>{const br=`img-req-${Rt.id}`,v=document.getElementById(br);v&&v.classList.toggle("hidden")},className:"w-full px-3 py-2 flex items-center justify-between bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",children:[u.jsx("span",{className:"font-mono text-sm text-gray-700 dark:text-gray-300",children:" Request Data"}),u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u.jsx("pre",{id:`img-req-${Rt.id}`,className:"hidden p-3 text-xs overflow-auto max-h-96 bg-white dark:bg-gray-900 font-mono text-gray-800 dark:text-gray-200",children:JSON.stringify(Rt.llmApiCall.request,null,2)})]}),Rt.llmApiCall?.response&&u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded overflow-hidden",children:[u.jsxs("button",{onClick:()=>{const br=`img-res-${Rt.id}`,v=document.getElementById(br);v&&v.classList.toggle("hidden")},className:"w-full px-3 py-2 flex items-center justify-between bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-750 transition-colors",children:[u.jsx("span",{className:"font-mono text-sm text-gray-700 dark:text-gray-300",children:" Response Data"}),u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),u.jsx("pre",{id:`img-res-${Rt.id}`,className:"hidden p-3 text-xs overflow-auto max-h-96 bg-white dark:bg-gray-900 font-mono text-gray-800 dark:text-gray-200",children:JSON.stringify(Rt.llmApiCall.response,null,2)})]})]});try{return typeof ie.content=="string"?JSON.parse(ie.content):ie.content,u.jsx(_v,{content:ie.content})}catch{return u.jsx(_v,{content:ie.content})}})():u.jsx(_v,{content:ie.content})]}),ie.name==="generate_image"&&(()=>{const Ke=ie.tool_call_id||ie.id,Rt=Y.imageGenerations?.find(br=>br.id===Ke);if(Rt&&(Rt.status==="generating"||Rt.status==="downloading")){const br=Rt.phase||"generating",v=Rt.estimatedSeconds||15;let C=" Generating image...",R="This may take 10-30 seconds for high-quality images";return br==="selecting_provider"?(C=" Selecting image provider...",R="Finding best available model"):br==="generating"?(C=` Generating image... (~${v}s)`,R=`Using ${Rt.provider||"selected"} ${Rt.model||"model"}`):Rt.status==="downloading"&&(C=" Downloading image...",R="Converting to base64 for offline storage"),u.jsx("div",{className:"mt-3 relative",children:u.jsxs("div",{className:"w-full rounded border border-purple-300 dark:border-purple-700 bg-purple-50 dark:bg-purple-900/20 flex flex-col items-center justify-center p-8",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 dark:border-purple-400 mb-4"}),u.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400 font-semibold mb-2",children:C}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-center max-w-md",children:R}),Rt.prompt&&u.jsxs("div",{className:"text-xs text-gray-400 dark:text-gray-500 text-center max-w-md mt-3 italic",children:['"',Rt.prompt.substring(0,100),Rt.prompt.length>100?"...":"",'"']})]})})}if(Rt&&(Rt.imageUrl||Rt.base64)){let br;Rt.base64?br=Rt.base64.startsWith("data:image/")?Rt.base64:`data:image/png;base64,${Rt.base64}`:Rt.imageUrl?.startsWith("data:image/")?br=Rt.imageUrl:br=Rt.imageUrl||"";const v=`<img src="${br}" alt="${Rt.prompt||"Generated image"}" />`;return u.jsxs("div",{className:"mt-3 relative group",children:[u.jsx("img",{src:br,alt:Rt.prompt||"Generated image",className:"w-full rounded border border-purple-300 dark:border-purple-700",style:{maxHeight:"512px",objectFit:"contain"}}),u.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(br||""),P(s("chat.copiedToClipboard"))},className:"p-1.5 bg-white/90 dark:bg-gray-800/90 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Copy image data URL",children:u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),u.jsx("button",{onClick:async()=>{await y(v,"assistant",Rt.prompt||"Generated image"),P("Image grabbed to swag")},className:"p-1.5 bg-white/90 dark:bg-gray-800/90 border border-gray-300 dark:border-gray-600 rounded hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Grab to swag",children:u.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})})})]})]})}return null})(),u.jsx(j3,{rawResponse:ie.rawResponse,extractionMetadata:ie.extractionMetadata})]},dt)})}),Y.isStreaming&&Y.toolResults&&Y.toolResults.length>0&&u.jsx("div",{className:"mt-4 p-4 bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-300 dark:border-blue-700 rounded-lg",children:u.jsxs("div",{className:"flex items-center gap-3 text-blue-700 dark:text-blue-300",children:[u.jsxs("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"font-semibold text-base",children:"Generating LLM Response..."}),u.jsx("div",{className:"text-sm opacity-80",children:"The AI is analyzing the tool results and composing a response"})]})]})})]}):u.jsxs("div",{className:"whitespace-pre-wrap",children:[u.jsx(B3,{text:ea(Y.content)}),Y._attachments&&Y._attachments.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:Y._attachments.filter(ie=>ie&&ie.name).map((ie,dt)=>u.jsx("div",{className:"bg-white/20 dark:bg-gray-700/30 rounded-lg overflow-hidden border border-white/30 dark:border-gray-600",children:ie.preview?u.jsx("img",{src:ie.preview,alt:ie.name,className:"w-32 h-32 object-cover cursor-pointer hover:opacity-80 transition-opacity",title:`${ie.name} (${(ie.size/1024).toFixed(1)} KB)`,onClick:()=>window.open(ie.preview,"_blank")}):u.jsxs("div",{className:"w-32 h-32 flex flex-col items-center justify-center p-2 bg-red-50 dark:bg-red-900/20",children:[u.jsxs("svg",{className:"w-8 h-8 text-red-600 dark:text-red-400 mb-2",fill:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{d:"M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"}),u.jsx("text",{x:"8",y:"16",fontSize:"8",fill:"currentColor",fontWeight:"bold",children:"PDF"})]}),u.jsx("span",{className:"text-xs text-center text-gray-700 dark:text-gray-300 font-medium truncate max-w-full px-1",children:ie.name})]})},dt))}),(console.log(" Checking imageGenerations:",{hasImageGenerations:!!Y.imageGenerations,length:Y.imageGenerations?.length,imageGenerations:Y.imageGenerations}),null),Y.imageGenerations&&Y.imageGenerations.length>0&&u.jsx("div",{className:"mt-3",children:(console.log(" About to render imageGenerations:",Y.imageGenerations),Y.imageGenerations.map(ie=>(console.log(" Mapping imageGen:",ie),u.jsx(yye,{data:ie,accessToken:i,providerApiKeys:nl,onCopy:dt=>{navigator.clipboard.writeText(dt).then(()=>{P(s("chat.copiedToClipboard"))}).catch(()=>{k("Failed to copy")})},onGrab:dt=>{navigator.clipboard.writeText(dt).then(()=>{P(s("chat.copiedToClipboard"))}).catch(()=>{k("Failed to copy")})},onLlmInfo:()=>{Lr(oe)},onStatusChange:(dt,We,Ct,Oe)=>{K(gt=>gt.map((It,Ke)=>{if(It.imageGenerations){const Rt=It.imageGenerations.map(v=>v.id===dt?{...v,status:We,imageUrl:Ct,llmApiCall:Oe}:v),br={...It,imageGenerations:Rt};return Oe&&Ke===oe&&(br.llmApiCalls=[...It.llmApiCalls||[],Oe]),br}return It}))}},ie.id))))})]}),Y.role==="assistant"&&!Te&&zs>0&&oe===I.length-1&&u.jsx("div",{className:"mt-2 flex items-center justify-end",children:u.jsxs("div",{className:"inline-flex items-center gap-1 bg-green-50 dark:bg-green-900/20 border border-green-300 dark:border-green-700 text-green-700 dark:text-green-300 px-2 py-1 rounded text-xs",children:[u.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),"Request cost: ",Gl(zs),M&&u.jsxs("span",{className:"ml-1 opacity-75",children:["(Total: ",Gl(M.totalCost),")"]})]})}),Y.role==="assistant"&&(Y.content||Y.llmApiCalls)&&u.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[u.jsxs("button",{onClick:()=>to(ea(Y.content),"assistant",void 0,Y.extractedContent,Y.toolResults),className:"flex items-center gap-1.5 px-3 py-2 text-sm bg-green-50 hover:bg-green-100 text-green-700 dark:bg-green-900/30 dark:hover:bg-green-900/50 dark:text-green-400 rounded transition-colors",title:"Save to Swag",children:[u.jsx(DH,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden sm:inline",children:"Save"})]}),u.jsxs("button",{onClick:()=>ut(oe),className:"flex items-center gap-1.5 px-3 py-2 text-sm bg-blue-50 hover:bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:hover:bg-blue-900/50 dark:text-blue-400 rounded transition-colors",title:"Share this response",children:[u.jsx(xI,{className:"h-4 w-4"}),u.jsx("span",{className:"hidden sm:inline",children:"Share"})]}),Y.llmApiCalls&&Y.llmApiCalls.length>0&&(()=>{let ie=0,dt=0;Y.llmApiCalls.forEach(Ct=>{ie+=Ct.response?.usage?.prompt_tokens||0,dt+=Ct.response?.usage?.completion_tokens||0});const We=ie+dt;return u.jsxs("button",{onClick:()=>Lr(oe),className:"text-xs px-2 py-1 rounded bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50 flex items-center gap-1.5 transition-colors",title:`View LLM transparency info  ${We.toLocaleString()} tokens (${ie.toLocaleString()} in, ${dt.toLocaleString()} out)  ${Y.llmApiCalls.length} call${Y.llmApiCalls.length!==1?"s":""}  ${us(Vs(Y))}`,children:[u.jsxs("span",{className:"font-semibold text-green-600 dark:text-green-400",children:[" ",us(Vs(Y))]}),u.jsxs("span",{className:"text-gray-600 dark:text-gray-400 hidden sm:inline",children:[" ",We.toLocaleString()," token",We!==1?"s":""," (",ie.toLocaleString()," in, ",dt.toLocaleString()," out)"]}),u.jsxs("span",{className:"text-gray-600 dark:text-gray-400 hidden lg:inline",children:[" ",Y.llmApiCalls.length," call",Y.llmApiCalls.length!==1?"s":""]}),u.jsx("span",{className:"ml-0.5",children:""})]})})(),!Y.isStreaming&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>Ao(oe),className:"text-xs px-2 py-1 rounded bg-green-50 dark:bg-green-900/30 hover:bg-green-100 dark:hover:bg-green-900/50 flex items-center gap-1 transition-colors",title:"Good response",children:""}),u.jsx("button",{onClick:()=>zc(oe),className:"text-xs px-2 py-1 rounded bg-red-50 dark:bg-red-900/30 hover:bg-red-100 dark:hover:bg-red-900/50 flex items-center gap-1 transition-colors",title:"Bad response - report issue",children:""})]}),Y.errorData&&ea(Y.content).startsWith(" Error:")&&!Y.guardrailFailed&&u.jsxs("button",{onClick:()=>Gn(oe),className:"text-xs text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-100 flex items-center gap-1",title:"View full error details",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Error Info"]}),Y.isRetryable&&(!Y.retryCount||Y.retryCount<3)&&u.jsxs("button",{onClick:()=>Di(oe),disabled:Te,className:"text-xs text-orange-600 dark:text-orange-400 hover:text-orange-900 dark:hover:text-orange-100 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",title:"Retry this request with full context",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Try Again",(Y.retryCount??0)>0&&u.jsxs("span",{className:"text-[10px] opacity-75",children:["(",(Y.retryCount??0)+1,")"]})]})]}),Y.role==="user"&&u.jsxs("div",{className:"flex gap-2 mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:[u.jsxs("button",{onClick:()=>{Ae(ea(Y.content)),K(I.slice(0,oe)),ur([]),sr("")},disabled:Te,className:"text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",title:"Reset chat to this message",children:[u.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 9l3-3m0 0l3 3m-3-3v12"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l-3 3m0 0l-3-3",opacity:"0.3"})]}),"Reset"]}),u.jsxs("button",{onClick:()=>{Bt.current=!0,K(I.slice(0,oe)),ur([]),sr(""),Ae(ea(Y.content))},disabled:Te,className:"text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed",title:"Retry this message (clears subsequent messages and resubmits)",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"2",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9"})}),"Retry"]}),u.jsxs("button",{onClick:()=>to(ea(Y.content),"user"),className:"text-xs text-blue-600 dark:text-blue-400 hover:text-blue-900 dark:hover:text-blue-100 flex items-center gap-1",title:"Capture to Swag",children:[u.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})}),"Grab"]})]})]})]})},oe)}),Te&&Ar!==null&&u.jsx("div",{className:"flex justify-start",children:u.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:[u.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full animate-pulse mr-1"}),"streaming..."]})}),Te&&!_t&&Yt.length===0&&u.jsx("div",{className:"flex justify-start",children:u.jsx("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-lg p-3",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce"}),u.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),u.jsx("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})}),u.jsx("div",{ref:Us})]}),u.jsx("div",{className:"md:px-4 py-4 border-t border-gray-200 dark:border-gray-700 space-y-3",children:u.jsxs(u.Fragment,{children:[u.jsx(lbe,{attachedFiles:di,onRemoveAttachment:Fh}),pi&&pi.total>0&&u.jsxs("div",{className:"mb-3 p-3 border border-yellow-200 dark:border-yellow-800 rounded bg-yellow-50 dark:bg-yellow-900/20",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2 text-yellow-900 dark:text-yellow-200 font-semibold text-sm",children:[u.jsx("span",{children:" Todos"}),u.jsxs("span",{className:"text-xs font-normal text-yellow-700 dark:text-yellow-300",children:[pi.total," total  ",pi.remaining," remaining"]}),pa&&u.jsxs("span",{className:"ml-2 text-xs italic text-yellow-800 dark:text-yellow-300 animate-pulse",children:[" Continuing: ",pa]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{className:"text-xs text-yellow-800 dark:text-yellow-300 hover:underline focus:outline-none",onClick:()=>Qu(Y=>!Y),title:fi?"Switch to detailed view":"Switch to compact view",children:fi?" Detailed":" Compact"}),u.jsx("button",{className:"text-xs text-yellow-800 dark:text-yellow-300 hover:underline focus:outline-none",onClick:()=>Co(Y=>!Y),children:eo?" Collapse":" Expand"})]})]}),u.jsxs("div",{className:"mt-1 text-sm text-gray-900 dark:text-gray-100",children:[u.jsx("span",{className:"font-medium",children:"Current:"})," ",pi.current?.description||""]}),eo&&u.jsx("ul",{className:"mt-2 max-h-48 overflow-y-auto text-sm divide-y divide-yellow-200 dark:divide-yellow-800 bg-white dark:bg-gray-800 rounded p-2",children:pi.items.map((Y,oe)=>u.jsxs("li",{className:`py-1.5 flex items-start gap-2 text-gray-900 dark:text-gray-100 ${fi?"items-center":""}`,children:[u.jsx("span",{className:`${fi?"":"mt-0.5"} text-xs flex-shrink-0`,children:Y.status==="done"?"":Y.status==="current"?"":""}),fi?u.jsx("span",{className:`flex-1 truncate ${Y.status==="done"?"line-through opacity-60":""}`,children:Y.description}):u.jsx("span",{className:`flex-1 ${Y.status==="done"?"line-through opacity-60":""}`,children:Y.description})]},String(Y.id)||oe))})]}),ui&&An&&u.jsxs("div",{className:"flex flex-col items-center gap-3 py-3 px-4",children:[u.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-400 dark:border-orange-600 rounded-lg p-4 max-w-2xl w-full",children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("svg",{className:"w-6 h-6 text-orange-600 dark:text-orange-400 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"font-semibold text-orange-900 dark:text-orange-100 mb-1",children:" Maximum Iteration Limit Reached"}),u.jsxs("p",{className:"text-sm text-orange-800 dark:text-orange-200 mb-2",children:["The conversation has reached the maximum number of tool execution iterations (",An?.maxIterations||"?"," iterations). This limit prevents infinite loops and excessive API usage."]}),u.jsx("p",{className:"text-sm text-orange-800 dark:text-orange-200 font-medium",children:"Would you like to continue processing from where it stopped?"})]})]})}),u.jsxs("button",{onClick:()=>{confirm(` Continue processing?

This will resume tool execution and may incur additional API costs. The iteration limit helps prevent runaway processes.

Click OK to continue or Cancel to stop here.`)&&td()},disabled:Te,className:"bg-orange-600 hover:bg-orange-700 disabled:opacity-50 disabled:cursor-not-allowed text-white p-2 md:px-6 md:py-3 rounded-lg font-semibold text-base transition-all transform hover:scale-105 shadow-lg flex items-center gap-2",title:"Continue from where the iteration limit was reached","aria-label":s("chat.continueProcessing"),children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 5l7 7-7 7M5 5l7 7-7 7"})}),u.jsx("span",{className:"hidden md:inline",children:s("chat.continueProcessing")})]})]}),u.jsxs("div",{className:"flex flex-col gap-2",children:[Ya.size>0&&u.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800 rounded-lg p-2",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[u.jsx("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:s("chat.snippetsAttached",{count:Ya.size,plural:Ya.size===1?"":"s"})}),u.jsxs("div",{className:"flex flex-wrap gap-1 flex-1 min-w-0",children:[Array.from(Ya).slice(0,3).map(Y=>{const oe=x.find(Ge=>Ge.id===Y);return oe?u.jsx("span",{className:"text-xs bg-blue-100 dark:bg-blue-800 text-blue-700 dark:text-blue-200 px-2 py-0.5 rounded truncate max-w-[200px]",title:oe.title||"Untitled",children:oe.title||"Untitled"},Y):null}),Ya.size>3&&u.jsxs("span",{className:"text-xs text-blue-600 dark:text-blue-300",children:["+",Ya.size-3," more"]})]})]}),u.jsx("button",{onClick:()=>es(new Set),className:"ml-2 p-1 text-blue-600 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-800 rounded transition-colors",title:s("chat.clearAttachedSnippets"),"aria-label":s("chat.clearAttachedSnippets"),children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),u.jsx("textarea",{ref:Pr,value:ye,onChange:Y=>{Ae(Y.target.value),_s(-1)},onKeyDown:Y=>{if(Y.key==="Enter"&&!Y.shiftKey)Y.preventDefault(),ds();else if(Y.key==="ArrowUp"&&!Y.shiftKey){if(Y.preventDefault(),jn.length>0){const oe=Math.min(Es+1,jn.length-1);_s(oe),Ae(jn[oe])}}else if(Y.key==="ArrowDown"&&!Y.shiftKey)if(Y.preventDefault(),Es>0){const oe=Es-1;_s(oe),Ae(jn[oe])}else Es===0&&(_s(-1),Ae(""))},placeholder:s("chat.inputPlaceholder"),className:"input-field flex-1 resize-none overflow-y-auto",style:{minHeight:"2.5rem",maxHeight:"300px"},"aria-label":s("chat.chatMessageInput"),"aria-describedby":"chat-input-help"}),u.jsx("span",{id:"chat-input-help",className:"sr-only",children:"Type your message and press Enter to send. Use Shift+Enter for new line. Use up and down arrows to navigate message history."}),u.jsxs("div",{className:"flex gap-2 justify-between items-center",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{ref:Vr,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp,application/pdf",multiple:!0,onChange:Y=>Gc(Y.target.files),className:"hidden"}),u.jsx("button",{onClick:()=>Vr.current?.click(),disabled:Te,className:"btn-secondary px-3 h-10 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",title:"Attach images or PDFs","aria-label":"Attach images or PDFs",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})})}),u.jsxs("div",{className:"relative",children:[u.jsxs("div",{className:"flex",children:[u.jsx("button",{onClick:()=>ko(!0),disabled:Te||!i,className:"btn-secondary px-3 h-10 rounded-r-none flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed",title:i?"Record voice message":"Please sign in to use voice input","aria-label":i?"Record voice message":"Sign in to use voice input",children:u.jsxs("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[u.jsx("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"}),u.jsx("path",{d:"M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"})]})}),u.jsx("button",{onClick:()=>Ii(!ci),disabled:Te||!i,className:`btn-secondary px-2 h-10 rounded-l-none border-l border-gray-300 dark:border-gray-600 flex-shrink-0 disabled:opacity-50 disabled:cursor-not-allowed ${_r?"bg-blue-100 dark:bg-blue-900 border-blue-500":""}`,title:"Voice input options","aria-label":"Voice input options","aria-expanded":ci,"aria-haspopup":"true",children:u.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true",children:u.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),ci&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>Ii(!1)}),u.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-64 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 z-20",children:u.jsx("div",{className:"py-1",children:u.jsxs("button",{onClick:()=>{Cs(!_r),Ii(!1)},disabled:!i,className:`w-full px-4 py-3 text-left flex items-center gap-3 text-sm disabled:opacity-50 disabled:cursor-not-allowed transition-colors ${_r?"bg-blue-50 dark:bg-blue-900/20 hover:bg-blue-100 dark:hover:bg-blue-900/30":"hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:[u.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${_r?"bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400"}`,children:_r?u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})]}):u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:`font-medium ${_r?"text-blue-700 dark:text-blue-300":"text-gray-900 dark:text-gray-100"}`,children:_r?"Stop Continuous Mode":"Start Continuous Mode"}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:_r?"Currently active - listening and responding automatically":"Auto-listen after each response (hands-free)"})]})]})})})]})]})]}),u.jsx("button",{onClick:()=>{_r?(console.log(" Stopping continuous voice mode from send button"),il(),Cs(!1)):Te?il():ye.trim()?ds():Pr.current?.focus()},disabled:!_r&&!Te&&!i,className:`btn-primary p-2 md:px-4 md:py-2 h-10 flex-shrink-0 flex items-center gap-1.5 ${Te||_r?"animate-pulse":""}`,title:_r?"Stop Continuous Voice Mode":i?ye.trim()?s("chat.sendMessage"):s("chat.typeMessageFirst"):s("chat.signInToSend"),"aria-label":_r?"Stop Continuous Voice Mode":s(Te?"chat.stopGenerating":"chat.sendMessage"),children:_r||Te?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:_r?"Stop Voice Mode":s("chat.stop")})]}):ye.trim()?u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:s("chat.send")})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{className:"hidden md:inline",children:s("chat.typeMessage")})]})})]})]})]})}),be&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:u.jsxs("div",{className:"card max-w-2xl w-full p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:s("chat.chatHistoryTitle")}),Hr.length>0&&u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:Zu,className:"btn-secondary text-xs px-3 py-1",children:[" ",s("chat.selectAll")]}),u.jsxs("button",{onClick:Vc,className:"btn-secondary text-xs px-3 py-1",children:[" ",s("chat.selectNone")]})]})]}),u.jsxs("div",{className:"space-y-3 max-h-[70vh] overflow-y-auto",children:[Hr.map(Y=>{const oe=new Date(Y.timestamp).toLocaleString(),Ge=ze.has(Y.id);return u.jsx("div",{className:`border ${Ge?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600"} rounded-lg p-3`,children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",checked:Ge,onChange:()=>ed(Y.id),className:"mt-1 w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100 font-medium mb-1 truncate",children:Y.firstUserPrompt}),u.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:oe})]}),u.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[u.jsx("button",{onClick:()=>zh(Y),className:"btn-primary text-xs px-3 py-1",children:s("chat.load")}),u.jsx("button",{onClick:()=>Yl(Y.id),className:"btn-secondary text-red-500 text-xs px-3 py-1",children:s("chat.delete")})]})]})},Y.id)}),Hr.length===0&&u.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:s("chat.noChatHistory")})]}),u.jsxs("div",{className:"flex gap-2 mt-4",children:[ze.size>0&&u.jsxs("button",{onClick:Ql,className:"btn-secondary text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[" ",s("chat.deleteSelected")," (",ze.size,")"]}),Hr.length>0&&u.jsxs("button",{onClick:()=>de(!0),className:"btn-secondary text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20",children:[" ",s("chat.clearHistory")]}),u.jsx("button",{onClick:()=>xe(!1),className:"btn-primary flex-1",children:s("chat.close")})]})]})}),me&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:u.jsxs("div",{className:"card max-w-md w-full p-6",children:[u.jsxs("h3",{className:"text-xl font-bold mb-4 text-gray-900 dark:text-gray-100",children:[s("chat.clearHistory"),"?"]}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:s("chat.confirmClearHistory")}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>de(!1),className:"btn-secondary flex-1",children:s("chat.cancel")}),u.jsx("button",{onClick:ro,className:"btn-primary flex-1 bg-red-600 hover:bg-red-700",children:s("chat.clearHistory")})]})]})}),r&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:u.jsxs("div",{className:"card max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:s("chat.mcpServerConfiguration")}),u.jsx("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:""})]}),u.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s("chat.addMCPServer")}),u.jsx("button",{onClick:()=>lr(!Kt),className:"text-sm text-blue-600 dark:text-blue-400 hover:underline",children:Kt?" Hide Examples":" Show Examples"})]}),Kt&&u.jsxs("div",{className:"mb-4 p-3 bg-white dark:bg-gray-900 rounded border border-gray-300 dark:border-gray-600",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quick Start Examples:"}),u.jsxs("select",{onChange:Y=>{const oe=Qe.find(Ge=>Ge.id===Y.target.value);oe&&Gt({name:oe.name,url:oe.url})},className:"input-field w-full mb-2",defaultValue:"",children:[u.jsx("option",{value:"",disabled:!0,children:"Select an example server..."}),u.jsx("optgroup",{label:" Sample Servers",children:Qe.filter(Y=>Y.category==="Sample").map(Y=>u.jsxs("option",{value:Y.id,children:[Y.name," - ",Y.description]},Y.id))}),u.jsx("optgroup",{label:" Official @modelcontextprotocol Servers",children:Qe.filter(Y=>Y.category==="Official").map(Y=>u.jsxs("option",{value:Y.id,children:[Y.name.replace("@modelcontextprotocol/server-","")," - ",Y.description]},Y.id))})]}),st.name&&Qe.find(Y=>Y.name===st.name)&&u.jsxs("div",{className:"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm",children:[u.jsx("p",{className:"font-semibold text-gray-900 dark:text-gray-100 mb-1",children:Qe.find(Y=>Y.name===st.name)?.name}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-2",children:Qe.find(Y=>Y.name===st.name)?.description}),u.jsxs("div",{className:"mb-2",children:[u.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Tools:"})," ",u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:Qe.find(Y=>Y.name===st.name)?.tools.join(", ")})]}),u.jsx("div",{className:"bg-gray-800 dark:bg-gray-950 text-gray-100 p-2 rounded font-mono text-xs whitespace-pre-wrap",children:Qe.find(Y=>Y.name===st.name)?.instructions})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("input",{type:"text",value:st.name,onChange:Y=>Gt({...st,name:Y.target.value}),placeholder:s("chat.mcpServerNamePlaceholder"),className:"input-field w-full"}),u.jsx("input",{type:"text",value:st.url,onChange:Y=>Gt({...st,url:Y.target.value}),placeholder:s("chat.mcpServerUrlPlaceholder"),className:"input-field w-full"}),u.jsxs("button",{onClick:Wc,disabled:!st.name.trim()||!st.url.trim(),className:"btn-primary w-full",children:[" ",s("chat.addServer")]})]})]}),u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold mb-3 text-gray-900 dark:text-gray-100",children:[s("chat.mcpServers")," (",fr.length,")"]}),u.jsxs("div",{className:"space-y-2",children:[fr.map(Y=>u.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[u.jsx("input",{type:"checkbox",checked:Y.enabled,onChange:()=>No(Y.id),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:Y.name}),u.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:Y.url})]}),u.jsx("button",{onClick:()=>ll(Y.id),className:"text-red-500 hover:text-red-700 px-3 py-1",title:s("chat.remove"),children:""})]},Y.id)),fr.length===0&&u.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:s("chat.noMcpServers")})]})]}),u.jsx("div",{className:"mt-6 flex gap-2",children:u.jsx("button",{onClick:()=>n(!1),className:"btn-primary flex-1",children:s("common.done")})})]})}),u.jsx(DG,{isOpen:he,onClose:()=>Ie(!1),onTransferToChat:Y=>{rd();try{const oe=JSON.parse(Y);Ae(oe.prompt),oe.persona&&Ne(oe.persona),oe.planningQuery&&ht(oe.planningQuery),oe.generatedSystemPrompt&&ct(oe.generatedSystemPrompt),oe.generatedUserQuery&&kt(oe.generatedUserQuery),console.log(" Transferred planning context to chat")}catch{Ae(Y)}Ie(!1)}}),ir&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full h-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-start",children:[u.jsxs("div",{className:"flex-1 pr-4",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:ir.result.title}),u.jsx("a",{href:ir.result.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-sm break-all",children:ir.result.url}),u.jsxs("div",{className:"mt-2 flex gap-3 text-xs text-gray-500 dark:text-gray-400",children:[u.jsxs("span",{children:[" ",(ir.result.content?.length/1024).toFixed(1)," KB"]}),ir.result.contentFormat&&u.jsxs("span",{children:[" ",ir.result.contentFormat]}),ir.result.images?.length>0&&u.jsxs("span",{children:[" ",ir.result.images.length," images"]}),ir.result.links?.length>0&&u.jsxs("span",{children:[" ",ir.result.links.length," links"]})]})]}),u.jsx("button",{onClick:()=>Kn(null),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-3xl leading-none","aria-label":s("chat.close"),children:""})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Page Content"}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:ir.result.contentFormat==="markdown"?u.jsx(k0,{content:ir.result.content}):u.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-300",children:ir.result.content})})]}),ir.result.images&&ir.result.images.length>0&&u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:["Images (",ir.result.images.length,")"]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:ir.result.images.map((Y,oe)=>u.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded overflow-hidden",children:[u.jsx("img",{src:Y.src,alt:Y.alt||`Image ${oe+1}`,className:"w-full h-32 object-cover",loading:"lazy"}),Y.alt&&u.jsx("div",{className:"p-2 text-xs text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-800",children:Y.alt})]},oe))})]}),ir.result.links&&ir.result.links.length>0&&u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:["Links (",ir.result.links.length,")"]}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsxs("ul",{className:"space-y-2",children:[ir.result.links.slice(0,50).map((Y,oe)=>u.jsxs("li",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:""}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("a",{href:Y.href,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-sm break-all",children:Y.text||Y.href}),Y.context&&u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 line-clamp-2",children:Y.context})]})]},oe)),ir.result.links.length>50&&u.jsxs("li",{className:"text-xs text-gray-500 dark:text-gray-400 italic",children:["... and ",ir.result.links.length-50," more links"]})]})})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:" Full Scraped Data (JSON)"}),u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx(Qg,{data:{url:ir.result.url,title:ir.result.title,description:ir.result.description,snippet:ir.result.snippet,fullScrapedContent:ir.result.content,contentFormat:ir.result.contentFormat,summarizedContent:ir.result.summary||ir.result.description,links:ir.result.links||[],images:ir.result.images||[],youtubeLinks:ir.result.youtube||ir.result.videos||[],otherMedia:ir.result.media||ir.result.audio||[],metadata:{contentLength:ir.result.content?.length||0,linkCount:ir.result.links?.length||0,imageCount:ir.result.images?.length||0,youtubeCount:(ir.result.youtube||ir.result.videos||[]).length,mediaCount:(ir.result.media||ir.result.audio||[]).length}},expanded:!1})})]})]})}),u.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:u.jsx("button",{onClick:()=>Kn(null),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})})]})}),Hn&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full h-full max-w-6xl max-h-[95vh] overflow-hidden flex flex-col",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700 flex justify-between items-start",children:[u.jsxs("div",{className:"flex-1 pr-4",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Raw HTML Content"}),u.jsx("a",{href:Hn.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline text-sm break-all",children:Hn.url}),u.jsxs("div",{className:"mt-2 flex gap-3 text-xs text-gray-500 dark:text-gray-400",children:[u.jsxs("span",{children:[" ",(Hn.html.length/1024).toFixed(1)," KB uncompressed"]}),u.jsx("span",{children:" Raw HTML"})]})]}),u.jsx("button",{onClick:()=>Tt(null),className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 text-3xl leading-none","aria-label":s("chat.close"),children:""})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u.jsx("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 border border-gray-200 dark:border-gray-700",children:u.jsx("pre",{className:"whitespace-pre-wrap text-xs text-gray-700 dark:text-gray-300 font-mono",children:Hn.html})})}),u.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end gap-3",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(Hn.html)},className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:" Copy to Clipboard"}),u.jsx("button",{onClick:()=>Tt(null),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Close"})]})]})}),qt!==null&&I[qt]?.llmApiCalls&&u.jsx(AS,{apiCalls:I[qt].llmApiCalls,onClose:()=>Lr(null)}),Gr!==null&&I[Gr]?.errorData&&u.jsx(fye,{errorData:I[Gr].errorData,llmApiCalls:I[Gr].llmApiCalls,onClose:()=>Gn(null)}),vr!==null&&u.jsx(PI,{isOpen:!0,onClose:()=>Fa(null),messageData:{messageId:`message-${vr}`,messageContent:ea(I[vr].content),llmApiCalls:I[vr].llmApiCalls||[],evaluations:I[vr].evaluations||[],conversationThread:I},showSuccess:P,showError:k}),u.jsx(NI,{isOpen:xa,onClose:()=>ko(!1),onTranscriptionComplete:Hl,accessToken:i,apiEndpoint:da}),i&&u.jsx("div",{className:"fixed bottom-20 right-4 z-30 max-w-sm",children:u.jsx(mye,{onVoiceRequest:Y=>{Ae(Y),setTimeout(()=>{console.log(" Continuous mode: Auto-submitting transcribed text"),ds(Y)},150)},onStopTTS:()=>{console.log(" Comprehensive stop triggered from continuous voice mode toast"),z(),Te&&(console.log(" Aborting LLM generation"),il()),console.log(" Disabling continuous voice mode"),Cs(!1)},accessToken:i,apiEndpoint:da,isProcessing:Te,isSpeaking:$.isPlaying,enabled:_r,onEnabledChange:Cs})}),u.jsx(sbe,{isOpen:zt,onClose:()=>Ca(!1),onExampleClick:Ku,location:W,locationLoading:H,requestLocation:re,clearLocation:ne}),Bs&&u.jsx(ube,{messages:I.map(Y=>({role:Y.role,content:typeof Y.content=="string"?Y.content:JSON.stringify(Y.content),timestamp:Date.now()})),onClose:()=>qn(!1),title:fe||void 0}),Se!==null&&I[Se]&&u.jsx(Kye,{snippetId:`chat-msg-${Se}`,content:ea(I[Se].content),title:`Chat Response ${Se+1}`,tags:["chat-response"],sourceType:"assistant",timestamp:Date.now(),onClose:()=>ut(null)}),Eo&&u.jsx("div",{className:"fixed bottom-0 left-0 right-0 h-2/3 z-40 bg-white dark:bg-gray-800 shadow-2xl border-t border-gray-300 dark:border-gray-600 overflow-hidden",children:u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-100 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:s("chat.attachContextTitle")}),u.jsx("button",{onClick:()=>mi(!1),className:"p-2 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600 rounded transition-colors",title:"Close Snippet Selector",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"flex-1 overflow-hidden",children:u.jsx(Jye,{selectedSnippetIds:Ya,onSelectionChange:es,userEmail:l?.email})})]})}),ua&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100 truncate",children:"Raw HTML"}),ua.url&&u.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate mt-1",children:ua.url})]}),u.jsx("button",{onClick:()=>yn(null),className:"ml-4 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Close raw HTML dialog",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:()=>{navigator.clipboard.writeText(ua.html)},className:"absolute top-2 right-2 px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white text-xs rounded",children:"Copy"}),u.jsx("pre",{className:"bg-gray-50 dark:bg-gray-900 p-4 rounded border border-gray-200 dark:border-gray-700 overflow-x-auto",children:u.jsx("code",{className:"text-xs text-gray-800 dark:text-gray-200 font-mono whitespace-pre",children:ua.html})})]})}),u.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:u.jsx("button",{onClick:()=>yn(null),className:"px-4 py-2 bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded hover:bg-gray-300 dark:hover:bg-gray-600",children:"Close"})})]})}),Nt&&u.jsx(bbe,{quiz:Nt,onClose:()=>xr(null)})]})},Sbe=({isBlocked:t,onUnblock:e})=>{const{settings:r}=vo(),{isAuthenticated:n}=oi(),a=Xi();return N.useEffect(()=>{if(t&&r?.providers&&r.providers.length>0){console.log("User has UI providers configured, unblocking UI"),e();return}},[t,r,e]),N.useEffect(()=>{const s=i=>{console.log("Provider added:",i.detail),setTimeout(()=>{r?.providers&&r.providers.length>0&&e()},100)};return window.addEventListener("provider-added",s),()=>{window.removeEventListener("provider-added",s)}},[r,e]),t&&n?u.jsxs("div",{className:"provider-setup-gate",children:[u.jsx("div",{className:"gate-overlay",children:u.jsxs("div",{className:"gate-content",children:[u.jsxs("div",{className:"gate-header",children:[u.jsx("h1",{children:" Credits Required"}),u.jsx("p",{className:"gate-subtitle",children:"To use this service, you need to purchase credits."})]}),u.jsxs("div",{className:"gate-info",children:[u.jsxs("div",{className:"info-box",children:[u.jsx("h3",{children:"How does it work?"}),u.jsx("p",{children:"This is a pay-as-you-go service. Purchase credits to access our LLM providers without needing your own API keys. Your credits are tracked automatically, and you will be charged based on actual usage."})]}),u.jsxs("div",{className:"info-box",children:[u.jsx("h3",{children:"Pricing"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Small models:"})," approximately $0.0001 per request"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Large models:"})," approximately $0.001 per request"]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Minimum purchase:"})," $5.00 (5,000-50,000 requests)"]})]}),u.jsx("p",{style:{marginTop:"1rem",fontSize:"0.9rem",color:"#888"},children:"Actual costs vary based on model and tokens used."})]}),u.jsxs("div",{className:"info-box",children:[u.jsx("h3",{children:"Secure Payment"}),u.jsx("p",{children:"Payments are processed securely through PayPal. Your credit balance is updated instantly after purchase."})]})]}),u.jsx("div",{className:"gate-action",children:u.jsx("button",{className:"btn-primary btn-large",onClick:()=>{console.log("Navigating to billing page"),e(),a("/settings?tab=billing")},children:"Buy Credits Now"})}),u.jsx("div",{className:"gate-footer",children:u.jsx("p",{className:"text-muted",children:"Your balance will be displayed in the top left corner after purchase. New users receive trial credits that expire after 24 hours."})})]})}),u.jsx("style",{children:".provider-setup-gate{position:fixed;top:0;left:0;right:0;bottom:0;z-index:10000;background:rgba(0,0,0,0.95);display:flex;align-items:center;justify-content:center;backdrop-filter:blur(10px)}.gate-overlay{width:100%;height:100%;overflow-y:auto;display:flex;align-items:center;justify-content:center;padding:2rem}.gate-content{max-width:800px;width:100%;background:#1a1a1a;border-radius:12px;padding:3rem;box-shadow:0 20px 60px rgba(0,0,0,0.5);border:1px solid #333}.gate-header{text-align:center;margin-bottom:2rem}.gate-header h1{font-size:2rem;margin:0 0 1rem 0;color:#fff}.gate-subtitle{font-size:1.1rem;color:#bbb;margin:0}.gate-info{margin-bottom:2rem}.info-box{background:#252525;border-radius:8px;padding:1.5rem;margin-bottom:1rem;border:1px solid #333}.info-box h3{margin:0 0 0.75rem 0;color:#fff;font-size:1.1rem}.info-box p{margin:0;color:#bbb;line-height:1.6}.info-box ul{margin:0.5rem 0 0 0;padding-left:1.5rem;color:#bbb}.info-box li{margin-bottom:0.75rem;line-height:1.6}.gate-action{text-align:center;margin-bottom:2rem}.btn-primary{background:#4a9eff;color:white;border:none;padding:1rem 2rem;border-radius:8px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all 0.2s ease}.btn-primary:hover{background:#357ac9;transform:translateY(-2px);box-shadow:0 4px 12px rgba(74,158,255,0.3)}.btn-large{padding:1.25rem 2.5rem;font-size:1.2rem}.gate-footer{text-align:center;border-top:1px solid #333;padding-top:1.5rem}.text-muted{color:#888;font-size:0.95rem;margin:0}@media (max-width:768px){.gate-content{padding:2rem 1.5rem}.gate-header h1{font-size:1.5rem}.gate-subtitle{font-size:1rem}}"})]}):null},kbe=({className:t=""})=>{const e=Xi();return u.jsx("button",{onClick:()=>e("/image-editor"),className:t,title:"Image Editor",children:u.jsx(TH,{className:"w-6 h-6"})})},Tbe=({hideGitHub:t=!1})=>{const e=Xi(),r=xo(),[n,a]=Ur.useState(navigator.onLine);return Ur.useEffect(()=>{const s=()=>a(!0),i=()=>a(!1);return window.addEventListener("online",s),window.addEventListener("offline",i),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",i)}},[]),n?u.jsxs("div",{className:"hidden md:flex fixed bottom-4 right-4 flex-col gap-2 z-50",style:{zIndex:9999},children:[r.pathname!=="/chat"&&u.jsx("button",{onClick:()=>e("/chat"),className:"p-3 bg-green-600 hover:bg-green-500 dark:bg-green-700 dark:hover:bg-green-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Chat with AI",children:u.jsx(SH,{className:"w-6 h-6"})}),u.jsx("button",{onClick:()=>{console.log("Navigating to /swag"),e("/swag")},className:"p-3 bg-blue-600 hover:bg-blue-500 dark:bg-blue-700 dark:hover:bg-blue-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Swag - Save and manage snippets",children:u.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M8 2C8 1.45 8.45 1 9 1h6c.55 0 1 .45 1 1v2h-8V2zm-1 4h10l1.5 13c.08.72-.48 1.32-1.2 1.32H6.7c-.72 0-1.28-.6-1.2-1.32L7 6zm5 2c-2.21 0-4 1.79-4 4v6h8v-6c0-2.21-1.79-4-4-4z"})})}),u.jsx("button",{onClick:()=>e("/feed"),className:"p-3 bg-cyan-600 hover:bg-cyan-500 dark:bg-cyan-700 dark:hover:bg-cyan-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Feed",children:u.jsx(bI,{className:"w-6 h-6"})}),u.jsx("button",{onClick:()=>e("/quiz"),className:"p-3 bg-indigo-600 hover:bg-indigo-500 dark:bg-indigo-700 dark:hover:bg-indigo-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Quiz Statistics",children:u.jsx(I0,{className:"w-6 h-6"})}),u.jsx(kbe,{className:"p-3 bg-orange-600 hover:bg-orange-500 dark:bg-orange-700 dark:hover:bg-orange-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center"}),u.jsx("button",{onClick:()=>e("/music"),className:"p-3 bg-purple-600 hover:bg-purple-500 dark:bg-purple-700 dark:hover:bg-purple-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Music - Manage playlists",children:u.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})})}),u.jsx("button",{onClick:()=>e("/settings"),className:"p-3 bg-gray-600 hover:bg-gray-500 dark:bg-gray-700 dark:hover:bg-gray-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Settings",children:u.jsxs("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),u.jsx("button",{onClick:()=>e("/help"),className:"p-3 bg-blue-600 hover:bg-blue-500 dark:bg-blue-700 dark:hover:bg-blue-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Help & Documentation",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsx("button",{onClick:()=>e("/privacy"),className:"p-3 bg-green-600 hover:bg-green-500 dark:bg-green-700 dark:hover:bg-green-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"Privacy Policy",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),!t&&u.jsx("a",{href:"https://github.com/syntithenai/lambdallmproxy",target:"_blank",rel:"noopener noreferrer",className:"p-3 bg-gray-800 hover:bg-gray-700 dark:bg-gray-700 dark:hover:bg-gray-600 text-white rounded-full shadow-lg transition-all duration-200 hover:scale-110 flex items-center justify-center",title:"View on GitHub",children:u.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:u.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})})]}):null},H3=()=>{try{localStorage.setItem("has_completed_welcome_wizard","true"),localStorage.setItem("welcome_wizard_completed_at",new Date().toISOString())}catch(t){console.error("Failed to mark welcome wizard as complete:",t)}},Cbe=()=>{try{localStorage.removeItem("has_completed_welcome_wizard"),localStorage.removeItem("welcome_wizard_completed_at")}catch(t){console.error("Failed to reset welcome wizard:",t)}},Sve=()=>{try{console.log(" Triggering welcome wizard..."),Cbe(),console.log(" Reset wizard state");const t=new CustomEvent("show-welcome-wizard");console.log(" About to dispatch event:",t),console.log(" Current event listeners on window:",window);const e=window.dispatchEvent(t);console.log(" Event dispatch result:",e),console.log(" Event dispatched successfully"),setTimeout(()=>{console.log(" Trying delayed dispatch...");const r=new CustomEvent("show-welcome-wizard");window.dispatchEvent(r)},100)}catch(t){console.error("Failed to trigger welcome wizard:",t)}},Xm=[{id:"welcome",type:"modal",title:" Welcome!",content:`Your AI research assistant is ready!

Let's explore the key features in under 2 minutes.`,navigateTo:"/"},{id:"chat",type:"spotlight",title:" Chat Interface",content:"Ask questions, get research, use web search & transcription.",targetSelector:'textarea[placeholder*="message"]',tooltipPosition:"top",navigateTo:"/"},{id:"voice",type:"spotlight",title:" Voice Input",content:"Speak your questions hands-free!",targetSelector:'button[aria-label*="voice" i], button[title*="voice" i]',tooltipPosition:"left",navigateTo:"/"},{id:"swag",type:"spotlight",title:" SWAG Storage",content:"Save & organize important info. Tag, search, and embed content locally!",targetSelector:'button[title*="Swag" i]',tooltipPosition:"left",navigateTo:"/"},{id:"nav-billing",type:"spotlight",title:" Navigate to Billing",content:"Click this button to view billing & usage.",targetSelector:'button[aria-label*="Billing" i], a[href="/billing"]',tooltipPosition:"right",navigateTo:"/"},{id:"billing",type:"spotlight",title:" Billing & Usage",content:"Track costs & usage. $0.50 welcome bonus included!",targetSelector:".billing-page, .billing-header, .billing-title h1, .transactions-table, .summary-cards",tooltipPosition:"bottom",navigateTo:"/billing"},{id:"feed",type:"spotlight",title:" Content Feed",content:"Discover curated articles, tutorials & insights. Filter by your saved Swag tags.",targetSelector:".bg-white.border-b.border-gray-200.sticky h1, .text-2xl.font-bold.text-gray-900",tooltipPosition:"bottom",navigateTo:"/feed"},{id:"quiz",type:"spotlight",title:" Quiz Mode",content:"Test your knowledge with AI-generated quizzes. Generate from Feed articles or selected SWAG content.",targetSelector:'[data-testid="quiz-page-title"], .quiz-page-header, h1.text-3xl.font-bold',tooltipPosition:"bottom",navigateTo:"/quiz"},{id:"image-editor",type:"spotlight",title:" Image Editor",content:"Create & edit images with AI assistance. Generate, modify, and save images.",targetSelector:"h1.text-xl.font-bold.text-gray-900",tooltipPosition:"bottom",navigateTo:"/image-editor"},{id:"settings",type:"spotlight",title:" Settings",content:"Customize tools, themes & preferences.",targetSelector:"h1.text-3xl.font-bold.text-gray-900, h1.dark\\:text-gray-100",tooltipPosition:"bottom",navigateTo:"/settings"},{id:"complete",type:"modal",title:" All Set!",content:`You're ready to go!

Enjoy your AI assistant!`,navigateTo:"/"}],G3=({isOpen:t,onClose:e})=>{const r=Xi(),[n,a]=N.useState(0),[s,i]=N.useState(null),[l,c]=N.useState(!1),d=N.useRef(null),p=Xm[n],g=n===0,m=n===Xm.length-1;N.useEffect(()=>{t&&p.navigateTo&&(r(p.navigateTo),p.id==="nav-billing"&&window.scrollTo({top:0,behavior:"smooth"}))},[t,n,p.navigateTo,r,p.id]),N.useEffect(()=>{if(!t||p.type!=="spotlight"||!p.targetSelector){i(null),c(!1);return}c(!0),i(null);let k=0;const _=10,P=()=>{const B=document.querySelector(p.targetSelector);if(B){const M=B.getBoundingClientRect();return i(M),c(!1),!0}return!1};if(P())return;const F=setInterval(()=>{k++,(P()||k>=_)&&(clearInterval(F),k>=_&&(console.warn(`Spotlight target not found after ${_} attempts: ${p.targetSelector}`),c(!1),["feed","billing","quiz","image-editor","settings"].includes(p.id)&&setTimeout(()=>{y()},2e3)))},300),D=()=>{s&&P()};return window.addEventListener("resize",D),()=>{clearInterval(F),window.removeEventListener("resize",D)}},[t,p,n]),N.useEffect(()=>{if(!t)return;const k=_=>{_.key==="Escape"?w():_.key==="ArrowRight"&&!m?y():_.key==="ArrowLeft"&&!g&&x()};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[t,n]);const y=()=>{m?T():a(k=>k+1)},x=()=>{g||a(k=>k-1)},w=()=>{H3(),e()},T=()=>{H3(),e()};return t?u.jsxs("div",{className:"fixed inset-0 z-[9999]",children:[u.jsx("div",{className:"absolute inset-0 bg-black transition-opacity duration-300",style:{opacity:p.type==="modal"?.75:.6},onClick:w,children:p.type==="spotlight"&&s&&u.jsx("div",{className:"absolute pointer-events-none transition-all duration-500 ease-out",style:{top:s.top-8,left:s.left-8,width:s.width+16,height:s.height+16,boxShadow:"0 0 0 9999px rgba(0, 0, 0, 0.6)",borderRadius:"12px",animation:"pulse-spotlight 2s ease-in-out infinite"}})}),p.type==="modal"&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",onClick:k=>k.stopPropagation(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6 transform transition-all duration-300 scale-100 border-4 border-gray-900 dark:border-gray-100",children:[u.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-white mb-3 uppercase tracking-tight",children:p.title}),u.jsx("div",{className:"text-gray-700 dark:text-gray-300 whitespace-pre-line mb-5 text-base leading-snug",children:p.content}),u.jsx("div",{className:"flex justify-center gap-2 mb-5",children:Xm.map((k,_)=>u.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${_===n?"w-8 bg-blue-600 dark:bg-blue-400":_<n?"w-2 bg-green-500 dark:bg-green-400":"w-2 bg-gray-400 dark:bg-gray-600"}`},_))}),u.jsxs("div",{className:"flex justify-between items-center gap-4",children:[u.jsx("button",{onClick:w,className:"px-3 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors text-xs font-bold uppercase",children:"Skip Tour"}),u.jsxs("div",{className:"flex gap-2",children:[!g&&u.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-600 transition-colors font-bold text-xs uppercase",children:"Back"}),u.jsx("button",{onClick:y,className:"px-5 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-bold text-xs uppercase shadow-lg shadow-blue-500/30",children:g?"Start":m?"Done":"Next"})]})]})]})}),p.type==="spotlight"&&s&&u.jsx("div",{ref:d,className:"absolute transform transition-all duration-300",style:{...Ebe(s,p.tooltipPosition||"top"),zIndex:1e4},onClick:k=>k.stopPropagation(),children:u.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border-4 border-gray-900 dark:border-gray-100 px-6 py-4 max-w-xs",children:[u.jsx("svg",{className:"absolute",style:_be(p.tooltipPosition||"top",s),width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Abe()}),u.jsxs("div",{className:"relative z-10",children:[u.jsx("h3",{className:"text-lg font-black text-gray-900 dark:text-white mb-2 uppercase tracking-tight",children:p.title}),u.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-300 leading-snug mb-3",children:p.content}),u.jsx("div",{className:"flex justify-center gap-1.5 mb-3",children:Xm.map((k,_)=>u.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${_===n?"w-6 bg-blue-600 dark:bg-blue-400":_<n?"w-1.5 bg-green-500 dark:bg-green-400":"w-1.5 bg-gray-400 dark:bg-gray-600"}`},_))}),u.jsxs("div",{className:"flex justify-between items-center gap-2",children:[u.jsx("button",{onClick:w,className:"text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors font-bold uppercase",children:"Skip"}),u.jsxs("div",{className:"flex gap-2",children:[!g&&u.jsx("button",{onClick:x,className:"px-3 py-1.5 bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-600 transition-colors font-bold text-xs uppercase",children:"Back"}),u.jsx("button",{onClick:y,className:"px-4 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-bold text-xs uppercase shadow-lg",children:m?"Done":"Next"})]})]})]})]})}),p.type==="spotlight"&&!s&&l&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4 pointer-events-none",children:u.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md border-4 border-gray-900 dark:border-gray-100",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-3"}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-bold uppercase",children:"Loading..."})]})})}),p.type==="spotlight"&&!s&&!l&&u.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-4",onClick:k=>k.stopPropagation(),children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 max-w-md border-4 border-gray-900 dark:border-gray-100",children:[u.jsxs("div",{className:"text-center mb-4",children:[u.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 font-bold",children:" Element not found"}),u.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-xs",children:"This feature may not be available on this page."})]}),u.jsxs("div",{className:"flex justify-center gap-3",children:[u.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-300 dark:bg-gray-700 text-gray-900 dark:text-gray-100 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-600 transition-colors font-bold text-xs uppercase",children:"Back"}),u.jsx("button",{onClick:y,className:"px-5 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-bold text-xs uppercase",children:"Skip"})]})]})}),u.jsx("style",{children:`
        @keyframes pulse-spotlight {
          0%, 100% {
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.6);
          }
          50% {
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.7);
          }
        }
      `})]}):null};function Ebe(t,e){const n=window.innerWidth,a=window.innerHeight,s=320;let i={};switch(e){case"top":i={left:Math.min(Math.max(t.left+t.width/2,s/2+16),n-s/2-16),top:t.top-50,transform:"translate(-50%, -100%)"};break;case"bottom":i={left:Math.min(Math.max(t.left+t.width/2,s/2+16),n-s/2-16),top:t.bottom+50,transform:"translate(-50%, 0)"};break;case"left":i={left:t.left-50,top:Math.min(Math.max(t.top+t.height/2,120),a-120),transform:"translate(-100%, -50%)"};break;case"right":i={left:t.right+50,top:Math.min(Math.max(t.top+t.height/2,120),a-120),transform:"translate(0, -50%)"};break;default:i={left:Math.min(Math.max(t.left+t.width/2,s/2+16),n-s/2-16),top:t.top-50,transform:"translate(-50%, -100%)"}}return i}function _be(t,e){const n=window.innerWidth,a=e.left+e.width/2,s=Math.min(Math.max(a,320/2+16),n-320/2-16),i=a-s,l=Math.max(-40,Math.min(40,i/320*100));switch(t){case"top":return{bottom:"-36px",left:`calc(50% + ${l}%)`,transform:"translateX(-50%)"};case"bottom":return{top:"-36px",left:`calc(50% + ${l}%)`,transform:"translateX(-50%) rotate(180deg)"};case"left":return{right:"-36px",top:"50%",transform:"translateY(-50%) rotate(-90deg)"};case"right":return{left:"-36px",top:"50%",transform:"translateY(-50%) rotate(90deg)"};default:return{bottom:"-36px",left:`calc(50% + ${l}%)`,transform:"translateX(-50%)"}}}function Abe(){return u.jsxs(u.Fragment,{children:[u.jsx("path",{d:"M 10 2 Q 15 10, 20 2 L 20 30 Q 20 35, 15 38 L 15 38 Q 10 35, 10 30 Z",className:"fill-gray-900 dark:fill-gray-100",strokeWidth:"0"}),u.jsx("path",{d:"M 12 4 Q 15 10, 18 4 L 18 29 Q 18 33, 15 35 L 15 35 Q 12 33, 12 29 Z",className:"fill-white dark:fill-gray-800",strokeWidth:"0"})]})}const Nbe=({isOpen:t,onClose:e})=>{const{t:r}=Lc();if(!t)return null;const n=[{title:r("keyboardShortcuts.general",{defaultValue:"General"}),shortcuts:[{keys:["Ctrl","K"],description:r("keyboardShortcuts.openHelp",{defaultValue:"Open keyboard shortcuts help"})},{keys:["?"],description:r("keyboardShortcuts.openHelpAlt",{defaultValue:"Show this help dialog"})},{keys:["Esc"],description:r("keyboardShortcuts.closeModal",{defaultValue:"Close modal / Clear input"})},{keys:["Tab"],description:r("keyboardShortcuts.navigateForward",{defaultValue:"Navigate forward"})},{keys:["Shift","Tab"],description:r("keyboardShortcuts.navigateBackward",{defaultValue:"Navigate backward"})}]},{title:r("keyboardShortcuts.chat",{defaultValue:"Chat"}),shortcuts:[{keys:["Ctrl","Enter"],description:r("keyboardShortcuts.sendMessage",{defaultValue:"Send message"})},{keys:["Shift","Enter"],description:r("keyboardShortcuts.newLine",{defaultValue:"New line in message"})},{keys:[""],description:r("keyboardShortcuts.previousPrompt",{defaultValue:"Previous prompt in history"})},{keys:[""],description:r("keyboardShortcuts.nextPrompt",{defaultValue:"Next prompt in history"})}]},{title:r("keyboardShortcuts.modals",{defaultValue:"Modals & Dialogs"}),shortcuts:[{keys:["Esc"],description:r("keyboardShortcuts.closeDialog",{defaultValue:"Close current dialog"})},{keys:["Tab"],description:r("keyboardShortcuts.cycleFocus",{defaultValue:"Cycle through controls (focus trap active)"})},{keys:["Enter"],description:r("keyboardShortcuts.confirmAction",{defaultValue:"Confirm action / Submit form"})}]}];return u.jsx(Kw.FocusTrap,{active:t,children:u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:u.jsxs("div",{className:"card max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:[" ",r("keyboardShortcuts.title",{defaultValue:"Keyboard Shortcuts"})]}),u.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200","aria-label":"Close keyboard shortcuts help",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsx("div",{className:"space-y-6",children:n.map((a,s)=>u.jsxs("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4 last:border-b-0",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-3",children:a.title}),u.jsx("div",{className:"space-y-2",children:a.shortcuts.map((i,l)=>u.jsxs("div",{className:"flex items-center justify-between py-2 px-3 rounded bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[u.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:i.description}),u.jsx("div",{className:"flex items-center gap-1",children:i.keys.map((c,d)=>u.jsxs(Ur.Fragment,{children:[u.jsx("kbd",{className:"px-2 py-1 text-xs font-semibold text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded shadow-sm",children:c}),d<i.keys.length-1&&u.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"+"})]},d))})]},l))})]},s))}),u.jsx("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:u.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[u.jsxs("strong",{children:[r("keyboardShortcuts.tip",{defaultValue:"Tip"}),":"]})," ",r("keyboardShortcuts.macNote",{defaultValue:"On Mac, use  (Cmd) instead of Ctrl for most shortcuts."})]})}),u.jsx("div",{className:"flex justify-end gap-3 mt-6",children:u.jsx("button",{onClick:e,className:"btn-primary",children:r("common.close",{defaultValue:"Close"})})})]})})})};function Pbe(){const[t,e]=N.useState({hasInternet:navigator.onLine,backendAvailable:!0}),[r,n]=N.useState(!1),a=async()=>{const p=navigator.onLine;let g=!1;if(p)try{const m=await dn(),y=new AbortController,x=setTimeout(()=>y.abort(),5e3),w=await fetch(`${m}/health`,{method:"GET",signal:y.signal}).catch(()=>null);clearTimeout(x),g=w?.ok||!1}catch{g=!1}return e({hasInternet:p,backendAvailable:g}),{hasInternet:p,backendAvailable:g}};N.useEffect(()=>{const p=()=>{console.log(" Internet connection restored"),a(),n(!1)},g=()=>{console.log(" Internet connection lost"),e({hasInternet:!1,backendAvailable:!1})};window.addEventListener("online",p),window.addEventListener("offline",g),a();const m=setInterval(()=>{(!t.hasInternet||!t.backendAvailable)&&a()},3e4);return()=>{window.removeEventListener("online",p),window.removeEventListener("offline",g),clearInterval(m)}},[t.hasInternet,t.backendAvailable]);const s=async()=>{n(!0);const{hasInternet:p,backendAvailable:g}=await a();p&&g?window.location.reload():n(!1)};if(t.hasInternet&&t.backendAvailable)return null;const i=!t.hasInternet,l=i?zH:gH,c=i?"You're Offline":"Backend Unavailable",d=i?"It looks like you've lost your internet connection. Please check your network settings and try again.":"Unable to reach the server. The backend may be temporarily unavailable or under maintenance.";return u.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-95 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-8 text-center",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx("div",{className:`${i?"bg-orange-100 dark:bg-orange-900":"bg-yellow-100 dark:bg-yellow-900"} rounded-full p-6`,children:u.jsx(l,{className:`h-16 w-16 ${i?"text-orange-600 dark:text-orange-400":"text-yellow-600 dark:text-yellow-400"}`})})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:c}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:d}),u.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6 space-y-2 text-sm",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Internet:"}),u.jsx("span",{className:`font-medium ${t.hasInternet?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:t.hasInternet?" Connected":" Offline"})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Backend:"}),u.jsx("span",{className:`font-medium ${t.backendAvailable?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:t.backendAvailable?" Available":" Unavailable"})]})]}),u.jsxs("button",{onClick:s,disabled:r,className:"w-full btn-primary py-3 px-6 rounded-lg font-medium flex items-center justify-center gap-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(AH,{className:`h-5 w-5 ${r?"animate-spin":""}`}),r?"Checking Connection...":"Retry Connection"]}),u.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-6",children:"Some features may be unavailable while offline. Cached content will remain accessible."})]})})}const V3="Research Agent",vw="saved_plans.json";let Bd=null;class Ibe{name="plans";enabled=!0;async getAppFolder(){if(Bd)return Bd;const e=await ms(),r=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${V3}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`Failed to search for app folder: ${r.statusText}`);const n=await r.json();if(n.files&&n.files.length>0)return Bd=n.files[0].id,Bd;const a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({name:V3,mimeType:"application/vnd.google-apps.folder"})});if(!a.ok)throw new Error(`Failed to create app folder: ${a.statusText}`);return Bd=(await a.json()).id,Bd}async getFileId(e){const r=await ms(),n=await this.getAppFolder(),a=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${e}' and '${n}' in parents and trashed=false`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`Failed to search for file: ${a.statusText}`);const s=await a.json();return s.files&&s.files.length>0?s.files[0].id:null}async pull(){try{const e=await this.getFileId(vw);if(!e)return null;const r=await ms(),n=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{headers:{Authorization:`Bearer ${r}`}});if(!n.ok)throw new Error(`Failed to download plans: ${n.statusText}`);const a=await n.text();return JSON.parse(a)}catch(e){throw console.error("Error pulling plans from Google Drive:",e),e}}async push(e){try{const r=await ms(),n=await this.getAppFolder(),a=await this.getFileId(vw),s=JSON.stringify(e,null,2),i=new Blob([s],{type:"application/json"});if(a){const l=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${a}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:i});if(!l.ok)throw new Error(`Failed to update plans file: ${l.statusText}`)}else{const l={name:vw,parents:[n],mimeType:"application/json"},c=new FormData;c.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),c.append("file",i);const d=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${r}`},body:c});if(!d.ok)throw new Error(`Failed to create plans file: ${d.statusText}`)}console.log(` Pushed ${e.length} plans to Google Drive`)}catch(r){throw console.error("Error pushing plans to Google Drive:",r),r}}async getLocalData(){return await Pl.getAllPlans()}async setLocalData(e){await Pl.replacePlans(e)}async getLastModified(){const e=await this.getLocalData();return e.length===0?0:Math.max(...e.map(r=>r.timestamp))}async shouldSync(){try{const e=localStorage.getItem("google_access_token");return e?(await fetch("https://www.googleapis.com/drive/v3/about?fields=user",{headers:{Authorization:`Bearer ${e}`}})).ok:!1}catch(e){return console.error("Error checking if plans should sync:",e),!1}}mergeData(e,r){return Pl.mergePlans(e,r)}}const Rbe=new Ibe,W3="Research Agent",ww="saved_playlists.json";let Fd=null;class Dbe{name="playlists";enabled=!0;async getAppFolder(){if(Fd)return Fd;const e=await Yn.ensureValidToken();if(!e)throw new Error("Failed to get Google auth token for playlists sync");const r=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${W3}' and mimeType='application/vnd.google-apps.folder' and trashed=false`,{headers:{Authorization:`Bearer ${e}`}});if(!r.ok)throw new Error(`Failed to search for app folder: ${r.statusText}`);const n=await r.json();if(n.files&&n.files.length>0)return Fd=n.files[0].id,Fd;const a=await fetch("https://www.googleapis.com/drive/v3/files",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({name:W3,mimeType:"application/vnd.google-apps.folder"})});if(!a.ok)throw new Error(`Failed to create app folder: ${a.statusText}`);return Fd=(await a.json()).id,Fd}async getFileId(e){const r=await Yn.ensureValidToken();if(!r)throw new Error("Failed to get Google auth token for playlists sync");const n=await this.getAppFolder(),a=await fetch(`https://www.googleapis.com/drive/v3/files?q=name='${e}' and '${n}' in parents and trashed=false`,{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`Failed to search for file: ${a.statusText}`);const s=await a.json();return s.files&&s.files.length>0?s.files[0].id:null}async pull(){try{const e=await this.getFileId(ww);if(!e)return null;const r=await Yn.ensureValidToken();if(!r)throw new Error("Failed to get Google auth token for playlists sync");const n=await fetch(`https://www.googleapis.com/drive/v3/files/${e}?alt=media`,{headers:{Authorization:`Bearer ${r}`}});if(!n.ok)throw new Error(`Failed to download playlists: ${n.statusText}`);const a=await n.text();return JSON.parse(a)}catch(e){throw console.error("Error pulling playlists from Google Drive:",e),e}}async push(e){try{const r=await Yn.ensureValidToken();if(!r)throw new Error("Failed to get Google auth token for playlists sync");const n=await this.getAppFolder(),a=await this.getFileId(ww),s=JSON.stringify(e,null,2),i=new Blob([s],{type:"application/json"});if(a){const l=await fetch(`https://www.googleapis.com/upload/drive/v3/files/${a}?uploadType=media`,{method:"PATCH",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:i});if(!l.ok)throw new Error(`Failed to update playlists file: ${l.statusText}`)}else{const l={name:ww,parents:[n],mimeType:"application/json"},c=new FormData;c.append("metadata",new Blob([JSON.stringify(l)],{type:"application/json"})),c.append("file",i);const d=await fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart",{method:"POST",headers:{Authorization:`Bearer ${r}`},body:c});if(!d.ok)throw new Error(`Failed to create playlists file: ${d.statusText}`)}console.log(` Pushed ${e.length} playlists to Google Drive`)}catch(r){throw console.error("Error pushing playlists to Google Drive:",r),r}}async getLocalData(){return await ni.init(),await ni.exportAllPlaylists()}async setLocalData(e){await ni.init(),await ni.importAndMergePlaylists(e)}async getLastModified(){const e=await this.getLocalData();return e.length===0?0:Math.max(...e.map(r=>r.updatedAt||r.createdAt||0))}async shouldSync(){try{const e=localStorage.getItem("google_access_token");return e?(await fetch("https://www.googleapis.com/drive/v3/about?fields=user",{headers:{Authorization:`Bearer ${e}`}})).ok:!1}catch(e){return console.error("Error checking if playlists should sync:",e),!1}}mergeData(e,r){const n=new Map;return e.forEach(a=>{const s=a.name.trim().toLowerCase();n.set(s,a)}),r.forEach(a=>{const s=a.name.trim().toLowerCase(),i=n.get(s),l=a.updatedAt||a.createdAt||0,c=i&&(i.updatedAt||i.createdAt)||0;(!i||l>c)&&n.set(s,a)}),Array.from(n.values())}}const Lbe=new Dbe,Mbe=N.createContext(void 0);function Obe({children:t}){const[e,r]=N.useState(Ha.getStatus());N.useEffect(()=>{const i=Ha.onStatusChange(l=>{r(l)});return()=>{i()}},[]);const n=async()=>{await Ha.syncAll()},a=i=>{Ha.setAdapterEnabled(i,!0)},s=i=>{Ha.setAdapterEnabled(i,!1)};return u.jsx(Mbe.Provider,{value:{syncStatus:e,manualSync:n,enableAdapter:a,disableAdapter:s},children:t})}const kj={maxConcurrentAgents:3,maxQueuedAgents:10,maxIterationsPerAgent:10,maxMemoryPerAgent:200,maxTotalMemory:600},Tj=150,Cj=.7;function jbe(t,e,r,n){const a=e.length>0?typeof e[0].content=="string"?e[0].content:JSON.stringify(e[0].content):r;return{id:crypto.randomUUID(),chatId:t,status:"idle",phase:"waiting",messages:e,currentInput:r,iterationCount:0,maxIterations:10,startTime:Date.now(),lastUpdateTime:Date.now(),estimatedMemoryUsage:0,tokenCount:0,toolCallsCount:0,retryCount:0,title:n||a.slice(0,50),createdAt:Date.now()}}function Ej(t){let e=50;return e+=t.messages.length*5/1024,t.phase==="streaming"&&(e+=20),e+=t.toolCallsCount*10,Math.round(e)}function _j(t){const e=Math.floor(t/1e3),r=Math.floor(e/60),n=Math.floor(r/60);return n>0?`${n}h ${r%60}m`:r>0?`${r}m ${e%60}s`:`${e}s`}const Bbe=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_AGENT_LIMITS:kj,MEMORY_PER_AGENT:Tj,SAFETY_MARGIN:Cj,createAgentState:jbe,estimateAgentMemory:Ej,formatDuration:_j},Symbol.toStringTag,{value:"Module"})),Fbe="AgentManagerDB",Gi="agents",zbe=1;class $be{dbPromise=null;async getDB(){return this.dbPromise||(this.dbPromise=Dy(Fbe,zbe,{upgrade(e){if(!e.objectStoreNames.contains(Gi)){const r=e.createObjectStore(Gi,{keyPath:"id"});r.createIndex("status","status"),r.createIndex("chatId","chatId"),r.createIndex("createdAt","createdAt"),r.createIndex("completedAt","completedAt")}}})),this.dbPromise}async saveAgent(e){try{await(await this.getDB()).put(Gi,e),this.backupToLocalStorage(e)}catch(r){throw console.error("Failed to save agent to IndexedDB:",r),r}}async getAgent(e){try{return await(await this.getDB()).get(Gi,e)||null}catch(r){return console.error("Failed to get agent from IndexedDB:",r),null}}async getAllAgents(){try{return(await(await this.getDB()).getAll(Gi)).sort((n,a)=>a.createdAt-n.createdAt)}catch(e){return console.error("Failed to get all agents from IndexedDB:",e),[]}}async getRunningAgents(){try{return await(await this.getDB()).transaction(Gi).store.index("status").getAll("running")}catch(e){return console.error("Failed to get running agents from IndexedDB:",e),[]}}async getQueuedAgents(){try{return await(await this.getDB()).transaction(Gi).store.index("status").getAll("queued")}catch(e){return console.error("Failed to get queued agents from IndexedDB:",e),[]}}async getCompletedAgents(){try{return(await(await this.getDB()).transaction(Gi).store.index("status").getAll("completed")).sort((a,s)=>(s.completedAt||0)-(a.completedAt||0))}catch(e){return console.error("Failed to get completed agents from IndexedDB:",e),[]}}async getFailedAgents(){try{return(await(await this.getDB()).getAll(Gi)).filter(n=>n.status==="error"||n.status==="aborted").sort((n,a)=>a.lastUpdateTime-n.lastUpdateTime)}catch(e){return console.error("Failed to get failed agents from IndexedDB:",e),[]}}async deleteAgent(e){try{await(await this.getDB()).delete(Gi,e),localStorage.removeItem(`agent_backup_${e}`)}catch(r){throw console.error("Failed to delete agent from IndexedDB:",r),r}}async updateAgentStatus(e,r){try{const n=await this.getAgent(e);n&&(n.status=r,n.lastUpdateTime=Date.now(),r==="completed"&&(n.completedAt=Date.now()),await this.saveAgent(n))}catch(n){throw console.error("Failed to update agent status:",n),n}}async clearCompletedAgents(){try{const e=await this.getCompletedAgents(),n=(await this.getDB()).transaction(Gi,"readwrite");await Promise.all([...e.map(a=>n.store.delete(a.id)),n.done]),e.forEach(a=>{localStorage.removeItem(`agent_backup_${a.id}`)})}catch(e){throw console.error("Failed to clear completed agents:",e),e}}async clearAllAgents(){try{await(await this.getDB()).clear(Gi),Object.keys(localStorage).forEach(n=>{n.startsWith("agent_backup_")&&localStorage.removeItem(n)})}catch(e){throw console.error("Failed to clear all agents:",e),e}}backupToLocalStorage(e){try{const r={id:e.id,chatId:e.chatId,status:e.status,lastUpdateTime:e.lastUpdateTime,title:e.title};localStorage.setItem(`agent_backup_${e.id}`,JSON.stringify(r))}catch(r){console.warn("Failed to backup agent to localStorage:",r)}}}const On=new $be;async function Ube(){const t=await On.getAllAgents(),e=Date.now(),r=3e4;return t.filter(n=>n.status==="running"&&e-n.lastUpdateTime>r)}function Aj(){if("memory"in performance&&performance.memory){const t=performance.memory,e=t.jsHeapSizeLimit/(1024*1024),r=t.usedJSHeapSize/(1024*1024),n=e-r;return{totalMemory:e,usedMemory:r,availableMemory:n,jsHeapLimit:e,isLowMemory:n/e<.2}}return{totalMemory:2048,usedMemory:512,availableMemory:1536,jsHeapLimit:2048,isLowMemory:!1}}function Nj(t){const e=Math.floor(t.availableMemory*Cj/Tj);return Math.max(1,Math.min(5,e))}function qbe(t,e,r,n){return t.iterationCount>=e.maxIterationsPerAgent?(t.status="error",t.lastError=`Exceeded max iterations (${e.maxIterationsPerAgent})`,{canProceed:!1,reason:t.lastError}):t.estimatedMemoryUsage>e.maxMemoryPerAgent?(t.status="error",t.lastError=`Exceeded memory limit (${e.maxMemoryPerAgent}MB)`,{canProceed:!1,reason:t.lastError}):r>=e.maxConcurrentAgents?{canProceed:!1,reason:"Max concurrent agents reached - queueing"}:n>=e.maxQueuedAgents?(t.status="error",t.lastError=`Queue full (${e.maxQueuedAgents} agents)`,{canProceed:!1,reason:t.lastError}):{canProceed:!0}}function Hbe(){const t=Aj(),e=Nj(t);return{...kj,maxConcurrentAgents:e}}function kve(t){return t.availableMemory<200?{level:"critical",message:`Critical: Only ${Math.round(t.availableMemory)}MB available. Consider closing tabs or reloading.`}:t.isLowMemory?{level:"warning",message:`Warning: Low memory detected (${Math.round(t.availableMemory)}MB available). New agents may be paused.`}:{level:"ok"}}class Gbe{runningAgents=new Map;queuedAgents=[];limits;listeners=new Map;executionCallback=null;constructor(e){this.limits=e||Hbe()}setExecutionCallback(e){this.executionCallback=e}on(e,r){this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(r)}off(e,r){const n=this.listeners.get(e);n&&n.delete(r)}emit(e,r){const n=this.listeners.get(e);n&&n.forEach(a=>a(r))}async enqueue(e){e.estimatedMemoryUsage=Ej(e);const r=qbe(e,this.limits,this.runningAgents.size,this.queuedAgents.length);if(!r.canProceed){if(e.status==="error")throw await On.saveAgent(e),this.emit("agent-error",e),new Error(r.reason);e.status="queued",this.queuedAgents.push(e),await On.saveAgent(e),this.emit("agent-queued",e),this.emit("queue-updated",e);return}await this.startAgent(e)}async startAgent(e){if(e.status="running",e.startTime=Date.now(),e.lastUpdateTime=Date.now(),this.runningAgents.set(e.id,e),await On.saveAgent(e),this.emit("agent-started",e),this.emit("queue-updated",e),this.executionCallback)try{await this.executionCallback(e)}catch(r){console.error("Agent execution error:",r),e.status="error",e.lastError=r.message,await On.saveAgent(e),this.emit("agent-error",e),this.runningAgents.delete(e.id),await this.dequeue()}}async completeAgent(e){const r=this.runningAgents.get(e);r&&(r.status="completed",r.completedAt=Date.now(),await On.saveAgent(r),this.runningAgents.delete(e),this.emit("agent-completed",r),this.emit("queue-updated",r),await this.dequeue())}async pauseAgent(e){const r=this.runningAgents.get(e);if(!r){const n=this.queuedAgents.findIndex(a=>a.id===e);if(n!==-1){const a=this.queuedAgents[n];a.status="paused",await On.saveAgent(a),this.queuedAgents.splice(n,1),this.emit("agent-paused",a),this.emit("queue-updated",a)}return}r.status="paused",await On.saveAgent(r),this.runningAgents.delete(e),this.emit("agent-paused",r),this.emit("queue-updated",r),await this.dequeue()}async abortAgent(e){const r=this.runningAgents.get(e);if(!r){const n=this.queuedAgents.findIndex(a=>a.id===e);if(n!==-1){const a=this.queuedAgents[n];a.status="aborted",await On.saveAgent(a),this.queuedAgents.splice(n,1),this.emit("agent-aborted",a),this.emit("queue-updated",a)}return}r.status="aborted",await On.saveAgent(r),this.runningAgents.delete(e),this.emit("agent-aborted",r),this.emit("queue-updated",r),await this.dequeue()}async resumeAgent(e){const r=await On.getAgent(e);!r||r.status!=="paused"||(r.status="idle",await this.enqueue(r))}async dequeue(){if(this.queuedAgents.length>0&&this.runningAgents.size<this.limits.maxConcurrentAgents){const e=this.queuedAgents.shift();await this.startAgent(e)}}updateMaxConcurrent(e){this.limits.maxConcurrentAgents=Math.max(1,Math.min(5,e)),this.dequeue()}async pauseQueue(){const e=[...this.queuedAgents];this.queuedAgents=[];for(const r of e)r.status="paused",await On.saveAgent(r),this.emit("agent-paused",r);this.emit("queue-updated",e[0]||{})}getStatus(){return{running:this.runningAgents.size,queued:this.queuedAgents.length,maxConcurrent:this.limits.maxConcurrentAgents,runningAgents:Array.from(this.runningAgents.values()),queuedAgents:[...this.queuedAgents]}}clear(){this.runningAgents.clear(),this.queuedAgents=[]}}const $o=new Gbe,Vbe=new URL("/assets/agent-worker-a1XFDa3h.ts",import.meta.url);function Wbe(){const t=N.useRef(new Map),e=5,[,r]=N.useState({}),n=N.useCallback(l=>{if(t.current.size>=e)throw new Error("Max concurrent workers reached. Please queue agent.");const c=new Worker(Vbe,{type:"module"});c.addEventListener("message",async p=>{const{type:g,payload:m}=p.data;try{switch(g){case"AGENT_UPDATE":m?.agent&&(await On.saveAgent(m.agent),window.dispatchEvent(new CustomEvent("agent-update",{detail:m.agent})));break;case"AGENT_COMPLETED":m?.agent&&(await On.saveAgent(m.agent),t.current.delete(m.agent.id),c.terminate(),await $o.completeAgent(m.agent.id),window.dispatchEvent(new CustomEvent("agent-completed",{detail:m.agent})),r({}));break;case"AGENT_ERROR":m?.agent&&(await On.saveAgent(m.agent),t.current.delete(m.agent.id),c.terminate(),window.dispatchEvent(new CustomEvent("agent-error",{detail:m.agent})),r({}));break;case"AGENT_ABORTED":m?.agent&&(await On.saveAgent(m.agent),t.current.delete(m.agent.id),c.terminate(),window.dispatchEvent(new CustomEvent("agent-aborted",{detail:m.agent})),r({}));break;case"AGENT_PAUSED":m?.agent&&(await On.saveAgent(m.agent),t.current.delete(m.agent.id),c.terminate(),window.dispatchEvent(new CustomEvent("agent-paused",{detail:m.agent})),r({}));break}}catch(y){console.error("Error handling worker message:",y)}}),c.addEventListener("error",p=>{console.error("Worker error:",p),t.current.delete(l.id),c.terminate(),l.status="error",l.lastError="Worker crashed: "+p.message,On.saveAgent(l),window.dispatchEvent(new CustomEvent("agent-error",{detail:l})),r({})});const d={type:"START_AGENT",payload:{agent:l}};c.postMessage(d),t.current.set(l.id,c),r({})},[e]),a=N.useCallback(l=>{const c=t.current.get(l);if(c){const d={type:"PAUSE_AGENT",payload:{agentId:l}};c.postMessage(d)}},[]),s=N.useCallback(l=>{const c=t.current.get(l);if(c){const d={type:"ABORT_AGENT",payload:{agentId:l}};c.postMessage(d)}},[]),i=N.useCallback(()=>{t.current.forEach(l=>{try{l.terminate()}catch(c){console.warn("Error terminating worker:",c)}}),t.current.clear(),r({})},[]);return N.useEffect(()=>i,[i]),{workers:t.current,maxWorkers:e,startAgent:n,pauseAgent:a,abortAgent:s,cleanup:i}}async function Ybe(t={}){const e=await Ube();return e.length===0?!1:(console.log(` Found ${e.length} interrupted agent(s)`,e),t.autoRecover?(await Pj(e.map(r=>r.id)),!0):t.autoDiscard?(await Ij(e.map(r=>r.id)),!0):(t.onInterruptedAgentsFound&&t.onInterruptedAgentsFound(e),!0))}async function Pj(t){const e=t.length;for(const r of t){const n=await On.getAgent(r);n&&(n.status="queued",n.retryCount+=1,n.lastUpdateTime=Date.now(),n.lastError=void 0,await On.saveAgent(n),window.dispatchEvent(new CustomEvent("agent-recovered",{detail:n})))}console.log(` Recovered ${e} agent(s)`)}async function Ij(t){const e=t.length;for(const r of t){const n=await On.getAgent(r);n&&(n.status="aborted",n.lastError="Discarded by user after interruption",n.lastUpdateTime=Date.now(),await On.saveAgent(n))}console.log(` Discarded ${e} agent(s)`)}const Qbe=({agents:t,onRecover:e,onDiscard:r,onClose:n})=>{const[a,s]=N.useState(new Set(t.map(m=>m.id))),i=m=>{const y=new Set(a);y.has(m)?y.delete(m):y.add(m),s(y)},l=()=>{s(new Set(t.map(m=>m.id)))},c=()=>{s(new Set)},d=()=>{e(Array.from(a)),n()},p=()=>{r(Array.from(a)),n()},g=()=>{r(t.map(m=>m.id)),n()};return u.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[u.jsxs("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("span",{className:"text-3xl",children:""}),u.jsx("h2",{className:"text-2xl font-bold dark:text-gray-100",children:"Recover Interrupted Agents"})]}),u.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"The following agents were interrupted when you closed the browser. Would you like to recover them?"})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-3",children:t.map(m=>{const y=Date.now()-m.lastUpdateTime;return u.jsx("div",{className:`border-2 rounded-lg p-4 cursor-pointer transition-all ${a.has(m.id)?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500"}`,onClick:()=>i(m.id),children:u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",checked:a.has(m.id),onChange:x=>{x.stopPropagation(),i(m.id)},className:"mt-1"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100 truncate mb-1",children:m.title}),u.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-600 dark:text-gray-400",children:[u.jsxs("div",{children:[" Iteration ",m.iterationCount,"/",m.maxIterations]}),u.jsxs("div",{children:[" ",m.messages.length," messages"]}),u.jsxs("div",{children:[" Interrupted ",_j(y)," ago"]})]}),m.lastError&&u.jsxs("div",{className:"mt-2 text-xs text-red-600 dark:text-red-400",children:[" Last error: ",m.lastError]})]})]})},m.id)})}),u.jsxs("div",{className:"px-6 py-3 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:l,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:"Select All"}),u.jsx("span",{className:"text-gray-400",children:""}),u.jsx("button",{onClick:c,className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300",children:"Select None"})]}),u.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[a.size," of ",t.length," selected"]})]}),u.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[u.jsxs("button",{onClick:d,disabled:a.size===0,className:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-medium rounded-lg transition-colors",children:[" Recover Selected (",a.size,")"]}),u.jsx("button",{onClick:p,disabled:a.size===0,className:"flex-1 px-6 py-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 disabled:bg-gray-100 dark:disabled:bg-gray-800 disabled:cursor-not-allowed text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors",children:" Discard Selected"}),u.jsx("button",{onClick:g,className:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors",children:"Discard All"})]})]})})},Rj=N.createContext(void 0),Kbe=({children:t})=>{const[e,r]=N.useState([]),[n,a]=N.useState([]),[s,i]=N.useState([]),[l,c]=N.useState(!1),[d,p]=N.useState(!1),[g,m]=N.useState([]),y=Wbe();N.useEffect(()=>{$o.setExecutionCallback(async $=>{try{y.startAgent($)}catch(Z){console.error("Failed to start agent in worker:",Z),$.status="error",$.lastError=Z instanceof Error?Z.message:"Failed to start worker",await On.saveAgent($)}})},[y]),N.useEffect(()=>{x()},[]),N.useEffect(()=>{const $=()=>{x()};return window.addEventListener("agent-update",$),window.addEventListener("agent-completed",$),window.addEventListener("agent-error",$),window.addEventListener("agent-paused",$),window.addEventListener("agent-aborted",$),window.addEventListener("agent-recovered",$),()=>{window.removeEventListener("agent-update",$),window.removeEventListener("agent-completed",$),window.removeEventListener("agent-error",$),window.removeEventListener("agent-paused",$),window.removeEventListener("agent-aborted",$),window.removeEventListener("agent-recovered",$)}},[]),N.useEffect(()=>{Ybe({onInterruptedAgentsFound:$=>{m($),p(!0)}})},[]),N.useEffect(()=>{const $=setInterval(()=>{const Z=Aj(),z=Nj(Z);$o.updateMaxConcurrent(z),Z.isLowMemory&&(console.warn(" Low memory detected - pausing queue"),$o.pauseQueue())},1e4);return()=>clearInterval($)},[]);const x=async()=>{const $=await On.getAllAgents(),Z=await On.getRunningAgents(),z=await On.getQueuedAgents();i($),r(Z),a(z)},w=N.useCallback(async($,Z,z,ee)=>{const{createAgentState:te}=await Zt(async()=>{const{createAgentState:Q}=await Promise.resolve().then(()=>Bbe);return{createAgentState:Q}},void 0),X=te($,Z,z,ee);return await On.saveAgent(X),X},[]),T=N.useCallback(async $=>{await $o.enqueue($),await x()},[]),k=N.useCallback(async $=>{await $o.pauseAgent($),y.pauseAgent($),await x()},[y]),_=N.useCallback(async $=>{await $o.resumeAgent($),await x()},[]),P=N.useCallback(async $=>{await $o.abortAgent($),y.abortAgent($),await x()},[y]),F=N.useCallback(async $=>{const Z=await On.getAgent($);Z&&(Z.status="idle",Z.retryCount+=1,Z.lastError=void 0,await $o.enqueue(Z),await x())},[]),D=N.useCallback(async $=>{await Pj($),p(!1);for(const Z of $){const z=await On.getAgent(Z);z&&z.status==="queued"&&await $o.enqueue(z)}await x()},[]),B=N.useCallback(async $=>{await Ij($),p(!1),await x()},[]),M={createAgent:w,startAgent:T,pauseAgent:k,resumeAgent:_,abortAgent:P,retryAgent:F,runningAgents:e,queuedAgents:n,allAgents:s,showAgentManager:l,setShowAgentManager:c};return u.jsxs(Rj.Provider,{value:M,children:[t,d&&g.length>0&&u.jsx(Qbe,{agents:g,onRecover:D,onDiscard:B,onClose:()=>p(!1)})]})},Dj=()=>{const t=N.useContext(Rj);if(!t)throw new Error("useAgents must be used within an AgentProvider");return t},Xbe=()=>{const{runningAgents:t,queuedAgents:e,setShowAgentManager:r}=Dj();return t.length+e.length===0?null:u.jsxs("button",{onClick:()=>r(!0),className:"flex items-center gap-2 px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors shadow-md",title:"View agent manager",children:[u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"text-lg",children:""}),t.length>0&&u.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[u.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),u.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]})]}),u.jsx("div",{className:"flex flex-col items-start text-xs",children:u.jsxs("span",{className:"font-medium",children:[t.length>0&&u.jsxs("span",{className:"text-green-200",children:[t.length," running"]}),t.length>0&&e.length>0&&u.jsx("span",{className:"mx-1",children:""}),e.length>0&&u.jsxs("span",{className:"text-yellow-200",children:[e.length," queued"]})]})})]})};function Jbe({isOpen:t,onClose:e}){const{t:r}=Lc(),{projects:n,currentProject:a,createProject:s,deleteProject:i,selectProject:l,clearProject:c}=ef(),[d,p]=N.useState(""),[g,m]=N.useState(!1),[y,x]=N.useState(null),[w,T]=N.useState(null);N.useEffect(()=>{const D=B=>{B.key==="Escape"&&e()};if(t)return document.addEventListener("keydown",D),()=>document.removeEventListener("keydown",D)},[t,e]);const k=async D=>{D.preventDefault(),T(null);const B=d.trim();if(!B){T(r("projects.errors.emptyName","Project name cannot be empty"));return}if(n.some(M=>M.name.toLowerCase()===B.toLowerCase())){T(r("projects.errors.duplicateName","A project with this name already exists"));return}m(!0);try{await s(B),p(""),T(null),e()}catch(M){T(M instanceof Error?M.message:r("projects.errors.createFailed","Failed to create project"))}finally{m(!1)}},_=async D=>{if(y===D)try{await i(D),x(null)}catch(B){T(B instanceof Error?B.message:r("projects.errors.deleteFailed","Failed to delete project"))}else x(D),setTimeout(()=>x(null),3e3)},P=async D=>{D?await l(D.id):await c(),e()},F=D=>{p(D.target.value),w&&T(null)};return t?u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,role:"dialog","aria-modal":"true","aria-labelledby":"project-dialog-title",children:u.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[80vh] overflow-hidden flex flex-col",onClick:D=>D.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("h2",{id:"project-dialog-title",className:"text-xl font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[u.jsx(yI,{className:"w-5 h-5"}),r("projects.selectProject","Select Project")]}),u.jsx("button",{onClick:e,className:`text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 
                       focus:outline-none focus:ring-2 focus:ring-blue-500 rounded-lg p-1`,"aria-label":r("common.close","Close"),children:u.jsx(n0,{className:"w-5 h-5"})})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:[u.jsxs("div",{className:"space-y-2 mb-6",children:[u.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors
                ${a?"hover:bg-gray-100 dark:hover:bg-gray-700 border-2 border-transparent":"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-500"}`,children:[u.jsx("input",{type:"radio",name:"project",checked:!a,onChange:()=>P(null),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),u.jsx("span",{className:"flex-1 font-medium text-gray-900 dark:text-white",children:r("projects.default","Default")})]}),n.map(D=>u.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg transition-colors
                  ${a?.id===D.id?"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-500":"hover:bg-gray-100 dark:hover:bg-gray-700 border-2 border-transparent"}`,children:[u.jsxs("label",{className:"flex items-center gap-3 flex-1 cursor-pointer",children:[u.jsx("input",{type:"radio",name:"project",checked:a?.id===D.id,onChange:()=>P(D),className:"w-4 h-4 text-blue-600 focus:ring-blue-500"}),u.jsx("span",{className:"flex-1 text-gray-900 dark:text-white",children:D.name})]}),u.jsx("button",{onClick:()=>_(D.id),className:`p-2 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-red-500
                    ${y===D.id?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"text-gray-400 hover:text-red-600 dark:hover:text-red-400"}`,title:y===D.id?r("projects.confirmDelete","Click again to confirm"):r("projects.delete","Delete project"),"aria-label":y===D.id?r("projects.confirmDelete","Click again to confirm"):r("projects.delete","Delete project"),children:u.jsx(OH,{className:"w-4 h-4"})})]},D.id))]}),u.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:u.jsxs("form",{onSubmit:k,className:"space-y-3",children:[u.jsxs("label",{className:"block",children:[u.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r("projects.createNew","Create New Project")}),u.jsxs("div",{className:"flex gap-2 mt-1",children:[u.jsx("input",{type:"text",value:d,onChange:F,placeholder:r("projects.namePlaceholder","Project name..."),className:`flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg
                             bg-white dark:bg-gray-700 text-gray-900 dark:text-white
                             placeholder-gray-400 dark:placeholder-gray-500
                             focus:outline-none focus:ring-2 focus:ring-blue-500`,disabled:g}),u.jsxs("button",{type:"submit",disabled:g||!d.trim(),className:`px-4 py-2 bg-blue-600 text-white rounded-lg
                             hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500
                             disabled:opacity-50 disabled:cursor-not-allowed
                             transition-colors duration-200 flex items-center gap-2`,"aria-label":r("projects.create","Create"),children:[u.jsx(EH,{className:"w-4 h-4"}),r("projects.create","Create")]})]})]}),w&&u.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",role:"alert",children:w})]})})]}),u.jsx("div",{className:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/50",children:u.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:r("projects.description","Projects help organize your content, chats, quizzes, and feed.")})})]})}):null}function Zbe(){const{t}=Lc(),{currentProject:e}=ef(),[r,n]=N.useState(!1),a=l=>{l.preventDefault(),n(!0)},s=()=>{n(!1)},i=e?.name||t("projects.default","Default");return u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:a,className:`flex items-center justify-center p-2 text-gray-700 dark:text-gray-200 
                   bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 
                   rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 
                   focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
                   transition-colors duration-200`,title:`${t("projects.selectProject","Select Project")}: ${i}`,"aria-label":`${t("projects.selectProject","Select Project")}: ${i}`,children:u.jsx(yI,{className:"w-5 h-5"})}),r&&u.jsx(Jbe,{isOpen:r,onClose:s})]})}const exe=N.lazy(()=>Zt(()=>import("./SettingsPage-DksCBMEA.js"),__vite__mapDeps([53,54,55])).then(t=>({default:t.SettingsPage}))),txe=N.lazy(()=>Zt(()=>import("./PlanningPage-BEXHj2o8.js"),[]).then(t=>({default:t.PlanningPage}))),rxe=N.lazy(()=>Zt(()=>import("./SwagPage-CtvlMrME.js"),__vite__mapDeps([56,57,58,59,60])).then(t=>({default:t.SwagPage}))),nxe=N.lazy(()=>Zt(()=>import("./SnippetViewPage-DJrasvNm.js"),__vite__mapDeps([61,57,58,62]))),axe=N.lazy(()=>Zt(()=>import("./QuizPage-Dtz7OxHe.js"),__vite__mapDeps([63,59,64,65,54]))),sxe=N.lazy(()=>Zt(()=>import("./FeedPage-2v1a6a1L.js"),__vite__mapDeps([66,65,62,67]))),ixe=N.lazy(()=>Zt(()=>import("./BillingPage-BfgKwe7t.js"),__vite__mapDeps([68,69]))),Y3=N.lazy(()=>Zt(()=>import("./HelpPage-DOnISI7J.js"),[]).then(t=>({default:t.HelpPage}))),Q3=N.lazy(()=>Zt(()=>import("./PrivacyPolicy-DVldmGyn.js"),[]).then(t=>({default:t.PrivacyPolicy}))),K3=N.lazy(()=>Zt(()=>import("./SharedSnippetViewer-AmHNZvhg.js"),[]).then(t=>({default:t.SharedSnippetViewer}))),oxe=N.lazy(()=>Zt(()=>import("./SharedChatViewer-BUCkc-XG.js"),[]).then(t=>({default:t.SharedChatViewer}))),X3=N.lazy(()=>Zt(()=>import("./SharedFeedItemViewer-DWanZhm-.js"),[]).then(t=>({default:t.SharedFeedItemViewer}))),J3=N.lazy(()=>Zt(()=>import("./SharedQuizViewer-Ba5g4Ah1.js"),__vite__mapDeps([70,64]))),lxe=N.lazy(()=>Zt(()=>import("./ImageEditorPage-DNSV5qaZ.js"),[]).then(t=>({default:t.ImageEditorPage}))),cxe=N.lazy(()=>Zt(()=>import("./AgentManager-BoD8ha8z.js"),[]).then(t=>({default:t.AgentManager}))),uxe=N.lazy(()=>Zt(()=>import("./MusicPage-BwSIXG5o.js"),__vite__mapDeps([71,67]))),Z3=()=>u.jsx("div",{className:"flex items-center justify-center h-full",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 dark:border-blue-400"}),u.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading..."})]})});function dxe(){const{isAuthenticated:t,getToken:e,user:r}=oi(),{settings:n}=vo(),{usage:a,loading:s}=My(),{showAgentManager:i,setShowAgentManager:l}=Dj(),{features:c}=Oq(),{i18n:d}=Lc(),p=Xi(),g=xo(),m=N.useRef(null),[y,x]=N.useState(!1),[w,T]=N.useState(!1),[k,_]=N.useState(!1),[P,F]=N.useState(!1),[D,B]=N.useState(!1),[M,$]=N.useState(null),[Z,z]=N.useState(!1),[ee,te]=N.useState(!1),[X,Q]=N.useState(!1);N.useEffect(()=>{Yn.init().catch(fe=>{console.warn(" Failed to initialize Google Auth:",fe)})},[]),N.useEffect(()=>{console.log(" Route changed to:",g.pathname)},[g.pathname]),N.useEffect(()=>{console.log(" showWelcomeWizard changed to:",ee)},[ee]),N.useEffect(()=>{if(Ha.registerAdapter(Rbe),Ha.registerAdapter(Lbe),!t){console.log(" User not authenticated, unified sync disabled");return}return localStorage.getItem("auto_sync_enabled")!=="false"?(Ha.start(300*1e3),console.log(" Unified sync started (plans, playlists) - Google Drive sync handled separately")):console.log(" Auto-sync disabled by user"),()=>{Ha.stop()}},[t]),N.useEffect(()=>{(async()=>{try{await tq(),console.log(" Google API initialized")}catch(Ne){console.warn(" Google API initialization failed:",Ne)}})()},[]),N.useEffect(()=>{n?.language&&d.language!==n.language&&d.changeLanguage(n.language);const fe=["ar","he","fa"].includes(d.language)?"rtl":"ltr";document.documentElement.dir=fe,document.documentElement.lang=d.language},[n?.language,d]),N.useEffect(()=>{const fe=Ne=>{(Ne.ctrlKey&&Ne.key==="k"||Ne.key==="?")&&(Ne.preventDefault(),Q(!0))};return window.addEventListener("keydown",fe),()=>window.removeEventListener("keydown",fe)},[]),N.useEffect(()=>{z(!1)},[g.pathname]);const W=fe=>{console.log("handleNavigate called:",{path:fe,isChatLoading:P,currentPath:g.pathname}),P&&g.pathname==="/"?(console.log("Showing navigation warning (chat is loading)"),$(fe),B(!0)):(console.log("Navigating to:",fe),p(fe))},H=()=>{B(!1),M&&p(M),$(null)},re=()=>{B(!1),$(null)};N.useEffect(()=>{!P&&D&&(B(!1),$(null))},[P,D]);const ne=()=>{try{const fe=Pw();if(fe){const Te=`user:${fe}:chat_enabled_tools`,se=localStorage.getItem(Te);if(se)return console.log(" Found existing tool settings for user:",fe),JSON.parse(se)}const Ne=localStorage.getItem("chat_enabled_tools");if(Ne)return console.log(" Found legacy tool settings, will migrate to user-scoped"),JSON.parse(Ne)}catch(fe){console.error("Error loading initial tool settings:",fe)}return console.log(" No saved tool settings found, using defaults"),{web_search:!0,execute_js:!1,scrape_url:!0,youtube:!0,transcribe:!0,generate_chart:!0,generate_image:!0,search_knowledge_base:!1,manage_todos:!1,manage_snippets:!0,ask_llm:!1,generate_reasoning_chain:!1}},[ve,O]=go("chat_enabled_tools",ne());N.useEffect(()=>{console.log(" App.tsx enabledTools state:",ve)},[ve]),N.useEffect(()=>{if(r?.email&&m.current!==r.email){console.log(" User authenticated, reloading enabled tools from user-scoped storage"),m.current=r.email;const fe=`user:${r.email}:chat_enabled_tools`,Ne=localStorage.getItem(fe);if(Ne)try{const Te=JSON.parse(Ne);console.log(" Reloaded user-scoped enabled tools:",Te),O(Te)}catch(Te){console.error("Failed to parse user-scoped enabled tools:",Te)}else console.log(" No user-scoped enabled tools found, using defaults")}},[r?.email]),N.useEffect(()=>{const fe=Ne=>{if(P&&g.pathname==="/chat")return Ne.preventDefault(),Ne.returnValue="",""};return window.addEventListener("beforeunload",fe),()=>window.removeEventListener("beforeunload",fe)},[P,g.pathname]),N.useEffect(()=>{(async()=>{try{console.log("Starting migration from localStorage to IndexedDB...");const Ne=await _i.migrateFromLocalStorage();console.log(`Migration complete: ${Ne} chats migrated`),await _i.cleanupOldChats(100),console.log("Cleanup complete: kept 100 most recent chats")}catch(Ne){console.error("Error during migration:",Ne)}})()},[]),N.useEffect(()=>{(async()=>{if(!(!t||!r?.email))try{const{migrateFromLocalStorage:Ne}=await Zt(async()=>{const{migrateFromLocalStorage:Te}=await import("./migrateFromLocalStorage-Dun7rKDl.js");return{migrateFromLocalStorage:Te}},[]);console.log(" Starting unified settings migration for user:",r.email),await Ne(r.email),console.log(" Settings migration complete")}catch(Ne){console.error(" Error during settings migration:",Ne)}})()},[t,r?.email]),N.useEffect(()=>{const fe="548179877633-cfvhlc5roj9prus33jlarcm540i495qi.apps.googleusercontent.com";if(window.google)zw(fe);else{const Ne=setInterval(()=>{window.google&&(zw(fe),clearInterval(Ne))},100);setTimeout(()=>clearInterval(Ne),5e3)}},[]),N.useEffect(()=>{t&&!k&&(async()=>{if(!t){_(!0);return}try{const Ne=await e();if(!Ne){_(!0);return}_(!0);const Te=await dn(),se=await fetch(`${Te}/chat`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Ne}`},body:JSON.stringify({messages:[{role:"user",content:"test"}],providers:n?.providers||[]})});se.status===403&&(await se.json()).requiresProviderSetup&&(console.log(" User needs to configure providers"),T(!0))}catch{console.log("Unable to verify provider setup status (this is not critical)")}})()},[t,e,n?.providers,k]),N.useEffect(()=>{},[k,t]),N.useEffect(()=>{const fe=()=>{console.log(" Received show-welcome-wizard event, setting showWelcomeWizard to true"),te(Ne=>(console.log(" State update function called, prev:",Ne,"new: true"),!0))};return window.addEventListener("show-welcome-wizard",fe),()=>window.removeEventListener("show-welcome-wizard",fe)},[]);const I=new URLSearchParams(g.search).has("share"),K=g.hash.includes("/chat/shared"),U=g.pathname.startsWith("/feed/share/"),ce=g.hash.includes("/quiz/shared"),ye=g.pathname.startsWith("/snippet/shared")||g.hash.includes("/snippet/shared")||g.pathname==="/privacy"||g.pathname==="/help"||I||K||U||ce;if(N.useEffect(()=>{console.log(" Public route detection:",{pathname:g.pathname,search:g.search,hash:g.hash,hasShareParam:I,isChatShared:K,isFeedShared:U,isQuizShared:ce,isPublicRoute:ye})},[g.pathname,g.search,g.hash,I,K,U,ce,ye]),ye)return u.jsxs(u.Fragment,{children:[u.jsx(N.Suspense,{fallback:u.jsx(Z3,{}),children:g.pathname.startsWith("/snippet/shared")||g.hash.includes("/snippet/shared")?u.jsx(K3,{}):I||K?u.jsx(oxe,{}):U?u.jsx(X3,{}):ce?u.jsx(J3,{}):g.pathname==="/privacy"?u.jsx(Q3,{}):g.pathname==="/help"?u.jsx(Y3,{}):null}),t&&u.jsx(G3,{isOpen:ee,onClose:()=>te(!1)})]});if(!t)return u.jsx(Bq,{});if(!k)return u.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-900",children:u.jsx("div",{className:"text-white text-xl",children:"Loading..."})});const Ae=a?.exceeded||!1;return w||Ae?u.jsx(Sbe,{isBlocked:w||Ae,onUnblock:()=>T(!1)}):u.jsxs("div",{className:"flex flex-col min-h-screen bg-white dark:bg-gray-900",children:[u.jsx("a",{href:"#main-content",className:"sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 focus:z-50 focus:p-4 focus:bg-blue-600 focus:text-white focus:rounded-br-lg focus:shadow-lg",children:"Skip to main content"}),u.jsxs("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:[u.jsxs("div",{className:"flex justify-between items-center px-0 md:px-4 py-3 w-full md:max-w-screen-2xl md:mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>W("/chat"),className:"hover:opacity-80 transition-opacity",title:"Go to Chat","aria-label":"Go to Chat",children:u.jsx("img",{src:"/agent.png",alt:"Research Agent",className:"h-10 sm:h-12 w-auto object-contain"})}),u.jsx(Zbe,{})]}),u.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[u.jsx(zq,{}),g.pathname!=="/billing"&&u.jsxs("button",{onClick:()=>{console.log("Billing button clicked, navigating to /billing"),W("/billing")},className:"flex items-center gap-2 px-3 py-2 rounded-lg transition-colors shadow-sm font-medium bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 min-h-11 touch-target select-none",title:a?`You have $${a.creditBalance.toFixed(2)} remaining of $${a.totalCredits.toFixed(2)} total credits`:"View billing and usage details","aria-label":"Billing and credits",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),a&&!s&&typeof a.creditBalance=="number"&&typeof a.totalCredits=="number"&&u.jsxs("span",{className:`text-xs font-medium select-none ${a.exceeded?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:["$",a.creditBalance.toFixed(2)," / $",a.totalCredits.toFixed(2)]})]}),(g.pathname==="/help"||g.pathname==="/privacy")&&u.jsxs("button",{onClick:()=>p("/chat"),className:"flex items-center gap-2 p-2 md:px-3 md:py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors shadow-sm font-medium min-h-11 touch-target",title:"Back to Chat","aria-label":"Back to Chat",children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",strokeWidth:2.5,viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),u.jsx("span",{className:"text-sm hidden md:inline",children:"Back"})]}),u.jsx(Xbe,{}),u.jsx(u_,{})]}),u.jsxs("div",{className:"flex md:hidden items-center gap-2",children:[g.pathname!=="/billing"&&a&&!s&&typeof a.creditBalance=="number"&&u.jsxs("div",{className:`text-xs font-medium px-2 py-1 rounded ${a.exceeded?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20":"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20"}`,children:["$",a.creditBalance.toFixed(2)]}),(g.pathname==="/help"||g.pathname==="/privacy")&&u.jsxs("button",{onClick:()=>W("/chat"),className:"px-3 py-2 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 rounded-lg transition-colors flex items-center gap-2",title:"Back to Chat","aria-label":"Back to Chat",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-700 dark:text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),u.jsx("span",{className:"hidden md:inline text-sm font-medium text-gray-700 dark:text-gray-300",children:"Back"})]}),u.jsx("button",{onClick:()=>z(!Z),className:"icon-button","aria-label":Z?"Close menu":"Open menu","aria-expanded":Z,children:Z?u.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):u.jsx("svg",{className:"w-6 h-6 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),Z&&u.jsx("nav",{className:"md:hidden border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",role:"navigation","aria-label":"Mobile navigation",children:u.jsxs("div",{className:"px-4 py-2 space-y-1",children:[g.pathname!=="/"&&u.jsxs("button",{onClick:()=>{p("/"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Feed"})]}),g.pathname!=="/chat"&&u.jsxs("button",{onClick:()=>{p("/chat"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Chat"})]}),g.pathname!=="/billing"&&u.jsxs("button",{onClick:()=>{W("/billing"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Billing"}),a&&!s&&typeof a.creditBalance=="number"&&typeof a.totalCredits=="number"&&u.jsxs("div",{className:`text-xs ${a.exceeded?"text-red-600 dark:text-red-400":"text-green-600 dark:text-green-400"}`,children:["$",a.creditBalance.toFixed(2)," / $",a.totalCredits.toFixed(2)]})]})]}),g.pathname!=="/swag"&&u.jsxs("button",{onClick:()=>{W("/swag"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{d:"M8 2C8 1.45 8.45 1 9 1h6c.55 0 1 .45 1 1v2h-8V2zm-1 4h10l1.5 13c.08.72-.48 1.32-1.2 1.32H6.7c-.72 0-1.28-.6-1.2-1.32L7 6zm5 2c-2.21 0-4 1.79-4 4v6h8v-6c0-2.21-1.79-4-4-4z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Swag"})]}),c?.imageEditing&&u.jsxs("button",{onClick:()=>{W("/image-editor"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Image Editor"})]}),g.pathname!=="/music"&&u.jsxs("button",{onClick:()=>{W("/music"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Music"})]}),u.jsxs("button",{onClick:()=>{W("/settings"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsxs("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Settings"})]}),u.jsxs("button",{onClick:()=>{W("/help"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Help"})]}),u.jsxs("button",{onClick:()=>{W("/privacy"),z(!1)},className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"Privacy Policy"})]}),u.jsxs("a",{href:"https://github.com/syntithenai/lambdallmproxy",target:"_blank",rel:"noopener noreferrer",onClick:()=>z(!1),className:"flex items-center gap-3 w-full px-4 py-3 rounded-lg transition-colors text-left touch-target hover:bg-gray-100 dark:hover:bg-gray-700",children:[u.jsx("svg",{className:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:u.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})}),u.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:"GitHub"})]}),u.jsx("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700",children:u.jsx(u_,{})})]})})]}),u.jsx(tbe,{}),u.jsx(aH,{}),u.jsx("main",{id:"main-content",className:"flex-1 overflow-y-auto pt-[73px]",children:u.jsx("div",{className:"min-h-full w-full md:max-w-screen-2xl md:mx-auto",children:u.jsx(N.Suspense,{fallback:u.jsx(Z3,{}),children:u.jsxs(zz,{children:[u.jsx(ss,{path:"/",element:u.jsx(q3,{enabledTools:ve,setEnabledTools:O,showMCPDialog:y,setShowMCPDialog:x,onLoadingChange:F})}),u.jsx(ss,{path:"/feed",element:u.jsx(sxe,{})}),u.jsx(ss,{path:"/chat",element:u.jsx(q3,{enabledTools:ve,setEnabledTools:O,showMCPDialog:y,setShowMCPDialog:x,onLoadingChange:F})}),u.jsx(ss,{path:"/planning",element:u.jsx(txe,{})}),u.jsx(ss,{path:"/swag",element:u.jsx(rxe,{})}),u.jsx(ss,{path:"/snippet/:id",element:u.jsx(nxe,{})}),u.jsx(ss,{path:"/quiz",element:u.jsx(axe,{})}),u.jsx(ss,{path:"/quiz/shared",element:u.jsx(J3,{})}),u.jsx(ss,{path:"/image-editor",element:u.jsx(lxe,{})}),u.jsx(ss,{path:"/music",element:u.jsx(uxe,{})}),u.jsx(ss,{path:"/snippet/shared",element:u.jsx(K3,{})}),u.jsx(ss,{path:"/feed/share/:data",element:u.jsx(X3,{})}),u.jsx(ss,{path:"/billing",element:u.jsx(ixe,{})}),u.jsx(ss,{path:"/settings",element:u.jsx(exe,{enabledTools:ve,setEnabledTools:O,onOpenMCPDialog:()=>x(!0)})}),u.jsx(ss,{path:"/help",element:u.jsx(Y3,{})}),u.jsx(ss,{path:"/privacy",element:u.jsx(Q3,{})})]})})})}),i&&u.jsx(N.Suspense,{fallback:null,children:u.jsx(cxe,{onSwitchToAgent:()=>{W("/chat"),l(!1)},onCreateNewAgent:()=>{W("/chat"),l(!1)},onClose:()=>l(!1)})}),X&&u.jsx(Nbe,{isOpen:X,onClose:()=>Q(!1)}),D&&u.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:u.jsxs("div",{className:"card max-w-md w-full p-6",children:[u.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-4",children:" Active Request in Progress"}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:"You have an active chat request running. Navigating away will stop the current request and you may lose the response."}),u.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-6 font-semibold",children:"Are you sure you want to continue?"}),u.jsxs("div",{className:"flex gap-3 justify-end",children:[u.jsx("button",{onClick:re,className:"btn-secondary px-4 py-2",children:"Stay Here"}),u.jsx("button",{onClick:H,className:"btn-primary px-4 py-2 bg-orange-600 hover:bg-orange-700",children:"Navigate Away"})]})]})}),u.jsx(Tbe,{}),u.jsx(Pbe,{}),u.jsx(G3,{isOpen:ee,onClose:()=>te(!1)})]})}function hxe(){return u.jsx(u$,{basename:"/",children:u.jsx(SU,{children:u.jsx(A$,{children:u.jsx(R$,{children:u.jsx(jq,{children:u.jsx(wq,{children:u.jsx(lq,{children:u.jsx(Tq,{children:u.jsx(Obe,{children:u.jsx(Kbe,{children:u.jsx(Mq,{children:u.jsx(Sq,{children:u.jsx(xq,{children:u.jsx(vU,{children:u.jsx(wU,{children:u.jsx(D$,{children:u.jsx(pq,{children:u.jsx(yq,{children:u.jsx(dxe,{})})})})})})})})})})})})})})})})})})})}typeof window<"u"&&(window.ragDB=Is,console.log(" ragDB exposed to window.ragDB for debugging"));const pxe=()=>{const t="AU9cY15vsAcz4tWwm5U0O-nMBqYTP3cT0dOHTpHqPCCD1n9fwdcD-xNcuzMv_eP-UtaB3PFHTuHoXeCW",e=document.createElement("script");e.src=`https://www.paypal.com/sdk/js?client-id=${t}&currency=USD`,e.async=!0,e.onload=()=>console.log(" PayPal SDK loaded successfully"),e.onerror=()=>console.error(" Failed to load PayPal SDK"),document.head.appendChild(e)};pxe();"serviceWorker"in navigator?window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log(" Service Worker registered successfully:",t.scope),setInterval(()=>{t.update()},3600*1e3),t.addEventListener("updatefound",()=>{const e=t.installing;e&&e.addEventListener("statechange",()=>{if(e.state==="installed"&&navigator.serviceWorker.controller){console.log(" New version available! Please refresh the page.");const r=new CustomEvent("sw-update-available");window.dispatchEvent(r)}})})}).catch(t=>{console.error(" Service Worker registration failed:",t)})}):console.warn(" Service Workers not supported in this browser");const Sw=new URLSearchParams(window.location.search);if(Sw.get("reset")==="true"){console.log(" Reset parameter detected - clearing remote Lambda preference"),VP(),Sw.delete("reset");const t=Sw.toString(),e=window.location.pathname+(t?"?"+t:"")+window.location.hash;window.history.replaceState({},"",e)}sF.createRoot(document.getElementById("root")).render(u.jsx(hxe,{}));export{wg as $,gL as A,Ga as B,Ml as C,Qi as D,Ace as E,fhe as F,Dh as G,gO as H,gf as I,Gxe as J,mve as K,kf as L,k0 as M,fve as N,ho as O,DG as P,mbe as Q,Ur as R,Rae as S,Dae as T,wce as U,vce as V,mge as W,ave as X,_ae as Y,Vxe as Z,L as _,oi as a,kve as a$,Br as a0,Qo as a1,gne as a2,Mae as a3,jk as a4,bs as a5,iL as a6,hhe as a7,gle as a8,KA as a9,kae as aA,pf as aB,dr as aC,Er as aD,fL as aE,Jpe as aF,g5 as aG,pve as aH,Sce as aI,Wa as aJ,jc as aK,_k as aL,zO as aM,Wu as aN,hO as aO,gxe as aP,xI as aQ,OH as aR,Kye as aS,Lc as aT,My as aU,RU as aV,IU as aW,_j as aX,$o as aY,On as aZ,Aj as a_,tle as aa,AN as ab,_N as ac,tve as ad,Kxe as ae,Zxe as af,Jxe as ag,Yxe as ah,Od as ai,fk as aj,eve as ak,Qxe as al,nve as am,rve as an,Xxe as ao,Kne as ap,mh as aq,Hxe as ar,ub as as,nhe as at,fae as au,rk as av,lN as aw,sle as ax,f0 as ay,dhe as az,fxe as b,wf as b$,qw as b0,WU as b1,eI as b2,Zt as b3,Zde as b4,Gue as b5,Vde as b6,Ak as b7,E3 as b8,qge as b9,xye as bA,bxe as bB,yxe as bC,Yye as bD,vH as bE,b_ as bF,rT as bG,mH as bH,ms as bI,wxe as bJ,Wye as bK,Z$ as bL,Qye as bM,n0 as bN,EH as bO,BH as bP,Bxe as bQ,DH as bR,AH as bS,bbe as bT,EU as bU,Ch as bV,UP as bW,ni as bX,Oq as bY,po as bZ,Dc as b_,hve as ba,gve as bb,uve as bc,mr as bd,dve as be,Cge as bf,vge as bg,xge as bh,_pe as bi,rle as bj,qxe as bk,jy as bl,xo as bm,vo as bn,_S as bo,Is as bp,bI as bq,SH as br,I0 as bs,LU as bt,bye as bu,yve as bv,B3 as bw,rbe as bx,ls as by,vxe as bz,ja as c,qN as c$,Cpe as c0,Tpe as c1,C_ as c2,RG as c3,xxe as c4,Fxe as c5,nf as c6,vq as c7,kq as c8,Hu as c9,UF as cA,w$ as cB,Jde as cC,Gde as cD,Rue as cE,Nk as cF,Ede as cG,rhe as cH,xf as cI,Mh as cJ,hy as cK,jde as cL,hfe as cM,bf as cN,gy as cO,Ide as cP,X4 as cQ,Mue as cR,Oue as cS,mu as cT,YN as cU,jue as cV,Pk as cW,Lue as cX,zue as cY,Oh as cZ,Oc as c_,ehe as ca,aO as cb,sb as cc,cb as cd,fy as ce,iO as cf,nO as cg,Pde as ch,dk as ci,Tc as cj,wN as ck,Mie as cl,Bg as cm,gr as cn,V4 as co,eP as cp,ii as cq,Aie as cr,uk as cs,NL as ct,mf as cu,RL as cv,Wxe as cw,pne as cx,Kg as cy,$F as cz,rf as d,Ik as d0,Z4 as d1,uS as d2,the as d3,lb as d4,mxe as d5,kxe as d6,Txe as d7,Cxe as d8,fU as d9,Ow as da,Exe as db,CS as dc,jl as e,Sxe as f,dn as g,Yn as h,vve as i,u as j,$ye as k,Uye as l,ef as m,vn as n,Iye as o,Iae as p,yu as q,N as r,Pae as s,Sve as t,Xi as u,Nae as v,Aae as w,In as x,wn as y,wt as z};
